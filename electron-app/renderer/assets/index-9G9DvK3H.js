var PL=Object.defineProperty;var n3=e=>{throw TypeError(e)};var LL=(e,t,r)=>t in e?PL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Tt=(e,t,r)=>LL(e,typeof t!="symbol"?t+"":t,r),N2=(e,t,r)=>t.has(e)||n3("Cannot "+r);var We=(e,t,r)=>(N2(e,t,"read from private field"),r?r.call(e):t.get(e)),cr=(e,t,r)=>t.has(e)?n3("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Vt=(e,t,r,n)=>(N2(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Ss=(e,t,r)=>(N2(e,t,"access private method"),r);var mm=(e,t,r,n)=>({set _(s){Vt(e,t,s,r)},get _(){return We(e,t,n)}});function FL(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Wre=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function FE(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var DE={exports:{}},ax={},RE={exports:{}},ar={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vp=Symbol.for("react.element"),DL=Symbol.for("react.portal"),RL=Symbol.for("react.fragment"),IL=Symbol.for("react.strict_mode"),OL=Symbol.for("react.profiler"),ML=Symbol.for("react.provider"),BL=Symbol.for("react.context"),UL=Symbol.for("react.forward_ref"),$L=Symbol.for("react.suspense"),zL=Symbol.for("react.memo"),HL=Symbol.for("react.lazy"),s3=Symbol.iterator;function qL(e){return e===null||typeof e!="object"?null:(e=s3&&e[s3]||e["@@iterator"],typeof e=="function"?e:null)}var IE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},OE=Object.assign,ME={};function Ff(e,t,r){this.props=e,this.context=t,this.refs=ME,this.updater=r||IE}Ff.prototype.isReactComponent={};Ff.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ff.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function BE(){}BE.prototype=Ff.prototype;function f5(e,t,r){this.props=e,this.context=t,this.refs=ME,this.updater=r||IE}var h5=f5.prototype=new BE;h5.constructor=f5;OE(h5,Ff.prototype);h5.isPureReactComponent=!0;var a3=Array.isArray,UE=Object.prototype.hasOwnProperty,p5={current:null},$E={key:!0,ref:!0,__self:!0,__source:!0};function zE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)UE.call(t,n)&&!$E.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:vp,type:e,key:a,ref:i,props:s,_owner:p5.current}}function WL(e,t){return{$$typeof:vp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function m5(e){return typeof e=="object"&&e!==null&&e.$$typeof===vp}function VL(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var i3=/\/+/g;function S2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?VL(""+e.key):t.toString(36)}function pg(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case vp:case DL:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+S2(i,0):n,a3(s)?(r="",e!=null&&(r=e.replace(i3,"$&/")+"/"),pg(s,t,r,"",function(u){return u})):s!=null&&(m5(s)&&(s=WL(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(i3,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",a3(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+S2(a,o);i+=pg(a,t,r,l,s)}else if(l=qL(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+S2(a,o++),i+=pg(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function gm(e,t,r){if(e==null)return e;var n=[],s=0;return pg(e,n,"","",function(a){return t.call(r,a,s++)}),n}function KL(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var aa={current:null},mg={transition:null},GL={ReactCurrentDispatcher:aa,ReactCurrentBatchConfig:mg,ReactCurrentOwner:p5};function HE(){throw Error("act(...) is not supported in production builds of React.")}ar.Children={map:gm,forEach:function(e,t,r){gm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return gm(e,function(){t++}),t},toArray:function(e){return gm(e,function(t){return t})||[]},only:function(e){if(!m5(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ar.Component=Ff;ar.Fragment=RL;ar.Profiler=OL;ar.PureComponent=f5;ar.StrictMode=IL;ar.Suspense=$L;ar.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GL;ar.act=HE;ar.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=OE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=p5.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)UE.call(t,l)&&!$E.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:vp,type:e.type,key:s,ref:a,props:n,_owner:i}};ar.createContext=function(e){return e={$$typeof:BL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ML,_context:e},e.Consumer=e};ar.createElement=zE;ar.createFactory=function(e){var t=zE.bind(null,e);return t.type=e,t};ar.createRef=function(){return{current:null}};ar.forwardRef=function(e){return{$$typeof:UL,render:e}};ar.isValidElement=m5;ar.lazy=function(e){return{$$typeof:HL,_payload:{_status:-1,_result:e},_init:KL}};ar.memo=function(e,t){return{$$typeof:zL,type:e,compare:t===void 0?null:t}};ar.startTransition=function(e){var t=mg.transition;mg.transition={};try{e()}finally{mg.transition=t}};ar.unstable_act=HE;ar.useCallback=function(e,t){return aa.current.useCallback(e,t)};ar.useContext=function(e){return aa.current.useContext(e)};ar.useDebugValue=function(){};ar.useDeferredValue=function(e){return aa.current.useDeferredValue(e)};ar.useEffect=function(e,t){return aa.current.useEffect(e,t)};ar.useId=function(){return aa.current.useId()};ar.useImperativeHandle=function(e,t,r){return aa.current.useImperativeHandle(e,t,r)};ar.useInsertionEffect=function(e,t){return aa.current.useInsertionEffect(e,t)};ar.useLayoutEffect=function(e,t){return aa.current.useLayoutEffect(e,t)};ar.useMemo=function(e,t){return aa.current.useMemo(e,t)};ar.useReducer=function(e,t,r){return aa.current.useReducer(e,t,r)};ar.useRef=function(e){return aa.current.useRef(e)};ar.useState=function(e){return aa.current.useState(e)};ar.useSyncExternalStore=function(e,t,r){return aa.current.useSyncExternalStore(e,t,r)};ar.useTransition=function(){return aa.current.useTransition()};ar.version="18.3.1";RE.exports=ar;var J=RE.exports;const Jl=FE(J),YL=FL({__proto__:null,default:Jl},[J]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XL=J,JL=Symbol.for("react.element"),QL=Symbol.for("react.fragment"),ZL=Object.prototype.hasOwnProperty,eF=XL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,tF={key:!0,ref:!0,__self:!0,__source:!0};function qE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)ZL.call(t,n)&&!tF.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:JL,type:e,key:a,ref:i,props:s,_owner:eF.current}}ax.Fragment=QL;ax.jsx=qE;ax.jsxs=qE;DE.exports=ax;var c=DE.exports,Qv={},WE={exports:{}},Ma={},VE={exports:{}},KE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,U){var ue=re.length;re.push(U);e:for(;0<ue;){var pe=ue-1>>>1,C=re[pe];if(0<s(C,U))re[pe]=U,re[ue]=C,ue=pe;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var U=re[0],ue=re.pop();if(ue!==U){re[0]=ue;e:for(var pe=0,C=re.length,R=C>>>1;pe<R;){var B=2*(pe+1)-1,O=re[B],Y=B+1,ie=re[Y];if(0>s(O,ue))Y<C&&0>s(ie,O)?(re[pe]=ie,re[Y]=ue,pe=Y):(re[pe]=O,re[B]=ue,pe=B);else if(Y<C&&0>s(ie,ue))re[pe]=ie,re[Y]=ue,pe=Y;else break e}}return U}function s(re,U){var ue=re.sortIndex-U.sortIndex;return ue!==0?ue:re.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,f=null,p=3,h=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(re){for(var U=r(u);U!==null;){if(U.callback===null)n(u);else if(U.startTime<=re)n(u),U.sortIndex=U.expirationTime,t(l,U);else break;U=r(u)}}function N(re){if(g=!1,b(re),!m)if(r(l)!==null)m=!0,ae(A);else{var U=r(u);U!==null&&he(N,U.startTime-re)}}function A(re,U){m=!1,g&&(g=!1,x(D),D=-1),h=!0;var ue=p;try{for(b(U),f=r(l);f!==null&&(!(f.expirationTime>U)||re&&!_());){var pe=f.callback;if(typeof pe=="function"){f.callback=null,p=f.priorityLevel;var C=pe(f.expirationTime<=U);U=e.unstable_now(),typeof C=="function"?f.callback=C:f===r(l)&&n(l),b(U)}else n(l);f=r(l)}if(f!==null)var R=!0;else{var B=r(u);B!==null&&he(N,B.startTime-U),R=!1}return R}finally{f=null,p=ue,h=!1}}var P=!1,j=null,D=-1,E=5,I=-1;function _(){return!(e.unstable_now()-I<E)}function L(){if(j!==null){var re=e.unstable_now();I=re;var U=!0;try{U=j(!0,re)}finally{U?M():(P=!1,j=null)}}else P=!1}var M;if(typeof w=="function")M=function(){w(L)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Z=K.port2;K.port1.onmessage=L,M=function(){Z.postMessage(null)}}else M=function(){y(L,0)};function ae(re){j=re,P||(P=!0,M())}function he(re,U){D=y(function(){re(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,ae(A))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(re){switch(p){case 1:case 2:case 3:var U=3;break;default:U=p}var ue=p;p=U;try{return re()}finally{p=ue}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,U){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ue=p;p=re;try{return U()}finally{p=ue}},e.unstable_scheduleCallback=function(re,U,ue){var pe=e.unstable_now();switch(typeof ue=="object"&&ue!==null?(ue=ue.delay,ue=typeof ue=="number"&&0<ue?pe+ue:pe):ue=pe,re){case 1:var C=-1;break;case 2:C=250;break;case 5:C=1073741823;break;case 4:C=1e4;break;default:C=5e3}return C=ue+C,re={id:d++,callback:U,priorityLevel:re,startTime:ue,expirationTime:C,sortIndex:-1},ue>pe?(re.sortIndex=ue,t(u,re),r(l)===null&&re===r(u)&&(g?(x(D),D=-1):g=!0,he(N,ue-pe))):(re.sortIndex=C,t(l,re),m||h||(m=!0,ae(A))),re},e.unstable_shouldYield=_,e.unstable_wrapCallback=function(re){var U=p;return function(){var ue=p;p=U;try{return re.apply(this,arguments)}finally{p=ue}}}})(KE);VE.exports=KE;var rF=VE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nF=J,Ra=rF;function rt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var GE=new Set,S0={};function Wu(e,t){bf(e,t),bf(e+"Capture",t)}function bf(e,t){for(S0[e]=t,e=0;e<t.length;e++)GE.add(t[e])}var hl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zv=Object.prototype.hasOwnProperty,sF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,o3={},l3={};function aF(e){return Zv.call(l3,e)?!0:Zv.call(o3,e)?!1:sF.test(e)?l3[e]=!0:(o3[e]=!0,!1)}function iF(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function oF(e,t,r,n){if(t===null||typeof t>"u"||iF(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function ia(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var ws={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ws[e]=new ia(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ws[t]=new ia(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ws[e]=new ia(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ws[e]=new ia(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ws[e]=new ia(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ws[e]=new ia(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ws[e]=new ia(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ws[e]=new ia(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ws[e]=new ia(e,5,!1,e.toLowerCase(),null,!1,!1)});var g5=/[\-:]([a-z])/g;function x5(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g5,x5);ws[t]=new ia(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g5,x5);ws[t]=new ia(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g5,x5);ws[t]=new ia(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ws[e]=new ia(e,1,!1,e.toLowerCase(),null,!1,!1)});ws.xlinkHref=new ia("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ws[e]=new ia(e,1,!1,e.toLowerCase(),null,!0,!0)});function v5(e,t,r,n){var s=ws.hasOwnProperty(t)?ws[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(oF(t,r,s,n)&&(r=null),n||s===null?aF(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var bl=nF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xm=Symbol.for("react.element"),Fd=Symbol.for("react.portal"),Dd=Symbol.for("react.fragment"),y5=Symbol.for("react.strict_mode"),ey=Symbol.for("react.profiler"),YE=Symbol.for("react.provider"),XE=Symbol.for("react.context"),w5=Symbol.for("react.forward_ref"),ty=Symbol.for("react.suspense"),ry=Symbol.for("react.suspense_list"),b5=Symbol.for("react.memo"),Gl=Symbol.for("react.lazy"),JE=Symbol.for("react.offscreen"),c3=Symbol.iterator;function yh(e){return e===null||typeof e!="object"?null:(e=c3&&e[c3]||e["@@iterator"],typeof e=="function"?e:null)}var rn=Object.assign,k2;function Rh(e){if(k2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);k2=t&&t[1]||""}return`
`+k2+e}var _2=!1;function E2(e,t){if(!e||_2)return"";_2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{_2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Rh(e):""}function lF(e){switch(e.tag){case 5:return Rh(e.type);case 16:return Rh("Lazy");case 13:return Rh("Suspense");case 19:return Rh("SuspenseList");case 0:case 2:case 15:return e=E2(e.type,!1),e;case 11:return e=E2(e.type.render,!1),e;case 1:return e=E2(e.type,!0),e;default:return""}}function ny(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Dd:return"Fragment";case Fd:return"Portal";case ey:return"Profiler";case y5:return"StrictMode";case ty:return"Suspense";case ry:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case XE:return(e.displayName||"Context")+".Consumer";case YE:return(e._context.displayName||"Context")+".Provider";case w5:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case b5:return t=e.displayName||null,t!==null?t:ny(e.type)||"Memo";case Gl:t=e._payload,e=e._init;try{return ny(e(t))}catch{}}return null}function cF(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ny(t);case 8:return t===y5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ec(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function QE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function uF(e){var t=QE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function vm(e){e._valueTracker||(e._valueTracker=uF(e))}function ZE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=QE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Gg(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function sy(e,t){var r=t.checked;return rn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function u3(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Ec(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function e6(e,t){t=t.checked,t!=null&&v5(e,"checked",t,!1)}function ay(e,t){e6(e,t);var r=Ec(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?iy(e,t.type,r):t.hasOwnProperty("defaultValue")&&iy(e,t.type,Ec(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function d3(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function iy(e,t,r){(t!=="number"||Gg(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ih=Array.isArray;function Kd(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ec(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function oy(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(rt(91));return rn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function f3(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(rt(92));if(Ih(r)){if(1<r.length)throw Error(rt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Ec(r)}}function t6(e,t){var r=Ec(t.value),n=Ec(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function h3(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function r6(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ly(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?r6(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ym,n6=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ym=ym||document.createElement("div"),ym.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ym.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function k0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},dF=["Webkit","ms","Moz","O"];Object.keys(Gh).forEach(function(e){dF.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gh[t]=Gh[e]})});function s6(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gh.hasOwnProperty(e)&&Gh[e]?(""+t).trim():t+"px"}function a6(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=s6(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var fF=rn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function cy(e,t){if(t){if(fF[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(rt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(rt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(rt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(rt(62))}}function uy(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dy=null;function N5(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var fy=null,Gd=null,Yd=null;function p3(e){if(e=bp(e)){if(typeof fy!="function")throw Error(rt(280));var t=e.stateNode;t&&(t=ux(t),fy(e.stateNode,e.type,t))}}function i6(e){Gd?Yd?Yd.push(e):Yd=[e]:Gd=e}function o6(){if(Gd){var e=Gd,t=Yd;if(Yd=Gd=null,p3(e),t)for(e=0;e<t.length;e++)p3(t[e])}}function l6(e,t){return e(t)}function c6(){}var A2=!1;function u6(e,t,r){if(A2)return e(t,r);A2=!0;try{return l6(e,t,r)}finally{A2=!1,(Gd!==null||Yd!==null)&&(c6(),o6())}}function _0(e,t){var r=e.stateNode;if(r===null)return null;var n=ux(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(rt(231,t,typeof r));return r}var hy=!1;if(hl)try{var wh={};Object.defineProperty(wh,"passive",{get:function(){hy=!0}}),window.addEventListener("test",wh,wh),window.removeEventListener("test",wh,wh)}catch{hy=!1}function hF(e,t,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(d){this.onError(d)}}var Yh=!1,Yg=null,Xg=!1,py=null,pF={onError:function(e){Yh=!0,Yg=e}};function mF(e,t,r,n,s,a,i,o,l){Yh=!1,Yg=null,hF.apply(pF,arguments)}function gF(e,t,r,n,s,a,i,o,l){if(mF.apply(this,arguments),Yh){if(Yh){var u=Yg;Yh=!1,Yg=null}else throw Error(rt(198));Xg||(Xg=!0,py=u)}}function Vu(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function d6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function m3(e){if(Vu(e)!==e)throw Error(rt(188))}function xF(e){var t=e.alternate;if(!t){if(t=Vu(e),t===null)throw Error(rt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return m3(s),e;if(a===n)return m3(s),t;a=a.sibling}throw Error(rt(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(rt(189))}}if(r.alternate!==n)throw Error(rt(190))}if(r.tag!==3)throw Error(rt(188));return r.stateNode.current===r?e:t}function f6(e){return e=xF(e),e!==null?h6(e):null}function h6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=h6(e);if(t!==null)return t;e=e.sibling}return null}var p6=Ra.unstable_scheduleCallback,g3=Ra.unstable_cancelCallback,vF=Ra.unstable_shouldYield,yF=Ra.unstable_requestPaint,wn=Ra.unstable_now,wF=Ra.unstable_getCurrentPriorityLevel,S5=Ra.unstable_ImmediatePriority,m6=Ra.unstable_UserBlockingPriority,Jg=Ra.unstable_NormalPriority,bF=Ra.unstable_LowPriority,g6=Ra.unstable_IdlePriority,ix=null,go=null;function NF(e){if(go&&typeof go.onCommitFiberRoot=="function")try{go.onCommitFiberRoot(ix,e,void 0,(e.current.flags&128)===128)}catch{}}var Di=Math.clz32?Math.clz32:_F,SF=Math.log,kF=Math.LN2;function _F(e){return e>>>=0,e===0?32:31-(SF(e)/kF|0)|0}var wm=64,bm=4194304;function Oh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Qg(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Oh(o):(a&=i,a!==0&&(n=Oh(a)))}else i=r&~s,i!==0?n=Oh(i):a!==0&&(n=Oh(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Di(t),s=1<<r,n|=e[r],t&=~s;return n}function EF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function AF(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Di(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=EF(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function my(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function x6(){var e=wm;return wm<<=1,!(wm&4194240)&&(wm=64),e}function j2(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Di(t),e[t]=r}function jF(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Di(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function k5(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Di(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var jr=0;function v6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var y6,_5,w6,b6,N6,gy=!1,Nm=[],mc=null,gc=null,xc=null,E0=new Map,A0=new Map,Ql=[],CF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function x3(e,t){switch(e){case"focusin":case"focusout":mc=null;break;case"dragenter":case"dragleave":gc=null;break;case"mouseover":case"mouseout":xc=null;break;case"pointerover":case"pointerout":E0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":A0.delete(t.pointerId)}}function bh(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=bp(t),t!==null&&_5(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function TF(e,t,r,n,s){switch(t){case"focusin":return mc=bh(mc,e,t,r,n,s),!0;case"dragenter":return gc=bh(gc,e,t,r,n,s),!0;case"mouseover":return xc=bh(xc,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return E0.set(a,bh(E0.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,A0.set(a,bh(A0.get(a)||null,e,t,r,n,s)),!0}return!1}function S6(e){var t=ou(e.target);if(t!==null){var r=Vu(t);if(r!==null){if(t=r.tag,t===13){if(t=d6(r),t!==null){e.blockedOn=t,N6(e.priority,function(){w6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function gg(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=xy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);dy=n,r.target.dispatchEvent(n),dy=null}else return t=bp(r),t!==null&&_5(t),e.blockedOn=r,!1;t.shift()}return!0}function v3(e,t,r){gg(e)&&r.delete(t)}function PF(){gy=!1,mc!==null&&gg(mc)&&(mc=null),gc!==null&&gg(gc)&&(gc=null),xc!==null&&gg(xc)&&(xc=null),E0.forEach(v3),A0.forEach(v3)}function Nh(e,t){e.blockedOn===t&&(e.blockedOn=null,gy||(gy=!0,Ra.unstable_scheduleCallback(Ra.unstable_NormalPriority,PF)))}function j0(e){function t(s){return Nh(s,e)}if(0<Nm.length){Nh(Nm[0],e);for(var r=1;r<Nm.length;r++){var n=Nm[r];n.blockedOn===e&&(n.blockedOn=null)}}for(mc!==null&&Nh(mc,e),gc!==null&&Nh(gc,e),xc!==null&&Nh(xc,e),E0.forEach(t),A0.forEach(t),r=0;r<Ql.length;r++)n=Ql[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ql.length&&(r=Ql[0],r.blockedOn===null);)S6(r),r.blockedOn===null&&Ql.shift()}var Xd=bl.ReactCurrentBatchConfig,Zg=!0;function LF(e,t,r,n){var s=jr,a=Xd.transition;Xd.transition=null;try{jr=1,E5(e,t,r,n)}finally{jr=s,Xd.transition=a}}function FF(e,t,r,n){var s=jr,a=Xd.transition;Xd.transition=null;try{jr=4,E5(e,t,r,n)}finally{jr=s,Xd.transition=a}}function E5(e,t,r,n){if(Zg){var s=xy(e,t,r,n);if(s===null)M2(e,t,n,e1,r),x3(e,n);else if(TF(s,e,t,r,n))n.stopPropagation();else if(x3(e,n),t&4&&-1<CF.indexOf(e)){for(;s!==null;){var a=bp(s);if(a!==null&&y6(a),a=xy(e,t,r,n),a===null&&M2(e,t,n,e1,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else M2(e,t,n,null,r)}}var e1=null;function xy(e,t,r,n){if(e1=null,e=N5(n),e=ou(e),e!==null)if(t=Vu(e),t===null)e=null;else if(r=t.tag,r===13){if(e=d6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return e1=e,null}function k6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wF()){case S5:return 1;case m6:return 4;case Jg:case bF:return 16;case g6:return 536870912;default:return 16}default:return 16}}var lc=null,A5=null,xg=null;function _6(){if(xg)return xg;var e,t=A5,r=t.length,n,s="value"in lc?lc.value:lc.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return xg=s.slice(e,1<n?1-n:void 0)}function vg(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sm(){return!0}function y3(){return!1}function Ba(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Sm:y3,this.isPropagationStopped=y3,this}return rn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Sm)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Sm)},persist:function(){},isPersistent:Sm}),t}var Df={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},j5=Ba(Df),wp=rn({},Df,{view:0,detail:0}),DF=Ba(wp),C2,T2,Sh,ox=rn({},wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:C5,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Sh&&(Sh&&e.type==="mousemove"?(C2=e.screenX-Sh.screenX,T2=e.screenY-Sh.screenY):T2=C2=0,Sh=e),C2)},movementY:function(e){return"movementY"in e?e.movementY:T2}}),w3=Ba(ox),RF=rn({},ox,{dataTransfer:0}),IF=Ba(RF),OF=rn({},wp,{relatedTarget:0}),P2=Ba(OF),MF=rn({},Df,{animationName:0,elapsedTime:0,pseudoElement:0}),BF=Ba(MF),UF=rn({},Df,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$F=Ba(UF),zF=rn({},Df,{data:0}),b3=Ba(zF),HF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},WF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=WF[e])?!!t[e]:!1}function C5(){return VF}var KF=rn({},wp,{key:function(e){if(e.key){var t=HF[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=vg(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?qF[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:C5,charCode:function(e){return e.type==="keypress"?vg(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?vg(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),GF=Ba(KF),YF=rn({},ox,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N3=Ba(YF),XF=rn({},wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:C5}),JF=Ba(XF),QF=rn({},Df,{propertyName:0,elapsedTime:0,pseudoElement:0}),ZF=Ba(QF),e7=rn({},ox,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),t7=Ba(e7),r7=[9,13,27,32],T5=hl&&"CompositionEvent"in window,Xh=null;hl&&"documentMode"in document&&(Xh=document.documentMode);var n7=hl&&"TextEvent"in window&&!Xh,E6=hl&&(!T5||Xh&&8<Xh&&11>=Xh),S3=" ",k3=!1;function A6(e,t){switch(e){case"keyup":return r7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function j6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Rd=!1;function s7(e,t){switch(e){case"compositionend":return j6(t);case"keypress":return t.which!==32?null:(k3=!0,S3);case"textInput":return e=t.data,e===S3&&k3?null:e;default:return null}}function a7(e,t){if(Rd)return e==="compositionend"||!T5&&A6(e,t)?(e=_6(),xg=A5=lc=null,Rd=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return E6&&t.locale!=="ko"?null:t.data;default:return null}}var i7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!i7[e.type]:t==="textarea"}function C6(e,t,r,n){i6(n),t=t1(t,"onChange"),0<t.length&&(r=new j5("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Jh=null,C0=null;function o7(e){U6(e,0)}function lx(e){var t=Md(e);if(ZE(t))return e}function l7(e,t){if(e==="change")return t}var T6=!1;if(hl){var L2;if(hl){var F2="oninput"in document;if(!F2){var E3=document.createElement("div");E3.setAttribute("oninput","return;"),F2=typeof E3.oninput=="function"}L2=F2}else L2=!1;T6=L2&&(!document.documentMode||9<document.documentMode)}function A3(){Jh&&(Jh.detachEvent("onpropertychange",P6),C0=Jh=null)}function P6(e){if(e.propertyName==="value"&&lx(C0)){var t=[];C6(t,C0,e,N5(e)),u6(o7,t)}}function c7(e,t,r){e==="focusin"?(A3(),Jh=t,C0=r,Jh.attachEvent("onpropertychange",P6)):e==="focusout"&&A3()}function u7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return lx(C0)}function d7(e,t){if(e==="click")return lx(t)}function f7(e,t){if(e==="input"||e==="change")return lx(t)}function h7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Mi=typeof Object.is=="function"?Object.is:h7;function T0(e,t){if(Mi(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Zv.call(t,s)||!Mi(e[s],t[s]))return!1}return!0}function j3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function C3(e,t){var r=j3(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=j3(r)}}function L6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?L6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function F6(){for(var e=window,t=Gg();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Gg(e.document)}return t}function P5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function p7(e){var t=F6(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&L6(r.ownerDocument.documentElement,r)){if(n!==null&&P5(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=C3(r,a);var i=C3(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var m7=hl&&"documentMode"in document&&11>=document.documentMode,Id=null,vy=null,Qh=null,yy=!1;function T3(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;yy||Id==null||Id!==Gg(n)||(n=Id,"selectionStart"in n&&P5(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Qh&&T0(Qh,n)||(Qh=n,n=t1(vy,"onSelect"),0<n.length&&(t=new j5("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Id)))}function km(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Od={animationend:km("Animation","AnimationEnd"),animationiteration:km("Animation","AnimationIteration"),animationstart:km("Animation","AnimationStart"),transitionend:km("Transition","TransitionEnd")},D2={},D6={};hl&&(D6=document.createElement("div").style,"AnimationEvent"in window||(delete Od.animationend.animation,delete Od.animationiteration.animation,delete Od.animationstart.animation),"TransitionEvent"in window||delete Od.transitionend.transition);function cx(e){if(D2[e])return D2[e];if(!Od[e])return e;var t=Od[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in D6)return D2[e]=t[r];return e}var R6=cx("animationend"),I6=cx("animationiteration"),O6=cx("animationstart"),M6=cx("transitionend"),B6=new Map,P3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rc(e,t){B6.set(e,t),Wu(t,[e])}for(var R2=0;R2<P3.length;R2++){var I2=P3[R2],g7=I2.toLowerCase(),x7=I2[0].toUpperCase()+I2.slice(1);Rc(g7,"on"+x7)}Rc(R6,"onAnimationEnd");Rc(I6,"onAnimationIteration");Rc(O6,"onAnimationStart");Rc("dblclick","onDoubleClick");Rc("focusin","onFocus");Rc("focusout","onBlur");Rc(M6,"onTransitionEnd");bf("onMouseEnter",["mouseout","mouseover"]);bf("onMouseLeave",["mouseout","mouseover"]);bf("onPointerEnter",["pointerout","pointerover"]);bf("onPointerLeave",["pointerout","pointerover"]);Wu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),v7=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mh));function L3(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,gF(n,t,void 0,e),e.currentTarget=null}function U6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;L3(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;L3(s,o,u),a=l}}}if(Xg)throw e=py,Xg=!1,py=null,e}function qr(e,t){var r=t[ky];r===void 0&&(r=t[ky]=new Set);var n=e+"__bubble";r.has(n)||($6(t,e,2,!1),r.add(n))}function O2(e,t,r){var n=0;t&&(n|=4),$6(r,e,n,t)}var _m="_reactListening"+Math.random().toString(36).slice(2);function P0(e){if(!e[_m]){e[_m]=!0,GE.forEach(function(r){r!=="selectionchange"&&(v7.has(r)||O2(r,!1,e),O2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_m]||(t[_m]=!0,O2("selectionchange",!1,t))}}function $6(e,t,r,n){switch(k6(t)){case 1:var s=LF;break;case 4:s=FF;break;default:s=E5}r=s.bind(null,t,r,e),s=void 0,!hy||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function M2(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=ou(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}u6(function(){var u=a,d=N5(r),f=[];e:{var p=B6.get(e);if(p!==void 0){var h=j5,m=e;switch(e){case"keypress":if(vg(r)===0)break e;case"keydown":case"keyup":h=GF;break;case"focusin":m="focus",h=P2;break;case"focusout":m="blur",h=P2;break;case"beforeblur":case"afterblur":h=P2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=w3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=IF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=JF;break;case R6:case I6:case O6:h=BF;break;case M6:h=ZF;break;case"scroll":h=DF;break;case"wheel":h=t7;break;case"copy":case"cut":case"paste":h=$F;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=N3}var g=(t&4)!==0,y=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var w=u,b;w!==null;){b=w;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,x!==null&&(N=_0(w,x),N!=null&&g.push(L0(w,N,b)))),y)break;w=w.return}0<g.length&&(p=new h(p,m,null,r,d),f.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==dy&&(m=r.relatedTarget||r.fromElement)&&(ou(m)||m[pl]))break e;if((h||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=u,m=m?ou(m):null,m!==null&&(y=Vu(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=u),h!==m)){if(g=w3,N="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(g=N3,N="onPointerLeave",x="onPointerEnter",w="pointer"),y=h==null?p:Md(h),b=m==null?p:Md(m),p=new g(N,w+"leave",h,r,d),p.target=y,p.relatedTarget=b,N=null,ou(d)===u&&(g=new g(x,w+"enter",m,r,d),g.target=b,g.relatedTarget=y,N=g),y=N,h&&m)t:{for(g=h,x=m,w=0,b=g;b;b=pd(b))w++;for(b=0,N=x;N;N=pd(N))b++;for(;0<w-b;)g=pd(g),w--;for(;0<b-w;)x=pd(x),b--;for(;w--;){if(g===x||x!==null&&g===x.alternate)break t;g=pd(g),x=pd(x)}g=null}else g=null;h!==null&&F3(f,p,h,g,!1),m!==null&&y!==null&&F3(f,y,m,g,!0)}}e:{if(p=u?Md(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var A=l7;else if(_3(p))if(T6)A=f7;else{A=u7;var P=c7}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(A=d7);if(A&&(A=A(e,u))){C6(f,A,r,d);break e}P&&P(e,p,u),e==="focusout"&&(P=p._wrapperState)&&P.controlled&&p.type==="number"&&iy(p,"number",p.value)}switch(P=u?Md(u):window,e){case"focusin":(_3(P)||P.contentEditable==="true")&&(Id=P,vy=u,Qh=null);break;case"focusout":Qh=vy=Id=null;break;case"mousedown":yy=!0;break;case"contextmenu":case"mouseup":case"dragend":yy=!1,T3(f,r,d);break;case"selectionchange":if(m7)break;case"keydown":case"keyup":T3(f,r,d)}var j;if(T5)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Rd?A6(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(E6&&r.locale!=="ko"&&(Rd||D!=="onCompositionStart"?D==="onCompositionEnd"&&Rd&&(j=_6()):(lc=d,A5="value"in lc?lc.value:lc.textContent,Rd=!0)),P=t1(u,D),0<P.length&&(D=new b3(D,e,null,r,d),f.push({event:D,listeners:P}),j?D.data=j:(j=j6(r),j!==null&&(D.data=j)))),(j=n7?s7(e,r):a7(e,r))&&(u=t1(u,"onBeforeInput"),0<u.length&&(d=new b3("onBeforeInput","beforeinput",null,r,d),f.push({event:d,listeners:u}),d.data=j))}U6(f,t)})}function L0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function t1(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=_0(e,r),a!=null&&n.unshift(L0(e,a,s)),a=_0(e,t),a!=null&&n.push(L0(e,a,s))),e=e.return}return n}function pd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function F3(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=_0(r,a),l!=null&&i.unshift(L0(r,l,o))):s||(l=_0(r,a),l!=null&&i.push(L0(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var y7=/\r\n?/g,w7=/\u0000|\uFFFD/g;function D3(e){return(typeof e=="string"?e:""+e).replace(y7,`
`).replace(w7,"")}function Em(e,t,r){if(t=D3(t),D3(e)!==t&&r)throw Error(rt(425))}function r1(){}var wy=null,by=null;function Ny(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Sy=typeof setTimeout=="function"?setTimeout:void 0,b7=typeof clearTimeout=="function"?clearTimeout:void 0,R3=typeof Promise=="function"?Promise:void 0,N7=typeof queueMicrotask=="function"?queueMicrotask:typeof R3<"u"?function(e){return R3.resolve(null).then(e).catch(S7)}:Sy;function S7(e){setTimeout(function(){throw e})}function B2(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),j0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);j0(t)}function vc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function I3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Rf=Math.random().toString(36).slice(2),uo="__reactFiber$"+Rf,F0="__reactProps$"+Rf,pl="__reactContainer$"+Rf,ky="__reactEvents$"+Rf,k7="__reactListeners$"+Rf,_7="__reactHandles$"+Rf;function ou(e){var t=e[uo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pl]||r[uo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=I3(e);e!==null;){if(r=e[uo])return r;e=I3(e)}return t}e=r,r=e.parentNode}return null}function bp(e){return e=e[uo]||e[pl],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Md(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(rt(33))}function ux(e){return e[F0]||null}var _y=[],Bd=-1;function Ic(e){return{current:e}}function Gr(e){0>Bd||(e.current=_y[Bd],_y[Bd]=null,Bd--)}function $r(e,t){Bd++,_y[Bd]=e.current,e.current=t}var Ac={},Bs=Ic(Ac),fa=Ic(!1),Pu=Ac;function Nf(e,t){var r=e.type.contextTypes;if(!r)return Ac;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ha(e){return e=e.childContextTypes,e!=null}function n1(){Gr(fa),Gr(Bs)}function O3(e,t,r){if(Bs.current!==Ac)throw Error(rt(168));$r(Bs,t),$r(fa,r)}function z6(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(rt(108,cF(e)||"Unknown",s));return rn({},r,n)}function s1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ac,Pu=Bs.current,$r(Bs,e),$r(fa,fa.current),!0}function M3(e,t,r){var n=e.stateNode;if(!n)throw Error(rt(169));r?(e=z6(e,t,Pu),n.__reactInternalMemoizedMergedChildContext=e,Gr(fa),Gr(Bs),$r(Bs,e)):Gr(fa),$r(fa,r)}var Jo=null,dx=!1,U2=!1;function H6(e){Jo===null?Jo=[e]:Jo.push(e)}function E7(e){dx=!0,H6(e)}function Oc(){if(!U2&&Jo!==null){U2=!0;var e=0,t=jr;try{var r=Jo;for(jr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Jo=null,dx=!1}catch(s){throw Jo!==null&&(Jo=Jo.slice(e+1)),p6(S5,Oc),s}finally{jr=t,U2=!1}}return null}var Ud=[],$d=0,a1=null,i1=0,Ja=[],Qa=0,Lu=null,rl=1,nl="";function tu(e,t){Ud[$d++]=i1,Ud[$d++]=a1,a1=e,i1=t}function q6(e,t,r){Ja[Qa++]=rl,Ja[Qa++]=nl,Ja[Qa++]=Lu,Lu=e;var n=rl;e=nl;var s=32-Di(n)-1;n&=~(1<<s),r+=1;var a=32-Di(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,rl=1<<32-Di(t)+s|r<<s|n,nl=a+e}else rl=1<<a|r<<s|n,nl=e}function L5(e){e.return!==null&&(tu(e,1),q6(e,1,0))}function F5(e){for(;e===a1;)a1=Ud[--$d],Ud[$d]=null,i1=Ud[--$d],Ud[$d]=null;for(;e===Lu;)Lu=Ja[--Qa],Ja[Qa]=null,nl=Ja[--Qa],Ja[Qa]=null,rl=Ja[--Qa],Ja[Qa]=null}var Da=null,La=null,Qr=!1,ji=null;function W6(e,t){var r=ti(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function B3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Da=e,La=vc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Da=e,La=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Lu!==null?{id:rl,overflow:nl}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=ti(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Da=e,La=null,!0):!1;default:return!1}}function Ey(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ay(e){if(Qr){var t=La;if(t){var r=t;if(!B3(e,t)){if(Ey(e))throw Error(rt(418));t=vc(r.nextSibling);var n=Da;t&&B3(e,t)?W6(n,r):(e.flags=e.flags&-4097|2,Qr=!1,Da=e)}}else{if(Ey(e))throw Error(rt(418));e.flags=e.flags&-4097|2,Qr=!1,Da=e}}}function U3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Da=e}function Am(e){if(e!==Da)return!1;if(!Qr)return U3(e),Qr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Ny(e.type,e.memoizedProps)),t&&(t=La)){if(Ey(e))throw V6(),Error(rt(418));for(;t;)W6(e,t),t=vc(t.nextSibling)}if(U3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(rt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){La=vc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}La=null}}else La=Da?vc(e.stateNode.nextSibling):null;return!0}function V6(){for(var e=La;e;)e=vc(e.nextSibling)}function Sf(){La=Da=null,Qr=!1}function D5(e){ji===null?ji=[e]:ji.push(e)}var A7=bl.ReactCurrentBatchConfig;function kh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(rt(309));var n=r.stateNode}if(!n)throw Error(rt(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(rt(284));if(!r._owner)throw Error(rt(290,e))}return e}function jm(e,t){throw e=Object.prototype.toString.call(t),Error(rt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function $3(e){var t=e._init;return t(e._payload)}function K6(e){function t(x,w){if(e){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function r(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function n(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function s(x,w){return x=Nc(x,w),x.index=0,x.sibling=null,x}function a(x,w,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,w,b,N){return w===null||w.tag!==6?(w=K2(b,x.mode,N),w.return=x,w):(w=s(w,b),w.return=x,w)}function l(x,w,b,N){var A=b.type;return A===Dd?d(x,w,b.props.children,N,b.key):w!==null&&(w.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Gl&&$3(A)===w.type)?(N=s(w,b.props),N.ref=kh(x,w,b),N.return=x,N):(N=_g(b.type,b.key,b.props,null,x.mode,N),N.ref=kh(x,w,b),N.return=x,N)}function u(x,w,b,N){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=G2(b,x.mode,N),w.return=x,w):(w=s(w,b.children||[]),w.return=x,w)}function d(x,w,b,N,A){return w===null||w.tag!==7?(w=wu(b,x.mode,N,A),w.return=x,w):(w=s(w,b),w.return=x,w)}function f(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=K2(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xm:return b=_g(w.type,w.key,w.props,null,x.mode,b),b.ref=kh(x,null,w),b.return=x,b;case Fd:return w=G2(w,x.mode,b),w.return=x,w;case Gl:var N=w._init;return f(x,N(w._payload),b)}if(Ih(w)||yh(w))return w=wu(w,x.mode,b,null),w.return=x,w;jm(x,w)}return null}function p(x,w,b,N){var A=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return A!==null?null:o(x,w,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xm:return b.key===A?l(x,w,b,N):null;case Fd:return b.key===A?u(x,w,b,N):null;case Gl:return A=b._init,p(x,w,A(b._payload),N)}if(Ih(b)||yh(b))return A!==null?null:d(x,w,b,N,null);jm(x,b)}return null}function h(x,w,b,N,A){if(typeof N=="string"&&N!==""||typeof N=="number")return x=x.get(b)||null,o(w,x,""+N,A);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case xm:return x=x.get(N.key===null?b:N.key)||null,l(w,x,N,A);case Fd:return x=x.get(N.key===null?b:N.key)||null,u(w,x,N,A);case Gl:var P=N._init;return h(x,w,b,P(N._payload),A)}if(Ih(N)||yh(N))return x=x.get(b)||null,d(w,x,N,A,null);jm(w,N)}return null}function m(x,w,b,N){for(var A=null,P=null,j=w,D=w=0,E=null;j!==null&&D<b.length;D++){j.index>D?(E=j,j=null):E=j.sibling;var I=p(x,j,b[D],N);if(I===null){j===null&&(j=E);break}e&&j&&I.alternate===null&&t(x,j),w=a(I,w,D),P===null?A=I:P.sibling=I,P=I,j=E}if(D===b.length)return r(x,j),Qr&&tu(x,D),A;if(j===null){for(;D<b.length;D++)j=f(x,b[D],N),j!==null&&(w=a(j,w,D),P===null?A=j:P.sibling=j,P=j);return Qr&&tu(x,D),A}for(j=n(x,j);D<b.length;D++)E=h(j,x,D,b[D],N),E!==null&&(e&&E.alternate!==null&&j.delete(E.key===null?D:E.key),w=a(E,w,D),P===null?A=E:P.sibling=E,P=E);return e&&j.forEach(function(_){return t(x,_)}),Qr&&tu(x,D),A}function g(x,w,b,N){var A=yh(b);if(typeof A!="function")throw Error(rt(150));if(b=A.call(b),b==null)throw Error(rt(151));for(var P=A=null,j=w,D=w=0,E=null,I=b.next();j!==null&&!I.done;D++,I=b.next()){j.index>D?(E=j,j=null):E=j.sibling;var _=p(x,j,I.value,N);if(_===null){j===null&&(j=E);break}e&&j&&_.alternate===null&&t(x,j),w=a(_,w,D),P===null?A=_:P.sibling=_,P=_,j=E}if(I.done)return r(x,j),Qr&&tu(x,D),A;if(j===null){for(;!I.done;D++,I=b.next())I=f(x,I.value,N),I!==null&&(w=a(I,w,D),P===null?A=I:P.sibling=I,P=I);return Qr&&tu(x,D),A}for(j=n(x,j);!I.done;D++,I=b.next())I=h(j,x,D,I.value,N),I!==null&&(e&&I.alternate!==null&&j.delete(I.key===null?D:I.key),w=a(I,w,D),P===null?A=I:P.sibling=I,P=I);return e&&j.forEach(function(L){return t(x,L)}),Qr&&tu(x,D),A}function y(x,w,b,N){if(typeof b=="object"&&b!==null&&b.type===Dd&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case xm:e:{for(var A=b.key,P=w;P!==null;){if(P.key===A){if(A=b.type,A===Dd){if(P.tag===7){r(x,P.sibling),w=s(P,b.props.children),w.return=x,x=w;break e}}else if(P.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===Gl&&$3(A)===P.type){r(x,P.sibling),w=s(P,b.props),w.ref=kh(x,P,b),w.return=x,x=w;break e}r(x,P);break}else t(x,P);P=P.sibling}b.type===Dd?(w=wu(b.props.children,x.mode,N,b.key),w.return=x,x=w):(N=_g(b.type,b.key,b.props,null,x.mode,N),N.ref=kh(x,w,b),N.return=x,x=N)}return i(x);case Fd:e:{for(P=b.key;w!==null;){if(w.key===P)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){r(x,w.sibling),w=s(w,b.children||[]),w.return=x,x=w;break e}else{r(x,w);break}else t(x,w);w=w.sibling}w=G2(b,x.mode,N),w.return=x,x=w}return i(x);case Gl:return P=b._init,y(x,w,P(b._payload),N)}if(Ih(b))return m(x,w,b,N);if(yh(b))return g(x,w,b,N);jm(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(r(x,w.sibling),w=s(w,b),w.return=x,x=w):(r(x,w),w=K2(b,x.mode,N),w.return=x,x=w),i(x)):r(x,w)}return y}var kf=K6(!0),G6=K6(!1),o1=Ic(null),l1=null,zd=null,R5=null;function I5(){R5=zd=l1=null}function O5(e){var t=o1.current;Gr(o1),e._currentValue=t}function jy(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Jd(e,t){l1=e,R5=zd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(da=!0),e.firstContext=null)}function si(e){var t=e._currentValue;if(R5!==e)if(e={context:e,memoizedValue:t,next:null},zd===null){if(l1===null)throw Error(rt(308));zd=e,l1.dependencies={lanes:0,firstContext:e}}else zd=zd.next=e;return t}var lu=null;function M5(e){lu===null?lu=[e]:lu.push(e)}function Y6(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,M5(t)):(r.next=s.next,s.next=r),t.interleaved=r,ml(e,n)}function ml(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Yl=!1;function B5(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function X6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ol(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function yc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,vr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,ml(e,r)}return s=n.interleaved,s===null?(t.next=t,M5(n)):(t.next=s.next,s.next=t),n.interleaved=t,ml(e,r)}function yg(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k5(e,r)}}function z3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function c1(e,t,r,n){var s=e.updateQueue;Yl=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var d=e.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(a!==null){var f=s.baseState;i=0,d=u=l=null,o=a;do{var p=o.lane,h=o.eventTime;if((n&p)===p){d!==null&&(d=d.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(p=t,h=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){f=m.call(h,f,p);break e}f=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(h,f,p):m,p==null)break e;f=rn({},f,p);break e;case 2:Yl=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=h,l=f):d=d.next=h,i|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;p=o,o=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(l=f),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Du|=i,e.lanes=i,e.memoizedState=f}}function H3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(rt(191,s));s.call(n)}}}var Np={},xo=Ic(Np),D0=Ic(Np),R0=Ic(Np);function cu(e){if(e===Np)throw Error(rt(174));return e}function U5(e,t){switch($r(R0,t),$r(D0,e),$r(xo,Np),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ly(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ly(t,e)}Gr(xo),$r(xo,t)}function _f(){Gr(xo),Gr(D0),Gr(R0)}function J6(e){cu(R0.current);var t=cu(xo.current),r=ly(t,e.type);t!==r&&($r(D0,e),$r(xo,r))}function $5(e){D0.current===e&&(Gr(xo),Gr(D0))}var en=Ic(0);function u1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var $2=[];function z5(){for(var e=0;e<$2.length;e++)$2[e]._workInProgressVersionPrimary=null;$2.length=0}var wg=bl.ReactCurrentDispatcher,z2=bl.ReactCurrentBatchConfig,Fu=0,tn=null,Vn=null,es=null,d1=!1,Zh=!1,I0=0,j7=0;function ks(){throw Error(rt(321))}function H5(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Mi(e[r],t[r]))return!1;return!0}function q5(e,t,r,n,s,a){if(Fu=a,tn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,wg.current=e===null||e.memoizedState===null?L7:F7,e=r(n,s),Zh){a=0;do{if(Zh=!1,I0=0,25<=a)throw Error(rt(301));a+=1,es=Vn=null,t.updateQueue=null,wg.current=D7,e=r(n,s)}while(Zh)}if(wg.current=f1,t=Vn!==null&&Vn.next!==null,Fu=0,es=Vn=tn=null,d1=!1,t)throw Error(rt(300));return e}function W5(){var e=I0!==0;return I0=0,e}function ao(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return es===null?tn.memoizedState=es=e:es=es.next=e,es}function ai(){if(Vn===null){var e=tn.alternate;e=e!==null?e.memoizedState:null}else e=Vn.next;var t=es===null?tn.memoizedState:es.next;if(t!==null)es=t,Vn=e;else{if(e===null)throw Error(rt(310));Vn=e,e={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},es===null?tn.memoizedState=es=e:es=es.next=e}return es}function O0(e,t){return typeof t=="function"?t(e):t}function H2(e){var t=ai(),r=t.queue;if(r===null)throw Error(rt(311));r.lastRenderedReducer=e;var n=Vn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var d=u.lane;if((Fu&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var f={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=f,i=n):l=l.next=f,tn.lanes|=d,Du|=d}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,Mi(n,t.memoizedState)||(da=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,tn.lanes|=a,Du|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function q2(e){var t=ai(),r=t.queue;if(r===null)throw Error(rt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);Mi(a,t.memoizedState)||(da=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Q6(){}function Z6(e,t){var r=tn,n=ai(),s=t(),a=!Mi(n.memoizedState,s);if(a&&(n.memoizedState=s,da=!0),n=n.queue,V5(rA.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||es!==null&&es.memoizedState.tag&1){if(r.flags|=2048,M0(9,tA.bind(null,r,n,s,t),void 0,null),ns===null)throw Error(rt(349));Fu&30||eA(r,t,s)}return s}function eA(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=tn.updateQueue,t===null?(t={lastEffect:null,stores:null},tn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function tA(e,t,r,n){t.value=r,t.getSnapshot=n,nA(t)&&sA(e)}function rA(e,t,r){return r(function(){nA(t)&&sA(e)})}function nA(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Mi(e,r)}catch{return!0}}function sA(e){var t=ml(e,1);t!==null&&Ri(t,e,1,-1)}function q3(e){var t=ao();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:O0,lastRenderedState:e},t.queue=e,e=e.dispatch=P7.bind(null,tn,e),[t.memoizedState,e]}function M0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=tn.updateQueue,t===null?(t={lastEffect:null,stores:null},tn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function aA(){return ai().memoizedState}function bg(e,t,r,n){var s=ao();tn.flags|=e,s.memoizedState=M0(1|t,r,void 0,n===void 0?null:n)}function fx(e,t,r,n){var s=ai();n=n===void 0?null:n;var a=void 0;if(Vn!==null){var i=Vn.memoizedState;if(a=i.destroy,n!==null&&H5(n,i.deps)){s.memoizedState=M0(t,r,a,n);return}}tn.flags|=e,s.memoizedState=M0(1|t,r,a,n)}function W3(e,t){return bg(8390656,8,e,t)}function V5(e,t){return fx(2048,8,e,t)}function iA(e,t){return fx(4,2,e,t)}function oA(e,t){return fx(4,4,e,t)}function lA(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function cA(e,t,r){return r=r!=null?r.concat([e]):null,fx(4,4,lA.bind(null,t,e),r)}function K5(){}function uA(e,t){var r=ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&H5(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function dA(e,t){var r=ai();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&H5(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function fA(e,t,r){return Fu&21?(Mi(r,t)||(r=x6(),tn.lanes|=r,Du|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,da=!0),e.memoizedState=r)}function C7(e,t){var r=jr;jr=r!==0&&4>r?r:4,e(!0);var n=z2.transition;z2.transition={};try{e(!1),t()}finally{jr=r,z2.transition=n}}function hA(){return ai().memoizedState}function T7(e,t,r){var n=bc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},pA(e))mA(t,r);else if(r=Y6(e,t,r,n),r!==null){var s=ea();Ri(r,e,n,s),gA(r,t,n)}}function P7(e,t,r){var n=bc(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(pA(e))mA(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Mi(o,i)){var l=t.interleaved;l===null?(s.next=s,M5(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=Y6(e,t,s,n),r!==null&&(s=ea(),Ri(r,e,n,s),gA(r,t,n))}}function pA(e){var t=e.alternate;return e===tn||t!==null&&t===tn}function mA(e,t){Zh=d1=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function gA(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,k5(e,r)}}var f1={readContext:si,useCallback:ks,useContext:ks,useEffect:ks,useImperativeHandle:ks,useInsertionEffect:ks,useLayoutEffect:ks,useMemo:ks,useReducer:ks,useRef:ks,useState:ks,useDebugValue:ks,useDeferredValue:ks,useTransition:ks,useMutableSource:ks,useSyncExternalStore:ks,useId:ks,unstable_isNewReconciler:!1},L7={readContext:si,useCallback:function(e,t){return ao().memoizedState=[e,t===void 0?null:t],e},useContext:si,useEffect:W3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,bg(4194308,4,lA.bind(null,t,e),r)},useLayoutEffect:function(e,t){return bg(4194308,4,e,t)},useInsertionEffect:function(e,t){return bg(4,2,e,t)},useMemo:function(e,t){var r=ao();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=ao();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=T7.bind(null,tn,e),[n.memoizedState,e]},useRef:function(e){var t=ao();return e={current:e},t.memoizedState=e},useState:q3,useDebugValue:K5,useDeferredValue:function(e){return ao().memoizedState=e},useTransition:function(){var e=q3(!1),t=e[0];return e=C7.bind(null,e[1]),ao().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=tn,s=ao();if(Qr){if(r===void 0)throw Error(rt(407));r=r()}else{if(r=t(),ns===null)throw Error(rt(349));Fu&30||eA(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,W3(rA.bind(null,n,a,e),[e]),n.flags|=2048,M0(9,tA.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=ao(),t=ns.identifierPrefix;if(Qr){var r=nl,n=rl;r=(n&~(1<<32-Di(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=I0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=j7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},F7={readContext:si,useCallback:uA,useContext:si,useEffect:V5,useImperativeHandle:cA,useInsertionEffect:iA,useLayoutEffect:oA,useMemo:dA,useReducer:H2,useRef:aA,useState:function(){return H2(O0)},useDebugValue:K5,useDeferredValue:function(e){var t=ai();return fA(t,Vn.memoizedState,e)},useTransition:function(){var e=H2(O0)[0],t=ai().memoizedState;return[e,t]},useMutableSource:Q6,useSyncExternalStore:Z6,useId:hA,unstable_isNewReconciler:!1},D7={readContext:si,useCallback:uA,useContext:si,useEffect:V5,useImperativeHandle:cA,useInsertionEffect:iA,useLayoutEffect:oA,useMemo:dA,useReducer:q2,useRef:aA,useState:function(){return q2(O0)},useDebugValue:K5,useDeferredValue:function(e){var t=ai();return Vn===null?t.memoizedState=e:fA(t,Vn.memoizedState,e)},useTransition:function(){var e=q2(O0)[0],t=ai().memoizedState;return[e,t]},useMutableSource:Q6,useSyncExternalStore:Z6,useId:hA,unstable_isNewReconciler:!1};function wi(e,t){if(e&&e.defaultProps){t=rn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Cy(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:rn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var hx={isMounted:function(e){return(e=e._reactInternals)?Vu(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=ea(),s=bc(e),a=ol(n,s);a.payload=t,r!=null&&(a.callback=r),t=yc(e,a,s),t!==null&&(Ri(t,e,s,n),yg(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=ea(),s=bc(e),a=ol(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=yc(e,a,s),t!==null&&(Ri(t,e,s,n),yg(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ea(),n=bc(e),s=ol(r,n);s.tag=2,t!=null&&(s.callback=t),t=yc(e,s,n),t!==null&&(Ri(t,e,n,r),yg(t,e,n))}};function V3(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!T0(r,n)||!T0(s,a):!0}function xA(e,t,r){var n=!1,s=Ac,a=t.contextType;return typeof a=="object"&&a!==null?a=si(a):(s=ha(t)?Pu:Bs.current,n=t.contextTypes,a=(n=n!=null)?Nf(e,s):Ac),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=hx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function K3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&hx.enqueueReplaceState(t,t.state,null)}function Ty(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},B5(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=si(a):(a=ha(t)?Pu:Bs.current,s.context=Nf(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Cy(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&hx.enqueueReplaceState(s,s.state,null),c1(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ef(e,t){try{var r="",n=t;do r+=lF(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function W2(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Py(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var R7=typeof WeakMap=="function"?WeakMap:Map;function vA(e,t,r){r=ol(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){p1||(p1=!0,$y=n),Py(e,t)},r}function yA(e,t,r){r=ol(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Py(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Py(e,t),typeof n!="function"&&(wc===null?wc=new Set([this]):wc.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function G3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new R7;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=Y7.bind(null,e,t,r),t.then(e,e))}function Y3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function X3(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ol(-1,1),t.tag=2,yc(r,t,1))),r.lanes|=1),e)}var I7=bl.ReactCurrentOwner,da=!1;function Gs(e,t,r,n){t.child=e===null?G6(t,null,r,n):kf(t,e.child,r,n)}function J3(e,t,r,n,s){r=r.render;var a=t.ref;return Jd(t,s),n=q5(e,t,r,n,a,s),r=W5(),e!==null&&!da?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gl(e,t,s)):(Qr&&r&&L5(t),t.flags|=1,Gs(e,t,n,s),t.child)}function Q3(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!tb(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,wA(e,t,a,n,s)):(e=_g(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:T0,r(i,n)&&e.ref===t.ref)return gl(e,t,s)}return t.flags|=1,e=Nc(a,n),e.ref=t.ref,e.return=t,t.child=e}function wA(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(T0(a,n)&&e.ref===t.ref)if(da=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(da=!0);else return t.lanes=e.lanes,gl(e,t,s)}return Ly(e,t,r,n,s)}function bA(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},$r(qd,Ca),Ca|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,$r(qd,Ca),Ca|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,$r(qd,Ca),Ca|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,$r(qd,Ca),Ca|=n;return Gs(e,t,s,r),t.child}function NA(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ly(e,t,r,n,s){var a=ha(r)?Pu:Bs.current;return a=Nf(t,a),Jd(t,s),r=q5(e,t,r,n,a,s),n=W5(),e!==null&&!da?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,gl(e,t,s)):(Qr&&n&&L5(t),t.flags|=1,Gs(e,t,r,s),t.child)}function Z3(e,t,r,n,s){if(ha(r)){var a=!0;s1(t)}else a=!1;if(Jd(t,s),t.stateNode===null)Ng(e,t),xA(t,r,n),Ty(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=si(u):(u=ha(r)?Pu:Bs.current,u=Nf(t,u));var d=r.getDerivedStateFromProps,f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";f||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&K3(t,i,n,u),Yl=!1;var p=t.memoizedState;i.state=p,c1(t,n,i,s),l=t.memoizedState,o!==n||p!==l||fa.current||Yl?(typeof d=="function"&&(Cy(t,r,d,n),l=t.memoizedState),(o=Yl||V3(t,r,o,n,p,l,u))?(f||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,X6(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:wi(t.type,o),i.props=u,f=t.pendingProps,p=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=si(l):(l=ha(r)?Pu:Bs.current,l=Nf(t,l));var h=r.getDerivedStateFromProps;(d=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==f||p!==l)&&K3(t,i,n,l),Yl=!1,p=t.memoizedState,i.state=p,c1(t,n,i,s);var m=t.memoizedState;o!==f||p!==m||fa.current||Yl?(typeof h=="function"&&(Cy(t,r,h,n),m=t.memoizedState),(u=Yl||V3(t,r,u,n,p,m,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return Fy(e,t,r,n,a,s)}function Fy(e,t,r,n,s,a){NA(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&M3(t,r,!1),gl(e,t,a);n=t.stateNode,I7.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=kf(t,e.child,null,a),t.child=kf(t,null,o,a)):Gs(e,t,o,a),t.memoizedState=n.state,s&&M3(t,r,!0),t.child}function SA(e){var t=e.stateNode;t.pendingContext?O3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&O3(e,t.context,!1),U5(e,t.containerInfo)}function eN(e,t,r,n,s){return Sf(),D5(s),t.flags|=256,Gs(e,t,r,n),t.child}var Dy={dehydrated:null,treeContext:null,retryLane:0};function Ry(e){return{baseLanes:e,cachePool:null,transitions:null}}function kA(e,t,r){var n=t.pendingProps,s=en.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),$r(en,s&1),e===null)return Ay(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=gx(i,n,0,null),e=wu(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Ry(r),t.memoizedState=Dy,e):G5(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return O7(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Nc(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Nc(o,a):(a=wu(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Ry(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Dy,n}return a=e.child,e=a.sibling,n=Nc(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function G5(e,t){return t=gx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Cm(e,t,r,n){return n!==null&&D5(n),kf(t,e.child,null,r),e=G5(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function O7(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=W2(Error(rt(422))),Cm(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=gx({mode:"visible",children:n.children},s,0,null),a=wu(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&kf(t,e.child,null,i),t.child.memoizedState=Ry(i),t.memoizedState=Dy,a);if(!(t.mode&1))return Cm(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(rt(419)),n=W2(a,n,void 0),Cm(e,t,i,n)}if(o=(i&e.childLanes)!==0,da||o){if(n=ns,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,ml(e,s),Ri(n,e,s,-1))}return eb(),n=W2(Error(rt(421))),Cm(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=X7.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,La=vc(s.nextSibling),Da=t,Qr=!0,ji=null,e!==null&&(Ja[Qa++]=rl,Ja[Qa++]=nl,Ja[Qa++]=Lu,rl=e.id,nl=e.overflow,Lu=t),t=G5(t,n.children),t.flags|=4096,t)}function tN(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),jy(e.return,t,r)}function V2(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function _A(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Gs(e,t,n.children,r),n=en.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&tN(e,r,t);else if(e.tag===19)tN(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if($r(en,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&u1(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),V2(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&u1(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}V2(t,!0,r,null,a);break;case"together":V2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ng(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function gl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Du|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(rt(153));if(t.child!==null){for(e=t.child,r=Nc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Nc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function M7(e,t,r){switch(t.tag){case 3:SA(t),Sf();break;case 5:J6(t);break;case 1:ha(t.type)&&s1(t);break;case 4:U5(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;$r(o1,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?($r(en,en.current&1),t.flags|=128,null):r&t.child.childLanes?kA(e,t,r):($r(en,en.current&1),e=gl(e,t,r),e!==null?e.sibling:null);$r(en,en.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return _A(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),$r(en,en.current),n)break;return null;case 22:case 23:return t.lanes=0,bA(e,t,r)}return gl(e,t,r)}var EA,Iy,AA,jA;EA=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Iy=function(){};AA=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,cu(xo.current);var a=null;switch(r){case"input":s=sy(e,s),n=sy(e,n),a=[];break;case"select":s=rn({},s,{value:void 0}),n=rn({},n,{value:void 0}),a=[];break;case"textarea":s=oy(e,s),n=oy(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=r1)}cy(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(S0.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(S0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&qr("scroll",e),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};jA=function(e,t,r,n){r!==n&&(t.flags|=4)};function _h(e,t){if(!Qr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function _s(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function B7(e,t,r){var n=t.pendingProps;switch(F5(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return _s(t),null;case 1:return ha(t.type)&&n1(),_s(t),null;case 3:return n=t.stateNode,_f(),Gr(fa),Gr(Bs),z5(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Am(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ji!==null&&(qy(ji),ji=null))),Iy(e,t),_s(t),null;case 5:$5(t);var s=cu(R0.current);if(r=t.type,e!==null&&t.stateNode!=null)AA(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(rt(166));return _s(t),null}if(e=cu(xo.current),Am(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[uo]=t,n[F0]=a,e=(t.mode&1)!==0,r){case"dialog":qr("cancel",n),qr("close",n);break;case"iframe":case"object":case"embed":qr("load",n);break;case"video":case"audio":for(s=0;s<Mh.length;s++)qr(Mh[s],n);break;case"source":qr("error",n);break;case"img":case"image":case"link":qr("error",n),qr("load",n);break;case"details":qr("toggle",n);break;case"input":u3(n,a),qr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},qr("invalid",n);break;case"textarea":f3(n,a),qr("invalid",n)}cy(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Em(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Em(n.textContent,o,e),s=["children",""+o]):S0.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&qr("scroll",n)}switch(r){case"input":vm(n),d3(n,a,!0);break;case"textarea":vm(n),h3(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=r1)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=r6(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[uo]=t,e[F0]=n,EA(e,t,!1,!1),t.stateNode=e;e:{switch(i=uy(r,n),r){case"dialog":qr("cancel",e),qr("close",e),s=n;break;case"iframe":case"object":case"embed":qr("load",e),s=n;break;case"video":case"audio":for(s=0;s<Mh.length;s++)qr(Mh[s],e);s=n;break;case"source":qr("error",e),s=n;break;case"img":case"image":case"link":qr("error",e),qr("load",e),s=n;break;case"details":qr("toggle",e),s=n;break;case"input":u3(e,n),s=sy(e,n),qr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=rn({},n,{value:void 0}),qr("invalid",e);break;case"textarea":f3(e,n),s=oy(e,n),qr("invalid",e);break;default:s=n}cy(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?a6(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&n6(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&k0(e,l):typeof l=="number"&&k0(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(S0.hasOwnProperty(a)?l!=null&&a==="onScroll"&&qr("scroll",e):l!=null&&v5(e,a,l,i))}switch(r){case"input":vm(e),d3(e,n,!1);break;case"textarea":vm(e),h3(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Ec(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Kd(e,!!n.multiple,a,!1):n.defaultValue!=null&&Kd(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=r1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return _s(t),null;case 6:if(e&&t.stateNode!=null)jA(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(rt(166));if(r=cu(R0.current),cu(xo.current),Am(t)){if(n=t.stateNode,r=t.memoizedProps,n[uo]=t,(a=n.nodeValue!==r)&&(e=Da,e!==null))switch(e.tag){case 3:Em(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Em(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[uo]=t,t.stateNode=n}return _s(t),null;case 13:if(Gr(en),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Qr&&La!==null&&t.mode&1&&!(t.flags&128))V6(),Sf(),t.flags|=98560,a=!1;else if(a=Am(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(rt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(rt(317));a[uo]=t}else Sf(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;_s(t),a=!1}else ji!==null&&(qy(ji),ji=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||en.current&1?Gn===0&&(Gn=3):eb())),t.updateQueue!==null&&(t.flags|=4),_s(t),null);case 4:return _f(),Iy(e,t),e===null&&P0(t.stateNode.containerInfo),_s(t),null;case 10:return O5(t.type._context),_s(t),null;case 17:return ha(t.type)&&n1(),_s(t),null;case 19:if(Gr(en),a=t.memoizedState,a===null)return _s(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)_h(a,!1);else{if(Gn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=u1(e),i!==null){for(t.flags|=128,_h(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return $r(en,en.current&1|2),t.child}e=e.sibling}a.tail!==null&&wn()>Af&&(t.flags|=128,n=!0,_h(a,!1),t.lanes=4194304)}else{if(!n)if(e=u1(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),_h(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Qr)return _s(t),null}else 2*wn()-a.renderingStartTime>Af&&r!==1073741824&&(t.flags|=128,n=!0,_h(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=wn(),t.sibling=null,r=en.current,$r(en,n?r&1|2:r&1),t):(_s(t),null);case 22:case 23:return Z5(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Ca&1073741824&&(_s(t),t.subtreeFlags&6&&(t.flags|=8192)):_s(t),null;case 24:return null;case 25:return null}throw Error(rt(156,t.tag))}function U7(e,t){switch(F5(t),t.tag){case 1:return ha(t.type)&&n1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return _f(),Gr(fa),Gr(Bs),z5(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return $5(t),null;case 13:if(Gr(en),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(rt(340));Sf()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Gr(en),null;case 4:return _f(),null;case 10:return O5(t.type._context),null;case 22:case 23:return Z5(),null;case 24:return null;default:return null}}var Tm=!1,Ls=!1,$7=typeof WeakSet=="function"?WeakSet:Set,yt=null;function Hd(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){un(e,t,n)}else r.current=null}function Oy(e,t,r){try{r()}catch(n){un(e,t,n)}}var rN=!1;function z7(e,t){if(wy=Zg,e=F6(),P5(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,d=0,f=e,p=null;t:for(;;){for(var h;f!==r||s!==0&&f.nodeType!==3||(o=i+s),f!==a||n!==0&&f.nodeType!==3||(l=i+n),f.nodeType===3&&(i+=f.nodeValue.length),(h=f.firstChild)!==null;)p=f,f=h;for(;;){if(f===e)break t;if(p===r&&++u===s&&(o=i),p===a&&++d===n&&(l=i),(h=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(by={focusedElem:e,selectionRange:r},Zg=!1,yt=t;yt!==null;)if(t=yt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,yt=e;else for(;yt!==null;){t=yt;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:wi(t.type,g),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(rt(163))}}catch(N){un(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,yt=e;break}yt=t.return}return m=rN,rN=!1,m}function e0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Oy(t,r,a)}s=s.next}while(s!==n)}}function px(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function My(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function CA(e){var t=e.alternate;t!==null&&(e.alternate=null,CA(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[uo],delete t[F0],delete t[ky],delete t[k7],delete t[_7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function TA(e){return e.tag===5||e.tag===3||e.tag===4}function nN(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||TA(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function By(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=r1));else if(n!==4&&(e=e.child,e!==null))for(By(e,t,r),e=e.sibling;e!==null;)By(e,t,r),e=e.sibling}function Uy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Uy(e,t,r),e=e.sibling;e!==null;)Uy(e,t,r),e=e.sibling}var fs=null,ki=!1;function $l(e,t,r){for(r=r.child;r!==null;)PA(e,t,r),r=r.sibling}function PA(e,t,r){if(go&&typeof go.onCommitFiberUnmount=="function")try{go.onCommitFiberUnmount(ix,r)}catch{}switch(r.tag){case 5:Ls||Hd(r,t);case 6:var n=fs,s=ki;fs=null,$l(e,t,r),fs=n,ki=s,fs!==null&&(ki?(e=fs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):fs.removeChild(r.stateNode));break;case 18:fs!==null&&(ki?(e=fs,r=r.stateNode,e.nodeType===8?B2(e.parentNode,r):e.nodeType===1&&B2(e,r),j0(e)):B2(fs,r.stateNode));break;case 4:n=fs,s=ki,fs=r.stateNode.containerInfo,ki=!0,$l(e,t,r),fs=n,ki=s;break;case 0:case 11:case 14:case 15:if(!Ls&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Oy(r,t,i),s=s.next}while(s!==n)}$l(e,t,r);break;case 1:if(!Ls&&(Hd(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){un(r,t,o)}$l(e,t,r);break;case 21:$l(e,t,r);break;case 22:r.mode&1?(Ls=(n=Ls)||r.memoizedState!==null,$l(e,t,r),Ls=n):$l(e,t,r);break;default:$l(e,t,r)}}function sN(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new $7),t.forEach(function(n){var s=J7.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function gi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:fs=o.stateNode,ki=!1;break e;case 3:fs=o.stateNode.containerInfo,ki=!0;break e;case 4:fs=o.stateNode.containerInfo,ki=!0;break e}o=o.return}if(fs===null)throw Error(rt(160));PA(a,i,s),fs=null,ki=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){un(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)LA(t,e),t=t.sibling}function LA(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gi(t,e),Qi(e),n&4){try{e0(3,e,e.return),px(3,e)}catch(g){un(e,e.return,g)}try{e0(5,e,e.return)}catch(g){un(e,e.return,g)}}break;case 1:gi(t,e),Qi(e),n&512&&r!==null&&Hd(r,r.return);break;case 5:if(gi(t,e),Qi(e),n&512&&r!==null&&Hd(r,r.return),e.flags&32){var s=e.stateNode;try{k0(s,"")}catch(g){un(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&e6(s,a),uy(o,i);var u=uy(o,a);for(i=0;i<l.length;i+=2){var d=l[i],f=l[i+1];d==="style"?a6(s,f):d==="dangerouslySetInnerHTML"?n6(s,f):d==="children"?k0(s,f):v5(s,d,f,u)}switch(o){case"input":ay(s,a);break;case"textarea":t6(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?Kd(s,!!a.multiple,h,!1):p!==!!a.multiple&&(a.defaultValue!=null?Kd(s,!!a.multiple,a.defaultValue,!0):Kd(s,!!a.multiple,a.multiple?[]:"",!1))}s[F0]=a}catch(g){un(e,e.return,g)}}break;case 6:if(gi(t,e),Qi(e),n&4){if(e.stateNode===null)throw Error(rt(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){un(e,e.return,g)}}break;case 3:if(gi(t,e),Qi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{j0(t.containerInfo)}catch(g){un(e,e.return,g)}break;case 4:gi(t,e),Qi(e);break;case 13:gi(t,e),Qi(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(J5=wn())),n&4&&sN(e);break;case 22:if(d=r!==null&&r.memoizedState!==null,e.mode&1?(Ls=(u=Ls)||d,gi(t,e),Ls=u):gi(t,e),Qi(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(yt=e,d=e.child;d!==null;){for(f=yt=d;yt!==null;){switch(p=yt,h=p.child,p.tag){case 0:case 11:case 14:case 15:e0(4,p,p.return);break;case 1:Hd(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){un(n,r,g)}}break;case 5:Hd(p,p.return);break;case 22:if(p.memoizedState!==null){iN(f);continue}}h!==null?(h.return=p,yt=h):iN(f)}d=d.sibling}e:for(d=null,f=e;;){if(f.tag===5){if(d===null){d=f;try{s=f.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=f.stateNode,l=f.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=s6("display",i))}catch(g){un(e,e.return,g)}}}else if(f.tag===6){if(d===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(g){un(e,e.return,g)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===e)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;f.sibling===null;){if(f.return===null||f.return===e)break e;d===f&&(d=null),f=f.return}d===f&&(d=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gi(t,e),Qi(e),n&4&&sN(e);break;case 21:break;default:gi(t,e),Qi(e)}}function Qi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(TA(r)){var n=r;break e}r=r.return}throw Error(rt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(k0(s,""),n.flags&=-33);var a=nN(e);Uy(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=nN(e);By(e,o,i);break;default:throw Error(rt(161))}}catch(l){un(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function H7(e,t,r){yt=e,FA(e)}function FA(e,t,r){for(var n=(e.mode&1)!==0;yt!==null;){var s=yt,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Tm;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Ls;o=Tm;var u=Ls;if(Tm=i,(Ls=l)&&!u)for(yt=s;yt!==null;)i=yt,l=i.child,i.tag===22&&i.memoizedState!==null?oN(s):l!==null?(l.return=i,yt=l):oN(s);for(;a!==null;)yt=a,FA(a),a=a.sibling;yt=s,Tm=o,Ls=u}aN(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,yt=a):aN(e)}}function aN(e){for(;yt!==null;){var t=yt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ls||px(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Ls)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:wi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&H3(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}H3(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var f=d.dehydrated;f!==null&&j0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(rt(163))}Ls||t.flags&512&&My(t)}catch(p){un(t,t.return,p)}}if(t===e){yt=null;break}if(r=t.sibling,r!==null){r.return=t.return,yt=r;break}yt=t.return}}function iN(e){for(;yt!==null;){var t=yt;if(t===e){yt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,yt=r;break}yt=t.return}}function oN(e){for(;yt!==null;){var t=yt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{px(4,t)}catch(l){un(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){un(t,s,l)}}var a=t.return;try{My(t)}catch(l){un(t,a,l)}break;case 5:var i=t.return;try{My(t)}catch(l){un(t,i,l)}}}catch(l){un(t,t.return,l)}if(t===e){yt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,yt=o;break}yt=t.return}}var q7=Math.ceil,h1=bl.ReactCurrentDispatcher,Y5=bl.ReactCurrentOwner,ri=bl.ReactCurrentBatchConfig,vr=0,ns=null,Fn=null,gs=0,Ca=0,qd=Ic(0),Gn=0,B0=null,Du=0,mx=0,X5=0,t0=null,ua=null,J5=0,Af=1/0,Xo=null,p1=!1,$y=null,wc=null,Pm=!1,cc=null,m1=0,r0=0,zy=null,Sg=-1,kg=0;function ea(){return vr&6?wn():Sg!==-1?Sg:Sg=wn()}function bc(e){return e.mode&1?vr&2&&gs!==0?gs&-gs:A7.transition!==null?(kg===0&&(kg=x6()),kg):(e=jr,e!==0||(e=window.event,e=e===void 0?16:k6(e.type)),e):1}function Ri(e,t,r,n){if(50<r0)throw r0=0,zy=null,Error(rt(185));yp(e,r,n),(!(vr&2)||e!==ns)&&(e===ns&&(!(vr&2)&&(mx|=r),Gn===4&&Zl(e,gs)),pa(e,n),r===1&&vr===0&&!(t.mode&1)&&(Af=wn()+500,dx&&Oc()))}function pa(e,t){var r=e.callbackNode;AF(e,t);var n=Qg(e,e===ns?gs:0);if(n===0)r!==null&&g3(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&g3(r),t===1)e.tag===0?E7(lN.bind(null,e)):H6(lN.bind(null,e)),N7(function(){!(vr&6)&&Oc()}),r=null;else{switch(v6(n)){case 1:r=S5;break;case 4:r=m6;break;case 16:r=Jg;break;case 536870912:r=g6;break;default:r=Jg}r=$A(r,DA.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function DA(e,t){if(Sg=-1,kg=0,vr&6)throw Error(rt(327));var r=e.callbackNode;if(Qd()&&e.callbackNode!==r)return null;var n=Qg(e,e===ns?gs:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=g1(e,n);else{t=n;var s=vr;vr|=2;var a=IA();(ns!==e||gs!==t)&&(Xo=null,Af=wn()+500,yu(e,t));do try{K7();break}catch(o){RA(e,o)}while(!0);I5(),h1.current=a,vr=s,Fn!==null?t=0:(ns=null,gs=0,t=Gn)}if(t!==0){if(t===2&&(s=my(e),s!==0&&(n=s,t=Hy(e,s))),t===1)throw r=B0,yu(e,0),Zl(e,n),pa(e,wn()),r;if(t===6)Zl(e,n);else{if(s=e.current.alternate,!(n&30)&&!W7(s)&&(t=g1(e,n),t===2&&(a=my(e),a!==0&&(n=a,t=Hy(e,a))),t===1))throw r=B0,yu(e,0),Zl(e,n),pa(e,wn()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(rt(345));case 2:ru(e,ua,Xo);break;case 3:if(Zl(e,n),(n&130023424)===n&&(t=J5+500-wn(),10<t)){if(Qg(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){ea(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Sy(ru.bind(null,e,ua,Xo),t);break}ru(e,ua,Xo);break;case 4:if(Zl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-Di(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=wn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*q7(n/1960))-n,10<n){e.timeoutHandle=Sy(ru.bind(null,e,ua,Xo),n);break}ru(e,ua,Xo);break;case 5:ru(e,ua,Xo);break;default:throw Error(rt(329))}}}return pa(e,wn()),e.callbackNode===r?DA.bind(null,e):null}function Hy(e,t){var r=t0;return e.current.memoizedState.isDehydrated&&(yu(e,t).flags|=256),e=g1(e,t),e!==2&&(t=ua,ua=r,t!==null&&qy(t)),e}function qy(e){ua===null?ua=e:ua.push.apply(ua,e)}function W7(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Mi(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zl(e,t){for(t&=~X5,t&=~mx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Di(t),n=1<<r;e[r]=-1,t&=~n}}function lN(e){if(vr&6)throw Error(rt(327));Qd();var t=Qg(e,0);if(!(t&1))return pa(e,wn()),null;var r=g1(e,t);if(e.tag!==0&&r===2){var n=my(e);n!==0&&(t=n,r=Hy(e,n))}if(r===1)throw r=B0,yu(e,0),Zl(e,t),pa(e,wn()),r;if(r===6)throw Error(rt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,ru(e,ua,Xo),pa(e,wn()),null}function Q5(e,t){var r=vr;vr|=1;try{return e(t)}finally{vr=r,vr===0&&(Af=wn()+500,dx&&Oc())}}function Ru(e){cc!==null&&cc.tag===0&&!(vr&6)&&Qd();var t=vr;vr|=1;var r=ri.transition,n=jr;try{if(ri.transition=null,jr=1,e)return e()}finally{jr=n,ri.transition=r,vr=t,!(vr&6)&&Oc()}}function Z5(){Ca=qd.current,Gr(qd)}function yu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,b7(r)),Fn!==null)for(r=Fn.return;r!==null;){var n=r;switch(F5(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&n1();break;case 3:_f(),Gr(fa),Gr(Bs),z5();break;case 5:$5(n);break;case 4:_f();break;case 13:Gr(en);break;case 19:Gr(en);break;case 10:O5(n.type._context);break;case 22:case 23:Z5()}r=r.return}if(ns=e,Fn=e=Nc(e.current,null),gs=Ca=t,Gn=0,B0=null,X5=mx=Du=0,ua=t0=null,lu!==null){for(t=0;t<lu.length;t++)if(r=lu[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}lu=null}return e}function RA(e,t){do{var r=Fn;try{if(I5(),wg.current=f1,d1){for(var n=tn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}d1=!1}if(Fu=0,es=Vn=tn=null,Zh=!1,I0=0,Y5.current=null,r===null||r.return===null){Gn=1,B0=t,Fn=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=gs,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,f=d.tag;if(!(d.mode&1)&&(f===0||f===11||f===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var h=Y3(i);if(h!==null){h.flags&=-257,X3(h,i,o,a,t),h.mode&1&&G3(a,u,t),t=h,l=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if(!(t&1)){G3(a,u,t),eb();break e}l=Error(rt(426))}}else if(Qr&&o.mode&1){var y=Y3(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),X3(y,i,o,a,t),D5(Ef(l,o));break e}}a=l=Ef(l,o),Gn!==4&&(Gn=2),t0===null?t0=[a]:t0.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=vA(a,l,t);z3(a,x);break e;case 1:o=l;var w=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(wc===null||!wc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var N=yA(a,o,t);z3(a,N);break e}}a=a.return}while(a!==null)}MA(r)}catch(A){t=A,Fn===r&&r!==null&&(Fn=r=r.return);continue}break}while(!0)}function IA(){var e=h1.current;return h1.current=f1,e===null?f1:e}function eb(){(Gn===0||Gn===3||Gn===2)&&(Gn=4),ns===null||!(Du&268435455)&&!(mx&268435455)||Zl(ns,gs)}function g1(e,t){var r=vr;vr|=2;var n=IA();(ns!==e||gs!==t)&&(Xo=null,yu(e,t));do try{V7();break}catch(s){RA(e,s)}while(!0);if(I5(),vr=r,h1.current=n,Fn!==null)throw Error(rt(261));return ns=null,gs=0,Gn}function V7(){for(;Fn!==null;)OA(Fn)}function K7(){for(;Fn!==null&&!vF();)OA(Fn)}function OA(e){var t=UA(e.alternate,e,Ca);e.memoizedProps=e.pendingProps,t===null?MA(e):Fn=t,Y5.current=null}function MA(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=U7(r,t),r!==null){r.flags&=32767,Fn=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Gn=6,Fn=null;return}}else if(r=B7(r,t,Ca),r!==null){Fn=r;return}if(t=t.sibling,t!==null){Fn=t;return}Fn=t=e}while(t!==null);Gn===0&&(Gn=5)}function ru(e,t,r){var n=jr,s=ri.transition;try{ri.transition=null,jr=1,G7(e,t,r,n)}finally{ri.transition=s,jr=n}return null}function G7(e,t,r,n){do Qd();while(cc!==null);if(vr&6)throw Error(rt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(rt(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(jF(e,a),e===ns&&(Fn=ns=null,gs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Pm||(Pm=!0,$A(Jg,function(){return Qd(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=ri.transition,ri.transition=null;var i=jr;jr=1;var o=vr;vr|=4,Y5.current=null,z7(e,r),LA(r,e),p7(by),Zg=!!wy,by=wy=null,e.current=r,H7(r),yF(),vr=o,jr=i,ri.transition=a}else e.current=r;if(Pm&&(Pm=!1,cc=e,m1=s),a=e.pendingLanes,a===0&&(wc=null),NF(r.stateNode),pa(e,wn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(p1)throw p1=!1,e=$y,$y=null,e;return m1&1&&e.tag!==0&&Qd(),a=e.pendingLanes,a&1?e===zy?r0++:(r0=0,zy=e):r0=0,Oc(),null}function Qd(){if(cc!==null){var e=v6(m1),t=ri.transition,r=jr;try{if(ri.transition=null,jr=16>e?16:e,cc===null)var n=!1;else{if(e=cc,cc=null,m1=0,vr&6)throw Error(rt(331));var s=vr;for(vr|=4,yt=e.current;yt!==null;){var a=yt,i=a.child;if(yt.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(yt=u;yt!==null;){var d=yt;switch(d.tag){case 0:case 11:case 15:e0(8,d,a)}var f=d.child;if(f!==null)f.return=d,yt=f;else for(;yt!==null;){d=yt;var p=d.sibling,h=d.return;if(CA(d),d===u){yt=null;break}if(p!==null){p.return=h,yt=p;break}yt=h}}}var m=a.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}yt=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,yt=i;else e:for(;yt!==null;){if(a=yt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:e0(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,yt=x;break e}yt=a.return}}var w=e.current;for(yt=w;yt!==null;){i=yt;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,yt=b;else e:for(i=w;yt!==null;){if(o=yt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:px(9,o)}}catch(A){un(o,o.return,A)}if(o===i){yt=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,yt=N;break e}yt=o.return}}if(vr=s,Oc(),go&&typeof go.onPostCommitFiberRoot=="function")try{go.onPostCommitFiberRoot(ix,e)}catch{}n=!0}return n}finally{jr=r,ri.transition=t}}return!1}function cN(e,t,r){t=Ef(r,t),t=vA(e,t,1),e=yc(e,t,1),t=ea(),e!==null&&(yp(e,1,t),pa(e,t))}function un(e,t,r){if(e.tag===3)cN(e,e,r);else for(;t!==null;){if(t.tag===3){cN(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(wc===null||!wc.has(n))){e=Ef(r,e),e=yA(t,e,1),t=yc(t,e,1),e=ea(),t!==null&&(yp(t,1,e),pa(t,e));break}}t=t.return}}function Y7(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=ea(),e.pingedLanes|=e.suspendedLanes&r,ns===e&&(gs&r)===r&&(Gn===4||Gn===3&&(gs&130023424)===gs&&500>wn()-J5?yu(e,0):X5|=r),pa(e,t)}function BA(e,t){t===0&&(e.mode&1?(t=bm,bm<<=1,!(bm&130023424)&&(bm=4194304)):t=1);var r=ea();e=ml(e,t),e!==null&&(yp(e,t,r),pa(e,r))}function X7(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),BA(e,r)}function J7(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(rt(314))}n!==null&&n.delete(t),BA(e,r)}var UA;UA=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||fa.current)da=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return da=!1,M7(e,t,r);da=!!(e.flags&131072)}else da=!1,Qr&&t.flags&1048576&&q6(t,i1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ng(e,t),e=t.pendingProps;var s=Nf(t,Bs.current);Jd(t,r),s=q5(null,t,n,e,s,r);var a=W5();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ha(n)?(a=!0,s1(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,B5(t),s.updater=hx,t.stateNode=s,s._reactInternals=t,Ty(t,n,e,r),t=Fy(null,t,n,!0,a,r)):(t.tag=0,Qr&&a&&L5(t),Gs(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ng(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=Z7(n),e=wi(n,e),s){case 0:t=Ly(null,t,n,e,r);break e;case 1:t=Z3(null,t,n,e,r);break e;case 11:t=J3(null,t,n,e,r);break e;case 14:t=Q3(null,t,n,wi(n.type,e),r);break e}throw Error(rt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wi(n,s),Ly(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wi(n,s),Z3(e,t,n,s,r);case 3:e:{if(SA(t),e===null)throw Error(rt(387));n=t.pendingProps,a=t.memoizedState,s=a.element,X6(e,t),c1(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Ef(Error(rt(423)),t),t=eN(e,t,n,r,s);break e}else if(n!==s){s=Ef(Error(rt(424)),t),t=eN(e,t,n,r,s);break e}else for(La=vc(t.stateNode.containerInfo.firstChild),Da=t,Qr=!0,ji=null,r=G6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Sf(),n===s){t=gl(e,t,r);break e}Gs(e,t,n,r)}t=t.child}return t;case 5:return J6(t),e===null&&Ay(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Ny(n,s)?i=null:a!==null&&Ny(n,a)&&(t.flags|=32),NA(e,t),Gs(e,t,i,r),t.child;case 6:return e===null&&Ay(t),null;case 13:return kA(e,t,r);case 4:return U5(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=kf(t,null,n,r):Gs(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wi(n,s),J3(e,t,n,s,r);case 7:return Gs(e,t,t.pendingProps,r),t.child;case 8:return Gs(e,t,t.pendingProps.children,r),t.child;case 12:return Gs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,$r(o1,n._currentValue),n._currentValue=i,a!==null)if(Mi(a.value,i)){if(a.children===s.children&&!fa.current){t=gl(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=ol(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),jy(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(rt(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),jy(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Gs(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Jd(t,r),s=si(s),n=n(s),t.flags|=1,Gs(e,t,n,r),t.child;case 14:return n=t.type,s=wi(n,t.pendingProps),s=wi(n.type,s),Q3(e,t,n,s,r);case 15:return wA(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:wi(n,s),Ng(e,t),t.tag=1,ha(n)?(e=!0,s1(t)):e=!1,Jd(t,r),xA(t,n,s),Ty(t,n,s,r),Fy(null,t,n,!0,e,r);case 19:return _A(e,t,r);case 22:return bA(e,t,r)}throw Error(rt(156,t.tag))};function $A(e,t){return p6(e,t)}function Q7(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ti(e,t,r,n){return new Q7(e,t,r,n)}function tb(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Z7(e){if(typeof e=="function")return tb(e)?1:0;if(e!=null){if(e=e.$$typeof,e===w5)return 11;if(e===b5)return 14}return 2}function Nc(e,t){var r=e.alternate;return r===null?(r=ti(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function _g(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")tb(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Dd:return wu(r.children,s,a,t);case y5:i=8,s|=8;break;case ey:return e=ti(12,r,t,s|2),e.elementType=ey,e.lanes=a,e;case ty:return e=ti(13,r,t,s),e.elementType=ty,e.lanes=a,e;case ry:return e=ti(19,r,t,s),e.elementType=ry,e.lanes=a,e;case JE:return gx(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case YE:i=10;break e;case XE:i=9;break e;case w5:i=11;break e;case b5:i=14;break e;case Gl:i=16,n=null;break e}throw Error(rt(130,e==null?e:typeof e,""))}return t=ti(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function wu(e,t,r,n){return e=ti(7,e,n,t),e.lanes=r,e}function gx(e,t,r,n){return e=ti(22,e,n,t),e.elementType=JE,e.lanes=r,e.stateNode={isHidden:!1},e}function K2(e,t,r){return e=ti(6,e,null,t),e.lanes=r,e}function G2(e,t,r){return t=ti(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function eD(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=j2(0),this.expirationTimes=j2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=j2(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rb(e,t,r,n,s,a,i,o,l){return e=new eD(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=ti(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},B5(a),e}function tD(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fd,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function zA(e){if(!e)return Ac;e=e._reactInternals;e:{if(Vu(e)!==e||e.tag!==1)throw Error(rt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ha(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(rt(171))}if(e.tag===1){var r=e.type;if(ha(r))return z6(e,r,t)}return t}function HA(e,t,r,n,s,a,i,o,l){return e=rb(r,n,!0,e,s,a,i,o,l),e.context=zA(null),r=e.current,n=ea(),s=bc(r),a=ol(n,s),a.callback=t??null,yc(r,a,s),e.current.lanes=s,yp(e,s,n),pa(e,n),e}function xx(e,t,r,n){var s=t.current,a=ea(),i=bc(s);return r=zA(r),t.context===null?t.context=r:t.pendingContext=r,t=ol(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=yc(s,t,i),e!==null&&(Ri(e,s,i,a),yg(e,s,i)),i}function x1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function uN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function nb(e,t){uN(e,t),(e=e.alternate)&&uN(e,t)}function rD(){return null}var qA=typeof reportError=="function"?reportError:function(e){console.error(e)};function sb(e){this._internalRoot=e}vx.prototype.render=sb.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(rt(409));xx(e,t,null,null)};vx.prototype.unmount=sb.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ru(function(){xx(null,e,null,null)}),t[pl]=null}};function vx(e){this._internalRoot=e}vx.prototype.unstable_scheduleHydration=function(e){if(e){var t=b6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ql.length&&t!==0&&t<Ql[r].priority;r++);Ql.splice(r,0,e),r===0&&S6(e)}};function ab(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function yx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function dN(){}function nD(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=x1(i);a.call(u)}}var i=HA(t,n,e,0,null,!1,!1,"",dN);return e._reactRootContainer=i,e[pl]=i.current,P0(e.nodeType===8?e.parentNode:e),Ru(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=x1(l);o.call(u)}}var l=rb(e,0,!1,null,null,!1,!1,"",dN);return e._reactRootContainer=l,e[pl]=l.current,P0(e.nodeType===8?e.parentNode:e),Ru(function(){xx(t,l,r,n)}),l}function wx(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=x1(i);o.call(l)}}xx(t,i,e,s)}else i=nD(r,t,e,s,n);return x1(i)}y6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Oh(t.pendingLanes);r!==0&&(k5(t,r|1),pa(t,wn()),!(vr&6)&&(Af=wn()+500,Oc()))}break;case 13:Ru(function(){var n=ml(e,1);if(n!==null){var s=ea();Ri(n,e,1,s)}}),nb(e,1)}};_5=function(e){if(e.tag===13){var t=ml(e,134217728);if(t!==null){var r=ea();Ri(t,e,134217728,r)}nb(e,134217728)}};w6=function(e){if(e.tag===13){var t=bc(e),r=ml(e,t);if(r!==null){var n=ea();Ri(r,e,t,n)}nb(e,t)}};b6=function(){return jr};N6=function(e,t){var r=jr;try{return jr=e,t()}finally{jr=r}};fy=function(e,t,r){switch(t){case"input":if(ay(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=ux(n);if(!s)throw Error(rt(90));ZE(n),ay(n,s)}}}break;case"textarea":t6(e,r);break;case"select":t=r.value,t!=null&&Kd(e,!!r.multiple,t,!1)}};l6=Q5;c6=Ru;var sD={usingClientEntryPoint:!1,Events:[bp,Md,ux,i6,o6,Q5]},Eh={findFiberByHostInstance:ou,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},aD={bundleType:Eh.bundleType,version:Eh.version,rendererPackageName:Eh.rendererPackageName,rendererConfig:Eh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=f6(e),e===null?null:e.stateNode},findFiberByHostInstance:Eh.findFiberByHostInstance||rD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lm.isDisabled&&Lm.supportsFiber)try{ix=Lm.inject(aD),go=Lm}catch{}}Ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sD;Ma.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ab(t))throw Error(rt(200));return tD(e,t,null,r)};Ma.createRoot=function(e,t){if(!ab(e))throw Error(rt(299));var r=!1,n="",s=qA;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=rb(e,1,!1,null,null,r,!1,n,s),e[pl]=t.current,P0(e.nodeType===8?e.parentNode:e),new sb(t)};Ma.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(rt(188)):(e=Object.keys(e).join(","),Error(rt(268,e)));return e=f6(t),e=e===null?null:e.stateNode,e};Ma.flushSync=function(e){return Ru(e)};Ma.hydrate=function(e,t,r){if(!yx(t))throw Error(rt(200));return wx(null,e,t,!0,r)};Ma.hydrateRoot=function(e,t,r){if(!ab(e))throw Error(rt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=qA;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=HA(t,null,e,1,r??null,s,!1,a,i),e[pl]=t.current,P0(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new vx(t)};Ma.render=function(e,t,r){if(!yx(t))throw Error(rt(200));return wx(null,e,t,!1,r)};Ma.unmountComponentAtNode=function(e){if(!yx(e))throw Error(rt(40));return e._reactRootContainer?(Ru(function(){wx(null,null,e,!1,function(){e._reactRootContainer=null,e[pl]=null})}),!0):!1};Ma.unstable_batchedUpdates=Q5;Ma.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!yx(r))throw Error(rt(200));if(e==null||e._reactInternals===void 0)throw Error(rt(38));return wx(e,t,r,!1,n)};Ma.version="18.3.1-next-f1338f8080-20240426";function WA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(WA)}catch(e){console.error(e)}}WA(),WE.exports=Ma;var iD=WE.exports,fN=iD;Qv.createRoot=fN.createRoot,Qv.hydrateRoot=fN.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function U0(){return U0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U0.apply(this,arguments)}var uc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(uc||(uc={}));const hN="popstate";function oD(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Wy("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:v1(s)}return cD(t,r,null,e)}function kn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ib(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function lD(){return Math.random().toString(36).substr(2,8)}function pN(e,t){return{usr:e.state,key:e.key,idx:t}}function Wy(e,t,r,n){return r===void 0&&(r=null),U0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?If(t):t,{state:r,key:t&&t.key||n||lD()})}function v1(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function If(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function cD(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=uc.Pop,l=null,u=d();u==null&&(u=0,i.replaceState(U0({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){o=uc.Pop;let y=d(),x=y==null?null:y-u;u=y,l&&l({action:o,location:g.location,delta:x})}function p(y,x){o=uc.Push;let w=Wy(g.location,y,x);u=d()+1;let b=pN(w,u),N=g.createHref(w);try{i.pushState(b,"",N)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(N)}a&&l&&l({action:o,location:g.location,delta:1})}function h(y,x){o=uc.Replace;let w=Wy(g.location,y,x);u=d();let b=pN(w,u),N=g.createHref(w);i.replaceState(b,"",N),a&&l&&l({action:o,location:g.location,delta:0})}function m(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof y=="string"?y:v1(y);return w=w.replace(/ $/,"%20"),kn(x,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,x)}let g={get action(){return o},get location(){return e(s,i)},listen(y){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(hN,f),l=y,()=>{s.removeEventListener(hN,f),l=null}},createHref(y){return t(s,y)},createURL:m,encodeLocation(y){let x=m(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:h,go(y){return i.go(y)}};return g}var mN;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(mN||(mN={}));function uD(e,t,r){return r===void 0&&(r="/"),dD(e,t,r)}function dD(e,t,r,n){let s=typeof t=="string"?If(t):t,a=ob(s.pathname||"/",r);if(a==null)return null;let i=VA(e);fD(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=kD(a);o=bD(i[l],u)}return o}function VA(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(kn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=Sc([n,l.relativePath]),d=r.concat(l);a.children&&a.children.length>0&&(kn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),VA(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:yD(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of KA(a.path))s(a,i,l)}),t}function KA(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=KA(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function fD(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:wD(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const hD=/^:[\w-]+$/,pD=3,mD=2,gD=1,xD=10,vD=-2,gN=e=>e==="*";function yD(e,t){let r=e.split("/"),n=r.length;return r.some(gN)&&(n+=vD),t&&(n+=mD),r.filter(s=>!gN(s)).reduce((s,a)=>s+(hD.test(a)?pD:a===""?gD:xD),n)}function wD(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function bD(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=ND({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),p=l.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:Sc([a,f.pathname]),pathnameBase:CD(Sc([a,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(a=Sc([a,f.pathnameBase]))}return i}function ND(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=SD(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:p,isOptional:h}=d;if(p==="*"){let g=o[f]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const m=o[f];return h&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function SD(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),ib(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function kD(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ib(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ob(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const _D=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ED=e=>_D.test(e);function AD(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?If(e):e,a;if(r)if(ED(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),ib(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=xN(r.substring(1),"/"):a=xN(r,t)}else a=t;return{pathname:a,search:TD(n),hash:PD(s)}}function xN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function Y2(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function jD(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function lb(e,t){let r=jD(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function cb(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=If(e):(s=U0({},e),kn(!s.pathname||!s.pathname.includes("?"),Y2("?","pathname","search",s)),kn(!s.pathname||!s.pathname.includes("#"),Y2("#","pathname","hash",s)),kn(!s.search||!s.search.includes("#"),Y2("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),f-=1;s.pathname=p.join("/")}o=f>=0?t[f]:"/"}let l=AD(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const Sc=e=>e.join("/").replace(/\/\/+/g,"/"),CD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),TD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,PD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function LD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const GA=["post","put","patch","delete"];new Set(GA);const FD=["get",...GA];new Set(FD);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function $0(){return $0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$0.apply(this,arguments)}const ub=J.createContext(null),DD=J.createContext(null),Mc=J.createContext(null),bx=J.createContext(null),Nl=J.createContext({outlet:null,matches:[],isDataRoute:!1}),YA=J.createContext(null);function RD(e,t){let{relative:r}=t===void 0?{}:t;Of()||kn(!1);let{basename:n,navigator:s}=J.useContext(Mc),{hash:a,pathname:i,search:o}=JA(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:Sc([n,i])),s.createHref({pathname:l,search:o,hash:a})}function Of(){return J.useContext(bx)!=null}function Mf(){return Of()||kn(!1),J.useContext(bx).location}function XA(e){J.useContext(Mc).static||J.useLayoutEffect(e)}function $s(){let{isDataRoute:e}=J.useContext(Nl);return e?GD():ID()}function ID(){Of()||kn(!1);let e=J.useContext(ub),{basename:t,future:r,navigator:n}=J.useContext(Mc),{matches:s}=J.useContext(Nl),{pathname:a}=Mf(),i=JSON.stringify(lb(s,r.v7_relativeSplatPath)),o=J.useRef(!1);return XA(()=>{o.current=!0}),J.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=cb(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Sc([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,i,a,e])}function Ku(){let{matches:e}=J.useContext(Nl),t=e[e.length-1];return t?t.params:{}}function JA(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=J.useContext(Mc),{matches:s}=J.useContext(Nl),{pathname:a}=Mf(),i=JSON.stringify(lb(s,n.v7_relativeSplatPath));return J.useMemo(()=>cb(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function OD(e,t){return MD(e,t)}function MD(e,t,r,n){Of()||kn(!1);let{navigator:s}=J.useContext(Mc),{matches:a}=J.useContext(Nl),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Mf(),d;if(t){var f;let y=typeof t=="string"?If(t):t;l==="/"||(f=y.pathname)!=null&&f.startsWith(l)||kn(!1),d=y}else d=u;let p=d.pathname||"/",h=p;if(l!=="/"){let y=l.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=uD(e,{pathname:h}),g=HD(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:Sc([l,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?l:Sc([l,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return t&&g?J.createElement(bx.Provider,{value:{location:$0({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:uc.Pop}},g):g}function BD(){let e=KD(),t=LD(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return J.createElement(J.Fragment,null,J.createElement("h2",null,"Unexpected Application Error!"),J.createElement("h3",{style:{fontStyle:"italic"}},t),r?J.createElement("pre",{style:s},r):null,null)}const UD=J.createElement(BD,null);class $D extends J.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?J.createElement(Nl.Provider,{value:this.props.routeContext},J.createElement(YA.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function zD(e){let{routeContext:t,match:r,children:n}=e,s=J.useContext(ub);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),J.createElement(Nl.Provider,{value:t},n)}function HD(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);d>=0||kn(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:p,errors:h}=r,m=f.route.loader&&p[f.route.id]===void 0&&(!h||h[f.route.id]===void 0);if(f.route.lazy||m){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,p)=>{let h,m=!1,g=null,y=null;r&&(h=o&&f.route.id?o[f.route.id]:void 0,g=f.route.errorElement||UD,l&&(u<0&&p===0?(YD("route-fallback"),m=!0,y=null):u===p&&(m=!0,y=f.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,p+1)),w=()=>{let b;return h?b=g:m?b=y:f.route.Component?b=J.createElement(f.route.Component,null):f.route.element?b=f.route.element:b=d,J.createElement(zD,{match:f,routeContext:{outlet:d,matches:x,isDataRoute:r!=null},children:b})};return r&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?J.createElement($D,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:w(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):w()},null)}var QA=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(QA||{}),ZA=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ZA||{});function qD(e){let t=J.useContext(ub);return t||kn(!1),t}function WD(e){let t=J.useContext(DD);return t||kn(!1),t}function VD(e){let t=J.useContext(Nl);return t||kn(!1),t}function ej(e){let t=VD(),r=t.matches[t.matches.length-1];return r.route.id||kn(!1),r.route.id}function KD(){var e;let t=J.useContext(YA),r=WD(),n=ej();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function GD(){let{router:e}=qD(QA.UseNavigateStable),t=ej(ZA.UseNavigateStable),r=J.useRef(!1);return XA(()=>{r.current=!0}),J.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,$0({fromRouteId:t},a)))},[e,t])}const vN={};function YD(e,t,r){vN[e]||(vN[e]=!0)}function XD(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Br(e){let{to:t,replace:r,state:n,relative:s}=e;Of()||kn(!1);let{future:a,static:i}=J.useContext(Mc),{matches:o}=J.useContext(Nl),{pathname:l}=Mf(),u=$s(),d=cb(t,lb(o,a.v7_relativeSplatPath),l,s==="path"),f=JSON.stringify(d);return J.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Dr(e){kn(!1)}function JD(e){let{basename:t="/",children:r=null,location:n,navigationType:s=uc.Pop,navigator:a,static:i=!1,future:o}=e;Of()&&kn(!1);let l=t.replace(/^\/*/,"/"),u=J.useMemo(()=>({basename:l,navigator:a,static:i,future:$0({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=If(n));let{pathname:d="/",search:f="",hash:p="",state:h=null,key:m="default"}=n,g=J.useMemo(()=>{let y=ob(d,l);return y==null?null:{location:{pathname:y,search:f,hash:p,state:h,key:m},navigationType:s}},[l,d,f,p,h,m,s]);return g==null?null:J.createElement(Mc.Provider,{value:u},J.createElement(bx.Provider,{children:r,value:g}))}function QD(e){let{children:t,location:r}=e;return OD(Vy(t),r)}new Promise(()=>{});function Vy(e,t){t===void 0&&(t=[]);let r=[];return J.Children.forEach(e,(n,s)=>{if(!J.isValidElement(n))return;let a=[...t,s];if(n.type===J.Fragment){r.push.apply(r,Vy(n.props.children,a));return}n.type!==Dr&&kn(!1),!n.props.index||!n.props.children||kn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Vy(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ky(){return Ky=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ky.apply(this,arguments)}function ZD(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function eR(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function tR(e,t){return e.button===0&&(!t||t==="_self")&&!eR(e)}const rR=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],nR="6";try{window.__reactRouterVersion=nR}catch{}const sR="startTransition",yN=YL[sR];function aR(e){let{basename:t,children:r,future:n,window:s}=e,a=J.useRef();a.current==null&&(a.current=oD({window:s,v5Compat:!0}));let i=a.current,[o,l]=J.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=J.useCallback(f=>{u&&yN?yN(()=>l(f)):l(f)},[l,u]);return J.useLayoutEffect(()=>i.listen(d),[i,d]),J.useEffect(()=>XD(n),[n]),J.createElement(JD,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const iR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",oR=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pi=J.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:u,preventScrollReset:d,viewTransition:f}=t,p=ZD(t,rR),{basename:h}=J.useContext(Mc),m,g=!1;if(typeof u=="string"&&oR.test(u)&&(m=u,iR))try{let b=new URL(window.location.href),N=u.startsWith("//")?new URL(b.protocol+u):new URL(u),A=ob(N.pathname,h);N.origin===b.origin&&A!=null?u=A+N.search+N.hash:g=!0}catch{}let y=RD(u,{relative:s}),x=lR(u,{replace:i,state:o,target:l,preventScrollReset:d,relative:s,viewTransition:f});function w(b){n&&n(b),b.defaultPrevented||x(b)}return J.createElement("a",Ky({},p,{href:m||y,onClick:g||a?n:w,ref:r,target:l}))});var wN;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wN||(wN={}));var bN;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(bN||(bN={}));function lR(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=$s(),u=Mf(),d=JA(e,{relative:i});return J.useCallback(f=>{if(tR(f,r)){f.preventDefault();let p=n!==void 0?n:v1(u)===v1(d);l(e,{replace:p,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,d,n,s,r,e,a,i,o])}var Nx=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},cR={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},rc,d5,kE,uR=(kE=class{constructor(){cr(this,rc,cR);cr(this,d5,!1)}setTimeoutProvider(e){Vt(this,rc,e)}setTimeout(e,t){return We(this,rc).setTimeout(e,t)}clearTimeout(e){We(this,rc).clearTimeout(e)}setInterval(e,t){return We(this,rc).setInterval(e,t)}clearInterval(e){We(this,rc).clearInterval(e)}},rc=new WeakMap,d5=new WeakMap,kE),Gy=new uR;function dR(e){setTimeout(e,0)}var Sx=typeof window>"u"||"Deno"in globalThis;function bi(){}function fR(e,t){return typeof e=="function"?e(t):e}function hR(e){return typeof e=="number"&&e>=0&&e!==1/0}function pR(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Yy(e,t){return typeof e=="function"?e(t):e}function mR(e,t){return typeof e=="function"?e(t):e}function NN(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==db(i,t.options))return!1}else if(!H0(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||a&&!a(t))}function SN(e,t){const{exact:r,status:n,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(z0(t.options.mutationKey)!==z0(a))return!1}else if(!H0(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function db(e,t){return((t==null?void 0:t.queryKeyHashFn)||z0)(e)}function z0(e){return JSON.stringify(e,(t,r)=>Xy(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function H0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>H0(e[r],t[r])):!1}var gR=Object.prototype.hasOwnProperty;function tj(e,t){if(e===t)return e;const r=kN(e)&&kN(t);if(!r&&!(Xy(e)&&Xy(t)))return t;const s=(r?e:Object.keys(e)).length,a=r?t:Object.keys(t),i=a.length,o=r?new Array(i):{};let l=0;for(let u=0;u<i;u++){const d=r?u:a[u],f=e[d],p=t[d];if(f===p){o[d]=f,(r?u<s:gR.call(e,d))&&l++;continue}if(f===null||p===null||typeof f!="object"||typeof p!="object"){o[d]=p;continue}const h=tj(f,p);o[d]=h,h===f&&l++}return s===i&&l===s?e:o}function kN(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Xy(e){if(!_N(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!_N(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function _N(e){return Object.prototype.toString.call(e)==="[object Object]"}function xR(e){return new Promise(t=>{Gy.setTimeout(t,e)})}function vR(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?tj(e,t):t}function yR(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function wR(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var fb=Symbol();function rj(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===fb?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var hu,nc,hf,_E,bR=(_E=class extends Nx{constructor(){super();cr(this,hu);cr(this,nc);cr(this,hf);Vt(this,hf,t=>{if(!Sx&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){We(this,nc)||this.setEventListener(We(this,hf))}onUnsubscribe(){var t;this.hasListeners()||((t=We(this,nc))==null||t.call(this),Vt(this,nc,void 0))}setEventListener(t){var r;Vt(this,hf,t),(r=We(this,nc))==null||r.call(this),Vt(this,nc,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){We(this,hu)!==t&&(Vt(this,hu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof We(this,hu)=="boolean"?We(this,hu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},hu=new WeakMap,nc=new WeakMap,hf=new WeakMap,_E),nj=new bR;function NR(){let e,t;const r=new Promise((s,a)=>{e=s,t=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}var SR=dR;function kR(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=SR;const a=o=>{t?e.push(o):s(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{a(()=>{o(...l)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var Xs=kR(),pf,sc,mf,EE,_R=(EE=class extends Nx{constructor(){super();cr(this,pf,!0);cr(this,sc);cr(this,mf);Vt(this,mf,t=>{if(!Sx&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){We(this,sc)||this.setEventListener(We(this,mf))}onUnsubscribe(){var t;this.hasListeners()||((t=We(this,sc))==null||t.call(this),Vt(this,sc,void 0))}setEventListener(t){var r;Vt(this,mf,t),(r=We(this,sc))==null||r.call(this),Vt(this,sc,t(this.setOnline.bind(this)))}setOnline(t){We(this,pf)!==t&&(Vt(this,pf,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return We(this,pf)}},pf=new WeakMap,sc=new WeakMap,mf=new WeakMap,EE),y1=new _R;function ER(e){return Math.min(1e3*2**e,3e4)}function sj(e){return(e??"online")==="online"?y1.isOnline():!0}var Jy=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function aj(e){let t=!1,r=0,n;const s=NR(),a=()=>s.status!=="pending",i=g=>{var y;if(!a()){const x=new Jy(g);p(x),(y=e.onCancel)==null||y.call(e,x)}},o=()=>{t=!0},l=()=>{t=!1},u=()=>nj.isFocused()&&(e.networkMode==="always"||y1.isOnline())&&e.canRun(),d=()=>sj(e.networkMode)&&e.canRun(),f=g=>{a()||(n==null||n(),s.resolve(g))},p=g=>{a()||(n==null||n(),s.reject(g))},h=()=>new Promise(g=>{var y;n=x=>{(a()||u())&&g(x)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;n=void 0,a()||(g=e.onContinue)==null||g.call(e)}),m=()=>{if(a())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(f).catch(x=>{var P;if(a())return;const w=e.retry??(Sx?0:3),b=e.retryDelay??ER,N=typeof b=="function"?b(r,x):b,A=w===!0||typeof w=="number"&&r<w||typeof w=="function"&&w(r,x);if(t||!A){p(x);return}r++,(P=e.onFail)==null||P.call(e,r,x),xR(N).then(()=>u()?void 0:h()).then(()=>{t?p(x):m()})})};return{promise:s,status:()=>s.status,cancel:i,continue:()=>(n==null||n(),s),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?m():h().then(m),s)}}var pu,AE,ij=(AE=class{constructor(){cr(this,pu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hR(this.gcTime)&&Vt(this,pu,Gy.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Sx?1/0:5*60*1e3))}clearGcTimeout(){We(this,pu)&&(Gy.clearTimeout(We(this,pu)),Vt(this,pu,void 0))}},pu=new WeakMap,AE),mu,gf,Xa,gu,Qn,mp,xu,Ni,Yo,jE,AR=(jE=class extends ij{constructor(t){super();cr(this,Ni);cr(this,mu);cr(this,gf);cr(this,Xa);cr(this,gu);cr(this,Qn);cr(this,mp);cr(this,xu);Vt(this,xu,!1),Vt(this,mp,t.defaultOptions),this.setOptions(t.options),this.observers=[],Vt(this,gu,t.client),Vt(this,Xa,We(this,gu).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Vt(this,mu,AN(this.options)),this.state=t.state??We(this,mu),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=We(this,Qn))==null?void 0:t.promise}setOptions(t){if(this.options={...We(this,mp),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=AN(this.options);r.data!==void 0&&(this.setState(EN(r.data,r.dataUpdatedAt)),Vt(this,mu,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&We(this,Xa).remove(this)}setData(t,r){const n=vR(this.state.data,t,this.options);return Ss(this,Ni,Yo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){Ss(this,Ni,Yo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=We(this,Qn))==null?void 0:n.promise;return(s=We(this,Qn))==null||s.cancel(t),r?r.then(bi).catch(bi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(We(this,mu))}isActive(){return this.observers.some(t=>mR(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===fb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Yy(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!pR(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=We(this,Qn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=We(this,Qn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),We(this,Xa).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(We(this,Qn)&&(We(this,xu)?We(this,Qn).cancel({revert:!0}):We(this,Qn).cancelRetry()),this.scheduleGc()),We(this,Xa).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Ss(this,Ni,Yo).call(this,{type:"invalidate"})}async fetch(t,r){var l,u,d,f,p,h,m,g,y,x,w,b;if(this.state.fetchStatus!=="idle"&&((l=We(this,Qn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(We(this,Qn))return We(this,Qn).continueRetry(),We(this,Qn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const N=this.observers.find(A=>A.options.queryFn);N&&this.setOptions(N.options)}const n=new AbortController,s=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(Vt(this,xu,!0),n.signal)})},a=()=>{const N=rj(this.options,r),P=(()=>{const j={client:We(this,gu),queryKey:this.queryKey,meta:this.meta};return s(j),j})();return Vt(this,xu,!1),this.options.persister?this.options.persister(N,P,this):N(P)},o=(()=>{const N={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:We(this,gu),state:this.state,fetchFn:a};return s(N),N})();(u=this.options.behavior)==null||u.onFetch(o,this),Vt(this,gf,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=o.fetchOptions)==null?void 0:d.meta))&&Ss(this,Ni,Yo).call(this,{type:"fetch",meta:(f=o.fetchOptions)==null?void 0:f.meta}),Vt(this,Qn,aj({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:N=>{N instanceof Jy&&N.revert&&this.setState({...We(this,gf),fetchStatus:"idle"}),n.abort()},onFail:(N,A)=>{Ss(this,Ni,Yo).call(this,{type:"failed",failureCount:N,error:A})},onPause:()=>{Ss(this,Ni,Yo).call(this,{type:"pause"})},onContinue:()=>{Ss(this,Ni,Yo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const N=await We(this,Qn).start();if(N===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(N),(h=(p=We(this,Xa).config).onSuccess)==null||h.call(p,N,this),(g=(m=We(this,Xa).config).onSettled)==null||g.call(m,N,this.state.error,this),N}catch(N){if(N instanceof Jy){if(N.silent)return We(this,Qn).promise;if(N.revert){if(this.state.data===void 0)throw N;return this.state.data}}throw Ss(this,Ni,Yo).call(this,{type:"error",error:N}),(x=(y=We(this,Xa).config).onError)==null||x.call(y,N,this),(b=(w=We(this,Xa).config).onSettled)==null||b.call(w,this.state.data,N,this),N}finally{this.scheduleGc()}}},mu=new WeakMap,gf=new WeakMap,Xa=new WeakMap,gu=new WeakMap,Qn=new WeakMap,mp=new WeakMap,xu=new WeakMap,Ni=new WeakSet,Yo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...jR(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...EN(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Vt(this,gf,t.manual?s:void 0),s;case"error":const a=t.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Xs.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),We(this,Xa).notify({query:this,type:"updated",action:t})})},jE);function jR(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:sj(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function EN(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function AN(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function jN(e){return{onFetch:(t,r)=>{var d,f,p,h,m;const n=t.options,s=(p=(f=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:f.fetchMore)==null?void 0:p.direction,a=((h=t.state.data)==null?void 0:h.pages)||[],i=((m=t.state.data)==null?void 0:m.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let g=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},x=rj(t.options,t.fetchOptions),w=async(b,N,A)=>{if(g)return Promise.reject();if(N==null&&b.pages.length)return Promise.resolve(b);const j=(()=>{const _={client:t.client,queryKey:t.queryKey,pageParam:N,direction:A?"backward":"forward",meta:t.options.meta};return y(_),_})(),D=await x(j),{maxPages:E}=t.options,I=A?wR:yR;return{pages:I(b.pages,D,E),pageParams:I(b.pageParams,N,E)}};if(s&&a.length){const b=s==="backward",N=b?CR:CN,A={pages:a,pageParams:i},P=N(n,A);o=await w(A,P,b)}else{const b=e??a.length;do{const N=l===0?i[0]??n.initialPageParam:CN(n,o);if(l>0&&N==null)break;o=await w(o,N),l++}while(l<b)}return o};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function CN(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function CR(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var gp,oo,Ks,vu,lo,Vl,CE,TR=(CE=class extends ij{constructor(t){super();cr(this,lo);cr(this,gp);cr(this,oo);cr(this,Ks);cr(this,vu);Vt(this,gp,t.client),this.mutationId=t.mutationId,Vt(this,Ks,t.mutationCache),Vt(this,oo,[]),this.state=t.state||PR(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){We(this,oo).includes(t)||(We(this,oo).push(t),this.clearGcTimeout(),We(this,Ks).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Vt(this,oo,We(this,oo).filter(r=>r!==t)),this.scheduleGc(),We(this,Ks).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){We(this,oo).length||(this.state.status==="pending"?this.scheduleGc():We(this,Ks).remove(this))}continue(){var t;return((t=We(this,vu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,u,d,f,p,h,m,g,y,x,w,b,N,A,P,j,D,E;const r=()=>{Ss(this,lo,Vl).call(this,{type:"continue"})},n={client:We(this,gp),meta:this.options.meta,mutationKey:this.options.mutationKey};Vt(this,vu,aj({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(I,_)=>{Ss(this,lo,Vl).call(this,{type:"failed",failureCount:I,error:_})},onPause:()=>{Ss(this,lo,Vl).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>We(this,Ks).canRun(this)}));const s=this.state.status==="pending",a=!We(this,vu).canStart();try{if(s)r();else{Ss(this,lo,Vl).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=We(this,Ks).config).onMutate)==null?void 0:o.call(i,t,this,n));const _=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,t,n));_!==this.state.context&&Ss(this,lo,Vl).call(this,{type:"pending",context:_,variables:t,isPaused:a})}const I=await We(this,vu).start();return await((f=(d=We(this,Ks).config).onSuccess)==null?void 0:f.call(d,I,t,this.state.context,this,n)),await((h=(p=this.options).onSuccess)==null?void 0:h.call(p,I,t,this.state.context,n)),await((g=(m=We(this,Ks).config).onSettled)==null?void 0:g.call(m,I,null,this.state.variables,this.state.context,this,n)),await((x=(y=this.options).onSettled)==null?void 0:x.call(y,I,null,t,this.state.context,n)),Ss(this,lo,Vl).call(this,{type:"success",data:I}),I}catch(I){try{throw await((b=(w=We(this,Ks).config).onError)==null?void 0:b.call(w,I,t,this.state.context,this,n)),await((A=(N=this.options).onError)==null?void 0:A.call(N,I,t,this.state.context,n)),await((j=(P=We(this,Ks).config).onSettled)==null?void 0:j.call(P,void 0,I,this.state.variables,this.state.context,this,n)),await((E=(D=this.options).onSettled)==null?void 0:E.call(D,void 0,I,t,this.state.context,n)),I}finally{Ss(this,lo,Vl).call(this,{type:"error",error:I})}}finally{We(this,Ks).runNext(this)}}},gp=new WeakMap,oo=new WeakMap,Ks=new WeakMap,vu=new WeakMap,lo=new WeakSet,Vl=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Xs.batch(()=>{We(this,oo).forEach(n=>{n.onMutationUpdate(t)}),We(this,Ks).notify({mutation:this,type:"updated",action:t})})},CE);function PR(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var el,Si,xp,TE,LR=(TE=class extends Nx{constructor(t={}){super();cr(this,el);cr(this,Si);cr(this,xp);this.config=t,Vt(this,el,new Set),Vt(this,Si,new Map),Vt(this,xp,0)}build(t,r,n){const s=new TR({client:t,mutationCache:this,mutationId:++mm(this,xp)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){We(this,el).add(t);const r=Fm(t);if(typeof r=="string"){const n=We(this,Si).get(r);n?n.push(t):We(this,Si).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(We(this,el).delete(t)){const r=Fm(t);if(typeof r=="string"){const n=We(this,Si).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&We(this,Si).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Fm(t);if(typeof r=="string"){const n=We(this,Si).get(r),s=n==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=Fm(t);if(typeof r=="string"){const s=(n=We(this,Si).get(r))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Xs.batch(()=>{We(this,el).forEach(t=>{this.notify({type:"removed",mutation:t})}),We(this,el).clear(),We(this,Si).clear()})}getAll(){return Array.from(We(this,el))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>SN(r,n))}findAll(t={}){return this.getAll().filter(r=>SN(t,r))}notify(t){Xs.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Xs.batch(()=>Promise.all(t.map(r=>r.continue().catch(bi))))}},el=new WeakMap,Si=new WeakMap,xp=new WeakMap,TE);function Fm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var co,PE,FR=(PE=class extends Nx{constructor(t={}){super();cr(this,co);this.config=t,Vt(this,co,new Map)}build(t,r,n){const s=r.queryKey,a=r.queryHash??db(s,r);let i=this.get(a);return i||(i=new AR({client:t,queryKey:s,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){We(this,co).has(t.queryHash)||(We(this,co).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=We(this,co).get(t.queryHash);r&&(t.destroy(),r===t&&We(this,co).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Xs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return We(this,co).get(t)}getAll(){return[...We(this,co).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>NN(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>NN(t,n)):r}notify(t){Xs.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Xs.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Xs.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},co=new WeakMap,PE),ln,ac,ic,xf,vf,oc,yf,wf,LE,DR=(LE=class{constructor(e={}){cr(this,ln);cr(this,ac);cr(this,ic);cr(this,xf);cr(this,vf);cr(this,oc);cr(this,yf);cr(this,wf);Vt(this,ln,e.queryCache||new FR),Vt(this,ac,e.mutationCache||new LR),Vt(this,ic,e.defaultOptions||{}),Vt(this,xf,new Map),Vt(this,vf,new Map),Vt(this,oc,0)}mount(){mm(this,oc)._++,We(this,oc)===1&&(Vt(this,yf,nj.subscribe(async e=>{e&&(await this.resumePausedMutations(),We(this,ln).onFocus())})),Vt(this,wf,y1.subscribe(async e=>{e&&(await this.resumePausedMutations(),We(this,ln).onOnline())})))}unmount(){var e,t;mm(this,oc)._--,We(this,oc)===0&&((e=We(this,yf))==null||e.call(this),Vt(this,yf,void 0),(t=We(this,wf))==null||t.call(this),Vt(this,wf,void 0))}isFetching(e){return We(this,ln).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return We(this,ac).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=We(this,ln).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=We(this,ln).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Yy(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return We(this,ln).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=We(this,ln).get(n.queryHash),a=s==null?void 0:s.state.data,i=fR(t,a);if(i!==void 0)return We(this,ln).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return Xs.batch(()=>We(this,ln).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=We(this,ln).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=We(this,ln);Xs.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=We(this,ln);return Xs.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Xs.batch(()=>We(this,ln).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(bi).catch(bi)}invalidateQueries(e,t={}){return Xs.batch(()=>(We(this,ln).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Xs.batch(()=>We(this,ln).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(bi)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(bi)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=We(this,ln).build(this,t);return r.isStaleByTime(Yy(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(bi).catch(bi)}fetchInfiniteQuery(e){return e.behavior=jN(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(bi).catch(bi)}ensureInfiniteQueryData(e){return e.behavior=jN(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return y1.isOnline()?We(this,ac).resumePausedMutations():Promise.resolve()}getQueryCache(){return We(this,ln)}getMutationCache(){return We(this,ac)}getDefaultOptions(){return We(this,ic)}setDefaultOptions(e){Vt(this,ic,e)}setQueryDefaults(e,t){We(this,xf).set(z0(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...We(this,xf).values()],r={};return t.forEach(n=>{H0(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){We(this,vf).set(z0(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...We(this,vf).values()],r={};return t.forEach(n=>{H0(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...We(this,ic).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=db(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===fb&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...We(this,ic).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){We(this,ln).clear(),We(this,ac).clear()}},ln=new WeakMap,ac=new WeakMap,ic=new WeakMap,xf=new WeakMap,vf=new WeakMap,oc=new WeakMap,yf=new WeakMap,wf=new WeakMap,LE),RR=J.createContext(void 0),IR=({client:e,children:t})=>(J.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(RR.Provider,{value:e,children:t}));function OR(){if(console&&console.warn){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];bu(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t)}}const TN={};function Qy(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];bu(t[0])&&TN[t[0]]||(bu(t[0])&&(TN[t[0]]=new Date),OR(...t))}const oj=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},PN=(e,t,r)=>{e.loadNamespaces(t,oj(e,r))},LN=(e,t,r,n)=>{bu(r)&&(r=[r]),r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,oj(e,n))},MR=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=t.languages[0],s=t.options?t.options.fallbackLng:!1,a=t.languages[t.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,l)=>{const u=t.services.backendConnector.state[`${o}|${l}`];return u===-1||u===2};return r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e)?!1:!!(t.hasResourceBundle(n,e)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||i(n,e)&&(!s||i(a,e)))},BR=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!t.languages||!t.languages.length?(Qy("i18n.languages were undefined or empty",t.languages),!0):t.options.ignoreJSONStructure!==void 0?t.hasLoadedNamespace(e,{lng:r.lng,precheck:(s,a)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!a(s.isLanguageChangingTo,e))return!1}}):MR(e,t,r)},bu=e=>typeof e=="string",UR=e=>typeof e=="object"&&e!==null,$R=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,zR={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},HR=e=>zR[e],qR=e=>e.replace($R,HR);let Zy={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:qR};const WR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Zy={...Zy,...e}},VR=()=>Zy;let lj;const KR=e=>{lj=e},GR=()=>lj,YR={type:"3rdParty",init(e){WR(e.options.react),KR(e)}},XR=J.createContext();class JR{constructor(){Tt(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}}const QR=(e,t)=>{const r=J.useRef();return J.useEffect(()=>{r.current=e},[e,t]),r.current},cj=(e,t,r,n)=>e.getFixedT(t,r,n),ZR=(e,t,r,n)=>J.useCallback(cj(e,t,r,n),[e,t,r,n]),$i=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:r}=t,{i18n:n,defaultNS:s}=J.useContext(XR)||{},a=r||n||GR();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new JR),!a){Qy("You will need to pass in an i18next instance by using initReactI18next");const N=(P,j)=>bu(j)?j:UR(j)&&bu(j.defaultValue)?j.defaultValue:Array.isArray(P)?P[P.length-1]:P,A=[N,{},!1];return A.t=N,A.i18n={},A.ready=!1,A}a.options.react&&a.options.react.wait!==void 0&&Qy("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const i={...VR(),...a.options.react,...t},{useSuspense:o,keyPrefix:l}=i;let u=s||a.options&&a.options.defaultNS;u=bu(u)?[u]:u||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(u);const d=(a.isInitialized||a.initializedStoreOnce)&&u.every(N=>BR(N,a,i)),f=ZR(a,t.lng||null,i.nsMode==="fallback"?u:u[0],l),p=()=>f,h=()=>cj(a,t.lng||null,i.nsMode==="fallback"?u:u[0],l),[m,g]=J.useState(p);let y=u.join();t.lng&&(y=`${t.lng}${y}`);const x=QR(y),w=J.useRef(!0);J.useEffect(()=>{const{bindI18n:N,bindI18nStore:A}=i;w.current=!0,!d&&!o&&(t.lng?LN(a,t.lng,u,()=>{w.current&&g(h)}):PN(a,u,()=>{w.current&&g(h)})),d&&x&&x!==y&&w.current&&g(h);const P=()=>{w.current&&g(h)};return N&&a&&a.on(N,P),A&&a&&a.store.on(A,P),()=>{w.current=!1,N&&a&&N.split(" ").forEach(j=>a.off(j,P)),A&&a&&A.split(" ").forEach(j=>a.store.off(j,P))}},[a,y]),J.useEffect(()=>{w.current&&d&&g(p)},[a,l,d]);const b=[m,a,d];if(b.t=m,b.i18n=a,b.ready=d,d||!d&&!o)return b;throw new Promise(N=>{t.lng?LN(a,t.lng,u,()=>N()):PN(a,u,()=>N())})},eI={},FN=e=>{let t;const r=new Set,n=(d,f)=>{const p=typeof d=="function"?d(t):d;if(!Object.is(p,t)){const h=t;t=f??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(m=>m(t,h))}},s=()=>t,l={setState:n,getState:s,getInitialState:()=>u,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(eI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,s,l);return l},tI=e=>e?FN(e):FN;var uj={exports:{}},dj={},fj={exports:{}},hj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jf=J;function rI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var nI=typeof Object.is=="function"?Object.is:rI,sI=jf.useState,aI=jf.useEffect,iI=jf.useLayoutEffect,oI=jf.useDebugValue;function lI(e,t){var r=t(),n=sI({inst:{value:r,getSnapshot:t}}),s=n[0].inst,a=n[1];return iI(function(){s.value=r,s.getSnapshot=t,X2(s)&&a({inst:s})},[e,r,t]),aI(function(){return X2(s)&&a({inst:s}),e(function(){X2(s)&&a({inst:s})})},[e]),oI(r),r}function X2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!nI(e,r)}catch{return!0}}function cI(e,t){return t()}var uI=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?cI:lI;hj.useSyncExternalStore=jf.useSyncExternalStore!==void 0?jf.useSyncExternalStore:uI;fj.exports=hj;var dI=fj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kx=J,fI=dI;function hI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pI=typeof Object.is=="function"?Object.is:hI,mI=fI.useSyncExternalStore,gI=kx.useRef,xI=kx.useEffect,vI=kx.useMemo,yI=kx.useDebugValue;dj.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var a=gI(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=vI(function(){function l(h){if(!u){if(u=!0,d=h,h=n(h),s!==void 0&&i.hasValue){var m=i.value;if(s(m,h))return f=m}return f=h}if(m=f,pI(d,h))return m;var g=n(h);return s!==void 0&&s(m,g)?(d=h,m):(d=h,f=g)}var u=!1,d,f,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,s]);var o=mI(e,a[0],a[1]);return xI(function(){i.hasValue=!0,i.value=o},[o]),yI(o),o};uj.exports=dj;var wI=uj.exports;const bI=FE(wI),pj={},{useDebugValue:NI}=Jl,{useSyncExternalStoreWithSelector:SI}=bI;let DN=!1;const kI=e=>e;function _I(e,t=kI,r){(pj?"production":void 0)!=="production"&&r&&!DN&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),DN=!0);const n=SI(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return NI(n),n}const RN=e=>{(pj?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?tI(e):e,r=(n,s)=>_I(t,n,s);return Object.assign(r,t),r},hb=e=>e?RN(e):RN,EI={};function AI(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var a;const i=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(s))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const q0=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return q0(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return q0(n)(r)}}}},jI=(e,t)=>(r,n,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,x)=>({...x,...y}),...t},i=!1;const o=new Set,l=new Set;let u;try{u=a.getStorage()}catch{}if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...y)},n,s);const d=q0(a.serialize),f=()=>{const y=a.partialize({...n()});let x;const w=d({state:y,version:a.version}).then(b=>u.setItem(a.name,b)).catch(b=>{x=b});if(x)throw x;return w},p=s.setState;s.setState=(y,x)=>{p(y,x),f()};const h=e((...y)=>{r(...y),f()},n,s);let m;const g=()=>{var y;if(!u)return;i=!1,o.forEach(w=>w(n()));const x=((y=a.onRehydrateStorage)==null?void 0:y.call(a,n()))||void 0;return q0(u.getItem.bind(u))(a.name).then(w=>{if(w)return a.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==a.version){if(a.migrate)return a.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var b;return m=a.merge(w,(b=n())!=null?b:h),r(m,!0),f()}).then(()=>{x==null||x(m,void 0),i=!0,l.forEach(w=>w(m))}).catch(w=>{x==null||x(void 0,w)})};return s.persist={setOptions:y=>{a={...a,...y},y.getStorage&&(u=y.getStorage())},clearStorage:()=>{u==null||u.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(l.add(y),()=>{l.delete(y)})},g(),m||h},CI=(e,t)=>(r,n,s)=>{let a={storage:AI(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},i=!1;const o=new Set,l=new Set;let u=a.storage;if(!u)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...g)},n,s);const d=()=>{const g=a.partialize({...n()});return u.setItem(a.name,{state:g,version:a.version})},f=s.setState;s.setState=(g,y)=>{f(g,y),d()};const p=e((...g)=>{r(...g),d()},n,s);s.getInitialState=()=>p;let h;const m=()=>{var g,y;if(!u)return;i=!1,o.forEach(w=>{var b;return w((b=n())!=null?b:p)});const x=((y=a.onRehydrateStorage)==null?void 0:y.call(a,(g=n())!=null?g:p))||void 0;return q0(u.getItem.bind(u))(a.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==a.version){if(a.migrate)return[!0,a.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var b;const[N,A]=w;if(h=a.merge(A,(b=n())!=null?b:p),r(h,!0),N)return d()}).then(()=>{x==null||x(h,void 0),h=n(),i=!0,l.forEach(w=>w(h))}).catch(w=>{x==null||x(void 0,w)})};return s.persist={setOptions:g=>{a={...a,...g},g.storage&&(u=g.storage)},clearStorage:()=>{u==null||u.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},a.skipHydration||m(),h||p},TI=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((EI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),jI(e,t)):CI(e,t),PI=TI;function mj(e,t){return function(){return e.apply(t,arguments)}}const{toString:LI}=Object.prototype,{getPrototypeOf:pb}=Object,{iterator:_x,toStringTag:gj}=Symbol,Ex=(e=>t=>{const r=LI.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),zi=e=>(e=e.toLowerCase(),t=>Ex(t)===e),Ax=e=>t=>typeof t===e,{isArray:Bf}=Array,Cf=Ax("undefined");function Sp(e){return e!==null&&!Cf(e)&&e.constructor!==null&&!Cf(e.constructor)&&ma(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const xj=zi("ArrayBuffer");function FI(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&xj(e.buffer),t}const DI=Ax("string"),ma=Ax("function"),vj=Ax("number"),kp=e=>e!==null&&typeof e=="object",RI=e=>e===!0||e===!1,Eg=e=>{if(Ex(e)!=="object")return!1;const t=pb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(gj in e)&&!(_x in e)},II=e=>{if(!kp(e)||Sp(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},OI=zi("Date"),MI=zi("File"),BI=zi("Blob"),UI=zi("FileList"),$I=e=>kp(e)&&ma(e.pipe),zI=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ma(e.append)&&((t=Ex(e))==="formdata"||t==="object"&&ma(e.toString)&&e.toString()==="[object FormData]"))},HI=zi("URLSearchParams"),[qI,WI,VI,KI]=["ReadableStream","Request","Response","Headers"].map(zi),GI=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _p(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Bf(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(Sp(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function yj(e,t){if(Sp(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const uu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,wj=e=>!Cf(e)&&e!==uu;function ew(){const{caseless:e,skipUndefined:t}=wj(this)&&this||{},r={},n=(s,a)=>{const i=e&&yj(r,a)||a;Eg(r[i])&&Eg(s)?r[i]=ew(r[i],s):Eg(s)?r[i]=ew({},s):Bf(s)?r[i]=s.slice():(!t||!Cf(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&_p(arguments[s],n);return r}const YI=(e,t,r,{allOwnKeys:n}={})=>(_p(t,(s,a)=>{r&&ma(s)?e[a]=mj(s,r):e[a]=s},{allOwnKeys:n}),e),XI=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),JI=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},QI=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&pb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},ZI=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},eO=e=>{if(!e)return null;if(Bf(e))return e;let t=e.length;if(!vj(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},tO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&pb(Uint8Array)),rO=(e,t)=>{const n=(e&&e[_x]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},nO=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},sO=zi("HTMLFormElement"),aO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),IN=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),iO=zi("RegExp"),bj=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};_p(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},oO=e=>{bj(e,(t,r)=>{if(ma(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ma(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},lO=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return Bf(e)?n(e):n(String(e).split(t)),r},cO=()=>{},uO=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function dO(e){return!!(e&&ma(e.append)&&e[gj]==="FormData"&&e[_x])}const fO=e=>{const t=new Array(10),r=(n,s)=>{if(kp(n)){if(t.indexOf(n)>=0)return;if(Sp(n))return n;if(!("toJSON"in n)){t[s]=n;const a=Bf(n)?[]:{};return _p(n,(i,o)=>{const l=r(i,s+1);!Cf(l)&&(a[o]=l)}),t[s]=void 0,a}}return n};return r(e,0)},hO=zi("AsyncFunction"),pO=e=>e&&(kp(e)||ma(e))&&ma(e.then)&&ma(e.catch),Nj=((e,t)=>e?setImmediate:t?((r,n)=>(uu.addEventListener("message",({source:s,data:a})=>{s===uu&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),uu.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ma(uu.postMessage)),mO=typeof queueMicrotask<"u"?queueMicrotask.bind(uu):typeof process<"u"&&process.nextTick||Nj,gO=e=>e!=null&&ma(e[_x]),Pe={isArray:Bf,isArrayBuffer:xj,isBuffer:Sp,isFormData:zI,isArrayBufferView:FI,isString:DI,isNumber:vj,isBoolean:RI,isObject:kp,isPlainObject:Eg,isEmptyObject:II,isReadableStream:qI,isRequest:WI,isResponse:VI,isHeaders:KI,isUndefined:Cf,isDate:OI,isFile:MI,isBlob:BI,isRegExp:iO,isFunction:ma,isStream:$I,isURLSearchParams:HI,isTypedArray:tO,isFileList:UI,forEach:_p,merge:ew,extend:YI,trim:GI,stripBOM:XI,inherits:JI,toFlatObject:QI,kindOf:Ex,kindOfTest:zi,endsWith:ZI,toArray:eO,forEachEntry:rO,matchAll:nO,isHTMLForm:sO,hasOwnProperty:IN,hasOwnProp:IN,reduceDescriptors:bj,freezeMethods:oO,toObjectSet:lO,toCamelCase:aO,noop:cO,toFiniteNumber:uO,findKey:yj,global:uu,isContextDefined:wj,isSpecCompliantForm:dO,toJSONObject:fO,isAsyncFn:hO,isThenable:pO,setImmediate:Nj,asap:mO,isIterable:gO};function tr(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Pe.inherits(tr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Pe.toJSONObject(this.config),code:this.code,status:this.status}}});const Sj=tr.prototype,kj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{kj[e]={value:e}});Object.defineProperties(tr,kj);Object.defineProperty(Sj,"isAxiosError",{value:!0});tr.from=(e,t,r,n,s,a)=>{const i=Object.create(Sj);Pe.toFlatObject(e,i,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",l=t==null&&e?e.code:t;return tr.call(i,o,l,r,n,s),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const xO=null;function tw(e){return Pe.isPlainObject(e)||Pe.isArray(e)}function _j(e){return Pe.endsWith(e,"[]")?e.slice(0,-2):e}function ON(e,t,r){return e?e.concat(t).map(function(s,a){return s=_j(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function vO(e){return Pe.isArray(e)&&!e.some(tw)}const yO=Pe.toFlatObject(Pe,{},null,function(t){return/^is[A-Z]/.test(t)});function jx(e,t,r){if(!Pe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Pe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!Pe.isUndefined(y[g])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,i=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&Pe.isSpecCompliantForm(t);if(!Pe.isFunction(s))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(Pe.isDate(m))return m.toISOString();if(Pe.isBoolean(m))return m.toString();if(!l&&Pe.isBlob(m))throw new tr("Blob is not supported. Use a Buffer instead.");return Pe.isArrayBuffer(m)||Pe.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function d(m,g,y){let x=m;if(m&&!y&&typeof m=="object"){if(Pe.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(Pe.isArray(m)&&vO(m)||(Pe.isFileList(m)||Pe.endsWith(g,"[]"))&&(x=Pe.toArray(m)))return g=_j(g),x.forEach(function(b,N){!(Pe.isUndefined(b)||b===null)&&t.append(i===!0?ON([g],N,a):i===null?g:g+"[]",u(b))}),!1}return tw(m)?!0:(t.append(ON(y,g,a),u(m)),!1)}const f=[],p=Object.assign(yO,{defaultVisitor:d,convertValue:u,isVisitable:tw});function h(m,g){if(!Pe.isUndefined(m)){if(f.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));f.push(m),Pe.forEach(m,function(x,w){(!(Pe.isUndefined(x)||x===null)&&s.call(t,x,Pe.isString(w)?w.trim():w,g,p))===!0&&h(x,g?g.concat(w):[w])}),f.pop()}}if(!Pe.isObject(e))throw new TypeError("data must be an object");return h(e),t}function MN(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function mb(e,t){this._pairs=[],e&&jx(e,this,t)}const Ej=mb.prototype;Ej.append=function(t,r){this._pairs.push([t,r])};Ej.toString=function(t){const r=t?function(n){return t.call(this,n,MN)}:MN;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function wO(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Aj(e,t,r){if(!t)return e;const n=r&&r.encode||wO;Pe.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=Pe.isURLSearchParams(t)?t.toString():new mb(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class BN{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Pe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const jj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bO=typeof URLSearchParams<"u"?URLSearchParams:mb,NO=typeof FormData<"u"?FormData:null,SO=typeof Blob<"u"?Blob:null,kO={isBrowser:!0,classes:{URLSearchParams:bO,FormData:NO,Blob:SO},protocols:["http","https","file","blob","url","data"]},gb=typeof window<"u"&&typeof document<"u",rw=typeof navigator=="object"&&navigator||void 0,_O=gb&&(!rw||["ReactNative","NativeScript","NS"].indexOf(rw.product)<0),EO=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",AO=gb&&window.location.href||"http://localhost",jO=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:gb,hasStandardBrowserEnv:_O,hasStandardBrowserWebWorkerEnv:EO,navigator:rw,origin:AO},Symbol.toStringTag,{value:"Module"})),Fs={...jO,...kO};function CO(e,t){return jx(e,new Fs.classes.URLSearchParams,{visitor:function(r,n,s,a){return Fs.isNode&&Pe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function TO(e){return Pe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function PO(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function Cj(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),l=a>=r.length;return i=!i&&Pe.isArray(s)?s.length:i,l?(Pe.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Pe.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Pe.isArray(s[i])&&(s[i]=PO(s[i])),!o)}if(Pe.isFormData(e)&&Pe.isFunction(e.entries)){const r={};return Pe.forEachEntry(e,(n,s)=>{t(TO(n),s,r,0)}),r}return null}function LO(e,t,r){if(Pe.isString(e))try{return(t||JSON.parse)(e),Pe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Ep={transitional:jj,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Pe.isObject(t);if(a&&Pe.isHTMLForm(t)&&(t=new FormData(t)),Pe.isFormData(t))return s?JSON.stringify(Cj(t)):t;if(Pe.isArrayBuffer(t)||Pe.isBuffer(t)||Pe.isStream(t)||Pe.isFile(t)||Pe.isBlob(t)||Pe.isReadableStream(t))return t;if(Pe.isArrayBufferView(t))return t.buffer;if(Pe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return CO(t,this.formSerializer).toString();if((o=Pe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return jx(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),LO(t)):t}],transformResponse:[function(t){const r=this.transitional||Ep.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Pe.isResponse(t)||Pe.isReadableStream(t))return t;if(t&&Pe.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?tr.from(o,tr.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fs.classes.FormData,Blob:Fs.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Pe.forEach(["delete","get","head","post","put","patch"],e=>{Ep.headers[e]={}});const FO=Pe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),DO=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&FO[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},UN=Symbol("internals");function Ah(e){return e&&String(e).trim().toLowerCase()}function Ag(e){return e===!1||e==null?e:Pe.isArray(e)?e.map(Ag):String(e)}function RO(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const IO=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function J2(e,t,r,n,s){if(Pe.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Pe.isString(t)){if(Pe.isString(n))return t.indexOf(n)!==-1;if(Pe.isRegExp(n))return n.test(t)}}function OO(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function MO(e,t){const r=Pe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let ga=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,l,u){const d=Ah(l);if(!d)throw new Error("header name must be a non-empty string");const f=Pe.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||l]=Ag(o))}const i=(o,l)=>Pe.forEach(o,(u,d)=>a(u,d,l));if(Pe.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Pe.isString(t)&&(t=t.trim())&&!IO(t))i(DO(t),r);else if(Pe.isObject(t)&&Pe.isIterable(t)){let o={},l,u;for(const d of t){if(!Pe.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(l=o[u])?Pe.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Ah(t),t){const n=Pe.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return RO(s);if(Pe.isFunction(r))return r.call(this,s,n);if(Pe.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Ah(t),t){const n=Pe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||J2(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=Ah(i),i){const o=Pe.findKey(n,i);o&&(!r||J2(n,n[o],o,r))&&(delete n[o],s=!0)}}return Pe.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||J2(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Pe.forEach(this,(s,a)=>{const i=Pe.findKey(n,a);if(i){r[i]=Ag(s),delete r[a];return}const o=t?OO(a):String(a).trim();o!==a&&delete r[a],r[o]=Ag(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Pe.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Pe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[UN]=this[UN]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=Ah(i);n[o]||(MO(s,i),n[o]=!0)}return Pe.isArray(t)?t.forEach(a):a(t),this}};ga.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Pe.reduceDescriptors(ga.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Pe.freezeMethods(ga);function Q2(e,t){const r=this||Ep,n=t||r,s=ga.from(n.headers);let a=n.data;return Pe.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function Tj(e){return!!(e&&e.__CANCEL__)}function Uf(e,t,r){tr.call(this,e??"canceled",tr.ERR_CANCELED,t,r),this.name="CanceledError"}Pe.inherits(Uf,tr,{__CANCEL__:!0});function Pj(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new tr("Request failed with status code "+r.status,[tr.ERR_BAD_REQUEST,tr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function BO(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function UO(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(l){const u=Date.now(),d=n[a];i||(i=u),r[s]=l,n[s]=u;let f=a,p=0;for(;f!==s;)p+=r[f++],f=f%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-i<t)return;const h=d&&u-d;return h?Math.round(p*1e3/h):void 0}}function $O(e,t){let r=0,n=1e3/t,s,a;const i=(u,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?i(u,d):(s=u,a||(a=setTimeout(()=>{a=null,i(s)},n-f)))},()=>s&&i(s)]}const w1=(e,t,r=3)=>{let n=0;const s=UO(50,250);return $O(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,l=i-n,u=s(l),d=i<=o;n=i;const f={loaded:i,total:o,progress:o?i/o:void 0,bytes:l,rate:u||void 0,estimated:u&&o&&d?(o-i)/u:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},$N=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},zN=e=>(...t)=>Pe.asap(()=>e(...t)),zO=Fs.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Fs.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Fs.origin),Fs.navigator&&/(msie|trident)/i.test(Fs.navigator.userAgent)):()=>!0,HO=Fs.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Pe.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Pe.isString(n)&&o.push(`path=${n}`),Pe.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),Pe.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function qO(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function WO(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function Lj(e,t,r){let n=!qO(t);return e&&(n||r==!1)?WO(e,t):t}const HN=e=>e instanceof ga?{...e}:e;function Iu(e,t){t=t||{};const r={};function n(u,d,f,p){return Pe.isPlainObject(u)&&Pe.isPlainObject(d)?Pe.merge.call({caseless:p},u,d):Pe.isPlainObject(d)?Pe.merge({},d):Pe.isArray(d)?d.slice():d}function s(u,d,f,p){if(Pe.isUndefined(d)){if(!Pe.isUndefined(u))return n(void 0,u,f,p)}else return n(u,d,f,p)}function a(u,d){if(!Pe.isUndefined(d))return n(void 0,d)}function i(u,d){if(Pe.isUndefined(d)){if(!Pe.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function o(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const l={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(u,d,f)=>s(HN(u),HN(d),f,!0)};return Pe.forEach(Object.keys({...e,...t}),function(d){const f=l[d]||s,p=f(e[d],t[d],d);Pe.isUndefined(p)&&f!==o||(r[d]=p)}),r}const Fj=e=>{const t=Iu({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=ga.from(i),t.url=Aj(Lj(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Pe.isFormData(r)){if(Fs.hasStandardBrowserEnv||Fs.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Pe.isFunction(r.getHeaders)){const l=r.getHeaders(),u=["content-type","content-length"];Object.entries(l).forEach(([d,f])=>{u.includes(d.toLowerCase())&&i.set(d,f)})}}if(Fs.hasStandardBrowserEnv&&(n&&Pe.isFunction(n)&&(n=n(t)),n||n!==!1&&zO(t.url))){const l=s&&a&&HO.read(a);l&&i.set(s,l)}return t},VO=typeof XMLHttpRequest<"u",KO=VO&&function(e){return new Promise(function(r,n){const s=Fj(e);let a=s.data;const i=ga.from(s.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:u}=s,d,f,p,h,m;function g(){h&&h(),m&&m(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function x(){if(!y)return;const b=ga.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:b,config:e,request:y};Pj(function(j){r(j),g()},function(j){n(j),g()},A),y=null}"onloadend"in y?y.onloadend=x:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(x)},y.onabort=function(){y&&(n(new tr("Request aborted",tr.ECONNABORTED,e,y)),y=null)},y.onerror=function(N){const A=N&&N.message?N.message:"Network Error",P=new tr(A,tr.ERR_NETWORK,e,y);P.event=N||null,n(P),y=null},y.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const A=s.transitional||jj;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),n(new tr(N,A.clarifyTimeoutError?tr.ETIMEDOUT:tr.ECONNABORTED,e,y)),y=null},a===void 0&&i.setContentType(null),"setRequestHeader"in y&&Pe.forEach(i.toJSON(),function(N,A){y.setRequestHeader(A,N)}),Pe.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),o&&o!=="json"&&(y.responseType=s.responseType),u&&([p,m]=w1(u,!0),y.addEventListener("progress",p)),l&&y.upload&&([f,h]=w1(l),y.upload.addEventListener("progress",f),y.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(d=b=>{y&&(n(!b||b.type?new Uf(null,e,y):b),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const w=BO(s.url);if(w&&Fs.protocols.indexOf(w)===-1){n(new tr("Unsupported protocol "+w+":",tr.ERR_BAD_REQUEST,e));return}y.send(a||null)})},GO=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,o();const d=u instanceof Error?u:this.reason;n.abort(d instanceof tr?d:new Uf(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,a(new tr(`timeout ${t} of ms exceeded`,tr.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:l}=n;return l.unsubscribe=()=>Pe.asap(o),l}},YO=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},XO=async function*(e,t){for await(const r of JO(e))yield*YO(r,t)},JO=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},qN=(e,t,r,n)=>{const s=XO(e,t);let a=0,i,o=l=>{i||(i=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:d}=await s.next();if(u){o(),l.close();return}let f=d.byteLength;if(r){let p=a+=f;r(p)}l.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(l){return o(l),s.return()}},{highWaterMark:2})},WN=64*1024,{isFunction:Dm}=Pe,QO=(({Request:e,Response:t})=>({Request:e,Response:t}))(Pe.global),{ReadableStream:VN,TextEncoder:KN}=Pe.global,GN=(e,...t)=>{try{return!!e(...t)}catch{return!1}},ZO=e=>{e=Pe.merge.call({skipUndefined:!0},QO,e);const{fetch:t,Request:r,Response:n}=e,s=t?Dm(t):typeof fetch=="function",a=Dm(r),i=Dm(n);if(!s)return!1;const o=s&&Dm(VN),l=s&&(typeof KN=="function"?(m=>g=>m.encode(g))(new KN):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=a&&o&&GN(()=>{let m=!1;const g=new r(Fs.origin,{body:new VN,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),d=i&&o&&GN(()=>Pe.isReadableStream(new n("").body)),f={stream:d&&(m=>m.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!f[m]&&(f[m]=(g,y)=>{let x=g&&g[m];if(x)return x.call(g);throw new tr(`Response type '${m}' is not supported`,tr.ERR_NOT_SUPPORT,y)})});const p=async m=>{if(m==null)return 0;if(Pe.isBlob(m))return m.size;if(Pe.isSpecCompliantForm(m))return(await new r(Fs.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(Pe.isArrayBufferView(m)||Pe.isArrayBuffer(m))return m.byteLength;if(Pe.isURLSearchParams(m)&&(m=m+""),Pe.isString(m))return(await l(m)).byteLength},h=async(m,g)=>{const y=Pe.toFiniteNumber(m.getContentLength());return y??p(g)};return async m=>{let{url:g,method:y,data:x,signal:w,cancelToken:b,timeout:N,onDownloadProgress:A,onUploadProgress:P,responseType:j,headers:D,withCredentials:E="same-origin",fetchOptions:I}=Fj(m),_=t||fetch;j=j?(j+"").toLowerCase():"text";let L=GO([w,b&&b.toAbortSignal()],N),M=null;const K=L&&L.unsubscribe&&(()=>{L.unsubscribe()});let Z;try{if(P&&u&&y!=="get"&&y!=="head"&&(Z=await h(D,x))!==0){let pe=new r(g,{method:"POST",body:x,duplex:"half"}),C;if(Pe.isFormData(x)&&(C=pe.headers.get("content-type"))&&D.setContentType(C),pe.body){const[R,B]=$N(Z,w1(zN(P)));x=qN(pe.body,WN,R,B)}}Pe.isString(E)||(E=E?"include":"omit");const ae=a&&"credentials"in r.prototype,he={...I,signal:L,method:y.toUpperCase(),headers:D.normalize().toJSON(),body:x,duplex:"half",credentials:ae?E:void 0};M=a&&new r(g,he);let re=await(a?_(M,I):_(g,he));const U=d&&(j==="stream"||j==="response");if(d&&(A||U&&K)){const pe={};["status","statusText","headers"].forEach(O=>{pe[O]=re[O]});const C=Pe.toFiniteNumber(re.headers.get("content-length")),[R,B]=A&&$N(C,w1(zN(A),!0))||[];re=new n(qN(re.body,WN,R,()=>{B&&B(),K&&K()}),pe)}j=j||"text";let ue=await f[Pe.findKey(f,j)||"text"](re,m);return!U&&K&&K(),await new Promise((pe,C)=>{Pj(pe,C,{data:ue,headers:ga.from(re.headers),status:re.status,statusText:re.statusText,config:m,request:M})})}catch(ae){throw K&&K(),ae&&ae.name==="TypeError"&&/Load failed|fetch/i.test(ae.message)?Object.assign(new tr("Network Error",tr.ERR_NETWORK,m,M),{cause:ae.cause||ae}):tr.from(ae,ae&&ae.code,m,M)}}},eM=new Map,Dj=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,l,u,d=eM;for(;o--;)l=a[o],u=d.get(l),u===void 0&&d.set(l,u=o?new Map:ZO(t)),d=u;return u};Dj();const xb={http:xO,xhr:KO,fetch:{get:Dj}};Pe.forEach(xb,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const YN=e=>`- ${e}`,tM=e=>Pe.isFunction(e)||e===null||e===!1;function rM(e,t){e=Pe.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!tM(n)&&(s=xb[(o=String(n)).toLowerCase()],s===void 0))throw new tr(`Unknown adapter '${o}'`);if(s&&(Pe.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(YN).join(`
`):" "+YN(i[0]):"as no adapter specified";throw new tr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const Rj={getAdapter:rM,adapters:xb};function Z2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Uf(null,e)}function XN(e){return Z2(e),e.headers=ga.from(e.headers),e.data=Q2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Rj.getAdapter(e.adapter||Ep.adapter,e)(e).then(function(n){return Z2(e),n.data=Q2.call(e,e.transformResponse,n),n.headers=ga.from(n.headers),n},function(n){return Tj(n)||(Z2(e),n&&n.response&&(n.response.data=Q2.call(e,e.transformResponse,n.response),n.response.headers=ga.from(n.response.headers))),Promise.reject(n)})}const Ij="1.13.2",Cx={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Cx[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const JN={};Cx.transitional=function(t,r,n){function s(a,i){return"[Axios v"+Ij+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new tr(s(i," has been removed"+(r?" in "+r:"")),tr.ERR_DEPRECATED);return r&&!JN[i]&&(JN[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};Cx.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function nM(e,t,r){if(typeof e!="object")throw new tr("options must be an object",tr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],l=o===void 0||i(o,a,e);if(l!==!0)throw new tr("option "+a+" must be "+l,tr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new tr("Unknown option "+a,tr.ERR_BAD_OPTION)}}const jg={assertOptions:nM,validators:Cx},Zi=jg.validators;let Nu=class{constructor(t){this.defaults=t||{},this.interceptors={request:new BN,response:new BN}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Iu(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&jg.assertOptions(n,{silentJSONParsing:Zi.transitional(Zi.boolean),forcedJSONParsing:Zi.transitional(Zi.boolean),clarifyTimeoutError:Zi.transitional(Zi.boolean)},!1),s!=null&&(Pe.isFunction(s)?r.paramsSerializer={serialize:s}:jg.assertOptions(s,{encode:Zi.function,serialize:Zi.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),jg.assertOptions(r,{baseUrl:Zi.spelling("baseURL"),withXsrfToken:Zi.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Pe.merge(a.common,a[r.method]);a&&Pe.forEach(["delete","get","head","post","put","patch","common"],m=>{delete a[m]}),r.headers=ga.concat(i,a);const o=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(l=l&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let d,f=0,p;if(!l){const m=[XN.bind(this),void 0];for(m.unshift(...o),m.push(...u),p=m.length,d=Promise.resolve(r);f<p;)d=d.then(m[f++],m[f++]);return d}p=o.length;let h=r;for(;f<p;){const m=o[f++],g=o[f++];try{h=m(h)}catch(y){g.call(this,y);break}}try{d=XN.call(this,h)}catch(m){return Promise.reject(m)}for(f=0,p=u.length;f<p;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=Iu(this.defaults,t);const r=Lj(t.baseURL,t.url,t.allowAbsoluteUrls);return Aj(r,t.params,t.paramsSerializer)}};Pe.forEach(["delete","get","head","options"],function(t){Nu.prototype[t]=function(r,n){return this.request(Iu(n||{},{method:t,url:r,data:(n||{}).data}))}});Pe.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(Iu(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}Nu.prototype[t]=r(),Nu.prototype[t+"Form"]=r(!0)});let sM=class Oj{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new Uf(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Oj(function(s){t=s}),cancel:t}}};function aM(e){return function(r){return e.apply(null,r)}}function iM(e){return Pe.isObject(e)&&e.isAxiosError===!0}const nw={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(nw).forEach(([e,t])=>{nw[t]=e});function Mj(e){const t=new Nu(e),r=mj(Nu.prototype.request,t);return Pe.extend(r,Nu.prototype,t,{allOwnKeys:!0}),Pe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return Mj(Iu(e,s))},r}const fn=Mj(Ep);fn.Axios=Nu;fn.CanceledError=Uf;fn.CancelToken=sM;fn.isCancel=Tj;fn.VERSION=Ij;fn.toFormData=jx;fn.AxiosError=tr;fn.Cancel=fn.CanceledError;fn.all=function(t){return Promise.all(t)};fn.spread=aM;fn.isAxiosError=iM;fn.mergeConfig=Iu;fn.AxiosHeaders=ga;fn.formToJSON=e=>Cj(Pe.isHTMLForm(e)?new FormData(e):e);fn.getAdapter=Rj.getAdapter;fn.HttpStatusCode=nw;fn.default=fn;const{Axios:Gre,AxiosError:Yre,CanceledError:Xre,isCancel:Jre,CancelToken:Qre,VERSION:Zre,all:ene,Cancel:tne,isAxiosError:rne,spread:nne,toFormData:sne,AxiosHeaders:ane,HttpStatusCode:ine,formToJSON:one,getAdapter:lne,mergeConfig:cne}=fn,ev={},oM=()=>{var t;if(typeof window<"u"&&((t=window.electron)!=null&&t.apiUrl)){const r=window.electron.apiUrl;return console.log(" [API] Using Electron API URL:",r),`${r}/api`}if(typeof window<"u"&&window.location.hostname!=="localhost"&&window.location.hostname!=="127.0.0.1")return console.log(" [API] Web production mode, using relative path /api"),"/api";const e=ev==null?void 0:ev.VITE_API_URL;return e?(console.log(" [API] Dev mode, using VITE_API_URL:",e),e):typeof window<"u"&&window.location.hostname!=="localhost"?(console.log(" [API] Production mode, using relative path"),"/api"):(console.log(" [API] Development mode, using localhost"),"http://localhost:3000/api")};class lM{constructor(){Tt(this,"client");const t=oM();this.client=fn.create({baseURL:t,headers:{"Content-Type":"application/json"}}),console.log("API Service initialized with baseURL:",t),this.client.interceptors.request.use(r=>{var s;console.log("API Request:",(s=r.method)==null?void 0:s.toUpperCase(),r.url,r.data);const n=localStorage.getItem("authToken");return n&&(r.headers.Authorization=`Bearer ${n}`),r},r=>Promise.reject(r)),this.client.interceptors.response.use(r=>{console.log("API Response:",r.status,r.config.url,r.data);const n=r.headers["x-new-token"];return n&&(console.log(" Token auto-refreshed by server, updating storage"),this.updateStoredToken(n)),r},async r=>{var a,i,o,l,u,d,f,p,h;const n=(a=r.response)==null?void 0:a.status;console.error("API Error:",n,(i=r.config)==null?void 0:i.url,(o=r.response)==null?void 0:o.data);const s=r.config;if(n&&n>=500)return console.warn(` Server error ${n} - session preserved, app will work offline`),Promise.reject(r);if(!r.response&&r.code==="ERR_NETWORK")return console.warn(" Network error - session preserved, app will work offline"),Promise.reject(r);if(n===401&&s&&!((l=s.url)!=null&&l.includes("/auth/login"))&&!((u=s.url)!=null&&u.includes("/auth/register"))&&!((d=s.url)!=null&&d.includes("/auth/refresh"))&&!s._retry){s._retry=!0;const m=localStorage.getItem("authToken");if(m)try{console.log(" Attempting to refresh token...");const y=await fn.create({baseURL:this.client.defaults.baseURL,headers:{"Content-Type":"application/json"},timeout:1e4}).post("/auth/refresh",{token:m});if((p=(f=y.data)==null?void 0:f.data)!=null&&p.token){const x=y.data.data.token;return console.log(" Token refreshed successfully"),this.updateStoredToken(x),s.headers=s.headers||{},s.headers.Authorization=`Bearer ${x}`,this.client.request(s)}}catch(g){const y=(h=g.response)==null?void 0:h.status;if(console.log(" Token refresh failed:",y||g.message),(y===401||y===403)&&this.handleLogout(),y&&y>=500)return console.warn(" Server error during refresh - session preserved"),Promise.reject(r)}else this.handleLogout()}return Promise.reject(r)})}updateStoredToken(t){localStorage.setItem("authToken",t);const r=localStorage.getItem("auth-storage");if(r)try{const n=JSON.parse(r);n.state&&(n.state.token=t,localStorage.setItem("auth-storage",JSON.stringify(n)))}catch(n){console.warn("Failed to update auth storage:",n)}}handleLogout(){console.log(" Logging out user due to auth failure"),localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp");const t=window.location.hash.includes("#/");(t?window.location.hash.replace("#",""):window.location.pathname).includes("/login")||(t?window.location.hash="#/login":window.location.href="/login")}async refreshToken(t){return(await this.client.post("/auth/refresh",{token:t})).data}async register(t){return(await this.client.post("/auth/register",t)).data}async login(t,r){return(await this.client.post("/auth/login",{email:t,password:r})).data}async getCurrentUser(){return(await this.client.get("/auth/me")).data}async getProjects(t){return(await this.client.get("/projects",{params:{status:t}})).data}async getProject(t){return(await this.client.get(`/projects/${t}`)).data}async createProject(t){return(await this.client.post("/projects",t)).data}async updateProject(t,r){return(await this.client.put(`/projects/${t}`,r)).data}async deleteProject(t){return(await this.client.delete(`/projects/${t}`)).data}async getDeletedProjects(){return(await this.client.get("/projects/deleted/list")).data}async restoreProject(t){return(await this.client.post(`/projects/${t}/restore`)).data}async getBordereaux(t){return(await this.client.get(`/bordereau/project/${t}`)).data}async getPeriodes(t){return(await this.client.get(`/periodes/project/${t}`)).data}async createBordereau(t){return(await this.client.post("/bordereau",t)).data}async updateBordereau(t,r){return(await this.client.put(`/bordereau/${t}`,r)).data}async deleteBordereau(t){return(await this.client.delete(`/bordereau/${t}`)).data}async getMetres(t){return(await this.client.get(`/metre/project/${t}`)).data}async createMetre(t){return(await this.client.post("/metre",t)).data}async updateMetre(t,r){return(await this.client.put(`/metre/${t}`,r)).data}async deleteMetre(t){return(await this.client.delete(`/metre/${t}`)).data}async getDecompts(t){return(await this.client.get(`/decompt/project/${t}`)).data}async createDecompt(t){return(await this.client.post("/decompt",t)).data}async updateDecompt(t,r){return(await this.client.put(`/decompt/${t}`,r)).data}async deleteDecompt(t){return(await this.client.delete(`/decompt/${t}`)).data}async uploadPhoto(t,r,n){const s=new FormData;return s.append("photo",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/photos",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getPhotos(t){return(await this.client.get(`/photos/project/${t}`)).data}async deletePhoto(t){return(await this.client.delete(`/photos/${t}`)).data}async getPVs(t){return(await this.client.get(`/pv/project/${t}`)).data}async createPV(t){return(await this.client.post("/pv",t)).data}async updatePV(t,r){return(await this.client.put(`/pv/${t}`,r)).data}async deletePV(t){return(await this.client.delete(`/pv/${t}`)).data}async uploadAttachment(t,r,n){const s=new FormData;return s.append("file",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/attachments",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getAttachments(t,r){return(await this.client.get(`/attachments/project/${t}`,{params:{category:r}})).data}async deleteAttachment(t){return(await this.client.delete(`/attachments/${t}`)).data}async syncPush(t,r){return(await this.client.post("/sync/push",{operations:t,deviceId:r})).data}async syncPull(t,r){return(await this.client.get("/sync/pull",{params:{lastSync:t,deviceId:r}})).data}async getLastSyncTime(){return(await this.client.get("/sync/last")).data}async resolveConflict(t,r,n){return(await this.client.post(`/sync/conflict/${t}`,{resolution:r,mergedData:n})).data}async getBordereau(t){return(await this.client.get(`/bordereau/${t}`)).data}async createPeriode(t){return(await this.client.post("/periodes",t)).data}async updatePeriode(t,r){return(await this.client.put(`/periodes/${t}`,r)).data}async deletePeriode(t){return(await this.client.delete(`/periodes/${t}`)).data}async permanentDeleteProject(t){return(await this.client.delete(`/projects/${t}/permanent`)).data}async getCompanies(){try{const t=await this.getProjects(),r=(t==null?void 0:t.data)||t||[],n=new Map;if(Array.isArray(r))for(const s of r){const a=s.societe||s.socit;if(a&&a.trim()){const i=a.trim().toLowerCase();n.has(i)||n.set(i,{nom:a.trim(),rc:s.rc||"",cnss:s.cnss||""})}}return console.log(` ${n.size} entreprises uniques trouves`),Array.from(n.values())}catch(t){return console.error("Error fetching companies from projects:",t),[]}}async get(t){return(await this.client.get(t)).data}async post(t,r){return(await this.client.post(t,r)).data}async put(t,r){return(await this.client.put(t,r)).data}async delete(t){return(await this.client.delete(t)).data}async postFormData(t,r,n){return(await this.client.post(t,r,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:a=>{if(n&&a.total){const i=Math.round(a.loaded*100/a.total);n(i)}}})).data}}const mt=new lM,Vr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,In=Object.keys,Is=Array.isArray;function ra(e,t){return typeof t!="object"||In(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||Vr.Promise||(Vr.Promise=Promise);const W0=Object.getPrototypeOf,cM={}.hasOwnProperty;function Ia(e,t){return cM.call(e,t)}function Tf(e,t){typeof t=="function"&&(t=t(W0(e))),(typeof Reflect>"u"?In:Reflect.ownKeys)(t).forEach(r=>{ll(e,r,t[r])})}const Bj=Object.defineProperty;function ll(e,t,r,n){Bj(e,t,ra(r&&Ia(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Zd(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ll(e.prototype,"constructor",e),{extend:Tf.bind(null,e.prototype)}}}}const uM=Object.getOwnPropertyDescriptor;function vb(e,t){let r;return uM(e,t)||(r=W0(e))&&vb(r,t)}const dM=[].slice;function b1(e,t,r){return dM.call(e,t,r)}function Uj(e,t){return t(e)}function Bh(e){if(!e)throw new Error("Assertion Failed")}function $j(e){Vr.setImmediate?setImmediate(e):setTimeout(e,0)}function zj(e,t){return e.reduce((r,n,s)=>{var a=t(n,s);return a&&(r[a[0]]=a[1]),r},{})}function cl(e,t){if(typeof t=="string"&&Ia(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,s=t.length;n<s;++n){var a=cl(e,t[n]);r.push(a)}return r}var i=t.indexOf(".");if(i!==-1){var o=e[t.substr(0,i)];return o==null?void 0:cl(o,t.substr(i+1))}}function Ii(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Bh(typeof r!="string"&&"length"in r);for(var n=0,s=t.length;n<s;++n)Ii(e,t[n],r[n])}else{var a=t.indexOf(".");if(a!==-1){var i=t.substr(0,a),o=t.substr(a+1);if(o==="")r===void 0?Is(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=r;else{var l=e[i];l&&Ia(e,i)||(l=e[i]={}),Ii(l,o,r)}}else r===void 0?Is(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Hj(e){var t={};for(var r in e)Ia(e,r)&&(t[r]=e[r]);return t}const fM=[].concat;function qj(e){return fM.apply([],e)}const Wj="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(qj([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>Vr[e]),hM=Wj.map(e=>Vr[e]);zj(Wj,e=>[e,!0]);let Xl=null;function Ap(e){Xl=typeof WeakMap<"u"&&new WeakMap;const t=sw(e);return Xl=null,t}function sw(e){if(!e||typeof e!="object")return e;let t=Xl&&Xl.get(e);if(t)return t;if(Is(e)){t=[],Xl&&Xl.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(sw(e[r]))}else if(hM.indexOf(e.constructor)>=0)t=e;else{const a=W0(e);for(var s in t=a===Object.prototype?{}:Object.create(a),Xl&&Xl.set(e,t),e)Ia(e,s)&&(t[s]=sw(e[s]))}return t}const{toString:pM}={};function aw(e){return pM.call(e).slice(8,-1)}const iw=typeof Symbol<"u"?Symbol.iterator:"@@iterator",mM=typeof iw=="symbol"?function(e){var t;return e!=null&&(t=e[iw])&&t.apply(e)}:function(){return null},jd={};function tl(e){var t,r,n,s;if(arguments.length===1){if(Is(e))return e.slice();if(this===jd&&typeof e=="string")return[e];if(s=mM(e)){for(r=[];!(n=s.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const yb=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var _o=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Vj(e,t){_o=e,Kj=t}var Kj=()=>!0;const gM=!new Error("").stack;function Gu(){if(gM)try{throw Gu.arguments,new Error}catch(e){return e}return new Error}function ow(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(Kj).map(n=>`
`+n).join("")):""}var Gj=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],wb=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Gj),xM={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function ef(e,t){this._e=Gu(),this.name=e,this.message=t}function Yj(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,s)=>s.indexOf(r)===n).join(`
`)}function N1(e,t,r,n){this._e=Gu(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=Yj(e,t)}function n0(e,t){this._e=Gu(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=Yj(e,t)}Zd(ef).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+ow(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Zd(N1).from(ef),Zd(n0).from(ef);var bb=wb.reduce((e,t)=>(e[t]=t+"Error",e),{});const vM=ef;var Ut=wb.reduce((e,t)=>{var r=t+"Error";function n(s,a){this._e=Gu(),this.name=r,s?typeof s=="string"?(this.message=`${s}${a?`
 `+a:""}`,this.inner=a||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=xM[t]||r,this.inner=null)}return Zd(n).from(vM),e[t]=n,e},{});Ut.Syntax=SyntaxError,Ut.Type=TypeError,Ut.Range=RangeError;var QN=Gj.reduce((e,t)=>(e[t+"Error"]=Ut[t],e),{}),Cg=wb.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Ut[t]),e),{});function Ir(){}function V0(e){return e}function yM(e,t){return e==null||e===V0?t:function(r){return t(e(r))}}function Ou(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function wM(e,t){return e===Ir?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Ou(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Ou(s,this.onerror):s),a!==void 0?a:r}}function bM(e,t){return e===Ir?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Ou(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Ou(n,this.onerror):n)}}function NM(e,t){return e===Ir?t:function(r){var n=e.apply(this,arguments);ra(r,n);var s=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Ou(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Ou(a,this.onerror):a),n===void 0?i===void 0?void 0:i:ra(n,i)}}function SM(e,t){return e===Ir?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function Nb(e,t){return e===Ir?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,s=arguments.length,a=new Array(s);s--;)a[s]=arguments[s];return r.then(function(){return t.apply(n,a)})}return t.apply(this,arguments)}}Cg.ModifyError=N1,Cg.DexieError=ef,Cg.BulkError=n0;var K0={};const Xj=100,[lw,S1,cw]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,W0(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,W0(t),e]})(),Jj=S1&&S1.then,Tg=lw&&lw.constructor,Sb=!!cw;var uw=!1,kM=cw?()=>{cw.then(Rm)}:Vr.setImmediate?setImmediate.bind(null,Rm):Vr.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Rm(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Rm,0)},s0=function(e,t){Uh.push([e,t]),k1&&(kM(),k1=!1)},dw=!0,k1=!0,Su=[],Pg=[],fw=null,hw=V0,tf={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:tS,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{tS(e[0],e[1])}catch{}})}},Rt=tf,Uh=[],ku=0,Lg=[];function vt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Ir,this._lib=!1;var t=this._PSD=Rt;if(_o&&(this._stackHolder=Gu(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==K0)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&mw(this,this._value))}this._state=null,this._value=null,++t.ref,Zj(this,e)}const pw={get:function(){var e=Rt,t=_1;function r(n,s){var a=!e.global&&(e!==Rt||t!==_1);const i=a&&!xl();var o=new vt((l,u)=>{kb(this,new Qj(E1(n,e,a,i),E1(s,e,a,i),l,u,e))});return _o&&rC(o,this),o}return r.prototype=K0,r},set:function(e){ll(this,"then",e&&e.prototype===K0?pw:{get:function(){return e},set:pw.set})}};function Qj(e,t,r,n,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=s}function Zj(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&jp();r&&typeof r.then=="function"?Zj(e,(s,a)=>{r instanceof vt?r._then(s,a):r.then(s,a)}):(e._state=!0,e._value=r,eC(e)),n&&Cp()}},mw.bind(null,e))}catch(r){mw(e,r)}}function mw(e,t){if(Pg.push(t),e._state===null){var r=e._lib&&jp();t=hw(t),e._state=!1,e._value=t,_o&&t!==null&&typeof t=="object"&&!t._promise&&function(n,s,a){try{n.apply(null,a)}catch{}}(()=>{var n=vb(t,"stack");t._promise=e,ll(t,"stack",{get:()=>uw?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){Su.some(s=>s._value===n._value)||Su.push(n)}(e),eC(e),r&&Cp()}}function eC(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)kb(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),ku===0&&(++ku,s0(()=>{--ku==0&&_b()},[]))}function kb(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ku,s0(_M,[r,e,t])}else e._listeners.push(t)}function _M(e,t,r){try{fw=t;var n,s=t._value;t._state?n=e(s):(Pg.length&&(Pg=[]),n=e(s),Pg.indexOf(s)===-1&&function(a){for(var i=Su.length;i;)if(Su[--i]._value===a._value)return void Su.splice(i,1)}(t)),r.resolve(n)}catch(a){r.reject(a)}finally{fw=null,--ku==0&&_b(),--r.psd.ref||r.psd.finalize()}}function tC(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var s,a,i=e._value;i!=null?(s=i.name||"Error",a=i.message||i,n=ow(i,0)):(s=i,a=""),t.push(s+(a?": "+a:"")+n)}return _o&&((n=ow(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&tC(e._prev,t,r)),t}function rC(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Rm(){jp()&&Cp()}function jp(){var e=dw;return dw=!1,k1=!1,e}function Cp(){var e,t,r;do for(;Uh.length>0;)for(e=Uh,Uh=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(Uh.length>0);dw=!0,k1=!0}function _b(){var e=Su;Su=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=Lg.slice(0),r=t.length;r;)t[--r]()}function Im(e){return new vt(K0,!1,e)}function Xr(e,t){var r=Rt;return function(){var n=jp(),s=Rt;try{return Cc(r,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Cc(s,!1),n&&Cp()}}}Tf(vt.prototype,{then:pw,_then:function(e,t){kb(this,new Qj(null,null,e,t,Rt))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):Im(n)):this.then(null,n=>n&&n.name===t?r(n):Im(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),Im(t)))},stack:{get:function(){if(this._stack)return this._stack;try{uw=!0;var e=tC(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{uw=!1}}},timeout:function(e,t){return e<1/0?new vt((r,n)=>{var s=setTimeout(()=>n(new Ut.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&ll(vt.prototype,Symbol.toStringTag,"Dexie.Promise"),tf.env=nC(),Tf(vt,{all:function(){var e=tl.apply(null,arguments).map(Om);return new vt(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((s,a)=>vt.resolve(s).then(i=>{e[a]=i,--n||t(e)},r))})},resolve:e=>{if(e instanceof vt)return e;if(e&&typeof e.then=="function")return new vt((r,n)=>{e.then(r,n)});var t=new vt(K0,!0,e);return rC(t,fw),t},reject:Im,race:function(){var e=tl.apply(null,arguments).map(Om);return new vt((t,r)=>{e.map(n=>vt.resolve(n).then(t,r))})},PSD:{get:()=>Rt,set:e=>Rt=e},totalEchoes:{get:()=>_1},newPSD:jc,usePSD:zf,scheduler:{get:()=>s0,set:e=>{s0=e}},rejectionMapper:{get:()=>hw,set:e=>{hw=e}},follow:(e,t)=>new vt((r,n)=>jc((s,a)=>{var i=Rt;i.unhandleds=[],i.onunhandled=a,i.finalize=Ou(function(){(function(o){function l(){o(),Lg.splice(Lg.indexOf(l),1)}Lg.push(l),++ku,s0(()=>{--ku==0&&_b()},[])})(()=>{this.unhandleds.length===0?s():a(this.unhandleds[0])})},i.finalize),e()},t,r,n))}),Tg&&(Tg.allSettled&&ll(vt,"allSettled",function(){const e=tl.apply(null,arguments).map(Om);return new vt(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((s,a)=>vt.resolve(s).then(i=>n[a]={status:"fulfilled",value:i},i=>n[a]={status:"rejected",reason:i}).then(()=>--r||t(n)))})}),Tg.any&&typeof AggregateError<"u"&&ll(vt,"any",function(){const e=tl.apply(null,arguments).map(Om);return new vt((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const s=new Array(n);e.forEach((a,i)=>vt.resolve(a).then(o=>t(o),o=>{s[i]=o,--n||r(new AggregateError(s))}))})}));const Ds={awaits:0,echoes:0,id:0};var EM=0,Fg=[],tv=0,_1=0,AM=0;function jc(e,t,r,n){var s=Rt,a=Object.create(s);a.parent=s,a.ref=0,a.global=!1,a.id=++AM;var i=tf.env;a.env=Sb?{Promise:vt,PromiseProp:{value:vt,configurable:!0,writable:!0},all:vt.all,race:vt.race,allSettled:vt.allSettled,any:vt.any,resolve:vt.resolve,reject:vt.reject,nthen:ZN(i.nthen,a),gthen:ZN(i.gthen,a)}:{},t&&ra(a,t),++s.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=zf(a,e,r,n);return a.ref===0&&a.finalize(),o}function $f(){return Ds.id||(Ds.id=++EM),++Ds.awaits,Ds.echoes+=Xj,Ds.id}function xl(){return!!Ds.awaits&&(--Ds.awaits==0&&(Ds.id=0),Ds.echoes=Ds.awaits*Xj,!0)}function Om(e){return Ds.echoes&&e&&e.constructor===Tg?($f(),e.then(t=>(xl(),t),t=>(xl(),Xn(t)))):e}function jM(e){++_1,Ds.echoes&&--Ds.echoes!=0||(Ds.echoes=Ds.id=0),Fg.push(Rt),Cc(e,!0)}function CM(){var e=Fg[Fg.length-1];Fg.pop(),Cc(e,!1)}function Cc(e,t){var r=Rt;if((t?!Ds.echoes||tv++&&e===Rt:!tv||--tv&&e===Rt)||sC(t?jM.bind(null,e):CM),e!==Rt&&(Rt=e,r===tf&&(tf.env=nC()),Sb)){var n=tf.env.Promise,s=e.env;S1.then=s.nthen,n.prototype.then=s.gthen,(r.global||e.global)&&(Object.defineProperty(Vr,"Promise",s.PromiseProp),n.all=s.all,n.race=s.race,n.resolve=s.resolve,n.reject=s.reject,s.allSettled&&(n.allSettled=s.allSettled),s.any&&(n.any=s.any))}}function nC(){var e=Vr.Promise;return Sb?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Vr,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:S1.then,gthen:e.prototype.then}:{}}function zf(e,t,r,n,s){var a=Rt;try{return Cc(e,!0),t(r,n,s)}finally{Cc(a,!1)}}function sC(e){Jj.call(lw,e)}function E1(e,t,r,n){return typeof e!="function"?e:function(){var s=Rt;r&&$f(),Cc(t,!0);try{return e.apply(this,arguments)}finally{Cc(s,!1),n&&sC(xl)}}}function ZN(e,t){return function(r,n){return e.call(this,E1(r,t),E1(n,t))}}(""+Jj).indexOf("[native code]")===-1&&($f=xl=Ir);const eS="unhandledrejection";function tS(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,s={promise:t,reason:e};if(Vr.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(eS,!0,!0),ra(n,s)):Vr.CustomEvent&&ra(n=new CustomEvent(eS,{detail:s}),s),n&&Vr.dispatchEvent&&(dispatchEvent(n),!Vr.PromiseRejectionEvent&&Vr.onunhandledrejection))try{Vr.onunhandledrejection(n)}catch{}_o&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Xn=vt.reject;function gw(e,t,r,n){if(e.idbdb&&(e._state.openComplete||Rt.letThrough||e._vip)){var s=e._createTransaction(t,r,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===bb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>gw(e,t,r,n))):Xn(a)}return s._promise(t,(a,i)=>jc(()=>(Rt.trans=s,n(a,i,s)))).then(a=>s._completion.then(()=>a))}if(e._state.openComplete)return Xn(new Ut.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Xn(new Ut.DatabaseClosed);e.open().catch(Ir)}return e._state.dbReadyPromise.then(()=>gw(e,t,r,n))}const rS="3.2.7",du="",xw=-1/0,qo="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",aC="String expected.",a0=[],Tx=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),TM=Tx,PM=Tx,iC=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),Px="__dbnames",rv="readonly",nv="readwrite";function Mu(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const oC={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Mm(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=Ap(t))[e],t)}let LM=class{_trans(t,r,n){const s=this._tx||Rt.trans,a=this.name;function i(l,u,d){if(!d.schema[a])throw new Ut.NotFound("Table "+a+" not part of transaction");return r(d.idbtrans,d)}const o=jp();try{return s&&s.db===this.db?s===Rt.trans?s._promise(t,i,n):jc(()=>s._promise(t,i,n),{trans:s,transless:Rt.transless||Rt}):gw(this.db,t,[this.name],i)}finally{o&&Cp()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(s=>this.hook.reading.fire(s))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Is(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=In(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&r.every(d=>u.keyPath.indexOf(d)>=0)){for(let d=0;d<r.length;++d)if(r.indexOf(u.keyPath[d])===-1)return!1;return!0}return!1}).sort((u,d)=>u.keyPath.length-d.keyPath.length)[0];if(n&&this.db._maxKey!==du){const u=n.keyPath.slice(0,r.length);return this.where(u).equals(u.map(d=>t[d]))}!n&&_o&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:s}=this.schema,a=this.db._deps.indexedDB;function i(u,d){try{return a.cmp(u,d)===0}catch{return!1}}const[o,l]=r.reduce(([u,d],f)=>{const p=s[f],h=t[f];return[u||p,u||!p?Mu(d,p&&p.multi?m=>{const g=cl(m,f);return Is(g)&&g.some(y=>i(h,y))}:m=>i(h,cl(m,f))):d]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Is(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const s=Object.create(t.prototype);for(var a in n)if(Ia(n,a))try{s[a]=n[a]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){ra(this,t)})}add(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Mm(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:r!=null?[r]:null,values:[a]})).then(i=>i.numFailures?vt.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Ii(t,s,i)}catch{}return i})}update(t,r){if(typeof t!="object"||Is(t))return this.where(":id").equals(t).modify(r);{const n=cl(t,this.schema.primKey.keyPath);if(n===void 0)return Xn(new Ut.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?In(r).forEach(s=>{Ii(t,s,r[s])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Mm(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[a],keys:r!=null?[r]:null})).then(i=>i.numFailures?vt.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Ii(t,s,i)}catch{}return i})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?vt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:oC})).then(t=>t.numFailures?vt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new Ut.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new Ut.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let d=l&&o?t.map(Mm(l)):t;return this.core.mutate({trans:i,type:"add",keys:s,values:d,wantResults:a}).then(({numFailures:f,results:p,lastResult:h,failures:m})=>{if(f===0)return a?p:h;throw new n0(`${this.name}.bulkAdd(): ${f} of ${u} operations failed`,m)})})}bulkPut(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new Ut.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new Ut.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let d=l&&o?t.map(Mm(l)):t;return this.core.mutate({trans:i,type:"put",keys:s,values:d,wantResults:a}).then(({numFailures:f,results:p,lastResult:h,failures:m})=>{if(f===0)return a?p:h;throw new n0(`${this.name}.bulkPut(): ${f} of ${u} operations failed`,m)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:s,failures:a})=>{if(n===0)return s;throw new n0(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,a)})}};function i0(e){var t={},r=function(i,o){if(o){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return t[i].subscribe.apply(null,u),e}if(typeof i=="string")return t[i]};r.addEventType=a;for(var n=1,s=arguments.length;n<s;++n)a(arguments[n]);return r;function a(i,o,l){if(typeof i!="object"){var u;o||(o=SM),l||(l=Ir);var d={subscribers:[],fire:l,subscribe:function(f){d.subscribers.indexOf(f)===-1&&(d.subscribers.push(f),d.fire=o(d.fire,f))},unsubscribe:function(f){d.subscribers=d.subscribers.filter(function(p){return p!==f}),d.fire=d.subscribers.reduce(o,l)}};return t[i]=r[i]=d,d}In(u=i).forEach(function(f){var p=u[f];if(Is(p))a(f,u[f][0],u[f][1]);else{if(p!=="asap")throw new Ut.InvalidArgument("Invalid event config");var h=a(f,V0,function(){for(var m=arguments.length,g=new Array(m);m--;)g[m]=arguments[m];h.subscribers.forEach(function(y){$j(function(){y.apply(null,g)})})})}})}}function jh(e,t){return Zd(t).from({prototype:e}),t}function md(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function sv(e,t){e.filter=Mu(e.filter,t)}function av(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>Mu(n(),t()):t,e.justLimit=r&&!n}function Dg(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Ut.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function nS(e,t,r){const n=Dg(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function Bm(e,t,r,n){const s=e.replayFilter?Mu(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},i=(o,l,u)=>{if(!s||s(l,u,p=>l.stop(p),p=>l.fail(p))){var d=l.primaryKey,f=""+d;f==="[object ArrayBuffer]"&&(f=""+new Uint8Array(d)),Ia(a,f)||(a[f]=!0,t(o,l,u))}};return Promise.all([e.or._iterate(i,r),sS(nS(e,n,r),e.algorithm,i,!e.keysOnly&&e.valueMapper)])}return sS(nS(e,n,r),Mu(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function sS(e,t,r,n){var s=Xr(n?(a,i,o)=>r(n(a),i,o):r);return e.then(a=>{if(a)return a.start(()=>{var i=()=>a.continue();t&&!t(a,o=>i=o,o=>{a.stop(o),i=Ir},o=>{a.fail(o),i=Ir})||s(a.value,a,o=>i=o),i()})})}function Qs(e,t){try{const r=aS(e),n=aS(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(s,a){const i=s.length,o=a.length,l=i<o?i:o;for(let u=0;u<l;++u)if(s[u]!==a[u])return s[u]<a[u]?-1:1;return i===o?0:i<o?-1:1}(iS(e),iS(t));case"Array":return function(s,a){const i=s.length,o=a.length,l=i<o?i:o;for(let u=0;u<l;++u){const d=Qs(s[u],a[u]);if(d!==0)return d}return i===o?0:i<o?-1:1}(e,t)}}catch{}return NaN}function aS(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=aw(e);return r==="ArrayBuffer"?"binary":r}function iS(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}let FM=class{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Xn.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Xn.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=Mu(r.algorithm,t)}_iterate(t,r){return Bm(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&ra(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>Bm(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,s=n.table.core;if(md(n,!0))return s.count({trans:r,query:{index:Dg(n,s.schema),range:n.range}}).then(i=>Math.min(i,n.limit));var a=0;return Bm(n,()=>(++a,!1),r,s).then(()=>a)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),s=n[0],a=n.length-1;function i(u,d){return d?i(u[n[d]],d-1):u[s]}var o=this._ctx.dir==="next"?1:-1;function l(u,d){var f=i(u,a),p=i(d,a);return f<p?-o:f>p?o:0}return this.toArray(function(u){return u.sort(l)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&md(n,!0)&&n.limit>0){const{valueMapper:s}=n,a=Dg(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:a,range:n.range}}).then(({result:i})=>s?i.map(s):i)}{const s=[];return Bm(n,a=>s.push(a),r,n.table.core).then(()=>s)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,md(r)?av(r,()=>{var n=t;return(s,a)=>n===0||(n===1?(--n,!1):(a(()=>{s.advance(n),n=0}),!1))}):av(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),av(this._ctx,()=>{var r=t;return function(n,s,a){return--r<=0&&s(a),r>=0}},!0),this}until(t,r){return sv(this._ctx,function(n,s,a){return!t(n.value)||(s(a),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return sv(this._ctx,function(s){return t(s.value)}),r=this._ctx,n=t,r.isMatch=Mu(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.primaryKey,s)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&md(r,!0)&&r.limit>0)return this._read(s=>{var a=Dg(r,r.table.core.schema);return r.table.core.query({trans:s,values:!1,limit:r.limit,query:{index:a,range:r.range}})}).then(({result:s})=>s).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return sv(this._ctx,function(s){var a=s.primaryKey.toString(),i=Ia(n,a);return n[a]=!0,!i}),this}modify(t){var r=this._ctx;return this._write(n=>{var s;if(typeof t=="function")s=t;else{var a=In(t),i=a.length;s=function(g){for(var y=!1,x=0;x<i;++x){var w=a[x],b=t[w];cl(g,w)!==b&&(Ii(g,w,b),y=!0)}return y}}const o=r.table.core,{outbound:l,extractKey:u}=o.schema.primaryKey,d=this.db._options.modifyChunkSize||200,f=[];let p=0;const h=[],m=(g,y)=>{const{failures:x,numFailures:w}=y;p+=g-w;for(let b of In(x))f.push(x[b])};return this.clone().primaryKeys().then(g=>{const y=x=>{const w=Math.min(d,g.length-x);return o.getMany({trans:n,keys:g.slice(x,x+w),cache:"immutable"}).then(b=>{const N=[],A=[],P=l?[]:null,j=[];for(let E=0;E<w;++E){const I=b[E],_={value:Ap(I),primKey:g[x+E]};s.call(_,_.value,_)!==!1&&(_.value==null?j.push(g[x+E]):l||Qs(u(I),u(_.value))===0?(A.push(_.value),l&&P.push(g[x+E])):(j.push(g[x+E]),N.push(_.value)))}const D=md(r)&&r.limit===1/0&&(typeof t!="function"||t===iv)&&{index:r.index,range:r.range};return Promise.resolve(N.length>0&&o.mutate({trans:n,type:"add",values:N}).then(E=>{for(let I in E.failures)j.splice(parseInt(I),1);m(N.length,E)})).then(()=>(A.length>0||D&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:P,values:A,criteria:D,changeSpec:typeof t!="function"&&t}).then(E=>m(A.length,E))).then(()=>(j.length>0||D&&t===iv)&&o.mutate({trans:n,type:"delete",keys:j,criteria:D}).then(E=>m(j.length,E))).then(()=>g.length>x+w&&y(x+d))})};return y(0).then(()=>{if(f.length>0)throw new N1("Error modifying one or more objects",f,p,h);return g.length})})})}delete(){var t=this._ctx,r=t.range;return md(t)&&(t.isPrimKey&&!PM||r.type===3)?this._write(n=>{const{primaryKey:s}=t.table.core.schema,a=r;return t.table.core.count({trans:n,query:{index:s,range:a}}).then(i=>t.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(({failures:o,lastResult:l,results:u,numFailures:d})=>{if(d)throw new N1("Could not delete some values",Object.keys(o).map(f=>o[f]),i-d);return i-d}))}):this.modify(iv)}};const iv=(e,t)=>t.value=null;function DM(e,t){return e<t?-1:e===t?0:1}function RM(e,t){return e>t?-1:e===t?0:1}function ja(e,t,r){var n=e instanceof cC?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function gd(e){return new e.Collection(e,()=>lC("")).limit(0)}function IM(e,t,r,n,s,a){for(var i=Math.min(e.length,n.length),o=-1,l=0;l<i;++l){var u=t[l];if(u!==n[l])return s(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):s(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;s(e[l],u)<0&&(o=l)}return i<n.length&&a==="next"?e+r.substr(e.length):i<e.length&&a==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function Um(e,t,r,n){var s,a,i,o,l,u,d,f=r.length;if(!r.every(g=>typeof g=="string"))return ja(e,aC);function p(g){s=function(x){return x==="next"?w=>w.toUpperCase():w=>w.toLowerCase()}(g),a=function(x){return x==="next"?w=>w.toLowerCase():w=>w.toUpperCase()}(g),i=g==="next"?DM:RM;var y=r.map(function(x){return{lower:a(x),upper:s(x)}}).sort(function(x,w){return i(x.lower,w.lower)});o=y.map(function(x){return x.upper}),l=y.map(function(x){return x.lower}),u=g,d=g==="next"?"":n}p("next");var h=new e.Collection(e,()=>Kl(o[0],l[f-1]+n));h._ondirectionchange=function(g){p(g)};var m=0;return h._addAlgorithm(function(g,y,x){var w=g.key;if(typeof w!="string")return!1;var b=a(w);if(t(b,l,m))return!0;for(var N=null,A=m;A<f;++A){var P=IM(w,b,o[A],l[A],i,u);P===null&&N===null?m=A+1:(N===null||i(N,P)>0)&&(N=P)}return y(N!==null?function(){g.continue(N+d)}:x),!1}),h}function Kl(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function lC(e){return{type:1,lower:e,upper:e}}class cC{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,s){n=n!==!1,s=s===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||s)&&(!n||!s)?gd(this):new this.Collection(this,()=>Kl(t,r,!n,!s))}catch{return ja(this,qo)}}equals(t){return t==null?ja(this,qo):new this.Collection(this,()=>lC(t))}above(t){return t==null?ja(this,qo):new this.Collection(this,()=>Kl(t,void 0,!0))}aboveOrEqual(t){return t==null?ja(this,qo):new this.Collection(this,()=>Kl(t,void 0,!1))}below(t){return t==null?ja(this,qo):new this.Collection(this,()=>Kl(void 0,t,!1,!0))}belowOrEqual(t){return t==null?ja(this,qo):new this.Collection(this,()=>Kl(void 0,t))}startsWith(t){return typeof t!="string"?ja(this,aC):this.between(t,t+du,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Um(this,(r,n)=>r.indexOf(n[0])===0,[t],du)}equalsIgnoreCase(t){return Um(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=tl.apply(jd,arguments);return t.length===0?gd(this):Um(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=tl.apply(jd,arguments);return t.length===0?gd(this):Um(this,(r,n)=>n.some(s=>r.indexOf(s)===0),t,du)}anyOf(){const t=tl.apply(jd,arguments);let r=this._cmp;try{t.sort(r)}catch{return ja(this,qo)}if(t.length===0)return gd(this);const n=new this.Collection(this,()=>Kl(t[0],t[t.length-1]));n._ondirectionchange=a=>{r=a==="next"?this._ascending:this._descending,t.sort(r)};let s=0;return n._addAlgorithm((a,i,o)=>{const l=a.key;for(;r(l,t[s])>0;)if(++s,s===t.length)return i(o),!1;return r(l,t[s])===0||(i(()=>{a.continue(t[s])}),!1)}),n}notEqual(t){return this.inAnyRange([[xw,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=tl.apply(jd,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ja(this,qo)}const r=t.reduce((n,s)=>n?n.concat([[n[n.length-1][1],s]]):[[xw,s]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,s=this._ascending,a=this._descending,i=this._min,o=this._max;if(t.length===0)return gd(this);if(!t.every(w=>w[0]!==void 0&&w[1]!==void 0&&s(w[0],w[1])<=0))return ja(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ut.InvalidArgument);const l=!r||r.includeLowers!==!1,u=r&&r.includeUppers===!0;let d,f=s;function p(w,b){return f(w[0],b[0])}try{d=t.reduce(function(w,b){let N=0,A=w.length;for(;N<A;++N){const P=w[N];if(n(b[0],P[1])<0&&n(b[1],P[0])>0){P[0]=i(P[0],b[0]),P[1]=o(P[1],b[1]);break}}return N===A&&w.push(b),w},[]),d.sort(p)}catch{return ja(this,qo)}let h=0;const m=u?w=>s(w,d[h][1])>0:w=>s(w,d[h][1])>=0,g=l?w=>a(w,d[h][0])>0:w=>a(w,d[h][0])>=0;let y=m;const x=new this.Collection(this,()=>Kl(d[0][0],d[d.length-1][1],!l,!u));return x._ondirectionchange=w=>{w==="next"?(y=m,f=s):(y=g,f=a),d.sort(p)},x._addAlgorithm((w,b,N)=>{for(var A=w.key;y(A);)if(++h,h===d.length)return b(N),!1;return!!function(P){return!m(P)&&!g(P)}(A)||(this._cmp(A,d[h][1])===0||this._cmp(A,d[h][0])===0||b(()=>{f===s?w.continue(d[h][0]):w.continue(d[h][1])}),!1)}),x}startsWithAnyOf(){const t=tl.apply(jd,arguments);return t.every(r=>typeof r=="string")?t.length===0?gd(this):this.inAnyRange(t.map(r=>[r,r+du])):ja(this,"startsWithAnyOf() only works with strings")}}function io(e){return Xr(function(t){return G0(t),e(t.target.error),!1})}function G0(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Y0="storagemutated",ec="x-storagemutated-1",Tc=i0(null,Y0);class OM{_lock(){return Bh(!Rt.global),++this._reculock,this._reculock!==1||Rt.global||(Rt.lockOwnerFor=this),this}_unlock(){if(Bh(!Rt.global),--this._reculock==0)for(Rt.global||(Rt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{zf(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Rt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(Bh(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new Ut.DatabaseClosed(n);case"MissingAPIError":throw new Ut.MissingAPI(n.message,n);default:throw new Ut.OpenFailed(n)}if(!this.active)throw new Ut.TransactionInactive;return Bh(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Xr(s=>{G0(s),this._reject(t.error)}),t.onabort=Xr(s=>{G0(s),this.active&&this._reject(new Ut.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=Xr(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&Tc.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Xn(new Ut.ReadOnly("Transaction is readonly"));if(!this.active)return Xn(new Ut.TransactionInactive);if(this._locked())return new vt((a,i)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(a,i)},Rt])});if(n)return jc(()=>{var a=new vt((i,o)=>{this._lock();const l=r(i,o,this);l&&l.then&&l.then(i,o)});return a.finally(()=>this._unlock()),a._lib=!0,a});var s=new vt((a,i)=>{var o=r(a,i,this);o&&o.then&&o.then(a,i)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=vt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var s=r.idbtrans.objectStore(r.storeNames[0]);(function i(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(s.get(-1/0).onsuccess=i)})()}var a=r._waitingFor;return new vt((i,o)=>{n.then(l=>r._waitingQueue.push(Xr(i.bind(null,l))),l=>r._waitingQueue.push(Xr(o.bind(null,l)))).finally(()=>{r._waitingFor===a&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ut.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Ia(r,t))return r[t];const n=this.schema[t];if(!n)throw new Ut.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,n,this);return s.core=this.db.core.table(t),r[t]=s,s}}function vw(e,t,r,n,s,a,i){return{name:e,keyPath:t,unique:r,multi:n,auto:s,compound:a,src:(r&&!i?"&":"")+(n?"*":"")+(s?"++":"")+uC(t)}}function uC(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function dC(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:zj(r,n=>[n.name,n])}}let X0=e=>{try{return e.only([[]]),X0=()=>[[]],[[]]}catch{return X0=()=>du,du}};function yw(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>cl(n,t)}(e):t=>cl(t,e)}function oS(e){return[].slice.call(e)}let MM=0;function o0(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function BM(e,t,r){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:d,lowerOpen:f,upperOpen:p}=l;return u===void 0?d===void 0?null:t.upperBound(d,!!p):d===void 0?t.lowerBound(u,!!f):t.bound(u,d,!!f,!!p)}const{schema:s,hasGetAll:a}=function(l,u){const d=oS(l.objectStoreNames);return{schema:{name:l.name,tables:d.map(f=>u.objectStore(f)).map(f=>{const{keyPath:p,autoIncrement:h}=f,m=Is(p),g=p==null,y={},x={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:m,keyPath:p,autoIncrement:h,unique:!0,extractKey:yw(p)},indexes:oS(f.indexNames).map(w=>f.index(w)).map(w=>{const{name:b,unique:N,multiEntry:A,keyPath:P}=w,j={name:b,compound:Is(P),keyPath:P,unique:N,multiEntry:A,extractKey:yw(P)};return y[o0(P)]=j,j}),getIndexByKeyPath:w=>y[o0(w)]};return y[":id"]=x.primaryKey,p!=null&&(y[o0(p)]=x.primaryKey),x})},hasGetAll:d.length>0&&"getAll"in u.objectStore(d[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),i=s.tables.map(l=>function(u){const d=u.name;return{name:d,schema:u,mutate:function({trans:f,type:p,keys:h,values:m,range:g}){return new Promise((y,x)=>{y=Xr(y);const w=f.objectStore(d),b=w.keyPath==null,N=p==="put"||p==="add";if(!N&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:A}=h||m||{length:1};if(h&&m&&h.length!==m.length)throw new Error("Given keys array must have same length as given values array.");if(A===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let P;const j=[],D=[];let E=0;const I=L=>{++E,G0(L)};if(p==="deleteRange"){if(g.type===4)return y({numFailures:E,failures:D,results:[],lastResult:void 0});g.type===3?j.push(P=w.clear()):j.push(P=w.delete(n(g)))}else{const[L,M]=N?b?[m,h]:[m,null]:[h,null];if(N)for(let K=0;K<A;++K)j.push(P=M&&M[K]!==void 0?w[p](L[K],M[K]):w[p](L[K])),P.onerror=I;else for(let K=0;K<A;++K)j.push(P=w[p](L[K])),P.onerror=I}const _=L=>{const M=L.target.result;j.forEach((K,Z)=>K.error!=null&&(D[Z]=K.error)),y({numFailures:E,failures:D,results:p==="delete"?h:j.map(K=>K.result),lastResult:M})};P.onerror=L=>{I(L),_(L)},P.onsuccess=_})},getMany:({trans:f,keys:p})=>new Promise((h,m)=>{h=Xr(h);const g=f.objectStore(d),y=p.length,x=new Array(y);let w,b=0,N=0;const A=j=>{const D=j.target;x[D._pos]=D.result,++N===b&&h(x)},P=io(m);for(let j=0;j<y;++j)p[j]!=null&&(w=g.get(p[j]),w._pos=j,w.onsuccess=A,w.onerror=P,++b);b===0&&h(x)}),get:({trans:f,key:p})=>new Promise((h,m)=>{h=Xr(h);const g=f.objectStore(d).get(p);g.onsuccess=y=>h(y.target.result),g.onerror=io(m)}),query:function(f){return p=>new Promise((h,m)=>{h=Xr(h);const{trans:g,values:y,limit:x,query:w}=p,b=x===1/0?void 0:x,{index:N,range:A}=w,P=g.objectStore(d),j=N.isPrimaryKey?P:P.index(N.name),D=n(A);if(x===0)return h({result:[]});if(f){const E=y?j.getAll(D,b):j.getAllKeys(D,b);E.onsuccess=I=>h({result:I.target.result}),E.onerror=io(m)}else{let E=0;const I=y||!("openKeyCursor"in j)?j.openCursor(D):j.openKeyCursor(D),_=[];I.onsuccess=L=>{const M=I.result;return M?(_.push(y?M.value:M.primaryKey),++E===x?h({result:_}):void M.continue()):h({result:_})},I.onerror=io(m)}})}(a),openCursor:function({trans:f,values:p,query:h,reverse:m,unique:g}){return new Promise((y,x)=>{y=Xr(y);const{index:w,range:b}=h,N=f.objectStore(d),A=w.isPrimaryKey?N:N.index(w.name),P=m?g?"prevunique":"prev":g?"nextunique":"next",j=p||!("openKeyCursor"in A)?A.openCursor(n(b),P):A.openKeyCursor(n(b),P);j.onerror=io(x),j.onsuccess=Xr(D=>{const E=j.result;if(!E)return void y(null);E.___id=++MM,E.done=!1;const I=E.continue.bind(E);let _=E.continuePrimaryKey;_&&(_=_.bind(E));const L=E.advance.bind(E),M=()=>{throw new Error("Cursor not stopped")};E.trans=f,E.stop=E.continue=E.continuePrimaryKey=E.advance=()=>{throw new Error("Cursor not started")},E.fail=Xr(x),E.next=function(){let K=1;return this.start(()=>K--?this.continue():this.stop()).then(()=>this)},E.start=K=>{const Z=new Promise((he,re)=>{he=Xr(he),j.onerror=io(re),E.fail=re,E.stop=U=>{E.stop=E.continue=E.continuePrimaryKey=E.advance=M,he(U)}}),ae=()=>{if(j.result)try{K()}catch(he){E.fail(he)}else E.done=!0,E.start=()=>{throw new Error("Cursor behind last entry")},E.stop()};return j.onsuccess=Xr(he=>{j.onsuccess=ae,ae()}),E.continue=I,E.continuePrimaryKey=_,E.advance=L,ae(),Z},y(E)},x)})},count({query:f,trans:p}){const{index:h,range:m}=f;return new Promise((g,y)=>{const x=p.objectStore(d),w=h.isPrimaryKey?x:x.index(h.name),b=n(m),N=b?w.count(b):w.count();N.onsuccess=Xr(A=>g(A.target.result)),N.onerror=io(y)})}}}(l)),o={};return i.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:e.transaction.bind(e),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:X0(t),schema:s}}function ww({_novip:e},t){const r=t.db,n=function(s,a,{IDBKeyRange:i,indexedDB:o},l){return{dbcore:function(d,f){return f.reduce((p,{create:h})=>({...p,...h(p)}),d)}(BM(a,i,l),s.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(s=>{const a=s.name;e.core.schema.tables.some(i=>i.name===a)&&(s.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=s.core))})}function A1({_novip:e},t,r,n){r.forEach(s=>{const a=n[s];t.forEach(i=>{const o=vb(i,s);(!o||"value"in o&&o.value===void 0)&&(i===e.Transaction.prototype||i instanceof e.Transaction?ll(i,s,{get(){return this.table(s)},set(l){Bj(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[s]=new e.Table(s,a))})})}function bw({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function UM(e,t){return e._cfg.version-t._cfg.version}function $M(e,t,r,n){const s=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,s);a.create(r),a._completion.catch(n);const i=a._reject.bind(a),o=Rt.transless||Rt;jc(()=>{Rt.trans=a,Rt.transless=o,t===0?(In(s).forEach(l=>{ov(r,l,s[l].primKey,s[l].indexes)}),ww(e,r),vt.follow(()=>e.on.populate.fire(a)).catch(i)):function({_novip:l},u,d,f){const p=[],h=l._versions;let m=l._dbSchema=Sw(l,l.idbdb,f),g=!1;const y=h.filter(w=>w._cfg.version>=u);function x(){return p.length?vt.resolve(p.shift()(d.idbtrans)).then(x):vt.resolve()}return y.forEach(w=>{p.push(()=>{const b=m,N=w._cfg.dbschema;kw(l,b,f),kw(l,N,f),m=l._dbSchema=N;const A=fC(b,N);A.add.forEach(j=>{ov(f,j[0],j[1].primKey,j[1].indexes)}),A.change.forEach(j=>{if(j.recreate)throw new Ut.Upgrade("Not yet support for changing primary key");{const D=f.objectStore(j.name);j.add.forEach(E=>Nw(D,E)),j.change.forEach(E=>{D.deleteIndex(E.name),Nw(D,E)}),j.del.forEach(E=>D.deleteIndex(E))}});const P=w._cfg.contentUpgrade;if(P&&w._cfg.version>u){ww(l,f),d._memoizedTables={},g=!0;let j=Hj(N);A.del.forEach(_=>{j[_]=b[_]}),bw(l,[l.Transaction.prototype]),A1(l,[l.Transaction.prototype],In(j),j),d.schema=j;const D=yb(P);let E;D&&$f();const I=vt.follow(()=>{if(E=P(d),E&&D){var _=xl.bind(null,null);E.then(_,_)}});return E&&typeof E.then=="function"?vt.resolve(E):I.then(()=>E)}}),p.push(b=>{(!g||!TM)&&function(N,A){[].slice.call(A.db.objectStoreNames).forEach(P=>N[P]==null&&A.db.deleteObjectStore(P))}(w._cfg.dbschema,b),bw(l,[l.Transaction.prototype]),A1(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),d.schema=l._dbSchema})}),x().then(()=>{var w,b;b=f,In(w=m).forEach(N=>{b.db.objectStoreNames.contains(N)||ov(b,N,w[N].primKey,w[N].indexes)})})}(e,t,a,r).catch(i)})}function fC(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const s=e[n],a=t[n];if(s){const i={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||s.primKey.auto!==a.primKey.auto&&!Tx)i.recreate=!0,r.change.push(i);else{const o=s.idxByName,l=a.idxByName;let u;for(u in o)l[u]||i.del.push(u);for(u in l){const d=o[u],f=l[u];d?d.src!==f.src&&i.change.push(f):i.add.push(f)}(i.del.length>0||i.add.length>0||i.change.length>0)&&r.change.push(i)}}else r.add.push([n,a])}return r}function ov(e,t,r,n){const s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(a=>Nw(s,a)),s}function Nw(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Sw(e,t,r){const n={};return b1(t.objectStoreNames,0).forEach(s=>{const a=r.objectStore(s);let i=a.keyPath;const o=vw(uC(i),i||"",!1,!1,!!a.autoIncrement,i&&typeof i!="string",!0),l=[];for(let d=0;d<a.indexNames.length;++d){const f=a.index(a.indexNames[d]);i=f.keyPath;var u=vw(f.name,i,!!f.unique,!!f.multiEntry,!1,i&&typeof i!="string",!1);l.push(u)}n[s]=dC(s,o,l)}),n}function kw({_novip:e},t,r){const n=r.db.objectStoreNames;for(let s=0;s<n.length;++s){const a=n[s],i=r.objectStore(a);e._hasGetAll="getAll"in i;for(let o=0;o<i.indexNames.length;++o){const l=i.indexNames[o],u=i.index(l).keyPath,d=typeof u=="string"?u:"["+b1(u).join("+")+"]";if(t[a]){const f=t[a].idxByName[d];f&&(f.name=l,delete t[a].idxByName[d],t[a].idxByName[l]=f)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Vr.WorkerGlobalScope&&Vr instanceof Vr.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class zM{_parseStoresSpec(t,r){In(t).forEach(n=>{if(t[n]!==null){var s=t[n].split(",").map((i,o)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return vw(l,u||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),Is(u),o===0)}),a=s.shift();if(a.multi)throw new Ut.Schema("Primary key cannot be multi-valued");s.forEach(i=>{if(i.auto)throw new Ut.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new Ut.Schema("Index must have a name and cannot be an empty string")}),r[n]=dC(n,a,s)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?ra(this._cfg.storesSource,t):t;const n=r._versions,s={};let a={};return n.forEach(i=>{ra(s,i._cfg.storesSource),a=i._cfg.dbschema={},i._parseStoresSpec(s,a)}),r._dbSchema=a,bw(r,[r._allTables,r,r.Transaction.prototype]),A1(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],In(a),a),r._storeNames=In(a),this}upgrade(t){return this._cfg.contentUpgrade=Nb(this._cfg.contentUpgrade||Ir,t),this}}function Eb(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new _u(Px,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function Ab(e){return e&&typeof e.databases=="function"}function _w(e){return jc(function(){return Rt.letThrough=!0,e()})}function HM(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function qM(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Xn(t.dbOpenError):e);_o&&(t.openCanceller._stackHolder=Gu()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function s(){if(t.openCanceller!==n)throw new Ut.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,i=null,o=!1;const l=()=>new vt((u,d)=>{if(s(),!r)throw new Ut.MissingAPI;const f=e.name,p=t.autoSchema?r.open(f):r.open(f,Math.round(10*e.verno));if(!p)throw new Ut.MissingAPI;p.onerror=io(d),p.onblocked=Xr(e._fireOnBlocked),p.onupgradeneeded=Xr(h=>{if(i=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=G0,i.abort(),p.result.close();const g=r.deleteDatabase(f);g.onsuccess=g.onerror=Xr(()=>{d(new Ut.NoSuchDatabase(`Database ${f} doesnt exist`))})}else{i.onerror=io(d);var m=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;o=m<1,e._novip.idbdb=p.result,$M(e,m/10,i,d)}},d),p.onsuccess=Xr(()=>{i=null;const h=e._novip.idbdb=p.result,m=b1(h.objectStoreNames);if(m.length>0)try{const y=h.transaction((g=m).length===1?g[0]:g,"readonly");t.autoSchema?function({_novip:x},w,b){x.verno=w.version/10;const N=x._dbSchema=Sw(0,w,b);x._storeNames=b1(w.objectStoreNames,0),A1(x,[x._allTables],In(N),N)}(e,h,y):(kw(e,e._dbSchema,y),function(x,w){const b=fC(Sw(0,x.idbdb,w),x._dbSchema);return!(b.add.length||b.change.some(N=>N.add.length||N.change.length))}(e,y)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),ww(e,y)}catch{}var g;a0.push(e),h.onversionchange=Xr(y=>{t.vcFired=!0,e.on("versionchange").fire(y)}),h.onclose=Xr(y=>{e.on("close").fire(y)}),o&&function({indexedDB:y,IDBKeyRange:x},w){!Ab(y)&&w!==Px&&Eb(y,x).put({name:w}).catch(Ir)}(e._deps,f),u()},d)}).catch(u=>u&&u.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):vt.reject(u));return vt.race([n,(typeof navigator>"u"?vt.resolve():HM()).then(l)]).then(()=>(s(),t.onReadyBeingFired=[],vt.resolve(_w(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let d=t.onReadyBeingFired.reduce(Nb,Ir);return t.onReadyBeingFired=[],vt.resolve(_w(()=>d(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{i&&i.abort()}catch{}return n===t.openCanceller&&e._close(),Xn(u)}).finally(()=>{t.openComplete=!0,a()})}function Ew(e){var t=a=>e.next(a),r=s(t),n=s(a=>e.throw(a));function s(a){return i=>{var o=a(i),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(r,n):Is(l)?Promise.all(l).then(r,n):r(l)}}return s(t)()}function WM(e,t,r){var n=arguments.length;if(n<2)throw new Ut.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return r=s.pop(),[e,qj(s),r]}function hC(e,t,r,n,s){return vt.resolve().then(()=>{const a=Rt.transless||Rt,i=e._createTransaction(t,r,e._dbSchema,n),o={trans:i,transless:a};if(n)i.idbtrans=n.idbtrans;else try{i.create(),e._state.PR1398_maxLoop=3}catch(f){return f.name===bb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>hC(e,t,r,null,s))):Xn(f)}const l=yb(s);let u;l&&$f();const d=vt.follow(()=>{if(u=s.call(i,i),u)if(l){var f=xl.bind(null,null);u.then(f,f)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=Ew(u))},o);return(u&&typeof u.then=="function"?vt.resolve(u).then(f=>i.active?f:Xn(new Ut.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):d.then(()=>u)).then(f=>(n&&i._resolve(),i._completion.then(()=>f))).catch(f=>(i._reject(f),Xn(f)))})}function $m(e,t,r){const n=Is(e)?e.slice():[e];for(let s=0;s<r;++s)n.push(t);return n}const VM={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,s={},a=[];function i(d,f,p){const h=o0(d),m=s[h]=s[h]||[],g=d==null?0:typeof d=="string"?1:d.length,y=f>0,x={...p,isVirtual:y,keyTail:f,keyLength:g,extractKey:yw(d),unique:!y&&p.unique};return m.push(x),x.isPrimaryKey||a.push(x),g>1&&i(g===2?d[0]:d.slice(0,g-1),f+1,p),m.sort((w,b)=>w.keyTail-b.keyTail),x}const o=i(n.primaryKey.keyPath,0,n.primaryKey);s[":id"]=[o];for(const d of n.indexes)i(d.keyPath,0,d);function l(d){const f=d.query.index;return f.isVirtual?{...d,query:{index:f,range:(p=d.query.range,h=f.keyTail,{type:p.type===1?2:p.type,lower:$m(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,h),lowerOpen:!0,upper:$m(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,h),upperOpen:!0})}}:d;var p,h}return{...r,schema:{...n,primaryKey:o,indexes:a,getIndexByKeyPath:function(d){const f=s[o0(d)];return f&&f[0]}},count:d=>r.count(l(d)),query:d=>r.query(l(d)),openCursor(d){const{keyTail:f,isVirtual:p,keyLength:h}=d.query.index;return p?r.openCursor(l(d)).then(m=>m&&function(g){return Object.create(g,{continue:{value:function(x){x!=null?g.continue($m(x,d.reverse?e.MAX_KEY:e.MIN_KEY,f)):d.unique?g.continue(g.key.slice(0,h).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,f)):g.continue()}},continuePrimaryKey:{value(x,w){g.continuePrimaryKey($m(x,e.MAX_KEY,f),w)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const x=g.key;return h===1?x[0]:x.slice(0,h)}},value:{get:()=>g.value}})}(m)):r.openCursor(d)}}}}}};function jb(e,t,r,n){return r=r||{},n=n||"",In(e).forEach(s=>{if(Ia(t,s)){var a=e[s],i=t[s];if(typeof a=="object"&&typeof i=="object"&&a&&i){const o=aw(a);o!==aw(i)?r[n+s]=t[s]:o==="Object"?jb(a,i,r,n+s+"."):a!==i&&(r[n+s]=t[s])}else a!==i&&(r[n+s]=t[s])}else r[n+s]=void 0}),In(t).forEach(s=>{Ia(e,s)||(r[n+s]=t[s])}),r}const KM={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(a){const i=Rt.trans,{deleting:o,creating:l,updating:u}=i.table(t).hook;switch(a.type){case"add":if(l.fire===Ir)break;return i._promise("readwrite",()=>d(a),!0);case"put":if(l.fire===Ir&&u.fire===Ir)break;return i._promise("readwrite",()=>d(a),!0);case"delete":if(o.fire===Ir)break;return i._promise("readwrite",()=>d(a),!0);case"deleteRange":if(o.fire===Ir)break;return i._promise("readwrite",()=>function(p){return f(p.trans,p.range,1e4)}(a),!0)}return r.mutate(a);function d(p){const h=Rt.trans,m=p.keys||function(g,y){return y.type==="delete"?y.keys:y.keys||y.values.map(g.extractKey)}(n,p);if(!m)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:m}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(g,y,x){return y.type==="add"?Promise.resolve([]):g.getMany({trans:y.trans,keys:x,cache:"immutable"})}(r,p,m).then(g=>{const y=m.map((x,w)=>{const b=g[w],N={onerror:null,onsuccess:null};if(p.type==="delete")o.fire.call(N,x,b,h);else if(p.type==="add"||b===void 0){const A=l.fire.call(N,x,p.values[w],h);x==null&&A!=null&&(x=A,p.keys[w]=x,n.outbound||Ii(p.values[w],n.keyPath,x))}else{const A=jb(b,p.values[w]),P=u.fire.call(N,A,x,b,h);if(P){const j=p.values[w];Object.keys(P).forEach(D=>{Ia(j,D)?j[D]=P[D]:Ii(j,D,P[D])})}}return N});return r.mutate(p).then(({failures:x,results:w,numFailures:b,lastResult:N})=>{for(let A=0;A<m.length;++A){const P=w?w[A]:m[A],j=y[A];P==null?j.onerror&&j.onerror(x[A]):j.onsuccess&&j.onsuccess(p.type==="put"&&g[A]?p.values[A]:P)}return{failures:x,results:w,numFailures:b,lastResult:N}}).catch(x=>(y.forEach(w=>w.onerror&&w.onerror(x)),Promise.reject(x)))})}function f(p,h,m){return r.query({trans:p,values:!1,query:{index:n,range:h},limit:m}).then(({result:g})=>d({type:"delete",keys:g,trans:p}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):g.length<m?{failures:[],numFailures:0,lastResult:void 0}:f(p,{...h,lower:g[g.length-1],lowerOpen:!0},m)))}}}}})};function pC(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let s=0,a=0;s<t.keys.length&&a<e.length;++s)Qs(t.keys[s],e[a])===0&&(n.push(r?Ap(t.values[s]):t.values[s]),++a);return n.length===e.length?n:null}catch{return null}}const GM={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const s=pC(n.keys,n.trans._cache,n.cache==="clone");return s?vt.resolve(s):r.getMany(n).then(a=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Ap(a):a},a))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function Cb(e){return!("from"in e)}const Qo=function(e,t){if(!this){const r=new Qo;return e&&"d"in e&&ra(r,e),r}ra(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function J0(e,t,r){const n=Qs(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(Cb(e))return ra(e,{from:t,to:r,d:1});const s=e.l,a=e.r;if(Qs(r,e.from)<0)return s?J0(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},lS(e);if(Qs(t,e.to)>0)return a?J0(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},lS(e);Qs(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),Qs(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const i=!e.r;s&&!e.l&&j1(e,s),a&&i&&j1(e,a)}function j1(e,t){Cb(t)||function r(n,{from:s,to:a,l:i,r:o}){J0(n,s,a),i&&r(n,i),o&&r(n,o)}(e,t)}function YM(e,t){const r=Aw(t);let n=r.next();if(n.done)return!1;let s=n.value;const a=Aw(e);let i=a.next(s.from),o=i.value;for(;!n.done&&!i.done;){if(Qs(o.from,s.to)<=0&&Qs(o.to,s.from)>=0)return!0;Qs(s.from,o.from)<0?s=(n=r.next(o.from)).value:o=(i=a.next(s.from)).value}return!1}function Aw(e){let t=Cb(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Qs(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Qs(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function lS(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=n>1?"r":n<-1?"l":"";if(s){const a=s==="r"?"l":"r",i={...e},o=e[s];e.from=o.from,e.to=o.to,e[s]=o[s],i[s]=o[a],e[a]=i,i.d=cS(i)}e.d=cS(e)}function cS({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Tf(Qo.prototype,{add(e){return j1(this,e),this},addKey(e){return J0(this,e,e),this},addKeys(e){return e.forEach(t=>J0(this,t,t)),this},[iw](){return Aw(this)}});const XM={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new Qo(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const s=e.table(n),{schema:a}=s,{primaryKey:i}=a,{extractKey:o,outbound:l}=i,u={...s,mutate:p=>{const h=p.trans,m=h.mutatedParts||(h.mutatedParts={}),g=P=>{const j=`idb://${t}/${n}/${P}`;return m[j]||(m[j]=new Qo)},y=g(""),x=g(":dels"),{type:w}=p;let[b,N]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const A=p.trans._cache;return s.mutate(p).then(P=>{if(Is(b)){w!=="delete"&&(b=P.results),y.addKeys(b);const j=pC(b,A);j||w==="add"||x.addKeys(b),(j||N)&&function(D,E,I,_){function L(M){const K=D(M.name||"");function Z(he){return he!=null?M.extractKey(he):null}const ae=he=>M.multiEntry&&Is(he)?he.forEach(re=>K.addKey(re)):K.addKey(he);(I||_).forEach((he,re)=>{const U=I&&Z(I[re]),ue=_&&Z(_[re]);Qs(U,ue)!==0&&(U!=null&&ae(U),ue!=null&&ae(ue))})}E.indexes.forEach(L)}(g,a,j,N)}else if(b){const j={from:b.lower,to:b.upper};x.add(j),y.add(j)}else y.add(r),x.add(r),a.indexes.forEach(j=>g(j.name).add(r));return P})}},d=({query:{index:p,range:h}})=>{var m,g;return[p,new Qo((m=h.lower)!==null&&m!==void 0?m:e.MIN_KEY,(g=h.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},f={get:p=>[i,new Qo(p.key)],getMany:p=>[i,new Qo().addKeys(p.keys)],count:d,query:d,openCursor:d};return In(f).forEach(p=>{u[p]=function(h){const{subscr:m}=Rt;if(m){const g=N=>{const A=`idb://${t}/${n}/${N}`;return m[A]||(m[A]=new Qo)},y=g(""),x=g(":dels"),[w,b]=f[p](h);if(g(w.name||"").add(b),!w.isPrimaryKey){if(p!=="count"){const N=p==="query"&&l&&h.values&&s.query({...h,values:!1});return s[p].apply(this,arguments).then(A=>{if(p==="query"){if(l&&h.values)return N.then(({result:j})=>(y.addKeys(j),A));const P=h.values?A.result.map(o):A.result;h.values?y.addKeys(P):x.addKeys(P)}else if(p==="openCursor"){const P=A,j=h.values;return P&&Object.create(P,{key:{get:()=>(x.addKey(P.primaryKey),P.key)},primaryKey:{get(){const D=P.primaryKey;return x.addKey(D),D}},value:{get:()=>(j&&y.addKey(P.primaryKey),P.value)}})}return A})}x.add(r)}}return s[p].apply(this,arguments)}}),u}}}};class _u{constructor(t,r){this._middlewares={},this.verno=0;const n=_u.dependencies;this._options=r={addons:_u.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:s}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Ir,dbReadyPromise:null,cancelOpen:Ir,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;a.dbReadyPromise=new vt(o=>{a.dbReadyResolve=o}),a.openCanceller=new vt((o,l)=>{a.cancelOpen=l}),this._state=a,this.name=t,this.on=i0(this,"populate","blocked","versionchange","close",{ready:[Nb,Ir]}),this.on.ready.subscribe=Uj(this.on.ready.subscribe,o=>(l,u)=>{_u.vip(()=>{const d=this._state;if(d.openComplete)d.dbOpenError||vt.resolve().then(l),u&&o(l);else if(d.onReadyBeingFired)d.onReadyBeingFired.push(l),u&&o(l);else{o(l);const f=this;u||o(function p(){f.on.ready.unsubscribe(l),f.on.ready.unsubscribe(p)})}})}),this.Collection=(i=this,jh(FM.prototype,function(o,l){this.db=i;let u=oC,d=null;if(l)try{u=l()}catch(m){d=m}const f=o._ctx,p=f.table,h=p.hook.reading.fire;this._ctx={table:p,index:f.index,isPrimKey:!f.index||p.schema.primKey.keyPath&&f.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:d,or:f.or,valueMapper:h!==V0?h:null}})),this.Table=function(o){return jh(LM.prototype,function(l,u,d){this.db=o,this._tx=d,this.name=l,this.schema=u,this.hook=o._allTables[l]?o._allTables[l].hook:i0(null,{creating:[wM,Ir],reading:[yM,V0],updating:[NM,Ir],deleting:[bM,Ir]})})}(this),this.Transaction=function(o){return jh(OM.prototype,function(l,u,d,f,p){this.db=o,this.mode=l,this.storeNames=u,this.schema=d,this.chromeTransactionDurability=f,this.idbtrans=null,this.on=i0(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new vt((h,m)=>{this._resolve=h,this._reject=m}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var m=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):m&&this.idbtrans&&this.idbtrans.abort(),Xn(h)})})}(this),this.Version=function(o){return jh(zM.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return jh(cC.prototype,function(l,u,d){this.db=o,this._ctx={table:l,index:u===":id"?null:u,or:d};const f=o._deps.indexedDB;if(!f)throw new Ut.MissingAPI;this._cmp=this._ascending=f.cmp.bind(f),this._descending=(p,h)=>f.cmp(h,p),this._max=(p,h)=>f.cmp(p,h)>0?p:h,this._min=(p,h)=>f.cmp(p,h)<0?p:h,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=X0(r.IDBKeyRange),this._createTransaction=(o,l,u,d)=>new this.Transaction(o,l,u,this._options.chromeTransactionDurability,d),this._fireOnBlocked=o=>{this.on("blocked").fire(o),a0.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(VM),this.use(KM),this.use(XM),this.use(GM),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new Ut.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Ut.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(s=>s._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(UM),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Rt.letThrough||this._vip)?t():new vt((r,n)=>{if(this._state.openComplete)return n(new Ut.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new Ut.DatabaseClosed);this.open().catch(Ir)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:s}){s&&this.unuse({stack:t,name:s});const a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:r,level:n??10,name:s}),a.sort((i,o)=>i.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>n?s.create!==n:!!r&&s.name!==r)),this}open(){return qM(this)}_close(){const t=this._state,r=a0.indexOf(this);if(r>=0&&a0.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new vt(n=>{t.dbReadyResolve=n}),t.openCanceller=new vt((n,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Ut.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new vt((n,s)=>{const a=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Xr(()=>{(function({indexedDB:o,IDBKeyRange:l},u){!Ab(o)&&u!==Px&&Eb(o,l).delete(u).catch(Ir)})(this._deps,this.name),n()}),i.onerror=io(s),i.onblocked=this._fireOnBlocked};if(t)throw new Ut.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return In(this._allTables).map(t=>this._allTables[t])}transaction(){const t=WM.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let s=Rt.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const a=t.indexOf("?")!==-1;let i,o;t=t.replace("!","").replace("?","");try{if(o=r.map(u=>{var d=u instanceof this.Table?u.name:u;if(typeof d!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return d}),t=="r"||t===rv)i=rv;else{if(t!="rw"&&t!=nv)throw new Ut.InvalidArgument("Invalid transaction mode: "+t);i=nv}if(s){if(s.mode===rv&&i===nv){if(!a)throw new Ut.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(u=>{if(s&&s.storeNames.indexOf(u)===-1){if(!a)throw new Ut.SubTransaction("Table "+u+" not included in parent transaction.");s=null}}),a&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,(d,f)=>{f(u)}):Xn(u)}const l=hC.bind(null,this,i,o,s,n);return s?s._promise(i,l,"lock"):Rt.trans?zf(Rt.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!Ia(this._allTables,t))throw new Ut.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const JM=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class QM{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[JM](){return this}}function mC(e,t){return In(t).forEach(r=>{j1(e[r]||(e[r]=new Qo),t[r])}),e}function gC(e){let t,r=!1;const n=new QM(s=>{const a=yb(e);let i=!1,o={},l={};const u={get closed(){return i},unsubscribe:()=>{i=!0,Tc.storagemutated.unsubscribe(h)}};s.start&&s.start(u);let d=!1,f=!1;function p(){return In(l).some(g=>o[g]&&YM(o[g],l[g]))}const h=g=>{mC(o,g),p()&&m()},m=()=>{if(d||i)return;o={};const g={},y=function(x){a&&$f();const w=()=>jc(e,{subscr:x,trans:null}),b=Rt.trans?zf(Rt.transless,w):w();return a&&b.then(xl,xl),b}(g);f||(Tc(Y0,h),f=!0),d=!0,Promise.resolve(y).then(x=>{r=!0,t=x,d=!1,i||(p()?m():(o={},l=g,s.next&&s.next(x)))},x=>{d=!1,r=!1,s.error&&s.error(x),u.unsubscribe()})};return m(),u});return n.hasValue=()=>r,n.getValue=()=>t,n}let jw;try{jw={indexedDB:Vr.indexedDB||Vr.mozIndexedDB||Vr.webkitIndexedDB||Vr.msIndexedDB,IDBKeyRange:Vr.IDBKeyRange||Vr.webkitIDBKeyRange}}catch{jw={indexedDB:null,IDBKeyRange:null}}const eu=_u;function Rg(e){let t=sl;try{sl=!0,Tc.storagemutated.fire(e)}finally{sl=t}}Tf(eu,{...Cg,delete:e=>new eu(e,{addons:[]}).delete(),exists:e=>new eu(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return Ab(t)?Promise.resolve(t.databases()).then(n=>n.map(s=>s.name).filter(s=>s!==Px)):Eb(t,r).toCollection().primaryKeys()}(eu.dependencies).then(e)}catch{return Xn(new Ut.MissingAPI)}},defineClass:()=>function(e){ra(this,e)},ignoreTransaction:e=>Rt.trans?zf(Rt.transless,e):e(),vip:_w,async:function(e){return function(){try{var t=Ew(e.apply(this,arguments));return t&&typeof t.then=="function"?t:vt.resolve(t)}catch(r){return Xn(r)}}},spawn:function(e,t,r){try{var n=Ew(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:vt.resolve(n)}catch(s){return Xn(s)}},currentTransaction:{get:()=>Rt.trans||null},waitFor:function(e,t){const r=vt.resolve(typeof e=="function"?eu.ignoreTransaction(e):e).timeout(t||6e4);return Rt.trans?Rt.trans.waitFor(r):r},Promise:vt,debug:{get:()=>_o,set:e=>{Vj(e,e==="dexie"?()=>!0:iC)}},derive:Zd,extend:ra,props:Tf,override:Uj,Events:i0,on:Tc,liveQuery:gC,extendObservabilitySet:mC,getByKeyPath:cl,setByKeyPath:Ii,delByKeyPath:function(e,t){typeof t=="string"?Ii(e,t,void 0):"length"in t&&[].map.call(t,function(r){Ii(e,r,void 0)})},shallowClone:Hj,deepClone:Ap,getObjectDiff:jb,cmp:Qs,asap:$j,minKey:xw,addons:[],connections:a0,errnames:bb,dependencies:jw,semVer:rS,version:rS.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),eu.maxKey=X0(eu.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Tc(Y0,e=>{if(!sl){let t;Tx?(t=document.createEvent("CustomEvent"),t.initCustomEvent(ec,!0,!0,e)):t=new CustomEvent(ec,{detail:e}),sl=!0,dispatchEvent(t),sl=!1}}),addEventListener(ec,({detail:e})=>{sl||Rg(e)}));let sl=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(ec);typeof e.unref=="function"&&e.unref(),Tc(Y0,t=>{sl||e.postMessage(t)}),e.onmessage=t=>{t.data&&Rg(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Tc(Y0,t=>{try{sl||(typeof localStorage<"u"&&localStorage.setItem(ec,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:ec,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===ec){const r=JSON.parse(t.newValue);r&&Rg(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===ec&&Rg(t.changedParts)})}vt.rejectionMapper=function(e,t){if(!e||e instanceof ef||e instanceof TypeError||e instanceof SyntaxError||!e.name||!QN[e.name])return e;var r=new QN[e.name](t||e.message,e);return"stack"in e&&ll(r,"stack",{get:function(){return this.inner.stack}}),r},Vj(_o,iC);class ZM extends _u{constructor(){super("ProjetGestionDB");Tt(this,"users");Tt(this,"projects");Tt(this,"bordereaux");Tt(this,"periodes");Tt(this,"metres");Tt(this,"decompts");Tt(this,"photos");Tt(this,"pvs");Tt(this,"attachments");Tt(this,"syncOperations");Tt(this,"auditLogs");Tt(this,"companies");this.version(1).stores({users:"id, email",projects:"id, userId, status, annee, marcheNo",bordereaux:"id, projectId, userId, reference",metres:"id, projectId, bordereauLigneId, userId, reference",decompts:"id, projectId, userId, periode, numero",photos:"id, projectId, userId, syncStatus",pvs:"id, projectId, userId, type, date",attachments:"id, projectId, userId, category, syncStatus",syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(2).stores({syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(3).stores({periodes:"id, projectId, userId, numero, statut",metres:"id, projectId, periodeId, bordereauLigneId, userId, reference",decompts:"id, projectId, periodeId, userId, numero"}),this.version(4).stores({periodes:"id, projectId, userId, numero, statut"}),this.version(5).stores({projects:"id, userId, status, annee, marcheNo"}),this.version(6).stores({users:"id, email, role, isActive, createdBy",auditLogs:"id, userId, action, entityType, timestamp"}),this.version(7).stores({companies:"id, userId, nom, rc, cnss, usageCount, lastUsed"}),this.version(8).stores({syncOperations:"id, userId, deviceId, entity, entityId, timestamp, synced, syncedAt, [userId+synced]",projects:"id, userId, status, annee, marcheNo, deletedAt",bordereaux:"id, projectId, userId, reference, deletedAt",metres:"id, projectId, periodeId, bordereauLigneId, userId, deletedAt",decompts:"id, projectId, periodeId, userId, numero, deletedAt",periodes:"id, projectId, userId, numero, statut, deletedAt"})}}const be=new ZM,Eu=()=>typeof window>"u"?!1:window.navigator.userAgent.includes("Electron")||window.location.protocol==="app:"||window.electron!==void 0||window.electronAPI!==void 0,St=()=>!Eu();console.log(` Platform: ${Eu()?"Electron (offline-first)":"Web (server-first)"}`);const e9=async()=>{console.log(" [WEB] Clearing all cached data for server-first mode...");try{await be.projects.clear(),await be.bordereaux.clear(),await be.metres.clear(),await be.decompts.clear(),await be.periodes.clear(),await be.pvs.clear(),await be.photos.clear(),await be.attachments.clear(),await be.syncOperations.clear(),console.log(" [WEB] Cache cleared successfully")}catch(e){console.error(" [WEB] Failed to clear cache:",e)}},On=hb()(PI((e,t)=>({user:null,token:null,isLoading:!1,isInitialized:!1,error:null,login:async(r,n)=>{var s,a,i;e({isLoading:!0,error:null});try{const o=await mt.login(r,n),{user:l,token:u}=o.data;if(localStorage.removeItem("lastSyncTimestamp"),localStorage.removeItem("sync-server-seq"),console.log(" Cleared lastSyncTimestamp for full sync"),St()&&await e9(),l.trialEndDate&&new Date(l.trialEndDate)<new Date)throw await be.users.update(l.id,{isActive:!1}),new Error("Votre priode d'essai a expir. Veuillez contacter l'administrateur.");if(l.isActive===!1)throw new Error("Votre compte est dsactiv. Veuillez contacter l'administrateur.");await be.users.update(l.id,{lastLogin:new Date().toISOString()}),localStorage.setItem("authToken",u),await be.users.put({id:l.id,email:l.email,firstName:l.firstName,lastName:l.lastName,role:l.role||"user",isActive:l.isActive??!0,trialEndDate:l.trialEndDate,createdBy:l.createdBy,createdAt:l.createdAt||new Date().toISOString(),lastLogin:new Date().toISOString(),token:u}),e({user:l,token:u,isLoading:!1,isInitialized:!0})}catch(o){throw e({error:((i=(a=(s=o.response)==null?void 0:s.data)==null?void 0:a.error)==null?void 0:i.message)||o.message||"Login failed",isLoading:!1}),o}},register:async r=>{var n,s,a;e({isLoading:!0,error:null});try{console.log(" Sending registration request:",r);const i=await mt.register(r);console.log(" Registration response:",i);const{user:o,token:l}=i.data;localStorage.setItem("authToken",l),await be.users.put({id:o.id,email:o.email,firstName:o.firstName,lastName:o.lastName,role:o.role,isActive:o.isActive??!0,createdAt:o.createdAt||new Date().toISOString(),token:l}),e({user:o,token:l,isLoading:!1,isInitialized:!0})}catch(i){console.error(" Registration error:",i),console.error(" Error response:",i.response);const o=((a=(s=(n=i.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:a.message)||i.message||"Registration failed";throw e({error:o,isLoading:!1}),i}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("lastSyncTimestamp"),localStorage.removeItem("auth-storage"),e({user:null,token:null,error:null,isInitialized:!0})},refreshToken:async()=>{var n;const r=localStorage.getItem("authToken");if(!r)return!1;try{console.log(" Attempting to refresh token from authStore...");const s=await mt.refreshToken(r);if((n=s.data)!=null&&n.token){const a=s.data.token;return localStorage.setItem("authToken",a),e(i=>({...i,token:a})),console.log(" Token refreshed successfully in authStore"),!0}return!1}catch{return console.error(" Token refresh failed in authStore"),!1}},checkAuth:async()=>{var s,a;let r=localStorage.getItem("authToken");if(r||(r=t().token,r&&(localStorage.setItem("authToken",r),console.log(" Restored authToken to localStorage from state"))),!r){console.log(" No token found, setting initialized"),e({user:null,token:null,error:null,isInitialized:!0});return}const n=t();if(n.user&&n.token===r&&n.isInitialized){console.log(" Auth already validated, skipping API call");return}try{e({isLoading:!0}),console.log(" Checking auth with server...");const o=(await mt.getCurrentUser()).data,l=localStorage.getItem("authToken")||r;console.log(" Auth check successful for user:",o.email),e({user:o,token:l,error:null,isInitialized:!0,isLoading:!1})}catch(i){const o=(s=i.response)==null?void 0:s.status;if(console.log(" Auth check failed:",o||i.message),o&&o>=500){console.warn(" Server error during auth check - preserving session for offline mode");const u=n.user;if(u)e({user:u,token:r,error:null,isInitialized:!0,isLoading:!1});else try{const f=(await be.users.toArray()).find(p=>p.token===r);f?(console.log(" Using cached user from IndexedDB for offline mode"),e({user:f,token:r,error:null,isInitialized:!0,isLoading:!1})):e({user:null,token:r,error:"Server indisponible - mode hors ligne",isInitialized:!0,isLoading:!1})}catch{e({user:null,token:r,error:"Server indisponible - mode hors ligne",isInitialized:!0,isLoading:!1})}return}if(!i.response&&(i.code==="ERR_NETWORK"||i.message==="Network Error")){console.warn(" Network error - preserving session for offline mode");const u=n.user;e(u?{user:u,token:r,error:null,isInitialized:!0,isLoading:!1}:{user:null,token:r,error:"Hors ligne",isInitialized:!0,isLoading:!1});return}const l=localStorage.getItem("authToken");if(!l)console.log(" Token was cleared by interceptor, clearing state"),e({user:null,token:null,error:null,isInitialized:!0,isLoading:!1});else try{console.log(" Retrying auth check after potential refresh...");const d=(await mt.getCurrentUser()).data,f=localStorage.getItem("authToken")||r;console.log(" Retry successful for user:",d.email),e({user:d,token:f,error:null,isInitialized:!0,isLoading:!1})}catch(u){const d=(a=u.response)==null?void 0:a.status;if(d&&d>=500){console.warn(" Server still down - preserving session"),e({user:n.user,token:l,error:"Server indisponible",isInitialized:!0,isLoading:!1});return}console.log(" Retry also failed, clearing state"),localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp"),e({user:null,token:null,error:null,isInitialized:!0,isLoading:!1})}}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token}),onRehydrateStorage:()=>e=>{if(e!=null&&e.token){const t=localStorage.getItem("authToken");(!t||t!==e.token)&&(localStorage.setItem("authToken",e.token),console.log(" Synced authToken to localStorage on rehydrate"))}}}));function t9(e,t,r){var n,s;typeof e=="function"?(n=t||[],s=r):(n=[],s=t);var a=Jl.useRef({hasResult:!1,result:s,error:null}),i=Jl.useReducer(function(u){return u+1},0);i[0];var o=i[1],l=Jl.useMemo(function(){var u=typeof e=="function"?e():e;if(!u||typeof u.subscribe!="function")throw e===u?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!a.current.hasResult&&typeof window<"u"&&(typeof u.hasValue!="function"||u.hasValue()))if(typeof u.getValue=="function")a.current.result=u.getValue(),a.current.hasResult=!0;else{var d=u.subscribe(function(f){a.current.result=f,a.current.hasResult=!0});typeof d=="function"?d():d.unsubscribe()}return u},n);if(Jl.useDebugValue(a.current.result),Jl.useEffect(function(){var u=l.subscribe(function(d){var f=a.current;(f.error!==null||f.result!==d)&&(f.error=null,f.result=d,f.hasResult=!0,o())},function(d){var f=a.current;f.error!==d&&(f.error=d,o())});return typeof u=="function"?u:u.unsubscribe.bind(u)},n),a.current.error)throw a.current.error;return a.current.result}function Dn(e,t,r){return t9(function(){return gC(e)},t||[],r)}let zm;const r9=new Uint8Array(16);function n9(){if(!zm&&(zm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!zm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return zm(r9)}const ds=[];for(let e=0;e<256;++e)ds.push((e+256).toString(16).slice(1));function s9(e,t=0){return ds[e[t+0]]+ds[e[t+1]]+ds[e[t+2]]+ds[e[t+3]]+"-"+ds[e[t+4]]+ds[e[t+5]]+"-"+ds[e[t+6]]+ds[e[t+7]]+"-"+ds[e[t+8]]+ds[e[t+9]]+"-"+ds[e[t+10]]+ds[e[t+11]]+ds[e[t+12]]+ds[e[t+13]]+ds[e[t+14]]+ds[e[t+15]]}const a9=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),uS={randomUUID:a9};function Tr(e,t,r){if(uS.randomUUID&&!e)return uS.randomUUID();e=e||{};const n=e.random||(e.rng||n9)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,s9(n)}const C1={DEVICE_ID_KEY:"sync-device-id",LAST_SYNC_KEY:"lastSyncTimestamp"},dS=()=>typeof window>"u"?!1:window.navigator.userAgent.includes("Electron")||window.location.protocol==="app:"||window.electronAPI!==void 0,$h=()=>{const e=dS()?`${C1.DEVICE_ID_KEY}-electron`:`${C1.DEVICE_ID_KEY}-browser`;let t=localStorage.getItem(e);return t||(t=`${dS()?"electron":"browser"}-${Tr()}`,localStorage.setItem(e,t),console.log(" Generated new deviceId:",t)),t},fS=()=>{const e=localStorage.getItem(C1.LAST_SYNC_KEY);return e?parseInt(e,10):0},hS=e=>{localStorage.setItem(C1.LAST_SYNC_KEY,e.toString())},ps=async(e,t,r,n,s)=>{const a=Tr(),i={id:a,userId:s,deviceId:$h(),type:e,entity:t,entityId:r,data:n,timestamp:Date.now(),synced:!1};return await be.syncOperations.add(i),console.log(` Logged ${e} operation for ${t}:${r} (op_id: ${a})`),a},Ga=()=>navigator.onLine,i9=(e,t)=>(window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}),wo=Object.create(null);wo.open="0";wo.close="1";wo.ping="2";wo.pong="3";wo.message="4";wo.upgrade="5";wo.noop="6";const Ig=Object.create(null);Object.keys(wo).forEach(e=>{Ig[wo[e]]=e});const Cw={type:"error",data:"parser error"},xC=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",vC=typeof ArrayBuffer=="function",yC=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,Tb=({type:e,data:t},r,n)=>xC&&t instanceof Blob?r?n(t):pS(t,n):vC&&(t instanceof ArrayBuffer||yC(t))?r?n(t):pS(new Blob([t]),n):n(wo[e]+(t||"")),pS=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function mS(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let lv;function o9(e,t){if(xC&&e.data instanceof Blob)return e.data.arrayBuffer().then(mS).then(t);if(vC&&(e.data instanceof ArrayBuffer||yC(e.data)))return t(mS(e.data));Tb(e,!1,r=>{lv||(lv=new TextEncoder),t(lv.encode(r))})}const gS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",zh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<gS.length;e++)zh[gS.charCodeAt(e)]=e;const l9=e=>{let t=e.length*.75,r=e.length,n,s=0,a,i,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),d=new Uint8Array(u);for(n=0;n<r;n+=4)a=zh[e.charCodeAt(n)],i=zh[e.charCodeAt(n+1)],o=zh[e.charCodeAt(n+2)],l=zh[e.charCodeAt(n+3)],d[s++]=a<<2|i>>4,d[s++]=(i&15)<<4|o>>2,d[s++]=(o&3)<<6|l&63;return u},c9=typeof ArrayBuffer=="function",Pb=(e,t)=>{if(typeof e!="string")return{type:"message",data:wC(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:u9(e.substring(1),t)}:Ig[r]?e.length>1?{type:Ig[r],data:e.substring(1)}:{type:Ig[r]}:Cw},u9=(e,t)=>{if(c9){const r=l9(e);return wC(r,t)}else return{base64:!0,data:e}},wC=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},bC="",d9=(e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach((a,i)=>{Tb(a,!1,o=>{n[i]=o,++s===r&&t(n.join(bC))})})},f9=(e,t)=>{const r=e.split(bC),n=[];for(let s=0;s<r.length;s++){const a=Pb(r[s],t);if(n.push(a),a.type==="error")break}return n};function h9(){return new TransformStream({transform(e,t){o9(e,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let cv;function Hm(e){return e.reduce((t,r)=>t+r.length,0)}function qm(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function p9(e,t){cv||(cv=new TextDecoder);const r=[];let n=0,s=-1,a=!1;return new TransformStream({transform(i,o){for(r.push(i);;){if(n===0){if(Hm(r)<1)break;const l=qm(r,1);a=(l[0]&128)===128,s=l[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(Hm(r)<2)break;const l=qm(r,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(Hm(r)<8)break;const l=qm(r,8),u=new DataView(l.buffer,l.byteOffset,l.length),d=u.getUint32(0);if(d>Math.pow(2,21)-1){o.enqueue(Cw);break}s=d*Math.pow(2,32)+u.getUint32(4),n=3}else{if(Hm(r)<s)break;const l=qm(r,s);o.enqueue(Pb(a?l:cv.decode(l),t)),n=0}if(s===0||s>e){o.enqueue(Cw);break}}}})}const NC=4;function Rn(e){if(e)return m9(e)}function m9(e){for(var t in Rn.prototype)e[t]=Rn.prototype[t];return e}Rn.prototype.on=Rn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Rn.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Rn.prototype.off=Rn.prototype.removeListener=Rn.prototype.removeAllListeners=Rn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Rn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,t)}return this};Rn.prototype.emitReserved=Rn.prototype.emit;Rn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Rn.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Lx=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Za=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),g9="arraybuffer";function SC(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const x9=Za.setTimeout,v9=Za.clearTimeout;function Fx(e,t){t.useNativeTimers?(e.setTimeoutFn=x9.bind(Za),e.clearTimeoutFn=v9.bind(Za)):(e.setTimeoutFn=Za.setTimeout.bind(Za),e.clearTimeoutFn=Za.clearTimeout.bind(Za))}const y9=1.33;function w9(e){return typeof e=="string"?b9(e):Math.ceil((e.byteLength||e.size)*y9)}function b9(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function kC(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function N9(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function S9(e){let t={},r=e.split("&");for(let n=0,s=r.length;n<s;n++){let a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class k9 extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class Lb extends Rn{constructor(t){super(),this.writable=!1,Fx(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new k9(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Pb(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=N9(t);return r.length?"?"+r:""}}class _9 extends Lb{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};f9(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,d9(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=kC()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let _C=!1;try{_C=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const E9=_C;function A9(){}class j9 extends _9{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class vo extends Rn{constructor(t,r,n){super(),this.createRequest=t,Fx(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=SC(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=vo.requestsCount++,vo.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=A9,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete vo.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}vo.requestsCount=0;vo.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",xS);else if(typeof addEventListener=="function"){const e="onpagehide"in Za?"pagehide":"unload";addEventListener(e,xS,!1)}}function xS(){for(let e in vo.requests)vo.requests.hasOwnProperty(e)&&vo.requests[e].abort()}const C9=function(){const e=EC({xdomain:!1});return e&&e.responseType!==null}();class T9 extends j9{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=C9&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new vo(EC,this.uri(),t)}}function EC(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||E9))return new XMLHttpRequest}catch{}if(!t)try{return new Za[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const AC=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class P9 extends Lb{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=AC?{}:SC(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;Tb(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}s&&Lx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=kC()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const uv=Za.WebSocket||Za.MozWebSocket;class L9 extends P9{createSocket(t,r,n){return AC?new uv(t,r,n):r?new uv(t,r):new uv(t)}doWrite(t,r){this.ws.send(r)}}class F9 extends Lb{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=p9(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),s=h9();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const a=()=>{n.read().then(({done:o,value:l})=>{o||(this.onPacket(l),a())}).catch(o=>{})};a();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;this._writer.write(n).then(()=>{s&&Lx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const D9={websocket:L9,webtransport:F9,polling:T9},R9=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,I9=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Tw(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=R9.exec(e||""),a={},i=14;for(;i--;)a[I9[i]]=s[i]||"";return r!=-1&&n!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=O9(a,a.path),a.queryKey=M9(a,a.query),a}function O9(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function M9(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,a){s&&(r[s]=a)}),r}const Pw=typeof addEventListener=="function"&&typeof removeEventListener=="function",Og=[];Pw&&addEventListener("offline",()=>{Og.forEach(e=>e())},!1);class kc extends Rn{constructor(t,r){if(super(),this.binaryType=g9,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=Tw(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=Tw(r.host).host);Fx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=S9(this.opts.query)),Pw&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Og.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=NC,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&kc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",kc.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=w9(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Lx(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:t,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(kc.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Pw&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=Og.indexOf(this._offlineEventListener);n!==-1&&Og.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}kc.protocol=NC;class B9 extends kc{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;kc.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",f=>{if(!n)if(f.type==="pong"&&f.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;kc.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(d(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function a(){n||(n=!0,d(),r.close(),r=null)}const i=f=>{const p=new Error("probe error: "+f);p.transport=r.name,a(),this.emitReserved("upgradeError",p)};function o(){i("transport closed")}function l(){i("socket closed")}function u(f){r&&f.name!==r.name&&a()}const d=()=>{r.removeListener("open",s),r.removeListener("error",i),r.removeListener("close",o),this.off("close",l),this.off("upgrading",u)};r.once("open",s),r.once("error",i),r.once("close",o),this.once("close",l),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let U9=class extends B9{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>D9[s]).filter(s=>!!s)),super(t,n)}};function $9(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=Tw(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const z9=typeof ArrayBuffer=="function",H9=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,jC=Object.prototype.toString,q9=typeof Blob=="function"||typeof Blob<"u"&&jC.call(Blob)==="[object BlobConstructor]",W9=typeof File=="function"||typeof File<"u"&&jC.call(File)==="[object FileConstructor]";function Fb(e){return z9&&(e instanceof ArrayBuffer||H9(e))||q9&&e instanceof Blob||W9&&e instanceof File}function Mg(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(Mg(e[r]))return!0;return!1}if(Fb(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return Mg(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&Mg(e[r]))return!0;return!1}function V9(e){const t=[],r=e.data,n=e;return n.data=Lw(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Lw(e,t){if(!e)return e;if(Fb(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Lw(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Lw(e[n],t));return r}return e}function K9(e,t){return e.data=Fw(e.data,t),delete e.attachments,e}function Fw(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=Fw(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=Fw(e[r],t));return e}const G9=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],Y9=5;var ur;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(ur||(ur={}));class X9{constructor(t){this.replacer=t}encode(t){return(t.type===ur.EVENT||t.type===ur.ACK)&&Mg(t)?this.encodeAsBinary({type:t.type===ur.EVENT?ur.BINARY_EVENT:ur.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===ur.BINARY_EVENT||t.type===ur.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=V9(t),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function vS(e){return Object.prototype.toString.call(e)==="[object Object]"}class Db extends Rn{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===ur.BINARY_EVENT;n||r.type===ur.BINARY_ACK?(r.type=n?ur.EVENT:ur.ACK,this.reconstructor=new J9(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(Fb(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(ur[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===ur.BINARY_EVENT||n.type===ur.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const i=t.substring(a,r);if(i!=Number(i)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(a,r)}else n.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const i=t.charAt(r);if(i==null||Number(i)!=i){--r;break}if(r===t.length)break}n.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Db.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case ur.CONNECT:return vS(r);case ur.DISCONNECT:return r===void 0;case ur.CONNECT_ERROR:return typeof r=="string"||vS(r);case ur.EVENT:case ur.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&G9.indexOf(r[0])===-1);case ur.ACK:case ur.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class J9{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=K9(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const Q9=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Db,Encoder:X9,get PacketType(){return ur},protocol:Y9},Symbol.toStringTag,{value:"Module"}));function _i(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const Z9=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class CC extends Rn{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[_i(t,"open",this.onopen.bind(this)),_i(t,"packet",this.onpacket.bind(this)),_i(t,"error",this.onerror.bind(this)),_i(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,s,a;if(Z9.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:ur.EVENT,data:r};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const d=this.ids++,f=r.pop();this._registerAckCallback(d,f),i.id=d}const o=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);r.call(this,new Error("operation has timed out"))},s),i=(...o)=>{this.io.clearTimeoutFn(a),r.apply(this,o)};i.withError=!0,this.acks[t]=i}emitWithAck(t,...r){return new Promise((n,s)=>{const a=(i,o)=>i?s(i):n(o);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...a)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ur.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ur.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ur.EVENT:case ur.BINARY_EVENT:this.onevent(t);break;case ur.ACK:case ur.BINARY_ACK:this.onack(t);break;case ur.DISCONNECT:this.ondisconnect();break;case ur.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:ur.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ur.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Hf(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Hf.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Hf.prototype.reset=function(){this.attempts=0};Hf.prototype.setMin=function(e){this.ms=e};Hf.prototype.setMax=function(e){this.max=e};Hf.prototype.setJitter=function(e){this.jitter=e};class Dw extends Rn{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,Fx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Hf({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||Q9;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new U9(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=_i(r,"open",function(){n.onopen(),t&&t()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},i=_i(r,"error",a);if(this._timeout!==!1){const o=this._timeout,l=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(_i(t,"ping",this.onping.bind(this)),_i(t,"data",this.ondata.bind(this)),_i(t,"error",this.onerror.bind(this)),_i(t,"close",this.onclose.bind(this)),_i(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Lx(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new CC(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const Ch={};function Bg(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=$9(e,t.path||"/socket.io"),n=r.source,s=r.id,a=r.path,i=Ch[s]&&a in Ch[s].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||i;let l;return o?l=new Dw(n,t):(Ch[s]||(Ch[s]=new Dw(n,t)),l=Ch[s]),r.query&&!t.query&&(t.query=r.queryKey),l.socket(r.path,t)}Object.assign(Bg,{Manager:Dw,Socket:CC,io:Bg,connect:Bg});const Rb=hb((e,t)=>({dirtyPages:new Map,setDirty:(r,n)=>{e(s=>{const a=new Map(s.dirtyPages);return a.set(r,{pageId:r,pageName:n,isDirty:!0,lastModified:new Date}),console.log(` Dirty state SET: ${n} (${r})`),{dirtyPages:a}})},clearDirty:r=>{e(n=>{const s=new Map(n.dirtyPages),a=s.get(r);return a&&console.log(` Dirty state CLEARED: ${a.pageName} (${r})`),s.delete(r),{dirtyPages:s}})},hasAnyDirtyPages:()=>t().dirtyPages.size>0,getDirtyPages:()=>Array.from(t().dirtyPages.values()),isPageDirty:r=>t().dirtyPages.has(r),clearAll:()=>{console.log(" All dirty states CLEARED"),e({dirtyPages:new Map})}})),Wo={RECONNECT_DELAY_MIN:1e3,RECONNECT_DELAY_MAX:3e4,RECONNECT_ATTEMPTS_MAX:10,SERVER_SEQ_KEY:"realtime-server-seq",FALLBACK_POLL_INTERVAL:3e3},sx=class sx{constructor(){Tt(this,"socket",null);Tt(this,"state",{status:"disconnected",lastConnected:null,reconnectAttempts:0,serverSeq:0});Tt(this,"operationListeners",new Set);Tt(this,"statusListeners",new Set);Tt(this,"reconnectTimer",null);Tt(this,"fallbackPollTimer",null);Tt(this,"token",null);Tt(this,"deviceId",null);Tt(this,"userId",null);Tt(this,"serverUrl",null);Tt(this,"subscribedProjects",new Set);Tt(this,"lastFullSyncTime",0);const t=localStorage.getItem(Wo.SERVER_SEQ_KEY);t&&(this.state.serverSeq=parseInt(t,10)||0)}connect(t,r,n,s){var o;if(this.token=r,this.deviceId=n,this.userId=s,this.serverUrl=t.replace(/\/api\/?$/,""),(o=this.socket)!=null&&o.connected){console.log(" Already connected to realtime server");return}console.log(" Connecting to realtime server:",t),this.updateStatus("connecting");let a=t.replace(/\/api\/?$/,"");!a.startsWith("http://")&&!a.startsWith("https://")&&(a=`http://${a}`),console.log(" Socket.IO URL:",a);const i=()=>{let l=localStorage.getItem("clientSessionId");return l||(l=`session-${n}-${Date.now()}`,localStorage.setItem("clientSessionId",l)),l};this.socket=Bg(a,{path:"/socket.io/",auth:{token:r,deviceId:n,clientSessionId:i()},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:Wo.RECONNECT_DELAY_MIN,reconnectionDelayMax:Wo.RECONNECT_DELAY_MAX,reconnectionAttempts:Wo.RECONNECT_ATTEMPTS_MAX,timeout:2e4,forceNew:!1}),this.setupEventListeners()}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{var t;console.log(" Connected to realtime server"),this.updateStatus("connected"),this.state.lastConnected=Date.now(),this.state.reconnectAttempts=0,this.stopFallbackPolling();for(const r of this.subscribedProjects)(t=this.socket)==null||t.emit("join:project",r),console.log(" Re-joined project room:",r);this.requestMissedOperations()}),this.socket.on("disconnect",t=>{var r;console.log(" Disconnected from realtime server:",t),this.updateStatus("disconnected"),(t==="io server disconnect"||t==="transport close")&&((r=this.socket)==null||r.connect()),t!=="io client disconnect"&&this.startFallbackPolling()}),this.socket.on("connect_error",t=>{console.error(" Connection error:",t.message),this.updateStatus("error"),this.state.reconnectAttempts++,this.state.reconnectAttempts>=3&&this.startFallbackPolling()}),this.socket.on("sync:op",t=>{console.log(" Received realtime op:",t.opId,t.type,t.entity),this.handleOperation(t)}),this.socket.on("sync:state",t=>{console.log(" Received sync state:",t.operations.length,"operations");const r=Date.now()-this.lastFullSyncTime;if(r<sx.FULL_SYNC_COOLDOWN){if(console.log(" Skipping sync:state - full sync was done",Math.round(r/1e3),"seconds ago"),t.operations.length>0){const n=Math.max(...t.operations.map(s=>s.serverSeq));this.state.serverSeq=Math.max(this.state.serverSeq,n),localStorage.setItem(Wo.SERVER_SEQ_KEY,this.state.serverSeq.toString())}return}for(const n of t.operations)this.handleOperation(n)}),this.socket.on("sync:error",t=>{console.error(" Sync error:",t.message)}),this.socket.on("error",t=>{console.error(" Socket error:",t)}))}async handleOperation(t){if(t.clientId===this.deviceId){console.log(" Skipping own operation:",t.opId);return}if(t.type==="DELETE"){console.log(" BLOCKED DELETE from realtime/polling:",t.entity,t.entityId),this.state.serverSeq=Math.max(this.state.serverSeq,t.serverSeq),localStorage.setItem(Wo.SERVER_SEQ_KEY,this.state.serverSeq.toString());return}if(t.serverSeq<=this.state.serverSeq){console.log(" Skipping already processed operation:",t.opId);return}await this.applyOperation(t),this.state.serverSeq=Math.max(this.state.serverSeq,t.serverSeq),localStorage.setItem(Wo.SERVER_SEQ_KEY,this.state.serverSeq.toString());for(const r of this.operationListeners)try{r(t)}catch(n){console.error("Error in operation listener:",n)}}async applyOperation(t){const r=Rb.getState();if(t.entity==="metre"&&r.hasAnyDirtyPages()){const i=r.getDirtyPages();console.log(" Realtime METRE update skipped: Dirty pages exist:",i.map(o=>o.pageName).join(", "));return}const s={project:be.projects,bordereau:be.bordereaux,periode:be.periodes,metre:be.metres,decompt:be.decompts,photo:be.photos,pv:be.pvs,attachment:be.attachments,company:be.companies}[t.entity];if(!s){console.warn("Unknown entity type:",t.entity);return}const a=this.normalizeEntityId(t.entity,t.entityId);try{await be.transaction("rw",[s,be.syncOperations],async()=>{if(await be.syncOperations.where("entityId").equals(a).filter(o=>o.entity===t.entity&&!o.synced).count()>0){console.warn(` Conflict detected for ${t.entity}:${a}. Skipping remote update to preserve local pending changes.`);return}switch(t.type){case"CREATE":case"UPDATE":{const o=this.normalizeData(t.entity,t.data,a);await s.put(o),console.log(` Applied ${t.type} to ${t.entity}:${a}`);break}case"DELETE":{await s.delete(a),console.log(` Applied DELETE to ${t.entity}:${a}`);break}}})}catch(i){console.error(` Failed to apply ${t.type} to ${t.entity}:${a}:`,i.message)}}normalizeEntityId(t,r){if(!r)return"";const n=r.includes(":")?r.split(":").pop():r;return`${t}:${n}`}normalizeData(t,r,n){const s={...r,id:n};return s.projectId&&(s.projectId=this.normalizeEntityId("project",s.projectId)),s.periodeId&&s.periodeId.trim()!==""&&(s.periodeId=this.normalizeEntityId("periode",s.periodeId)),s.bordereauId&&(s.bordereauId=this.normalizeEntityId("bordereau",s.bordereauId)),s.userId&&(s.userId=this.normalizeEntityId("user",s.userId)),s}requestMissedOperations(){var t;(t=this.socket)!=null&&t.connected&&(console.log(" Requesting operations since seq:",this.state.serverSeq),this.socket.emit("sync:request",{since:this.state.serverSeq}))}subscribeToProject(t){var r;this.subscribedProjects.add(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("join:project",t),console.log(" Subscribed to project:",t))}unsubscribeFromProject(t){var r;this.subscribedProjects.delete(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("leave:project",t),console.log(" Unsubscribed from project:",t))}startFallbackPolling(){this.fallbackPollTimer||(console.log(" Starting fallback polling..."),this.fallbackPollTimer=setInterval(async()=>{var t;if((t=this.socket)!=null&&t.connected){this.stopFallbackPolling();return}await this.pollForUpdates()},Wo.FALLBACK_POLL_INTERVAL))}stopFallbackPolling(){this.fallbackPollTimer&&(clearInterval(this.fallbackPollTimer),this.fallbackPollTimer=null,console.log(" Stopped fallback polling"))}async pollForUpdates(){var t;if(this.token)try{const n=`${this.serverUrl||""}/api/sync/pull?since=${this.state.serverSeq}&deviceId=${this.deviceId}`,s=await fetch(n,{headers:{Authorization:`Bearer ${this.token}`}});if(s.ok){const i=((t=(await s.json()).data)==null?void 0:t.operations)||[];for(const o of i)await this.handleOperation({serverSeq:o.serverSeq,opId:o.opId||o.id,clientId:o.clientId,type:o.type,entity:o.entity,entityId:o.entityId,data:o.data,timestamp:o.timestamp,userId:o.userId||this.userId||""})}}catch(r){console.error("Polling error:",r)}}onOperation(t){return this.operationListeners.add(t),()=>this.operationListeners.delete(t)}onStatusChange(t){return this.statusListeners.add(t),t(this.state.status),()=>this.statusListeners.delete(t)}updateStatus(t){this.state.status=t;for(const r of this.statusListeners)try{r(t)}catch(n){console.error("Error in status listener:",n)}}getState(){return{...this.state}}isConnected(){var t;return((t=this.socket)==null?void 0:t.connected)??!1}getServerSeq(){return this.state.serverSeq}setServerSeq(t){this.state.serverSeq=t,localStorage.setItem(Wo.SERVER_SEQ_KEY,t.toString())}markFullSyncComplete(){this.lastFullSyncTime=Date.now(),console.log(" Full sync marked complete - will skip sync:state for 10 seconds")}disconnect(){console.log(" Disconnecting from realtime server"),this.stopFallbackPolling(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.socket&&(this.socket.disconnect(),this.socket=null),this.updateStatus("disconnected"),this.subscribedProjects.clear()}reconnect(){if(this.token&&this.deviceId&&this.userId){const t=this.getServerUrl();this.disconnect(),this.connect(t,this.token,this.deviceId,this.userId)}}getServerUrl(){var r,n,s;if(typeof window<"u"&&((r=window.electron)!=null&&r.apiUrl)){const a=window.electron.apiUrl;return console.log(" [REALTIME] Using Electron API URL:",a),a}const t=(s=(n=import.meta)==null?void 0:n.env)==null?void 0:s.VITE_API_URL;return t?(console.log(" [REALTIME] Using VITE_API_URL:",t),t.replace("/api","")):typeof window<"u"?window.location.protocol==="app:"||window.location.protocol==="file:"?(console.log(" [REALTIME] Electron detected, using production URL"),"http://localhost:5000"):window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?(console.log(" [REALTIME] Development mode, using localhost"),"http://localhost:5000"):window.location.origin:"http://localhost:5000"}};Tt(sx,"FULL_SYNC_COOLDOWN",1e4);let Rw=sx;const eo=new Rw,xd=new Map,yS={emit(e,t){const r=xd.get(e);if(r)for(const n of r)try{n(t)}catch(s){console.error("Event listener error:",s)}},on(e,t){return xd.has(e)||xd.set(e,new Set),xd.get(e).add(t),()=>{var r;(r=xd.get(e))==null||r.delete(t)}},off(e,t){var r;(r=xd.get(e))==null||r.delete(t)}},Vo={PROJECT_UPDATED:"project:updated",BORDEREAU_UPDATED:"bordereau:updated",PERIODE_UPDATED:"periode:updated",METRE_UPDATED:"metre:updated",DECOMPT_UPDATED:"decompt:updated",PHOTO_UPDATED:"photo:updated",PV_UPDATED:"pv:updated",ATTACHMENT_UPDATED:"attachment:updated",DATA_CHANGED:"data:changed"},wS={project:"projects",bordereau:"bordereaux",metre:"metres",decompt:"decompts",pv:"pvs",periode:"periodes",photo:"photos",attachment:"attachments",user:"users",company:"companies",auditLog:"auditLogs"},Ur=(e,t)=>{if(!t)return"";const r=t.includes(":")?t.split(":").pop():t;return`${e}:${r}`},ei=e=>e?e.includes(":")?e.split(":").pop():e:"",l0=[],eB=500,Er=e=>{l0.unshift({...e,timestamp:new Date}),l0.length>eB&&l0.pop();const t=e.success?"":"";console.log(`${t} [SYNC] ${e.action}`,e.entity?`${e.entity}:${e.entityId}`:"",e.error||"")},tB=()=>[...l0],rB=()=>{l0.length=0},nB=async e=>{const t={localCounts:{},missingEntities:[],orphanedEntities:[],errors:[]};try{t.localCounts={projects:await be.projects.count(),bordereaux:await be.bordereaux.count(),metres:await be.metres.count(),decompts:await be.decompts.count(),periodes:await be.periodes.count(),pvs:await be.pvs.count(),photos:await be.photos.count(),attachments:await be.attachments.count()};const r=await mt.getProjects(),n=r.data||r;if(Array.isArray(n))for(const a of n){const i=Ur("project",a.id);await be.projects.get(i)||t.missingEntities.push({entity:"project",id:a.id})}const s=await be.projects.toArray();for(const a of s){const i=ei(a.id);!(Array.isArray(n)&&n.some(l=>ei(l.id)===i||l.id===i))&&!a.deletedAt&&t.orphanedEntities.push({entity:"project",id:a.id})}Er({action:"INSPECT",success:!0,data:t})}catch(r){t.errors.push(r.message),Er({action:"INSPECT",success:!1,error:r.message})}return t},sB=e=>{const t={CREATE:0,UPDATE:1,DELETE:2};return[...e].sort((r,n)=>{const s=t[r.type]-t[n.type];if(s!==0)return s;const a=typeof r.timestamp=="string"?new Date(r.timestamp).getTime():r.timestamp,i=typeof n.timestamp=="string"?new Date(n.timestamp).getTime():n.timestamp;return a-i})},aB=async e=>{var a,i;const t={applied:0,skipped:0,errors:[]};if(e.length===0)return t;const r=sB(e);console.log(` Applying ${r.length} operations (sorted: CREATEUPDATEDELETE)...`);const n=[];for(const o of r){const l=Ur(o.entity,o.entityId),u=ei(o.entityId);if(o.type==="DELETE"){console.log(` BLOCKED DELETE from sync pull: ${o.entity}:${l}`),t.skipped++,Er({action:"SKIP_DELETE",entity:o.entity,entityId:o.entityId,success:!1,error:"DELETE blocked from remote sync"});continue}if(await be.syncOperations.where("entityId").anyOf([l,u]).filter(f=>f.entity===o.entity&&!f.synced).count()>0){console.warn(` Conflict detected for ${o.entity}:${l} during PULL. Skipping remote update.`),t.skipped++,Er({action:"SKIP_CONFLICT",entity:o.entity,entityId:o.entityId,success:!1,error:"Local pending changes exist"});continue}n.push(o)}const s={};for(const o of n){const l=wS[o.entity];if(!l){t.skipped++,Er({action:"SKIP",entity:o.entity,entityId:o.entityId,success:!1,error:`Unknown entity: ${o.entity}`});continue}s[l]||(s[l]={creates:[],updates:[],deletes:[]});const u=Ur(o.entity,o.entityId),d=o.data?{...o.data}:{};switch(d.projectId&&(d.projectId=Ur("project",d.projectId)),d.periodeId&&String(d.periodeId).trim()!==""&&(d.periodeId=Ur("periode",d.periodeId)),d.bordereauId&&(d.bordereauId=Ur("bordereau",d.bordereauId)),o.type){case"CREATE":s[l].creates.push({...d,id:u});break;case"UPDATE":s[l].updates.push({id:u,data:d});break;case"DELETE":s[l].deletes.push(u);break}}try{const o=[be.projects,be.bordereaux,be.metres,be.decompts,be.periodes,be.pvs,be.photos];await be.transaction("rw",o,async()=>{var l,u,d,f;for(const[p,h]of Object.entries(s)){const m=be[p];if(m){if(h.creates.length>0)try{for(const g of h.creates)try{const y=await m.get(g.id);if(y)if(p==="metres"){const x={...g,sections:g.sections&&g.sections.length>0?g.sections:y.sections||[],subSections:g.subSections&&g.subSections.length>0?g.subSections:y.subSections||[],lignes:g.lignes&&g.lignes.length>0?g.lignes:y.lignes||[],totalPartiel:g.totalPartiel||y.totalPartiel||0,totalCumule:g.totalCumule||y.totalCumule||0};await m.put(x),console.log(` Merged metre data for ${g.id} - preserved local sections/lignes`)}else if(p==="bordereaux"){const x=(l=y.lignes)==null?void 0:l.some(N=>N.quantite>0),w=(u=g.lignes)==null?void 0:u.some(N=>N.quantite>0),b={...g,lignes:w||!x?g.lignes:y.lignes,montantTotal:w||!x?g.montantTotal:y.montantTotal};await m.put(b),console.log(` Merged bordereau data for ${g.id} - preserved local lignes with quantite`)}else await m.put({...g,updatedAt:g.updatedAt||y.updatedAt});else await m.put(g);t.applied++}catch(y){t.errors.push({op:{type:"CREATE",entity:p,entityId:g.id,data:g},error:y.message}),Er({action:"CREATE",entity:p,entityId:g.id,success:!1,error:y.message})}Er({action:"BULK_CREATE",entity:p,success:!0,data:{count:h.creates.length}})}catch(g){console.error(` Error in bulk create for ${p}:`,g),t.errors.push({op:{type:"CREATE",entity:p},error:g.message})}for(const g of h.updates)try{const y=await m.get(g.id);if(y)if(p==="metres"){const x={...g.data,sections:g.data.sections&&g.data.sections.length>0?g.data.sections:y.sections,subSections:g.data.subSections&&g.data.subSections.length>0?g.data.subSections:y.subSections,lignes:g.data.lignes&&g.data.lignes.length>0?g.data.lignes:y.lignes};await m.update(g.id,x),console.log(` Merged metre update for ${g.id} - preserved local hierarchical data`)}else if(p==="bordereaux"){const x=(d=y.lignes)==null?void 0:d.some(N=>N.quantite>0),w=(f=g.data.lignes)==null?void 0:f.some(N=>N.quantite>0),b={...g.data,lignes:w||!x?g.data.lignes:y.lignes,montantTotal:w||!x?g.data.montantTotal:y.montantTotal};await m.update(g.id,b),console.log(` Merged bordereau update for ${g.id} - preserved local lignes`)}else await m.update(g.id,g.data);else await m.put({...g.data,id:g.id});t.applied++,Er({action:"UPDATE",entity:p,entityId:g.id,success:!0})}catch(y){t.errors.push({op:{type:"UPDATE",entity:p,entityId:g.id,data:g.data},error:y.message}),Er({action:"UPDATE",entity:p,entityId:g.id,success:!1,error:y.message})}if(h.deletes.length>0)try{await m.bulkDelete(h.deletes),t.applied+=h.deletes.length,Er({action:"BULK_DELETE",entity:p,success:!0,data:{count:h.deletes.length}})}catch{for(const y of h.deletes)try{await m.delete(y),t.applied++,Er({action:"DELETE",entity:p,entityId:y,success:!0})}catch(x){t.errors.push({op:{type:"DELETE",entity:p,entityId:y},error:x.message}),Er({action:"DELETE",entity:p,entityId:y,success:!1,error:x.message})}}}}})}catch(o){console.error(" Transaction error:",o),Er({action:"TRANSACTION",success:!1,error:o.message});for(const l of r)try{const u=wS[l.entity];if(!u)continue;const d=be[u];if(!d)continue;const f=Ur(l.entity,l.entityId),p=l.data?{...l.data}:{};switch(p.projectId&&(p.projectId=Ur("project",p.projectId)),l.type){case"CREATE":case"UPDATE":{const h=await d.get(f);if(u==="metres"&&h){const m={...p,id:f,sections:p.sections&&p.sections.length>0?p.sections:h.sections||[],subSections:p.subSections&&p.subSections.length>0?p.subSections:h.subSections||[],lignes:p.lignes&&p.lignes.length>0?p.lignes:h.lignes||[]};await d.put(m),console.log(` Fallback: Merged metre data for ${f}`)}else if(u==="bordereaux"&&h){const m=(a=h.lignes)==null?void 0:a.some(x=>x.quantite>0),g=(i=p.lignes)==null?void 0:i.some(x=>x.quantite>0),y={...p,id:f,lignes:g||!m?p.lignes:h.lignes,montantTotal:g||!m?p.montantTotal:h.montantTotal};await d.put(y),console.log(` Fallback: Merged bordereau data for ${f}`)}else await d.put({...p,id:f});break}case"DELETE":await d.delete(f);break}t.applied++,Er({action:l.type,entity:l.entity,entityId:f,success:!0})}catch(u){t.errors.push({op:l,error:u.message}),Er({action:l.type,entity:l.entity,entityId:l.entityId,success:!1,error:u.message})}}return console.log(` Applied: ${t.applied}, Skipped: ${t.skipped}, Errors: ${t.errors.length}`),t},Cd=async(e,t=!1)=>{var s;const r=Rb.getState();if(r.hasAnyDirtyPages()&&!t){const a=r.getDirtyPages();return console.log(" PULL SKIPPED: Unsaved changes detected in:",a.map(i=>i.pageName).join(", ")),Er({action:"PULL_SKIPPED",success:!0,data:{reason:"unsaved_changes",dirtyPages:a.map(i=>i.pageName)}}),0}let n=0;console.log(" Starting direct data pull...",e?`for project: ${e}`:"all data"),Er({action:"PULL_START",success:!0,data:{projectId:e}});try{const a=await mt.getProjects(),i=a.data||a;if(Array.isArray(i)){await be.transaction("rw",be.projects,async()=>{for(const l of i){if(e&&ei(l.id)!==ei(e))continue;const u=Ur("project",l.id);await be.projects.put({...l,id:u,userId:l.userId?Ur("user",l.userId):l.userId}),n++}});const o=e?i.filter(l=>ei(l.id)===ei(e)):i;for(const l of o){const u=ei(l.id),d=Ur("project",u);try{const f=await mt.getBordereaux(u),p=f.data||f;Array.isArray(p)&&p.length>0&&await be.transaction("rw",be.bordereaux,async()=>{for(const h of p)await be.bordereaux.put({...h,id:Ur("bordereau",h.id),projectId:d}),n++})}catch{console.log("No bordereaux for project:",u)}try{const f=await((s=mt.getPeriodes)==null?void 0:s.call(mt,u)),p=(f==null?void 0:f.data)||f;Array.isArray(p)&&p.length>0&&await be.transaction("rw",be.periodes,async()=>{for(const h of p)await be.periodes.put({...h,id:Ur("periode",h.id),projectId:d}),n++})}catch{console.log("No periodes for project:",u)}try{const f=await mt.getMetres(u),p=f.data||f;Array.isArray(p)&&p.length>0&&await be.transaction("rw",be.metres,async()=>{for(const h of p)await be.metres.put({...h,id:Ur("metre",h.id),projectId:d,periodeId:h.periodeId?Ur("periode",h.periodeId):""}),n++})}catch{console.log("No metres for project:",u)}try{const f=await mt.getDecompts(u),p=f.data||f;Array.isArray(p)&&p.length>0&&await be.transaction("rw",be.decompts,async()=>{for(const h of p)await be.decompts.put({...h,id:Ur("decompt",h.id),projectId:d,periodeId:h.periodeId?Ur("periode",h.periodeId):""}),n++})}catch{console.log("No decompts for project:",u)}}}Er({action:"PULL_COMPLETE",success:!0,data:{totalPulled:n}}),console.log(` Direct pull complete: ${n} items`)}catch(a){throw console.error(" Direct pull error:",a),Er({action:"PULL_ERROR",success:!1,error:a.message}),a}return n},iB=e=>{const t=Dn(async()=>e?await be.syncOperations.where("synced").equals(0).count():0,[e])||0,[r,n]=J.useState({status:Ga()?"idle":"offline",lastSyncTime:fS()||null,pendingOperations:0,error:null,lastPullCount:0,realtimeConnected:!1});J.useEffect(()=>{n(x=>({...x,pendingOperations:t}))},[t]);const[s,a]=J.useState(!0),i=J.useRef(!1),o=J.useRef(!1),l=J.useCallback(()=>{if(!e||o.current&&eo.isConnected())return;const x=localStorage.getItem("authToken");if(!x)return;const w=$h();let b="http://localhost:3000";typeof window<"u"&&window.location.hostname!=="localhost"&&(b=window.location.origin),console.log(" Connecting to realtime server:",b),eo.connect(b,x,w,e),o.current=!0;const N=eo.onStatusChange(P=>{n(j=>({...j,realtimeConnected:P==="connected",status:P==="connected"?"realtime":j.status}))}),A=eo.onOperation(P=>{console.log(" Realtime op in sync manager:",P.type,P.entity);const D={project:Vo.PROJECT_UPDATED,bordereau:Vo.BORDEREAU_UPDATED,periode:Vo.PERIODE_UPDATED,metre:Vo.METRE_UPDATED,decompt:Vo.DECOMPT_UPDATED,photo:Vo.PHOTO_UPDATED,pv:Vo.PV_UPDATED,attachment:Vo.ATTACHMENT_UPDATED}[P.entity];D&&yS.emit(D,{type:P.type,entityId:P.entityId,data:P.data}),yS.emit(Vo.DATA_CHANGED,{entity:P.entity,type:P.type,entityId:P.entityId,data:P.data})});return()=>{N(),A()}},[e]),u=J.useCallback(async()=>{if(e)try{const x=await be.syncOperations.where("synced").equals(0).count();n(w=>({...w,pendingOperations:x}))}catch(x){console.error("Error updating pending count:",x)}},[e]),d=J.useCallback(async()=>{var x,w,b;if(!e||!Ga()){console.log(" Cannot push: user not authenticated or offline");return}console.log(" [v3] Starting sync push..."),Er({action:"PUSH_START",success:!0});try{const N=await be.syncOperations.filter(E=>!E.synced&&E.userId===e).toArray();if(N.length===0){console.log(" No pending operations");return}console.log(` Found ${N.length} pending operations`);const A=N.map(E=>({id:E.id,type:E.type,entity:E.entity,entityId:ei(E.entityId),data:E.data,timestamp:E.timestamp})),P=await mt.syncPush(A,$h());console.log(" Server response:",P);const j=((x=P.data)==null?void 0:x.success)||P.success||[];if(Array.isArray(j)&&j.length>0){const E=N.filter(I=>j.includes(I.id)||j.includes(ei(I.entityId))).map(I=>I.id);E.length>0&&await be.transaction("rw",be.syncOperations,async()=>{for(const I of E)await be.syncOperations.update(I,{synced:!0,syncedAt:new Date().toISOString()})})}const D=((w=P.data)==null?void 0:w.failed)||P.failed||[];if(D.length>0){console.error(" Some operations failed:",D),Er({action:"PUSH_ERRORS",success:!1,data:{errors:D}});const E=["overflow","invalid input","duplicate key","not-null"],I=["foreign key","fkey"];for(const _ of D){const L=(_.error||"").toLowerCase(),M=I.some(Z=>L.includes(Z));if(E.some(Z=>L.includes(Z))&&!M){const Z=N.find(ae=>ae.id===_.id||ei(ae.entityId)===_.id||ae.entityId.includes(_.id));Z&&Z.id&&(console.warn(` Marking permanently failed op for deletion: ${Z.entity}:${Z.entityId}`),await be.syncOperations.delete(Z.id),Er({action:"DELETE_FAILED_OP",entity:Z.entity,entityId:Z.entityId,success:!0,error:_.error}))}else M&&console.log(` Recoverable error, keeping op for retry: ${(b=_.error)==null?void 0:b.slice(0,50)}...`)}}Er({action:"PUSH_COMPLETE",success:!0,data:{pushed:j.length}})}catch(N){throw console.error(" Push error:",N),Er({action:"PUSH_ERROR",success:!1,error:N.message}),N}},[e]),f=J.useCallback(async()=>{var x,w,b;if(!e||!Ga()){console.log(" Cannot pull: user not authenticated or offline");return}console.log(" [v3] Starting sync pull..."),n(N=>({...N,status:"pulling"})),Er({action:"PULL_START",success:!0});try{const N=fS(),A=await mt.syncPull(N,$h());console.log(" Pull response received");const P=((x=A.data)==null?void 0:x.operations)||A.operations||[],j=((w=A.data)==null?void 0:w.serverTime)||A.serverTime||Date.now();if(P.length===0&&N===0){console.log(" No sync operations, performing direct fetch...");const D=await Cd();n(E=>({...E,lastPullCount:D}))}else if(P.length>0){const D=await aB(P);n(E=>({...E,lastPullCount:D.applied})),D.errors.length>0&&console.error(" Some operations failed to apply:",D.errors)}hS(j),eo.markFullSyncComplete(),Er({action:"PULL_COMPLETE",success:!0})}catch(N){if(console.error(" Pull error:",N),Er({action:"PULL_ERROR",success:!1,error:N.message}),((b=N.response)==null?void 0:b.status)!==401)throw N}},[e]),p=J.useCallback(async()=>{if(i.current){console.log(" Sync already in progress");return}if(!e||!Ga()){n(x=>({...x,status:"offline",error:"Cannot sync while offline"}));return}i.current=!0,n(x=>({...x,status:"syncing",error:null}));try{await d(),await f();const x=new Date;x.setDate(x.getDate()-30),await be.syncOperations.where("syncedAt").below(x.toISOString()).delete(),n(w=>({...w,status:"synced",lastSyncTime:Date.now(),error:null})),Er({action:"SYNC_COMPLETE",success:!0})}catch(x){n(w=>({...w,status:"error",error:x.message||"Sync failed"})),Er({action:"SYNC_ERROR",success:!1,error:x.message})}finally{i.current=!1}},[e,d,f,u]);J.useEffect(()=>i9(()=>{n(N=>({...N,status:"idle"})),s&&setTimeout(()=>p(),1e3)},()=>{n(N=>({...N,status:"offline"}))}),[p,s]),J.useEffect(()=>{if(!s||!Ga())return;const x=()=>r.realtimeConnected?2*60*1e3:10*1e3;let w;return(()=>{clearInterval(w),w=setInterval(()=>{p().catch(console.error)},x())})(),()=>clearInterval(w)},[p,s,r.realtimeConnected]),J.useEffect(()=>{u()},[u]),J.useEffect(()=>{if(e&&Ga()){const x=l();return()=>{x&&x(),o.current=!1}}},[e,l]),J.useEffect(()=>{const x=()=>{e&&!eo.isConnected()&&(console.log(" Back online, reconnecting realtime..."),l())};return window.addEventListener("online",x),()=>window.removeEventListener("online",x)},[e,l]),J.useEffect(()=>{if(!e||!Ga())return;const x=setInterval(()=>{eo.isConnected()||(console.log(" WebSocket health check: Not connected, attempting reconnect..."),l())},3e4);return()=>clearInterval(x)},[e,l]);const h=J.useCallback(async()=>{try{const x=await be.syncOperations.filter(b=>b.synced===!1||b.synced===void 0).toArray();if(x.length===0)return console.log(" No pending operations to clear"),{cleared:0};console.log(` Clearing ${x.length} pending operations...`);const w=x.map(b=>b.id).filter(b=>b!=null);return await be.syncOperations.bulkDelete(w),n(b=>({...b,pendingOperations:0,error:null,status:"idle"})),console.log(` Cleared ${x.length} pending operations`),{cleared:x.length}}catch(x){return console.error(" Failed to clear pending operations:",x),{cleared:0,error:x.message}}},[]),m=J.useCallback(async()=>{if(!e)return{repaired:0,errors:[]};console.log(" Starting orphaned entity repair...");const x=$h(),w=Date.now();let b=0;const N=[];try{const A=await be.projects.where("userId").equals(e).toArray();for(const j of A)if(!await be.syncOperations.where("entityId").equals(j.id).filter(E=>E.type==="CREATE"&&!E.synced).first()){console.log(` Creating missing sync op for project: ${j.id}`);const E={id:`repair:${j.id}:${w}`,userId:e,deviceId:x,type:"CREATE",entity:"project",entityId:j.id,data:j,timestamp:w-1e3,synced:!1};await be.syncOperations.add(E),b++,console.log(` Created repair sync op for project: ${j.marcheNo}`)}const P=[{table:be.bordereaux,entity:"bordereau"},{table:be.periodes,entity:"periode"},{table:be.metres,entity:"metre"},{table:be.decompts,entity:"decompt"}];for(const j of P){const D=await j.table.where("userId").equals(e).toArray();for(const E of D)if(!await be.syncOperations.where("entityId").equals(E.id).filter(_=>_.type==="CREATE"&&!_.synced).first()){const _={id:`repair:${E.id}:${w}`,userId:e,deviceId:x,type:"CREATE",entity:j.entity,entityId:E.id,data:E,timestamp:w,synced:!1};await be.syncOperations.add(_),b++}}return console.log(` Repaired ${b} orphaned entities`),b>0&&await u(),{repaired:b,errors:N}}catch(A){return console.error(" Repair failed:",A),N.push(A.message),{repaired:b,errors:N}}},[e,u]),g=J.useCallback(async()=>{if(e)try{console.log(" Starting full reset and resync..."),await h(),hS(0),await Cd(),console.log(" Reset and resync completed")}catch(x){console.error(" Reset and resync failed:",x)}},[e,h,Cd]),y=J.useCallback(async x=>{if(!e||!Ga()){console.log(" Cannot refresh: user not authenticated or offline");return}console.log(" [SERVER_REFRESH] Forcing data refresh from server..."),n(w=>({...w,status:"pulling"}));try{await d();const w=await Cd(x,!0);console.log(` [SERVER_REFRESH] Refreshed ${w} items from server`),n(b=>({...b,status:"synced",lastPullCount:w}))}catch(w){console.error(" [SERVER_REFRESH] Failed:",w),n(b=>({...b,status:"error",error:w.message}))}},[e,d]);return{syncState:r,sync:p,syncPush:d,syncPull:f,pullLatestData:Cd,refreshFromServer:y,updatePendingCount:u,autoSyncEnabled:s,setAutoSyncEnabled:a,isOnline:Ga(),isRealtimeConnected:r.realtimeConnected,connectRealtime:l,disconnectRealtime:()=>eo.disconnect(),subscribeToProject:x=>eo.subscribeToProject(x),unsubscribeFromProject:x=>eo.unsubscribeFromProject(x),clearPendingOperations:h,resetAndResync:g,repairOrphanedEntities:m,getSyncLogs:tB,clearSyncLogs:rB,inspectSync:()=>e?nB():Promise.resolve({localCounts:{},missingEntities:[],orphanedEntities:[],errors:["No user ID"]})}},TC=hb(e=>({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null,currentVersion:"",setUpdateAvailable:t=>e({isUpdateAvailable:!0,updateInfo:t,error:null}),setDownloading:t=>e({isDownloading:t}),setDownloadProgress:t=>e({downloadProgress:t}),setUpdateDownloaded:t=>e({isUpdateDownloaded:!0,isDownloading:!1,downloadProgress:null}),setError:t=>e({error:t,isDownloading:!1}),setCurrentVersion:t=>e({currentVersion:t}),reset:()=>e({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null})}));function oB(){const{setUpdateAvailable:e,setDownloadProgress:t,setUpdateDownloaded:r,setError:n,setCurrentVersion:s}=TC();J.useEffect(()=>{if(!window.electron){console.log("Not running in Electron, auto-updater disabled");return}window.electron.getAppVersion().then(d=>{s(d),console.log("Current app version:",d)});const a=window.electron.onUpdateAvailable(d=>{console.log("Update available:",d),e(d)}),i=window.electron.onUpdateNotAvailable(d=>{console.log("No updates available, current version:",d.version)}),o=window.electron.onDownloadProgress(d=>{console.log("Download progress:",d.percent+"%"),t(d)}),l=window.electron.onUpdateDownloaded(d=>{console.log("Update downloaded:",d.version),r(d)}),u=window.electron.onUpdateError(d=>{console.error("Update error:",d.message),n(d.message)});return()=>{a(),i(),o(),l(),u()}},[e,t,r,n,s])}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var lB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),dt=(e,t)=>{const r=J.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:l,...u},d)=>J.createElement("svg",{ref:d,...lB,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${cB(e)}`,o].join(" "),...u},[...t.map(([f,p])=>J.createElement(f,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=dt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ni=dt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q0=dt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=dt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=dt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=dt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rf=dt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PC=dt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dx=dt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=dt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T1=dt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=dt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dv=dt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ul=dt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=dt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=dt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P1=dt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ci=dt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sl=dt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=dt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=dt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=dt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=dt("FileImage",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["circle",{cx:"10",cy:"13",r:"2",key:"6v46hv"}],["path",{d:"m20 17-1.09-1.09a2 2 0 0 0-2.82 0L10 22",key:"17vly1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LC=dt("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wr=dt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=dt("File",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=dt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=dt("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iw=dt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=dt("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=dt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=dt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=dt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=dt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=dt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=dt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=dt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FC=dt("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=dt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=dt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fv=dt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=dt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=dt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=dt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hv=dt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=dt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=dt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L1=dt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=dt("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=dt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=dt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=dt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=dt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DC=dt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=dt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AS=dt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=dt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PB=dt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=dt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=dt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=dt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LB=dt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F1=dt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FB=dt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DB=dt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=dt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=dt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RB=dt("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=dt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IB=dt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=dt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=dt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OB=dt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RC=dt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=dt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MB=dt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BB=dt("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),UB=()=>{const{t:e}=$i(),t=$s(),{login:r,isLoading:n,error:s}=On(),[a,i]=J.useState({email:"",password:""}),o=async l=>{l.preventDefault();try{await r(a.email,a.password),t("/")}catch{}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("app.title")}),c.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),c.jsxs("form",{onSubmit:o,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),c.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:l=>i({...a,email:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),c.jsx("input",{id:"password",type:"password",required:!0,className:"input",value:a.password,onChange:l=>i({...a,password:l.target.value})})]}),s&&c.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),c.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?c.jsx("span",{children:e("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsx(_B,{className:"w-5 h-5"}),c.jsx("span",{children:e("auth.login")})]})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"font-medium mb-1",children:"Accs restreint"}),c.jsx("p",{className:"text-xs",children:"Les comptes utilisateurs sont crs uniquement par l'administrateur systme. Pour demander un accs, veuillez contacter votre administrateur."})]})})]})})})},$B=()=>{const{t:e}=$i(),t=$s(),{register:r,isLoading:n,error:s}=On(),[a,i]=J.useState({email:"",password:"",firstName:"",lastName:""}),o=async l=>{l.preventDefault();try{await r(a),t("/")}catch{}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("auth.register")}),c.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),c.jsxs("form",{onSubmit:o,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.firstName")}),c.jsx("input",{id:"firstName",type:"text",required:!0,className:"input",value:a.firstName,onChange:l=>i({...a,firstName:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.lastName")}),c.jsx("input",{id:"lastName",type:"text",required:!0,className:"input",value:a.lastName,onChange:l=>i({...a,lastName:l.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),c.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:l=>i({...a,email:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),c.jsx("input",{id:"password",type:"password",required:!0,minLength:6,className:"input",value:a.password,onChange:l=>i({...a,password:l.target.value})})]}),s&&c.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),c.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?c.jsx("span",{children:e("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsx(IB,{className:"w-5 h-5"}),c.jsx("span",{children:e("auth.register")})]})})]}),c.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[e("auth.login")," ",c.jsx(Pi,{to:"/login",className:"text-primary-600 hover:text-primary-700 font-medium",children:e("auth.login")})]})]})})})},zB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),[a,i]=J.useState(null),o=J.useRef(!0),l=J.useRef(null),u=J.useCallback(async(d=!0)=>{var f;if(!e){r([]),s(!1),i(null);return}d&&s(!0),i(null);try{console.log(" [WEB] Fetching projects from server...");const p=await mt.getProjects();if(!o.current)return;const m=(p.data||p).filter(g=>!g.deletedAt);console.log(` [WEB] Loaded ${m.length} projects from server`),r(m),s(!1)}catch(p){if(!o.current)return;console.error(" [WEB] Failed to fetch projects:",p),s(!1),i(((f=p.response)==null?void 0:f.status)===401?"Session expire, veuillez vous reconnecter":"Impossible de charger les projets")}},[e]);return J.useEffect(()=>(o.current=!0,e!==l.current&&(l.current=e,u(!0)),()=>{o.current=!1}),[e,u]),{projects:t,isLoading:n,error:a,refresh:()=>u(!0),silentRefresh:()=>u(!1)}},HB=e=>{const[t,r]=J.useState(null),[n,s]=J.useState(!1),[a,i]=J.useState(null),o=J.useRef(!0),l=(e==null?void 0:e.replace("project:",""))||null,u=J.useCallback(async()=>{if(!l){r(null),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching project ${l}...`);const d=await mt.getProject(l);if(!o.current)return;const f=d.data||d;r(f),console.log(` [WEB] Loaded project ${l}`,f)}catch(d){if(!o.current)return;console.error(` [WEB] Failed to fetch project ${l}:`,d),i("Impossible de charger le projet")}finally{o.current&&s(!1)}},[l]);return J.useEffect(()=>(o.current=!0,u(),()=>{o.current=!1}),[u]),{project:t,isLoading:n,error:a,refresh:u}},qB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),[a,i]=J.useState(null),o=J.useRef(!0),l=(e==null?void 0:e.replace("project:",""))||null,u=J.useCallback(async()=>{if(!l){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching bordereaux for project ${l}...`);const d=await mt.getBordereaux(l);if(!o.current)return;const f=d.data||d;console.log(` [WEB] Loaded ${f.length} bordereaux`),r(f.filter(p=>!p.deletedAt))}catch(d){if(!o.current)return;console.error(" [WEB] Failed to fetch bordereaux:",d),i("Impossible de charger le bordereau")}finally{o.current&&s(!1)}},[l]);return J.useEffect(()=>(o.current=!0,u(),()=>{o.current=!1}),[u]),{bordereaux:t,bordereau:t[0]||null,isLoading:n,error:a,refresh:u}},WB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),[a,i]=J.useState(null),o=J.useRef(!0),l=J.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,d=J.useCallback(async()=>{if(!u){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching priodes for project ${u}...`);const f=await mt.getPeriodes(u);if(!o.current)return;const h=(f.data||f).filter(m=>!m.deletedAt).sort((m,g)=>m.numero-g.numero);r(h),s(!1)}catch(f){if(!o.current)return;console.error(" [WEB] Failed to fetch priodes:",f),s(!1),r([])}},[u]);return J.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,d()),()=>{o.current=!1}),[u,d]),{periodes:t,isLoading:n,error:a,refresh:d}},VB=(e,t)=>{const[r,n]=J.useState([]),[s,a]=J.useState(!1),[i,o]=J.useState(null),l=J.useRef(!0),u=J.useRef(""),d=(e==null?void 0:e.replace("project:",""))||null,f=null,p=`${d}-${f}`,h=J.useCallback(async()=>{if(!d){n([]),a(!1);return}a(!0),o(null);try{console.log(` [WEB] Fetching mtrs for project ${d}...`);const m=await mt.getMetres(d);if(!l.current)return;let g=m.data||m;console.log(` [WEB] Loaded ${g.length} mtrs, filtering by periodeId: ${f}`),console.log(" [WEB] Metres periodeIds:",g.map(y=>y.periodeId)),n(g.filter(y=>!y.deletedAt)),a(!1)}catch(m){if(!l.current)return;console.error(" [WEB] Failed to fetch mtrs:",m),a(!1),n([])}},[d,f]);return J.useEffect(()=>(l.current=!0,p!==u.current&&(u.current=p,h()),()=>{l.current=!1}),[p,h]),{metres:r,isLoading:s,error:i,refresh:h}},KB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),[a,i]=J.useState(null),o=J.useRef(!0),l=J.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,d=J.useCallback(async()=>{if(!u){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching dcomptes for project ${u}...`);const f=await mt.getDecompts(u);if(!o.current)return;const p=f.data||f;r(p.filter(h=>!h.deletedAt)),s(!1)}catch(f){if(!o.current)return;console.error(" [WEB] Failed to fetch dcomptes:",f),s(!1),r([])}},[u]);return J.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,d()),()=>{o.current=!1}),[u,d]),{decompts:t,isLoading:n,error:a,refresh:d}},GB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),a=J.useRef(!0),i=J.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=J.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await mt.getPhotos(o);if(!a.current)return;const d=u.data||u;r(d.filter(f=>!f.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch photos:",u),r([])}finally{a.current&&s(!1)}},[o]);return J.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{photos:t,isLoading:n,refresh:l}},YB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),a=J.useRef(!0),i=J.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=J.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await mt.getPVs(o);if(!a.current)return;const d=u.data||u;r(d.filter(f=>!f.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch PVs:",u),r([])}finally{a.current&&s(!1)}},[o]);return J.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{pvs:t,isLoading:n,refresh:l}},XB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),a=J.useRef(!0),i=J.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=J.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await mt.getAttachments(o);if(!a.current)return;const d=u.data||u;r(d.filter(f=>!f.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch attachments:",u),r([])}finally{a.current&&s(!1)}},[o]);return J.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{attachments:t,isLoading:n,refresh:l}},JB=e=>{const[t,r]=J.useState([]),[n,s]=J.useState(!1),a=J.useRef(!0),i=J.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=J.useCallback(async()=>{var u;if(!o){r([]),s(!1);return}s(!0);try{const[d,f]=await Promise.all([mt.getMetres(o),mt.getPeriodes(o)]);if(!a.current)return;const p=(d.data||d).filter(N=>!N.deletedAt),h=(f.data||f).filter(N=>!N.deletedAt);if(p.length===0){r([]),s(!1);return}const m=h.sort((N,A)=>A.numero-N.numero),g=m.length>0?m[0].id:null,y=g==null?void 0:g.replace("periode:",""),x=N=>{if(N.includes("_")){const A=N.split("_");return A[A.length-1]}return N},w=new Map;for(const N of p){const A=x(N.bordereauLigneId),j=((u=N.periodeId)==null?void 0:u.replace("periode:",""))===y||N.periodeId===g,D=w.get(A);D?(D.totalCumule+=N.totalPartiel||0,j&&(D.totalPartiel=N.totalPartiel||0)):w.set(A,{reference:N.reference,designationBordereau:N.designationBordereau,unite:N.unite,quantiteBordereau:N.quantiteBordereau,totalCumule:N.totalPartiel||0,totalPartiel:j&&N.totalPartiel||0})}const b=Array.from(w.entries()).map(([N,A])=>{const P=Number(A.quantiteBordereau)||0,j=Number(A.totalCumule)||0,D=P>0?j/P*100:0,E=A.reference||N||"",I=E.split("-"),_=I.length>0?I[I.length-1]:E;return{id:N,reference:_,designationBordereau:A.designationBordereau,unite:A.unite,quantiteBordereau:P,totalPartiel:Number(A.totalPartiel)||0,totalCumule:j,pourcentageRealisation:isNaN(D)?0:D}});b.sort((N,A)=>{const P=parseInt(N.reference.replace(/\D/g,""))||0,j=parseInt(A.reference.replace(/\D/g,""))||0;return P-j}),r(b)}catch(d){if(!a.current)return;console.error(" [WEB] Failed to fetch aggregated mtrs:",d),r([])}finally{a.current&&s(!1)}},[o]);return J.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{aggregatedMetres:t,isLoading:n,refresh:l}},QB=()=>{const[e,t]=J.useState(navigator.onLine);return J.useEffect(()=>{const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),e},ZB=e=>{const[t,r]=J.useState(!0),[n]=J.useState(null),s=J.useRef(!1),a=Dn(async()=>{if(!e)return[];const o=[e,e.includes(":")?e.split(":").pop():e,e.includes(":")?e:`user:${e}`];return(await be.projects.filter(u=>!u.deletedAt).toArray()).filter(u=>o.includes(u.userId))},[e]),i=J.useCallback(async()=>{if(!(!e||!navigator.onLine))try{const o=await mt.getProjects(),l=o.data||o;await be.transaction("rw",be.projects,async()=>{for(const u of l){const d=u.id.includes(":")?u.id:`project:${u.id}`;await be.projects.put({...u,id:d})}})}catch(o){console.error("[ELECTRON] Sync failed:",o)}},[e]);return J.useEffect(()=>{e&&!s.current&&navigator.onLine?(s.current=!0,i().finally(()=>r(!1))):a!==void 0&&r(!1)},[e,a,i]),{projects:a||[],isLoading:t,error:n,refresh:i,silentRefresh:i}},eU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(()=>t?be.projects.get(t):void 0,[t]);return{project:r||null,isLoading:r===void 0,error:null,refresh:async()=>{}}},tU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.bordereaux.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{bordereaux:r||[],bordereau:(r==null?void 0:r[0])||null,isLoading:r===void 0,error:null,refresh:async()=>{}}},rU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.periodes.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{periodes:(r||[]).sort((n,s)=>n.numero-s.numero),isLoading:r===void 0,error:null,refresh:async()=>{}}},nU=(e,t)=>{const r=e!=null&&e.includes(":")?e:`project:${e}`,s=Dn(async()=>r?await be.metres.where("projectId").equals(r).filter(o=>!o.deletedAt).toArray():[],[r,null]);return{metres:s||[],isLoading:s===void 0,error:null,refresh:async()=>{}}},sU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.decompts.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{decompts:r||[],isLoading:r===void 0,error:null,refresh:async()=>{}}},aU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.photos.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{photos:r||[],isLoading:r===void 0,refresh:async()=>{}}},iU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.pvs.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{pvs:r||[],isLoading:r===void 0,refresh:async()=>{}}},oU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>t?be.attachments.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{attachments:r||[],isLoading:r===void 0,refresh:async()=>{}}},lU=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Dn(async()=>{if(!t)return[];const n=await be.metres.where("projectId").equals(t).filter(d=>!d.deletedAt).toArray();if(n.length===0)return[];const a=(await be.periodes.where("projectId").equals(t).filter(d=>!d.deletedAt).toArray()).sort((d,f)=>f.numero-d.numero),i=a.length>0?a[0].id:null,o=d=>{if(d.includes("_")){const f=d.split("_");return f[f.length-1]}return d},l=new Map;for(const d of n){const f=o(d.bordereauLigneId),p=l.get(f);p?(p.totalCumule+=d.totalPartiel||0,d.periodeId===i&&(p.totalPartiel=d.totalPartiel||0)):l.set(f,{reference:d.reference,designationBordereau:d.designationBordereau,unite:d.unite,quantiteBordereau:d.quantiteBordereau,totalCumule:d.totalPartiel||0,totalPartiel:d.periodeId===i&&d.totalPartiel||0})}const u=Array.from(l.entries()).map(([d,f])=>{const p=Number(f.quantiteBordereau)||0,h=Number(f.totalCumule)||0,m=p>0?h/p*100:0,g=f.reference.split("-"),y=g.length>0?g[g.length-1]:f.reference;return{id:d,reference:y,designationBordereau:f.designationBordereau,unite:f.unite,quantiteBordereau:p,totalPartiel:Number(f.totalPartiel)||0,totalCumule:h,pourcentageRealisation:isNaN(m)?0:m}});return u.sort((d,f)=>{const p=parseInt(d.reference.replace(/\D/g,""))||0,h=parseInt(f.reference.replace(/\D/g,""))||0;return p-h}),u},[t]);return{aggregatedMetres:r||[],isLoading:r===void 0,refresh:async()=>{}}},Ob=e=>St()?zB(e):ZB(e),Rx=e=>St()?HB(e):eU(e),Mb=e=>St()?qB(e):tU(e),Bb=e=>St()?WB(e):rU(e),Ub=(e,t)=>St()?VB(e):nU(e),cU=e=>St()?KB(e):sU(e),uU=e=>St()?GB(e):aU(e),dU=e=>St()?YB(e):iU(e),fU=e=>St()?XB(e):oU(e),hU=e=>St()?JB(e):lU(e),$b=()=>{const e=QB();return Eu()?{canModify:!0,reason:null}:e?{canModify:!0,reason:null}:{canModify:!1,reason:"Vous devez tre connect pour crer ou modifier des donnes"}};function na(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function So(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function pU(e,t){const r=na(e);return isNaN(t)?So(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Hh(e,t){const r=na(e);if(isNaN(t))return So(e,NaN);if(!t)return r;const n=r.getDate(),s=So(e,r.getTime());s.setMonth(r.getMonth()+t+1,0);const a=s.getDate();return n>=a?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}const IC=6048e5,mU=864e5,OC=6e4,MC=36e5;let gU={};function Ix(){return gU}function ep(e,t){var o,l,u,d;const r=Ix(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=na(e),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function D1(e){return ep(e,{weekStartsOn:1})}function BC(e){const t=na(e),r=t.getFullYear(),n=So(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=D1(n),a=So(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const i=D1(a);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function jS(e){const t=na(e);return t.setHours(0,0,0,0),t}function CS(e){const t=na(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function UC(e,t){const r=jS(e),n=jS(t),s=+r-CS(r),a=+n-CS(n);return Math.round((s-a)/mU)}function xU(e){const t=BC(e),r=So(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),D1(r)}function vU(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function tp(e){if(!vU(e)&&typeof e!="number")return!1;const t=na(e);return!isNaN(Number(t))}function Ei(e,t){const r=na(e),n=na(t),s=TS(r,n),a=Math.abs(UC(r,n));r.setDate(r.getDate()-s*a);const i=+(TS(r,n)===-s),o=s*(a-i);return o===0?0:o}function TS(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function yU(e){const t=na(e),r=So(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const wU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},bU=(e,t,r)=>{let n;const s=wU[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function nf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const NU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},SU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},kU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_U={date:nf({formats:NU,defaultWidth:"full"}),time:nf({formats:SU,defaultWidth:"full"}),dateTime:nf({formats:kU,defaultWidth:"full"})},EU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},AU=(e,t,r,n)=>EU[e];function fo(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[i]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const jU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},CU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},TU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},PU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},LU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},FU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},DU=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},RU={ordinalNumber:DU,era:fo({values:jU,defaultWidth:"wide"}),quarter:fo({values:CU,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fo({values:TU,defaultWidth:"wide"}),day:fo({values:PU,defaultWidth:"wide"}),dayPeriod:fo({values:LU,defaultWidth:"wide",formattingValues:FU,defaultFormattingWidth:"wide"})};function ho(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const i=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?OU(o,f=>f.test(i)):IU(o,f=>f.test(i));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const d=t.slice(i.length);return{value:u,rest:d}}}function IU(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function OU(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function $C(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let i=e.valueCallback?e.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(s.length);return{value:i,rest:o}}}const MU=/^(\d+)(th|st|nd|rd)?/i,BU=/\d+/i,UU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},$U={any:[/^b/i,/^(a|c)/i]},zU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},HU={any:[/1/i,/2/i,/3/i,/4/i]},qU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},WU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},VU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},KU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},GU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},YU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},XU={ordinalNumber:$C({matchPattern:MU,parsePattern:BU,valueCallback:e=>parseInt(e,10)}),era:ho({matchPatterns:UU,defaultMatchWidth:"wide",parsePatterns:$U,defaultParseWidth:"any"}),quarter:ho({matchPatterns:zU,defaultMatchWidth:"wide",parsePatterns:HU,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ho({matchPatterns:qU,defaultMatchWidth:"wide",parsePatterns:WU,defaultParseWidth:"any"}),day:ho({matchPatterns:VU,defaultMatchWidth:"wide",parsePatterns:KU,defaultParseWidth:"any"}),dayPeriod:ho({matchPatterns:GU,defaultMatchWidth:"any",parsePatterns:YU,defaultParseWidth:"any"})},JU={code:"en-US",formatDistance:bU,formatLong:_U,formatRelative:AU,localize:RU,match:XU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function QU(e){const t=na(e);return UC(t,yU(t))+1}function ZU(e){const t=na(e),r=+D1(t)-+xU(t);return Math.round(r/IC)+1}function zC(e,t){var d,f,p,h;const r=na(e),n=r.getFullYear(),s=Ix(),a=(t==null?void 0:t.firstWeekContainsDate)??((f=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(p=s.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,i=So(e,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=ep(i,t),l=So(e,0);l.setFullYear(n,0,a),l.setHours(0,0,0,0);const u=ep(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function e$(e,t){var o,l,u,d;const r=Ix(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((d=(u=r.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=zC(e,t),a=So(e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),ep(a,t)}function t$(e,t){const r=na(e),n=+ep(r,t)-+e$(r,t);return Math.round(n/IC)+1}function _r(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const zl={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return _r(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):_r(r+1,2)},d(e,t){return _r(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return _r(e.getHours()%12||12,t.length)},H(e,t){return _r(e.getHours(),t.length)},m(e,t){return _r(e.getMinutes(),t.length)},s(e,t){return _r(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return _r(s,t.length)}},vd={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},PS={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return zl.y(e,t)},Y:function(e,t,r,n){const s=zC(e,n),a=s>0?s:1-s;if(t==="YY"){const i=a%100;return _r(i,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):_r(a,t.length)},R:function(e,t){const r=BC(e);return _r(r,t.length)},u:function(e,t){const r=e.getFullYear();return _r(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return _r(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return _r(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return zl.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return _r(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=t$(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):_r(s,t.length)},I:function(e,t,r){const n=ZU(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):_r(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):zl.d(e,t)},D:function(e,t,r){const n=QU(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):_r(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return _r(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return _r(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return _r(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=vd.noon:n===0?s=vd.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=vd.evening:n>=12?s=vd.afternoon:n>=4?s=vd.morning:s=vd.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return zl.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):zl.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):_r(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):_r(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):zl.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):zl.s(e,t)},S:function(e,t){return zl.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return FS(n);case"XXXX":case"XX":return nu(n);case"XXXXX":case"XXX":default:return nu(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return FS(n);case"xxxx":case"xx":return nu(n);case"xxxxx":case"xxx":default:return nu(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+LS(n,":");case"OOOO":default:return"GMT"+nu(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+LS(n,":");case"zzzz":default:return"GMT"+nu(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return _r(n,t.length)},T:function(e,t,r){const n=e.getTime();return _r(n,t.length)}};function LS(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+_r(a,2)}function FS(e,t){return e%60===0?(e>0?"-":"+")+_r(Math.abs(e)/60,2):nu(e,t)}function nu(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=_r(Math.trunc(n/60),2),a=_r(n%60,2);return r+s+t+a}const DS=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},HC=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},r$=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return DS(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",DS(n,t)).replace("{{time}}",HC(s,t))},n$={p:HC,P:r$},s$=/^D+$/,a$=/^Y+$/,i$=["D","DD","YY","YYYY"];function o$(e){return s$.test(e)}function l$(e){return a$.test(e)}function c$(e,t,r){const n=u$(e,t,r);if(console.warn(n),i$.includes(e))throw new RangeError(n)}function u$(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const d$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,f$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h$=/^'([^]*?)'?$/,p$=/''/g,m$=/[a-zA-Z]/;function Kn(e,t,r){var d,f,p,h,m,g,y,x;const n=Ix(),s=(r==null?void 0:r.locale)??n.locale??JU,a=(r==null?void 0:r.firstWeekContainsDate)??((f=(d=r==null?void 0:r.locale)==null?void 0:d.options)==null?void 0:f.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(p=n.locale)==null?void 0:p.options)==null?void 0:h.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((g=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((x=(y=n.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,o=na(e);if(!tp(o))throw new RangeError("Invalid time value");let l=t.match(f$).map(w=>{const b=w[0];if(b==="p"||b==="P"){const N=n$[b];return N(w,s.formatLong)}return w}).join("").match(d$).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const b=w[0];if(b==="'")return{isToken:!1,value:g$(w)};if(PS[b])return{isToken:!0,value:w};if(b.match(m$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const u={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const b=w.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&l$(b)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&o$(b))&&c$(b,t,String(e));const N=PS[b[0]];return N(o,b,s.localize,u)}).join("")}function g$(e){const t=e.match(h$);return t?t[1].replace(p$,"'"):e}function Ai(e,t){const n=w$(e);let s;if(n.date){const l=b$(n.date,2);s=N$(l.restDateString,l.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const a=s.getTime();let i=0,o;if(n.time&&(i=S$(n.time),isNaN(i)))return new Date(NaN);if(n.timezone){if(o=k$(n.timezone),isNaN(o))return new Date(NaN)}else{const l=new Date(a+i),u=new Date(0);return u.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),u.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),u}return new Date(a+i+o)}const Vm={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},x$=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,v$=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,y$=/^([+-])(\d{2})(?::?(\d{2}))?$/;function w$(e){const t={},r=e.split(Vm.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Vm.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Vm.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=Vm.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function b$(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function N$(e,t){if(t===null)return new Date(NaN);const r=e.match(x$);if(!r)return new Date(NaN);const n=!!r[4],s=Th(r[1]),a=Th(r[2])-1,i=Th(r[3]),o=Th(r[4]),l=Th(r[5])-1;if(n)return C$(t,o,l)?_$(t,o,l):new Date(NaN);{const u=new Date(0);return!A$(t,a,i)||!j$(t,s)?new Date(NaN):(u.setUTCFullYear(t,a,Math.max(s,i)),u)}}function Th(e){return e?parseInt(e):1}function S$(e){const t=e.match(v$);if(!t)return NaN;const r=pv(t[1]),n=pv(t[2]),s=pv(t[3]);return T$(r,n,s)?r*MC+n*OC+s*1e3:NaN}function pv(e){return e&&parseFloat(e.replace(",","."))||0}function k$(e){if(e==="Z")return 0;const t=e.match(y$);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return P$(n,s)?r*(n*MC+s*OC):NaN}function _$(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const E$=[31,null,31,30,31,30,31,31,30,31,30,31];function qC(e){return e%400===0||e%4===0&&e%100!==0}function A$(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(E$[t]||(qC(e)?29:28))}function j$(e,t){return t>=1&&t<=(qC(e)?366:365)}function C$(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function T$(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function P$(e,t){return t>=0&&t<=59}const L$=()=>{$i();const{user:e}=On(),t=$s(),{projects:r,isLoading:n,error:s,refresh:a}=Ob((e==null?void 0:e.id)||null),i=navigator.onLine,o=i||!St(),l=!i&&St()?"Non disponible hors ligne":null,[u,d]=J.useState([]),[f,p]=J.useState([]);J.useEffect(()=>{(async()=>{if(!(r!=null&&r.length)){d([]),p([]);return}const b=[],N=[];try{await Promise.all(r.map(async A=>{var j;const P=((j=A.id)==null?void 0:j.replace("project:",""))||A.id;try{const D=await mt.getBordereaux(P),E=D.data||D;Array.isArray(E)&&b.push(...E.map(I=>({...I,projectId:A.id})))}catch{}try{const D=await mt.getDecompts(P),E=D.data||D;Array.isArray(E)&&N.push(...E.map(I=>({...I,projectId:A.id})))}catch{}})),d(b.filter(A=>!A.deletedAt)),p(N.filter(A=>!A.deletedAt))}catch(A){console.error("Failed to load bordereaux/decompts:",A)}})()},[r]);const h=J.useMemo(()=>{var E;if(!r)return{totalProjects:0,activeProjects:0,completedProjects:0,totalBudget:0,totalRealized:0,averageProgress:0,projectsNeedingDecompte:0,upcomingDeadlines:0};const w=r.filter(I=>I.status==="active"),b=r.filter(I=>I.status==="completed");let N=0,A=0;for(const I of r){const _=((E=I.id)==null?void 0:E.replace("project:",""))||I.id,M=((u==null?void 0:u.filter(ae=>{var re;return(((re=ae.projectId||ae.project_id)==null?void 0:re.replace("project:",""))||ae.projectId)===_||ae.projectId===I.id}))||[]).reduce((ae,he)=>{if(!he.lignes)return ae;const re=he.lignes.reduce((U,ue)=>U+Number(ue.quantite||0)*Number(ue.prixUnitaire||ue.prix_unitaire||0),0);return ae+re*1.2},0);N+=M;const Z=((f==null?void 0:f.filter(ae=>{var re;return(((re=ae.projectId||ae.project_id)==null?void 0:re.replace("project:",""))||ae.projectId)===_||ae.projectId===I.id}))||[]).reduce((ae,he)=>ae+(Number(he.totalTTC||he.total_ttc)||Number(he.montantTotal||he.montant_total)||0),0);A+=Z}const P=N>0?Math.round(A/N*100):0,j=w.filter(I=>{var K;const _=((K=I.id)==null?void 0:K.replace("project:",""))||I.id,L=(f==null?void 0:f.filter(Z=>{var he;return(((he=Z.projectId||Z.project_id)==null?void 0:he.replace("project:",""))||Z.projectId)===_||Z.projectId===I.id}))||[];if(L.length===0)return!0;const M=L.sort((Z,ae)=>new Date(ae.createdAt||ae.created_at).getTime()-new Date(Z.createdAt||Z.created_at).getTime())[0];return Ei(new Date,new Date(M.createdAt||M.created_at))>30}),D=w.filter(I=>{if(!I.osc||!I.delaisExecution)return!1;const _=Hh(new Date(I.osc),I.delaisExecution),L=Ei(_,new Date);return L<=30&&L>=0});return{totalProjects:r.length,activeProjects:w.length,completedProjects:b.length,totalBudget:N,totalRealized:A,averageProgress:P,projectsNeedingDecompte:j.length,upcomingDeadlines:D.length}},[r,f,u]),m=J.useMemo(()=>{if(!r)return[];const w=[],b=new Date;return r.forEach(N=>{var P;const A=N.id.replace("project:","");if(N.status==="active"&&N.osc&&N.delaisExecution){const j=Hh(new Date(N.osc),N.delaisExecution),D=Ei(b,j);D>0?w.push({id:`overdue-${N.id}`,type:"danger",icon:Q0,title:`Dlai dpass de ${D} jours`,description:`${N.objet} (${N.marcheNo})`,action:{label:"Voir",path:`/projects/${A}`},projectId:N.id,priority:1}):D>-30&&w.push({id:`deadline-${N.id}`,type:"warning",icon:DB,title:`Fin de dlai dans ${Math.abs(D)} jours`,description:`${N.objet} (${N.marcheNo})`,action:{label:"Voir",path:`/projects/${A}`},projectId:N.id,priority:2})}if(N.status==="active"){const j=(f==null?void 0:f.filter(D=>D.projectId===N.id))||[];if(j.length===0)Ei(b,new Date(N.createdAt))>15&&w.push({id:`no-decompte-${N.id}`,type:"warning",icon:Ci,title:"Aucun dcompte cr",description:`${N.objet}`,action:{label:"Crer",path:`/projects/${A}`},projectId:N.id,priority:2});else{const D=j.sort((I,_)=>new Date(_.createdAt).getTime()-new Date(I.createdAt).getTime())[0],E=Ei(b,new Date(D.createdAt));E>30&&w.push({id:`old-decompte-${N.id}`,type:"info",icon:AS,title:`Dcompte ancien (${E}j)`,description:`${N.objet}`,action:{label:"Nouveau",path:`/projects/${A}`},projectId:N.id,priority:3})}}if(N.dateReceptionProvisoire&&!N.dateReceptionDefinitive){const j=new Date(N.dateReceptionProvisoire),D=Hh(j,12),E=Ei(D,b);E<=30&&E>=0&&w.push({id:`garantie-${N.id}`,type:"warning",icon:F1,title:`Fin garantie dans ${E}j`,description:`${N.objet}`,action:{label:"Planifier",path:`/projects/${A}/edit`},projectId:N.id,priority:2})}if(N.status==="active"){const j=((P=N.id)==null?void 0:P.replace("project:",""))||N.id;((u==null?void 0:u.filter(E=>{var _;return(((_=E.projectId||E.project_id)==null?void 0:_.replace("project:",""))||E.projectId)===j||E.projectId===N.id}))||[]).length===0&&w.push({id:`no-bordereau-${N.id}`,type:"danger",icon:Wr,title:"Bordereau manquant",description:`${N.objet}`,action:{label:"Crer",path:`/projects/${A}`},projectId:N.id,priority:1})}}),w.sort((N,A)=>N.priority-A.priority)},[r,f,u]),g=J.useMemo(()=>r?r.filter(w=>w.status==="active").map(w=>{var L;const b=((L=w.id)==null?void 0:L.replace("project:",""))||w.id,N=(f==null?void 0:f.filter(M=>{var Z;return(((Z=M.projectId||M.project_id)==null?void 0:Z.replace("project:",""))||M.projectId)===b||M.projectId===w.id}))||[],A=N.sort((M,K)=>new Date(K.createdAt||K.created_at).getTime()-new Date(M.createdAt||M.created_at).getTime())[0],j=((u==null?void 0:u.filter(M=>{var Z;return(((Z=M.projectId||M.project_id)==null?void 0:Z.replace("project:",""))||M.projectId)===b||M.projectId===w.id}))||[]).reduce((M,K)=>{if(!K.lignes)return M;const Z=K.lignes.reduce((ae,he)=>ae+(he.quantite||0)*(he.prixUnitaire||he.prix_unitaire||0),0);return M+Z*1.2},0),D=N.reduce((M,K)=>M+(Number(K.totalTTC)||Number(K.montantTotal)||0),0);let E="normal",I="";if(w.osc&&w.delaisExecution){const M=Hh(new Date(w.osc),w.delaisExecution),K=Ei(M,new Date);K<0?(E="critical",I=`Retard ${Math.abs(K)}j`):K<15?(E="high",I=`${K}j restants`):K<30&&(E="medium",I=`${K}j restants`)}const _=parseInt(w.marcheNo.split("/")[0])||999;return{...w,lastDecompte:A,urgency:E,reason:I,montantTTC:j,montantRealise:D,marcheNum:_}}).sort((w,b)=>w.marcheNum-b.marcheNum).slice(0,10):[],[r,f,u]),y=w=>({danger:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800"})[w],x=w=>({danger:"text-red-500",warning:"text-yellow-500",info:"text-blue-500",success:"text-green-500"})[w];return n&&St()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(yo,{className:"w-8 h-8 animate-spin text-blue-600 mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Chargement des donnes depuis le serveur..."})]}):s&&St()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(Au,{className:"w-12 h-12 text-red-500 mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:s}),c.jsxs("button",{onClick:()=>a(),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(No,{className:"w-4 h-4"}),"Ressayer"]})]}):c.jsxs("div",{className:"space-y-6",children:[!i&&St()&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3",children:[c.jsx(Au,{className:"w-5 h-5 text-yellow-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-yellow-800",children:"Mode hors ligne"}),c.jsx("p",{className:"text-sm text-yellow-700",children:"Les modifications sont dsactives. Reconnectez-vous pour continuer."})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord"}),c.jsxs("p",{className:"text-gray-600 mt-1",children:["Bienvenue, ",e==null?void 0:e.firstName," ! Voici l'tat de vos projets."]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>a(),disabled:n,className:"btn btn-secondary flex items-center gap-2",title:"Rafrachir depuis le serveur",children:c.jsx(No,{className:`w-4 h-4 ${n?"animate-spin":""}`})}),o?c.jsxs(Pi,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[c.jsx(ms,{className:"w-5 h-5"}),"Nouveau projet"]}):c.jsxs("button",{disabled:!0,className:"btn btn-primary flex items-center gap-2 opacity-50 cursor-not-allowed",title:l||"Non disponible hors ligne",children:[c.jsx(Au,{className:"w-5 h-5"}),"Nouveau projet"]})]})]}),m.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(fB,{className:"w-5 h-5 text-gray-700"}),c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Alertes (",m.length,")"]})]}),c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:m.slice(0,4).map(w=>{const b=w.icon;return c.jsxs("div",{className:`p-4 rounded-lg border ${y(w.type)} flex items-start gap-3`,children:[c.jsx(b,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${x(w.type)}`}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium",children:w.title}),c.jsx("p",{className:"text-sm opacity-80 truncate",children:w.description})]}),w.action&&c.jsxs(Pi,{to:w.action.path,className:"flex-shrink-0 text-sm font-medium hover:underline flex items-center gap-1",children:[w.action.label,c.jsx(ul,{className:"w-4 h-4"})]})]},w.id)})}),m.length>4&&c.jsxs("p",{className:"text-sm text-gray-500",children:["+ ",m.length-4," autres alertes"]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-500 rounded-xl text-white",children:c.jsx(Bu,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-blue-700",children:"Total projets"}),c.jsx("p",{className:"text-2xl font-bold text-blue-900",children:h.totalProjects})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-500 rounded-xl text-white",children:c.jsx(vl,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-green-700",children:"En cours"}),c.jsx("p",{className:"text-2xl font-bold text-green-900",children:h.activeProjects})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-500 rounded-xl text-white",children:c.jsx(FB,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-purple-700",children:"Progression"}),c.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[h.averageProgress,"%"]})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-500 rounded-xl text-white",children:c.jsx(dc,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-orange-700",children:"Budget"}),c.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[isNaN(h.totalBudget)||h.totalBudget===0?"0":(h.totalBudget/1e6).toFixed(1),"M"]})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:c.jsx(ni,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.upcomingDeadlines}),c.jsx("p",{className:"text-xs text-gray-500",children:"Dlais proches"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:c.jsx(AS,{className:"w-5 h-5 text-yellow-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.projectsNeedingDecompte}),c.jsx("p",{className:"text-xs text-gray-500",children:"Besoins dcompte"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:c.jsx(bo,{className:"w-5 h-5 text-green-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h.completedProjects}),c.jsx("p",{className:"text-xs text-gray-500",children:"Termins"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(Ci,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{children:[c.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[isNaN(h.totalRealized)||h.totalRealized===0?"0":(h.totalRealized/1e6).toFixed(1),"M"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"Ralis"})]})]})]}),c.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 card",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[c.jsx(MB,{className:"w-5 h-5 text-yellow-500"}),"Mes projets"]}),c.jsx(Pi,{to:"/projects",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Voir tout"})]}),!r||r.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Bu,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-500 mb-3",children:"Aucun projet"}),c.jsxs(Pi,{to:"/projects/new",className:"btn btn-primary btn-sm inline-flex items-center gap-2",children:[c.jsx(ms,{className:"w-4 h-4"}),"Crer un projet"]})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-blue-50 border-y border-blue-200",children:[c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"N March"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Objet"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"CT"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Titulaire du march"}),c.jsx("th",{className:"py-2 px-3 text-right font-semibold text-blue-900",children:"Montant march DH"}),c.jsx("th",{className:"py-2 px-3 text-center font-semibold text-blue-900",children:"Dlai du march"})]})}),c.jsx("tbody",{children:g.map((w,b)=>c.jsxs("tr",{onClick:()=>t(`/projects/${w.id.replace("project:","")}`),className:`border-b border-gray-200 hover:bg-blue-50 cursor-pointer transition-colors ${b%2===0?"bg-white":"bg-gray-50"}`,children:[c.jsx("td",{className:"py-3 px-3 font-medium text-gray-900",children:w.marcheNo}),c.jsx("td",{className:"py-3 px-3 text-gray-700 max-w-xs",children:c.jsx("p",{className:"line-clamp-2",children:w.objet})}),c.jsx("td",{className:"py-3 px-3 text-gray-600",children:w.commune||"-"}),c.jsx("td",{className:"py-3 px-3 text-gray-600",children:w.societe||"-"}),c.jsx("td",{className:"py-3 px-3 text-right font-medium text-gray-900",children:w.montantTTC>0?w.montantTTC.toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),c.jsx("td",{className:"py-3 px-3 text-center text-gray-600",children:w.delaisExecution?`${String(w.delaisExecution).padStart(2,"0")} Mois`:"-"})]},w.id))})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rsum financier"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Budget total"}),c.jsxs("span",{className:"font-medium",children:[(h.totalBudget/1e6).toFixed(2)," M DH"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:"100%"}})})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Montant ralis"}),c.jsxs("span",{className:"font-medium",children:[(h.totalRealized/1e6).toFixed(2)," M DH"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${h.totalBudget>0?h.totalRealized/h.totalBudget*100:0}%`}})})]}),c.jsx("div",{className:"pt-3 border-t border-gray-100",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Reste  raliser"}),c.jsxs("span",{className:"font-medium text-orange-600",children:[((h.totalBudget-h.totalRealized)/1e6).toFixed(2)," M DH"]})]})}),c.jsx("div",{className:"pt-3 border-t border-gray-100",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Taux de ralisation"}),c.jsxs("span",{className:`font-bold ${h.totalBudget>0&&h.totalRealized/h.totalBudget>=.7?"text-green-600":h.totalBudget>0&&h.totalRealized/h.totalBudget>=.4?"text-yellow-600":"text-red-600"}`,children:[h.totalBudget>0?(h.totalRealized/h.totalBudget*100).toFixed(1):0,"%"]})]})}),c.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Rpartition des projets"}),c.jsxs("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:[h.activeProjects>0&&c.jsx("div",{className:"bg-green-500",style:{width:`${h.activeProjects/h.totalProjects*100}%`},title:`En cours: ${h.activeProjects}`}),h.completedProjects>0&&c.jsx("div",{className:"bg-blue-500",style:{width:`${h.completedProjects/h.totalProjects*100}%`},title:`Termins: ${h.completedProjects}`}),h.totalProjects-h.activeProjects-h.completedProjects>0&&c.jsx("div",{className:"bg-gray-300",style:{width:`${(h.totalProjects-h.activeProjects-h.completedProjects)/h.totalProjects*100}%`},title:"Autres"})]}),c.jsxs("div",{className:"flex gap-4 mt-2 text-xs",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"En cours (",h.activeProjects,")"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Termins (",h.completedProjects,")"]})]})]})]})]})]})]})},F$=()=>{const{t:e}=$i(),{user:t}=On(),r=$s(),[n,s]=J.useState(""),[a,i]=J.useState("all"),[o,l]=J.useState("all"),[u,d]=J.useState("grid"),{projects:f,isLoading:p,error:h,refresh:m}=Ob((t==null?void 0:t.id)||null),g=navigator.onLine,y=g||!St(),x=!g&&St()?"Non disponible hors ligne":null,[w,b]=J.useState([]);J.useEffect(()=>{(async()=>{if(!(f!=null&&f.length)){b([]);return}const L=[];await Promise.all(f.map(async M=>{var Z;const K=((Z=M.id)==null?void 0:Z.replace("project:",""))||M.id;try{const ae=await mt.getBordereaux(K),he=ae.data||ae;Array.isArray(he)&&L.push(...he.map(re=>({...re,projectId:M.id})))}catch{}})),b(L.filter(M=>!M.deletedAt))})()},[f]);const N=_=>{if(!(w!=null&&w.length))return 0;const L=(_==null?void 0:_.replace("project:",""))||_,M=w.find(Z=>{var he;return(((he=Z.projectId||Z.project_id)==null?void 0:he.replace("project:",""))||Z.projectId)===L||Z.projectId===_});return!M||!M.lignes?0:M.lignes.reduce((Z,ae)=>Z+(ae.quantite||0)*(ae.prixUnitaire||ae.prix_unitaire||0),0)*1.2},A=Array.from(new Set((f==null?void 0:f.map(_=>_.annee))||[])).sort().reverse(),P=f==null?void 0:f.filter(_=>{var Z;const L=_.objet.toLowerCase().includes(n.toLowerCase())||_.marcheNo.toLowerCase().includes(n.toLowerCase())||((Z=_.societe)==null?void 0:Z.toLowerCase().includes(n.toLowerCase())),M=a==="all"||_.status===a,K=o==="all"||_.annee===o;return L&&M&&K}),j=async(_,L)=>{if(L.preventDefault(),L.stopPropagation(),!(!t||!confirm("tes-vous sr de vouloir supprimer ce projet?")))try{const M=(_==null?void 0:_.replace("project:",""))||_;await mt.deleteProject(M),m()}catch(M){console.error("Failed to delete project:",M),alert("Erreur lors de la suppression du projet")}},D={total:(P==null?void 0:P.length)||0,active:(P==null?void 0:P.filter(_=>_.status==="active").length)||0,completed:(P==null?void 0:P.filter(_=>_.status==="completed").length)||0,draft:(P==null?void 0:P.filter(_=>_.status==="draft").length)||0,totalBudget:(P==null?void 0:P.reduce((_,L)=>_+N(L.id),0))||0},E=_=>{switch(_){case"active":return c.jsx(vl,{className:"w-4 h-4"});case"completed":return c.jsx(bo,{className:"w-4 h-4"});case"archived":return c.jsx(dB,{className:"w-4 h-4"});default:return c.jsx(Wr,{className:"w-4 h-4"})}},I=_=>{switch(_){case"active":return"bg-green-100 text-green-700";case"completed":return"bg-blue-100 text-blue-700";case"archived":return"bg-gray-100 text-gray-700";default:return"bg-yellow-100 text-yellow-700"}};return p&&St()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(yo,{className:"w-8 h-8 animate-spin text-blue-600 mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Chargement des projets depuis le serveur..."})]}):h&&St()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(Au,{className:"w-12 h-12 text-red-500 mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:h}),c.jsxs("button",{onClick:()=>m(),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(No,{className:"w-4 h-4"}),"Ressayer"]})]}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.projects")}),c.jsxs("p",{className:"text-gray-600 mt-1",children:[D.total," ",D.total>1?"projets":"projet"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>m(),disabled:p,className:"btn btn-secondary flex items-center gap-2",title:"Rafrachir depuis le serveur",children:c.jsx(No,{className:`w-4 h-4 ${p?"animate-spin":""}`})}),y?c.jsxs(Pi,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[c.jsx(ms,{className:"w-5 h-5"}),e("project.newProject")]}):c.jsxs("button",{disabled:!0,className:"btn btn-primary flex items-center gap-2 opacity-50 cursor-not-allowed",title:x||"Non disponible hors ligne",children:[c.jsx(Au,{className:"w-5 h-5"}),e("project.newProject")]})]})]}),!g&&St()&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[c.jsx(Au,{className:"w-5 h-5 text-yellow-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-yellow-800",children:"Mode hors ligne"}),c.jsx("p",{className:"text-sm text-yellow-700",children:"Les modifications sont dsactives. Reconnectez-vous pour continuer."})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(Bu,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.total}),c.jsx("p",{className:"text-xs text-gray-600",children:"Total"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-green-100 text-green-600 rounded-lg",children:c.jsx(vl,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.active}),c.jsx("p",{className:"text-xs text-gray-600",children:"Actifs"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(bo,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.completed}),c.jsx("p",{className:"text-xs text-gray-600",children:"Termins"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-yellow-100 text-yellow-600 rounded-lg",children:c.jsx(Wr,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:D.draft}),c.jsx("p",{className:"text-xs text-gray-600",children:"Brouillons"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(dc,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[(D.totalBudget/1e6).toFixed(1),"M"]}),c.jsx("p",{className:"text-xs text-gray-600",children:"MAD"})]})]})})]}),c.jsx("div",{className:"card mb-6",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Ib,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),c.jsx("input",{type:"text",placeholder:"Rechercher (Objet, March, Socit...)",className:"input pl-10",value:n,onChange:_=>s(_.target.value)})]}),c.jsxs("select",{className:"input md:w-48",value:a,onChange:_=>i(_.target.value),children:[c.jsx("option",{value:"all",children:"Tous les statuts"}),c.jsx("option",{value:"draft",children:e("project.status.draft")}),c.jsx("option",{value:"active",children:e("project.status.active")}),c.jsx("option",{value:"completed",children:e("project.status.completed")}),c.jsx("option",{value:"archived",children:e("project.status.archived")})]}),c.jsxs("select",{className:"input md:w-32",value:o,onChange:_=>l(_.target.value),children:[c.jsx("option",{value:"all",children:"Toutes"}),A.map(_=>c.jsx("option",{value:_,children:_},_))]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>d("grid"),className:`p-2 rounded-lg border ${u==="grid"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:c.jsx(NB,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>d("list"),className:`p-2 rounded-lg border ${u==="list"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:c.jsx(SB,{className:"w-5 h-5"})})]})]})}),!P||P.length===0?c.jsxs("div",{className:"card text-center py-12",children:[c.jsx(Bu,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500 mb-4",children:n||a!=="all"||o!=="all"?"Aucun rsultat trouv":"Aucun projet pour le moment"}),!n&&a==="all"&&o==="all"&&c.jsxs(Pi,{to:"/projects/new",className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(ms,{className:"w-5 h-5"}),e("project.newProject")]})]}):u==="grid"?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:P.map(_=>{const L=_.id.includes(":")?_.id.split(":").pop():_.id;return c.jsxs("div",{className:"card hover:shadow-lg transition-shadow relative group",children:[c.jsxs(Pi,{to:`/projects/${L}`,className:"block",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-lg text-gray-900 flex-1 pr-2 line-clamp-2",children:_.objet}),c.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full flex-shrink-0 ${I(_.status)}`,children:[E(_.status),e(`project.status.${_.status}`)]})]}),c.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"March:"}),c.jsx("span",{className:"font-medium",children:_.marcheNo})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Anne:"}),c.jsx("span",{className:"font-medium",children:_.annee})]}),_.societe&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Socit:"}),c.jsx("span",{className:"font-medium truncate ml-2",children:_.societe})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Montant (TTC):"}),c.jsxs("span",{className:"font-medium text-primary-600",children:[N(_.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{className:"flex justify-between text-xs",children:[c.jsx("span",{children:"Cr le:"}),c.jsx("span",{children:Kn(new Date(_.createdAt),"dd/MM/yyyy")})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[c.jsx("span",{children:e("project.progress")}),c.jsxs("span",{className:"font-medium",children:[_.progress,"%"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${_.progress}%`}})})]})]}),c.jsxs("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2",children:[c.jsx("button",{onClick:M=>{M.preventDefault(),r(`/projects/${L}`)},className:"p-2 bg-white rounded-lg shadow-md hover:bg-primary-50 text-primary-600",title:"Voir",children:c.jsx(Z0,{className:"w-4 h-4"})}),c.jsx("button",{onClick:M=>j(_.id,M),className:"p-2 bg-white rounded-lg shadow-md hover:bg-red-50 text-red-600",title:"Supprimer",children:c.jsx(xs,{className:"w-4 h-4"})})]})]},_.id)})}):c.jsx("div",{className:"card overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Objet"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"March"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Anne"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Montant (TTC)"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Statut"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Avancement"}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:"Actions"})]})}),c.jsx("tbody",{children:P.map(_=>{const L=_.id.includes(":")?_.id.split(":").pop():_.id;return c.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/projects/${L}`),children:[c.jsxs("td",{className:"py-3 px-4",children:[c.jsx("div",{className:"font-medium text-gray-900",children:_.objet}),_.societe&&c.jsx("div",{className:"text-xs text-gray-500",children:_.societe})]}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:_.marcheNo}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:_.annee}),c.jsxs("td",{className:"py-3 px-4 text-sm font-medium text-primary-600",children:[N(_.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${I(_.status)}`,children:[E(_.status),e(`project.status.${_.status}`)]})}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500",style:{width:`${_.progress}%`}})}),c.jsxs("span",{className:"text-xs text-gray-600 w-10",children:[_.progress,"%"]})]})}),c.jsx("td",{className:"py-3 px-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:M=>{M.stopPropagation(),r(`/projects/${L}`)},className:"p-1.5 hover:bg-primary-50 text-primary-600 rounded",title:"Voir",children:c.jsx(Z0,{className:"w-4 h-4"})}),c.jsx("button",{onClick:M=>j(_.id,M),className:"p-1.5 hover:bg-red-50 text-red-600 rounded",title:"Supprimer",children:c.jsx(xs,{className:"w-4 h-4"})})]})})]},_.id)})})]})})})]})};class D${constructor(){Tt(this,"baseUrl","/assets")}async listAssets(t,r){try{const n=r?`?type=${r}`:"",s=await mt.get(`${this.baseUrl}/project/${t}${n}`);return(s==null?void 0:s.data)||[]}catch(n){return console.error("Error listing assets:",n),[]}}async getPhotos(t){return this.listAssets(t,"photo")}async getPVs(t){return this.listAssets(t,"pv")}async getDocuments(t){return this.listAssets(t,"document")}async getAssetCounts(t){try{const r=await mt.get(`${this.baseUrl}/project/${t}/counts`);return(r==null?void 0:r.data)||{photos:0,pv:0,documents:0}}catch(r){return console.error("Error getting asset counts:",r),{photos:0,pv:0,documents:0}}}async uploadPhotos(t,r,n){const s=new FormData;r.forEach(a=>{s.append("files",a)});try{const a=await mt.postFormData(`${this.baseUrl}/project/${t}/photos`,s,n);return(a==null?void 0:a.data)||[]}catch(a){throw console.error("Error uploading photos:",a),a}}async uploadDocument(t,r,n){const s=new FormData;s.append("file",r),s.append("type","document");try{const a=await mt.postFormData(`${this.baseUrl}/project/${t}/upload`,s,n);return a==null?void 0:a.data}catch(a){throw console.error("Error uploading document:",a),a}}async createPV(t,r){try{const n=await mt.post(`${this.baseUrl}/project/${t}/pv`,r);return n==null?void 0:n.data}catch(n){throw console.error("Error creating PV:",n),n}}async deleteAsset(t){try{await mt.delete(`${this.baseUrl}/${t}`)}catch(r){throw console.error("Error deleting asset:",r),r}}getAssetUrl(t){return t.startsWith("http")?t:`${window.location.origin}${t}`}formatFileSize(t){if(t===0)return"0 B";const r=1024,n=["B","KB","MB","GB"],s=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,s)).toFixed(2))+" "+n[s]}}const rs=new D$,R$={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},I$=(e,t,r)=>{let n;const s=R$[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},O$={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},M$={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},B$={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},U$={date:nf({formats:O$,defaultWidth:"full"}),time:nf({formats:M$,defaultWidth:"full"}),dateTime:nf({formats:B$,defaultWidth:"full"})},$$={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},z$=(e,t,r,n)=>$$[e],H$={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},q$={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},W$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},V$={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},K$={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},G$=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const s=["year","week","hour","minute","second"];let a;return r===1?a=n&&s.includes(n)?"re":"er":a="me",r+a},Y$=["MMM","MMMM"],X$={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&Y$.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:G$,era:fo({values:H$,defaultWidth:"wide"}),quarter:fo({values:q$,defaultWidth:"wide",argumentCallback:e=>e-1}),month:fo({values:W$,defaultWidth:"wide"}),day:fo({values:V$,defaultWidth:"wide"}),dayPeriod:fo({values:K$,defaultWidth:"wide"})},J$=/^(\d+)(ime|re|me|er|e)?/i,Q$=/\d+/i,Z$={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},ez={any:[/^av/i,/^ap/i]},tz={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},rz={any:[/1/i,/2/i,/3/i,/4/i]},nz={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},sz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},az={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},iz={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},oz={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},lz={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},cz={ordinalNumber:$C({matchPattern:J$,parsePattern:Q$,valueCallback:e=>parseInt(e)}),era:ho({matchPatterns:Z$,defaultMatchWidth:"wide",parsePatterns:ez,defaultParseWidth:"any"}),quarter:ho({matchPatterns:tz,defaultMatchWidth:"wide",parsePatterns:rz,defaultParseWidth:"any",valueCallback:e=>e+1}),month:ho({matchPatterns:nz,defaultMatchWidth:"wide",parsePatterns:sz,defaultParseWidth:"any"}),day:ho({matchPatterns:az,defaultMatchWidth:"wide",parsePatterns:iz,defaultParseWidth:"any"}),dayPeriod:ho({matchPatterns:oz,defaultMatchWidth:"any",parsePatterns:lz,defaultParseWidth:"any"})},Pc={code:"fr",formatDistance:I$,formatLong:U$,formatRelative:z$,localize:X$,match:cz,options:{weekStartsOn:1,firstWeekContainsDate:4}},uz=({projectId:e,photos:t,onRefresh:r})=>{const n=J.useRef(null),[s,a]=J.useState(!1),[i,o]=J.useState(0),[l,u]=J.useState(null),[d,f]=J.useState(null),p=()=>{var y;(y=n.current)==null||y.click()},h=async y=>{const x=y.target.files;if(!x||x.length===0)return;const w=Array.from(x).filter(b=>b.type.startsWith("image/"));if(w.length===0){alert("Veuillez slectionner des fichiers image");return}a(!0),o(0);try{await rs.uploadPhotos(e,w,b=>{o(b)}),r()}catch(b){console.error("Upload error:",b),alert("Erreur lors du tlchargement des photos")}finally{a(!1),o(0),n.current&&(n.current.value="")}},m=async y=>{if(confirm("Supprimer cette photo ?")){f(y.id);try{await rs.deleteAsset(y.id),r()}catch(x){console.error("Delete error:",x),alert("Erreur lors de la suppression")}finally{f(null)}}},g=y=>{const x=rs.getAssetUrl(y.storagePath),w=document.createElement("a");w.href=x,w.download=y.originalName||y.fileName,document.body.appendChild(w),w.click(),document.body.removeChild(w)};return t.length===0&&!s?c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(c0,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune photo"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Ajoutez des photos pour documenter l'avancement du projet"}),c.jsxs("button",{onClick:p,className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(c0,{className:"w-4 h-4"}),"Ajouter des photos"]}),c.jsx("input",{ref:n,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:h})]})}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Photos (",t.length,")"]}),c.jsx("button",{onClick:p,disabled:s,className:"btn btn-primary inline-flex items-center gap-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx(yo,{className:"w-4 h-4 animate-spin"}),i,"%"]}):c.jsxs(c.Fragment,{children:[c.jsx(Tp,{className:"w-4 h-4"}),"Ajouter des photos"]})}),c.jsx("input",{ref:n,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:h})]}),s&&c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx(yo,{className:"w-5 h-5 text-blue-600 animate-spin"}),c.jsx("span",{className:"text-blue-700 font-medium",children:"Tlchargement en cours..."})]}),c.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i}%`}})})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:t.map(y=>c.jsxs("div",{className:"group relative aspect-square bg-gray-100 rounded-lg overflow-hidden",children:[c.jsx("img",{src:rs.getAssetUrl(y.storagePath),alt:y.originalName,className:"w-full h-full object-cover cursor-pointer transition-transform group-hover:scale-105",onClick:()=>u(y),loading:"lazy"}),c.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>u(y),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition-colors",title:"Agrandir",children:c.jsx(BB,{className:"w-5 h-5 text-gray-700"})}),c.jsx("button",{onClick:()=>g(y),className:"p-2 bg-white rounded-full hover:bg-gray-100 transition-colors",title:"Tlcharger",children:c.jsx(Sl,{className:"w-5 h-5 text-gray-700"})}),c.jsx("button",{onClick:()=>m(y),disabled:d===y.id,className:"p-2 bg-white rounded-full hover:bg-red-50 transition-colors",title:"Supprimer",children:d===y.id?c.jsx(yo,{className:"w-5 h-5 text-red-500 animate-spin"}):c.jsx(xs,{className:"w-5 h-5 text-red-500"})})]})}),c.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[c.jsx("p",{className:"text-white text-xs truncate",children:y.originalName}),c.jsx("p",{className:"text-white/70 text-xs",children:Kn(new Date(y.createdAt),"dd/MM/yyyy",{locale:Pc})})]})]},y.id))}),l&&c.jsxs("div",{className:"fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4",onClick:()=>u(null),children:[c.jsx("button",{onClick:()=>u(null),className:"absolute top-4 right-4 p-2 text-white hover:bg-white/20 rounded-full transition-colors",children:c.jsx(Bi,{className:"w-6 h-6"})}),c.jsx("img",{src:rs.getAssetUrl(l.storagePath),alt:l.originalName,className:"max-w-full max-h-full object-contain",onClick:y=>y.stopPropagation()}),c.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 bg-black/50 rounded-lg px-4 py-2 text-white text-sm",children:[l.originalName,"  ",rs.formatFileSize(l.fileSize)]})]})]})},dz=[{value:"Rception Provisoire",label:"Rception Provisoire"},{value:"Rception Dfinitive",label:"Rception Dfinitive"},{value:"Installation de Chantier",label:"Installation de Chantier"},{value:"Constat",label:"Constat"},{value:"Runion de Chantier",label:"Runion de Chantier"},{value:"Arrt de Travaux",label:"Arrt de Travaux"},{value:"Reprise de Travaux",label:"Reprise de Travaux"},{value:"Autre",label:"Autre"}],fz=({projectId:e,pvs:t,onRefresh:r})=>{const[n,s]=J.useState(!1),[a,i]=J.useState(!1),[o,l]=J.useState(null),[u,d]=J.useState({pvType:"",date:new Date().toISOString().split("T")[0],observations:"",participants:[]}),[f,p]=J.useState(""),h=async()=>{if(!u.pvType||!u.date){alert("Veuillez remplir le type et la date du PV");return}i(!0);try{await rs.createPV(e,u),r(),s(!1),m()}catch(N){console.error("Error creating PV:",N),alert("Erreur lors de la cration du PV")}finally{i(!1)}},m=()=>{d({pvType:"",date:new Date().toISOString().split("T")[0],observations:"",participants:[]}),p("")},g=()=>{f.trim()&&(d(N=>({...N,participants:[...N.participants||[],f.trim()]})),p(""))},y=N=>{d(A=>{var P;return{...A,participants:((P=A.participants)==null?void 0:P.filter((j,D)=>D!==N))||[]}})},x=async N=>{if(confirm("Supprimer ce PV ?")){l(N.id);try{await rs.deleteAsset(N.id),r()}catch(A){console.error("Delete error:",A),alert("Erreur lors de la suppression")}finally{l(null)}}},w=N=>{const A=rs.getAssetUrl(N.storagePath);window.open(A,"_blank")},b=N=>{const A=rs.getAssetUrl(N.storagePath),P=document.createElement("a");P.href=A,P.download=N.originalName||N.fileName,document.body.appendChild(P),P.click(),document.body.removeChild(P)};return t.length===0?c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun PV"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Grez vos procs-verbaux (installation, rception, constat...)"}),c.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Wr,{className:"w-4 h-4"}),"Crer un PV"]})]}),n&&c.jsx(RS,{formData:u,setFormData:d,participantInput:f,setParticipantInput:p,addParticipant:g,removeParticipant:y,isCreating:a,onClose:()=>{s(!1),m()},onCreate:h})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Procs-Verbaux (",t.length,")"]}),c.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(ms,{className:"w-4 h-4"}),"Crer un PV"]})]}),c.jsx("div",{className:"space-y-3",children:t.map(N=>{const A=N.metadata||{};return c.jsxs("div",{className:"card hover:shadow-md transition-shadow",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:c.jsx(Wr,{className:"w-6 h-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:A.pvType||"PV"}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(Dx,{className:"w-4 h-4"}),c.jsx("span",{children:A.date||Kn(new Date(N.createdAt),"dd/MM/yyyy",{locale:Pc})})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"text-right text-sm text-gray-500",children:[c.jsxs("p",{children:["Cr le ",Kn(new Date(N.createdAt),"dd/MM/yyyy  HH:mm",{locale:Pc})]}),N.createdByName&&c.jsxs("p",{children:["par ",N.createdByName]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>w(N),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Voir",children:c.jsx(Z0,{className:"w-5 h-5 text-gray-600"})}),c.jsx("button",{onClick:()=>b(N),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Tlcharger",children:c.jsx(Sl,{className:"w-5 h-5 text-gray-600"})}),c.jsx("button",{onClick:()=>x(N),disabled:o===N.id,className:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:o===N.id?c.jsx(yo,{className:"w-5 h-5 text-red-500 animate-spin"}):c.jsx(xs,{className:"w-5 h-5 text-red-500"})})]})]})]}),A.observations&&c.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:c.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:A.observations})})]},N.id)})}),n&&c.jsx(RS,{formData:u,setFormData:d,participantInput:f,setParticipantInput:p,addParticipant:g,removeParticipant:y,isCreating:a,onClose:()=>{s(!1),m()},onCreate:h})]})},RS=({formData:e,setFormData:t,participantInput:r,setParticipantInput:n,addParticipant:s,removeParticipant:a,isCreating:i,onClose:o,onCreate:l})=>c.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Crer un PV"}),c.jsx("button",{onClick:o,className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(Bi,{className:"w-5 h-5 text-gray-500"})})]}),c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type de PV *"}),c.jsxs("select",{value:e.pvType,onChange:u=>t(d=>({...d,pvType:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[c.jsx("option",{value:"",children:"Slectionner un type"}),dz.map(u=>c.jsx("option",{value:u.value,children:u.label},u.value))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),c.jsx("input",{type:"date",value:e.date,onChange:u=>t(d=>({...d,date:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observations"}),c.jsx("textarea",{value:e.observations,onChange:u=>t(d=>({...d,observations:u.target.value})),rows:4,placeholder:"Dcrivez les observations du PV...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Participants"}),c.jsxs("div",{className:"flex gap-2 mb-2",children:[c.jsx("input",{type:"text",value:r,onChange:u=>n(u.target.value),onKeyPress:u=>u.key==="Enter"&&(u.preventDefault(),s()),placeholder:"Nom du participant",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),c.jsx("button",{onClick:s,type:"button",className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:c.jsx(ms,{className:"w-5 h-5"})})]}),e.participants&&e.participants.length>0&&c.jsx("div",{className:"flex flex-wrap gap-2",children:e.participants.map((u,d)=>c.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 rounded-full text-sm",children:[u,c.jsx("button",{onClick:()=>a(d),className:"hover:text-red-500",children:c.jsx(Bi,{className:"w-4 h-4"})})]},d))})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-3 p-4 border-t bg-gray-50",children:[c.jsx("button",{onClick:o,disabled:i,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",children:"Annuler"}),c.jsx("button",{onClick:l,disabled:i||!e.pvType||!e.date,className:"btn btn-primary inline-flex items-center gap-2",children:i?c.jsxs(c.Fragment,{children:[c.jsx(yo,{className:"w-4 h-4 animate-spin"}),"Cration..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Wr,{className:"w-4 h-4"}),"Crer le PV"]})})]})]})}),hz=e=>e.includes("pdf")?Wr:e.includes("spreadsheet")||e.includes("excel")?LC:e.includes("image")?mB:e.includes("word")||e.includes("document")?Wr:gB,pz=e=>e.includes("pdf")?"bg-red-100 text-red-600":e.includes("spreadsheet")||e.includes("excel")?"bg-green-100 text-green-600":e.includes("image")?"bg-purple-100 text-purple-600":e.includes("word")||e.includes("document")?"bg-blue-100 text-blue-600":"bg-gray-100 text-gray-600",mz=({projectId:e,documents:t,onRefresh:r})=>{const n=J.useRef(null),[s,a]=J.useState(!1),[i,o]=J.useState(0),[l,u]=J.useState(null),d=()=>{var g;(g=n.current)==null||g.click()},f=async g=>{var x;const y=(x=g.target.files)==null?void 0:x[0];if(y){a(!0),o(0);try{await rs.uploadDocument(e,y,w=>{o(w)}),r()}catch(w){console.error("Upload error:",w),alert("Erreur lors du tlchargement du document")}finally{a(!1),o(0),n.current&&(n.current.value="")}}},p=async g=>{if(confirm("Supprimer ce document ?")){u(g.id);try{await rs.deleteAsset(g.id),r()}catch(y){console.error("Delete error:",y),alert("Erreur lors de la suppression")}finally{u(null)}}},h=g=>{const y=rs.getAssetUrl(g.storagePath),x=document.createElement("a");x.href=y,x.download=g.originalName||g.fileName,document.body.appendChild(x),x.click(),document.body.removeChild(x)},m=g=>{const y=rs.getAssetUrl(g.storagePath);window.open(y,"_blank")};return t.length===0&&!s?c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(L1,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun document"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Attachez vos factures, plans, et autres documents importants"}),c.jsxs("button",{onClick:d,className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(L1,{className:"w-4 h-4"}),"Joindre un document"]}),c.jsx("input",{ref:n,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.dwg,.dxf,.png,.jpg,.jpeg",className:"hidden",onChange:f})]})}):c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Documents (",t.length,")"]}),c.jsx("button",{onClick:d,disabled:s,className:"btn btn-primary inline-flex items-center gap-2",children:s?c.jsxs(c.Fragment,{children:[c.jsx(yo,{className:"w-4 h-4 animate-spin"}),i,"%"]}):c.jsxs(c.Fragment,{children:[c.jsx(Tp,{className:"w-4 h-4"}),"Joindre un document"]})}),c.jsx("input",{ref:n,type:"file",accept:".pdf,.doc,.docx,.xls,.xlsx,.dwg,.dxf,.png,.jpg,.jpeg",className:"hidden",onChange:f})]}),s&&c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsx(yo,{className:"w-5 h-5 text-blue-600 animate-spin"}),c.jsx("span",{className:"text-blue-700 font-medium",children:"Tlchargement en cours..."})]}),c.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${i}%`}})})]}),c.jsx("div",{className:"space-y-2",children:t.map(g=>{const y=hz(g.mimeType),x=pz(g.mimeType);return c.jsx("div",{className:"card hover:shadow-md transition-shadow",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[c.jsx("div",{className:`w-12 h-12 ${x} rounded-xl flex items-center justify-center flex-shrink-0`,children:c.jsx(y,{className:"w-6 h-6"})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h3",{className:"font-medium text-gray-900 truncate cursor-pointer hover:text-primary-600",onClick:()=>m(g),title:g.originalName,children:g.originalName}),c.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[c.jsx("span",{children:rs.formatFileSize(g.fileSize)}),c.jsx("span",{children:""}),c.jsx("span",{children:Kn(new Date(g.createdAt),"dd/MM/yyyy",{locale:Pc})}),g.createdByName&&c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsx("span",{children:g.createdByName})]})]})]})]}),c.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 ml-4",children:[c.jsx("button",{onClick:()=>h(g),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",title:"Tlcharger",children:c.jsx(Sl,{className:"w-5 h-5 text-gray-600"})}),c.jsx("button",{onClick:()=>p(g),disabled:l===g.id,className:"p-2 hover:bg-red-50 rounded-lg transition-colors",title:"Supprimer",children:l===g.id?c.jsx(yo,{className:"w-5 h-5 text-red-500 animate-spin"}):c.jsx(xs,{className:"w-5 h-5 text-red-500"})})]})]})},g.id)})})]})},rp=[{id:"DEB-001",code:"1.1",designation:"Dblais pour ouvrages excuts dans l'eau en terrain de toute nature y compris la roche et  toute profondeur LE METRE CUBE",unite:"M",prixReference:48,categorie:"Terrassement",tags:["dblais","eau","terrain","roche"]},{id:"FOU-001",code:"1.2",designation:"Fourniture et mise en place de gabions y compris cage, enrochement et terrassements LE METRE CUBE",unite:"M",prixReference:400,categorie:"Terrassement",tags:["fourniture","gabions","cage","enrochement"]},{id:"BET-001",code:"1.3",designation:"Gros bton dos  300kg/m3 de ciment CPJ 45 y compris coffrage et dcoffrage et toutes sujtions LE METRE CUBE",unite:"M",prixReference:753.5,categorie:"Bton",tags:["bton","ciment","coffrage","dcoffrage"]},{id:"REM-001",code:"1.4",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:30,categorie:"Terrassement",tags:["remblais","compact","ouvrages"]},{id:"DEB-002",code:"2.1",designation:"Dblais pour ouvrages et canaux excuts dans le lit de l'oued y compris rocher et terrassement dans l'eau toutes sujtions. LE METRE CUBE",unite:"M",prixReference:70,categorie:"Hydro-Agricole",tags:["dblais","canaux","oued","rocher"]},{id:"HER-001",code:"2.2",designation:"Hrissonnage de gros pierres sches poses  la main sur le sol et point en l'air  recopiissage  la pierre casse et fortement dame. LE METRE CARRE",unite:"M",prixReference:50,categorie:"Hydro-Agricole",tags:["hrissonnage","pierres","casse","dame"]},{id:"BET-002",code:"2.3",designation:"Bton pour bton arm dos  350kg/m3 de ciment CPJ 45 y compris coffrage, dcoffrage et toutes sujtions. LE METRE CUBE",unite:"M",prixReference:1150,categorie:"Bton",tags:["bton arm","ciment","coffrage"]},{id:"FOU-002",code:"2.4",designation:"Fourniture et pose des aciers mi-durs  haute adhrence pour armatures de tout diamtre y compris toutes sujtions de mise en dpts. LE KILOGRAMME",unite:"KG",prixReference:15,categorie:"Ferraillage",tags:["fourniture","aciers","armatures","adhrence"]},{id:"CUR-001",code:"2.5",designation:"Curage et reprofilage de khettaras LE METRE LINEAIRE",unite:"ML",prixReference:400,categorie:"Hydro-Agricole",tags:["curage","reprofilage","khettaras"]},{id:"REM-002",code:"2.6",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:40,categorie:"Terrassement",tags:["remblais","ordinaire","compact"]},{id:"JOI-001",code:"2.7",designation:"Joint de retrait ralis au moyen d'un produit bitumineux y compris toutes sujtions LE METRE LINEAIRE",unite:"ML",prixReference:100,categorie:"tanchit",tags:["joint","retrait","bitumineux"]},{id:"FOU-003",code:"2.8",designation:"Fourniture et pose de tle mtalliques pour vannette LE KILOGRAMME",unite:"KG",prixReference:60,categorie:"Mtallerie",tags:["fourniture","tle","vannette"]},{id:"MUR-001",code:"3.1",designation:"Mur en moellons de pierre y compris mortier et toutes sujtions LE METRE CUBE",unite:"M",prixReference:850,categorie:"Maonnerie",tags:["mur","moellons","pierre","mortier"]},{id:"END-001",code:"3.2",designation:"Enduit de ciment liss sur murs y compris toutes sujtions LE METRE CARRE",unite:"M",prixReference:45,categorie:"Finition",tags:["enduit","ciment","liss","murs"]},{id:"CHA-001",code:"4.1",designation:"Charpente mtallique y compris peinture antirouille LE KILOGRAMME",unite:"KG",prixReference:25,categorie:"Charpente",tags:["charpente","mtallique","peinture"]},{id:"TUI-001",code:"4.2",designation:"Tuiles mcaniques y compris pose et accessoires LE METRE CARRE",unite:"M",prixReference:120,categorie:"Couverture",tags:["tuiles","mcaniques","pose"]}],gz=["Terrassement","Bton","Ferraillage","Hydro-Agricole","Maonnerie","Finition","tanchit","Mtallerie","Charpente","Couverture"],xz=e=>{if(!e)return rp;const t=e.toLowerCase();return rp.filter(r=>r.designation.toLowerCase().includes(t)||r.code.includes(t)||r.categorie.toLowerCase().includes(t)||r.tags.some(n=>n.includes(t)))},vz=e=>rp.filter(t=>t.categorie===e),WC=({bordereauId:e,onClose:t,onSaved:r})=>{const{user:n}=On(),[s,a]=J.useState([]),[i,o]=J.useState(null),[l,u]=J.useState(""),[d,f]=J.useState(!1),[p,h]=J.useState(0),m=J.useRef({}),[g,y]=J.useState(null),[x,w]=J.useState(!0),b=Dn(()=>St()?Promise.resolve(void 0):be.bordereaux.get(e),[e]),N=e!=null&&e.includes(":")?e.split(":").pop():e,A=J.useCallback(async()=>{if(!(!St()||!N))try{w(!0),console.log(` [BordereauTable] Fetching bordereau ${N}...`);const U=await mt.getBordereau(N),ue=U.data||U;console.log(" [BordereauTable] Loaded bordereau:",ue),y(ue)}catch(U){console.error(" [BordereauTable] Failed to fetch bordereau:",U)}finally{w(!1)}},[N]);J.useEffect(()=>{St()?A():w(!1)},[A]);const P=St()?g:b,j=l.length>=2?xz(l).slice(0,5):[];J.useEffect(()=>{P!=null&&P.lignes&&a(P.lignes)},[P]);const D=()=>{const U=s.reduce((C,R)=>C+R.montant,0),ue=U*.2,pe=U+ue;return{montantHT:U,tva:ue,montantTTC:pe}},E=()=>{const U={id:Tr(),numero:s.length+1,designation:"",unite:"",quantite:0,prixUnitaire:0,montant:0};a([...s,U]),o(U.id),setTimeout(()=>{var ue;(ue=m.current[`designation-${U.id}`])==null||ue.focus()},50)},I=(U,ue,pe)=>{a(C=>C.map(R=>{if(R.id===U){const B={...R,[ue]:pe};return(ue==="quantite"||ue==="prixUnitaire")&&(B.montant=B.quantite*B.prixUnitaire),B}return R}))},_=U=>{const pe=s.filter(C=>C.id!==U).map((C,R)=>({...C,numero:R+1}));a(pe)},L=U=>{if(!i||!j[U])return;const ue=j[U];I(i,"designation",ue.designation),I(i,"unite",ue.unite),I(i,"prixUnitaire",ue.prixReference),u(""),f(!1),h(0),setTimeout(()=>{var pe;(pe=m.current[`quantite-${i}`])==null||pe.focus()},50)},M=(U,ue,pe)=>{pe==="designation"&&d?U.key==="ArrowDown"?(U.preventDefault(),h(C=>Math.min(C+1,j.length-1))):U.key==="ArrowUp"?(U.preventDefault(),h(C=>Math.max(C-1,0))):U.key==="Enter"?(U.preventDefault(),L(p)):U.key==="Escape"&&(f(!1),u("")):U.key==="Enter"&&(U.preventDefault(),(pe==="montant"||pe==="prixUnitaire")&&E())},K=async()=>{if(!n||!P)return;const{montantHT:U}=D(),ue={...P,lignes:s,montantTotal:U,updatedAt:new Date().toISOString()};if(St())try{console.log(" [BordereauTable] Saving bordereau..."),await mt.updateBordereau(N,{lignes:s,montantTotal:U}),y(ue),console.log(" [BordereauTable] Bordereau saved"),r&&r(),alert("Bordereau enregistr avec succs !")}catch(pe){console.error(" [BordereauTable] Failed to save:",pe),alert("Erreur lors de l'enregistrement")}else await be.bordereaux.update(e,ue),await ps("UPDATE","bordereau",e.replace("bordereau:",""),ue,n.id),alert("Bordereau enregistr avec succs !")},Z=()=>{if(!P)return;const{montantHT:U,tva:ue,montantTTC:pe}=D();let C=`N,Dsignation des ouvrages,U,Quantit,Prix unitaire (MAD),Montant (MAD)
`;s.forEach(O=>{C+=`${O.numero},"${O.designation}",${O.unite},${O.quantite},${O.prixUnitaire},${O.montant}
`}),C+=`
,,,Total HT:,,${U.toFixed(2)}
`,C+=`,,,TVA 20%:,,${ue.toFixed(2)}
`,C+=`,,,Total TTC:,,${pe.toFixed(2)}
`;const R=new Blob([C],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a");B.href=URL.createObjectURL(R),B.download=`${P.reference}.csv`,B.click()};if(x||!P)return c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})});const{montantHT:ae,tva:he,montantTTC:re}=D();return c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ii,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:P.reference}),c.jsx("p",{className:"text-sm text-gray-600",children:P.designation})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:Z,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Sl,{className:"w-4 h-4"}),"Exporter CSV"]}),c.jsxs("button",{onClick:K,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Yu,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 border-b-2 border-gray-200",children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-16",children:"N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Dsignation des ouvrages"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-24",children:"Unit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-32",children:"Quantit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Prix unitaire (MAD)"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Montant (MAD)"}),c.jsx("th",{className:"px-4 py-3 w-12"})]})}),c.jsx("tbody",{children:s.map(U=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-2 text-gray-700",children:U.numero}),c.jsxs("td",{className:"px-4 py-2 relative",children:[c.jsx("input",{ref:ue=>m.current[`designation-${U.id}`]=ue,type:"text",value:i===U.id&&l||U.designation,onChange:ue=>{const pe=ue.target.value;I(U.id,"designation",pe),i===U.id&&(u(pe),f(pe.length>=2),h(0))},onFocus:()=>{o(U.id),u(U.designation),U.designation.length>=2&&f(!0)},onBlur:()=>{setTimeout(()=>{f(!1),o(null),u("")},200)},onKeyDown:ue=>M(ue,U.id,"designation"),className:"input text-sm w-full",placeholder:"Rechercher ou taper..."}),i===U.id&&d&&j.length>0&&c.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:j.map((ue,pe)=>c.jsxs("div",{onClick:()=>L(pe),className:`px-4 py-2 cursor-pointer ${pe===p?"bg-primary-50":"hover:bg-gray-50"}`,children:[c.jsx("div",{className:"font-medium text-sm text-gray-900",children:ue.code}),c.jsx("div",{className:"text-xs text-gray-600 truncate",children:ue.designation}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[c.jsxs("span",{className:"font-medium text-primary-600",children:[ue.prixReference," MAD"]}),c.jsx("span",{children:""}),c.jsx("span",{children:ue.unite})]})]},ue.id))})]}),c.jsx("td",{className:"px-2 py-2 w-24",children:c.jsxs("select",{value:U.unite||"",onChange:ue=>I(U.id,"unite",ue.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[c.jsx("option",{value:"",children:"--"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"ML",children:"ML"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"KG",children:"KG"}),c.jsx("option",{value:"T",children:"T"}),c.jsx("option",{value:"U",children:"U"}),c.jsx("option",{value:"ENS",children:"ENS"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"FF",children:"FF"}),c.jsx("option",{value:"L",children:"L"})]})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{ref:ue=>m.current[`quantite-${U.id}`]=ue,type:"number",step:"0.01",value:U.quantite||"",onChange:ue=>I(U.id,"quantite",parseFloat(ue.target.value)||0),onKeyDown:ue=>M(ue,U.id,"quantite"),className:"input text-sm text-right w-full"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{type:"number",step:"0.01",value:U.prixUnitaire||"",onChange:ue=>I(U.id,"prixUnitaire",parseFloat(ue.target.value)||0),onKeyDown:ue=>M(ue,U.id,"prixUnitaire"),className:"input text-sm text-right w-full"})}),c.jsx("td",{className:"px-4 py-2 text-right font-medium text-gray-900",children:U.montant.toFixed(2)}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("button",{onClick:()=>_(U.id),className:"p-1 hover:bg-red-50 text-red-600 rounded transition-colors",children:c.jsx(xs,{className:"w-4 h-4"})})})]},U.id))}),c.jsx("tfoot",{children:c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-4 py-2",children:c.jsxs("button",{onClick:E,className:"flex items-center gap-2 text-primary-600 hover:text-primary-700 font-medium text-sm",children:[c.jsx(ms,{className:"w-4 h-4"}),"Ajouter une ligne"]})})})})]})}),c.jsx("div",{className:"mt-6 pt-6 border-t",children:c.jsxs("div",{className:"max-w-md ml-auto space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[c.jsx("span",{children:"Total HT:"}),c.jsxs("span",{className:"font-semibold",children:[ae.toFixed(2)," MAD"]})]}),c.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[c.jsx("span",{children:"TVA 20%:"}),c.jsxs("span",{className:"font-semibold",children:[he.toFixed(2)," MAD"]})]}),c.jsxs("div",{className:"flex items-center justify-between text-lg font-bold text-gray-900 pt-2 border-t",children:[c.jsx("span",{children:"Total TTC:"}),c.jsxs("span",{className:"text-primary-600",children:[re.toFixed(2)," MAD"]})]})]})})]})},VC=({onClose:e,onCreate:t})=>{const[r,n]=J.useState(""),[s,a]=J.useState(""),i=o=>{o.preventDefault(),r.trim()&&s.trim()&&t({reference:r.trim(),designation:s.trim()})};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full mx-4",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau bordereau"}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Bi,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:r,onChange:o=>n(o.target.value),className:"input",placeholder:"Ex: BPU-2024-01",required:!0,autoFocus:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),c.jsx("textarea",{value:s,onChange:o=>a(o.target.value),className:"input",rows:3,placeholder:"Ex: Bordereau des Prix Unitaires - Terrassement",required:!0})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"Crer"})]})]})]})})},KC=({projectId:e,onClose:t,onCreated:r})=>{const{user:n}=On(),[s,a]=J.useState(""),[i,o]=J.useState(""),[l,u]=J.useState(new Set),d=i?vz(i):rp.filter(h=>s===""||h.designation.toLowerCase().includes(s.toLowerCase())||h.code.toLowerCase().includes(s.toLowerCase())||h.tags.some(m=>m.toLowerCase().includes(s.toLowerCase()))),f=h=>{const m=new Set(l);m.has(h)?m.delete(h):m.add(h),u(m)},p=async()=>{if(!n||l.size===0){alert("Veuillez slectionner au moins un article");return}const h=`bordereau:${Tr()}`,m=new Date().toISOString(),g=new Date().getFullYear(),y=Array.from(l).map((w,b)=>{const N=rp.find(A=>A.id===w);return N?{id:Tr(),numero:b+1,designation:N.designation,unite:N.unite,quantite:0,prixUnitaire:N.prixReference,montant:0}:null}).filter(w=>w!==null),x={id:h,projectId:e,userId:n.id,reference:`BPU-${g}`,designation:"Bordereau des Prix Unitaires",lignes:y,montantTotal:0,createdAt:m,updatedAt:m};St()?await mt.createBordereau({projectId:e.replace("project:",""),reference:`BPU-${g}`,designation:"Bordereau des Prix Unitaires",lignes:y,montantTotal:0}):(await be.bordereaux.add(x),await ps("CREATE","bordereau",h.replace("bordereau:",""),x,n.id)),r(h)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bibliothque de modles"}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.size," article(s) slectionn(s)"]})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Bi,{className:"w-5 h-5"})})]}),c.jsx("div",{className:"p-6 border-b space-y-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Ib,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),c.jsx("input",{type:"text",value:s,onChange:h=>a(h.target.value),className:"input pl-10",placeholder:"Rechercher par dsignation, code ou tag..."})]}),c.jsxs("select",{value:i,onChange:h=>o(h.target.value),className:"input w-64",children:[c.jsx("option",{value:"",children:"Toutes les catgories"}),gz.map(h=>c.jsx("option",{value:h,children:h},h))]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(h=>c.jsx("div",{onClick:()=>f(h.id),className:`card cursor-pointer transition-all border-2 ${l.has(h.id)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("input",{type:"checkbox",checked:l.has(h.id),onChange:()=>{},className:"mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900",children:h.code}),c.jsx("div",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:h.designation})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"font-semibold text-primary-600",children:[h.prixReference," MAD"]}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h.unite})]})]}),c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded",children:h.categorie}),h.tags.slice(0,2).map((m,g)=>c.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:m},g))]})]})]})},h.id))}),d.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(xB,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-500",children:"Aucun modle trouv"})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:p,disabled:l.size===0,className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:["Crer avec ",l.size," article(s)"]})]})})]})})},GC=({currentProjectId:e,onClose:t,onCopied:r})=>{var E;const{user:n}=On(),[s,a]=J.useState(""),[i,o]=J.useState(""),[l,u]=J.useState(""),[d,f]=J.useState(""),p=Dn(()=>St()?Promise.resolve([]):be.projects.where("userId").equals((n==null?void 0:n.id)||"").and(I=>!I.deletedAt&&I.id!==`project:${e}`).toArray(),[n,e]),h=Dn(()=>St()||!s?Promise.resolve([]):be.bordereaux.where("projectId").equals(s).and(I=>!I.deletedAt).toArray(),[s]),m=Dn(()=>St()||!i?Promise.resolve(null):be.bordereaux.get(i),[i]),[g,y]=J.useState([]),[x,w]=J.useState([]),[b,N]=J.useState(null);J.useEffect(()=>{St()&&mt.getProjects().then(I=>{const _=I.data||I;y(_.filter(L=>L.id!==e))})},[e]),J.useEffect(()=>{if(St()&&s){const I=s.replace("project:","");mt.getBordereaux(I).then(_=>{w(_.data||_)})}},[s]),J.useEffect(()=>{if(St()&&i){const I=x.find(_=>_.id===i);N(I||null)}},[i,x]);const A=St()?g:p,P=St()?x:h,j=St()?b:m,D=async()=>{if(!n||!j||!l.trim()||!d.trim()){alert("Veuillez remplir tous les champs et slectionner un bordereau");return}const I=`bordereau:${Tr()}`,_=new Date().toISOString(),L=j.lignes.map((K,Z)=>({...K,id:Tr(),numero:Z+1,quantite:0,montant:0})),M={id:I,projectId:e,userId:n.id,reference:l.trim(),designation:d.trim(),lignes:L,montantTotal:0,createdAt:_,updatedAt:_};St()?await mt.createBordereau({projectId:e.replace("project:",""),reference:l.trim(),designation:d.trim(),lignes:L,montantTotal:0}):(await be.bordereaux.add(M),await ps("CREATE","bordereau",I.replace("bordereau:",""),M,n.id)),r(I)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Copier depuis un projet"}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Bi,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"1. Slectionner le projet source"}),c.jsxs("select",{value:s,onChange:I=>{a(I.target.value),o("")},className:"input w-full",children:[c.jsx("option",{value:"",children:"Choisir un projet..."}),A==null?void 0:A.map(I=>c.jsxs("option",{value:I.id,children:[I.objet," - March N ",I.marcheNo]},I.id))]})]}),s&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2. Slectionner le bordereau  copier"}),P&&P.length>0?c.jsx("div",{className:"space-y-2",children:P.map(I=>{var _,L;return c.jsx("div",{onClick:()=>o(I.id),className:`card cursor-pointer transition-all border-2 ${i===I.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-primary-100 text-primary-600 rounded-lg flex items-center justify-center",children:c.jsx(Wr,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-gray-900",children:I.reference}),c.jsx("div",{className:"text-sm text-gray-600",children:I.designation}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[((_=I.lignes)==null?void 0:_.length)||0," lignes  ",(L=I.montantTotal)==null?void 0:L.toLocaleString()," MAD"]})]})]})},I.id)})}):c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(Wr,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),c.jsx("p",{children:"Aucun bordereau dans ce projet"})]})]}),i&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"3. Informations du nouveau bordereau"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:l,onChange:I=>u(I.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-02"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Dsignation *"}),c.jsx("input",{type:"text",value:d,onChange:I=>f(I.target.value),className:"input w-full",placeholder:"Ex: Bordereau copi"})]}),j&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(P1,{className:"w-5 h-5 text-blue-600 mt-0.5"}),c.jsxs("div",{className:"text-sm text-blue-900",children:[c.jsx("p",{className:"font-medium mb-1",children:"Contenu  copier:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[c.jsxs("li",{children:[((E=j.lignes)==null?void 0:E.length)||0," lignes de bordereau"]}),c.jsx("li",{children:"Dsignations et units"}),c.jsx("li",{children:"Prix unitaires de rfrence"}),c.jsx("li",{className:"font-medium",children:"Les quantits seront remises  0"})]})]})]})})]})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:D,disabled:!i||!l.trim()||!d.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx(P1,{className:"w-4 h-4"}),"Copier le bordereau"]})]})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var YC=1252,yz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],zb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hb=function(e){yz.indexOf(e)!=-1&&(YC=zb[0]=e)};function wz(){Hb(1252)}var Li=function(e){Hb(e)};function XC(){Li(1200),wz()}function IS(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function bz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function JC(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var qh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?bz(e.slice(2)):t==254&&r==255?JC(e.slice(2)):t==65279?e.slice(1):e},Km=function(t){return String.fromCharCode(t)},OS=function(t){return String.fromCharCode(t)},np,fc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function MS(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=fc.charAt(a)+fc.charAt(i)+fc.charAt(o)+fc.charAt(l);return t}function Oa(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=fc.indexOf(e.charAt(u++)),i=fc.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=fc.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=fc.indexOf(e.charAt(u++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var dr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Xu=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Lc(e){return dr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function BS(e){return dr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ti=function(t){return dr?Xu(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Ju(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function qb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return qb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var tc=dr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Xu(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Nz(e){for(var t=[],r=0,n=e.length+250,s=Lc(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Lc(65535),n=65530)}return t.push(s.slice(0,r)),tc(t)}var ta=/\u0000/g,Wh=/[\u0001-\u0006]/g;function sf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Fi(e,t){var r=""+e;return r.length>=t?r:dn("0",t-r.length)+r}function Wb(e,t){var r=""+e;return r.length>=t?r:dn(" ",t-r.length)+r}function R1(e,t){var r=""+e;return r.length>=t?r:r+dn(" ",t-r.length)}function Sz(e,t){var r=""+Math.round(e);return r.length>=t?r:dn("0",t-r.length)+r}function kz(e,t){var r=""+e;return r.length>=t?r:dn("0",t-r.length)+r}var US=Math.pow(2,32);function yd(e,t){if(e>US||e<-US)return Sz(e,t);var r=Math.round(e);return kz(r,t)}function I1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var $S=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function _z(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var er={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},zS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Ez={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function O1(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+l,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,l=u,u=d;if(d>t&&(u>t?(d=l,o=a):(d=u,o=i)),!r)return[0,n*o,d];var p=Math.floor(n*o/d);return[p,n*o-p*d,d]}function fu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Lz(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var QC=new Date(1899,11,31,0,0,0),Az=QC.getTime(),jz=new Date(1900,2,1,0,0,0);function ZC(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=jz&&(r+=24*60*60*1e3),(r-(Az+(e.getTimezoneOffset()-QC.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Vb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Cz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Tz(e){var t=e<0?12:11,r=Vb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Pz(e){var t=Vb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function sp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Tz(e):t===10?r=e.toFixed(10).substr(0,12):r=Pz(e),Vb(Cz(r.toUpperCase()))}function Uu(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return oi(14,ZC(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Lz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Fz(e,t,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return mv[r.m-1][1];case 5:return mv[r.m-1][0];default:return mv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return $S[r.q][0];default:return $S[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Fi(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Fi(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?Fi(l,u):"";return d}function hc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var eT=/%/g;function Dz(e,t,r){var n=t.replace(eT,""),s=t.length-n.length;return dl(e,n,r*Math.pow(10,2*s))+dn("%",s)}function Rz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return dl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rT=/# (\?+)( ?)\/( ?)(\d+)/;function Iz(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?dn(" ",e[1].length+1+e[4].length):Wb(i,e[1].length)+e[2]+"/"+e[3]+Fi(o,e[4].length))}function Oz(e,t,r){return r+(t===0?"":""+t)+dn(" ",e[1].length+2+e[4].length)}var nT=/^#*0*\.([0#]+)/,sT=/\).*[0#]/,aT=/\(###\) ###\\?-####/;function Ys(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function HS(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function qS(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Mz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Bz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ka(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ka("n",n,r):"("+Ka("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Rz(e,t,r);if(t.indexOf("%")!==-1)return Dz(e,t,r);if(t.indexOf("E")!==-1)return tT(t,r);if(t.charCodeAt(0)===36)return"$"+Ka(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+yd(l,t.length);if(t.match(/^[#?]+$/))return s=yd(r,0),s==="0"&&(s=""),s.length>t.length?s:Ys(t.substr(0,t.length-s.length))+s;if(a=t.match(rT))return Iz(a,l,u);if(t.match(/^#+0+$/))return u+yd(l,t.length-t.indexOf("0"));if(a=t.match(nT))return s=HS(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Ys(a[1])).replace(/\.$/,"."+Ys(a[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+dn("0",Ys(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+HS(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+hc(yd(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ka(e,t,-r):hc(""+(Math.floor(r)+Mz(r,a[1].length)))+"."+Fi(qS(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ka(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=sf(Ka(e,t.replace(/[\\-]/g,""),r)),i=0,sf(sf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(aT))return s=Ka(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=O1(l,Math.pow(10,i)-1,!1),s=""+u,d=dl("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=R1(o[2],i),d.length<a[4].length&&(d=Ys(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=O1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Wb(o[1],i)+a[2]+"/"+a[3]+R1(o[2],i):dn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=yd(r,0),t.length<=s.length?s:Ys(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,p=t.length-s.length-f;return Ys(t.substr(0,f)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=qS(r,a[1].length),r<0?"-"+Ka(e,t,-r):hc(Bz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Fi(0,3-m.length):"")+m})+"."+Fi(i,a[1].length);switch(t){case"###,##0.00":return Ka(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=hc(yd(l,0));return h!=="0"?u+h:"";case"###,###.00":return Ka(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ka(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Uz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return dl(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $z(e,t,r){var n=t.replace(eT,""),s=t.length-n.length;return dl(e,n,r*Math.pow(10,2*s))+dn("%",s)}function iT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function no(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?no("n",n,r):"("+no("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Uz(e,t,r);if(t.indexOf("%")!==-1)return $z(e,t,r);if(t.indexOf("E")!==-1)return iT(t,r);if(t.charCodeAt(0)===36)return"$"+no(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Fi(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Ys(t.substr(0,t.length-s.length))+s;if(a=t.match(rT))return Oz(a,l,u);if(t.match(/^#+0+$/))return u+Fi(l,t.length-t.indexOf("0"));if(a=t.match(nT))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Ys(a[1])).replace(/\.$/,"."+Ys(a[1])),s=s.replace(/\.(\d*)$/,function(m,g){return"."+g+dn("0",Ys(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+hc(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+no(e,t,-r):hc(""+r)+"."+dn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return no(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=sf(no(e,t.replace(/[\\-]/g,""),r)),i=0,sf(sf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(aT))return s=no(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=O1(l,Math.pow(10,i)-1,!1),s=""+u,d=dl("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=R1(o[2],i),d.length<a[4].length&&(d=Ys(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=O1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Wb(o[1],i)+a[2]+"/"+a[3]+R1(o[2],i):dn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Ys(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,p=t.length-s.length-f;return Ys(t.substr(0,f)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+no(e,t,-r):hc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Fi(0,3-m.length):"")+m})+"."+Fi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=hc(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return no(e,t.slice(0,t.lastIndexOf(".")),r)+Ys(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function dl(e,t,r){return(r|0)===r?no(e,t,r):Ka(e,t,r)}function zz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var oT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function qf(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":I1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(oT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Hz(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",u,d,f,p="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!I1(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var h=e.charAt(++i),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=fu(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=fu(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=fu(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",i+=5,p="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",i+=5,p="h"):(g.t="t",++i),u==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(oT)){if(u==null&&(u=fu(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",qf(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var y=0,x=0,w;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=p,l="h",y<1&&(y=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(x=Math.max(x,w[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[i].v.match(/[Hh]/)&&(y=1),y<2&&s[i].v.match(/[Mm]/)&&(y=2),y<3&&s[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Fz(s[i].t.charCodeAt(0),s[i].v,u,x),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;b+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=Uu(t,r);break}var A="",P,j;if(b.length>0){b.charCodeAt(0)==40?(P=t<0&&b.charCodeAt(0)===45?-t:t,j=dl("n",b,P)):(P=t<0&&n>1?-t:t,j=dl("n",b,P),P<0&&s[0]&&s[0].t=="t"&&(j=j.substr(1),s[0].v="-"+s[0].v)),N=j.length-1;var D=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){D=i;break}var E=s.length;if(D===s.length&&j.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=j.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=j.substr(0,N+1),N=-1),s[i].t="t",E=i);N>=0&&E<s.length&&(s[E].v=j.substr(0,N+1)+s[E].v)}else if(D!==s.length&&j.indexOf("E")===-1){for(N=j.indexOf(".")-1,i=D;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===D?s[i].v.indexOf(".")-1:s[i].v.length-1,A=s[i].v.substr(d+1);d>=0;--d)N>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(A=j.charAt(N--)+A);s[i].v=A,s[i].t="t",E=i}for(N>=0&&E<s.length&&(s[E].v=j.substr(0,N+1)+s[E].v),N=j.indexOf(".")+1,i=D;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==D)){for(d=s[i].v.indexOf(".")>-1&&i===D?s[i].v.indexOf(".")+1:0,A=s[i].v.substr(0,d);d<s[i].v.length;++d)N<j.length&&(A+=j.charAt(N++));s[i].v=A,s[i].t="t",E=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=dl(s[i].t,s[i].v,P),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var WS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function VS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function qz(e,t){var r=zz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(WS),o=r[1].match(WS);return VS(t,i)?[n,r[0]]:VS(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function oi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:er)[e],n==null&&(n=r.table&&r.table[zS[e]]||er[zS[e]]),n==null&&(n=Ez[e]||"General");break}if(I1(n,0))return Uu(t,r);t instanceof Date&&(t=ZC(t,r.date1904));var s=qz(n,t);if(I1(s[1]))return Uu(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Hz(s[1],t,r,s[0])}function ju(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(er[r]==null){t<0&&(t=r);continue}if(er[r]==e){t=r;break}}t<0&&(t=391)}return er[t]=e,t}function lT(){er=_z()}var Wz={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},cT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Vz(e){var t=typeof e=="number"?er[e]:e;return t=t.replace(cT,"(\\d+)"),new RegExp("^"+t+"$")}function Kz(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(cT)||[]).forEach(function(f,p){var h=parseInt(r[p+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":i=h;break;case"s":l=h;break;case"m":i>=0?o=h:s=h;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Gz=function(){var e={};e.version="1.2.0";function t(){for(var j=0,D=new Array(256),E=0;E!=256;++E)j=E,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,D[E]=j;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(j){var D=0,E=0,I=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)_[I]=j[I];for(I=0;I!=256;++I)for(E=j[I],D=256+I;D<4096;D+=256)E=_[D]=E>>>8^j[E&255];var L=[];for(I=1;I!=16;++I)L[I-1]=typeof Int32Array<"u"?_.subarray(I*256,I*256+256):_.slice(I*256,I*256+256);return L}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],d=s[5],f=s[6],p=s[7],h=s[8],m=s[9],g=s[10],y=s[11],x=s[12],w=s[13],b=s[14];function N(j,D){for(var E=D^-1,I=0,_=j.length;I<_;)E=E>>>8^r[(E^j.charCodeAt(I++))&255];return~E}function A(j,D){for(var E=D^-1,I=j.length-15,_=0;_<I;)E=b[j[_++]^E&255]^w[j[_++]^E>>8&255]^x[j[_++]^E>>16&255]^y[j[_++]^E>>>24]^g[j[_++]]^m[j[_++]]^h[j[_++]]^p[j[_++]]^f[j[_++]]^d[j[_++]]^u[j[_++]]^l[j[_++]]^o[j[_++]]^i[j[_++]]^a[j[_++]]^r[j[_++]];for(I+=15;_<I;)E=E>>>8^r[(E^j[_++])&255];return~E}function P(j,D){for(var E=D^-1,I=0,_=j.length,L=0,M=0;I<_;)L=j.charCodeAt(I++),L<128?E=E>>>8^r[(E^L)&255]:L<2048?(E=E>>>8^r[(E^(192|L>>6&31))&255],E=E>>>8^r[(E^(128|L&63))&255]):L>=55296&&L<57344?(L=(L&1023)+64,M=j.charCodeAt(I++)&1023,E=E>>>8^r[(E^(240|L>>8&7))&255],E=E>>>8^r[(E^(128|L>>2&63))&255],E=E>>>8^r[(E^(128|M>>6&15|(L&3)<<4))&255],E=E>>>8^r[(E^(128|M&63))&255]):(E=E>>>8^r[(E^(224|L>>12&15))&255],E=E>>>8^r[(E^(128|L>>6&63))&255],E=E>>>8^r[(E^(128|L&63))&255]);return~E}return e.table=r,e.bstr=N,e.buf=A,e.str=P,e}(),pr=function(){var t={};t.version="1.2.1";function r(W,te){for(var ee=W.split("/"),se=te.split("/"),oe=0,fe=0,_e=Math.min(ee.length,se.length);oe<_e;++oe){if(fe=ee[oe].length-se[oe].length)return fe;if(ee[oe]!=se[oe])return ee[oe]<se[oe]?-1:1}return ee.length-se.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var te=W.lastIndexOf("/");return te===-1?W:W.slice(0,te+1)}function s(W){if(W.charAt(W.length-1)=="/")return s(W.slice(0,-1));var te=W.lastIndexOf("/");return te===-1?W:W.slice(te+1)}function a(W,te){typeof te=="string"&&(te=new Date(te));var ee=te.getHours();ee=ee<<6|te.getMinutes(),ee=ee<<5|te.getSeconds()>>>1,W.write_shift(2,ee);var se=te.getFullYear()-1980;se=se<<4|te.getMonth()+1,se=se<<5|te.getDate(),W.write_shift(2,se)}function i(W){var te=W.read_shift(2)&65535,ee=W.read_shift(2)&65535,se=new Date,oe=ee&31;ee>>>=5;var fe=ee&15;ee>>>=4,se.setMilliseconds(0),se.setFullYear(ee+1980),se.setMonth(fe-1),se.setDate(oe);var _e=te&31;te>>>=5;var De=te&63;return te>>>=6,se.setHours(te),se.setMinutes(De),se.setSeconds(_e<<1),se}function o(W){hs(W,0);for(var te={},ee=0;W.l<=W.length-4;){var se=W.read_shift(2),oe=W.read_shift(2),fe=W.l+oe,_e={};switch(se){case 21589:ee=W.read_shift(1),ee&1&&(_e.mtime=W.read_shift(4)),oe>5&&(ee&2&&(_e.atime=W.read_shift(4)),ee&4&&(_e.ctime=W.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}W.l=fe,te[se]=_e}return te}var l;function u(){return l||(l={})}function d(W,te){if(W[0]==80&&W[1]==75)return Be(W,te);if((W[0]|32)==109&&(W[1]|32)==105)return Et(W,te);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var ee=3,se=512,oe=0,fe=0,_e=0,De=0,Ee=0,Ae=[],Te=W.slice(0,512);hs(Te,0);var Ze=f(Te);switch(ee=Ze[0],ee){case 3:se=512;break;case 4:se=4096;break;case 0:if(Ze[1]==0)return Be(W,te);default:throw new Error("Major Version: Expected 3 or 4 saw "+ee)}se!==512&&(Te=W.slice(0,se),hs(Te,28));var at=W.slice(0,se);p(Te,ee);var ht=Te.read_shift(4,"i");if(ee===3&&ht!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ht);Te.l+=4,_e=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),De=Te.read_shift(4,"i"),oe=Te.read_shift(4,"i"),Ee=Te.read_shift(4,"i"),fe=Te.read_shift(4,"i");for(var nt=-1,ut=0;ut<109&&(nt=Te.read_shift(4,"i"),!(nt<0));++ut)Ae[ut]=nt;var Bt=h(W,se);y(Ee,fe,Bt,se,Ae);var Cr=w(Bt,_e,Ae,se);Cr[_e].name="!Directory",oe>0&&De!==M&&(Cr[De].name="!MiniFAT"),Cr[Ae[0]].name="!FAT",Cr.fat_addrs=Ae,Cr.ssz=se;var or={},nn=[],Wi=[],ui=[];b(_e,Cr,Bt,nn,oe,or,Wi,De),m(Wi,ui,nn),nn.shift();var Vi={FileIndex:Wi,FullPaths:ui};return te&&te.raw&&(Vi.raw={header:at,sectors:Bt}),Vi}function f(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(K,"Header Signature: "),W.l+=16;var te=W.read_shift(2,"u");return[W.read_shift(2,"u"),te]}function p(W,te){var ee=9;switch(W.l+=2,ee=W.read_shift(2)){case 9:if(te!=3)throw new Error("Sector Shift: Expected 9 saw "+ee);break;case 12:if(te!=4)throw new Error("Sector Shift: Expected 12 saw "+ee);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ee)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function h(W,te){for(var ee=Math.ceil(W.length/te)-1,se=[],oe=1;oe<ee;++oe)se[oe-1]=W.slice(oe*te,(oe+1)*te);return se[ee-1]=W.slice(ee*te),se}function m(W,te,ee){for(var se=0,oe=0,fe=0,_e=0,De=0,Ee=ee.length,Ae=[],Te=[];se<Ee;++se)Ae[se]=Te[se]=se,te[se]=ee[se];for(;De<Te.length;++De)se=Te[De],oe=W[se].L,fe=W[se].R,_e=W[se].C,Ae[se]===se&&(oe!==-1&&Ae[oe]!==oe&&(Ae[se]=Ae[oe]),fe!==-1&&Ae[fe]!==fe&&(Ae[se]=Ae[fe])),_e!==-1&&(Ae[_e]=se),oe!==-1&&se!=Ae[se]&&(Ae[oe]=Ae[se],Te.lastIndexOf(oe)<De&&Te.push(oe)),fe!==-1&&se!=Ae[se]&&(Ae[fe]=Ae[se],Te.lastIndexOf(fe)<De&&Te.push(fe));for(se=1;se<Ee;++se)Ae[se]===se&&(fe!==-1&&Ae[fe]!==fe?Ae[se]=Ae[fe]:oe!==-1&&Ae[oe]!==oe&&(Ae[se]=Ae[oe]));for(se=1;se<Ee;++se)if(W[se].type!==0){if(De=se,De!=Ae[De])do De=Ae[De],te[se]=te[De]+"/"+te[se];while(De!==0&&Ae[De]!==-1&&De!=Ae[De]);Ae[se]=-1}for(te[0]+="/",se=1;se<Ee;++se)W[se].type!==2&&(te[se]+="/")}function g(W,te,ee){for(var se=W.start,oe=W.size,fe=[],_e=se;ee&&oe>0&&_e>=0;)fe.push(te.slice(_e*L,_e*L+L)),oe-=L,_e=au(ee,_e*4);return fe.length===0?Wn(0):tc(fe).slice(0,W.size)}function y(W,te,ee,se,oe){var fe=M;if(W===M){if(te!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var _e=ee[W],De=(se>>>2)-1;if(!_e)return;for(var Ee=0;Ee<De&&(fe=au(_e,Ee*4))!==M;++Ee)oe.push(fe);y(au(_e,se-4),te-1,ee,se,oe)}}function x(W,te,ee,se,oe){var fe=[],_e=[];oe||(oe=[]);var De=se-1,Ee=0,Ae=0;for(Ee=te;Ee>=0;){oe[Ee]=!0,fe[fe.length]=Ee,_e.push(W[Ee]);var Te=ee[Math.floor(Ee*4/se)];if(Ae=Ee*4&De,se<4+Ae)throw new Error("FAT boundary crossed: "+Ee+" 4 "+se);if(!W[Te])break;Ee=au(W[Te],Ae)}return{nodes:fe,data:rk([_e])}}function w(W,te,ee,se){var oe=W.length,fe=[],_e=[],De=[],Ee=[],Ae=se-1,Te=0,Ze=0,at=0,ht=0;for(Te=0;Te<oe;++Te)if(De=[],at=Te+te,at>=oe&&(at-=oe),!_e[at]){Ee=[];var nt=[];for(Ze=at;Ze>=0;){nt[Ze]=!0,_e[Ze]=!0,De[De.length]=Ze,Ee.push(W[Ze]);var ut=ee[Math.floor(Ze*4/se)];if(ht=Ze*4&Ae,se<4+ht)throw new Error("FAT boundary crossed: "+Ze+" 4 "+se);if(!W[ut]||(Ze=au(W[ut],ht),nt[Ze]))break}fe[at]={nodes:De,data:rk([Ee])}}return fe}function b(W,te,ee,se,oe,fe,_e,De){for(var Ee=0,Ae=se.length?2:0,Te=te[W].data,Ze=0,at=0,ht;Ze<Te.length;Ze+=128){var nt=Te.slice(Ze,Ze+128);hs(nt,64),at=nt.read_shift(2),ht=Jb(nt,0,at-Ae),se.push(ht);var ut={name:ht,type:nt.read_shift(1),color:nt.read_shift(1),L:nt.read_shift(4,"i"),R:nt.read_shift(4,"i"),C:nt.read_shift(4,"i"),clsid:nt.read_shift(16),state:nt.read_shift(4,"i"),start:0,size:0},Bt=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Bt!==0&&(ut.ct=N(nt,nt.l-8));var Cr=nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2)+nt.read_shift(2);Cr!==0&&(ut.mt=N(nt,nt.l-8)),ut.start=nt.read_shift(4,"i"),ut.size=nt.read_shift(4,"i"),ut.size<0&&ut.start<0&&(ut.size=ut.type=0,ut.start=M,ut.name=""),ut.type===5?(Ee=ut.start,oe>0&&Ee!==M&&(te[Ee].name="!StreamData")):ut.size>=4096?(ut.storage="fat",te[ut.start]===void 0&&(te[ut.start]=x(ee,ut.start,te.fat_addrs,te.ssz)),te[ut.start].name=ut.name,ut.content=te[ut.start].data.slice(0,ut.size)):(ut.storage="minifat",ut.size<0?ut.size=0:Ee!==M&&ut.start!==M&&te[Ee]&&(ut.content=g(ut,te[Ee].data,(te[De]||{}).data))),ut.content&&hs(ut.content,0),fe[ht]=ut,_e.push(ut)}}function N(W,te){return new Date((Ta(W,te+4)/1e7*Math.pow(2,32)+Ta(W,te)/1e7-11644473600)*1e3)}function A(W,te){return u(),d(l.readFileSync(W),te)}function P(W,te){var ee=te&&te.type;switch(ee||dr&&Buffer.isBuffer(W)&&(ee="buffer"),ee||"base64"){case"file":return A(W,te);case"base64":return d(Ti(Oa(W)),te);case"binary":return d(Ti(W),te)}return d(W,te)}function j(W,te){var ee=te||{},se=ee.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=se+"/",W.FileIndex[0]={name:se,type:5}),ee.CLSID&&(W.FileIndex[0].clsid=ee.CLSID),D(W)}function D(W){var te="Sh33tJ5";if(!pr.find(W,"/"+te)){var ee=Wn(4);ee[0]=55,ee[1]=ee[3]=50,ee[2]=54,W.FileIndex.push({name:te,type:2,content:ee,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+te),E(W)}}function E(W,te){j(W);for(var ee=!1,se=!1,oe=W.FullPaths.length-1;oe>=0;--oe){var fe=W.FileIndex[oe];switch(fe.type){case 0:se?ee=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:se=!0,isNaN(fe.R*fe.L*fe.C)&&(ee=!0),fe.R>-1&&fe.L>-1&&fe.R==fe.L&&(ee=!0);break;default:ee=!0;break}}if(!(!ee&&!te)){var _e=new Date(1987,1,19),De=0,Ee=Object.create?Object.create(null):{},Ae=[];for(oe=0;oe<W.FullPaths.length;++oe)Ee[W.FullPaths[oe]]=!0,W.FileIndex[oe].type!==0&&Ae.push([W.FullPaths[oe],W.FileIndex[oe]]);for(oe=0;oe<Ae.length;++oe){var Te=n(Ae[oe][0]);se=Ee[Te],se||(Ae.push([Te,{name:s(Te).replace("/",""),type:1,clsid:ae,ct:_e,mt:_e,content:null}]),Ee[Te]=!0)}for(Ae.sort(function(ht,nt){return r(ht[0],nt[0])}),W.FullPaths=[],W.FileIndex=[],oe=0;oe<Ae.length;++oe)W.FullPaths[oe]=Ae[oe][0],W.FileIndex[oe]=Ae[oe][1];for(oe=0;oe<Ae.length;++oe){var Ze=W.FileIndex[oe],at=W.FullPaths[oe];if(Ze.name=s(at).replace("/",""),Ze.L=Ze.R=Ze.C=-(Ze.color=1),Ze.size=Ze.content?Ze.content.length:0,Ze.start=0,Ze.clsid=Ze.clsid||ae,oe===0)Ze.C=Ae.length>1?1:-1,Ze.size=0,Ze.type=5;else if(at.slice(-1)=="/"){for(De=oe+1;De<Ae.length&&n(W.FullPaths[De])!=at;++De);for(Ze.C=De>=Ae.length?-1:De,De=oe+1;De<Ae.length&&n(W.FullPaths[De])!=n(at);++De);Ze.R=De>=Ae.length?-1:De,Ze.type=1}else n(W.FullPaths[oe+1]||"")==n(at)&&(Ze.R=oe+1),Ze.type=2}}}function I(W,te){var ee=te||{};if(ee.fileType=="mad")return sr(W,ee);switch(E(W),ee.fileType){case"zip":return ft(W,ee)}var se=function(ht){for(var nt=0,ut=0,Bt=0;Bt<ht.FileIndex.length;++Bt){var Cr=ht.FileIndex[Bt];if(Cr.content){var or=Cr.content.length;or>0&&(or<4096?nt+=or+63>>6:ut+=or+511>>9)}}for(var nn=ht.FullPaths.length+3>>2,Wi=nt+7>>3,ui=nt+127>>7,Vi=Wi+ut+nn+ui,Ua=Vi+127>>7,_l=Ua<=109?0:Math.ceil((Ua-109)/127);Vi+Ua+_l+127>>7>Ua;)_l=++Ua<=109?0:Math.ceil((Ua-109)/127);var En=[1,_l,Ua,ui,nn,ut,nt,0];return ht.FileIndex[0].size=nt<<6,En[7]=(ht.FileIndex[0].start=En[0]+En[1]+En[2]+En[3]+En[4]+En[5])+(En[6]+7>>3),En}(W),oe=Wn(se[7]<<9),fe=0,_e=0;{for(fe=0;fe<8;++fe)oe.write_shift(1,Z[fe]);for(fe=0;fe<8;++fe)oe.write_shift(2,0);for(oe.write_shift(2,62),oe.write_shift(2,3),oe.write_shift(2,65534),oe.write_shift(2,9),oe.write_shift(2,6),fe=0;fe<3;++fe)oe.write_shift(2,0);for(oe.write_shift(4,0),oe.write_shift(4,se[2]),oe.write_shift(4,se[0]+se[1]+se[2]+se[3]-1),oe.write_shift(4,0),oe.write_shift(4,4096),oe.write_shift(4,se[3]?se[0]+se[1]+se[2]-1:M),oe.write_shift(4,se[3]),oe.write_shift(-4,se[1]?se[0]-1:M),oe.write_shift(4,se[1]),fe=0;fe<109;++fe)oe.write_shift(-4,fe<se[2]?se[1]+fe:-1)}if(se[1])for(_e=0;_e<se[1];++_e){for(;fe<236+_e*127;++fe)oe.write_shift(-4,fe<se[2]?se[1]+fe:-1);oe.write_shift(-4,_e===se[1]-1?M:_e+1)}var De=function(ht){for(_e+=ht;fe<_e-1;++fe)oe.write_shift(-4,fe+1);ht&&(++fe,oe.write_shift(-4,M))};for(_e=fe=0,_e+=se[1];fe<_e;++fe)oe.write_shift(-4,he.DIFSECT);for(_e+=se[2];fe<_e;++fe)oe.write_shift(-4,he.FATSECT);De(se[3]),De(se[4]);for(var Ee=0,Ae=0,Te=W.FileIndex[0];Ee<W.FileIndex.length;++Ee)Te=W.FileIndex[Ee],Te.content&&(Ae=Te.content.length,!(Ae<4096)&&(Te.start=_e,De(Ae+511>>9)));for(De(se[6]+7>>3);oe.l&511;)oe.write_shift(-4,he.ENDOFCHAIN);for(_e=fe=0,Ee=0;Ee<W.FileIndex.length;++Ee)Te=W.FileIndex[Ee],Te.content&&(Ae=Te.content.length,!(!Ae||Ae>=4096)&&(Te.start=_e,De(Ae+63>>6)));for(;oe.l&511;)oe.write_shift(-4,he.ENDOFCHAIN);for(fe=0;fe<se[4]<<2;++fe){var Ze=W.FullPaths[fe];if(!Ze||Ze.length===0){for(Ee=0;Ee<17;++Ee)oe.write_shift(4,0);for(Ee=0;Ee<3;++Ee)oe.write_shift(4,-1);for(Ee=0;Ee<12;++Ee)oe.write_shift(4,0);continue}Te=W.FileIndex[fe],fe===0&&(Te.start=Te.size?Te.start-1:M);var at=fe===0&&ee.root||Te.name;if(Ae=2*(at.length+1),oe.write_shift(64,at,"utf16le"),oe.write_shift(2,Ae),oe.write_shift(1,Te.type),oe.write_shift(1,Te.color),oe.write_shift(-4,Te.L),oe.write_shift(-4,Te.R),oe.write_shift(-4,Te.C),Te.clsid)oe.write_shift(16,Te.clsid,"hex");else for(Ee=0;Ee<4;++Ee)oe.write_shift(4,0);oe.write_shift(4,Te.state||0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(4,Te.start),oe.write_shift(4,Te.size),oe.write_shift(4,0)}for(fe=1;fe<W.FileIndex.length;++fe)if(Te=W.FileIndex[fe],Te.size>=4096)if(oe.l=Te.start+1<<9,dr&&Buffer.isBuffer(Te.content))Te.content.copy(oe,oe.l,0,Te.size),oe.l+=Te.size+511&-512;else{for(Ee=0;Ee<Te.size;++Ee)oe.write_shift(1,Te.content[Ee]);for(;Ee&511;++Ee)oe.write_shift(1,0)}for(fe=1;fe<W.FileIndex.length;++fe)if(Te=W.FileIndex[fe],Te.size>0&&Te.size<4096)if(dr&&Buffer.isBuffer(Te.content))Te.content.copy(oe,oe.l,0,Te.size),oe.l+=Te.size+63&-64;else{for(Ee=0;Ee<Te.size;++Ee)oe.write_shift(1,Te.content[Ee]);for(;Ee&63;++Ee)oe.write_shift(1,0)}if(dr)oe.l=oe.length;else for(;oe.l<oe.length;)oe.write_shift(1,0);return oe}function _(W,te){var ee=W.FullPaths.map(function(Ee){return Ee.toUpperCase()}),se=ee.map(function(Ee){var Ae=Ee.split("/");return Ae[Ae.length-(Ee.slice(-1)=="/"?2:1)]}),oe=!1;te.charCodeAt(0)===47?(oe=!0,te=ee[0].slice(0,-1)+te):oe=te.indexOf("/")!==-1;var fe=te.toUpperCase(),_e=oe===!0?ee.indexOf(fe):se.indexOf(fe);if(_e!==-1)return W.FileIndex[_e];var De=!fe.match(Wh);for(fe=fe.replace(ta,""),De&&(fe=fe.replace(Wh,"!")),_e=0;_e<ee.length;++_e)if((De?ee[_e].replace(Wh,"!"):ee[_e]).replace(ta,"")==fe||(De?se[_e].replace(Wh,"!"):se[_e]).replace(ta,"")==fe)return W.FileIndex[_e];return null}var L=64,M=-2,K="d0cf11e0a1b11ae1",Z=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",he={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(W,te,ee){u();var se=I(W,ee);l.writeFileSync(te,se)}function U(W){for(var te=new Array(W.length),ee=0;ee<W.length;++ee)te[ee]=String.fromCharCode(W[ee]);return te.join("")}function ue(W,te){var ee=I(W,te);switch(te&&te.type||"buffer"){case"file":return u(),l.writeFileSync(te.filename,ee),ee;case"binary":return typeof ee=="string"?ee:U(ee);case"base64":return MS(typeof ee=="string"?ee:U(ee));case"buffer":if(dr)return Buffer.isBuffer(ee)?ee:Xu(ee);case"array":return typeof ee=="string"?Ti(ee):ee}return ee}var pe;function C(W){try{var te=W.InflateRaw,ee=new te;if(ee._processChunk(new Uint8Array([3,0]),ee._finishFlushFlag),ee.bytesRead)pe=W;else throw new Error("zlib does not expose bytesRead")}catch(se){console.error("cannot use native zlib: "+(se.message||se))}}function R(W,te){if(!pe)return Ge(W,te);var ee=pe.InflateRaw,se=new ee,oe=se._processChunk(W.slice(W.l),se._finishFlushFlag);return W.l+=se.bytesRead,oe}function B(W){return pe?pe.deflateRawSync(W):it(W)}var O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(W){var te=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(te>>16|te>>8|te)&255}for(var ge=typeof Uint8Array<"u",xe=ge?new Uint8Array(256):[],Le=0;Le<256;++Le)xe[Le]=me(Le);function z(W,te){var ee=xe[W&255];return te<=8?ee>>>8-te:(ee=ee<<8|xe[W>>8&255],te<=16?ee>>>16-te:(ee=ee<<8|xe[W>>16&255],ee>>>24-te))}function Re(W,te){var ee=te&7,se=te>>>3;return(W[se]|(ee<=6?0:W[se+1]<<8))>>>ee&3}function Fe(W,te){var ee=te&7,se=te>>>3;return(W[se]|(ee<=5?0:W[se+1]<<8))>>>ee&7}function X(W,te){var ee=te&7,se=te>>>3;return(W[se]|(ee<=4?0:W[se+1]<<8))>>>ee&15}function Oe(W,te){var ee=te&7,se=te>>>3;return(W[se]|(ee<=3?0:W[se+1]<<8))>>>ee&31}function Me(W,te){var ee=te&7,se=te>>>3;return(W[se]|(ee<=1?0:W[se+1]<<8))>>>ee&127}function st(W,te,ee){var se=te&7,oe=te>>>3,fe=(1<<ee)-1,_e=W[oe]>>>se;return ee<8-se||(_e|=W[oe+1]<<8-se,ee<16-se)||(_e|=W[oe+2]<<16-se,ee<24-se)||(_e|=W[oe+3]<<24-se),_e&fe}function Ue(W,te,ee){var se=te&7,oe=te>>>3;return se<=5?W[oe]|=(ee&7)<<se:(W[oe]|=ee<<se&255,W[oe+1]=(ee&7)>>8-se),te+3}function xt(W,te,ee){var se=te&7,oe=te>>>3;return ee=(ee&1)<<se,W[oe]|=ee,te+1}function tt(W,te,ee){var se=te&7,oe=te>>>3;return ee<<=se,W[oe]|=ee&255,ee>>>=8,W[oe+1]=ee,te+8}function gt(W,te,ee){var se=te&7,oe=te>>>3;return ee<<=se,W[oe]|=ee&255,ee>>>=8,W[oe+1]=ee&255,W[oe+2]=ee>>>8,te+16}function ct(W,te){var ee=W.length,se=2*ee>te?2*ee:te+5,oe=0;if(ee>=te)return W;if(dr){var fe=BS(se);if(W.copy)W.copy(fe);else for(;oe<W.length;++oe)fe[oe]=W[oe];return fe}else if(ge){var _e=new Uint8Array(se);if(_e.set)_e.set(W);else for(;oe<ee;++oe)_e[oe]=W[oe];return _e}return W.length=se,W}function Mt(W){for(var te=new Array(W),ee=0;ee<W;++ee)te[ee]=0;return te}function It(W,te,ee){var se=1,oe=0,fe=0,_e=0,De=0,Ee=W.length,Ae=ge?new Uint16Array(32):Mt(32);for(fe=0;fe<32;++fe)Ae[fe]=0;for(fe=Ee;fe<ee;++fe)W[fe]=0;Ee=W.length;var Te=ge?new Uint16Array(Ee):Mt(Ee);for(fe=0;fe<Ee;++fe)Ae[oe=W[fe]]++,se<oe&&(se=oe),Te[fe]=0;for(Ae[0]=0,fe=1;fe<=se;++fe)Ae[fe+16]=De=De+Ae[fe-1]<<1;for(fe=0;fe<Ee;++fe)De=W[fe],De!=0&&(Te[fe]=Ae[De+16]++);var Ze=0;for(fe=0;fe<Ee;++fe)if(Ze=W[fe],Ze!=0)for(De=z(Te[fe],se)>>se-Ze,_e=(1<<se+4-Ze)-1;_e>=0;--_e)te[De|_e<<Ze]=Ze&15|fe<<4;return se}var Pt=ge?new Uint16Array(512):Mt(512),Jt=ge?new Uint16Array(32):Mt(32);if(!ge){for(var Lt=0;Lt<512;++Lt)Pt[Lt]=0;for(Lt=0;Lt<32;++Lt)Jt[Lt]=0}(function(){for(var W=[],te=0;te<32;te++)W.push(5);It(W,Jt,32);var ee=[];for(te=0;te<=143;te++)ee.push(8);for(;te<=255;te++)ee.push(9);for(;te<=279;te++)ee.push(7);for(;te<=287;te++)ee.push(8);It(ee,Pt,288)})();var pt=function(){for(var te=ge?new Uint8Array(32768):[],ee=0,se=0;ee<ie.length-1;++ee)for(;se<ie[ee+1];++se)te[se]=ee;for(;se<32768;++se)te[se]=29;var oe=ge?new Uint8Array(259):[];for(ee=0,se=0;ee<Y.length-1;++ee)for(;se<Y[ee+1];++se)oe[se]=ee;function fe(De,Ee){for(var Ae=0;Ae<De.length;){var Te=Math.min(65535,De.length-Ae),Ze=Ae+Te==De.length;for(Ee.write_shift(1,+Ze),Ee.write_shift(2,Te),Ee.write_shift(2,~Te&65535);Te-- >0;)Ee[Ee.l++]=De[Ae++]}return Ee.l}function _e(De,Ee){for(var Ae=0,Te=0,Ze=ge?new Uint16Array(32768):[];Te<De.length;){var at=Math.min(65535,De.length-Te);if(at<10){for(Ae=Ue(Ee,Ae,+(Te+at==De.length)),Ae&7&&(Ae+=8-(Ae&7)),Ee.l=Ae/8|0,Ee.write_shift(2,at),Ee.write_shift(2,~at&65535);at-- >0;)Ee[Ee.l++]=De[Te++];Ae=Ee.l*8;continue}Ae=Ue(Ee,Ae,+(Te+at==De.length)+2);for(var ht=0;at-- >0;){var nt=De[Te];ht=(ht<<5^nt)&32767;var ut=-1,Bt=0;if((ut=Ze[ht])&&(ut|=Te&-32768,ut>Te&&(ut-=32768),ut<Te))for(;De[ut+Bt]==De[Te+Bt]&&Bt<250;)++Bt;if(Bt>2){nt=oe[Bt],nt<=22?Ae=tt(Ee,Ae,xe[nt+1]>>1)-1:(tt(Ee,Ae,3),Ae+=5,tt(Ee,Ae,xe[nt-23]>>5),Ae+=3);var Cr=nt<8?0:nt-4>>2;Cr>0&&(gt(Ee,Ae,Bt-Y[nt]),Ae+=Cr),nt=te[Te-ut],Ae=tt(Ee,Ae,xe[nt]>>3),Ae-=3;var or=nt<4?0:nt-2>>1;or>0&&(gt(Ee,Ae,Te-ut-ie[nt]),Ae+=or);for(var nn=0;nn<Bt;++nn)Ze[ht]=Te&32767,ht=(ht<<5^De[Te])&32767,++Te;at-=Bt-1}else nt<=143?nt=nt+48:Ae=xt(Ee,Ae,1),Ae=tt(Ee,Ae,xe[nt]),Ze[ht]=Te&32767,++Te}Ae=tt(Ee,Ae,0)-1}return Ee.l=(Ae+7)/8|0,Ee.l}return function(Ee,Ae){return Ee.length<8?fe(Ee,Ae):_e(Ee,Ae)}}();function it(W){var te=Wn(50+Math.floor(W.length*1.1)),ee=pt(W,te);return te.slice(0,ee)}var ot=ge?new Uint16Array(32768):Mt(32768),ir=ge?new Uint16Array(32768):Mt(32768),Ft=ge?new Uint16Array(128):Mt(128),Ot=1,qt=1;function Ne(W,te){var ee=Oe(W,te)+257;te+=5;var se=Oe(W,te)+1;te+=5;var oe=X(W,te)+4;te+=4;for(var fe=0,_e=ge?new Uint8Array(19):Mt(19),De=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ee=1,Ae=ge?new Uint8Array(8):Mt(8),Te=ge?new Uint8Array(8):Mt(8),Ze=_e.length,at=0;at<oe;++at)_e[O[at]]=fe=Fe(W,te),Ee<fe&&(Ee=fe),Ae[fe]++,te+=3;var ht=0;for(Ae[0]=0,at=1;at<=Ee;++at)Te[at]=ht=ht+Ae[at-1]<<1;for(at=0;at<Ze;++at)(ht=_e[at])!=0&&(De[at]=Te[ht]++);var nt=0;for(at=0;at<Ze;++at)if(nt=_e[at],nt!=0){ht=xe[De[at]]>>8-nt;for(var ut=(1<<7-nt)-1;ut>=0;--ut)Ft[ht|ut<<nt]=nt&7|at<<3}var Bt=[];for(Ee=1;Bt.length<ee+se;)switch(ht=Ft[Me(W,te)],te+=ht&7,ht>>>=3){case 16:for(fe=3+Re(W,te),te+=2,ht=Bt[Bt.length-1];fe-- >0;)Bt.push(ht);break;case 17:for(fe=3+Fe(W,te),te+=3;fe-- >0;)Bt.push(0);break;case 18:for(fe=11+Me(W,te),te+=7;fe-- >0;)Bt.push(0);break;default:Bt.push(ht),Ee<ht&&(Ee=ht);break}var Cr=Bt.slice(0,ee),or=Bt.slice(ee);for(at=ee;at<286;++at)Cr[at]=0;for(at=se;at<30;++at)or[at]=0;return Ot=It(Cr,ot,286),qt=It(or,ir,30),te}function Ie(W,te){if(W[0]==3&&!(W[1]&3))return[Lc(te),2];for(var ee=0,se=0,oe=BS(te||1<<18),fe=0,_e=oe.length>>>0,De=0,Ee=0;!(se&1);){if(se=Fe(W,ee),ee+=3,se>>>1)se>>1==1?(De=9,Ee=5):(ee=Ne(W,ee),De=Ot,Ee=qt);else{ee&7&&(ee+=8-(ee&7));var Ae=W[ee>>>3]|W[(ee>>>3)+1]<<8;if(ee+=32,Ae>0)for(!te&&_e<fe+Ae&&(oe=ct(oe,fe+Ae),_e=oe.length);Ae-- >0;)oe[fe++]=W[ee>>>3],ee+=8;continue}for(;;){!te&&_e<fe+32767&&(oe=ct(oe,fe+32767),_e=oe.length);var Te=st(W,ee,De),Ze=se>>>1==1?Pt[Te]:ot[Te];if(ee+=Ze&15,Ze>>>=4,!(Ze>>>8&255))oe[fe++]=Ze;else{if(Ze==256)break;Ze-=257;var at=Ze<8?0:Ze-4>>2;at>5&&(at=0);var ht=fe+Y[Ze];at>0&&(ht+=st(W,ee,at),ee+=at),Te=st(W,ee,Ee),Ze=se>>>1==1?Jt[Te]:ir[Te],ee+=Ze&15,Ze>>>=4;var nt=Ze<4?0:Ze-2>>1,ut=ie[Ze];for(nt>0&&(ut+=st(W,ee,nt),ee+=nt),!te&&_e<ht&&(oe=ct(oe,ht+100),_e=oe.length);fe<ht;)oe[fe]=oe[fe-ut],++fe}}}return te?[oe,ee+7>>>3]:[oe.slice(0,fe),ee+7>>>3]}function Ge(W,te){var ee=W.slice(W.l||0),se=Ie(ee,te);return W.l+=se[1],se[0]}function He(W,te){if(W)typeof console<"u"&&console.error(te);else throw new Error(te)}function Be(W,te){var ee=W;hs(ee,0);var se=[],oe=[],fe={FileIndex:se,FullPaths:oe};j(fe,{root:te.root});for(var _e=ee.length-4;(ee[_e]!=80||ee[_e+1]!=75||ee[_e+2]!=5||ee[_e+3]!=6)&&_e>=0;)--_e;ee.l=_e+4,ee.l+=4;var De=ee.read_shift(2);ee.l+=6;var Ee=ee.read_shift(4);for(ee.l=Ee,_e=0;_e<De;++_e){ee.l+=20;var Ae=ee.read_shift(4),Te=ee.read_shift(4),Ze=ee.read_shift(2),at=ee.read_shift(2),ht=ee.read_shift(2);ee.l+=8;var nt=ee.read_shift(4),ut=o(ee.slice(ee.l+Ze,ee.l+Ze+at));ee.l+=Ze+at+ht;var Bt=ee.l;ee.l=nt+4,$e(ee,Ae,Te,fe,ut),ee.l=Bt}return fe}function $e(W,te,ee,se,oe){W.l+=2;var fe=W.read_shift(2),_e=W.read_shift(2),De=i(W);if(fe&8257)throw new Error("Unsupported ZIP encryption");for(var Ee=W.read_shift(4),Ae=W.read_shift(4),Te=W.read_shift(4),Ze=W.read_shift(2),at=W.read_shift(2),ht="",nt=0;nt<Ze;++nt)ht+=String.fromCharCode(W[W.l++]);if(at){var ut=o(W.slice(W.l,W.l+at));(ut[21589]||{}).mt&&(De=ut[21589].mt),((oe||{})[21589]||{}).mt&&(De=oe[21589].mt)}W.l+=at;var Bt=W.slice(W.l,W.l+Ae);switch(_e){case 8:Bt=R(W,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var Cr=!1;fe&8&&(Ee=W.read_shift(4),Ee==134695760&&(Ee=W.read_shift(4),Cr=!0),Ae=W.read_shift(4),Te=W.read_shift(4)),Ae!=te&&He(Cr,"Bad compressed size: "+te+" != "+Ae),Te!=ee&&He(Cr,"Bad uncompressed size: "+ee+" != "+Te),pn(se,ht,Bt,{unsafe:!0,mt:De})}function ft(W,te){var ee=te||{},se=[],oe=[],fe=Wn(1),_e=ee.compression?8:0,De=0,Ee=0,Ae=0,Te=0,Ze=0,at=W.FullPaths[0],ht=at,nt=W.FileIndex[0],ut=[],Bt=0;for(Ee=1;Ee<W.FullPaths.length;++Ee)if(ht=W.FullPaths[Ee].slice(at.length),nt=W.FileIndex[Ee],!(!nt.size||!nt.content||ht=="Sh33tJ5")){var Cr=Te,or=Wn(ht.length);for(Ae=0;Ae<ht.length;++Ae)or.write_shift(1,ht.charCodeAt(Ae)&127);or=or.slice(0,or.l),ut[Ze]=Gz.buf(nt.content,0);var nn=nt.content;_e==8&&(nn=B(nn)),fe=Wn(30),fe.write_shift(4,67324752),fe.write_shift(2,20),fe.write_shift(2,De),fe.write_shift(2,_e),nt.mt?a(fe,nt.mt):fe.write_shift(4,0),fe.write_shift(-4,ut[Ze]),fe.write_shift(4,nn.length),fe.write_shift(4,nt.content.length),fe.write_shift(2,or.length),fe.write_shift(2,0),Te+=fe.length,se.push(fe),Te+=or.length,se.push(or),Te+=nn.length,se.push(nn),fe=Wn(46),fe.write_shift(4,33639248),fe.write_shift(2,0),fe.write_shift(2,20),fe.write_shift(2,De),fe.write_shift(2,_e),fe.write_shift(4,0),fe.write_shift(-4,ut[Ze]),fe.write_shift(4,nn.length),fe.write_shift(4,nt.content.length),fe.write_shift(2,or.length),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(4,0),fe.write_shift(4,Cr),Bt+=fe.l,oe.push(fe),Bt+=or.length,oe.push(or),++Ze}return fe=Wn(22),fe.write_shift(4,101010256),fe.write_shift(2,0),fe.write_shift(2,0),fe.write_shift(2,Ze),fe.write_shift(2,Ze),fe.write_shift(4,Bt),fe.write_shift(4,Te),fe.write_shift(2,0),tc([tc(se),tc(oe),fe])}var Ye={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qe(W,te){if(W.ctype)return W.ctype;var ee=W.name||"",se=ee.match(/\.([^\.]+)$/);return se&&Ye[se[1]]||te&&(se=(ee=te).match(/[\.\\]([^\.\\])+$/),se&&Ye[se[1]])?Ye[se[1]]:"application/octet-stream"}function zt(W){for(var te=MS(W),ee=[],se=0;se<te.length;se+=76)ee.push(te.slice(se,se+76));return ee.join(`\r
`)+`\r
`}function Dt(W){var te=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var Te=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});te=te.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),te.charAt(0)==`
`&&(te="=0D"+te.slice(1)),te=te.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ee=[],se=te.split(`\r
`),oe=0;oe<se.length;++oe){var fe=se[oe];if(fe.length==0){ee.push("");continue}for(var _e=0;_e<fe.length;){var De=76,Ee=fe.slice(_e,_e+De);Ee.charAt(De-1)=="="?De--:Ee.charAt(De-2)=="="?De-=2:Ee.charAt(De-3)=="="&&(De-=3),Ee=fe.slice(_e,_e+De),_e+=De,_e<fe.length&&(Ee+="="),ee.push(Ee)}}return ee.join(`\r
`)}function _n(W){for(var te=[],ee=0;ee<W.length;++ee){for(var se=W[ee];ee<=W.length&&se.charAt(se.length-1)=="=";)se=se.slice(0,se.length-1)+W[++ee];te.push(se)}for(var oe=0;oe<te.length;++oe)te[oe]=te[oe].replace(/[=][0-9A-Fa-f]{2}/g,function(fe){return String.fromCharCode(parseInt(fe.slice(1),16))});return Ti(te.join(`\r
`))}function wr(W,te,ee){for(var se="",oe="",fe="",_e,De=0;De<10;++De){var Ee=te[De];if(!Ee||Ee.match(/^\s*$/))break;var Ae=Ee.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":se=Ae[2].trim();break;case"content-type":fe=Ae[2].trim();break;case"content-transfer-encoding":oe=Ae[2].trim();break}}switch(++De,oe.toLowerCase()){case"base64":_e=Ti(Oa(te.slice(De).join("")));break;case"quoted-printable":_e=_n(te.slice(De));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+oe)}var Te=pn(W,se.slice(ee.length),_e,{unsafe:!0});fe&&(Te.ctype=fe)}function Et(W,te){if(U(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ee=te&&te.root||"",se=(dr&&Buffer.isBuffer(W)?W.toString("binary"):U(W)).split(`\r
`),oe=0,fe="";for(oe=0;oe<se.length;++oe)if(fe=se[oe],!!/^Content-Location:/i.test(fe)&&(fe=fe.slice(fe.indexOf("file")),ee||(ee=fe.slice(0,fe.lastIndexOf("/")+1)),fe.slice(0,ee.length)!=ee))for(;ee.length>0&&(ee=ee.slice(0,ee.length-1),ee=ee.slice(0,ee.lastIndexOf("/")+1),fe.slice(0,ee.length)!=ee););var _e=(se[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var De="--"+(_e[1]||""),Ee=[],Ae=[],Te={FileIndex:Ee,FullPaths:Ae};j(Te);var Ze,at=0;for(oe=0;oe<se.length;++oe){var ht=se[oe];ht!==De&&ht!==De+"--"||(at++&&wr(Te,se.slice(Ze,oe),ee),Ze=oe)}return Te}function sr(W,te){var ee=te||{},se=ee.boundary||"SheetJS";se="------="+se;for(var oe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+se.slice(2)+'"',"","",""],fe=W.FullPaths[0],_e=fe,De=W.FileIndex[0],Ee=1;Ee<W.FullPaths.length;++Ee)if(_e=W.FullPaths[Ee].slice(fe.length),De=W.FileIndex[Ee],!(!De.size||!De.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Bt){return"_x"+Bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Bt){return"_u"+Bt.charCodeAt(0).toString(16)+"_"});for(var Ae=De.content,Te=dr&&Buffer.isBuffer(Ae)?Ae.toString("binary"):U(Ae),Ze=0,at=Math.min(1024,Te.length),ht=0,nt=0;nt<=at;++nt)(ht=Te.charCodeAt(nt))>=32&&ht<128&&++Ze;var ut=Ze>=at*4/5;oe.push(se),oe.push("Content-Location: "+(ee.root||"file:///C:/SheetJS/")+_e),oe.push("Content-Transfer-Encoding: "+(ut?"quoted-printable":"base64")),oe.push("Content-Type: "+Qe(De,_e)),oe.push(""),oe.push(ut?Dt(Te):zt(Te))}return oe.push(se+`--\r
`),oe.join(`\r
`)}function va(W){var te={};return j(te,W),te}function pn(W,te,ee,se){var oe=se&&se.unsafe;oe||j(W);var fe=!oe&&pr.find(W,te);if(!fe){var _e=W.FullPaths[0];te.slice(0,_e.length)==_e?_e=te:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+te).replace("//","/")),fe={name:s(te),type:2},W.FileIndex.push(fe),W.FullPaths.push(_e),oe||pr.utils.cfb_gc(W)}return fe.content=ee,fe.size=ee?ee.length:0,se&&(se.CLSID&&(fe.clsid=se.CLSID),se.mt&&(fe.mt=se.mt),se.ct&&(fe.ct=se.ct)),fe}function Pr(W,te){j(W);var ee=pr.find(W,te);if(ee){for(var se=0;se<W.FileIndex.length;++se)if(W.FileIndex[se]==ee)return W.FileIndex.splice(se,1),W.FullPaths.splice(se,1),!0}return!1}function fr(W,te,ee){j(W);var se=pr.find(W,te);if(se){for(var oe=0;oe<W.FileIndex.length;++oe)if(W.FileIndex[oe]==se)return W.FileIndex[oe].name=s(ee),W.FullPaths[oe]=ee,!0}return!1}function br(W){E(W,!0)}return t.find=_,t.read=P,t.parse=d,t.write=ue,t.writeFile=re,t.utils={cfb_new:va,cfb_add:pn,cfb_del:Pr,cfb_mov:fr,cfb_gc:br,ReadShift:u0,CheckField:PT,prep_blob:hs,bconcat:tc,use_zlib:C,_deflateRaw:it,_inflateRaw:Ge,consts:he},t}();function Yz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ko(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Kb(e){for(var t=[],r=ko(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var M1=new Date(1899,11,30,0,0,0);function sa(e,t){var r=e.getTime(),n=M1.getTime()+(e.getTimezoneOffset()-M1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var uT=new Date,Xz=M1.getTime()+(uT.getTimezoneOffset()-M1.getTimezoneOffset())*6e4,KS=uT.getTimezoneOffset();function Ox(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Xz),t.getTimezoneOffset()!==KS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-KS)*6e4),t}function Jz(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var GS=new Date("2017-02-19T19:06:09.000Z"),dT=isNaN(GS.getFullYear())?new Date("2/19/17"):GS,Qz=dT.getFullYear()==2017;function ss(e,t){var r=new Date(e);if(Qz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(dT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function $u(e,t){if(dr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Kh(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Kh(JC(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Kh(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Kh(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function vs(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=vs(e[r]));return t}function dn(e,t){for(var r="";r.length<t;)r+=e;return r}function Oi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Zz=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Zz.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var eH=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function fT(e){return e?e.content&&e.type?$u(e.content,!0):e.data?qh(e.data):e.asNodeBuffer&&dr?qh(e.asNodeBuffer().toString("binary")):e.asBinary?qh(e.asBinary()):e._data&&e._data.getContent?qh($u(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function hT(e){if(!e)return null;if(e.data)return IS(e.data);if(e.asNodeBuffer&&dr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?IS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function tH(e){return e&&e.name.slice(-4)===".bin"?hT(e):fT(e)}function Ya(e,t){for(var r=e.FullPaths||ko(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Gb(e,t){var r=Ya(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Pn(e,t,r){if(!r)return tH(Gb(e,t));if(!t)return null;try{return Pn(e,t)}catch{return null}}function Pa(e,t,r){if(!r)return fT(Gb(e,t));if(!t)return null;try{return Pa(e,t)}catch{return null}}function rH(e,t,r){return hT(Gb(e,t))}function YS(e){for(var t=e.FullPaths||ko(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function nH(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return dr?n=Xu(r):n=Nz(r),pr.utils.cfb_add(e,t,n)}pr.utils.cfb_add(e,t,r)}else e.file(t,r)}function pT(e,t){switch(t.type){case"base64":return pr.read(e,{type:"base64"});case"binary":return pr.read(e,{type:"binary"});case"buffer":case"array":return pr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Vh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var mT=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,sH=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,XS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,aH=/<[^>]*>/g,zs=mT.match(XS)?XS:aH,iH=/<\w*:/,oH=/<(\/?)\w+:/;function $t(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(sH),o=0,l="",u=0,d="",f="",p=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(p=(s=f.charCodeAt(a+1))==34||s==39?1:0,l=f.slice(a+1+p,f.length-p),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var h=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[h]&&d.slice(o-3,o)=="ext")continue;n[h]=l,n[h.toLowerCase()]=l}}return n}function Eo(e){return e.replace(oH,"<$1")}var gT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lH=Kb(gT),yr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return gT[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),cH=/[&<>'"]/g,uH=/[\u0000-\u001f]/g;function Yb(e){var t=e+"";return t.replace(cH,function(r){return lH[r]}).replace(/\n/g,"<br/>").replace(uH,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var JS=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Jr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function gv(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function QS(e){var t=Lc(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function ZS(e){return Xu(e,"binary").toString("utf8")}var Gm="foo bar baz",zr=dr&&(ZS(Gm)==gv(Gm)&&ZS||QS(Gm)==gv(Gm)&&QS)||gv,Kh=dr?function(e){return Xu(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ap=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),xT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),dH=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),fH=/<\/?(?:vt:)?variant>/g,hH=/<(?:vt:)([^>]*)>([\s\S]*)</;function ek(e,t){var r=$t(e),n=e.match(dH(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(fH,"").match(hH);i&&s.push({v:zr(i[2]),t:i[1]})}),s}var pH=/(^\s|\s$|\n)/;function mH(e){return ko(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function gH(e,t,r){return"<"+e+(r!=null?mH(r):"")+(t!=null?(t.match(pH)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xb(e){if(dr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return zr(Ju(qb(e)));throw new Error("Bad input format: expected Buffer or string")}var ip=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,xH={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},vH=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function yH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function wH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var tk=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},rk=dr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Xu(t)})):tk(e)}:tk,nk=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(al(e,s)));return n.join("").replace(ta,"")},Jb=dr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ta,""):nk(e,t,r)}:nk,sk=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},vT=dr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):sk(e,t,r)}:sk,ak=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Td(e,s)));return n.join("")},Pp=dr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ak(t,r,n)}:ak,yT=function(e,t){var r=Ta(e,t);return r>0?Pp(e,t+4,t+4+r-1):""},wT=yT,bT=function(e,t){var r=Ta(e,t);return r>0?Pp(e,t+4,t+4+r-1):""},NT=bT,ST=function(e,t){var r=2*Ta(e,t);return r>0?Pp(e,t+4,t+4+r-1):""},kT=ST,_T=function(t,r){var n=Ta(t,r);return n>0?Jb(t,r+4,r+4+n):""},ET=_T,AT=function(e,t){var r=Ta(e,t);return r>0?Pp(e,t+4,t+4+r):""},jT=AT,CT=function(e,t){return yH(e,t)},B1=CT,TT=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};dr&&(wT=function(t,r){if(!Buffer.isBuffer(t))return yT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},NT=function(t,r){if(!Buffer.isBuffer(t))return bT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},kT=function(t,r){if(!Buffer.isBuffer(t))return ST(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},ET=function(t,r){if(!Buffer.isBuffer(t))return _T(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},jT=function(t,r){if(!Buffer.isBuffer(t))return AT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},B1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):CT(t,r)},TT=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Td=function(e,t){return e[t]},al=function(e,t){return e[t+1]*256+e[t]},bH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ta=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},au=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},NH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function u0(e,t){var r="",n,s,a=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,dr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(al(this,u)),u+=2;e*=2;break;case"utf8":r=Pp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Jb(this,this.l,this.l+e);break;case"wstr":return u0.call(this,e,"dbcs");case"lpstr-ansi":r=wT(this,this.l),e=4+Ta(this,this.l);break;case"lpstr-cp":r=NT(this,this.l),e=4+Ta(this,this.l);break;case"lpwstr":r=kT(this,this.l),e=4+2*Ta(this,this.l);break;case"lpp4":e=4+Ta(this,this.l),r=ET(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ta(this,this.l),r=jT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Td(this,this.l+e++))!==0;)a.push(Km(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=al(this,this.l+e))!==0;)a.push(Km(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Td(this,u),this.l=u+1,o=u0.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Km(al(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Td(this,u),this.l=u+1,o=u0.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Km(Td(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Td(this,this.l),this.l++,n;case 2:return n=(t==="i"?bH:al)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?au:NH)(this,this.l),this.l+=4,n):(s=Ta(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=B1(this,this.l):s=B1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=vT(this,this.l,e);break}}return this.l+=e,r}var SH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},kH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},_H=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function EH(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)_H(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,SH(this,t,this.l);break;case 8:if(n=8,r==="f"){wH(this,t,this.l);break}case 16:break;case-4:n=4,kH(this,t,this.l);break}return this.l+=n,this}function PT(e,t){var r=vT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function hs(e,t){e.l=t,e.read_shift=u0,e.chk=PT,e.write_shift=EH}function Us(e,t){e.l+=t}function Wn(e){var t=Lc(e);return hs(t,0),t}function kl(e,t,r){if(e){var n,s,a;hs(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=W1[o]||W1[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=l,t(d,u,o))return}}}function Bw(){var e=[],t=dr?256:2048,r=function(u){var d=Wn(u);return hs(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),tc(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function d0(e,t,r){var n=vs(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ik(e,t,r){var n=vs(e);return n.s=d0(n.s,t.s,r),n.e=d0(n.e,t.s,r),n}function f0(e,t){if(e.cRel&&e.c<0)for(e=vs(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=vs(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Xt(e);return!e.cRel&&e.cRel!=null&&(r=CH(r)),!e.rRel&&e.rRel!=null&&(r=AH(r)),r}function xv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Yn(e.s.c)+":"+(e.e.cRel?"":"$")+Yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ys(e.s.r)+":"+(e.e.rRel?"":"$")+ys(e.e.r):f0(e.s,t.biff)+":"+f0(e.e,t.biff)}function Qb(e){return parseInt(jH(e),10)-1}function ys(e){return""+(e+1)}function AH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jH(e){return e.replace(/\$(\d+)$/,"$1")}function Zb(e){for(var t=TH(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Yn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function CH(e){return e.replace(/^([A-Z])/,"$$$1")}function TH(e){return e.replace(/^\$([A-Z])/,"$1")}function PH(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Zs(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Xt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Wf(e){var t=e.indexOf(":");return t==-1?{s:Zs(e),e:Zs(e)}:{s:Zs(e.slice(0,t)),e:Zs(e.slice(t+1))}}function mr(e,t){return typeof t>"u"||typeof t=="number"?mr(e.s,e.e):(typeof e!="string"&&(e=Xt(e)),typeof t!="string"&&(t=Xt(t)),e==t?e:e+":"+t)}function hn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function ok(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=oi(e.z,r?sa(t):t)}catch{}try{return e.w=oi((e.XF||{}).numFmtId||(r?14:0),r?sa(t):t)}catch{return""+t}}function yl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ed[e.v]||e.v:t==null?ok(e,e.v):ok(e,t))}function Bc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function LT(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Zs(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=hn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[f].length;++p)if(!(typeof t[f][p]>"u")){var h={v:t[f][p]},m=i+f,g=o+p;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[f][p]&&typeof t[f][p]=="object"&&!Array.isArray(t[f][p])&&!(t[f][p]instanceof Date))h=t[f][p];else if(Array.isArray(h.v)&&(h.f=t[f][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||er[14],n.cellDates?(h.t="d",h.w=oi(h.z,sa(h.v))):(h.t="n",h.v=sa(h.v),h.w=oi(h.z,h.v))):h.t="s";if(s)a[m]||(a[m]=[]),a[m][g]&&a[m][g].z&&(h.z=a[m][g].z),a[m][g]=h;else{var y=Xt({c:g,r:m});a[y]&&a[y].z&&(h.z=a[y].z),a[y]=h}}}return u.s.c<1e7&&(a["!ref"]=mr(u)),a}function Vf(e,t){return LT(null,e,t)}function LH(e){return e.read_shift(4,"i")}function Ms(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function FH(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function e4(e,t){var r=e.l,n=e.read_shift(1),s=Ms(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(FH(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var DH=e4;function ci(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Qu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var RH=Ms;function t4(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var IH=Ms,Uw=t4;function r4(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?B1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):au(t,0)>>2;return r?s/100:s}function FT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Zu=FT;function Rs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function OH(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Cu[s];u&&(t.rgb=lp(u));break;case 2:t.rgb=lp([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function MH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function DT(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function BH(e){return DT(e,1)}function UH(e){return DT(e,2)}var n4=2,ca=3,Ym=11,lk=12,U1=19,Xm=64,$H=65,zH=71,HH=4108,qH=4126,Zn=80,RT=81,WH=[Zn,RT],VH={1:{n:"CodePage",t:n4},2:{n:"Category",t:Zn},3:{n:"PresentationFormat",t:Zn},4:{n:"ByteCount",t:ca},5:{n:"LineCount",t:ca},6:{n:"ParagraphCount",t:ca},7:{n:"SlideCount",t:ca},8:{n:"NoteCount",t:ca},9:{n:"HiddenCount",t:ca},10:{n:"MultimediaClipCount",t:ca},11:{n:"ScaleCrop",t:Ym},12:{n:"HeadingPairs",t:HH},13:{n:"TitlesOfParts",t:qH},14:{n:"Manager",t:Zn},15:{n:"Company",t:Zn},16:{n:"LinksUpToDate",t:Ym},17:{n:"CharacterCount",t:ca},19:{n:"SharedDoc",t:Ym},22:{n:"HyperlinksChanged",t:Ym},23:{n:"AppVersion",t:ca,p:"version"},24:{n:"DigSig",t:$H},26:{n:"ContentType",t:Zn},27:{n:"ContentStatus",t:Zn},28:{n:"Language",t:Zn},29:{n:"Version",t:Zn},255:{},2147483648:{n:"Locale",t:U1},2147483651:{n:"Behavior",t:U1},1919054434:{}},KH={1:{n:"CodePage",t:n4},2:{n:"Title",t:Zn},3:{n:"Subject",t:Zn},4:{n:"Author",t:Zn},5:{n:"Keywords",t:Zn},6:{n:"Comments",t:Zn},7:{n:"Template",t:Zn},8:{n:"LastAuthor",t:Zn},9:{n:"RevNumber",t:Zn},10:{n:"EditTime",t:Xm},11:{n:"LastPrinted",t:Xm},12:{n:"CreatedDate",t:Xm},13:{n:"ModifiedDate",t:Xm},14:{n:"PageCount",t:ca},15:{n:"WordCount",t:ca},16:{n:"CharCount",t:ca},17:{n:"Thumbnail",t:zH},18:{n:"Application",t:Zn},19:{n:"DocSecurity",t:ca},255:{},2147483648:{n:"Locale",t:U1},2147483651:{n:"Behavior",t:U1},1919054434:{}},ck={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},GH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function YH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var XH=YH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cu=vs(XH),ed={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},IT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},uk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function JH(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function QH(e){var t=JH();if(!e||!e.match)return t;var r={};if((e.match(zs)||[]).forEach(function(n){var s=$t(n);switch(s[0].replace(iH,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[uk[s.ContentType]]!==void 0&&t[uk[s.ContentType]].push(s.PartName);break}}),t.xmlns!==xH.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Wd={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $w(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function h0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(zs)||[]).forEach(function(s){var a=$t(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Vh(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var ZH="application/vnd.oasis.opendocument.spreadsheet";function eq(e,t){for(var r=Xb(e),n,s;n=ip.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=$t(n[0],!1),s.path=="/"&&s.type!==ZH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var p0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tq=function(){for(var e=new Array(p0.length),t=0;t<p0.length;++t){var r=p0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function OT(e){var t={};e=zr(e);for(var r=0;r<p0.length;++r){var n=p0[r],s=e.match(tq[r]);s!=null&&s.length>0&&(t[n[1]]=yr(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=ss(t[n[1]]))}return t}var rq=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function MT(e,t,r,n){var s=[];if(typeof e=="string")s=ek(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?ek(t,n).map(function(d){return d.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function nq(e,t,r){var n={};return t||(t={}),e=zr(e),rq.forEach(function(s){var a=(e.match(ap(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=yr(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&MT(n.HeadingPairs,n.TitlesOfParts,t,r),t}var sq=/<[^>]+>[^<]*/g;function aq(e,t){var r={},n="",s=e.match(sq);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=$t(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=yr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=yr(d);break;case"bool":r[n]=Jr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=ss(d);break;case"cy":case"error":r[n]=yr(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var iq={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},vv;function oq(e,t,r){vv||(vv=Kb(iq)),t=vv[t]||t,e[t]=r}function s4(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BT(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function UT(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function $T(e,t,r){return t===31?UT(e):BT(e,t,r)}function zw(e,t,r){return $T(e,t,r===!1?0:4)}function lq(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return $T(e,t,0)}function cq(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ta,""),e.l-s&2&&(e.l+=2)}return r}function uq(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ta,"");return r}function dq(e){var t=e.l,r=$1(e,RT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=$1(e,ca);return[r,n]}function fq(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(dq(e));return r}function dk(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(ta,"").replace(Wh,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function zT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function hq(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function $1(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==lk&&n!==t&&WH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===lk?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return BT(e,n,4).replace(ta,"");case 31:return UT(e);case 64:return s4(e);case 65:return zT(e);case 71:return hq(e);case 80:return zw(e,n,!a.raw).replace(ta,"");case 81:return lq(e,n).replace(ta,"");case 4108:return fq(e);case 4126:case 4127:return n==4127?cq(e):uq(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function fk(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(w,b){return w[1]-b[1]});var p={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var h=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],h=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],h=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(h=!1,e.l=a[i][1]),h)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[a[i][0]];if(p[m.n]=$1(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Li(o=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(a[i][0]===1){if(o=p.CodePage=$1(e,n4),Li(o),l!==-1){var g=e.l;e.l=a[l][1],u=dk(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}u=dk(e,o)}else{var y=u[a[i][0]],x;switch(e[e.l]){case 65:e.l+=4,x=zT(e);break;case 30:e.l+=4,x=zw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=zw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=yn(e,4);break;case 64:e.l+=4,x=ss(s4(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[y]=x}}return e.l=r+n,p}function hk(e,t,r){var n=e.content;if(!n)return{};hs(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==pr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var f=fk(n,t),p={SystemIdentifier:u};for(var h in f)p[h]=f[h];if(p.FMTID=a,s===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=fk(n,null)}catch{}for(h in m)p[h]=m[h];return p.FMTID=[a,i],p}function Hl(e,t){return e.read_shift(t),null}function pq(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function yn(e,t){return e.read_shift(t)===1}function Ln(e){return e.read_shift(2,"u")}function HT(e,t){return pq(e,t,Ln)}function mq(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Lp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function gq(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function zu(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Fp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):zu(e,n,r)}function td(e,t,r){if(r.biff>5)return Fp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function xq(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function vq(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ta,"");return n&&(e.l+=24),s}function yq(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(ta,"");return r+i}function wq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return vq(e);case"0303000000000000c000000000000046":return yq(e);default:throw new Error("Unsupported Moniker "+r)}}function Jm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ta,""):"";return r}function bq(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,u="",d,f;s&16&&(a=Jm(e,r-e.l)),s&128&&(i=Jm(e,r-e.l)),(s&257)===257&&(o=Jm(e,r-e.l)),(s&257)===1&&(l=wq(e,r-e.l)),s&8&&(u=Jm(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=s4(e)),e.l=r;var p=i||o||l||"";p&&u&&(p+="#"+u),p||(p="#"+u),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var h={Target:p};return d&&(h.guid=d),f&&(h.time=f),a&&(h.Tooltip=a),h}function qT(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function WT(e,t){var r=qT(e);return r[3]=0,r}function Ao(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Nq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Sq(e,t,r){return t===0?"":td(e,t,r)}function kq(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function VT(e){var t=e.read_shift(2),r=r4(e);return[t,r]}function _q(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Lp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function Mx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function KT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var Eq=KT;function GT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Aq(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function jq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Es(e){e.l+=2,e.l+=e.read_shift(2)}var Cq={0:Es,4:Es,5:Es,6:Es,7:jq,8:Es,9:Es,10:Es,11:Es,12:Es,13:Aq,14:Es,15:Es,16:Es,17:Es,18:Es,19:Es,20:Es,21:GT};function Tq(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(Cq[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Qm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Pq(e,t){return t===0||e.read_shift(2),1200}function Lq(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=td(e,0,r);return e.read_shift(t+n-e.l),s}function Fq(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Dq(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Lp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Rq(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(gq(e));return a.Count=n,a.Unique=s,a}function Iq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Oq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Mq(e){var t=Nq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Bq(e){return e.read_shift(2),e.read_shift(4)}function pk(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function Uq(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function $q(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function zq(){}function Hq(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Lp(e,0,r),n}function qq(e){var t=Ao(e);return t.isst=e.read_shift(4),t}function Wq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Ao(e);r.biff==2&&e.l++;var a=Fp(e,n-e.l,r);return s.val=a,s}function Vq(e,t,r){var n=e.read_shift(2),s=td(e,0,r);return[n,s]}var Kq=td;function mk(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function Gq(e){var t=e.read_shift(2),r=e.read_shift(2),n=VT(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Yq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(VT(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function Xq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Jq(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=GH[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Qq(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Jq(e,t,n.fStyle,r),n}function Zq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function gk(e,t,r){var n=Ao(e);(r.biff==2||t==9)&&++e.l;var s=mq(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function eW(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ao(e),s=Rs(e);return n.val=s,n}var xk=Sq;function tW(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=zu(e,a),o=[];n>e.l;)o.push(Fp(e));return[a,s,i,o]}function vk(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=_q(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var rW=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yk(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=zu(e,i,r);s&32&&(u=rW[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:OG(e,d,r,o);return{chKey:a,Name:u,itab:l,rgce:f}}function YT(e,t,r){if(r.biff<8)return nW(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(kq(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function nW(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Lp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function sW(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=zu(e,n,r),i=zu(e,s,r);return[a,i]}function aW(e,t,r){var n=KT(e);e.l++;var s=e.read_shift(1);return t-=8,[MG(e,t,r),s,n]}function wk(e,t,r){var n=Eq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,RG(e,t,r)]}function iW(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function oW(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=td(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function lW(e,t,r){return oW(e,t,r)}function cW(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Mx(e));return r}function uW(e,t,r){if(r&&r.biff<8)return fW(e,t,r);var n=GT(e),s=Tq(e,t-22,n[1]);return{cmo:n,ft:s}}var dW={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function fW(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((dW[n]||Us)(e,t,r)),{cmo:[s,n,a],ft:i}}function hW(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=xq(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ln(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=zu(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function pW(e,t){var r=Mx(e);e.l+=16;var n=bq(e,t-24);return[r,n]}function mW(e,t){e.read_shift(2);var r=Mx(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ta,""),[r,n]}function gW(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=ck[r]||r,r=e.read_shift(2),t[1]=ck[r]||r,t}function xW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(WT(e));return r}function vW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(WT(e));return r}function yW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function XT(e,t,r){if(!r.cellStyles)return Us(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function wW(e,t){var r={};return t<32||(e.l+=16,r.header=Rs(e),r.footer=Rs(e),e.l+=2),r}function bW(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var NW=Ao,SW=HT,kW=Fp;function _W(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function EW(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ao(e);++e.l;var s=td(e,t-7,r);return n.t="str",n.val=s,n}function AW(e){var t=Ao(e);++e.l;var r=Rs(e);return t.t="n",t.val=r,t}function jW(e){var t=Ao(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function CW(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function TW(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function PW(e,t,r){var n=e.l+t,s=Ao(e),a=e.read_shift(2),i=zu(e,a,r);return e.l=n,s.t="str",s.val=i,s}var LW=[2,3,48,49,131,139,140,245],bk=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Kb({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=Lc(1);switch(l.type){case"base64":d=Ti(Oa(o));break;case"binary":d=Ti(o);break;case"buffer":case"array":d=o;break}hs(d,0);var f=d.read_shift(1),p=!!(f&136),h=!1,m=!1;switch(f){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var g=0,y=521;f==2&&(g=d.read_shift(2)),d.l+=3,f!=2&&(g=d.read_shift(4)),g>1048576&&(g=1e6),f!=2&&(y=d.read_shift(2));var x=d.read_shift(2),w=l.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(w=e[d[d.l]]),d.l+=1,d.l+=2),m&&(d.l+=36);for(var b=[],N={},A=Math.min(d.length,f==2?521:y-10-(h?264:0)),P=m?32:11;d.l<A&&d[d.l]!=13;)switch(N={},N.name=np.utils.decode(w,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!m&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&b.push(N),f!=2&&(d.l+=m?13:14),N.type){case"B":(!h||N.len!=8)&&l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=y-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=y;var j=0,D=0;for(u[0]=[],D=0;D!=b.length;++D)u[0][D]=b[D].name;for(;g-- >0;){if(d[d.l]===42){d.l+=x;continue}for(++d.l,u[++j]=[],D=0,D=0;D!=b.length;++D){var E=d.slice(d.l,d.l+b[D].len);d.l+=b[D].len,hs(E,0);var I=np.utils.decode(w,E);switch(b[D].type){case"C":I.trim().length&&(u[j][D]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[j][D]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[j][D]=I;break;case"F":u[j][D]=parseFloat(I.trim());break;case"+":case"I":u[j][D]=m?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[j][D]=!0;break;case"N":case"F":u[j][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[j][D]="##MEMO##"+(m?parseInt(I.trim(),10):E.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[j][D]=+I||0);break;case"@":u[j][D]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":u[j][D]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":u[j][D]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[j][D]=-E.read_shift(-8,"f");break;case"B":if(h&&b[D].len==8){u[j][D]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[D].len;break;case"0":if(b[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[D].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Vf(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,l){try{return Bc(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Li(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Bw(),f=Yw(o,{header:1,raw:!0,cellDates:!0}),p=f[0],h=f.slice(1),m=o["!cols"]||[],g=0,y=0,x=0,w=1;for(g=0;g<p.length;++g){if(((m[g]||{}).DBF||{}).name){p[g]=m[g].DBF.name,++x;continue}if(p[g]!=null){if(++x,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(y=0;y<1024;++y)if(p.indexOf(p[g]+"_"+y)==-1){p[g]+="_"+y;break}}}}var b=hn(o["!ref"]),N=[],A=[],P=[];for(g=0;g<=b.e.c-b.s.c;++g){var j="",D="",E=0,I=[];for(y=0;y<h.length;++y)h[y][g]!=null&&I.push(h[y][g]);if(I.length==0||p[g]==null){N[g]="?";continue}for(y=0;y<I.length;++y){switch(typeof I[y]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=I[y]instanceof Date?"D":"C";break;default:D="C"}E=Math.max(E,String(I[y]).length),j=j&&j!=D?"C":D}E>250&&(E=250),D=((m[g]||{}).DBF||{}).type,D=="C"&&m[g].DBF.len>E&&(E=m[g].DBF.len),j=="B"&&D=="N"&&(j="N",P[g]=m[g].DBF.dec,E=m[g].DBF.len),A[g]=j=="C"||D=="N"?E:a[j]||0,w+=A[g],N[g]=j}var _=d.next(32);for(_.write_shift(4,318902576),_.write_shift(4,h.length),_.write_shift(2,296+32*x),_.write_shift(2,w),g=0;g<4;++g)_.write_shift(4,0);for(_.write_shift(4,0|(+t[YC]||3)<<8),g=0,y=0;g<p.length;++g)if(p[g]!=null){var L=d.next(32),M=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);L.write_shift(1,M,"sbcs"),L.write_shift(1,N[g]=="?"?"C":N[g],"sbcs"),L.write_shift(4,y),L.write_shift(1,A[g]||a[N[g]]||0),L.write_shift(1,P[g]||0),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(1,0),L.write_shift(4,0),L.write_shift(4,0),y+=A[g]||a[N[g]]||0}var K=d.next(264);for(K.write_shift(4,13),g=0;g<65;++g)K.write_shift(4,0);for(g=0;g<h.length;++g){var Z=d.next(w);for(Z.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(N[y]){case"L":Z.write_shift(1,h[g][y]==null?63:h[g][y]?84:70);break;case"B":Z.write_shift(8,h[g][y]||0,"f");break;case"N":var ae="0";for(typeof h[g][y]=="number"&&(ae=h[g][y].toFixed(P[y]||0)),x=0;x<A[y]-ae.length;++x)Z.write_shift(1,32);Z.write_shift(1,ae,"sbcs");break;case"D":h[g][y]?(Z.write_shift(4,("0000"+h[g][y].getFullYear()).slice(-4),"sbcs"),Z.write_shift(2,("00"+(h[g][y].getMonth()+1)).slice(-2),"sbcs"),Z.write_shift(2,("00"+h[g][y].getDate()).slice(-2),"sbcs")):Z.write_shift(8,"00000000","sbcs");break;case"C":var he=String(h[g][y]!=null?h[g][y]:"").slice(0,A[y]);for(Z.write_shift(1,he,"sbcs"),x=0;x<A[y]-he.length;++x)Z.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),FW=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ko(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var m=e[h];return typeof m=="number"?OS(m):m},n=function(p,h,m){var g=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?p:OS(g)};e["|"]=254;function s(p,h){switch(h.type){case"base64":return a(Oa(p),h);case"binary":return a(p,h);case"buffer":return a(dr&&Buffer.isBuffer(p)?p.toString("binary"):Ju(p),h);case"array":return a($u(p),h)}throw new Error("Unrecognized type "+h.type)}function a(p,h){var m=p.split(/[\n\r]+/),g=-1,y=-1,x=0,w=0,b=[],N=[],A=null,P={},j=[],D=[],E=[],I=0,_;for(+h.codepage>=0&&Li(+h.codepage);x!==m.length;++x){I=0;var L=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=L.replace(/;;/g,"\0").split(";").map(function(O){return O.replace(/\u0000/g,";")}),K=M[0],Z;if(L.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&N.push(L.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,he=!1,re=!1,U=!1,ue=-1,pe=-1;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"A":break;case"X":y=parseInt(M[w].slice(1))-1,he=!0;break;case"Y":for(g=parseInt(M[w].slice(1))-1,he||(y=0),_=b.length;_<=g;++_)b[_]=[];break;case"K":Z=M[w].slice(1),Z.charAt(0)==='"'?Z=Z.slice(1,Z.length-1):Z==="TRUE"?Z=!0:Z==="FALSE"?Z=!1:isNaN(Oi(Z))?isNaN(Pf(Z).getDate())||(Z=ss(Z)):(Z=Oi(Z),A!==null&&qf(A)&&(Z=Ox(Z))),ae=!0;break;case"E":U=!0;var C=af(M[w].slice(1),{r:g,c:y});b[g][y]=[b[g][y],C];break;case"S":re=!0,b[g][y]=[b[g][y],"S5S"];break;case"G":break;case"R":ue=parseInt(M[w].slice(1))-1;break;case"C":pe=parseInt(M[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}if(ae&&(b[g][y]&&b[g][y].length==2?b[g][y][0]=Z:b[g][y]=Z,A=null),re){if(U)throw new Error("SYLK shared formula cannot have own formula");var R=ue>-1&&b[ue][pe];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");b[g][y][1]=i8(R[1],{r:g-ue,c:y-pe})}break;case"F":var B=0;for(w=1;w<M.length;++w)switch(M[w].charAt(0)){case"X":y=parseInt(M[w].slice(1))-1,++B;break;case"Y":for(g=parseInt(M[w].slice(1))-1,_=b.length;_<=g;++_)b[_]=[];break;case"M":I=parseInt(M[w].slice(1))/20;break;case"F":break;case"G":break;case"P":A=N[parseInt(M[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=M[w].slice(1).split(" "),_=parseInt(E[0],10);_<=parseInt(E[1],10);++_)I=parseInt(E[2],10),D[_-1]=I===0?{hidden:!0}:{wch:I},Lf(D[_-1]);break;case"C":y=parseInt(M[w].slice(1))-1,D[y]||(D[y]={});break;case"R":g=parseInt(M[w].slice(1))-1,j[g]||(j[g]={}),I>0?(j[g].hpt=I,j[g].hpx=cp(I)):I===0&&(j[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}B<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+L)}}return j.length>0&&(P["!rows"]=j),D.length>0&&(P["!cols"]=D),h&&h.sheetRows&&(b=b.slice(0,h.sheetRows)),[b,P]}function i(p,h){var m=s(p,h),g=m[0],y=m[1],x=Vf(g,h);return ko(y).forEach(function(w){x[w]=y[w]}),x}function o(p,h){return Bc(i(p,h),h)}function l(p,h,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+yK(p.f,{r:m,c:g}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,h){h.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=H1(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=q1(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function d(p,h){h.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*n8(m.hpx)+";"),y.length>2&&p.push(y+"R"+(g+1))})}function f(p,h){var m=["ID;PWXL;N;E"],g=[],y=hn(p["!ref"]),x,w=Array.isArray(p),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&d(m,p["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var N=y.s.r;N<=y.e.r;++N)for(var A=y.s.c;A<=y.e.c;++A){var P=Xt({r:N,c:A});x=w?(p[N]||[])[A]:p[P],!(!x||x.v==null&&(!x.f||x.F))&&g.push(l(x,p,N,A))}return m.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:i,from_sheet:f}}(),DW=function(){function e(a,i){switch(i.type){case"base64":return t(Oa(a),i);case"binary":return t(a,i);case"buffer":return t(dr&&Buffer.isBuffer(a)?a.toString("binary"):Ju(a),i);case"array":return t($u(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++l]=[],u=0;continue}if(!(l<0)){var p=o[d].trim().split(","),h=p[0],m=p[1];++d;for(var g=o[d]||"";(g.match(/["]/g)||[]).length&1&&d<o.length-1;)g+=`
`+o[++d];switch(g=g.trim(),+h){case-1:if(g==="BOT"){f[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?f[l][u]=!0:g==="FALSE"?f[l][u]=!1:isNaN(Oi(m))?isNaN(Pf(m).getDate())?f[l][u]=m:f[l][u]=ss(m):f[l][u]=Oi(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),f[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return Vf(e(a,i),i)}function n(a,i){return Bc(r(a,i),i)}var s=function(){var a=function(l,u,d,f,p){l.push(u),l.push(d+","+f),l.push('"'+p.replace(/"/g,'""')+'"')},i=function(l,u,d,f){l.push(u+","+d),l.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(l){var u=[],d=hn(l["!ref"]),f,p=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var h=d.s.r;h<=d.e.r;++h){i(u,-1,0,"BOT");for(var m=d.s.c;m<=d.e.c;++m){var g=Xt({r:h,c:m});if(f=p?(l[h]||[])[m]:l[g],!f){i(u,1,0,"");continue}switch(f.t){case"n":var y=f.w;!y&&f.v!=null&&(y=f.v),y==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,y,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=oi(f.z||er[14],sa(ss(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var x=`\r
`,w=u.join(x);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),RW=function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,p){for(var h=f.split(`
`),m=-1,g=-1,y=0,x=[];y!==h.length;++y){var w=h[y].trim().split(":");if(w[0]==="cell"){var b=Zs(w[1]);if(x.length<=b.r)for(m=x.length;m<=b.r;++m)x[m]||(x[m]=[]);switch(m=b.r,g=b.c,w[2]){case"t":x[m][g]=e(w[3]);break;case"v":x[m][g]=+w[3];break;case"vtf":var N=w[w.length-1];case"vtc":switch(w[3]){case"nl":x[m][g]=!!+w[4];break;default:x[m][g]=+w[4];break}w[2]=="vtf"&&(x[m][g]=[x[m][g],N])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function n(f,p){return Vf(r(f,p),p)}function s(f,p){return Bc(n(f,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var p=[],h=[],m,g="",y=Wf(f["!ref"]),x=Array.isArray(f),w=y.s.r;w<=y.e.r;++w)for(var b=y.s.c;b<=y.e.c;++b)if(g=Xt({r:w,c:b}),m=x?(f[w]||[])[b]:f[g],!(!m||m.v==null||m.t==="z")){switch(h=["cell",g,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var N=sa(ss(m.v));h[2]="vtc",h[3]="nd",h[4]=""+N,h[5]=m.w||oi(m.z||er[14],N);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function d(f){return[a,i,o,i,u(f),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),op=function(){function e(d,f,p,h,m){m.raw?f[p][h]=d:d===""||(d==="TRUE"?f[p][h]=!0:d==="FALSE"?f[p][h]=!1:isNaN(Oi(d))?isNaN(Pf(d).getDate())?f[p][h]=d:f[p][h]=ss(d):f[p][h]=Oi(d))}function t(d,f){var p=f||{},h=[];if(!d||d.length===0)return h;for(var m=d.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,x=0,w=0;w<=g;++w)x=m[w].indexOf(" "),x==-1?x=m[w].length:x++,y=Math.max(y,x);for(w=0;w<=g;++w){h[w]=[];var b=0;for(e(m[w].slice(0,y).trim(),h,w,b,p),b=1;b<=(m[w].length-y)/10+1;++b)e(m[w].slice(y+(b-1)*10,y+b*10).trim(),h,w,b,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},p=!1,h=0,m=0;h<d.length;++h)(m=d.charCodeAt(h))==34?p=!p:!p&&m in r&&(f[m]=(f[m]||0)+1);m=[];for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h]);if(!m.length){f=n;for(h in f)Object.prototype.hasOwnProperty.call(f,h)&&m.push([f[h],h])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function a(d,f){var p=f||{},h="",m=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(h=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(h=d.charAt(4),d=d.slice(6)):h=s(d.slice(0,1024)):p&&p.FS?h=p.FS:h=s(d.slice(0,1024));var y=0,x=0,w=0,b=0,N=0,A=h.charCodeAt(0),P=!1,j=0,D=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var E=p.dateNF!=null?Vz(p.dateNF):null;function I(){var _=d.slice(b,N),L={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)L.t="z";else if(p.raw)L.t="s",L.v=_;else if(_.trim().length===0)L.t="s",L.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(L.t="s",L.v=_.slice(2,-1).replace(/""/g,'"')):bK(_)?(L.t="n",L.f=_.slice(1)):(L.t="s",L.v=_);else if(_=="TRUE")L.t="b",L.v=!0;else if(_=="FALSE")L.t="b",L.v=!1;else if(!isNaN(w=Oi(_)))L.t="n",p.cellText!==!1&&(L.w=_),L.v=w;else if(!isNaN(Pf(_).getDate())||E&&_.match(E)){L.z=p.dateNF||er[14];var M=0;E&&_.match(E)&&(_=Kz(_,p.dateNF,_.match(E)||[]),M=1),p.cellDates?(L.t="d",L.v=ss(_,M)):(L.t="n",L.v=sa(ss(_,M))),p.cellText!==!1&&(L.w=oi(L.z,L.v instanceof Date?sa(L.v):L.v)),p.cellNF||delete L.z}else L.t="s",L.v=_;if(L.t=="z"||(p.dense?(m[y]||(m[y]=[]),m[y][x]=L):m[Xt({c:x,r:y})]=L),b=N+1,D=d.charCodeAt(b),g.e.c<x&&(g.e.c=x),g.e.r<y&&(g.e.r=y),j==A)++x;else if(x=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;N<d.length;++N)switch(j=d.charCodeAt(N)){case 34:D===34&&(P=!P);break;case A:case 10:case 13:if(!P&&I())break e;break}return N-b>0&&I(),m["!ref"]=mr(g),m}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):Vf(t(d,f),f)}function o(d,f){var p="",h=f.type=="string"?[0,0,0,0]:f4(d,f);switch(f.type){case"base64":p=Oa(d);break;case"binary":p=d;break;case"buffer":f.codepage==65001?p=d.toString("utf8"):f.codepage&&typeof np<"u"||(p=dr&&Buffer.isBuffer(d)?d.toString("binary"):Ju(d));break;case"array":p=$u(d);break;case"string":p=d;break;default:throw new Error("Unrecognized type "+f.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=zr(p.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?p=zr(p):f.type=="binary"&&typeof np<"u",p.slice(0,19)=="socialcalc:version:"?RW.to_sheet(f.type=="string"?p:zr(p),f):i(p,f)}function l(d,f){return Bc(o(d,f),f)}function u(d){for(var f=[],p=hn(d["!ref"]),h,m=Array.isArray(d),g=p.s.r;g<=p.e.r;++g){for(var y=[],x=p.s.c;x<=p.e.c;++x){var w=Xt({r:g,c:x});if(h=m?(d[g]||[])[x]:d[w],!h||h.v==null){y.push("          ");continue}for(var b=(h.w||(yl(h),h.w)||"").slice(0,10);b.length<10;)b+=" ";y.push(b+(x===0?" ":""))}f.push(y.join(""))}return f.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function IW(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=FW.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return op.to_workbook(e,t)}}var m0=function(){function e(C,R,B){if(C){hs(C,C.l||0);for(var O=B.Enum||ue;C.l<C.length;){var Y=C.read_shift(2),ie=O[Y]||O[65535],me=C.read_shift(2),ge=C.l+me,xe=ie.f&&ie.f(C,me,B);if(C.l=ge,R(xe,ie,Y))return}}}function t(C,R){switch(R.type){case"base64":return r(Ti(Oa(C)),R);case"binary":return r(Ti(C),R);case"buffer":case"array":return r(C,R)}throw"Unsupported type "+R.type}function r(C,R){if(!C)return C;var B=R||{},O=B.dense?[]:{},Y="Sheet1",ie="",me=0,ge={},xe=[],Le=[],z={s:{r:0,c:0},e:{r:0,c:0}},Re=B.sheetRows||0;if(C[2]==0&&(C[3]==8||C[3]==9)&&C.length>=16&&C[14]==5&&C[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(C[2]==2)B.Enum=ue,e(C,function(Me,st,Ue){switch(Ue){case 0:B.vers=Me,Me>=4096&&(B.qpro=!0);break;case 6:z=Me;break;case 204:Me&&(ie=Me);break;case 222:ie=Me;break;case 15:case 51:B.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:Ue==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=B.dateNF||er[14],B.cellDates&&(Me[1].t="d",Me[1].v=Ox(Me[1].v))),B.qpro&&Me[3]>me&&(O["!ref"]=mr(z),ge[Y]=O,xe.push(Y),O=B.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},me=Me[3],Y=ie||"Sheet"+(me+1),ie="");var xt=B.dense?(O[Me[0].r]||[])[Me[0].c]:O[Xt(Me[0])];if(xt){xt.t=Me[1].t,xt.v=Me[1].v,Me[1].z!=null&&(xt.z=Me[1].z),Me[1].f!=null&&(xt.f=Me[1].f);break}B.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[Xt(Me[0])]=Me[1];break}},B);else if(C[2]==26||C[2]==14)B.Enum=pe,C[2]==14&&(B.qpro=!0,C.l=0),e(C,function(Me,st,Ue){switch(Ue){case 204:Y=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>me&&(O["!ref"]=mr(z),ge[Y]=O,xe.push(Y),O=B.dense?[]:{},z={s:{r:0,c:0},e:{r:0,c:0}},me=Me[3],Y="Sheet"+(me+1)),Re>0&&Me[0].r>=Re)break;B.dense?(O[Me[0].r]||(O[Me[0].r]=[]),O[Me[0].r][Me[0].c]=Me[1]):O[Xt(Me[0])]=Me[1],z.e.c<Me[0].c&&(z.e.c=Me[0].c),z.e.r<Me[0].r&&(z.e.r=Me[0].r);break;case 27:Me[14e3]&&(Le[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Le[Me[0]]=Me[1],Me[0]==me&&(Y=Me[1]);break}},B);else throw new Error("Unrecognized LOTUS BOF "+C[2]);if(O["!ref"]=mr(z),ge[ie||Y]=O,xe.push(ie||Y),!Le.length)return{SheetNames:xe,Sheets:ge};for(var Fe={},X=[],Oe=0;Oe<Le.length;++Oe)ge[xe[Oe]]?(X.push(Le[Oe]||xe[Oe]),Fe[Le[Oe]]=ge[Le[Oe]]||ge[xe[Oe]]):(X.push(Le[Oe]),Fe[Le[Oe]]={"!ref":"A1"});return{SheetNames:X,Sheets:Fe}}function n(C,R){var B=R||{};if(+B.codepage>=0&&Li(+B.codepage),B.type=="string")throw new Error("Cannot write WK1 to JS string");var O=Bw(),Y=hn(C["!ref"]),ie=Array.isArray(C),me=[];vi(O,0,a(1030)),vi(O,6,l(Y));for(var ge=Math.min(Y.e.r,8191),xe=Y.s.r;xe<=ge;++xe)for(var Le=ys(xe),z=Y.s.c;z<=Y.e.c;++z){xe===Y.s.r&&(me[z]=Yn(z));var Re=me[z]+Le,Fe=ie?(C[xe]||[])[z]:C[Re];if(!(!Fe||Fe.t=="z"))if(Fe.t=="n")(Fe.v|0)==Fe.v&&Fe.v>=-32768&&Fe.v<=32767?vi(O,13,h(xe,z,Fe.v)):vi(O,14,g(xe,z,Fe.v));else{var X=yl(Fe);vi(O,15,f(xe,z,X.slice(0,239)))}}return vi(O,1),O.end()}function s(C,R){var B=R||{};if(+B.codepage>=0&&Li(+B.codepage),B.type=="string")throw new Error("Cannot write WK3 to JS string");var O=Bw();vi(O,0,i(C));for(var Y=0,ie=0;Y<C.SheetNames.length;++Y)(C.Sheets[C.SheetNames[Y]]||{})["!ref"]&&vi(O,27,U(C.SheetNames[Y],ie++));var me=0;for(Y=0;Y<C.SheetNames.length;++Y){var ge=C.Sheets[C.SheetNames[Y]];if(!(!ge||!ge["!ref"])){for(var xe=hn(ge["!ref"]),Le=Array.isArray(ge),z=[],Re=Math.min(xe.e.r,8191),Fe=xe.s.r;Fe<=Re;++Fe)for(var X=ys(Fe),Oe=xe.s.c;Oe<=xe.e.c;++Oe){Fe===xe.s.r&&(z[Oe]=Yn(Oe));var Me=z[Oe]+X,st=Le?(ge[Fe]||[])[Oe]:ge[Me];if(!(!st||st.t=="z"))if(st.t=="n")vi(O,23,I(Fe,Oe,me,st.v));else{var Ue=yl(st);vi(O,22,j(Fe,Oe,me,Ue.slice(0,239)))}}++me}}return vi(O,1),O.end()}function a(C){var R=Wn(2);return R.write_shift(2,C),R}function i(C){var R=Wn(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var B=0,O=0,Y=0,ie=0;ie<C.SheetNames.length;++ie){var me=C.SheetNames[ie],ge=C.Sheets[me];if(!(!ge||!ge["!ref"])){++Y;var xe=Wf(ge["!ref"]);B<xe.e.r&&(B=xe.e.r),O<xe.e.c&&(O=xe.e.c)}}return B>8191&&(B=8191),R.write_shift(2,B),R.write_shift(1,Y),R.write_shift(1,O),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(C,R,B){var O={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&B.qpro?(O.s.c=C.read_shift(1),C.l++,O.s.r=C.read_shift(2),O.e.c=C.read_shift(1),C.l++,O.e.r=C.read_shift(2),O):(O.s.c=C.read_shift(2),O.s.r=C.read_shift(2),R==12&&B.qpro&&(C.l+=2),O.e.c=C.read_shift(2),O.e.r=C.read_shift(2),R==12&&B.qpro&&(C.l+=2),O.s.c==65535&&(O.s.c=O.e.c=O.s.r=O.e.r=0),O)}function l(C){var R=Wn(8);return R.write_shift(2,C.s.c),R.write_shift(2,C.s.r),R.write_shift(2,C.e.c),R.write_shift(2,C.e.r),R}function u(C,R,B){var O=[{c:0,r:0},{t:"n",v:0},0,0];return B.qpro&&B.vers!=20768?(O[0].c=C.read_shift(1),O[3]=C.read_shift(1),O[0].r=C.read_shift(2),C.l+=2):(O[2]=C.read_shift(1),O[0].c=C.read_shift(2),O[0].r=C.read_shift(2)),O}function d(C,R,B){var O=C.l+R,Y=u(C,R,B);if(Y[1].t="s",B.vers==20768){C.l++;var ie=C.read_shift(1);return Y[1].v=C.read_shift(ie,"utf8"),Y}return B.qpro&&C.l++,Y[1].v=C.read_shift(O-C.l,"cstr"),Y}function f(C,R,B){var O=Wn(7+B.length);O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,C),O.write_shift(1,39);for(var Y=0;Y<O.length;++Y){var ie=B.charCodeAt(Y);O.write_shift(1,ie>=128?95:ie)}return O.write_shift(1,0),O}function p(C,R,B){var O=u(C,R,B);return O[1].v=C.read_shift(2,"i"),O}function h(C,R,B){var O=Wn(7);return O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,C),O.write_shift(2,B,"i"),O}function m(C,R,B){var O=u(C,R,B);return O[1].v=C.read_shift(8,"f"),O}function g(C,R,B){var O=Wn(13);return O.write_shift(1,255),O.write_shift(2,R),O.write_shift(2,C),O.write_shift(8,B,"f"),O}function y(C,R,B){var O=C.l+R,Y=u(C,R,B);if(Y[1].v=C.read_shift(8,"f"),B.qpro)C.l=O;else{var ie=C.read_shift(2);N(C.slice(C.l,C.l+ie),Y),C.l+=ie}return Y}function x(C,R,B){var O=R&32768;return R&=-32769,R=(O?C:0)+(R>=8192?R-16384:R),(O?"":"$")+(B?Yn(R):ys(R))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(C,R){hs(C,0);for(var B=[],O=0,Y="",ie="",me="",ge="";C.l<C.length;){var xe=C[C.l++];switch(xe){case 0:B.push(C.read_shift(8,"f"));break;case 1:ie=x(R[0].c,C.read_shift(2),!0),Y=x(R[0].r,C.read_shift(2),!1),B.push(ie+Y);break;case 2:{var Le=x(R[0].c,C.read_shift(2),!0),z=x(R[0].r,C.read_shift(2),!1);ie=x(R[0].c,C.read_shift(2),!0),Y=x(R[0].r,C.read_shift(2),!1),B.push(Le+z+":"+ie+Y)}break;case 3:if(C.l<C.length){console.error("WK1 premature formula end");return}break;case 4:B.push("("+B.pop()+")");break;case 5:B.push(C.read_shift(2));break;case 6:{for(var Re="";xe=C[C.l++];)Re+=String.fromCharCode(xe);B.push('"'+Re.replace(/"/g,'""')+'"')}break;case 8:B.push("-"+B.pop());break;case 23:B.push("+"+B.pop());break;case 22:B.push("NOT("+B.pop()+")");break;case 20:case 21:ge=B.pop(),me=B.pop(),B.push(["AND","OR"][xe-20]+"("+me+","+ge+")");break;default:if(xe<32&&b[xe])ge=B.pop(),me=B.pop(),B.push(me+b[xe]+ge);else if(w[xe]){if(O=w[xe][1],O==69&&(O=C[C.l++]),O>B.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+B.join("|")+"|");return}var Fe=B.slice(-O);B.length-=O,B.push(w[xe][0]+"("+Fe.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}B.length==1?R[1].f=""+B[0]:console.error("WK1 bad formula parse |"+B.join("|")+"|")}function A(C){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=C.read_shift(2),R[3]=C[C.l++],R[0].c=C[C.l++],R}function P(C,R){var B=A(C);return B[1].t="s",B[1].v=C.read_shift(R-4,"cstr"),B}function j(C,R,B,O){var Y=Wn(6+O.length);Y.write_shift(2,C),Y.write_shift(1,B),Y.write_shift(1,R),Y.write_shift(1,39);for(var ie=0;ie<O.length;++ie){var me=O.charCodeAt(ie);Y.write_shift(1,me>=128?95:me)}return Y.write_shift(1,0),Y}function D(C,R){var B=A(C);B[1].v=C.read_shift(2);var O=B[1].v>>1;if(B[1].v&1)switch(O&7){case 0:O=(O>>3)*5e3;break;case 1:O=(O>>3)*500;break;case 2:O=(O>>3)/20;break;case 3:O=(O>>3)/200;break;case 4:O=(O>>3)/2e3;break;case 5:O=(O>>3)/2e4;break;case 6:O=(O>>3)/16;break;case 7:O=(O>>3)/64;break}return B[1].v=O,B}function E(C,R){var B=A(C),O=C.read_shift(4),Y=C.read_shift(4),ie=C.read_shift(2);if(ie==65535)return O===0&&Y===3221225472?(B[1].t="e",B[1].v=15):O===0&&Y===3489660928?(B[1].t="e",B[1].v=42):B[1].v=0,B;var me=ie&32768;return ie=(ie&32767)-16446,B[1].v=(1-me*2)*(Y*Math.pow(2,ie+32)+O*Math.pow(2,ie)),B}function I(C,R,B,O){var Y=Wn(14);if(Y.write_shift(2,C),Y.write_shift(1,B),Y.write_shift(1,R),O==0)return Y.write_shift(4,0),Y.write_shift(4,0),Y.write_shift(2,65535),Y;var ie=0,me=0,ge=0,xe=0;return O<0&&(ie=1,O=-O),me=Math.log2(O)|0,O/=Math.pow(2,me-31),xe=O>>>0,xe&2147483648||(O/=2,++me,xe=O>>>0),O-=xe,xe|=2147483648,xe>>>=0,O*=Math.pow(2,32),ge=O>>>0,Y.write_shift(4,ge),Y.write_shift(4,xe),me+=16383+(ie?32768:0),Y.write_shift(2,me),Y}function _(C,R){var B=E(C);return C.l+=R-14,B}function L(C,R){var B=A(C),O=C.read_shift(4);return B[1].v=O>>6,B}function M(C,R){var B=A(C),O=C.read_shift(8,"f");return B[1].v=O,B}function K(C,R){var B=M(C);return C.l+=R-10,B}function Z(C,R){return C[C.l+R-1]==0?C.read_shift(R,"cstr"):""}function ae(C,R){var B=C[C.l++];B>R-1&&(B=R-1);for(var O="";O.length<B;)O+=String.fromCharCode(C[C.l++]);return O}function he(C,R,B){if(!(!B.qpro||R<21)){var O=C.read_shift(1);C.l+=17,C.l+=1,C.l+=2;var Y=C.read_shift(R-21,"cstr");return[O,Y]}}function re(C,R){for(var B={},O=C.l+R;C.l<O;){var Y=C.read_shift(2);if(Y==14e3){for(B[Y]=[0,""],B[Y][0]=C.read_shift(2);C[C.l];)B[Y][1]+=String.fromCharCode(C[C.l]),C.l++;C.l++}}return B}function U(C,R){var B=Wn(5+C.length);B.write_shift(2,14e3),B.write_shift(2,R);for(var O=0;O<C.length;++O){var Y=C.charCodeAt(O);B[B.l++]=Y>127?95:Y}return B[B.l++]=0,B}var ue={0:{n:"BOF",f:Ln},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Z},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:L},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Z},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:he},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function OW(e){var t={},r=e.match(zs),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=$t(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=zb[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var MW=function(){var e=ap("t"),t=ap("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:yr(i[1])},l=a.match(t);return l&&(o.s=OW(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),BW=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),UW=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$W=/<(?:\w+:)?r>/,zW=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function a4(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=yr(zr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=zr(e),r&&(n.h=Yb(n.t))):e.match($W)&&(n.r=zr(e),n.t=yr(zr((e.replace(zW,"").match(UW)||[]).join("").replace(zs,""))),r&&(n.h=BW(MW(n.r)))),n):{t:""}}var HW=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,qW=/<(?:\w+:)?(?:si|sstItem)>/g,WW=/<\/(?:\w+:)?(?:si|sstItem)>/;function VW(e,t){var r=[],n="";if(!e)return r;var s=e.match(HW);if(s){n=s[2].replace(qW,"").split(WW);for(var a=0;a!=n.length;++a){var i=a4(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=$t(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function KW(e){return[e.read_shift(4),e.read_shift(4)]}function GW(e,t){var r=[],n=!1;return kl(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function JT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function fl(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function YW(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=fl(e,4),t.U=fl(e,4),t.W=fl(e,4),t}function XW(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function JW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(XW(e));return t}function QW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function ZW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=fl(e,4),t.U=fl(e,4),t.W=fl(e,4),t}function eV(e){var t=ZW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function QT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function ZT(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function tV(e){var t=fl(e);switch(t.Minor){case 2:return[t.Minor,rV(e)];case 3:return[t.Minor,nV()];case 4:return[t.Minor,sV(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function rV(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=QT(e,r),s=ZT(e,e.length-e.l);return{t:"Std",h:n,v:s}}function nV(){throw new Error("File is password-protected: ECMA-376 Extensible")}function sV(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(zs,function(a){var i=$t(a);switch(Eo(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function aV(e,t){var r={},n=r.EncryptionVersionInfo=fl(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=QT(e,s),t-=s,r.EncryptionVerifier=ZT(e,t),r}function iV(e){var t={},r=t.EncryptionVersionInfo=fl(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function oV(e){var t=0,r,n=JT(e),s=n.length+1,a,i,o,l,u;for(r=Lc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var e8=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=JT(i),l=a(o),u=o.length,d=Lc(16),f=0;f!=16;++f)d[f]=0;var p,h,m;for((u&1)===1&&(p=l>>8,d[u]=s(e[0],p),--u,p=l&255,h=o[o.length-1],d[u]=s(h,p));u>0;)--u,p=l>>8,d[u]=s(o[u],p),--u,p=l&255,d[u]=s(o[u],p);for(u=15,m=15-o.length;m>0;)p=l>>8,d[u]=s(e[m],p),--u,--m,p=l&255,d[u]=s(o[u],p),--u,--m;return d}}(),lV=function(e,t,r,n,s){s||(s=t),n||(n=e8(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},cV=function(e){var t=0,r=e8(e);return function(n){var s=lV("",n,t,r);return t=s[1],s[0]}};function uV(e,t,r,n){var s={key:Ln(e),verificationBytes:Ln(e)};return r.password&&(s.verifier=oV(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=cV(r.password)),s}function dV(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=iV(e):n.Data=aV(e,t),n}function fV(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?dV(e,t-2,n):uV(e,r.biff>=8?t:t-2,r,n),n}var hV=function(){function e(s,a){switch(a.type){case"base64":return t(Oa(s),a);case"binary":return t(s,a);case"buffer":return t(dr&&Buffer.isBuffer(s)?s.toString("binary"):Ju(s),a);case"array":return t($u(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var p=/\\\w+\b/g,h=0,m,g=-1;m=p.exec(d);){switch(m[0]){case"\\cell":var y=d.slice(h,p.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var x={v:y,t:"s"};Array.isArray(o)?o[f][g]=x:o[Xt({r:f,c:g})]=x}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=mr(u),o}function r(s,a){return Bc(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=hn(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Xt({r:u,c:d});o=l?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(yl(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function pV(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function lp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function mV(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function gV(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function z1(e,t){if(t===0)return e;var r=mV(pV(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),lp(gV(r))}var t8=6,xV=15,vV=1,Js=t8;function H1(e){return Math.floor((e+Math.round(128/Js)/256)*Js)}function q1(e){return Math.floor((e-5)/Js*100+.5)/100}function Hw(e){return Math.round((e*Js+5)/Js*256)/256}function yv(e){return Hw(q1(H1(e)))}function i4(e){var t=Math.abs(e-yv(e)),r=Js;if(t>.005)for(Js=vV;Js<xV;++Js)Math.abs(e-yv(e))<=t&&(t=Math.abs(e-yv(e)),r=Js);Js=r}function Lf(e){e.width?(e.wpx=H1(e.width),e.wch=q1(e.wpx),e.MDW=Js):e.wpx?(e.wch=q1(e.wpx),e.width=Hw(e.wch),e.MDW=Js):typeof e.wch=="number"&&(e.width=Hw(e.wch),e.wpx=H1(e.width),e.MDW=Js),e.customWidth&&delete e.customWidth}var yV=96,r8=yV;function n8(e){return e*96/r8}function cp(e){return e*r8/96}var wV={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function bV(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(zs)||[]).forEach(function(i){var o=$t(i);switch(Eo(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Jr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Jr(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function NV(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(zs)||[]).forEach(function(i){var o=$t(i);switch(Eo(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function SV(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(zs)||[]).forEach(function(i){var o=$t(i);switch(Eo(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=zr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Jr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Jr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Jr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Jr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Jr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Jr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Jr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=zb[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Jr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Cu[s.color.index];s.color.index==81&&(l=Cu[1]),l||(l=Cu[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=z1(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function kV(e,t,r){t.NumberFmt=[];for(var n=ko(er),s=0;s<n.length;++s)t.NumberFmt[n[s]]=er[n[s]];var a=e[0].match(zs);if(a)for(s=0;s<a.length;++s){var i=$t(a[s]);switch(Eo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=yr(zr(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}ju(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Zm=["numFmtId","fillId","fontId","borderId","xfId"],eg=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function _V(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(zs)||[]).forEach(function(a){var i=$t(a),o=0;switch(Eo(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Zm.length;++o)n[Zm[o]]&&(n[Zm[o]]=parseInt(n[Zm[o]],10));for(o=0;o<eg.length;++o)n[eg[o]]&&(n[eg[o]]=Jr(n[eg[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Jr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var EV=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&kV(f,d,u),(f=o.match(s))&&SV(f,d,l,u),(f=o.match(n))&&NV(f,d,l,u),(f=o.match(a))&&bV(f,d,l,u),(f=o.match(r))&&_V(f,d,u),d}}();function AV(e,t){var r=e.read_shift(2),n=Ms(e);return[r,n]}function jV(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=MH(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=OH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ms(e),n}var CV=Us;function TV(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var PV=Us;function LV(e,t,r){var n={};n.NumberFmt=[];for(var s in er)n.NumberFmt[s]=er[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return kl(e,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],ju(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=z1(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}var FV=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function DV(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(zs)||[]).forEach(function(s){var a=$t(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[FV.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function RV(){}function IV(){}var OV=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,MV=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,BV=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function UV(e,t,r){t.themeElements={};var n;[["clrScheme",OV,DV],["fontScheme",MV,RV],["fmtScheme",BV,IV]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var $V=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function s8(e,t){(!e||e.length===0)&&(e=zV());var r,n={};if(!(r=e.match($V)))throw new Error("themeElements not found in theme");return UV(r[0],n,t),n.raw=e,n}function zV(e,t){var r=[mT];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function HV(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=pT(a,{type:"array"})}catch{return}var o=Pa(i,"theme/theme/theme1.xml",!0);if(o)return s8(o,r)}}function qV(e){return e.read_shift(4)}function WV(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=VV(e,4);break;case 2:t.xclrValue=qT(e);break;case 3:t.xclrValue=qV(e);break;case 4:e.l+=4;break}return e.l+=8,t}function VV(e,t){return Us(e,t)}function KV(e,t){return Us(e,t)}function GV(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=WV(e);break;case 6:n[1]=KV(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function YV(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(GV(e,r-e.l));return{ixfe:n,ext:a}}function XV(e,t){t.forEach(function(r){switch(r[0]){}})}function JV(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ms(e)}}function QV(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function ZV(e){return e.l+=4,e.read_shift(4)!=0}function eK(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return kl(e,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function tK(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(zs,function(o){var l=$t(o);switch(Eo(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function rK(e){var t=[];if(!e)return t;var r=1;return(e.match(zs)||[]).forEach(function(n){var s=$t(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function nK(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Xt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function sK(e,t,r){var n=[];return kl(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function aK(e,t,r,n){if(!e)return e;var s=n||{},a=!1;kl(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function iK(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Nk(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Zs(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=hn(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=mr(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function oK(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=$t(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=Zs(l.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!f&&!!f[1]&&a4(f[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function lK(e,t){var r=[],n=!1,s={},a=0;return e.replace(zs,function(o,l){var u=$t(o);switch(Eo(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function cK(e,t){var r=[],n=!1;return e.replace(zs,function(a){var i=$t(a);switch(Eo(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function uK(e){var t={};t.iauthor=e.read_shift(4);var r=Zu(e);return t.rfx=r.s,t.ref=Xt(r.s),e.l+=16,t}var dK=Ms;function fK(e,t){var r=[],n=[],s={},a=!1;return kl(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var hK="application/vnd.ms-office.vbaProject";function pK(e){var t=pr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");pr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),pr.write(t)}function mK(){return{"!type":"dialog"}}function gK(){return{"!type":"dialog"}}function xK(){return{"!type":"macro"}}function vK(){return{"!type":"macro"}}var af=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,l?u+=t.r:--u,s+(o?"":"$")+Yn(d)+(l?"":"$")+ys(u)}return function(s,a){return t=a,s.replace(e,r)}}(),a8=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,yK=function(){return function(t,r){return t.replace(a8,function(n,s,a,i,o,l){var u=Zb(i)-(a?0:r.c),d=Qb(l)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",p=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+p})}}();function i8(e,t){return e.replace(a8,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Yn(Zb(a)+t.c))+(i=="$"?i+o:ys(Qb(o)+t.r))})}function wK(e,t,r){var n=Wf(t),s=n.s,a=Zs(r),i={r:a.r-s.r,c:a.c-s.c};return i8(e,i)}function bK(e){return e.length!=1}function Sk(e){return e.replace(/_xlfn\./g,"")}function Tn(e){e.l+=1}function Fc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function o8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return l8(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Fc(e),o=Fc(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function l8(e){var t=Fc(e),r=Fc(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function NK(e,t,r){if(r.biff<8)return l8(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Fc(e),i=Fc(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function c8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return SK(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Fc(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function SK(e){var t=Fc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function kK(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _K(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return EK(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function EK(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function AK(e,t,r){var n=(e[e.l++]&96)>>5,s=o8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function jK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=o8(e,a,r);return[n,s,i]}function CK(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function TK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function PK(e,t,r){var n=(e[e.l++]&96)>>5,s=NK(e,t-1,r);return[n,s]}function LK(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function kk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function FK(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function DK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function RK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function IK(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function OK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function u8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function MK(e){return e.read_shift(2),u8(e)}function BK(e){return e.read_shift(2),u8(e)}function UK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=c8(e,0,r);return[n,s]}function $K(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=_K(e,0,r);return[n,s]}function zK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=c8(e,0,r);return[n,s,a]}function HK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[qG[s],h8[s],n]}function qK(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:WK(e);return[s,(a[0]===0?h8:HG)[a[1]]]}function WK(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function VK(e,t,r){e.l+=r&&r.biff==2?3:4}function KK(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function GK(e){return e.l++,ed[e.read_shift(1)]}function YK(e){return e.l++,e.read_shift(2)}function XK(e){return e.l++,e.read_shift(1)!==0}function JK(e){return e.l++,Rs(e)}function QK(e,t,r){return e.l++,Lp(e,t-1,r)}function ZK(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=yn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ed[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Rs(e);break;case 2:r[1]=td(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function eG(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Zu:Mx)(e));return s}function tG(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=ZK(e,r.biff);return i}function rG(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function nG(e,t,r){if(r.biff==5)return sG(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function sG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function aG(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function iG(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function oG(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lG(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var cG=Us,uG=Us,dG=Us;function Dp(e,t,r){return e.l+=2,[kK(e)]}function o4(e){return e.l+=6,[]}var fG=Dp,hG=o4,pG=o4,mG=Dp;function d8(e){return e.l+=2,[Ln(e),e.read_shift(2)&1]}var gG=Dp,xG=d8,vG=o4,yG=Dp,wG=Dp,bG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function NG(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=bG[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function SG(e){return e.l+=2,[e.read_shift(4)]}function kG(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function _G(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function AG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jG(e){return e.l+=4,[0,0]}var _k={1:{n:"PtgExp",f:KK},2:{n:"PtgTbl",f:dG},3:{n:"PtgAdd",f:Tn},4:{n:"PtgSub",f:Tn},5:{n:"PtgMul",f:Tn},6:{n:"PtgDiv",f:Tn},7:{n:"PtgPower",f:Tn},8:{n:"PtgConcat",f:Tn},9:{n:"PtgLt",f:Tn},10:{n:"PtgLe",f:Tn},11:{n:"PtgEq",f:Tn},12:{n:"PtgGe",f:Tn},13:{n:"PtgGt",f:Tn},14:{n:"PtgNe",f:Tn},15:{n:"PtgIsect",f:Tn},16:{n:"PtgUnion",f:Tn},17:{n:"PtgRange",f:Tn},18:{n:"PtgUplus",f:Tn},19:{n:"PtgUminus",f:Tn},20:{n:"PtgPercent",f:Tn},21:{n:"PtgParen",f:Tn},22:{n:"PtgMissArg",f:Tn},23:{n:"PtgStr",f:QK},26:{n:"PtgSheet",f:kG},27:{n:"PtgEndSheet",f:_G},28:{n:"PtgErr",f:GK},29:{n:"PtgBool",f:XK},30:{n:"PtgInt",f:YK},31:{n:"PtgNum",f:JK},32:{n:"PtgArray",f:LK},33:{n:"PtgFunc",f:HK},34:{n:"PtgFuncVar",f:qK},35:{n:"PtgName",f:rG},36:{n:"PtgRef",f:UK},37:{n:"PtgArea",f:AK},38:{n:"PtgMemArea",f:aG},39:{n:"PtgMemErr",f:cG},40:{n:"PtgMemNoMem",f:uG},41:{n:"PtgMemFunc",f:iG},42:{n:"PtgRefErr",f:oG},43:{n:"PtgAreaErr",f:CK},44:{n:"PtgRefN",f:$K},45:{n:"PtgAreaN",f:PK},46:{n:"PtgMemAreaN",f:EG},47:{n:"PtgMemNoMemN",f:AG},57:{n:"PtgNameX",f:nG},58:{n:"PtgRef3d",f:zK},59:{n:"PtgArea3d",f:jK},60:{n:"PtgRefErr3d",f:lG},61:{n:"PtgAreaErr3d",f:TK},255:{}},CG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},TG={1:{n:"PtgElfLel",f:d8},2:{n:"PtgElfRw",f:yG},3:{n:"PtgElfCol",f:fG},6:{n:"PtgElfRwV",f:wG},7:{n:"PtgElfColV",f:mG},10:{n:"PtgElfRadical",f:gG},11:{n:"PtgElfRadicalS",f:vG},13:{n:"PtgElfColS",f:hG},15:{n:"PtgElfColSV",f:pG},16:{n:"PtgElfRadicalLel",f:xG},25:{n:"PtgList",f:NG},29:{n:"PtgSxName",f:SG},255:{}},PG={0:{n:"PtgAttrNoop",f:jG},1:{n:"PtgAttrSemi",f:OK},2:{n:"PtgAttrIf",f:RK},4:{n:"PtgAttrChoose",f:FK},8:{n:"PtgAttrGoto",f:DK},16:{n:"PtgAttrSum",f:VK},32:{n:"PtgAttrBaxcel",f:kk},33:{n:"PtgAttrBaxcel",f:kk},64:{n:"PtgAttrSpace",f:MK},65:{n:"PtgAttrSpaceSemi",f:BK},128:{n:"PtgAttrIfError",f:IK},255:{}};function Rp(e,t,r,n){if(n.biff<8)return Us(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=tG(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=eG(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Us(e,t)),a}function Ip(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=_k[a]||_k[CG[a]],(a===24||a===25)&&(s=(a===24?TG:PG)[e[e.l+1]]),!s||!s.f?Us(e,t):i.push([s.n,s.f(e,t,r)]);return i}function LG(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var FG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function DG(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function f8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ek(e,t,r){var n=f8(e,t,r);return n=="#REF"?n:DG(n,r)}function Ps(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,d,f=0,p=0,h,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",x=0,w=e[0].length;x<w;++x){var b=e[0][x];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=dn(" ",e[0][g][1][1]);break;case 1:y=dn("\r",e[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+FG[b[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=d0(b[1][1],i,s),o.push(f0(d,a));break;case"PtgRefN":d=r?d0(b[1][1],r,s):b[1][1],o.push(f0(d,a));break;case"PtgRef3d":f=b[1][1],d=d0(b[1][2],i,s),m=Ek(n,f,s),o.push(m+"!"+f0(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=b[1][0],A=b[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,A==="User"&&(A=P.shift()),o.push(A+"("+P.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":h=ik(b[1][1],r?{s:r}:i,s),o.push(xv(h,s));break;case"PtgArea":h=ik(b[1][1],i,s),o.push(xv(h,s));break;case"PtgArea3d":f=b[1][1],h=b[1][2],m=Ek(n,f,s),o.push(m+"!"+xv(h,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=b[1][2];var j=(n.names||[])[p-1]||(n[0]||[])[p],D=j?j.Name:"SH33TJSNAME"+String(p);D&&D.slice(0,6)=="_xlfn."&&!s.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var E=b[1][1];p=b[1][2];var I;if(s.biff<=5)E<0&&(E=-E),n[E]&&(I=n[E][p]);else{var _="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][p]&&n[E][p].itab>0&&(_=n.SheetNames[n[E][p].itab-1]+"!"):_=n.SheetNames[p-1]+"!"),n[E]&&n[E][p])_+=n[E][p].Name;else if(n[0]&&n[0][p])_+=n[0][p].Name;else{var L=(f8(n,E,s)||"").split(";;");L[p-1]?_=L[p-1]:_+="SH33TJSERRX"}o.push(_);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var M="(",K=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:M=dn(" ",e[0][g][1][1])+M;break;case 3:M=dn("\r",e[0][g][1][1])+M;break;case 4:K=dn(" ",e[0][g][1][1])+K;break;case 5:K=dn("\r",e[0][g][1][1])+K;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(M+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:b[1][1],r:b[1][0]};var Z={c:r.c,r:r.r};if(n.sharedf[Xt(d)]){var ae=n.sharedf[Xt(d)];o.push(Ps(ae,i,Z,n,s))}else{var he=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ps(u[1],i,Z,n,s)),he=!0;break}he||o.push(b[1])}break;case"PtgArray":o.push("{"+LG(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&re.indexOf(e[0][x][0])==-1){b=e[0][g];var U=!0;switch(b[1][0]){case 4:U=!1;case 0:y=dn(" ",b[1][1]);break;case 5:U=!1;case 1:y=dn("\r",b[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((U?y:"")+o.pop()+(U?"":y)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function RG(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Us(e,t-2)];var o=Ip(e,i,r);return t!==i+s&&(a=Rp(e,t-i-s,o,r)),e.l=n,[o,a]}function IG(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Us(e,t-2)];var o=Ip(e,i,r);return t!==i+s&&(a=Rp(e,t-i-s,o,r)),e.l=n,[o,a]}function OG(e,t,r,n){var s=e.l+t,a=Ip(e,n,r),i;return s!==e.l&&(i=Rp(e,s-e.l,a,r)),[a,i]}function MG(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Ip(e,a,r);return a==65535?[[],Us(e,t-2)]:(t!==a+2&&(s=Rp(e,n-a-2,i,r)),[i,s])}function BG(e){var t;if(al(e,e.l+6)!==65535)return[Rs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function wv(e,t,r){var n=e.l+t,s=Ao(e);r.biff==2&&++e.l;var a=BG(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=IG(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Bx(e,t,r){var n=e.read_shift(4),s=Ip(e,n,r),a=e.read_shift(4),i=a>0?Rp(e,a,s,r):null;return[s,i]}var UG=Bx,Ux=Bx,$G=Bx,zG=Bx,HG={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},h8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Ak(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function bv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var g0={},of={};function x0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function p8(e,t,r,n,s,a){try{n.cellNF&&(e.z=er[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=ss(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(er[t]==null&&ju(Wz[t]||"General",t),e.t==="e")e.w=e.w||ed[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sp(e.v);else if(e.t==="d"){var i=sa(e.v);(i|0)===i?e.w=i.toString(10):e.w=sp(i)}else{if(e.v===void 0)return"";e.w=Uu(e.v,of)}else e.t==="d"?e.w=oi(t,sa(e.v),of):e.w=oi(t,e.v,of)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=z1(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=z1(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function WG(e,t){var r=hn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=mr(r))}var VG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,KG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,GG=/<(?:\w:)?hyperlink [^>]*>/mg,YG=/"(\w*:\w*)"/,XG=/<(?:\w:)?col\b[^>]*[\/]?>/g,JG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,QG=/<(?:\w:)?pageMargins[^>]*\/>/g,m8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,ZG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,eY=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function tY(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(KG);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var p=u.match(m8);p?l4(p[0],o,s,r):(p=u.match(ZG))&&rY(p[0],p[1]||"",o,s,r);var h=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=u.slice(h,h+50).match(YG);m&&WG(o,m[1])}var g=u.match(eY);g&&g[1]&&lY(g[1],s);var y=[];if(t.cellStyles){var x=u.match(XG);x&&aY(y,x)}f&&cY(f[1],o,t,l,a,i);var w=d.match(JG);w&&(o["!autofilter"]=iY(w[0]));var b=[],N=d.match(VG);if(N)for(h=0;h!=N.length;++h)b[h]=hn(N[h].slice(N[h].indexOf('"')+1));var A=d.match(GG);A&&nY(o,A,n);var P=d.match(QG);if(P&&(o["!margins"]=sY($t(P[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=mr(l)),t.sheetRows>0&&o["!ref"]){var j=hn(o["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>l.e.r&&(j.e.r=l.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>l.e.c&&(j.e.c=l.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),o["!fullref"]=o["!ref"],o["!ref"]=mr(j))}return y.length>0&&(o["!cols"]=y),b.length>0&&(o["!merges"]=b),o}function l4(e,t,r,n){var s=$t(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=yr(zr(s.codeName)))}function rY(e,t,r,n,s){l4(e.slice(0,e.indexOf(">")),r,n,s)}function nY(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=$t(zr(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+yr(a.location))):(a.Target="#"+yr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=hn(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Xt({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function sY(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function aY(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=$t(t[n],!0);s.hidden&&(s.hidden=Jr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,i4(s.width)),Lf(s);a<=i;)e[a++]=vs(s)}}function iY(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var oY=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function lY(e,t){t.Views||(t.Views=[{}]),(e.match(oY)||[]).forEach(function(r,n){var s=$t(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Jr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var cY=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=ap("v"),i=ap("f");return function(l,u,d,f,p,h){for(var m=0,g="",y=[],x=[],w=0,b=0,N=0,A="",P,j,D=0,E=0,I,_,L=0,M=0,K=Array.isArray(h.CellXf),Z,ae=[],he=[],re=Array.isArray(u),U=[],ue={},pe=!1,C=!!d.sheetStubs,R=l.split(t),B=0,O=R.length;B!=O;++B){g=R[B].trim();var Y=g.length;if(Y!==0){var ie=0;e:for(m=0;m<Y;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(d&&d.cellStyles){if(j=$t(g.slice(ie,m),!0),D=j.r!=null?parseInt(j.r,10):D+1,E=-1,d.sheetRows&&d.sheetRows<D)continue;ue={},pe=!1,j.ht&&(pe=!0,ue.hpt=parseFloat(j.ht),ue.hpx=cp(ue.hpt)),j.hidden=="1"&&(pe=!0,ue.hidden=!0),j.outlineLevel!=null&&(pe=!0,ue.level=+j.outlineLevel),pe&&(U[D-1]=ue)}break;case"<":ie=m;break}if(ie>=m)break;if(j=$t(g.slice(ie,m),!0),D=j.r!=null?parseInt(j.r,10):D+1,E=-1,!(d.sheetRows&&d.sheetRows<D)){f.s.r>D-1&&(f.s.r=D-1),f.e.r<D-1&&(f.e.r=D-1),d&&d.cellStyles&&(ue={},pe=!1,j.ht&&(pe=!0,ue.hpt=parseFloat(j.ht),ue.hpx=cp(ue.hpt)),j.hidden=="1"&&(pe=!0,ue.hidden=!0),j.outlineLevel!=null&&(pe=!0,ue.level=+j.outlineLevel),pe&&(U[D-1]=ue)),y=g.slice(m).split(e);for(var me=0;me!=y.length&&y[me].trim().charAt(0)=="<";++me);for(y=y.slice(me),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(x=g.match(r),w=m,b=0,N=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,x!=null&&x.length===2){for(w=0,A=x[1],b=0;b!=A.length&&!((N=A.charCodeAt(b)-64)<1||N>26);++b)w=26*w+N;--w,E=w}else++E;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,j=$t(g.slice(0,b),!0),j.r||(j.r=Xt({r:D-1,c:E})),A=g.slice(b),P={t:""},(x=A.match(a))!=null&&x[1]!==""&&(P.v=yr(x[1])),d.cellFormula){if((x=A.match(i))!=null&&x[1]!==""){if(P.f=yr(zr(x[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=Sk(P.f)),x[0].indexOf('t="array"')>-1)P.F=(A.match(s)||[])[1],P.F.indexOf(":")>-1&&ae.push([hn(P.F),P.F]);else if(x[0].indexOf('t="shared"')>-1){_=$t(x[0]);var ge=yr(zr(x[1]));d.xlfn||(ge=Sk(ge)),he[parseInt(_.si,10)]=[_,ge,j.r]}}else(x=A.match(/<f[^>]*\/>/))&&(_=$t(x[0]),he[_.si]&&(P.f=wK(he[_.si][1],he[_.si][2],j.r)));var xe=Zs(j.r);for(b=0;b<ae.length;++b)xe.r>=ae[b][0].s.r&&xe.r<=ae[b][0].e.r&&xe.c>=ae[b][0].s.c&&xe.c<=ae[b][0].e.c&&(P.F=ae[b][1])}if(j.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(C)P.t="z";else continue;else P.t=j.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),P.t){case"n":if(P.v==""||P.v==null){if(!C)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!C)continue;P.t="z"}else I=g0[parseInt(P.v,10)],P.v=I.t,P.r=I.r,d.cellHTML&&(P.h=I.h);break;case"str":P.t="s",P.v=P.v!=null?zr(P.v):"",d.cellHTML&&(P.h=Yb(P.v));break;case"inlineStr":x=A.match(n),P.t="s",x!=null&&(I=a4(x[1]))?(P.v=I.t,d.cellHTML&&(P.h=I.h)):P.v="";break;case"b":P.v=Jr(P.v);break;case"d":d.cellDates?P.v=ss(P.v,1):(P.v=sa(ss(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=IT[P.v];break}if(L=M=0,Z=null,K&&j.s!==void 0&&(Z=h.CellXf[j.s],Z!=null&&(Z.numFmtId!=null&&(L=Z.numFmtId),d.cellStyles&&Z.fillId!=null&&(M=Z.fillId))),p8(P,L,M,d,p,h),d.cellDates&&K&&P.t=="n"&&qf(er[L])&&(P.t="d",P.v=Ox(P.v)),j.cm&&d.xlmeta){var Le=(d.xlmeta.Cell||[])[+j.cm-1];Le&&Le.type=="XLDAPR"&&(P.D=!0)}if(re){var z=Zs(j.r);u[z.r]||(u[z.r]=[]),u[z.r][z.c]=P}else u[j.r]=P}}}}U.length>0&&(u["!rows"]=U)}}();function uY(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var dY=Zu;function fY(){}function hY(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=RH(e),r}function pY(e){var t=ci(e);return[t]}function mY(e){var t=Qu(e);return[t]}function gY(e){var t=ci(e),r=e.read_shift(1);return[t,r,"b"]}function xY(e){var t=Qu(e),r=e.read_shift(1);return[t,r,"b"]}function vY(e){var t=ci(e),r=e.read_shift(1);return[t,r,"e"]}function yY(e){var t=Qu(e),r=e.read_shift(1);return[t,r,"e"]}function wY(e){var t=ci(e),r=e.read_shift(4);return[t,r,"s"]}function bY(e){var t=Qu(e),r=e.read_shift(4);return[t,r,"s"]}function NY(e){var t=ci(e),r=Rs(e);return[t,r,"n"]}function g8(e){var t=Qu(e),r=Rs(e);return[t,r,"n"]}function SY(e){var t=ci(e),r=r4(e);return[t,r,"n"]}function kY(e){var t=Qu(e),r=r4(e);return[t,r,"n"]}function _Y(e){var t=ci(e),r=e4(e);return[t,r,"is"]}function EY(e){var t=ci(e),r=Ms(e);return[t,r,"str"]}function AY(e){var t=Qu(e),r=Ms(e);return[t,r,"str"]}function jY(e,t,r){var n=e.l+t,s=ci(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=Ux(e,n-e.l,r);i[3]=Ps(o,null,s,r.supbooks,r)}else e.l=n;return i}function CY(e,t,r){var n=e.l+t,s=ci(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=Ux(e,n-e.l,r);i[3]=Ps(o,null,s,r.supbooks,r)}else e.l=n;return i}function TY(e,t,r){var n=e.l+t,s=ci(e);s.r=r["!row"];var a=Rs(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=Ux(e,n-e.l,r);i[3]=Ps(o,null,s,r.supbooks,r)}else e.l=n;return i}function PY(e,t,r){var n=e.l+t,s=ci(e);s.r=r["!row"];var a=Ms(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=Ux(e,n-e.l,r);i[3]=Ps(o,null,s,r.supbooks,r)}else e.l=n;return i}var LY=Zu;function FY(e,t){var r=e.l+t,n=Zu(e),s=t4(e),a=Ms(e),i=Ms(e),o=Ms(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function DY(){}function RY(e,t,r){var n=e.l+t,s=FT(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=UG(e,n-e.l,r);i[1]=o}else e.l=n;return i}function IY(e,t,r){var n=e.l+t,s=Zu(e),a=[s];if(r.cellFormula){var i=zG(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var OY=["left","right","top","bottom","header","footer"];function MY(e){var t={};return OY.forEach(function(r){t[r]=Rs(e)}),t}function BY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function UY(){}function $Y(){}function zY(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,p=!1,h,m,g,y,x,w,b,N,A,P=[];o.biff=12,o["!row"]=0;var j=0,D=!1,E=[],I={},_=o.supbooks||s.supbooks||[[]];if(_.sharedf=I,_.arrayf=E,_.SheetNames=s.SheetNames||s.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=_,s.Names))for(var L=0;L<s.Names.length;++L)_[0][L+1]=s.Names[L];var M=[],K=[],Z=!1;W1[16]={n:"BrtShortReal",f:g8};var ae;if(kl(e,function(U,ue,pe){if(!p)switch(pe){case 148:u=U;break;case 0:h=U,o.sheetRows&&o.sheetRows<=h.r&&(p=!0),N=ys(y=h.r),o["!row"]=h.r,(U.hidden||U.hpt||U.level!=null)&&(U.hpt&&(U.hpx=cp(U.hpt)),K[U.r]=U);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:U[2]},U[2]){case"n":m.v=U[1];break;case"s":b=g0[U[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!U[1];break;case"e":m.v=U[1],o.cellText!==!1&&(m.w=ed[m.v]);break;case"str":m.t="s",m.v=U[1];break;case"is":m.t="s",m.v=U[1].t;break}if((g=i.CellXf[U[0].iStyleRef])&&p8(m,g.numFmtId,null,o,a,i),x=U[0].c==-1?x+1:U[0].c,o.dense?(l[y]||(l[y]=[]),l[y][x]=m):l[Yn(x)+N]=m,o.cellFormula){for(D=!1,j=0;j<E.length;++j){var C=E[j];h.r>=C[0].s.r&&h.r<=C[0].e.r&&x>=C[0].s.c&&x<=C[0].e.c&&(m.F=mr(C[0]),D=!0)}!D&&U.length>3&&(m.f=U[3])}if(d.s.r>h.r&&(d.s.r=h.r),d.s.c>x&&(d.s.c=x),d.e.r<h.r&&(d.e.r=h.r),d.e.c<x&&(d.e.c=x),o.cellDates&&g&&m.t=="n"&&qf(er[g.numFmtId])){var R=fu(m.v);R&&(m.t="d",m.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;m={t:"z",v:void 0},x=U[0].c==-1?x+1:U[0].c,o.dense?(l[y]||(l[y]=[]),l[y][x]=m):l[Yn(x)+N]=m,d.s.r>h.r&&(d.s.r=h.r),d.s.c>x&&(d.s.c=x),d.e.r<h.r&&(d.e.r=h.r),d.e.c<x&&(d.e.c=x),ae&&(ae.type=="XLDAPR"&&(m.D=!0),ae=void 0);break;case 176:P.push(U);break;case 49:ae=((o.xlmeta||{}).Cell||[])[U-1];break;case 494:var B=n["!id"][U.relId];for(B?(U.Target=B.Target,U.loc&&(U.Target+="#"+U.loc),U.Rel=B):U.relId==""&&(U.Target="#"+U.loc),y=U.rfx.s.r;y<=U.rfx.e.r;++y)for(x=U.rfx.s.c;x<=U.rfx.e.c;++x)o.dense?(l[y]||(l[y]=[]),l[y][x]||(l[y][x]={t:"z",v:void 0}),l[y][x].l=U):(w=Xt({c:x,r:y}),l[w]||(l[w]={t:"z",v:void 0}),l[w].l=U);break;case 426:if(!o.cellFormula)break;E.push(U),A=o.dense?l[y][x]:l[Yn(x)+N],A.f=Ps(U[1],d,{r:h.r,c:x},_,o),A.F=mr(U[0]);break;case 427:if(!o.cellFormula)break;I[Xt(U[0].s)]=U[1],A=o.dense?l[y][x]:l[Yn(x)+N],A.f=Ps(U[1],d,{r:h.r,c:x},_,o);break;case 60:if(!o.cellStyles)break;for(;U.e>=U.s;)M[U.e--]={width:U.w/256,hidden:!!(U.flags&1),level:U.level},Z||(Z=!0,i4(U.w/256)),Lf(M[U.e+1]);break;case 161:l["!autofilter"]={ref:mr(U)};break;case 476:l["!margins"]=U;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),U.name&&(s.Sheets[r].CodeName=U.name),(U.above||U.left)&&(l["!outline"]={above:U.above,left:U.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),U.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!ue.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=mr(u||d)),o.sheetRows&&l["!ref"]){var he=hn(l["!ref"]);o.sheetRows<=+he.e.r&&(he.e.r=o.sheetRows-1,he.e.r>d.e.r&&(he.e.r=d.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>d.e.c&&(he.e.c=d.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),l["!fullref"]=l["!ref"],l["!ref"]=mr(he))}return P.length>0&&(l["!merges"]=P),M.length>0&&(l["!cols"]=M),K.length>0&&(l["!rows"]=K),l}function HY(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=yr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function qY(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var p=HY(f);d.s.r=d.s.c=0,d.e.c=o,u=Yn(o),p[0].forEach(function(h,m){i[u+ys(m)]={t:"n",v:h,z:p[1]},l=m}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=mr(d)),i}function WY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(m8);return o&&l4(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function VY(e,t){e.l+=10;var r=Ms(e);return{name:r}}function KY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return kl(e,function(l,u,d){switch(d){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var x8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],GY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],YY=[],XY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function jk(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Jr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Ck(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Jr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function v8(e){Ck(e.WBProps,x8),Ck(e.CalcPr,XY),jk(e.WBView,GY),jk(e.Sheets,YY),of.date1904=Jr(e.WBProps.date1904)}var JY="][*?/\\".split("");function QY(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return JY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var ZY=/<\w+:workbook/;function eX(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(zs,function(l,u){var d=$t(l);switch(Eo(d[0])){case"<?xml":break;case"<workbook":l.match(ZY)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":x8.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Jr(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=zr(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=yr(zr(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=zr(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Jr(d.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=yr(zr(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),vH.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return v8(r),r}function tX(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Uw(e),r.name=Ms(e),r}function rX(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Ms(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function nX(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sX(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=IH(e),i=$G(e,0,r),o=t4(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function aX(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],W1[16]={n:"BrtFRTArchID$",f:nX},kl(e,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Ps(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),v8(r),r.Names=a,r.supbooks=i,r}function iX(e,t,r){return t.slice(-4)===".bin"?aX(e,r):eX(e,r)}function oX(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?zY(e,n,r,s,a,i,o):tY(e,n,r,s,a,i,o)}function lX(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?KY(e,n,r,s,a):WY(e,n,r,s,a)}function cX(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?xK():vK()}function uX(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?mK():gK()}function dX(e,t,r,n){return t.slice(-4)===".bin"?LV(e,r,n):EV(e,r,n)}function fX(e,t,r){return s8(e,r)}function hX(e,t,r){return t.slice(-4)===".bin"?GW(e,r):VW(e,r)}function pX(e,t,r){return t.slice(-4)===".bin"?fK(e,r):oK(e,r)}function mX(e,t,r){return t.slice(-4)===".bin"?sK(e):rK(e)}function gX(e,t,r,n){return r.slice(-4)===".bin"?aK(e,t,r,n):void 0}function xX(e,t,r){return t.slice(-4)===".bin"?eK(e,t,r):tK(e,t,r)}var y8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,w8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(y8),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(w8),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function vX(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(y8),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(w8),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var v0;function yX(e,t){var r=v0[e]||yr(e);return r==="General"?Uu(t):oi(r,t)}function wX(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Jr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=ss(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[yr(t)]=s}function bX(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ed[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sp(e.v):e.w=Uu(e.v):e.w=yX(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=v0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&qf(n)){var s=fu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function NX(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=wV[n.Pattern]||n.Pattern)}e[t.ID]=t}function SX(e,t,r,n,s,a,i,o,l,u){var d="General",f=n.StyleID,p={};u=u||{};var h=[],m=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&h.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Jr(e);break;case"String":n.t="s",n.r=JS(yr(e)),n.v=e.indexOf("<")>-1?yr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(ss(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=yr(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=IT[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=JS(t||e));break}if(bX(n,d,u),u.cellFormula!==!1)if(n.Formula){var g=yr(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=af(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=af("RC:RC",s):n.ArrayRange&&(n.F=af(n.ArrayRange,s),l.push([hn(n.F),n.F]))}else for(m=0;m<l.length;++m)s.r>=l[m][0].s.r&&s.r<=l[m][0].e.r&&s.c>=l[m][0].s.c&&s.c<=l[m][0].e.c&&(n.F=l[m][1]);u.cellStyles&&(h.forEach(function(y){!p.patternType&&y.patternType&&(p.patternType=y.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function kX(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Nv(e,t){var r=t||{};lT();var n=qh(Xb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=zr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=vs(r);return i.type="string",op.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(st){s.indexOf("<"+st)>=0&&(a=!0)}),a)return FX(n,r);v0={"General Number":"General","General Date":er[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":er[15],"Short Date":er[14],"Long Time":er[19],"Medium Time":er[18],"Short Time":er[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:er[2],Standard:er[4],Percent:er[10],Scientific:er[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},f=[],p=r.dense?[]:{},h="",m={},g={},y=xi('<Data ss:Type="String">'),x=0,w=0,b=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},P={},j="",D=0,E=[],I={},_={},L=0,M=[],K=[],Z={},ae=[],he,re=!1,U=[],ue=[],pe={},C=0,R=0,B={Sheets:[],WBProps:{date1904:!1}},O={};ip.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Y="";o=ip.exec(n);)switch(o[3]=(Y=o[3]).toLowerCase()){case"data":if(Y=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?SX(n.slice(x,o.index),j,y,l[l.length-1][0]=="comment"?Z:m,{c:w,r:b},A,ae[w],g,U,r):(j="",y=xi(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(m.c=K),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(p[b]||(p[b]=[]),p[b][w]=m):p[Yn(w)+ys(b)]=m),m.HRef&&(m.l={Target:yr(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(C=w+(parseInt(m.MergeAcross,10)|0),R=b+(parseInt(m.MergeDown,10)|0),E.push({s:{c:w,r:b},e:{c:C,r:R}})),!r.sheetStubs)m.MergeAcross?w=C+1:++w;else if(m.MergeAcross||m.MergeDown){for(var ie=w;ie<=C;++ie)for(var me=b;me<=R;++me)(ie>w||me>b)&&(r.dense?(p[me]||(p[me]=[]),p[me][ie]={t:"z"}):p[Yn(ie)+ys(me)]={t:"z"});w=C+1}else++w;else m=vX(o[0]),m.Index&&(w=+m.Index-1),w<N.s.c&&(N.s.c=w),w>N.e.c&&(N.e.c=w),o[0].slice(-2)==="/>"&&++w,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<N.s.r&&(N.s.r=b),b>N.e.r&&(N.e.r=b),o[0].slice(-2)==="/>"&&(g=xi(o[0]),g.Index&&(b=+g.Index-1)),w=0,++b):(g=xi(o[0]),g.Index&&(b=+g.Index-1),pe={},(g.AutoFitHeight=="0"||g.Height)&&(pe.hpx=parseInt(g.Height,10),pe.hpt=n8(pe.hpx),ue[b]=pe),g.Hidden=="1"&&(pe.hidden=!0,ue[b]=pe));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(h),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(p["!ref"]=mr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(p["!fullref"]=p["!ref"],N.e.r=r.sheetRows-1,p["!ref"]=mr(N))),E.length&&(p["!merges"]=E),ae.length>0&&(p["!cols"]=ae),ue.length>0&&(p["!rows"]=ue),d[h]=p}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=w=0,l.push([o[3],!1]),u=xi(o[0]),h=yr(u.Name),p=r.dense?[]:{},E=[],U=[],ue=[],O={name:h,Hidden:0},B.Sheets.push(O);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),ae=[],re=!1}break;case"style":o[1]==="/"?NX(A,P,r):P=xi(o[0]);break;case"numberformat":P.nf=yr(xi(o[0]).Format||"General"),v0[P.nf]&&(P.nf=v0[P.nf]);for(var ge=0;ge!=392&&er[ge]!=P.nf;++ge);if(ge==392){for(ge=57;ge!=392;++ge)if(er[ge]==null){ju(P.nf,ge);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(he=xi(o[0]),he.Hidden&&(he.hidden=!0,delete he.Hidden),he.Width&&(he.wpx=parseInt(he.Width,10)),!re&&he.wpx>10){re=!0,Js=t8;for(var xe=0;xe<ae.length;++xe)ae[xe]&&Lf(ae[xe])}re&&Lf(he),ae[he.Index-1||ae.length]=he;for(var Le=0;Le<+he.Span;++Le)ae[ae.length]=vs(he);break;case"namedrange":if(o[1]==="/")break;B.Names||(B.Names=[]);var z=$t(o[0]),Re={Name:z.Name,Ref:af(z.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(Re.Sheet=B.Sheets.length-1),B.Names.push(Re);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?j+=n.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=xi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?oq(I,Y,n.slice(L,o.index)):L=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));kX(Z),K.push(Z)}else l.push([o[3],!1]),u=xi(o[0]),Z={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Fe=xi(o[0]);p["!autofilter"]={ref:af(Fe.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Rk(n,r);var X=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(o[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:X=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(L,o.index)){case"SheetHidden":O.Hidden=1;break;case"SheetVeryHidden":O.Hidden=2;break}else L=o.index+o[0].length;break;case"header":p["!margins"]||x0(p["!margins"]={},"xlml"),isNaN(+$t(o[0]).Margin)||(p["!margins"].header=+$t(o[0]).Margin);break;case"footer":p["!margins"]||x0(p["!margins"]={},"xlml"),isNaN(+$t(o[0]).Margin)||(p["!margins"].footer=+$t(o[0]).Margin);break;case"pagemargins":var Oe=$t(o[0]);p["!margins"]||x0(p["!margins"]={},"xlml"),isNaN(+Oe.Top)||(p["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(p["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(p["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(p["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:X=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:X=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:X=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:X=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1;break}if(X||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?wX(_,Y,M,n.slice(L,o.index)):(M=o,L=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Me={};return!r.bookSheets&&!r.bookProps&&(Me.Sheets=d),Me.SheetNames=f,Me.Workbook=B,Me.SSF=vs(er),Me.Props=I,Me.Custprops=_,Me}function qw(e,t){switch(d4(t=t||{}),t.type||"base64"){case"base64":return Nv(Oa(e),t);case"binary":case"buffer":case"file":return Nv(e,t);case"array":return Nv(Ju(e),t)}}function _X(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=BH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=UH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var EX=[60,1084,2066,2165,2175];function AX(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=al(r,r.l),u=Ww[l],d=0;u!=null&&EX.indexOf(l)>-1;)a=al(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=Ww[l=al(r,r.l)];var f=tc(i);hs(f,0);var p=0;f.lens=[];for(var h=0;h<i.length;++h)f.lens.push(p),p+=i[h].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function to(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=er[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ed[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=sp(e.v):e.w=Uu(e.v):e.w=oi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&qf(er[n]||String(n))){var s=fu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function tg(e,t,r){return{v:e,ixfe:t,t:r}}function jX(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],u="",d={},f,p="",h,m,g,y,x={},w=[],b,N,A=[],P=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},E=function(it){return it<8?Cu[it]:it<64&&P[it-8]||Cu[it]},I=function(it,ot,ir){var Ft=ot.XF.data;if(!(!Ft||!Ft.patternType||!ir||!ir.cellStyles)){ot.s={},ot.s.patternType=Ft.patternType;var Ot;(Ot=lp(E(Ft.icvFore)))&&(ot.s.fgColor={rgb:Ot}),(Ot=lp(E(Ft.icvBack)))&&(ot.s.bgColor={rgb:Ot})}},_=function(it,ot,ir){if(!(pe>1)&&!(ir.sheetRows&&it.r>=ir.sheetRows)){if(ir.cellStyles&&ot.XF&&ot.XF.data&&I(it,ot,ir),delete ot.ixfe,delete ot.XF,f=it,p=Xt(it),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),it.r<i.s.r&&(i.s.r=it.r),it.c<i.s.c&&(i.s.c=it.c),it.r+1>i.e.r&&(i.e.r=it.r+1),it.c+1>i.e.c&&(i.e.c=it.c+1),ir.cellFormula&&ot.f){for(var Ft=0;Ft<w.length;++Ft)if(!(w[Ft][0].s.c>it.c||w[Ft][0].s.r>it.r)&&!(w[Ft][0].e.c<it.c||w[Ft][0].e.r<it.r)){ot.F=mr(w[Ft][0]),(w[Ft][0].s.c!=it.c||w[Ft][0].s.r!=it.r)&&delete ot.f,ot.f&&(ot.f=""+Ps(w[Ft][1],i,it,U,L));break}}ir.dense?(s[it.r]||(s[it.r]=[]),s[it.r][it.c]=ot):s[p]=ot}},L={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(L.password=t.password);var M,K=[],Z=[],ae=[],he=[],re=!1,U=[];U.SheetNames=L.snames,U.sharedf=L.sharedf,U.arrayf=L.arrayf,U.names=[],U.XTI=[];var ue=0,pe=0,C=0,R=[],B=[],O;L.codepage=1200,Li(1200);for(var Y=!1;e.l<e.length-1;){var ie=e.l,me=e.read_shift(2);if(me===0&&ue===10)break;var ge=e.l===e.length?0:e.read_shift(2),xe=Ww[me];if(xe&&xe.f){if(t.bookSheets&&ue===133&&me!==133)break;if(ue=me,xe.r===2||xe.r==12){var Le=e.read_shift(2);if(ge-=2,!L.enc&&Le!==me&&((Le&255)<<8|Le>>8)!==me)throw new Error("rt mismatch: "+Le+"!="+me);xe.r==12&&(e.l+=10,ge-=10)}var z={};if(me===10?z=xe.f(e,ge,L):z=AX(me,xe,e,ge,L),pe==0&&[9,521,1033,2057].indexOf(ue)===-1)continue;switch(me){case 34:r.opts.Date1904=j.WBProps.date1904=z;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(L.enc||(e.l=0),L.enc=z,!t.password)throw new Error("File is password-protected");if(z.valid==null)throw new Error("Encryption scheme unsupported");if(!z.valid)throw new Error("Password is incorrect");break;case 92:L.lastuser=z;break;case 66:var Re=Number(z);switch(Re){case 21010:Re=1200;break;case 32768:Re=1e4;break;case 32769:Re=1252;break}Li(L.codepage=Re),Y=!0;break;case 317:L.rrtabid=z;break;case 25:L.winlocked=z;break;case 439:r.opts.RefreshAll=z;break;case 12:r.opts.CalcCount=z;break;case 16:r.opts.CalcDelta=z;break;case 17:r.opts.CalcIter=z;break;case 13:r.opts.CalcMode=z;break;case 14:r.opts.CalcPrecision=z;break;case 95:r.opts.CalcSaveRecalc=z;break;case 15:L.CalcRefMode=z;break;case 2211:r.opts.FullCalc=z;break;case 129:z.fDialog&&(s["!type"]="dialog"),z.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),z.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:A.push(z);break;case 430:U.push([z]),U[U.length-1].XTI=[];break;case 35:case 547:U[U.length-1].push(z);break;case 24:case 536:O={Name:z.Name,Ref:Ps(z.rgce,i,null,U,L)},z.itab>0&&(O.Sheet=z.itab-1),U.names.push(O),U[0]||(U[0]=[],U[0].XTI=[]),U[U.length-1].push(z),z.Name=="_xlnm._FilterDatabase"&&z.itab>0&&z.rgce&&z.rgce[0]&&z.rgce[0][0]&&z.rgce[0][0][0]=="PtgArea3d"&&(B[z.itab-1]={ref:mr(z.rgce[0][0][1][2])});break;case 22:L.ExternCount=z;break;case 23:U.length==0&&(U[0]=[],U[0].XTI=[]),U[U.length-1].XTI=U[U.length-1].XTI.concat(z),U.XTI=U.XTI.concat(z);break;case 2196:if(L.biff<8)break;O!=null&&(O.Comment=z[1]);break;case 18:s["!protect"]=z;break;case 19:z!==0&&L.WTF&&console.error("Password verifier: "+z);break;case 133:a[z.pos]=z,L.snames.push(z.name);break;case 10:{if(--pe)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=mr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Fe=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=mr(i),i.e.r=Fe}i.e.r++,i.e.c++}K.length>0&&(s["!merges"]=K),Z.length>0&&(s["!objects"]=Z),ae.length>0&&(s["!cols"]=ae),he.length>0&&(s["!rows"]=he),j.Sheets.push(D)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(L.biff===8&&(L.biff={9:2,521:3,1033:4}[me]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[z.BIFFVer]||8),L.biffguess=z.BIFFVer==0,z.BIFFVer==0&&z.dt==4096&&(L.biff=5,Y=!0,Li(L.codepage=28591)),L.biff==8&&z.BIFFVer==0&&z.dt==16&&(L.biff=2),pe++)break;if(s=t.dense?[]:{},L.biff<8&&!Y&&(Y=!0,Li(L.codepage=t.codepage||1252)),L.biff<5||z.BIFFVer==0&&z.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var X={pos:e.l-ge,name:u};a[X.pos]=X,L.snames.push(u)}else u=(a[ie]||{name:""}).name;z.dt==32&&(s["!type"]="chart"),z.dt==64&&(s["!type"]="macro"),K=[],Z=[],L.arrayf=w=[],ae=[],he=[],re=!1,D={Hidden:(a[ie]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[z.r]||[])[z.c]:s[Xt({c:z.c,r:z.r})])&&++z.c,b={ixfe:z.ixfe,XF:A[z.ixfe]||{},v:z.val,t:"n"},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t);break;case 5:case 517:b={ixfe:z.ixfe,XF:A[z.ixfe],v:z.val,t:z.t},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t);break;case 638:b={ixfe:z.ixfe,XF:A[z.ixfe],v:z.rknum,t:"n"},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t);break;case 189:for(var Oe=z.c;Oe<=z.C;++Oe){var Me=z.rkrec[Oe-z.c][0];b={ixfe:Me,XF:A[Me],v:z.rkrec[Oe-z.c][1],t:"n"},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:Oe,r:z.r},b,t)}break;case 6:case 518:case 1030:{if(z.val=="String"){o=z;break}if(b=tg(z.val,z.cell.ixfe,z.tt),b.XF=A[b.ixfe],t.cellFormula){var st=z.formula;if(st&&st[0]&&st[0][0]&&st[0][0][0]=="PtgExp"){var Ue=st[0][0][1][0],xt=st[0][0][1][1],tt=Xt({r:Ue,c:xt});x[tt]?b.f=""+Ps(z.formula,i,z.cell,U,L):b.F=((t.dense?(s[Ue]||[])[xt]:s[tt])||{}).F}else b.f=""+Ps(z.formula,i,z.cell,U,L)}C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_(z.cell,b,t),o=z}break;case 7:case 519:if(o)o.val=z,b=tg(z,o.cell.ixfe,"s"),b.XF=A[b.ixfe],t.cellFormula&&(b.f=""+Ps(o.formula,i,o.cell,U,L)),C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_(o.cell,b,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(z);var gt=Xt(z[0].s);if(h=t.dense?(s[z[0].s.r]||[])[z[0].s.c]:s[gt],t.cellFormula&&h){if(!o||!gt||!h)break;h.f=""+Ps(z[1],i,z[0],U,L),h.F=mr(z[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;x[Xt(o.cell)]=z[0],h=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Xt(o.cell)],(h||{}).f=""+Ps(z[0],i,f,U,L)}}break;case 253:b=tg(l[z.isst].t,z.ixfe,"s"),l[z.isst].h&&(b.h=l[z.isst].h),b.XF=A[b.ixfe],C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:z.ixfe,XF:A[z.ixfe],t:"z"},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t));break;case 190:if(t.sheetStubs)for(var ct=z.c;ct<=z.C;++ct){var Mt=z.ixfe[ct-z.c];b={ixfe:Mt,XF:A[Mt],t:"z"},C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:ct,r:z.r},b,t)}break;case 214:case 516:case 4:b=tg(z.val,z.ixfe,"s"),b.XF=A[b.ixfe],C>0&&(b.z=R[b.ixfe>>8&63]),to(b,t,r.opts.Date1904),_({c:z.c,r:z.r},b,t);break;case 0:case 512:pe===1&&(i=z);break;case 252:l=z;break;case 1054:if(L.biff==4){R[C++]=z[1];for(var It=0;It<C+163&&er[It]!=z[1];++It);It>=163&&ju(z[1],C+163)}else ju(z[1],z[0]);break;case 30:{R[C++]=z;for(var Pt=0;Pt<C+163&&er[Pt]!=z;++Pt);Pt>=163&&ju(z,C+163)}break;case 229:K=K.concat(z);break;case 93:Z[z.cmo[0]]=L.lastobj=z;break;case 438:L.lastobj.TxO=z;break;case 127:L.lastobj.ImData=z;break;case 440:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)h=t.dense?(s[y]||[])[g]:s[Xt({c:g,r:y})],h&&(h.l=z[1]);break;case 2048:for(y=z[0].s.r;y<=z[0].e.r;++y)for(g=z[0].s.c;g<=z[0].e.c;++g)h=t.dense?(s[y]||[])[g]:s[Xt({c:g,r:y})],h&&h.l&&(h.l.Tooltip=z[1]);break;case 28:{if(L.biff<=5&&L.biff>=2)break;h=t.dense?(s[z[0].r]||[])[z[0].c]:s[Xt(z[0])];var Jt=Z[z[2]];h||(t.dense?(s[z[0].r]||(s[z[0].r]=[]),h=s[z[0].r][z[0].c]={t:"z"}):h=s[Xt(z[0])]={t:"z"},i.e.r=Math.max(i.e.r,z[0].r),i.s.r=Math.min(i.s.r,z[0].r),i.e.c=Math.max(i.e.c,z[0].c),i.s.c=Math.min(i.s.c,z[0].c)),h.c||(h.c=[]),m={a:z[1],t:Jt.TxO.t},h.c.push(m)}break;case 2173:XV(A[z.ixfe],z.ext);break;case 125:{if(!L.cellStyles)break;for(;z.e>=z.s;)ae[z.e--]={width:z.w/256,level:z.level||0,hidden:!!(z.flags&1)},re||(re=!0,i4(z.w/256)),Lf(ae[z.e+1])}break;case 520:{var Lt={};z.level!=null&&(he[z.r]=Lt,Lt.level=z.level),z.hidden&&(he[z.r]=Lt,Lt.hidden=!0),z.hpt&&(he[z.r]=Lt,Lt.hpt=z.hpt,Lt.hpx=cp(z.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||x0(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[me]]=z;break;case 161:s["!margins"]||x0(s["!margins"]={}),s["!margins"].header=z.header,s["!margins"].footer=z.footer;break;case 574:z.RTL&&(j.Views[0].RTL=!0);break;case 146:P=z;break;case 2198:M=z;break;case 140:N=z;break;case 442:u?D.CodeName=z||D.name:j.WBProps.CodeName=z||"ThisWorkbook";break}}else xe||console.error("Missing Info for XLS Record 0x"+me.toString(16)),e.l+=ge}return r.SheetNames=ko(a).sort(function(pt,it){return Number(pt)-Number(it)}).map(function(pt){return a[pt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&B.forEach(function(pt,it){r.Sheets[r.SheetNames[it]]["!autofilter"]=pt}),r.Strings=l,r.SSF=vs(er),L.enc&&(r.Encryption=L.enc),M&&(r.Themes=M),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),U.names.length>0&&(j.Names=U.names),r.Workbook=j,r}var Tk={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function CX(e,t,r){var n=pr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=hk(n,VH,Tk.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=pr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=hk(i,KH,Tk.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(MT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function b8(e,t){t||(t={}),d4(t),XC(),t.codepage&&Hb(t.codepage);var r,n;if(e.FullPaths){if(pr.find(e,"/encryption"))throw new Error("File is password-protected");r=pr.find(e,"!CompObj"),n=pr.find(e,"/Workbook")||pr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ti(Oa(e));break;case"binary":e=Ti(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}hs(e,0),n={content:e}}var s,a;if(r&&_X(r),t.bookProps&&!t.bookSheets)s={};else{var i=dr?"buffer":"array";if(n&&n.content)s=jX(n.content,t);else if((a=pr.find(e,"PerfectOffice_MAIN"))&&a.content)s=m0.to_workbook(a.content,(t.type=i,t));else if((a=pr.find(e,"NativeContent_MAIN"))&&a.content)s=m0.to_workbook(a.content,(t.type=i,t));else throw(a=pr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&pr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=pK(e))}var o={};return e.FullPaths&&CX(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var W1={0:{f:uY},1:{f:pY},2:{f:SY},3:{f:vY},4:{f:gY},5:{f:NY},6:{f:EY},7:{f:wY},8:{f:PY},9:{f:TY},10:{f:jY},11:{f:CY},12:{f:mY},13:{f:kY},14:{f:yY},15:{f:xY},16:{f:g8},17:{f:AY},18:{f:bY},19:{f:e4},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sX},40:{},42:{},43:{f:jV},44:{f:AV},45:{f:CV},46:{f:PV},47:{f:TV},48:{},49:{f:LH},50:{},51:{f:QV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:XT},62:{f:_Y},63:{f:nK},64:{f:UY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Us,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:BY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:hY},148:{f:dY,p:16},151:{f:DY},152:{},153:{f:rX},154:{},155:{},156:{f:tX},157:{},158:{},159:{T:1,f:KW},160:{T:-1},161:{T:1,f:Zu},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:LY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:JV},336:{T:-1},337:{f:ZV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Uw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:YT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:RY},427:{f:IY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:MY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:fY},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:FY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Uw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:dK},633:{T:1},634:{T:-1},635:{T:1,f:uK},636:{T:-1},637:{f:DH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:VY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$Y},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Ww={6:{f:wv},10:{f:Hl},12:{f:Ln},13:{f:Ln},14:{f:yn},15:{f:yn},16:{f:Rs},17:{f:yn},18:{f:yn},19:{f:Ln},20:{f:xk},21:{f:xk},23:{f:YT},24:{f:yk},25:{f:yn},26:{},27:{},28:{f:lW},29:{},34:{f:yn},35:{f:vk},38:{f:Rs},39:{f:Rs},40:{f:Rs},41:{f:Rs},42:{f:yn},43:{f:yn},47:{f:fV},49:{f:Hq},51:{f:Ln},60:{},61:{f:Uq},64:{f:yn},65:{f:zq},66:{f:Ln},77:{},80:{},81:{},82:{},85:{f:Ln},89:{},90:{},91:{},92:{f:Lq},93:{f:uW},94:{},95:{f:yn},96:{},97:{},99:{f:yn},125:{f:XT},128:{f:Zq},129:{f:Fq},130:{f:Ln},131:{f:yn},132:{f:yn},133:{f:Dq},134:{},140:{f:gW},141:{f:Ln},144:{},146:{f:vW},151:{},152:{},153:{},154:{},155:{},156:{f:Ln},157:{},158:{},160:{f:SW},161:{f:wW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Yq},190:{f:Xq},193:{f:Hl},197:{},198:{},199:{},200:{},201:{},202:{f:yn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ln},220:{},221:{f:yn},222:{},224:{f:Qq},225:{f:Pq},226:{f:Hl},227:{},229:{f:cW},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Rq},253:{f:qq},255:{f:Iq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:HT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yn},353:{f:Hl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:tW},431:{f:yn},432:{},433:{},434:{},437:{},438:{f:hW},439:{f:yn},440:{f:pW},441:{},442:{f:Fp},443:{},444:{f:Ln},445:{},446:{},448:{f:Hl},449:{f:Bq,r:2},450:{f:Hl},512:{f:mk},513:{f:NW},515:{f:eW},516:{f:Wq},517:{f:gk},519:{f:kW},520:{f:Oq},523:{},545:{f:wk},549:{f:pk},566:{},574:{f:$q},638:{f:Gq},659:{},1048:{},1054:{f:Vq},1084:{},1212:{f:aW},2048:{f:mW},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Qm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Hl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:yW,r:12},2173:{f:YV,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:sW,r:12},2197:{},2198:{f:HV,r:12},2199:{},2200:{},2201:{},2202:{f:iW,r:12},2203:{f:Hl},2204:{},2205:{},2206:{},2207:{},2211:{f:Mq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ln},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:bW},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:xW},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:mk},1:{},2:{f:jW},3:{f:AW},4:{f:EW},5:{f:gk},7:{f:CW},8:{},9:{f:Qm},11:{},22:{f:Ln},30:{f:Kq},31:{},32:{},33:{f:wk},36:{},37:{f:pk},50:{f:TW},62:{},52:{},67:{},68:{f:Ln},69:{},86:{},126:{},127:{f:_W},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PW},223:{},234:{},354:{},421:{},518:{f:wv},521:{f:Qm},536:{f:yk},547:{f:vk},561:{},579:{},1030:{f:wv},1033:{f:Qm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vi(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&TT(r)&&e.push(r)}}function Pk(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=eH(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,p=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var g=l[i].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(y!="<td"&&y!="<th")){var x=g.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var w=x[o].trim();if(w.match(/<t[dh]/i)){for(var b=w,N=0;b.charAt(0)=="<"&&(N=b.indexOf(">"))>-1;)b=b.slice(N+1);for(var A=0;A<m.length;++A){var P=m[A];P.s.c==d&&P.s.r<u&&u<=P.e.r&&(d=P.e.c+1,A=-1)}var j=$t(w.slice(0,w.indexOf(">")));p=j.colspan?+j.colspan:1,((f=+j.rowspan)>1||p>1)&&m.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+p-1}});var D=j.t||j["data-t"]||"";if(!b.length){d+=p;continue}if(b=xT(b),h.s.r>u&&(h.s.r=u),h.e.r<u&&(h.e.r=u),h.s.c>d&&(h.s.c=d),h.e.c<d&&(h.e.c=d),!b.length){d+=p;continue}var E={t:"s",v:b};r.raw||!b.trim().length||D=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(Oi(b))?isNaN(Pf(b).getDate())||(E={t:"d",v:ss(b)},r.cellDates||(E={t:"n",v:sa(E.v)}),E.z=r.dateNF||er[14]):E={t:"n",v:Oi(b)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=E):n[Xt({r:u,c:d})]=E,d+=p}}}}return n["!ref"]=mr(h),m.length&&(n["!merges"]=m),n}function TX(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Xt({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],p=f&&f.v!=null&&(f.h||Yb(f.w||(yl(f),f.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":f&&(h["data-t"]=f&&f.t||"z",f.v!=null&&(h["data-v"]=f.v),f.z!=null&&(h["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+f.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+d,a.push(gH("td",p,h))}}var m="<tr>";return m+a.join("")+"</tr>"}var PX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',LX="</body></html>";function FX(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bc(Pk(r[0],t),t);var n=h4();return r.forEach(function(s,a){p4(n,Pk(s,t),"Sheet"+(a+1))}),n}function DX(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function RX(e,t){var r=t||{},n=r.header!=null?r.header:PX,s=r.footer!=null?r.footer:LX,a=[n],i=Wf(e["!ref"]);r.dense=Array.isArray(e),a.push(DX(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(TX(e,i,o,r));return a.push("</table>"+s),a.join("")}function N8(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Zs(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=Wf(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],p=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,x=0,w=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<l;++m){var N=o[m];if(Lk(N)){if(n.display)continue;h[g]={hidden:!0}}var A=N.children;for(y=x=0;y<A.length;++y){var P=A[y];if(!(n.display&&Lk(P))){var j=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):xT(P.innerHTML),D=P.getAttribute("data-z")||P.getAttribute("z");for(p=0;p<f.length;++p){var E=f[p];E.s.c==x+a&&E.s.r<g+s&&g+s<=E.e.r&&(x=E.e.c+1-a,p=-1)}b=+P.getAttribute("colspan")||1,((w=+P.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:g+s,c:x+a},e:{r:g+s+(w||1)-1,c:x+a+(b||1)-1}});var I={t:"s",v:j},_=P.getAttribute("data-t")||P.getAttribute("t")||"";j!=null&&(j.length==0?I.t=_||"z":n.raw||j.trim().length==0||_=="s"||(j==="TRUE"?I={t:"b",v:!0}:j==="FALSE"?I={t:"b",v:!1}:isNaN(Oi(j))?isNaN(Pf(j).getDate())||(I={t:"d",v:ss(j)},n.cellDates||(I={t:"n",v:sa(I.v)}),I.z=n.dateNF||er[14]):I={t:"n",v:Oi(j)})),I.z===void 0&&D!=null&&(I.z=D);var L="",M=P.getElementsByTagName("A");if(M&&M.length)for(var K=0;K<M.length&&!(M[K].hasAttribute("href")&&(L=M[K].getAttribute("href"),L.charAt(0)!="#"));++K);L&&L.charAt(0)!="#"&&(I.l={Target:L}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][x+a]=I):e[Xt({c:x+a,r:g+s})]=I,u.e.c<x+a&&(u.e.c=x+a),x+=b}}++g}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,g-1+s),e["!ref"]=mr(u),g>=l&&(e["!fullref"]=mr((u.e.r=o.length-m+g-1+s,u))),e}function S8(e,t){var r=t||{},n=r.dense?[]:{};return N8(n,e,t)}function IX(e,t){return Bc(S8(e,t),t)}function Lk(e){var t="",r=OX(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function OX(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function MX(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=yr(t.replace(/<[^>]*>/g,""));return[r]}var Fk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function k8(e,t){var r=t||{},n=Xb(e),s=[],a,i,o={name:""},l="",u=0,d,f,p={},h=[],m=r.dense?[]:{},g,y,x={value:""},w="",b=0,N=[],A=-1,P=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,E={},I=[],_={},L=0,M=0,K=[],Z=1,ae=1,he=[],re={Names:[]},U={},ue=["",""],pe=[],C={},R="",B=0,O=!1,Y=!1,ie=0;for(ip.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=ip.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?m["!ref"]=mr(j):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(m["!fullref"]=m["!ref"],j.e.r=r.sheetRows-1,m["!ref"]=mr(j)),I.length&&(m["!merges"]=I),K.length&&(m["!rows"]=K),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),h.push(d.name),p[d.name]=m,Y=!1):g[0].charAt(g[0].length-2)!=="/"&&(d=$t(g[0],!1),A=P=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,m=r.dense?[]:{},I=[],K=[],Y=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"":if(g[1]==="/"){A+=Z,Z=1;break}if(f=$t(g[0],!1),f.?A=f.-1:A==-1&&(A=0),Z=+f["number-rows-repeated"]||1,Z<10)for(ie=0;ie<Z;++ie)D>0&&(K[A+ie]={level:D});P=-1;break;case"covered-table-cell":g[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][P]={t:"z"}):m[Xt({r:A,c:P})]={t:"z"}),w="",N=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++P,x=$t(g[0],!1),ae=parseInt(x["number-columns-repeated"]||"1",10),y={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(y.f=Ak(yr(x.formula))),(x.||x["value-type"])=="string"&&(y.t="s",y.v=yr(x["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][P]=y):m[Xt({r:A,c:P})]=y),P+=ae-1;else if(g[1]!=="/"){++P,w="",b=0,N=[],ae=1;var me=Z?A+Z-1:A;if(P>j.e.c&&(j.e.c=P),P<j.s.c&&(j.s.c=P),A<j.s.r&&(j.s.r=A),me>j.e.r&&(j.e.r=me),x=$t(g[0],!1),pe=[],C={},y={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=yr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(L=parseInt(x["number-matrix-rows-spanned"],10)||0,M=parseInt(x["number-matrix-columns-spanned"],10)||0,_={s:{r:A,c:P},e:{r:A+L-1,c:P+M-1}},y.F=mr(_),he.push([_,y.F])),x.formula)y.f=Ak(x.formula);else for(ie=0;ie<he.length;++ie)A>=he[ie][0].s.r&&A<=he[ie][0].e.r&&P>=he[ie][0].s.c&&P<=he[ie][0].e.c&&(y.F=he[ie][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(L=parseInt(x["number-rows-spanned"],10)||0,M=parseInt(x["number-columns-spanned"],10)||0,_={s:{r:A,c:P},e:{r:A+L-1,c:P+M-1}},I.push(_)),x["number-columns-repeated"]&&(ae=parseInt(x["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=Jr(x["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(x.value);break;case"percentage":y.t="n",y.v=parseFloat(x.value);break;case"currency":y.t="n",y.v=parseFloat(x.value);break;case"date":y.t="d",y.v=ss(x["date-value"]),r.cellDates||(y.t="n",y.v=sa(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=Jz(x["time-value"])/86400,r.cellDates&&(y.t="d",y.v=Ox(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(x.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",x["string-value"]!=null&&(w=yr(x["string-value"]),N=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(O=!1,y.t==="s"&&(y.v=w||"",N.length&&(y.R=N),O=b==0),U.Target&&(y.l=U),pe.length>0&&(y.c=pe,pe=[]),w&&r.cellText!==!1&&(y.w=w),O&&(y.t="z",delete y.v),(!O||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var ge=0;ge<Z;++ge){if(ae=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[A+ge]||(m[A+ge]=[]),m[A+ge][P]=ge==0?y:vs(y);--ae>0;)m[A+ge][P+ae]=vs(y);else for(m[Xt({r:A+ge,c:P})]=y;--ae>0;)m[Xt({r:A+ge,c:P+ae})]=vs(y);j.e.c<=P&&(j.e.c=P)}ae=parseInt(x["number-columns-repeated"]||"1",10),P+=ae-1,ae=0,y={},w="",N=[]}U={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;C.t=w,N.length&&(C.R=N),C.a=R,pe.push(C)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);R="",B=0,w="",b=0,N=[];break;case"creator":g[1]==="/"?R=n.slice(B,g.index):B=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);w="",b=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(E[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=$t(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=$t(g[0],!1),l+=Fk[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=$t(g[0],!1),l+=Fk[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":i=$t(g[0],!1),ue=bv(i["cell-range-address"]);var xe={Name:i.name,Ref:ue[0]+"!"+ue[1]};Y&&(xe.Sheet=h.length),re.Names.push(xe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!x||!x["string-value"])){var Le=MX(n.slice(b,g.index));w=(w.length>0?w+`
`:"")+Le[0]}else $t(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ue=bv($t(g[0])["target-range-address"]),p[ue[0]]["!autofilter"]={ref:ue[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(U=$t(g[0],!1),!U.href)break;U.Target=yr(U.href),delete U.href,U.Target.charAt(0)=="#"&&U.Target.indexOf(".")>-1?(ue=bv(U.Target.slice(1)),U.Target="#"+ue[0]+"!"+ue[1]):U.Target.match(/^\.\.[\\\/]/)&&(U.Target=U.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var z={Sheets:p,SheetNames:h,Workbook:re};return r.bookSheets&&delete z.Sheets,z}function Dk(e,t){t=t||{},Ya(e,"META-INF/manifest.xml")&&eq(Pn(e,"META-INF/manifest.xml"),t);var r=Pa(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=k8(zr(r),t);return Ya(e,"meta.xml")&&(n.Props=OT(Pn(e,"meta.xml"))),n}function Rk(e,t){return k8(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function c4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Vw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):zr(Ju(e))}function Kw(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Ik(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function BX(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function up(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Jn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Os(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=up(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=up(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function u4(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function UX(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=up(e,n),a=Os(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Jn(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Os(o.data),u=Jn(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Jn(a[3][0].data)>>>0>0),r.push(i)}return r}function $X(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=up(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Kw(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Kw(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function zX(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push($X(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Kw(t)}function HX(e,t,r,n){var s=c4(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Ik(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Ik(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[l]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(l>-1)f={t:"s",v:t[l]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function qX(e,t,r){var n=c4(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(l=BX(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function WX(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return HX(e,t,r,e[0]);case 5:return qX(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function _c(e){var t=Os(e);return up(t[1][0].data)}function Ok(e,t){var r=Os(t.data),n=Jn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Os(i.data),l=Jn(o[1][0].data)>>>0;switch(n){case 1:a[l]=Vw(o[3][0].data);break;case 8:{var u=e[_c(o[9][0].data)][0],d=Os(u.data),f=e[_c(d[1][0].data)][0],p=Jn(f.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var h=Os(f.data);a[l]=h[3].map(function(m){return Vw(m.data)}).join("")}break}}),a}function VX(e,t){var r,n,s,a,i,o,l,u,d,f,p,h,m,g,y=Os(e),x=Jn(y[1][0].data)>>>0,w=Jn(y[2][0].data)>>>0,b=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Jn(y[8][0].data)>0||!1,N,A;if((a=(s=y[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,A=(u=(l=y[6])==null?void 0:l[0])==null?void 0:u.data;else if((f=(d=y[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(h=(p=y[4])==null?void 0:p[0])==null?void 0:h.data,A=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=b?4:1,j=c4(N),D=[],E=0;E<N.length/2;++E){var I=j.getUint16(E*2,!0);I<65535&&D.push([E,I])}if(D.length!=w)throw"Expected ".concat(w," cells, found ").concat(D.length);var _=[];for(E=0;E<D.length-1;++E)_[D[E][0]]=A.subarray(D[E][1]*P,D[E+1][1]*P);return D.length>=1&&(_[D[D.length-1][0]]=A.subarray(D[D.length-1][1]*P)),{R:x,cells:_}}function KX(e,t){var r,n=Os(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Jn(n[7][0].data)>>>0>0?1:0:-1,a=u4(n[5],function(i){return VX(i,s)});return{nrows:Jn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function GX(e,t,r){var n,s=Os(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Jn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Jn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=mr(a);var i=Os(s[4][0].data),o=Ok(e,e[_c(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Ok(e,e[_c(i[17][0].data)][0]):[],u=Os(i[3][0].data),d=0;u[1].forEach(function(f){var p=Os(f.data),h=e[_c(p[2][0].data)][0],m=Jn(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=KX(e,h);g.data.forEach(function(y,x){y.forEach(function(w,b){var N=Xt({r:d+x,c:b}),A=WX(w,o,l);A&&(r[N]=A)})}),d+=g.nrows})}function YX(e,t){var r=Os(t.data),n={"!ref":"A1"},s=e[_c(r[2][0].data)],a=Jn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return GX(e,s[0],n),n}function XX(e,t){var r,n=Os(t.data),s={name:(r=n[1])!=null&&r[0]?Vw(n[1][0].data):"",sheets:[]},a=u4(n[2],_c);return a.forEach(function(i){e[i].forEach(function(o){var l=Jn(o.meta[1][0].data);l==6e3&&s.sheets.push(YX(e,o))})}),s}function JX(e,t){var r=h4(),n=Os(t.data),s=u4(n[1],_c);if(s.forEach(function(a){e[a].forEach(function(i){var o=Jn(i.meta[1][0].data);if(o==2){var l=XX(e,i);l.sheets.forEach(function(u,d){p4(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Sv(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=zX(l.content)}catch(f){return console.log("?? "+l.content.length+" "+(f.message||f))}var d;try{d=UX(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Jn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var d=Jn(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return JX(a,o)}function QX(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function d4(e){QX([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ZX(e){return Wd.WS.indexOf(e)>-1?"sheet":e==Wd.CS?"chart":e==Wd.DS?"dialog":e==Wd.MS?"macro":e&&e.length?e:"sheet"}function eJ(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,ZX(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function tJ(e,t,r,n,s,a,i,o,l,u,d,f){try{a[n]=h0(Pa(e,r,!0),t);var p=Pn(e,t),h;switch(o){case"sheet":h=oX(p,t,s,l,a[n],u,d,f);break;case"chart":if(h=lX(p,t,s,l,a[n],u,d,f),!h||!h["!drawel"])break;var m=Vh(h["!drawel"].Target,t),g=$w(m),y=iK(Pa(e,m,!0),h0(Pa(e,g,!0),m)),x=Vh(y,m),w=$w(x);h=qY(Pa(e,x,!0),x,l,h0(Pa(e,w,!0),x),u,h);break;case"macro":h=cX(p,t,s,l,a[n],u,d,f);break;case"dialog":h=uX(p,t,s,l,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var b=[];a&&a[n]&&ko(a[n]).forEach(function(N){var A="";if(a[n][N].Type==Wd.CMNT){A=Vh(a[n][N].Target,t);var P=pX(Pn(e,A,!0),A,l);if(!P||!P.length)return;Nk(h,P,!1)}a[n][N].Type==Wd.TCMNT&&(A=Vh(a[n][N].Target,t),b=b.concat(lK(Pn(e,A,!0),l)))}),b&&b.length&&Nk(h,b,!0,l.people||[])}catch(N){if(l.WTF)throw N}}function Va(e){return e.charAt(0)=="/"?e.slice(1):e}function rJ(e,t){if(lT(),t=t||{},d4(t),Ya(e,"META-INF/manifest.xml")||Ya(e,"objectdata.xml"))return Dk(e,t);if(Ya(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Sv<"u"){if(e.FileIndex)return Sv(e);var r=pr.utils.cfb_new();return YS(e).forEach(function(K){nH(r,K,rH(e,K))}),Sv(r)}throw new Error("Unsupported NUMBERS file")}if(!Ya(e,"[Content_Types].xml"))throw Ya(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ya(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=YS(e),s=QH(Pa(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Pn(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Pn(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(g0=[],s.sst)try{g0=hX(Pn(e,Va(s.sst)),s.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&s.themes.length&&(l=fX(Pa(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=dX(Pn(e,Va(s.style)),s.style,l,t))}s.links.map(function(K){try{var Z=h0(Pa(e,$w(Va(K))),K);return gX(Pn(e,Va(K)),Z,K,t)}catch{}});var d=iX(Pn(e,Va(s.workbooks[0])),s.workbooks[0],t),f={},p="";s.coreprops.length&&(p=Pn(e,Va(s.coreprops[0]),!0),p&&(f=OT(p)),s.extprops.length!==0&&(p=Pn(e,Va(s.extprops[0]),!0),p&&nq(p,f,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(p=Pa(e,Va(s.custprops[0]),!0),p&&(h=aq(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(Z){return Z.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(m.Props=f,m.Custprops=h),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var g={};t.bookDeps&&s.calcchain&&(g=mX(Pn(e,Va(s.calcchain)),s.calcchain));var y=0,x={},w,b;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var A=0;A!=N.length;++A)f.SheetNames[A]=N[A].name}var P=a?"bin":"xml",j=s.workbooks[0].lastIndexOf("/"),D=(s.workbooks[0].slice(0,j+1)+"_rels/"+s.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Ya(e,D)||(D="xl/_rels/workbook."+P+".rels");var E=h0(Pa(e,D,!0),D.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=xX(Pn(e,Va(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=cK(Pn(e,Va(s.people[0])),t)),E&&(E=eJ(E,d.Sheets));var I=Pn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=f.Worksheets;++y){var _="sheet";if(E&&E[y]?(w="xl/"+E[y][1].replace(/[\/]?xl\//,""),Ya(e,w)||(w=E[y][1]),Ya(e,w)||(w=D.replace(/_rels\/.*$/,"")+E[y][1]),_=E[y][2]):(w="xl/worksheets/sheet"+(y+1-I)+"."+P,w=w.replace(/sheet0\./,"sheet.")),b=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(f.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var L=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==y&&(L=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==f.SheetNames[y].toLowerCase()&&(L=1);if(!L)continue e}}tJ(e,w,b,f.SheetNames[y],y,x,i,_,t,d,l,u)}return m={Directory:s,Workbook:d,Props:f,Custprops:h,Deps:g,Sheets:i,SheetNames:f.SheetNames,Strings:g0,Styles:u,Themes:l,SSF:vs(er)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(K,Z){K=K.replace(/^Root Entry[\/]/,""),m.keys.push(K),m.files[K]=e.FileIndex[Z]}))),t&&t.bookVBA&&(s.vba.length>0?m.vbaraw=Pn(e,Va(s.vba[0]),!0):s.defaults&&s.defaults.bin===hK&&(m.vbaraw=Pn(e,"xl/vbaProject.bin",!0))),m}function nJ(e,t){var r=t||{},n="Workbook",s=pr.find(e,n);try{if(n="/!DataSpaces/Version",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(YW(s.content),n="/!DataSpaces/DataSpaceMap",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=JW(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=QW(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);eV(s.content)}catch{}if(n="/EncryptionInfo",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tV(s.content);if(n="/EncryptedPackage",s=pr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function f4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Oa(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sJ(e,t){return pr.find(e,"EncryptedPackage")?nJ(e,t):b8(e,t)}function aJ(e,t){var r,n=e,s=t||{};return s.type||(s.type=dr&&Buffer.isBuffer(e)?"buffer":"base64"),r=pT(n,s),rJ(r,s)}function _8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return qw(e.slice(r),t);default:break e}return op.to_workbook(e,t)}function iJ(e,t){var r="",n=f4(e,t);switch(t.type){case"base64":r=Oa(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=$u(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=zr(r)),t.type="binary",_8(r,t)}function oJ(e,t){var r=e;return t.type=="base64"&&(r=Oa(r)),r=np.utils.decode(1200,r.slice(2),"str"),t.type="binary",_8(r,t)}function lJ(e){return e.match(/[^\x00-\x7F]/)?Kh(e):e}function kv(e,t,r,n){return n?(r.type="string",op.to_workbook(e,r)):op.to_workbook(t,r)}function Gw(e,t){XC();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Gw(new Uint8Array(e),(r=vs(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),of={},r.dateNF&&(of.dateNF=r.dateNF),r.type||(r.type=dr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=dr?"buffer":"binary",n=Yz(e),typeof Uint8Array<"u"&&!dr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=lJ(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=vs(r),r.type="array",Gw(qb(n),r)}switch((s=f4(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return sJ(pr.read(n,r),r);break;case 9:if(s[1]<=8)return b8(n,r);break;case 60:return qw(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return IW(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return DW.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?aJ(n,r):kv(e,n,r,a);case 239:return s[3]===60?qw(n,r):kv(e,n,r,a);case 255:if(s[1]===254)return oJ(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return m0.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return m0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return bk.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return hV.to_workbook(n,r);break;case 10:case 13:case 32:return iJ(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return LW.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?bk.to_workbook(n,r):kv(e,n,r,a)}function cJ(e,t,r,n,s,a,i,o){var l=ys(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=i?e[r][h]:e[n[h]+l];if(m===void 0||m.t===void 0){if(u===void 0)continue;a[h]!=null&&(p[a[h]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[h]!=null){if(g==null)if(m.t=="e"&&g===null)p[a[h]]=null;else if(u!==void 0)p[a[h]]=u;else if(d&&g===null)p[a[h]]=null;else continue;else p[a[h]]=d&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:yl(m,g,o);g!=null&&(f=!1)}}return{row:p,isempty:f}}function Yw(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=hn(d);break;case"number":l=hn(e["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var f=ys(l.s.r),p=[],h=[],m=0,g=0,y=Array.isArray(e),x=l.s.r,w=0,b={};y&&!e[x]&&(e[x]=[]);var N=u.skipHidden&&e["!cols"]||[],A=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(N[w]||{}).hidden)switch(p[w]=Yn(w),r=y?e[x][w]:e[p[w]+f],n){case 1:a[w]=w-l.s.c;break;case 2:a[w]=p[w];break;case 3:a[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=yl(r,null,u),g=b[i]||0,!g)b[i]=1;else{do o=i+"_"+g++;while(b[o]);b[i]=g,b[o]=1}a[w]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(A[x]||{}).hidden){var P=cJ(e,l,x,p,n,a,y,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[m++]=P.row)}return h.length=m,h}var Mk=/"/g;function uJ(e,t,r,n,s,a,i,o){for(var l=!0,u=[],d="",f=ys(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+f];if(h==null)d="";else if(h.v!=null){l=!1,d=""+(o.rawNumbers&&h.t=="n"?h.v:yl(h,null,o));for(var m=0,g=0;m!==d.length;++m)if((g=d.charCodeAt(m))===s||g===a||g===34||o.forceQuotes){d='"'+d.replace(Mk,'""')+'"';break}d=="ID"&&(d='"ID"')}else h.f!=null&&!h.F?(l=!1,d="="+h.f,d.indexOf(",")>=0&&(d='"'+d.replace(Mk,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(i)}function E8(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=hn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(p[m]||{}).hidden||(f[m]=Yn(m));for(var g=0,y=s.s.r;y<=s.e.r;++y)(h[y]||{}).hidden||(d=uJ(e,s,y,f,i,l,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((g++?o:"")+d)));return delete n.dense,r.join("")}function dJ(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=E8(e,t);return r}function fJ(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=hn(e["!ref"]),a="",i=[],o,l=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Yn(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=ys(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function A8(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Zs(n.origin):n.origin;i=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var f=hn(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var p=n.header||[],h=0;t.forEach(function(g,y){ko(g).forEach(function(x){(h=p.indexOf(x))==-1&&(p[h=p.length]=x);var w=g[x],b="z",N="",A=Xt({c:o+h,r:i+y+s});u=dp(a,A),w&&typeof w=="object"&&!(w instanceof Date)?a[A]=w:(typeof w=="number"?b="n":typeof w=="boolean"?b="b":typeof w=="string"?b="s":w instanceof Date?(b="d",n.cellDates||(b="n",w=sa(w)),N=n.dateNF||er[14]):w===null&&n.nullError&&(b="e",w=0),u?(u.t=b,u.v=w,delete u.w,delete u.R,N&&(u.z=N)):a[A]=u={t:b,v:w},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,o+p.length-1);var m=ys(i);if(s)for(h=0;h<p.length;++h)a[Yn(h+o)+m]={t:"s",v:p[h]};return a["!ref"]=mr(d),a}function hJ(e,t){return A8(null,e,t)}function dp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Zs(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?dp(e,Xt(t)):dp(e,Xt({r:t,c:r||0}))}function pJ(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function h4(){return{SheetNames:[],Sheets:{}}}function p4(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(QY(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function mJ(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=pJ(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function gJ(e,t){return e.z=t,e}function j8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function xJ(e,t,r){return j8(e,"#"+t,r)}function vJ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function yJ(e,t,r,n){for(var s=typeof t!="string"?t:hn(t),a=typeof t=="string"?t:mr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=dp(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var wJ={encode_col:Yn,encode_row:ys,encode_cell:Xt,encode_range:mr,decode_col:Zb,decode_row:Qb,split_cell:PH,decode_cell:Zs,decode_range:Wf,format_cell:yl,sheet_add_aoa:LT,sheet_add_json:A8,sheet_add_dom:N8,aoa_to_sheet:Vf,json_to_sheet:hJ,table_to_sheet:S8,table_to_book:IX,sheet_to_csv:E8,sheet_to_txt:dJ,sheet_to_json:Yw,sheet_to_html:RX,sheet_to_formulae:fJ,sheet_to_row_object_array:Yw,sheet_get_cell:dp,book_new:h4,book_append_sheet:p4,book_set_sheet_visibility:mJ,cell_set_number_format:gJ,cell_set_hyperlink:j8,cell_set_internal_link:xJ,cell_add_comment:vJ,sheet_set_array_formula:yJ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const C8=({projectId:e,onClose:t,onImported:r})=>{const{user:n}=On(),[s,a]=J.useState(null),[i,o]=J.useState(""),[l,u]=J.useState(""),[d,f]=J.useState([]),[p,h]=J.useState(!1),[m,g]=J.useState(""),y=async N=>{var P;const A=(P=N.target.files)==null?void 0:P[0];if(A){a(A),g(""),h(!0);try{const j=await A.arrayBuffer(),D=Gw(j),E=D.Sheets[D.SheetNames[0]],I=wJ.sheet_to_json(E,{header:1}),_=[];for(let L=1;L<I.length;L++){const M=I[L];if(!M||M.length===0||!M.some(C=>C))continue;const K=parseInt(M[0])||L,Z=String(M[1]||"").trim(),ae=String(M[2]||"M").trim(),he=parseFloat(M[3])||0,re=parseFloat(M[4])||0,U=he*re;let ue=!0,pe="";Z||(ue=!1,pe="Dsignation manquante"),_.push({numero:K,designation:Z,unite:ae,quantite:he,prixUnitaire:re,montant:U,isValid:ue,error:pe})}if(f(_),!i){const L=A.name.replace(/\.[^/.]+$/,"");o(L)}}catch(j){g("Erreur lors de la lecture du fichier. Vrifiez le format Excel."),console.error(j)}finally{h(!1)}}},x=async()=>{if(!n||!i.trim()||!l.trim()||d.length===0){alert("Veuillez remplir tous les champs et charger un fichier valide");return}const N=d.filter(I=>I.isValid);if(N.length===0){alert("Aucune ligne valide  importer");return}const A=`bordereau:${Tr()}`,P=new Date().toISOString(),j=N.map((I,_)=>({id:Tr(),numero:_+1,designation:I.designation,unite:I.unite,quantite:I.quantite,prixUnitaire:I.prixUnitaire,montant:I.montant})),D=j.reduce((I,_)=>I+_.montant,0),E={id:A,projectId:e,userId:n.id,reference:i.trim(),designation:l.trim(),lignes:j,montantTotal:D,createdAt:P,updatedAt:P};St()?await mt.createBordereau({projectId:e.replace("project:",""),reference:i.trim(),designation:l.trim(),lignes:j,montantTotal:D}):(await be.bordereaux.add(E),await ps("CREATE","bordereau",A.replace("bordereau:",""),E,n.id)),r(A)},w=d.filter(N=>N.isValid).length,b=d.filter(N=>!N.isValid).length;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Importer depuis Excel"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Format attendu: N, Dsignation, Unit, Quantit, Prix unitaire"})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Bi,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:i,onChange:N=>o(N.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),c.jsx("input",{type:"text",value:l,onChange:N=>u(N.target.value),className:"input w-full",placeholder:"Ex: Bordereau import"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier Excel (.xlsx, .xls)"}),c.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary-500 transition-colors",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:y,className:"hidden",id:"excel-upload"}),c.jsxs("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[c.jsx(LC,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s?c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:s.name}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(s.size/1024).toFixed(2)," KB"]})]}):c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Cliquer pour slectionner un fichier"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ou glisser-dposer"})]})]})]})]}),m&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[c.jsx(ni,{className:"w-5 h-5 text-red-600 mt-0.5"}),c.jsx("p",{className:"text-sm text-red-900",children:m})]}),d.length>0&&c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:"font-medium text-gray-900",children:"Aperu des donnes"}),c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[c.jsx(T1,{className:"w-4 h-4"}),w," valides"]}),b>0&&c.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[c.jsx(ni,{className:"w-4 h-4"}),b," erreurs"]})]})]}),c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50 border-b sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"N"}),c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Dsignation"}),c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"U"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Qt"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"P.U"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Montant"}),c.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700",children:"Statut"})]})}),c.jsx("tbody",{className:"divide-y",children:d.map((N,A)=>c.jsxs("tr",{className:N.isValid?"":"bg-red-50",children:[c.jsx("td",{className:"px-3 py-2",children:N.numero}),c.jsx("td",{className:"px-3 py-2",children:N.designation||c.jsx("span",{className:"text-gray-400",children:"-"})}),c.jsx("td",{className:"px-3 py-2",children:N.unite}),c.jsx("td",{className:"px-3 py-2 text-right",children:N.quantite}),c.jsx("td",{className:"px-3 py-2 text-right",children:N.prixUnitaire.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-right font-medium",children:N.montant.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-center",children:N.isValid?c.jsx(T1,{className:"w-4 h-4 text-green-600 mx-auto"}):c.jsxs("div",{className:"flex items-center justify-center gap-1",children:[c.jsx(ni,{className:"w-4 h-4 text-red-600"}),c.jsx("span",{className:"text-xs text-red-600",children:N.error})]})})]},A))})]})})})]}),p&&c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"}),c.jsx("p",{className:"ml-3 text-gray-600",children:"Traitement du fichier..."})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:x,disabled:d.length===0||w===0||!i.trim()||!l.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx(Tp,{className:"w-4 h-4"}),"Importer ",w>0&&`(${w} lignes)`]})]})})]})})},T8="app_storage_config",Op=()=>{const e=localStorage.getItem(T8);return e?JSON.parse(e):{type:"local",basePath:"MesProjetsBTP"}},P8=e=>{localStorage.setItem(T8,JSON.stringify(e))},L8=(e,t)=>{const r=t.replace(/\//g,"-").replace(/\s+/g,"-");return`${e}/${r}`},bJ=e=>{const n=`${Op().basePath}/${e}`;return{root:n,bordereau:`${n}/Bordereau`,metre:`${n}/Mtr`,decomptes:`${n}/Dcomptes`,attachements:`${n}/Attachements`,photos:`${n}/Photos`,pv:`${n}/PV`,documents:`${n}/Documents`}},NJ=async(e,t)=>{const r=Op(),n=L8(e,t),s=bJ(n);switch(r.type){case"local":await V1(s);break;case"onedrive":await SJ(s);break;case"google-drive":await kJ(s);break;default:await V1(s)}return s},V1=async e=>{if("showDirectoryPicker"in window)try{console.log(" File System Access API disponible")}catch(r){console.warn("Impossible de crer les dossiers locaux:",r)}else console.log(" File System Access API non disponible, utilisation du mode fallback");const t=JSON.parse(localStorage.getItem("project_folders")||"{}");t[e.root]={structure:e,createdAt:new Date().toISOString()},localStorage.setItem("project_folders",JSON.stringify(t)),console.log(" Structure de dossiers enregistre:",e)},SJ=async e=>{console.log(" OneDrive folders ( implmenter):",e),await V1(e)},kJ=async e=>{console.log(" Google Drive folders ( implmenter):",e),await V1(e)},_J=async e=>{var n;const r=`${Op().basePath}/${e}`;if((n=window.electronAPI)!=null&&n.openFolder){await window.electronAPI.openFolder(r);return}alert(`Chemin du dossier:
${r}

Copiez ce chemin pour accder au dossier.`)};let wd=null;const EJ=async()=>{if(!("showDirectoryPicker"in window))return alert("Votre navigateur ne supporte pas la slection de dossiers. Utilisez Chrome, Edge ou Opera."),null;try{if(wd=await window.showDirectoryPicker({mode:"readwrite"}),wd){const e=Op();return e.basePath=wd.name,P8(e),localStorage.setItem("base_folder_name",wd.name),console.log(" Dossier de base slectionn:",wd.name),wd.name}return null}catch(e){return console.warn("Slection de dossier annule:",e),null}},bd=(e,t,r="-")=>{if(!e)return r;try{const n=typeof e=="string"?Ai(e):new Date(e);return tp(n)?Kn(n,t,{locale:Pc}):r}catch{return r}},AJ=()=>{const{t:e}=$i(),{id:t}=Ku(),r=$s(),{user:n}=On(),[s,a]=J.useState("overview"),[i,o]=J.useState(!1),[l,u]=J.useState(null),{canModify:d,reason:f}=$b(),[p,h]=J.useState([]),[m,g]=J.useState([]),[y,x]=J.useState([]),[w,b]=J.useState(!1),N=t!=null&&t.startsWith("project:")?t:`project:${t}`,A=t!=null&&t.startsWith("project:")?t.replace("project:",""):t,{project:P,isLoading:j,refresh:D}=Rx(A||null),{bordereaux:E,refresh:I}=Mb(A||null),{decompts:_,refresh:L}=cU(A||null),{photos:M}=uU(A||null),{pvs:K}=dU(A||null),{attachments:Z}=fU(A||null),{periodes:ae,refresh:he}=Bb(A||null),{aggregatedMetres:re}=hU(A||null),{metres:U}=Ub(A||null),ue=async()=>{if(A){b(!0);try{const[z,Re,Fe]=await Promise.all([rs.getPhotos(A),rs.getPVs(A),rs.getDocuments(A)]);h(z),g(Re),x(Fe)}catch(z){console.error("Error loading assets:",z)}finally{b(!1)}}};J.useEffect(()=>{A&&ue()},[A]);const pe=E&&E.length>0?E[0].lignes.reduce((z,Re)=>{const X=Re.quantite*(Re.prixUnitaire||0)*1.2;return z+X},0):0,R=(()=>{if(!_||_.length===0||pe===0)return 0;const z=_.reduce((X,Oe)=>!X||Oe.numero>X.numero?Oe:X,_[0]),Fe=((z==null?void 0:z.totalTTC)||(z==null?void 0:z.montantTotal)||(z==null?void 0:z.montantTTC)||0)/pe*100;return Math.min(100,Math.max(0,Fe))})(),B=async()=>{if(!(!n||!P)){if(!d){alert(f||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}if(confirm("tes-vous sr de vouloir supprimer ce projet ? Cette action est irrversible."))try{St()?await mt.deleteProject(A):(await be.projects.update(P.id,{deletedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),await ps("DELETE","project",A,P,n.id)),r("/projects")}catch(z){console.error("Error deleting project:",z),alert("Erreur lors de la suppression du projet")}}},O=async z=>{if(!n||!t)return;if(!d){alert(f||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}const Re=`bordereau:${Tr()}`,Fe=new Date().toISOString(),X={id:Re,projectId:N,userId:n.id,reference:z.reference,designation:z.designation,lignes:[],montantTotal:0,createdAt:Fe,updatedAt:Fe};try{St()?(await mt.createBordereau({projectId:A,reference:z.reference,designation:z.designation,lignes:[]}),I()):(await be.bordereaux.add(X),await ps("CREATE","bordereau",Re.replace("bordereau:",""),X,n.id))}catch(Oe){console.error("Error creating bordereau:",Oe),alert("Erreur lors de la cration du bordereau")}u(null)},Y=async()=>{var xt;if(!n||!t||!E||E.length===0)return;if(!d){alert(f||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}const z=new Date().toISOString();if(St()){try{const tt=await mt.createPeriode({projectId:A,numero:((ae==null?void 0:ae.length)||0)+1,libelle:`Priode ${((ae==null?void 0:ae.length)||0)+1}`,dateDebut:z,dateFin:z,statut:"en_cours"}),gt=((xt=tt.data)==null?void 0:xt.id)||tt.id;await mt.createDecompt({projectId:A,periodeId:gt,numero:((ae==null?void 0:ae.length)||0)+1,statut:"draft"}),he(),L(),r(`/projects/${A}/metre/${gt.replace("periode:","")}`)}catch(tt){console.error("Error creating new metre:",tt),alert("Erreur lors de la cration du mtr")}return}const Re=await be.periodes.where("projectId").equals(N).and(tt=>!tt.deletedAt).toArray(),Fe=Re.length+1,X=`periode:${Tr()}`,Oe={id:X,projectId:N,userId:n.id,numero:Fe,libelle:`Priode ${Fe}`,dateDebut:z,dateFin:z,statut:"en_cours",createdAt:z,updatedAt:z};if(await be.periodes.add(Oe),await ps("CREATE","periode",X.replace("periode:",""),Oe,n.id),Fe>1){const tt=Re.find(gt=>gt.numero===Fe-1);if(tt){const gt=await be.metres.where("periodeId").equals(tt.id).and(ct=>!ct.deletedAt).toArray();for(const ct of gt){const Mt=`metre:${Tr()}`,It={id:Mt,projectId:N,periodeId:X,bordereauLigneId:ct.bordereauLigneId,userId:n.id,reference:ct.reference,designationBordereau:ct.designationBordereau,unite:ct.unite,sections:[],subSections:[],lignes:[],totalPartiel:0,totalCumule:ct.totalCumule||ct.totalPartiel||0,quantiteBordereau:ct.quantiteBordereau,pourcentageRealisation:ct.pourcentageRealisation||0,createdAt:z,updatedAt:z};await be.metres.add(It),await ps("CREATE","metre",Mt.replace("metre:",""),It,n.id)}}}const Me=`decompt:${Tr()}`;let st=0;Fe>1&&(st=(await be.decompts.where("projectId").equals(N).and(gt=>!gt.deletedAt).toArray()).reduce((gt,ct)=>gt+(Number(ct.montantTotal)||0),0));const Ue={id:Me,projectId:N,periodeId:X,userId:n.id,numero:Fe,lignes:[],montantTotal:0,montantCumule:st,statut:"draft",createdAt:z,updatedAt:z};await be.decompts.add(Ue),await ps("CREATE","decompt",Me.replace("decompt:",""),Ue,n.id),r(`/projects/${A}/metre/${X.replace("periode:","")}`)},[ie,me]=J.useState(!1);if(J.useEffect(()=>{const z=setTimeout(()=>{!P&&!j&&me(!0)},5e3);return()=>clearTimeout(z)},[P,j]),!P)return ie?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(ni,{className:"w-8 h-8 text-yellow-600"})}),c.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),c.jsx("p",{className:"text-gray-500 text-sm mb-4",children:St()?"Le projet n'existe pas sur le serveur.":"Le projet n'existe pas localement. Essayez de synchroniser."}),c.jsx("button",{onClick:()=>St()?D():window.location.reload(),className:"btn btn-primary",children:St()?"Ressayer":"Rafrachir la page"})]})}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})});const ge=[{id:"overview",label:"Vue d'ensemble",icon:Bu,count:null},{id:"bordereau",label:"Bordereau",icon:Wr,count:E&&E.length>0?1:0},{id:"metre",label:"Mtr",icon:dc,count:(re==null?void 0:re.length)||0},{id:"decompt",label:"Dcompte",icon:Ci,count:(_==null?void 0:_.length)||0},{id:"photos",label:"Photos",icon:c0,count:p.length},{id:"pv",label:"PV",icon:Wr,count:m.length},{id:"documents",label:"Documents",icon:L1,count:y.length}],xe=z=>{switch(z){case"active":return"bg-green-100 text-green-700 border-green-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"archived":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-yellow-100 text-yellow-700 border-yellow-200"}},Le=z=>{switch(z){case"active":return c.jsx(vl,{className:"w-4 h-4"});case"completed":return c.jsx(bo,{className:"w-4 h-4"});default:return c.jsx(Wr,{className:"w-4 h-4"})}};return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r("/projects"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[c.jsx(ii,{className:"w-5 h-5"}),c.jsx("span",{children:"Retour aux projets"})]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["March N ",P.marcheNo]}),c.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-full border ${xe(P.status)}`,children:[Le(P.status),e(`project.status.${P.status}`)]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Dx,{className:"w-4 h-4"}),P.annee]}),c.jsx("span",{children:""}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Ci,{className:"w-4 h-4"}),pe.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD (TTC)"]}),P.societe&&c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(rf,{className:"w-4 h-4"}),P.societe]})]})]}),c.jsx("p",{className:"text-gray-600 mt-2 line-clamp-2",title:P.objet,children:P.objet})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Sl,{className:"w-4 h-4"}),"Exporter"]}),c.jsxs(Pi,{to:`/projects/${t}/edit`,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(ES,{className:"w-4 h-4"}),"Modifier"]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>o(!i),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(jB,{className:"w-5 h-5 text-gray-600"})}),i&&c.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[c.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[c.jsx(LB,{className:"w-4 h-4"}),"Partager"]}),c.jsxs("button",{onClick:B,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[c.jsx(xs,{className:"w-4 h-4"}),"Supprimer"]})]})]})]})]})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progression du projet"}),c.jsxs("span",{className:`text-2xl font-bold ${R>100?"text-red-600":"text-primary-600"}`,children:[R.toFixed(1),"%"]})]}),c.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-500 ${R>100?"bg-gradient-to-r from-red-500 to-red-600":R>80?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-primary-500 to-primary-600"}`,style:{width:`${Math.min(100,R)}%`}})}),c.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Mis  jour le ",bd(P.updatedAt,"dd MMMM yyyy  HH:mm")]}),R>100&&c.jsx("span",{className:"text-xs text-red-500 font-medium",children:" Dpassement du budget!"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(Wr,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E&&E.length>0?"1":"0"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Bordereau"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(dc,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(U==null?void 0:U.length)||0}),c.jsx("p",{className:"text-sm text-gray-600",children:"Mtrs"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(Ci,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(_==null?void 0:_.length)||0}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dcomptes"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-yellow-100 text-yellow-600 rounded-lg",children:c.jsx(c0,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.length}),c.jsx("p",{className:"text-sm text-gray-600",children:"Photos"})]})]})})]}),c.jsx("div",{className:"border-b border-gray-200 mb-6",children:c.jsx("div",{className:"flex gap-1 overflow-x-auto",children:ge.map(z=>{const Re=z.icon;return c.jsxs("button",{onClick:()=>a(z.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${s===z.id?"border-primary-600 text-primary-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:[c.jsx(Re,{className:"w-4 h-4"}),z.label,z.count!==null&&c.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s===z.id?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:z.count})]},z.id)})})}),c.jsxs("div",{children:[s==="overview"&&c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Objet du march"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.objet})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Numro de march"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.marcheNo})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Anne"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.annee})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Date d'ouverture"}),c.jsx("p",{className:"font-medium text-gray-900",children:bd(P.dateOuverture,"dd/MM/yyyy")})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Montant (TTC)"}),c.jsxs("p",{className:"font-medium text-primary-600 text-lg",children:[pe.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Statut"}),c.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 text-sm font-medium rounded-full border ${xe(P.status)}`,children:[Le(P.status),e(`project.status.${P.status}`)]})]})]})]}),(P.snss||P.cbn||P.rcn||P.osc)&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations administratives"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[P.snss&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"SNSS"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.snss})]}),P.cbn&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"CBN"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.cbn})]}),P.rcn&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"RCN"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.rcn})]}),P.osc&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"OSC"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.osc})]})]})]}),(P.societe||P.patente||P.delaisEntreeService)&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de la socit"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[P.societe&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Nom de la socit"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.societe})]}),P.patente&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Patente"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.patente})]}),P.delaisEntreeService&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Dlais d'entre en service"}),c.jsx("p",{className:"font-medium text-gray-900",children:P.delaisEntreeService})]})]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Chronologie"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center",children:c.jsx(bo,{className:"w-4 h-4"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Projet cr"}),c.jsx("p",{className:"text-xs text-gray-500",children:bd(P.createdAt,"dd/MM/yyyy  HH:mm")})]})]}),P.updatedAt!==P.createdAt&&c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center",children:c.jsx(ES,{className:"w-4 h-4"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Dernire modification"}),c.jsx("p",{className:"text-xs text-gray-500",children:bd(P.updatedAt,"dd/MM/yyyy  HH:mm")})]})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(Wr,{className:"w-4 h-4"}),"Ajouter un bordereau"]}),c.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(c0,{className:"w-4 h-4"}),"Ajouter des photos"]}),c.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(L1,{className:"w-4 h-4"}),"Joindre un document"]})]})]}),c.jsx("div",{className:"card bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-primary-600 text-white rounded-lg flex items-center justify-center",children:c.jsx(Bu,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Dossier du projet"}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:P.folderPath||`${P.annee}/${P.marcheNo}`}),c.jsxs("button",{onClick:()=>_J(P.folderPath||`${P.annee}/${P.marcheNo}`),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 font-medium",children:[c.jsx(Iw,{className:"w-4 h-4"}),"Ouvrir le dossier",c.jsx(hB,{className:"w-3 h-3"})]})]})]})})]})]}),s==="bordereau"&&c.jsx(c.Fragment,{children:E&&E.length>0?c.jsx(WC,{bordereauId:E[0].id,onClose:()=>a("overview"),onSaved:()=>{D(),I()}}):c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center py-8 mb-6",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),c.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("button",{onClick:()=>u("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(ms,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),c.jsx("button",{onClick:()=>u("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(FC,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),c.jsx("button",{onClick:()=>u("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(P1,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),c.jsx("button",{onClick:()=>u("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Tp,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]})}),s==="metre"&&c.jsx(c.Fragment,{children:E&&E.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Mtrs (",(ae==null?void 0:ae.length)||0,")"]}),ae&&ae.length>0&&c.jsxs("button",{onClick:Y,className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(ms,{className:"w-4 h-4"}),"Nouveau mtr"]})]}),ae&&ae.length>0?c.jsx("div",{className:"grid gap-4",children:ae.sort((z,Re)=>Re.numero-z.numero).map(z=>{const Fe=((U==null?void 0:U.filter(Me=>{const st=ae==null?void 0:ae.find(Ue=>{const xt=(Ue.id||"").replace("periode:",""),tt=(Me.periodeId||"").replace("periode:","");return xt===tt});return st&&st.numero<=z.numero}))||[]).reduce((Me,st)=>{const Ue=Number(st.totalPartiel)||0;return Me+Ue},0),X=(z.id||"").replace("periode:",""),Oe=(U==null?void 0:U.filter(Me=>(Me.periodeId||"").replace("periode:","")===X))||[];return c.jsx("div",{className:"card hover:shadow-md transition-shadow cursor-pointer",onClick:()=>r(`/projects/${A}/metre/${z.id.replace("periode:","")}`),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-primary-100",children:c.jsx(dc,{className:"w-6 h-6 text-primary-600"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900",children:["Mtr N ",z.numero]}),c.jsx("p",{className:"text-sm text-gray-500",children:z.libelle||`Priode ${z.numero}`})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Total Cumul"}),c.jsx("p",{className:"font-semibold text-gray-900",children:Fe.toFixed(2)})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Articles"}),c.jsx("p",{className:"font-semibold text-primary-600",children:Oe.length})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),c.jsx("p",{className:"text-sm text-gray-700",children:bd(z.createdAt,"dd/MM/yyyy")})]}),c.jsx(ul,{className:"w-5 h-5 text-gray-400"})]})]})},z.id)})}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(dc,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun mtr cr"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Crez votre premier mtr pour commencer  mesurer les travaux"}),c.jsxs("button",{onClick:Y,className:"btn btn-primary inline-flex items-center gap-2 px-6 py-3",children:[c.jsx(ms,{className:"w-5 h-5"}),"Crer le premier mtr"]}),c.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Un dcompte sera cr automatiquement avec le mtr"})]})})]}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bordereau requis"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),c.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Wr,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})}),s==="decompt"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Dcomptes (",(_==null?void 0:_.length)||0,")"]})}),_&&_.length>0?c.jsx("div",{className:"grid gap-4",children:_.sort((z,Re)=>Re.numero-z.numero).map(z=>{var Oe;const Re=(z.periodeId||"").replace("periode:",""),Fe=ae==null?void 0:ae.find(Me=>(Me.id||"").replace("periode:","")===Re),X=Fe==null?void 0:Fe.isDecompteDernier;return console.log(" Dcompte click target:",{decomptId:z.id,periodeId:z.periodeId,cleanPeriodeId:Re,navigateTo:`/projects/${A}/decompte/${Re}`}),c.jsx("div",{className:"card hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{Re?r(`/projects/${A}/decompte/${Re}`):console.error(" Missing periodeId for dcompte:",z)},children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${X?"bg-green-100":"bg-primary-100"}`,children:c.jsx(Ci,{className:`w-6 h-6 ${X?"text-green-600":"text-primary-600"}`})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900",children:["Dcompte N ",z.numero,X&&c.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"et dernier"})]}),c.jsx("p",{className:"text-sm text-gray-500",children:Fe?`${Fe.libelle||`Priode ${Fe.numero}`}`:"Priode non trouve"})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Montant HT"}),c.jsxs("p",{className:"font-semibold text-gray-900",children:[(Oe=z.montantTotal||z.montantHT||0)==null?void 0:Oe.toLocaleString("fr-FR",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Statut"}),c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${z.statut==="validated"?"bg-green-100 text-green-800":z.statut==="submitted"?"bg-blue-100 text-blue-800":z.statut==="paid"?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800"}`,children:z.statut==="validated"?"Valid":z.statut==="submitted"?"Soumis":z.statut==="paid"?"Pay":"Brouillon"})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),c.jsx("p",{className:"text-sm text-gray-700",children:bd((Fe==null?void 0:Fe.dateFin)||z.createdAt,"dd/MM/yyyy")})]}),c.jsx(ul,{className:"w-5 h-5 text-gray-400"})]})]})},z.id)})}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Ci,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun dcompte"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Crez des mtrs puis gnrez le dcompte pour facturer les travaux excuts"}),c.jsxs("button",{onClick:()=>r(`/projects/${t}/decompte`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Ci,{className:"w-4 h-4"}),"Crer un dcompte"]})]})})]}),s==="photos"&&c.jsx(uz,{projectId:A,photos:p,onRefresh:ue}),s==="pv"&&c.jsx(fz,{projectId:A,pvs:m,onRefresh:ue}),s==="documents"&&c.jsx(mz,{projectId:A,documents:y,onRefresh:ue})]}),l==="blank"&&c.jsx(VC,{onClose:()=>u(null),onCreate:O}),l==="template"&&c.jsx(KC,{projectId:t,onClose:()=>u(null),onCreated:()=>u(null)}),l==="copy"&&c.jsx(GC,{currentProjectId:t,onClose:()=>u(null),onCopied:()=>u(null)}),l==="import"&&c.jsx(C8,{projectId:t,onClose:()=>u(null),onImported:()=>u(null)})]})};let Ph=[],Bk=0;const jJ=3e4,F8=async()=>{const e=Date.now();if(Ph.length>0&&e-Bk<jJ)return Ph;try{return Ph=(await mt.getCompanies()).map((r,n)=>({id:`server-company-${n}`,userId:"server",nom:r.nom,rc:r.rc||"",cnss:r.cnss||"",usageCount:1,lastUsed:new Date().toISOString(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})),Bk=e,console.log(` ${Ph.length} entreprises rcupres du serveur`),Ph}catch{return console.warn(" Impossible de rcuprer les entreprises du serveur, fallback IndexedDB"),[]}},CJ=async(e,t)=>{const r=await F8();let n=[];try{n=await be.companies.toArray()}catch{}const s=new Map;for(const l of r)s.set(l.nom.toLowerCase(),l);for(const l of n){const u=l.nom.toLowerCase();s.has(u)||s.set(u,l)}const a=Array.from(s.values());if(!t||t.length<2)return a.sort((l,u)=>(u.usageCount||0)-(l.usageCount||0)).slice(0,10);const i=t.toLowerCase();return a.filter(l=>{const u=l.nom.toLowerCase().includes(i),d=l.rc?l.rc.toLowerCase().includes(i):!1,f=l.cnss?l.cnss.toLowerCase().includes(i):!1;return u||d||f}).sort((l,u)=>{const d=l.nom.toLowerCase().startsWith(i),f=u.nom.toLowerCase().startsWith(i);return d&&!f?-1:!d&&f?1:(u.usageCount||0)-(l.usageCount||0)}).slice(0,10)},TJ=async(e,t)=>{const r=t.toLowerCase(),s=(await F8()).find(a=>a.nom.toLowerCase()===r);if(s)return s;try{return(await be.companies.filter(i=>i.nom.toLowerCase()===r).toArray())[0]}catch{return}},D8=async(e,t)=>{const r=new Date().toISOString(),n=await TJ("",t.nom);if(n){const s={...t,usageCount:n.usageCount+1,lastUsed:r,updatedAt:r};return await be.companies.update(n.id,s),await be.syncOperations.add({id:`sync:${Tr()}`,userId:e,deviceId:localStorage.getItem("deviceId")||"device-001",type:"UPDATE",entity:"company",entityId:n.id,data:{...n,...s},timestamp:Date.now(),synced:!1}),{...n,...s}}else{const s={id:`company:${Tr()}`,userId:e,nom:t.nom,rc:t.rc,cb:t.cb,cnss:t.cnss,patente:t.patente,adresse:t.adresse,telephone:t.telephone,email:t.email,usageCount:1,lastUsed:r,createdAt:r,updatedAt:r};return await be.companies.add(s),await be.syncOperations.add({id:`sync:${Tr()}`,userId:e,deviceId:localStorage.getItem("deviceId")||"device-001",type:"CREATE",entity:"company",entityId:s.id,data:s,timestamp:Date.now(),synced:!1}),console.log(" Nouvelle entreprise cre et prte pour sync:",s.nom),s}},R8=e=>e.societe?{nom:e.societe,rc:e.rc,cb:e.cb,cnss:e.cnss,patente:e.patente}:null,I8=({userId:e,value:t,onChange:r,onSelect:n,placeholder:s="Nom de la socit",className:a=""})=>{const[i,o]=J.useState(!1),[l,u]=J.useState([]),[d,f]=J.useState(!1),[p,h]=J.useState(-1),m=J.useRef(null),g=J.useRef(null);J.useEffect(()=>{const N=A=>{m.current&&!m.current.contains(A.target)&&o(!1)};return document.addEventListener("mousedown",N),()=>document.removeEventListener("mousedown",N)},[]),J.useEffect(()=>{const A=setTimeout(async()=>{if(e){f(!0);try{const P=await CJ(e,t);u(P)}catch(P){console.error("Erreur recherche entreprises:",P),u([])}finally{f(!1)}}},200);return()=>clearTimeout(A)},[e,t]);const y=N=>{if(!i){(N.key==="ArrowDown"||N.key==="Enter")&&o(!0);return}switch(N.key){case"ArrowDown":N.preventDefault(),h(A=>A<l.length-1?A+1:A);break;case"ArrowUp":N.preventDefault(),h(A=>A>0?A-1:A);break;case"Enter":N.preventDefault(),p>=0&&l[p]&&x(l[p]);break;case"Escape":o(!1),h(-1);break}},x=N=>{r(N.nom),n(N),o(!1),h(-1)},w=N=>{r(N.target.value),o(!0),h(-1)},b=()=>{o(!0)};return c.jsxs("div",{ref:m,className:`relative ${a}`,children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:g,type:"text",value:t,onChange:w,onFocus:b,onKeyDown:y,placeholder:s,className:"input w-full pl-10 pr-8",autoComplete:"off"}),c.jsx(rf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t&&c.jsx("button",{type:"button",onClick:()=>{var N;r(""),(N=g.current)==null||N.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c.jsx(Bi,{className:"w-4 h-4"})})]}),i&&(l.length>0||d)&&c.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto",children:d?c.jsx("div",{className:"p-3 text-center text-gray-500",children:c.jsx("div",{className:"w-5 h-5 border-2 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto"})}):c.jsx(c.Fragment,{children:l.length>0&&c.jsxs("div",{className:"py-1",children:[c.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-gray-500 bg-gray-50",children:"Entreprises enregistres"}),l.map((N,A)=>c.jsxs("button",{type:"button",onClick:()=>x(N),className:`w-full px-3 py-2 text-left flex items-start gap-3 transition-colors ${A===p?"bg-primary-50":"hover:bg-gray-50"}`,children:[c.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${A===p?"bg-primary-100":"bg-gray-100"}`,children:c.jsx(rf,{className:`w-4 h-4 ${A===p?"text-primary-600":"text-gray-500"}`})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium text-gray-900 truncate",children:N.nom}),c.jsx("p",{className:"text-xs text-gray-500 truncate",children:[N.rc&&`RC: ${N.rc}`,N.cnss&&`CNSS: ${N.cnss}`].filter(Boolean).join("  ")||"Aucune info supplmentaire"})]}),N.usageCount>1&&c.jsxs("span",{className:"flex-shrink-0 text-xs text-gray-400",children:[N.usageCount,"x"]})]},N.id))]})})}),i&&!d&&l.length===0&&t.length>=2&&c.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-3",children:c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(Ib,{className:"w-4 h-4"}),c.jsx("span",{children:"Nouvelle entreprise - les infos seront sauvegardes automatiquement"})]})})]})},PJ=()=>{const{t:e}=$i(),t=$s(),{user:r}=On(),[n,s]=J.useState(!1),[a,i]=J.useState(null),{canModify:o,reason:l}=$b(),[u,d]=J.useState({objet:"",marcheNo:"",annee:new Date().getFullYear().toString(),dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",achevementTravaux:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""}),f=async p=>{if(p.preventDefault(),!!r){if(!o){i(l||"Vous devez tre connect pour crer un projet");return}s(!0),i(null);try{const h=`project:${Tr()}`,m=new Date().toISOString(),g=L8(u.annee,u.marcheNo);if(St()){const w={objet:u.objet,marcheNo:u.marcheNo,annee:u.annee,dateOuverture:u.dateOuverture,montant:0,typeMarche:u.typeMarche,commune:u.commune||void 0,societe:u.societe,rc:u.rc,cb:u.cb,cnss:u.cnss,patente:u.patente,programme:u.programme,projet:u.projet,ligne:u.ligne,chapitre:u.chapitre,delaisExecution:u.delaisExecution?parseInt(u.delaisExecution):void 0,status:u.status,osc:u.osc||void 0,dateReceptionProvisoire:u.dateReceptionProvisoire||void 0,dateReceptionDefinitive:u.dateReceptionDefinitive||void 0,arrets:[],progress:0,folderPath:g};await mt.createProject(w),console.log(" [WEB] Projet cr via API"),t("/projects");return}try{await NJ(u.annee,u.marcheNo),console.log(" Dossiers du projet crs:",g)}catch(w){console.warn(" Impossible de crer les dossiers (mode fallback):",w)}const y={id:h,userId:r.id,objet:u.objet,marcheNo:u.marcheNo,annee:u.annee,dateOuverture:u.dateOuverture,montant:0,typeMarche:u.typeMarche,commune:u.commune||void 0,societe:u.societe,rc:u.rc,cb:u.cb,cnss:u.cnss,patente:u.patente,programme:u.programme,projet:u.projet,ligne:u.ligne,chapitre:u.chapitre,delaisExecution:u.delaisExecution?parseInt(u.delaisExecution):void 0,status:u.status,osc:u.osc||void 0,dateReceptionProvisoire:u.dateReceptionProvisoire||void 0,dateReceptionDefinitive:u.dateReceptionDefinitive||void 0,arrets:[],progress:0,folderPath:g,createdAt:m,updatedAt:m};await be.projects.add(y);const x=R8(u);if(x)try{await D8(r.id,x),console.log(" Entreprise sauvegarde pour autocompltion:",x.nom)}catch(w){console.warn(" Impossible de sauvegarder l'entreprise:",w)}await be.syncOperations.add({id:`sync:${Tr()}`,userId:r.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"CREATE",entity:"project",entityId:h,data:y,timestamp:Date.now(),synced:!1}),console.log(" Projet cr avec succs:",y),t("/projects")}catch(h){console.error(" Erreur cration projet:",h),i(h.message||"Erreur lors de la cration du projet")}finally{s(!1)}}};return c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),c.jsx("span",{children:e("common.back")})]}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.new")}),c.jsx("p",{className:"text-gray-600 mt-2",children:e("project.createDescription")})]}),c.jsxs("form",{onSubmit:f,className:"card space-y-6",children:[a&&c.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:a}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:u.typeMarche==="normal",onChange:p=>d({...u,typeMarche:p.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:u.typeMarche==="negocie",onChange:p=>d({...u,typeMarche:p.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.objet,onChange:p=>d({...u,objet:p.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.marcheNo,onChange:p=>d({...u,marcheNo:p.target.value}),placeholder:"Ex: 123/2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.annee,onChange:p=>d({...u,annee:p.target.value}),placeholder:"2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),c.jsxs("select",{className:"input",value:u.commune,onChange:p=>d({...u,commune:p.target.value}),children:[c.jsx("option",{value:"",children:"-- Slectionner une commune --"}),c.jsxs("optgroup",{label:"Municipalits",children:[c.jsx("option",{value:"Akka",children:"Akka"}),c.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),c.jsx("option",{value:"Tata",children:"Tata"}),c.jsx("option",{value:"Tissint",children:"Tissint"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[c.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),c.jsx("option",{value:"Allougoum",children:"Allougoum"}),c.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),c.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[c.jsx("option",{value:"Icht",children:"Icht"}),c.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[c.jsx("option",{value:"Addis",children:"Addis"}),c.jsx("option",{value:"Aguinane",children:"Aguinane"}),c.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),c.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),c.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),c.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),c.jsx("option",{value:"Tagmout",children:"Tagmout"}),c.jsx("option",{value:"Tlite",children:"Tlite"}),c.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),c.jsxs("select",{required:!0,className:"input",value:u.status,onChange:p=>d({...u,status:p.target.value}),children:[c.jsx("option",{value:"draft",children:"Brouillon"}),c.jsx("option",{value:"active",children:"Actif"}),c.jsx("option",{value:"completed",children:"Termin"}),c.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),c.jsx(I8,{userId:(r==null?void 0:r.id)||"",value:u.societe,onChange:p=>d({...u,societe:p}),onSelect:p=>{d(h=>({...h,societe:p.nom,rc:p.rc||h.rc,cb:p.cb||h.cb,cnss:p.cnss||h.cnss,patente:p.patente||h.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),c.jsx("input",{type:"text",className:"input",value:u.rc,onChange:p=>d({...u,rc:p.target.value}),placeholder:"Ex: 217/2021"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),c.jsx("input",{type:"text",className:"input",value:u.cb,onChange:p=>d({...u,cb:p.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),c.jsx("input",{type:"text",className:"input",value:u.cnss,onChange:p=>d({...u,cnss:p.target.value}),placeholder:"Ex: 4444634"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),c.jsx("input",{type:"text",className:"input",value:u.patente,onChange:p=>d({...u,patente:p.target.value}),placeholder:"Ex: 47730296"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),c.jsx("input",{type:"text",className:"input",value:u.programme,onChange:p=>d({...u,programme:p.target.value}),placeholder:"Ex: 31000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),c.jsx("input",{type:"text",className:"input",value:u.projet,onChange:p=>d({...u,projet:p.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),c.jsx("input",{type:"text",className:"input",value:u.ligne,onChange:p=>d({...u,ligne:p.target.value}),placeholder:"Ex: 24"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),c.jsx("input",{type:"text",className:"input",value:u.chapitre,onChange:p=>d({...u,chapitre:p.target.value}),placeholder:"Ex: 320010/03012"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture"}),c.jsx("input",{type:"date",className:"input",value:u.dateOuverture,onChange:p=>d({...u,dateOuverture:p.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date d'ouverture des plis"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),c.jsx("input",{type:"number",className:"input",value:u.delaisExecution,onChange:p=>d({...u,delaisExecution:p.target.value}),placeholder:"Ex: 10",min:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dure du march en mois"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux)"}),c.jsx("input",{type:"date",className:"input",value:u.osc,onChange:p=>d({...u,osc:p.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:n,children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:n,children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Enregistrement..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Yu,{className:"w-5 h-5"}),c.jsx("span",{children:"Enregistrer"})]})})]})]})]})},LJ=()=>{const{t:e}=$i(),t=$s(),{id:r}=Ku(),{user:n}=On(),[s,a]=J.useState(!1),[i,o]=J.useState(null),{canModify:l,reason:u}=$b(),d=r!=null&&r.startsWith("project:")?r.replace("project:",""):r,{project:f,isLoading:p}=Rx(d||null),[h,m]=J.useState({objet:"",marcheNo:"",annee:"",dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""}),g=x=>x?/^\d{4}-\d{2}-\d{2}$/.test(x)?x:x.split("T")[0]:"";J.useEffect(()=>{var x;f&&m({objet:f.objet||"",marcheNo:f.marcheNo||"",annee:f.annee||"",dateOuverture:g(f.dateOuverture),typeMarche:f.typeMarche||"normal",commune:f.commune||"",societe:f.societe||"",rc:f.rc||"",cb:f.cb||"",cnss:f.cnss||"",patente:f.patente||"",programme:f.programme||"",projet:f.projet||"",ligne:f.ligne||"",chapitre:f.chapitre||"",delaisExecution:((x=f.delaisExecution)==null?void 0:x.toString())||"",status:f.status||"draft",osc:g(f.osc),dateReceptionProvisoire:g(f.dateReceptionProvisoire),dateReceptionDefinitive:g(f.dateReceptionDefinitive)})},[f]);const y=async x=>{if(x.preventDefault(),!(!n||!f)){if(!l){o(u||"Vous devez tre connect pour modifier un projet");return}a(!0),o(null);try{const w=new Date().toISOString(),b={objet:h.objet,marcheNo:h.marcheNo,annee:h.annee,dateOuverture:h.dateOuverture,typeMarche:h.typeMarche,commune:h.commune||void 0,societe:h.societe,rc:h.rc,cb:h.cb,cnss:h.cnss,patente:h.patente,programme:h.programme,projet:h.projet,ligne:h.ligne,chapitre:h.chapitre,delaisExecution:h.delaisExecution?parseInt(h.delaisExecution):void 0,status:h.status,osc:h.osc||void 0,dateReceptionProvisoire:h.dateReceptionProvisoire||void 0,dateReceptionDefinitive:h.dateReceptionDefinitive||void 0,folderPath:`${h.annee}/${h.marcheNo}`};if(St()){await mt.updateProject(d,b),console.log(" [WEB] Projet modifi via API"),t(`/projects/${d}`);return}const N={...f,...b,updatedAt:w};await be.projects.update(f.id,N);const A=R8(h);if(A)try{await D8(n.id,A),console.log(" Entreprise sauvegarde pour autocompltion:",A.nom)}catch(P){console.warn(" Impossible de sauvegarder l'entreprise:",P)}await be.syncOperations.add({id:`sync:${Tr()}`,userId:n.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"UPDATE",entity:"project",entityId:f.id,data:N,timestamp:Date.now(),synced:!1}),console.log(" Projet modifi avec succs:",N),t(`/projects/${r}`)}catch(w){console.error(" Erreur modification projet:",w),o(w.message||"Erreur lors de la modification du projet")}finally{a(!1)}}};return!f&&!p?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:St()?"Projet non trouv sur le serveur":"Projet non trouv"})})}):f?c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),c.jsx("span",{children:e("common.back")})]}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Modifier le projet"}),c.jsxs("p",{className:"text-gray-600 mt-2",children:['Modifiez les informations du projet "',f.objet,'"']})]}),c.jsxs("form",{onSubmit:y,className:"card space-y-6",children:[i&&c.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:i}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:h.typeMarche==="normal",onChange:x=>m({...h,typeMarche:x.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:h.typeMarche==="negocie",onChange:x=>m({...h,typeMarche:x.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:h.objet,onChange:x=>m({...h,objet:x.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:h.marcheNo,onChange:x=>m({...h,marcheNo:x.target.value}),placeholder:"Ex: 123/2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:h.annee,onChange:x=>m({...h,annee:x.target.value}),placeholder:"2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),c.jsxs("select",{className:"input",value:h.commune,onChange:x=>m({...h,commune:x.target.value}),children:[c.jsx("option",{value:"",children:"-- Slectionner une commune --"}),c.jsxs("optgroup",{label:"Municipalits",children:[c.jsx("option",{value:"Akka",children:"Akka"}),c.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),c.jsx("option",{value:"Tata",children:"Tata"}),c.jsx("option",{value:"Tissint",children:"Tissint"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[c.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),c.jsx("option",{value:"Allougoum",children:"Allougoum"}),c.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),c.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[c.jsx("option",{value:"Icht",children:"Icht"}),c.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[c.jsx("option",{value:"Addis",children:"Addis"}),c.jsx("option",{value:"Aguinane",children:"Aguinane"}),c.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),c.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),c.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),c.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),c.jsx("option",{value:"Tagmout",children:"Tagmout"}),c.jsx("option",{value:"Tlite",children:"Tlite"}),c.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),c.jsxs("select",{required:!0,className:"input",value:h.status,onChange:x=>m({...h,status:x.target.value}),children:[c.jsx("option",{value:"draft",children:"Brouillon"}),c.jsx("option",{value:"active",children:"Actif"}),c.jsx("option",{value:"completed",children:"Termin"}),c.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),c.jsx(I8,{userId:(n==null?void 0:n.id)||"",value:h.societe,onChange:x=>m({...h,societe:x}),onSelect:x=>{m(w=>({...w,societe:x.nom,rc:x.rc||w.rc,cb:x.cb||w.cb,cnss:x.cnss||w.cnss,patente:x.patente||w.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),c.jsx("input",{type:"text",className:"input",value:h.rc,onChange:x=>m({...h,rc:x.target.value}),placeholder:"Ex: 217/2021"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),c.jsx("input",{type:"text",className:"input",value:h.cb,onChange:x=>m({...h,cb:x.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),c.jsx("input",{type:"text",className:"input",value:h.cnss,onChange:x=>m({...h,cnss:x.target.value}),placeholder:"Ex: 4444634"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),c.jsx("input",{type:"text",className:"input",value:h.patente,onChange:x=>m({...h,patente:x.target.value}),placeholder:"Ex: 47730296"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),c.jsx("input",{type:"text",className:"input",value:h.programme,onChange:x=>m({...h,programme:x.target.value}),placeholder:"Ex: 31000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),c.jsx("input",{type:"text",className:"input",value:h.projet,onChange:x=>m({...h,projet:x.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),c.jsx("input",{type:"text",className:"input",value:h.ligne,onChange:x=>m({...h,ligne:x.target.value}),placeholder:"Ex: 24"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),c.jsx("input",{type:"text",className:"input",value:h.chapitre,onChange:x=>m({...h,chapitre:x.target.value}),placeholder:"Ex: 320010/03012"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture"}),c.jsx("input",{type:"date",className:"input",value:h.dateOuverture,onChange:x=>m({...h,dateOuverture:x.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date d'ouverture des plis"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),c.jsx("input",{type:"number",className:"input",value:h.delaisExecution,onChange:x=>m({...h,delaisExecution:x.target.value}),placeholder:"Ex: 10",min:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dure du march en mois"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux)"}),c.jsx("input",{type:"date",className:"input",value:h.osc,onChange:x=>m({...h,osc:x.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:s,children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:s,children:s?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Enregistrement..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Yu,{className:"w-5 h-5"}),c.jsx("span",{children:"Enregistrer les modifications"})]})})]})]})]}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})})},FJ=e=>!e||e.length===0?0:e.reduce((t,r)=>{if(r.dateArret&&r.dateReprise){const n=Ai(r.dateArret),s=Ai(r.dateReprise);if(tp(n)&&tp(s))return t+Ei(s,n)}return t},0),Ug=e=>{const t=new Date,r=e.osc?Ai(e.osc):null;if(!r||!tp(r))return{status:"no-data",message:"Date OSC non dfinie"};const n=e.delaisExecution||0;if(n===0)return{status:"no-data",message:"Dlai non dfini"};const s=n*30,a=FJ(e.arrets),i=Hh(r,n),o=pU(i,a),l=Ei(t,r),u=Ei(o,t),d=s+a,f=Math.min(100,Math.max(0,l/d*100));let p;return e.dateReceptionDefinitive||e.dateReceptionProvisoire?p="completed":u<0?p="overdue":u<=15?p="critical":u<=30?p="warning":p="normal",{status:p,oscDate:r,delaiMois:n,delaiJours:s,joursArret:a,dateFinInitiale:i,dateFinEffective:o,joursEcoules:l,joursRestants:u,pourcentage:f,delaiTotal:d}},O8={normal:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",progress:"bg-green-500"},warning:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",progress:"bg-yellow-500"},critical:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",progress:"bg-red-500"},completed:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",progress:"bg-gray-500"},overdue:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-200",progress:"bg-purple-500"},"no-data":{bg:"bg-gray-50",text:"text-gray-400",border:"border-gray-100",progress:"bg-gray-300"}},DJ={normal:"En cours",warning:"Alerte",critical:"Critique",completed:"Termin",overdue:"Dpass","no-data":"Non configur"},RJ={normal:vl,warning:Q0,critical:RC,completed:bo,overdue:Q0,"no-data":vl},IJ=()=>{const{user:e}=On(),[t,r]=J.useState(null),[n,s]=J.useState("all"),{projects:a,isLoading:i,refresh:o}=Ob((e==null?void 0:e.id)||null),l=(a==null?void 0:a.reduce((p,h)=>{const m=Ug(h);return p[m.status]=(p[m.status]||0)+1,p},{}))||{},u=(a==null?void 0:a.filter(p=>n==="all"?!0:Ug(p).status===n))||[],d=async(p,h)=>{const m=a==null?void 0:a.find(x=>x.id===p);if(!m||!e)return;const g={id:Tr(),...h},y=[...m.arrets||[],g];if(St())try{await mt.updateProject(p.replace("project:",""),{arrets:y}),o()}catch(x){console.error("Error updating project:",x)}else await be.projects.update(p,{arrets:y,updatedAt:new Date().toISOString()});(t==null?void 0:t.id)===p&&r({...t,arrets:y})},f=async(p,h)=>{const m=a==null?void 0:a.find(y=>y.id===p);if(!m||!e)return;const g=(m.arrets||[]).filter(y=>y.id!==h);if(St())try{await mt.updateProject(p.replace("project:",""),{arrets:g}),o()}catch(y){console.error("Error updating project:",y)}else await be.projects.update(p,{arrets:g,updatedAt:new Date().toISOString()});(t==null?void 0:t.id)===p&&r({...t,arrets:g})};return i?c.jsx("div",{className:"flex items-center justify-center h-96",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des Dlais"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Suivi des dlais d'excution de tous les projets"})]})}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:c.jsx(vl,{className:"w-6 h-6 text-green-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.normal||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"En cours"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-100 flex items-center justify-center",children:c.jsx(Q0,{className:"w-6 h-6 text-yellow-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.warning||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Alerte"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center",children:c.jsx(RC,{className:"w-6 h-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.critical||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Critique"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:c.jsx(Q0,{className:"w-6 h-6 text-purple-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.overdue||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Dpass"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-100 flex items-center justify-center",children:c.jsx(bo,{className:"w-6 h-6 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.completed||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Termins"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("select",{className:"input w-48",value:n,onChange:p=>s(p.target.value),children:[c.jsx("option",{value:"all",children:"Tous les projets"}),c.jsx("option",{value:"normal",children:"En cours"}),c.jsx("option",{value:"warning",children:"Alerte"}),c.jsx("option",{value:"critical",children:"Critique"}),c.jsx("option",{value:"overdue",children:"Dpass"}),c.jsx("option",{value:"completed",children:"Termins"}),c.jsx("option",{value:"no-data",children:"Non configur"})]}),c.jsxs("span",{className:"text-gray-500",children:[u.length," projet(s)"]})]}),c.jsxs("div",{className:"space-y-4",children:[u.map(p=>{const h=Ug(p),m=O8[h.status],g=RJ[h.status];return c.jsxs("div",{className:"card p-5",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.objet}),c.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${m.bg} ${m.text}`,children:[c.jsx(g,{className:"w-3 h-3"}),DJ[h.status]]})]}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",p.marcheNo,"  ",p.societe||"Socit non dfinie"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>r(p),className:"btn btn-secondary btn-sm flex items-center gap-1",children:[c.jsx(Z0,{className:"w-4 h-4"}),"Dtails"]}),c.jsxs(Pi,{to:`/projects/${p.id.replace("project:","")}`,className:"btn btn-secondary btn-sm flex items-center gap-1",children:[c.jsx(Wr,{className:"w-4 h-4"}),"Projet"]})]})]}),h.status!=="no-data"&&typeof h.pourcentage=="number"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Progression"}),c.jsxs("span",{className:"font-medium",children:[Math.round(h.pourcentage),"%"]})]}),c.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full ${m.progress} transition-all duration-300`,style:{width:`${Math.min(100,h.pourcentage)}%`}})})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Dbut (OSC)"}),c.jsx("p",{className:"font-medium",children:h.oscDate?Kn(h.oscDate,"dd/MM/yyyy"):"-"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Dlai"}),c.jsxs("p",{className:"font-medium",children:[h.delaiMois," mois"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Jours d'arrt"}),c.jsxs("p",{className:"font-medium text-orange-600",children:[h.joursArret," j"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Fin prvue"}),c.jsx("p",{className:"font-medium",children:h.dateFinEffective?Kn(h.dateFinEffective,"dd/MM/yyyy"):"-"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Reste"}),c.jsx("p",{className:`font-bold ${(h.joursRestants??0)<0?"text-purple-600":(h.joursRestants??0)<=15?"text-red-600":(h.joursRestants??0)<=30?"text-yellow-600":"text-green-600"}`,children:(h.joursRestants??0)<0?`${Math.abs(h.joursRestants??0)}j de retard`:`${h.joursRestants??0} jours`})]})]})]}),h.status==="no-data"&&c.jsx("p",{className:"text-gray-400 text-sm italic",children:h.message})]},p.id)}),u.length===0&&c.jsxs("div",{className:"card p-12 text-center",children:[c.jsx(vl,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Aucun projet trouv"})]})]}),t&&c.jsx(OJ,{project:t,onClose:()=>r(null),onAddArret:d,onDeleteArret:f})]})},OJ=({project:e,onClose:t,onAddArret:r,onDeleteArret:n})=>{const[s,a]=J.useState(!1),[i,o]=J.useState({dateArret:"",dateReprise:"",motif:""}),l=Ug(e),u=O8[l.status],d=async()=>{!i.dateArret||!i.motif||(await r(e.id,{dateArret:i.dateArret,dateReprise:i.dateReprise||void 0,motif:i.motif}),o({dateArret:"",dateReprise:"",motif:""}),a(!1))};return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"p-6 border-b sticky top-0 bg-white z-10",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dtails du Dlai"}),c.jsx("p",{className:"text-gray-500",children:e.objet})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(Bi,{className:"w-5 h-5"})})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Dlai contractuel"}),c.jsxs("p",{className:"text-xl font-bold",children:[l.delaiMois||0," mois"]})]}),c.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-orange-600",children:"Jours d'arrt"}),c.jsxs("p",{className:"text-xl font-bold text-orange-700",children:[l.joursArret||0," jours"]})]}),c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-blue-600",children:"Dlai effectif"}),c.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[l.delaiTotal||0," jours"]})]}),c.jsxs("div",{className:`p-4 rounded-lg ${u.bg}`,children:[c.jsx("p",{className:`text-sm ${u.text}`,children:"Jours restants"}),c.jsx("p",{className:`text-xl font-bold ${u.text}`,children:l.joursRestants!==void 0?l.joursRestants<0?`${Math.abs(l.joursRestants)} retard`:l.joursRestants:"-"})]})]}),l.status!=="no-data"&&l.oscDate&&l.dateFinEffective&&c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Timeline"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:c.jsx("div",{className:`h-full ${u.progress} rounded-full`,style:{width:`${Math.min(100,l.pourcentage||0)}%`}})}),c.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["OSC: ",Kn(l.oscDate,"dd/MM/yyyy")]}),c.jsxs("span",{children:["Fin: ",Kn(l.dateFinEffective,"dd/MM/yyyy")]})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:"Historique des Arrts"}),c.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[c.jsx(ms,{className:"w-4 h-4"}),"Ajouter un arrt"]})]}),s&&c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg mb-4 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date d'arrt (OSA) *"}),c.jsx("input",{type:"date",className:"input",value:i.dateArret,onChange:f=>o({...i,dateArret:f.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de reprise (OSR)"}),c.jsx("input",{type:"date",className:"input",value:i.dateReprise,onChange:f=>o({...i,dateReprise:f.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motif *"}),c.jsx("input",{type:"text",className:"input",placeholder:"Ex: Vague de froid",value:i.motif,onChange:f=>o({...i,motif:f.target.value})})]})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>a(!1),className:"btn btn-secondary btn-sm",children:"Annuler"}),c.jsxs("button",{onClick:d,className:"btn btn-primary btn-sm flex items-center gap-1",disabled:!i.dateArret||!i.motif,children:[c.jsx(Yu,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),e.arrets&&e.arrets.length>0?c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Arrt (OSA)"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Reprise (OSR)"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Dure"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Motif"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y",children:e.arrets.map((f,p)=>{const h=f.dateArret&&f.dateReprise?Ei(Ai(f.dateReprise),Ai(f.dateArret)):null;return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-sm",children:p+1}),c.jsx("td",{className:"px-4 py-3 text-sm",children:c.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[c.jsx(kS,{className:"w-3 h-3"}),f.dateArret?Kn(Ai(f.dateArret),"dd/MM/yyyy"):"-"]})}),c.jsx("td",{className:"px-4 py-3 text-sm",children:f.dateReprise?c.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[c.jsx(CB,{className:"w-3 h-3"}),Kn(Ai(f.dateReprise),"dd/MM/yyyy")]}):c.jsx("span",{className:"text-orange-500 italic",children:"En cours"})}),c.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:h!==null?`${h} jours`:"-"}),c.jsx("td",{className:"px-4 py-3 text-sm",children:f.motif}),c.jsx("td",{className:"px-4 py-3 text-center",children:c.jsx("button",{onClick:()=>n(e.id,f.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",title:"Supprimer",children:c.jsx(Bi,{className:"w-4 h-4"})})})]},f.id)})})]})}):c.jsxs("div",{className:"text-center py-8 text-gray-400",children:[c.jsx(kS,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),c.jsx("p",{children:"Aucun arrt enregistr"})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Dates importantes"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Ordre de Service (OSC)"}),c.jsx("p",{className:"font-medium",children:e.osc?Kn(Ai(e.osc),"dd/MM/yyyy"):"Non dfini"})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Provisoire"}),c.jsx("p",{className:"font-medium",children:e.dateReceptionProvisoire?Kn(Ai(e.dateReceptionProvisoire),"dd/MM/yyyy"):"Non dfini"})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Dfinitive"}),c.jsx("p",{className:"font-medium",children:e.dateReceptionDefinitive?Kn(Ai(e.dateReceptionDefinitive),"dd/MM/yyyy"):"Non dfini"})]})]})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:c.jsx("button",{onClick:t,className:"btn btn-secondary",children:"Fermer"})})]})})},MJ=()=>{const{projectId:e}=Ku(),t=$s(),{user:r}=On(),[n,s]=J.useState(null),[a,i]=J.useState(null),[o,l]=J.useState([]),[u,d]=J.useState(!0),f=e!=null&&e.includes(":")?e.split(":").pop():e,p=e!=null&&e.includes(":")?e:`project:${e}`,h=J.useCallback(async()=>{if(f)try{console.log(` [BordereauPage] Fetching project ${f}...`);const x=await mt.getProject(f),w=x.data||x;i(w),console.log(" [BordereauPage] Loaded project",w)}catch(x){console.error(" [BordereauPage] Failed to fetch project:",x)}},[f]),m=J.useCallback(async()=>{if(f)try{console.log(` [BordereauPage] Fetching bordereaux for ${f}...`);const x=await mt.getBordereaux(f),b=(x.data||x).filter(N=>!N.deletedAt);l(b),console.log(` [BordereauPage] Loaded ${b.length} bordereaux`)}catch(x){console.error(" [BordereauPage] Failed to fetch bordereaux:",x)}},[f]);J.useEffect(()=>{(async()=>{d(!0),await Promise.all([h(),m()]),d(!1)})()},[h,m]);const g=o[0]||null,y=async x=>{if(!r||!p)return;const w=`bordereau:${Tr()}`,b=w.replace("bordereau:",""),N=new Date().toISOString(),A={id:w,projectId:p,userId:r.id,reference:x.reference,designation:x.designation,lignes:[],montantTotal:0,createdAt:N,updatedAt:N};if(St())try{console.log(" [BordereauPage] Creating bordereau..."),await mt.createBordereau({projectId:f,reference:x.reference,designation:x.designation,lignes:[],montantTotal:0}),console.log(" [BordereauPage] Bordereau created, refreshing..."),await m(),console.log(" [BordereauPage] Refresh completed")}catch(P){throw console.error(" [BordereauPage] Failed to create bordereau:",P),P}else await be.bordereaux.add(A),await ps("CREATE","bordereau",b,A,r.id);s(null)};return u?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):a?c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(`/projects/${p}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),"Retour au projet"]}),c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bordereau des Prix"}),c.jsx("p",{className:"text-gray-600",children:a.objet}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",a.marcheNo," - ",a.annee]})]})})]}),g?c.jsx(WC,{bordereauId:g.id,onClose:()=>t(`/projects/${p}`),onSaved:()=>{h(),m()}}):c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center py-8 mb-6",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),c.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("button",{onClick:()=>s("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(ms,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),c.jsx("button",{onClick:()=>s("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(FC,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),c.jsx("button",{onClick:()=>s("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(P1,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),c.jsx("button",{onClick:()=>s("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Tp,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]}),n==="blank"&&c.jsx(VC,{onClose:()=>s(null),onCreate:y}),n==="template"&&c.jsx(KC,{projectId:p,onClose:()=>s(null),onCreated:async()=>{console.log(" [BordereauPage] Template created, refreshing..."),await m(),s(null)}}),n==="copy"&&c.jsx(GC,{currentProjectId:p,onClose:()=>s(null),onCopied:async()=>{console.log(" [BordereauPage] Copy created, refreshing..."),await m(),s(null)}}),n==="import"&&c.jsx(C8,{projectId:p,onClose:()=>s(null),onImported:async()=>{console.log(" [BordereauPage] Import created, refreshing..."),await m(),s(null)}})]}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ni,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),c.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Synchronisez les donnes ou vrifiez l'URL"}),c.jsx("button",{onClick:()=>t("/projects"),className:"btn btn-primary",children:"Retour aux projets"})]})})},M8={"M":{unite:"M",type:"volume",label:"Volume",formule:"Longueur  Largeur  Profondeur",champs:["longueur","largeur","profondeur"],description:"Calcul de volume (terrassement, bton, etc.)"},"M":{unite:"M",type:"surface",label:"Surface",formule:"Longueur  Largeur",champs:["longueur","largeur"],description:"Calcul de surface (carrelage, enduit, etc.)"},ML:{unite:"ML",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},M:{unite:"M",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},KG:{unite:"KG",type:"poids",label:"Poids (KG)",formule:"Nombre  Longueur  Poids unitaire",champs:["nombre","longueur","diametre"],description:"Poids en kilogrammes (ferraillage)"},T:{unite:"T",type:"poids",label:"Poids (T)",formule:"Nombre  Longueur  Poids unitaire  1000",champs:["nombre","longueur","diametre"],description:"Poids en tonnes (ferraillage)"},U:{unite:"U",type:"unite",label:"Unit",formule:"Nombre",champs:["nombre"],description:"Nombre d'units"},ENS:{unite:"ENS",type:"unite",label:"Ensemble",formule:"Nombre",champs:["nombre"],description:"Nombre d'ensembles"}};function BJ(e){return M8[e]}const UJ={6:.222,8:.395,10:.617,12:.888,14:1.208,16:1.578,20:2.466,25:3.854,32:6.313,40:9.864};function $J(e){return UJ[e]||0}function zJ(e,t,r,n,s,a,i){const o=M8[e],l=i&&i>0?i:1;let u=0;switch(o.type){case"volume":u=(t||0)*(r||0)*(n||0);break;case"surface":u=(t||0)*(r||0);break;case"lineaire":u=t||0;break;case"poids":{const d=$J(a||0),f=(s||0)*(t||0)*d;u=e==="T"?f/1e3:f;break}case"unite":u=s||0;break;default:u=0}return u*l}const Uk=[{bg:"bg-blue-100",border:"border-blue-400",text:"text-blue-800",header:"bg-blue-500"},{bg:"bg-green-100",border:"border-green-400",text:"text-green-800",header:"bg-green-500"},{bg:"bg-purple-100",border:"border-purple-400",text:"text-purple-800",header:"bg-purple-500"},{bg:"bg-orange-100",border:"border-orange-400",text:"text-orange-800",header:"bg-orange-500"},{bg:"bg-pink-100",border:"border-pink-400",text:"text-pink-800",header:"bg-pink-500"},{bg:"bg-cyan-100",border:"border-cyan-400",text:"text-cyan-800",header:"bg-cyan-500"}],$k=[{bg:"bg-red-50",border:"border-red-300",text:"text-red-700"},{bg:"bg-amber-50",border:"border-amber-300",text:"text-amber-700"},{bg:"bg-lime-50",border:"border-lime-300",text:"text-lime-700"},{bg:"bg-teal-50",border:"border-teal-300",text:"text-teal-700"},{bg:"bg-indigo-50",border:"border-indigo-300",text:"text-indigo-700"}],rg=()=>{const{projectId:e,periodeId:t}=Ku(),r=$s(),{user:n}=On(),{setDirty:s,clearDirty:a}=Rb(),i=`metre-${e}-${t}`,[o,l]=J.useState([]),[u,d]=J.useState(!1),[f,p]=J.useState(!1),[h,m]=J.useState(!1),[g,y]=J.useState(null),[x,w]=J.useState(null),[b,N]=J.useState(!1),[A,P]=J.useState(new Date().toISOString().split("T")[0]),[j,D]=J.useState(!1),E=J.useRef(!1),I=e!=null&&e.includes(":")?e:`project:${e}`,_=t?t.includes(":")?t:`periode:${t}`:null;J.useEffect(()=>()=>{a(i)},[i,a]),J.useEffect(()=>{const Ne=Ie=>{if(b)return Ie.preventDefault(),Ie.returnValue="Vous avez des modifications non enregistres. Voulez-vous vraiment quitter?",Ie.returnValue};return window.addEventListener("beforeunload",Ne),()=>window.removeEventListener("beforeunload",Ne)},[b]);const L=J.useCallback(()=>{E.current=!0,b||(N(!0),s(i,`Mtr ${t}`))},[b,i,t,s]),M=J.useCallback(()=>{E.current=!1,N(!1),a(i)},[i,a]),{project:K,refresh:Z}=Rx(I),{bordereau:ae,refresh:he}=Mb(I),{periodes:re,refresh:U}=Bb(I),{metres:ue,refresh:pe}=Ub(I),C=J.useMemo(()=>{if(!_||!re)return;const Ne=_.replace("periode:","");return re.find(Ie=>Ie.id===_||Ie.id===Ne)},[_,re]);J.useEffect(()=>{if(C){const Ne=C.dateFin||C.dateDebut||new Date().toISOString();P(Ne.split("T")[0]),D(C.isDecompteDernier||!1)}},[C]);const R=Ne=>Ne?Ne.replace(/^bordereau:/,""):"",B=Ne=>Ne?Ne.replace(/^periode:/,""):"",O=Ne=>Uk[Ne%Uk.length],Y=Ne=>$k[Ne%$k.length],ie=J.useMemo(()=>C?C.numero:0,[C]),me=J.useMemo(()=>{if(!ue||!re||!_)return new Map;const Ne=new Map,Ie=[...re].sort((Ge,He)=>Ge.numero-He.numero);for(const Ge of ue){const He=B(Ge.periodeId),Be=Ie.find(Qe=>Qe.id===Ge.periodeId||Qe.id===He||B(Qe.id)===He);if(!Be||Be.numero>=ie)continue;const $e=R(Ge.bordereauLigneId);Ne.has($e)||Ne.set($e,{sections:[],subSections:[],lignes:[],total:0});const ft=Ne.get($e);if(Ge.sections)for(const Qe of Ge.sections){const zt={...Qe,periodeId:Ge.periodeId,periodeNumero:Be.numero,isFromPreviousPeriode:B(Ge.periodeId)!==B(_)};ft.sections.push(zt)}if(Ge.subSections)for(const Qe of Ge.subSections){const zt={...Qe,periodeId:Ge.periodeId,periodeNumero:Be.numero,isFromPreviousPeriode:B(Ge.periodeId)!==B(_)};ft.subSections.push(zt)}if(Ge.lignes)for(const Qe of Ge.lignes){const zt={...Qe,periodeId:Ge.periodeId,periodeNumero:Be.numero,isFromPreviousPeriode:B(Ge.periodeId)!==B(_)};ft.lignes.push(zt)}const Ye=Number(Ge.totalPartiel)||0;ft.total+=Ye}return Ne},[ue,re,_,ie]),ge=J.useRef(!1);J.useEffect(()=>{if(E.current||b){console.log(" Skipping data reload - unsaved changes present (ref:",E.current,", state:",b,")");return}if(ae&&ue!==void 0&&C){const Ne=ae.lignes.map(Ie=>{var zt,Dt,_n,wr,Et;const He=`${R(ae.id)}-ligne-${Ie.numero}`,Be=me.get(He),$e=ue==null?void 0:ue.find(sr=>R(sr.bordereauLigneId)===He&&B(sr.periodeId)===B(_));console.log(" Loading data for ligne:",He,{foundCurrentMetre:!!$e,currentMetreId:$e==null?void 0:$e.id,currentMetreSections:((zt=$e==null?void 0:$e.sections)==null?void 0:zt.length)||0,currentMetreSubSections:((Dt=$e==null?void 0:$e.subSections)==null?void 0:Dt.length)||0,currentMetreLignes:((_n=$e==null?void 0:$e.lignes)==null?void 0:_n.length)||0,rawSections:$e==null?void 0:$e.sections,rawSubSections:$e==null?void 0:$e.subSections,cumulData:Be?{sections:(wr=Be.sections)==null?void 0:wr.length,lignes:(Et=Be.lignes)==null?void 0:Et.length}:null});const ft=[...(Be==null?void 0:Be.sections)||[],...(($e==null?void 0:$e.sections)||[]).map(sr=>({...sr,periodeId:_,periodeNumero:C.numero,isFromPreviousPeriode:!1}))],Ye=[...(Be==null?void 0:Be.subSections)||[],...(($e==null?void 0:$e.subSections)||[]).map(sr=>({...sr,periodeId:_,periodeNumero:C.numero,isFromPreviousPeriode:!1}))],Qe=[...(Be==null?void 0:Be.lignes)||[],...(($e==null?void 0:$e.lignes)||[]).map(sr=>({...sr,periodeId:_,periodeNumero:C.numero,isFromPreviousPeriode:!1}))];return{bordereauLigneId:He,numeroLigne:Ie.numero,designation:Ie.designation,unite:Ie.unite,quantiteBordereau:Ie.quantite,prixUnitaire:Ie.prixUnitaire||0,sections:ft,subSections:Ye,lignes:Qe,isExpanded:!1,cumulPrecedent:(Be==null?void 0:Be.total)||0}});l(Ne),ge.current||(ge.current=!0)}},[ae,ue,me,C,b,_]);const xe=Ne=>{const Ie=o.find(He=>He.bordereauLigneId===Ne);if(!Ie)return;L();const Ge={id:`section-${Tr()}`,titre:"",ordre:Ie.sections.length+1,isCollapsed:!1,isFromPreviousPeriode:!1};l(He=>He.map(Be=>Be.bordereauLigneId===Ne?{...Be,sections:[...Be.sections,Ge],isExpanded:!0}:Be)),y(Ge.id)},Le=(Ne,Ie,Ge)=>{L(),l(He=>He.map(Be=>Be.bordereauLigneId===Ne?{...Be,sections:Be.sections.map($e=>$e.id===Ie?{...$e,titre:Ge}:$e)}:Be))},z=(Ne,Ie)=>{confirm("Supprimer cette section et toutes ses sous-sections et mesures ?")&&(L(),l(Ge=>Ge.map(He=>He.bordereauLigneId===Ne?{...He,sections:He.sections.filter(Be=>Be.id!==Ie),subSections:He.subSections.filter(Be=>Be.sectionId!==Ie),lignes:He.lignes.filter(Be=>Be.sectionId!==Ie)}:He)))},Re=(Ne,Ie)=>{l(Ge=>Ge.map(He=>He.bordereauLigneId===Ne?{...He,sections:He.sections.map(Be=>Be.id===Ie?{...Be,isCollapsed:!Be.isCollapsed}:Be)}:He))},Fe=(Ne,Ie)=>{const Ge=o.find(Qe=>Qe.bordereauLigneId===Ne);if(!Ge)return;L();const He=Ge.subSections.filter(Qe=>Qe.sectionId===Ie),Be=Ge.unite==="KG"||Ge.unite==="T",$e=`subsection-${Tr()}`,ft={id:$e,sectionId:Ie,titre:"",ordre:He.length+1,isCollapsed:!1,nombreElements:1,isFromPreviousPeriode:!1},Ye=Be?[{id:`${Ne}-mesure-${Date.now()}-1`,sectionId:Ie,subSectionId:$e,numero:1,designation:"filantes Longi  f 10 mm   esp 0,20",partiel:0,isFromPreviousPeriode:!1},{id:`${Ne}-mesure-${Date.now()}-2`,sectionId:Ie,subSectionId:$e,numero:2,designation:"Cadres filantes  f 8 mm   esp 0,20",partiel:0,isFromPreviousPeriode:!1}]:[];l(Qe=>Qe.map(zt=>zt.bordereauLigneId===Ne?{...zt,subSections:[...zt.subSections,ft],lignes:[...zt.lignes,...Ye]}:zt)),w(ft.id)},X=(Ne,Ie,Ge)=>{L(),l(He=>He.map(Be=>Be.bordereauLigneId===Ne?{...Be,subSections:Be.subSections.map($e=>$e.id===Ie?{...$e,titre:Ge}:$e)}:Be))},Oe=(Ne,Ie,Ge)=>{L(),l(He=>He.map(Be=>Be.bordereauLigneId===Ne?{...Be,subSections:Be.subSections.map($e=>$e.id===Ie?{...$e,nombreElements:Ge}:$e)}:Be))},Me=(Ne,Ie)=>{confirm("Supprimer cette sous-section et toutes ses mesures ?")&&(L(),l(Ge=>Ge.map(He=>He.bordereauLigneId===Ne?{...He,subSections:He.subSections.filter(Be=>Be.id!==Ie),lignes:He.lignes.filter(Be=>Be.subSectionId!==Ie)}:He)))},st=(Ne,Ie)=>{l(Ge=>Ge.map(He=>He.bordereauLigneId===Ne?{...He,subSections:He.subSections.map(Be=>Be.id===Ie?{...Be,isCollapsed:!Be.isCollapsed}:Be)}:He))},Ue=(Ne,Ie,Ge)=>{const He=o.find(Ye=>Ye.bordereauLigneId===Ne);if(!He)return;L();let Be=He.lignes;Ge?Be=He.lignes.filter(Ye=>Ye.subSectionId===Ge):Ie&&(Be=He.lignes.filter(Ye=>Ye.sectionId===Ie&&!Ye.subSectionId));const $e=Be.length+1,ft={id:`${Ne}-mesure-${Date.now()}`,sectionId:Ie,subSectionId:Ge,numero:$e,designation:"",partiel:0,isFromPreviousPeriode:!1};l(Ye=>Ye.map(Qe=>Qe.bordereauLigneId===Ne?{...Qe,lignes:[...Qe.lignes,ft],isExpanded:!0}:Qe))},xt=(Ne,Ie)=>{L(),l(Ge=>Ge.map(He=>He.bordereauLigneId===Ne?{...He,lignes:He.lignes.filter(Be=>Be.id!==Ie)}:He))},tt=(Ne,Ie,Ge,He)=>{L(),l(Be=>Be.map($e=>{if($e.bordereauLigneId!==Ne)return $e;const ft=$e.lignes.map(Ye=>{if(Ye.id!==Ie)return Ye;const Qe={...Ye,[Ge]:He};if(["nombreSemblables","nombreElements","longueur","largeur","profondeur","nombre","diametre"].includes(Ge)){const zt=zJ($e.unite,Qe.longueur,Qe.largeur,Qe.profondeur,Qe.nombre,Qe.diametre,Qe.nombreSemblables),Dt=Qe.nombreElements||1;Qe.partiel=zt*Dt}return Qe});return{...$e,lignes:ft}}))},gt=Ne=>{l(Ie=>Ie.map(Ge=>Ge.bordereauLigneId===Ne?{...Ge,isExpanded:!Ge.isExpanded}:Ge))},ct=async()=>{var Ne,Ie,Ge,He,Be,$e;if(!n||!I||!ae||!_){alert(" Erreur: Priode non dfinie. Veuillez revenir  la liste des mtrs.");return}d(!0);try{const ft=new Date().toISOString();console.log(" Starting save... metresQuick count:",o.length),console.log(" periodeId:",_),console.log(" projectId:",I),console.log(" allProjectMetres:",ue==null?void 0:ue.length,ue==null?void 0:ue.map(Qe=>({id:Qe.id,bordereauLigneId:Qe.bordereauLigneId,periodeId:Qe.periodeId})));for(const Qe of o){const zt=Qe.sections.filter(te=>te.isFromPreviousPeriode!==!0),Dt=Qe.subSections.filter(te=>te.isFromPreviousPeriode!==!0),_n=Qe.lignes.filter(te=>te.isFromPreviousPeriode!==!0);console.log(" Article:",Qe.bordereauLigneId),console.log("  - All sections:",Qe.sections.length,"Current:",zt.length),console.log("  - All subSections:",Qe.subSections.length,"Current:",Dt.length),console.log("  - All lignes:",Qe.lignes.length,"Current:",_n.length),console.log("  - Lignes data:",Qe.lignes.map(te=>({id:te.id,partiel:te.partiel,isFromPrev:te.isFromPreviousPeriode})));const wr=_n.reduce((te,ee)=>te+(Number(ee.partiel)||0),0),Et=Number(Qe.cumulPrecedent)||0,sr=Et+wr;console.log("   Totals:",{cumulPrecedent:Et,totalPartielCurrentPeriode:wr,totalCumule:sr});const va=Qe.quantiteBordereau>0?sr/Qe.quantiteBordereau*100:0,pn=Math.min(Math.max(va,-999.99),999.99),Pr=ue==null?void 0:ue.find(te=>te.bordereauLigneId===Qe.bordereauLigneId&&B(te.periodeId)===B(_));console.log("   Looking for existing metre:",{searchBordereauLigneId:Qe.bordereauLigneId,searchPeriodeId:_,found:!!Pr,existingMetreId:Pr==null?void 0:Pr.id,allMetresCount:ue==null?void 0:ue.length,allMetresBordereauIds:ue==null?void 0:ue.map(te=>te.bordereauLigneId)});const fr=zt.map(te=>{const{periodeId:ee,periodeNumero:se,isFromPreviousPeriode:oe,...fe}=te;return fe}),br=Dt.map(te=>{const{periodeId:ee,periodeNumero:se,isFromPreviousPeriode:oe,...fe}=te;return fe}),W=_n.map(te=>{const{periodeId:ee,periodeNumero:se,isFromPreviousPeriode:oe,...fe}=te;return fe});if(W.length===0&&fr.length===0&&br.length===0){console.log("   Skipping - no data for current period");continue}if(console.log("   Saving:",W.length,"lignes,",fr.length,"sections,",br.length,"subSections"),console.log("   Clean Sections to save:",JSON.stringify(fr)),console.log("   Clean SubSections to save:",JSON.stringify(br)),console.log("   Clean Lignes to save:",JSON.stringify(W)),St()){const te={projectId:I.replace("project:",""),periodeId:_.replace("periode:",""),bordereauLigneId:Qe.bordereauLigneId,userId:n.id.replace("user:",""),reference:`METRE-L${Qe.numeroLigne}`,designationBordereau:Qe.designation,unite:Qe.unite,sections:fr,subSections:br,lignes:W,totalPartiel:wr,totalCumule:sr,quantiteBordereau:Qe.quantiteBordereau,pourcentageRealisation:pn};Pr?(console.log("   [WEB] Updating existing metre:",Pr.id),await mt.updateMetre(Pr.id.replace("metre:",""),te),console.log("   [WEB] Metre updated successfully!")):(console.log("   [WEB] Creating new metre"),await mt.createMetre(te),console.log("   [WEB] Metre created successfully!"))}else if(Pr){console.log("   Updating existing metre:",Pr.id,{sections:fr,subSections:br,lignes:W}),await be.metres.update(Pr.id,{sections:fr,subSections:br,lignes:W,totalPartiel:wr,totalCumule:sr,pourcentageRealisation:pn,updatedAt:ft}),console.log("   Metre updated successfully!");const te=await be.metres.get(Pr.id);console.log("   Verification - Updated metre:",te?{id:te.id,sectionsCount:(Ne=te.sections)==null?void 0:Ne.length,subSectionsCount:(Ie=te.subSections)==null?void 0:Ie.length,lignesCount:(Ge=te.lignes)==null?void 0:Ge.length,sections:te.sections,lignes:te.lignes}:"NOT FOUND!"),await ps("UPDATE","metre",Pr.id.replace("metre:",""),{sections:fr,subSections:br,lignes:W,totalPartiel:wr,totalCumule:sr,pourcentageRealisation:pn},n.id)}else{const te=`metre:${Tr()}`;console.log("   Creating new metre:",te,{bordereauLigneId:Qe.bordereauLigneId,sections:fr,subSections:br,lignes:W});const ee={id:te,projectId:I,periodeId:_,bordereauLigneId:Qe.bordereauLigneId,userId:n.id,reference:`METRE-L${Qe.numeroLigne}`,designationBordereau:Qe.designation,unite:Qe.unite,sections:fr,subSections:br,lignes:W,totalPartiel:wr,totalCumule:sr,quantiteBordereau:Qe.quantiteBordereau,pourcentageRealisation:pn,createdAt:ft,updatedAt:ft};await be.metres.add(ee),console.log("   Metre created successfully!");const se=await be.metres.get(te);console.log("   Verification - Saved metre:",se?{id:se.id,sectionsCount:(He=se.sections)==null?void 0:He.length,subSectionsCount:(Be=se.subSections)==null?void 0:Be.length,lignesCount:($e=se.lignes)==null?void 0:$e.length}:"NOT FOUND!"),await ps("CREATE","metre",te.replace("metre:",""),ee,n.id)}}const Ye={dateFin:A+"T23:59:59.999Z",isDecompteDernier:j,updatedAt:ft};St()?await mt.updatePeriode(_.replace("periode:",""),Ye):(await be.periodes.update(_,Ye),await ps("UPDATE","periode",_.replace("periode:",""),{dateFin:A,isDecompteDernier:j},n.id)),M(),await pe(),await U(),alert(" Mtrs enregistrs avec succs !")}catch(ft){console.error("Erreur lors de la sauvegarde:",ft),alert(" Erreur lors de la sauvegarde des mtrs")}finally{d(!1)}},Mt=async()=>{m(!0);try{if(St())await Promise.all([Z(),he(),U(),pe()]);else{const Ne=I.replace("project:","");await Cd(Ne)}}catch(Ne){console.error("Error refreshing data:",Ne)}finally{m(!1)}},It=()=>{const Ne=I.replace("project:",""),Ie=(_==null?void 0:_.replace("periode:",""))||"";r(`/projects/${Ne}/periodes/${Ie}/attachement`)},Pt=()=>o.reduce((Ne,Ie)=>{const Ge=Ie.lignes.reduce((He,Be)=>He+Be.partiel,0);return Ne+Ge},0),Jt=()=>o.reduce((Ne,Ie)=>Ne+Ie.quantiteBordereau,0),Lt=()=>{const Ne=Jt();return Ne>0?Pt()/Ne*100:0},pt=()=>o.reduce((Ne,Ie)=>{const Ge=Ie.lignes.reduce((He,Be)=>He+Be.partiel,0);return Ne+Ge*Ie.prixUnitaire},0),it=()=>o.reduce((Ne,Ie)=>Ne+Ie.quantiteBordereau*Ie.prixUnitaire,0),ot=()=>{const Ne=it();return Ne>0?pt()/Ne*100:0},ir=(Ne,Ie)=>Ne.lignes.filter(Ge=>Ge.sectionId===Ie).reduce((Ge,He)=>Ge+He.partiel,0),Ft=(Ne,Ie)=>{const Ge=Ne.subSections.find($e=>$e.id===Ie),He=(Ge==null?void 0:Ge.nombreElements)||1;return Ne.lignes.filter($e=>$e.subSectionId===Ie).reduce(($e,ft)=>$e+ft.partiel,0)*He},Ot=f?o.filter(Ne=>Ne.lignes.length>0||Ne.sections.length>0):o;if(!K)return c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement du projet..."})]})});if(!ae)return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:()=>r(`/projects/${I}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),"Retour au projet"]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun bordereau"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),c.jsxs("button",{onClick:()=>r(`/projects/${I}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Wr,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})]});const qt=(Ne,Ie,Ge,He)=>{const Be=BJ(Ne.unite),$e=(Be==null?void 0:Be.champs)||[];let ft=Ne.lignes;return Ge?ft=Ne.lignes.filter(Ye=>Ye.subSectionId===Ge):Ie?ft=Ne.lignes.filter(Ye=>Ye.sectionId===Ie&&!Ye.subSectionId):ft=Ne.lignes.filter(Ye=>!Ye.sectionId),ft.length===0?c.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:c.jsx("p",{children:'Aucune mesure. Cliquez sur "+ Ajouter mesure" pour commencer.'})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:`w-full border ${He||"border-gray-300"}`,children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300 w-12",children:"N"}),c.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation"}),["M","M","ML","M"].includes(Ne.unite)&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-16",title:"Nombre des parties semblables",children:"Nbre"}),$e.includes("longueur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Longueur (m)"}),$e.includes("largeur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Largeur (m)"}),$e.includes("profondeur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Profondeur (m)"}),$e.includes("nombre")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-20",children:"Nombre"}),$e.includes("diametre")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Diamtre (mm)"}),["KG","T"].includes(Ne.unite)&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-20 bg-yellow-50",title:"Nombre d'lments (poteaux, poutres...)",children:"N.lm"}),c.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-gray-700 border-r border-gray-300 w-28 bg-blue-50",children:"Partiel"}),c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 w-16",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:ft.map((Ye,Qe)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-3 py-2 text-gray-700 font-medium border-r border-gray-200",children:Qe+1}),c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"text",value:Ye.designation,onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"designation",zt.target.value),className:"input text-sm w-full",placeholder:"Mesure / Description..."})}),["M","M","ML","M"].includes(Ne.unite)&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.nombreSemblables||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"nombreSemblables",parseInt(zt.target.value)||1),className:"input text-sm text-center w-full",step:"1",min:"1",placeholder:"1"})}),$e.includes("longueur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.longueur||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"longueur",parseFloat(zt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),$e.includes("largeur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.largeur||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"largeur",parseFloat(zt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),$e.includes("profondeur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.profondeur||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"profondeur",parseFloat(zt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),$e.includes("nombre")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.nombre||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"nombre",parseInt(zt.target.value)||0),className:"input text-sm text-center w-full",step:"1",placeholder:"0"})}),$e.includes("diametre")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Ye.diametre||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"diametre",parseFloat(zt.target.value)||0),className:"input text-sm text-center w-full",step:"0.1",placeholder:"0"})}),["KG","T"].includes(Ne.unite)&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200 bg-yellow-50",children:c.jsx("input",{type:"number",value:Ye.nombreElements||"",onChange:zt=>tt(Ne.bordereauLigneId,Ye.id,"nombreElements",parseInt(zt.target.value)||1),className:"input text-sm text-center w-full bg-yellow-50",step:"1",min:"1",placeholder:"1",title:"Nombre d'lments (poteaux, poutres...)"})}),c.jsx("td",{className:"px-3 py-2 text-right font-bold text-primary-600 border-r border-gray-200 bg-blue-50",children:Ye.partiel.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-center",children:c.jsx("button",{onClick:()=>xt(Ne.bordereauLigneId,Ye.id),className:"p-1 text-red-500 hover:bg-red-100 rounded",children:c.jsx(xs,{className:"w-4 h-4"})})})]},Ye.id))}),c.jsx("tfoot",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("td",{colSpan:2+$e.length+(["M","M","ML","M"].includes(Ne.unite)?1:0)+(["KG","T"].includes(Ne.unite)?1:0),className:"px-3 py-2 text-right font-semibold text-gray-700 border-r border-gray-300",children:"Total:"}),c.jsx("td",{className:"px-3 py-2 text-right font-bold text-primary-700 bg-primary-50 border-r border-gray-300",children:ft.reduce((Ye,Qe)=>Ye+Qe.partiel,0).toFixed(2)}),c.jsx("td",{})]})})]})})};return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r(`/projects/${e}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),"Retour au projet"]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Mtr N ",(C==null?void 0:C.numero)||""]}),j&&c.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs font-bold rounded-full",children:"et Dernier"}),c.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full",children:(C==null?void 0:C.libelle)||"Hirarchique"})]}),c.jsx("p",{className:"text-gray-700 font-medium",children:K.objet}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",K.marcheNo," - ",K.annee]}),c.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-600",children:"Date des travaux:"}),c.jsx("input",{type:"date",value:A,onChange:Ne=>{P(Ne.target.value),L()},className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:j,onChange:Ne=>{D(Ne.target.checked),L()},className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Dcompte et Dernier"})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:Mt,disabled:h,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(No,{className:`w-4 h-4 ${h?"animate-spin":""}`}),"Actualiser"]}),c.jsxs("button",{onClick:It,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(DC,{className:"w-4 h-4"}),"Attachement"]}),c.jsxs("button",{onClick:()=>r(`/projects/${I}/decompte`),className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Ci,{className:"w-4 h-4"}),"Dcompte"]}),c.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Sl,{className:"w-4 h-4"}),"Exporter"]}),c.jsx("button",{onClick:ct,disabled:u,className:`btn flex items-center gap-2 ${b?"btn-primary bg-orange-500 hover:bg-orange-600 animate-pulse":"btn-primary"}`,children:u?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enregistrement..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Yu,{className:"w-4 h-4"}),b?" Enregistrer":"Enregistrer"]})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(PC,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ae.lignes.length}),c.jsx("p",{className:"text-sm text-gray-600",children:"Lignes bordereau"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(dc,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pt().toFixed(2)}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total ralis"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(bo,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsxs("p",{className:`text-2xl font-bold ${Lt()>100?"text-orange-600":"text-gray-900"}`,children:[Lt().toFixed(1),"%"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Avancement quantit"})]})]})}),c.jsx("div",{className:`card ${ot()>100?"border-2 border-orange-400 bg-orange-50":""}`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:c.jsx(Ci,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsxs("p",{className:`text-2xl font-bold ${ot()>100?"text-orange-600":"text-gray-900"}`,children:[ot().toFixed(1),"%"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Avancement financier"})]})]})})]}),c.jsx("div",{className:"card mb-6 bg-gradient-to-r from-primary-50 to-blue-50",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Montant Bordereau (HT)"}),c.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[it().toLocaleString("fr-MA",{minimumFractionDigits:2})," DH"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Montant Ralis (HT)"}),c.jsxs("p",{className:"text-xl font-bold text-primary-600",children:[pt().toLocaleString("fr-MA",{minimumFractionDigits:2})," DH"]})]})]})}),c.jsx("div",{className:"card mb-4 bg-gradient-to-r from-gray-50 to-slate-50",children:c.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(hv,{className:"w-4 h-4 text-blue-600"}),c.jsx("span",{className:"font-medium",children:"Section"}),c.jsx("span",{className:"text-gray-500",children:"= Douar / Lieu"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(rf,{className:"w-4 h-4 text-red-600"}),c.jsx("span",{className:"font-medium",children:"Sous-section"}),c.jsx("span",{className:"text-gray-500",children:"= lment (semeille, radier, voile...)"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(wB,{className:"w-4 h-4 text-gray-600"}),c.jsx("span",{className:"font-medium",children:"Mesure"}),c.jsx("span",{className:"text-gray-500",children:"= Ligne de calcul"})]})]})}),c.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[c.jsxs("button",{onClick:()=>p(!f),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition ${f?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[f?c.jsx(Z0,{className:"w-4 h-4"}):c.jsx(pB,{className:"w-4 h-4"}),f?"Afficher tout":"Uniquement les mtrs"]}),c.jsxs("span",{className:"text-sm text-gray-500",children:[Ot.length," / ",o.length," lignes affiches"]})]}),c.jsx("div",{className:"card",children:c.jsx("div",{className:"space-y-3",children:Ot.map(Ne=>{const Ie=Ne.lignes.reduce(($e,ft)=>$e+ft.partiel,0),Ge=Ne.quantiteBordereau>0?Ie/Ne.quantiteBordereau*100:0,He=Ge>=100,Be=Ie>0;return c.jsxs("div",{className:`border-2 rounded-xl overflow-hidden shadow-sm ${He?Ge>100?"border-orange-400 bg-orange-50/50":"border-green-400 bg-green-50/50":"border-gray-200"}`,children:[c.jsxs("div",{className:"flex items-center gap-4 p-4 cursor-pointer hover:bg-gray-50 transition bg-white",onClick:()=>gt(Ne.bordereauLigneId),children:[Ne.isExpanded?c.jsx(dv,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):c.jsx(ul,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}),c.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-primary-100 text-primary-700 font-bold rounded-lg text-lg",children:Ne.numeroLigne}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-gray-900 font-semibold",children:Ne.designation}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:Ne.unite}),Ne.sections.length>0&&c.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:[Ne.sections.length," section(s)"]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:["Bordereau: ",Number(Ne.quantiteBordereau||0).toLocaleString()]}),c.jsxs("div",{className:"text-lg font-bold text-primary-600",children:["Ralis: ",Number(Ie||0).toFixed(2)]})]}),c.jsx("div",{className:"w-36",children:c.jsxs("div",{className:"flex items-center gap-2",children:[He?Ge>100?c.jsx(ni,{className:"w-5 h-5 text-orange-500 flex-shrink-0"}):c.jsx(bo,{className:"w-5 h-5 text-green-500 flex-shrink-0"}):Be?c.jsx(ni,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}):c.jsx("div",{className:"w-5 h-5 flex-shrink-0"}),c.jsx("div",{className:"flex-1",children:c.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-300 ${Ge>100?"bg-gradient-to-r from-orange-400 to-red-500":He?"bg-gradient-to-r from-green-400 to-emerald-500":Ge>=75?"bg-gradient-to-r from-blue-400 to-cyan-500":"bg-gradient-to-r from-yellow-400 to-orange-500"}`,style:{width:`${Math.min(Ge,100)}%`}})})}),c.jsxs("span",{className:`text-sm font-bold w-16 text-right ${Ge>100?"text-orange-600":"text-gray-700"}`,children:[Ge.toFixed(0),"%"]})]})})]}),Ne.isExpanded&&c.jsxs("div",{className:"border-t-2 border-gray-200 bg-gray-50 p-4",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-4 border-b border-gray-200",children:[c.jsxs("button",{onClick:()=>xe(Ne.bordereauLigneId),className:"btn btn-secondary flex items-center gap-2 text-sm bg-blue-50 text-blue-700 hover:bg-blue-100 border-blue-200",children:[c.jsx(hv,{className:"w-4 h-4"}),"+ Ajouter Section (Douar)"]}),c.jsxs("button",{onClick:()=>Ue(Ne.bordereauLigneId),className:"btn btn-secondary flex items-center gap-2 text-sm",children:[c.jsx(ms,{className:"w-4 h-4"}),"+ Ajouter Mesure Directe"]})]}),Ne.lignes.filter($e=>!$e.sectionId).length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Mesures Gnrales"}),qt(Ne),c.jsxs("button",{onClick:()=>Ue(Ne.bordereauLigneId),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[c.jsx(ms,{className:"w-3 h-3"}),"Ajouter mesure"]})]}),Ne.sections.map(($e,ft)=>{const Ye=O(ft),Qe=Ne.subSections.filter(Dt=>Dt.sectionId===$e.id),zt=ir(Ne,$e.id);return c.jsxs("div",{className:`mb-4 rounded-lg border-2 ${Ye.border} ${Ye.bg} overflow-hidden`,children:[c.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${Ye.header} text-white cursor-pointer`,onClick:()=>Re(Ne.bordereauLigneId,$e.id),children:[$e.isCollapsed?c.jsx(ul,{className:"w-5 h-5"}):c.jsx(dv,{className:"w-5 h-5"}),c.jsx(hv,{className:"w-5 h-5"}),g===$e.id?c.jsx("input",{type:"text",value:$e.titre,onChange:Dt=>Le(Ne.bordereauLigneId,$e.id,Dt.target.value),onBlur:()=>y(null),onKeyDown:Dt=>Dt.key==="Enter"&&y(null),onClick:Dt=>Dt.stopPropagation(),className:"flex-1 bg-white/20 text-white placeholder-white/70 px-2 py-1 rounded border-0 focus:ring-2 focus:ring-white/50",placeholder:"Douar / Lieu...",autoFocus:!0}):c.jsx("span",{className:"flex-1 font-bold text-lg",children:$e.titre||c.jsx("span",{className:"opacity-60 italic",children:"Douar / Lieu..."})}),c.jsxs("span",{className:"px-3 py-1 bg-white/20 rounded-full text-sm font-semibold",children:["Total: ",zt.toFixed(2)]}),c.jsxs("div",{className:"flex items-center gap-1",onClick:Dt=>Dt.stopPropagation(),children:[c.jsx("button",{onClick:()=>y($e.id),className:"p-1 hover:bg-white/20 rounded",title:"Modifier",children:c.jsx(_S,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>z(Ne.bordereauLigneId,$e.id),className:"p-1 hover:bg-white/20 rounded",title:"Supprimer",children:c.jsx(xs,{className:"w-4 h-4"})})]})]}),!$e.isCollapsed&&c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsxs("button",{onClick:()=>Fe(Ne.bordereauLigneId,$e.id),className:"btn btn-secondary flex items-center gap-2 text-sm bg-white",children:[c.jsx(rf,{className:"w-4 h-4"}),"+ Ajouter lment (semeille, radier...)"]}),c.jsxs("button",{onClick:()=>Ue(Ne.bordereauLigneId,$e.id),className:"btn btn-secondary flex items-center gap-2 text-sm bg-white",children:[c.jsx(ms,{className:"w-4 h-4"}),"+ Mesure directe"]})]}),Ne.lignes.filter(Dt=>Dt.sectionId===$e.id&&!Dt.subSectionId).length>0&&c.jsx("div",{className:"mb-4 bg-white rounded-lg p-3",children:qt(Ne,$e.id,void 0,Ye.border)}),Qe.map((Dt,_n)=>{const wr=Y(_n),Et=Ft(Ne,Dt.id);return c.jsxs("div",{className:`mb-3 rounded-lg border ${wr.border} ${wr.bg} overflow-hidden`,children:[c.jsxs("div",{className:`flex items-center gap-3 px-3 py-2 bg-white border-b ${wr.border} cursor-pointer`,onClick:()=>st(Ne.bordereauLigneId,Dt.id),children:[Dt.isCollapsed?c.jsx(ul,{className:"w-4 h-4 text-gray-500"}):c.jsx(dv,{className:"w-4 h-4 text-gray-500"}),c.jsx(rf,{className:`w-4 h-4 ${wr.text}`}),x===Dt.id?c.jsx("input",{type:"text",value:Dt.titre,onChange:sr=>X(Ne.bordereauLigneId,Dt.id,sr.target.value),onBlur:()=>w(null),onKeyDown:sr=>sr.key==="Enter"&&w(null),onClick:sr=>sr.stopPropagation(),className:`flex-1 px-2 py-1 rounded border ${wr.border} focus:ring-2 focus:ring-primary-300`,placeholder:"lment (semeille, radier, poteau...)",autoFocus:!0}):c.jsx("span",{className:`flex-1 font-semibold ${wr.text}`,children:Dt.titre||c.jsx("span",{className:"opacity-60 italic",children:"lment..."})}),c.jsxs("div",{className:"flex items-center gap-1",onClick:sr=>sr.stopPropagation(),children:[c.jsx("span",{className:"text-xs text-gray-500",children:""}),c.jsx("input",{type:"number",value:Dt.nombreElements||1,onChange:sr=>Oe(Ne.bordereauLigneId,Dt.id,parseInt(sr.target.value)||1),className:"w-12 px-1 py-0.5 text-center text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary-300",min:"1",step:"1",title:"Nombre d'lments (ex: nombre de poteaux)"})]}),c.jsx("span",{className:`px-2 py-0.5 ${wr.bg} ${wr.text} rounded text-sm font-medium`,children:Et.toFixed(2)}),c.jsxs("div",{className:"flex items-center gap-1",onClick:sr=>sr.stopPropagation(),children:[c.jsx("button",{onClick:()=>w(Dt.id),className:"p-1 hover:bg-gray-100 rounded",title:"Modifier",children:c.jsx(_S,{className:"w-3 h-3 text-gray-500"})}),c.jsx("button",{onClick:()=>Me(Ne.bordereauLigneId,Dt.id),className:"p-1 hover:bg-gray-100 rounded",title:"Supprimer",children:c.jsx(xs,{className:"w-3 h-3 text-gray-500"})})]})]}),!Dt.isCollapsed&&c.jsxs("div",{className:"p-3",children:[qt(Ne,$e.id,Dt.id,wr.border),c.jsxs("button",{onClick:()=>Ue(Ne.bordereauLigneId,$e.id,Dt.id),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[c.jsx(ms,{className:"w-3 h-3"}),"Ajouter mesure"]})]})]},Dt.id)})]})]},$e.id)}),c.jsx("div",{className:"mt-4 pt-4 border-t-2 border-gray-300 bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-lg font-bold text-gray-700",children:["TOTAL PARTIEL (Article ",Ne.numeroLigne,")"]}),c.jsxs("span",{className:"text-2xl font-bold text-primary-700",children:[Ie.toFixed(2)," ",Ne.unite]})]})})]})]},Ne.bordereauLigneId)})})})]})},HJ="modulepreload",qJ=function(e){return"/"+e},zk={},$g=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=qJ(l),l in zk)return;zk[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":HJ,u||(f.as="script"),f.crossOrigin="",f.href=l,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((p,h)=>{f.addEventListener("load",p),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function Ar(e){"@babel/helpers - typeof";return Ar=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(e)}var Ui=Uint8Array,Fa=Uint16Array,m4=Int32Array,g4=new Ui([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),x4=new Ui([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Hk=new Ui([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),B8=function(e,t){for(var r=new Fa(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new m4(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},U8=B8(g4,2),WJ=U8.b,Xw=U8.r;WJ[28]=258,Xw[258]=28;var VJ=B8(x4,0),qk=VJ.r,Jw=new Fa(32768);for(var Kr=0;Kr<32768;++Kr){var ql=(Kr&43690)>>1|(Kr&21845)<<1;ql=(ql&52428)>>2|(ql&13107)<<2,ql=(ql&61680)>>4|(ql&3855)<<4,Jw[Kr]=((ql&65280)>>8|(ql&255)<<8)>>1}var y0=function(e,t,r){for(var n=e.length,s=0,a=new Fa(t);s<n;++s)e[s]&&++a[e[s]-1];var i=new Fa(t);for(s=1;s<t;++s)i[s]=i[s-1]+a[s-1]<<1;var o;if(r){o=new Fa(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var u=s<<4|e[s],d=t-e[s],f=i[e[s]-1]++<<d,p=f|(1<<d)-1;f<=p;++f)o[Jw[f]>>l]=u}else for(o=new Fa(n),s=0;s<n;++s)e[s]&&(o[s]=Jw[i[e[s]-1]++]>>15-e[s]);return o},Hu=new Ui(288);for(var Kr=0;Kr<144;++Kr)Hu[Kr]=8;for(var Kr=144;Kr<256;++Kr)Hu[Kr]=9;for(var Kr=256;Kr<280;++Kr)Hu[Kr]=7;for(var Kr=280;Kr<288;++Kr)Hu[Kr]=8;var K1=new Ui(32);for(var Kr=0;Kr<32;++Kr)K1[Kr]=5;var KJ=y0(Hu,9,0),GJ=y0(K1,5,0),$8=function(e){return(e+7)/8|0},YJ=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Ui(e.subarray(t,r))},Ko=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Lh=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},_v=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,a=r.slice();if(!s)return{t:H8,l:0};if(s==1){var i=new Ui(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(A,P){return A.f-P.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,d=1,f=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};d!=s-1;)o=r[r[u].f<r[f].f?u++:f++],l=r[u!=d&&r[u].f<r[f].f?u++:f++],r[d++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=a[0].s,n=1;n<s;++n)a[n].s>p&&(p=a[n].s);var h=new Fa(p+1),m=Qw(r[d-1],h,0);if(m>t){var n=0,g=0,y=m-t,x=1<<y;for(a.sort(function(P,j){return h[j.s]-h[P.s]||P.f-j.f});n<s;++n){var w=a[n].s;if(h[w]>t)g+=x-(1<<m-h[w]),h[w]=t;else break}for(g>>=y;g>0;){var b=a[n].s;h[b]<t?g-=1<<t-h[b]++-1:++n}for(;n>=0&&g;--n){var N=a[n].s;h[N]==t&&(--h[N],++g)}m=t}return{t:new Ui(h),l:m}},Qw=function(e,t,r){return e.s==-1?Math.max(Qw(e.l,t,r+1),Qw(e.r,t,r+1)):t[e.s]=r},Wk=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Fa(++t),n=0,s=e[0],a=1,i=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==s&&o!=t)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=e[o]}return{c:r.subarray(0,n),n:t}},Fh=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},z8=function(e,t,r){var n=r.length,s=$8(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var a=0;a<n;++a)e[s+a+4]=r[a];return(s+4+n)*8},Vk=function(e,t,r,n,s,a,i,o,l,u,d){Ko(t,d++,r),++s[256];for(var f=_v(s,15),p=f.t,h=f.l,m=_v(a,15),g=m.t,y=m.l,x=Wk(p),w=x.c,b=x.n,N=Wk(g),A=N.c,P=N.n,j=new Fa(19),D=0;D<w.length;++D)++j[w[D]&31];for(var D=0;D<A.length;++D)++j[A[D]&31];for(var E=_v(j,7),I=E.t,_=E.l,L=19;L>4&&!I[Hk[L-1]];--L);var M=u+5<<3,K=Fh(s,Hu)+Fh(a,K1)+i,Z=Fh(s,p)+Fh(a,g)+i+14+3*L+Fh(j,I)+2*j[16]+3*j[17]+7*j[18];if(l>=0&&M<=K&&M<=Z)return z8(t,d,e.subarray(l,l+u));var ae,he,re,U;if(Ko(t,d,1+(Z<K)),d+=2,Z<K){ae=y0(p,h,0),he=p,re=y0(g,y,0),U=g;var ue=y0(I,_,0);Ko(t,d,b-257),Ko(t,d+5,P-1),Ko(t,d+10,L-4),d+=14;for(var D=0;D<L;++D)Ko(t,d+3*D,I[Hk[D]]);d+=3*L;for(var pe=[w,A],C=0;C<2;++C)for(var R=pe[C],D=0;D<R.length;++D){var B=R[D]&31;Ko(t,d,ue[B]),d+=I[B],B>15&&(Ko(t,d,R[D]>>5&127),d+=R[D]>>12)}}else ae=KJ,he=Hu,re=GJ,U=K1;for(var D=0;D<o;++D){var O=n[D];if(O>255){var B=O>>18&31;Lh(t,d,ae[B+257]),d+=he[B+257],B>7&&(Ko(t,d,O>>23&31),d+=g4[B]);var Y=O&31;Lh(t,d,re[Y]),d+=U[Y],Y>3&&(Lh(t,d,O>>5&8191),d+=x4[Y])}else Lh(t,d,ae[O]),d+=he[O]}return Lh(t,d,ae[256]),d+he[256]},XJ=new m4([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),H8=new Ui(0),JJ=function(e,t,r,n,s,a){var i=a.z||e.length,o=new Ui(n+i+5*(1+Math.ceil(i/7e3))+s),l=o.subarray(n,o.length-s),u=a.l,d=(a.r||0)&7;if(t){d&&(l[0]=a.r>>3);for(var f=XJ[t-1],p=f>>13,h=f&8191,m=(1<<r)-1,g=a.p||new Fa(32768),y=a.h||new Fa(m+1),x=Math.ceil(r/3),w=2*x,b=function(Fe){return(e[Fe]^e[Fe+1]<<x^e[Fe+2]<<w)&m},N=new m4(25e3),A=new Fa(288),P=new Fa(32),j=0,D=0,E=a.i||0,I=0,_=a.w||0,L=0;E+2<i;++E){var M=b(E),K=E&32767,Z=y[M];if(g[K]=Z,y[M]=K,_<=E){var ae=i-E;if((j>7e3||I>24576)&&(ae>423||!u)){d=Vk(e,l,0,N,A,P,D,I,L,E-L,d),I=j=D=0,L=E;for(var he=0;he<286;++he)A[he]=0;for(var he=0;he<30;++he)P[he]=0}var re=2,U=0,ue=h,pe=K-Z&32767;if(ae>2&&M==b(E-pe))for(var C=Math.min(p,ae)-1,R=Math.min(32767,E),B=Math.min(258,ae);pe<=R&&--ue&&K!=Z;){if(e[E+re]==e[E+re-pe]){for(var O=0;O<B&&e[E+O]==e[E+O-pe];++O);if(O>re){if(re=O,U=pe,O>C)break;for(var Y=Math.min(pe,O-2),ie=0,he=0;he<Y;++he){var me=E-pe+he&32767,ge=g[me],xe=me-ge&32767;xe>ie&&(ie=xe,Z=me)}}}K=Z,Z=g[K],pe+=K-Z&32767}if(U){N[I++]=268435456|Xw[re]<<18|qk[U];var Le=Xw[re]&31,z=qk[U]&31;D+=g4[Le]+x4[z],++A[257+Le],++P[z],_=E+re,++j}else N[I++]=e[E],++A[e[E]]}}for(E=Math.max(E,_);E<i;++E)N[I++]=e[E],++A[e[E]];d=Vk(e,l,u,N,A,P,D,I,L,E-L,d),u||(a.r=d&7|l[d/8|0]<<3,d-=7,a.h=y,a.p=g,a.i=E,a.w=_)}else{for(var E=a.w||0;E<i+u;E+=65535){var Re=E+65535;Re>=i&&(l[d/8|0]=u,Re=i),d=z8(l,d+1,e.subarray(E,Re))}a.i=i}return YJ(o,0,n+$8(d)+s)},q8=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,a=r.length|0,i=0;i!=a;){for(var o=Math.min(i+2655,a);i<o;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},QJ=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),i=new Ui(a.length+e.length);i.set(a),i.set(e,a.length),e=i,s.w=a.length}return JJ(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},W8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},ZJ=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=q8();s.p(t.dictionary),W8(e,2,s.d())}};function Zw(e,t){t||(t={});var r=q8();r.p(e);var n=QJ(e,t,t.dictionary?6:2,4);return ZJ(n,t),W8(n,n.length-4,r.d()),n}var eQ=typeof TextDecoder<"u"&&new TextDecoder,tQ=0;try{eQ.decode(H8,{stream:!0}),tQ=1}catch{}function rQ(e){if(Array.isArray(e))return e}function nQ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,a,i,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(d){u=!0,s=d}finally{try{if(!l&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw s}}return o}}function Kk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function sQ(e,t){if(e){if(typeof e=="string")return Kk(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Kk(e,t):void 0}}function aQ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gk(e,t){return rQ(e)||nQ(e,t)||sQ(e,t)||aQ()}function Yk(e,t="utf8"){return new TextDecoder(t).decode(e)}const iQ=new TextEncoder;function oQ(e){return iQ.encode(e)}const lQ=1024*8,cQ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Ev={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class v4{constructor(t=lQ,r={}){Tt(this,"buffer");Tt(this,"byteLength");Tt(this,"byteOffset");Tt(this,"length");Tt(this,"offset");Tt(this,"lastWrittenByte");Tt(this,"littleEndian");Tt(this,"_data");Tt(this,"_mark");Tt(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,a=t.byteLength-s;let i=s;(ArrayBuffer.isView(t)||t instanceof v4)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Ev[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===cQ&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+n));o.reverse();const l=new Ev[r](o.buffer);return this.offset+=n,l.reverse(),l}const i=new Ev[r](a);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return Yk(this.readBytes(t))}decodeText(t=1,r="utf8"){return Yk(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(oQ(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Kf(e){let t=e.length;for(;--t>=0;)e[t]=0}const uQ=3,dQ=258,V8=29,fQ=256,hQ=fQ+1+V8,K8=30,pQ=512,mQ=new Array((hQ+2)*2);Kf(mQ);const gQ=new Array(K8*2);Kf(gQ);const xQ=new Array(pQ);Kf(xQ);const vQ=new Array(dQ-uQ+1);Kf(vQ);const yQ=new Array(V8);Kf(yQ);const wQ=new Array(K8);Kf(wQ);const bQ=(e,t,r,n)=>{let s=e&65535|0,a=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do s=s+t[n++]|0,a=a+s|0;while(--i);s%=65521,a%=65521}return s|a<<16|0};var e5=bQ;const NQ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},SQ=new Uint32Array(NQ()),kQ=(e,t,r,n)=>{const s=SQ,a=n+r;e^=-1;for(let i=n;i<a;i++)e=e>>>8^s[(e^t[i])&255];return e^-1};var ro=kQ,t5={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},G8={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _Q=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var EQ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)_Q(r,n)&&(e[n]=r[n])}}return e},AQ=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,a=e.length;n<a;n++){let i=e[n];r.set(i,s),s+=i.length}return r},Y8={assign:EQ,flattenChunks:AQ};let X8=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{X8=!1}const fp=new Uint8Array(256);for(let e=0;e<256;e++)fp[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;fp[254]=fp[254]=1;var jQ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,a,i=e.length,o=0;for(s=0;s<i;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,s=0;a<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const CQ=(e,t)=>{if(t<65534&&e.subarray&&X8)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var TQ=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let i=e[n++];if(i<128){a[s++]=i;continue}let o=fp[i];if(o>4){a[s++]=65533,n+=o-1;continue}for(i&=o===2?31:o===3?15:7;o>1&&n<r;)i=i<<6|e[n++]&63,o--;if(o>1){a[s++]=65533;continue}i<65536?a[s++]=i:(i-=65536,a[s++]=55296|i>>10&1023,a[s++]=56320|i&1023)}return CQ(a,s)},PQ=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+fp[e[r]]>t?r:t},r5={string2buf:jQ,buf2string:TQ,utf8border:PQ};function LQ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var FQ=LQ;const ng=16209,DQ=16191;var RQ=function(t,r){let n,s,a,i,o,l,u,d,f,p,h,m,g,y,x,w,b,N,A,P,j,D,E,I;const _=t.state;n=t.next_in,E=t.input,s=n+(t.avail_in-5),a=t.next_out,I=t.output,i=a-(r-t.avail_out),o=a+(t.avail_out-257),l=_.dmax,u=_.wsize,d=_.whave,f=_.wnext,p=_.window,h=_.hold,m=_.bits,g=_.lencode,y=_.distcode,x=(1<<_.lenbits)-1,w=(1<<_.distbits)-1;e:do{m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=g[h&x];t:for(;;){if(N=b>>>24,h>>>=N,m-=N,N=b>>>16&255,N===0)I[a++]=b&65535;else if(N&16){A=b&65535,N&=15,N&&(m<N&&(h+=E[n++]<<m,m+=8),A+=h&(1<<N)-1,h>>>=N,m-=N),m<15&&(h+=E[n++]<<m,m+=8,h+=E[n++]<<m,m+=8),b=y[h&w];r:for(;;){if(N=b>>>24,h>>>=N,m-=N,N=b>>>16&255,N&16){if(P=b&65535,N&=15,m<N&&(h+=E[n++]<<m,m+=8,m<N&&(h+=E[n++]<<m,m+=8)),P+=h&(1<<N)-1,P>l){t.msg="invalid distance too far back",_.mode=ng;break e}if(h>>>=N,m-=N,N=a-i,P>N){if(N=P-N,N>d&&_.sane){t.msg="invalid distance too far back",_.mode=ng;break e}if(j=0,D=p,f===0){if(j+=u-N,N<A){A-=N;do I[a++]=p[j++];while(--N);j=a-P,D=I}}else if(f<N){if(j+=u+f-N,N-=f,N<A){A-=N;do I[a++]=p[j++];while(--N);if(j=0,f<A){N=f,A-=N;do I[a++]=p[j++];while(--N);j=a-P,D=I}}}else if(j+=f-N,N<A){A-=N;do I[a++]=p[j++];while(--N);j=a-P,D=I}for(;A>2;)I[a++]=D[j++],I[a++]=D[j++],I[a++]=D[j++],A-=3;A&&(I[a++]=D[j++],A>1&&(I[a++]=D[j++]))}else{j=a-P;do I[a++]=I[j++],I[a++]=I[j++],I[a++]=I[j++],A-=3;while(A>2);A&&(I[a++]=I[j++],A>1&&(I[a++]=I[j++]))}}else if(N&64){t.msg="invalid distance code",_.mode=ng;break e}else{b=y[(b&65535)+(h&(1<<N)-1)];continue r}break}}else if(N&64)if(N&32){_.mode=DQ;break e}else{t.msg="invalid literal/length code",_.mode=ng;break e}else{b=g[(b&65535)+(h&(1<<N)-1)];continue t}break}}while(n<s&&a<o);A=m>>3,n-=A,m-=A<<3,h&=(1<<m)-1,t.next_in=n,t.next_out=a,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=a<o?257+(o-a):257-(a-o),_.hold=h,_.bits=m};const Nd=15,Xk=852,Jk=592,Qk=0,Av=1,Zk=2,IQ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),OQ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),MQ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),BQ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),UQ=(e,t,r,n,s,a,i,o)=>{const l=o.bits;let u=0,d=0,f=0,p=0,h=0,m=0,g=0,y=0,x=0,w=0,b,N,A,P,j,D=null,E;const I=new Uint16Array(Nd+1),_=new Uint16Array(Nd+1);let L=null,M,K,Z;for(u=0;u<=Nd;u++)I[u]=0;for(d=0;d<n;d++)I[t[r+d]]++;for(h=l,p=Nd;p>=1&&I[p]===0;p--);if(h>p&&(h=p),p===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<p&&I[f]===0;f++);for(h<f&&(h=f),y=1,u=1;u<=Nd;u++)if(y<<=1,y-=I[u],y<0)return-1;if(y>0&&(e===Qk||p!==1))return-1;for(_[1]=0,u=1;u<Nd;u++)_[u+1]=_[u]+I[u];for(d=0;d<n;d++)t[r+d]!==0&&(i[_[t[r+d]]++]=d);if(e===Qk?(D=L=i,E=20):e===Av?(D=IQ,L=OQ,E=257):(D=MQ,L=BQ,E=0),w=0,d=0,u=f,j=a,m=h,g=0,A=-1,x=1<<h,P=x-1,e===Av&&x>Xk||e===Zk&&x>Jk)return 1;for(;;){M=u-g,i[d]+1<E?(K=0,Z=i[d]):i[d]>=E?(K=L[i[d]-E],Z=D[i[d]-E]):(K=96,Z=0),b=1<<u-g,N=1<<m,f=N;do N-=b,s[j+(w>>g)+N]=M<<24|K<<16|Z|0;while(N!==0);for(b=1<<u-1;w&b;)b>>=1;if(b!==0?(w&=b-1,w+=b):w=0,d++,--I[u]===0){if(u===p)break;u=t[r+i[d]]}if(u>h&&(w&P)!==A){for(g===0&&(g=h),j+=f,m=u-g,y=1<<m;m+g<p&&(y-=I[m+g],!(y<=0));)m++,y<<=1;if(x+=1<<m,e===Av&&x>Xk||e===Zk&&x>Jk)return 1;A=w&P,s[A]=h<<24|m<<16|j-a|0}}return w!==0&&(s[j+w]=u-g<<24|64<<16|0),o.bits=h,0};var w0=UQ;const $Q=0,J8=1,Q8=2,{Z_FINISH:e_,Z_BLOCK:zQ,Z_TREES:sg,Z_OK:qu,Z_STREAM_END:HQ,Z_NEED_DICT:qQ,Z_STREAM_ERROR:li,Z_DATA_ERROR:Z8,Z_MEM_ERROR:eP,Z_BUF_ERROR:WQ,Z_DEFLATED:t_}=G8,$x=16180,r_=16181,n_=16182,s_=16183,a_=16184,i_=16185,o_=16186,l_=16187,c_=16188,u_=16189,G1=16190,Go=16191,jv=16192,d_=16193,Cv=16194,f_=16195,h_=16196,p_=16197,m_=16198,ag=16199,ig=16200,g_=16201,x_=16202,v_=16203,y_=16204,w_=16205,Tv=16206,b_=16207,N_=16208,Yr=16209,tP=16210,rP=16211,VQ=852,KQ=592,GQ=15,YQ=GQ,S_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function XQ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const rd=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<$x||t.mode>rP?1:0},nP=e=>{if(rd(e))return li;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=$x,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(VQ),t.distcode=t.distdyn=new Int32Array(KQ),t.sane=1,t.back=-1,qu},sP=e=>{if(rd(e))return li;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,nP(e)},aP=(e,t)=>{let r;if(rd(e))return li;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?li:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,sP(e))},iP=(e,t)=>{if(!e)return li;const r=new XQ;e.state=r,r.strm=e,r.window=null,r.mode=$x;const n=aP(e,t);return n!==qu&&(e.state=null),n},JQ=e=>iP(e,YQ);let k_=!0,Pv,Lv;const QQ=e=>{if(k_){Pv=new Int32Array(512),Lv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(w0(J8,e.lens,0,288,Pv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;w0(Q8,e.lens,0,32,Lv,0,e.work,{bits:5}),k_=!1}e.lencode=Pv,e.lenbits=9,e.distcode=Lv,e.distbits=5},oP=(e,t,r,n)=>{let s;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(t.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},ZQ=(e,t)=>{let r,n,s,a,i,o,l,u,d,f,p,h,m,g,y=0,x,w,b,N,A,P,j,D;const E=new Uint8Array(4);let I,_;const L=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(rd(e)||!e.output||!e.input&&e.avail_in!==0)return li;r=e.state,r.mode===Go&&(r.mode=jv),i=e.next_out,s=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,u=r.hold,d=r.bits,f=o,p=l,D=qu;e:for(;;)switch(r.mode){case $x:if(r.wrap===0){r.mode=jv;break}for(;d<16;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=ro(r.check,E,2,0),u=0,d=0,r.mode=r_;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Yr;break}if((u&15)!==t_){e.msg="unknown compression method",r.mode=Yr;break}if(u>>>=4,d-=4,j=(u&15)+8,r.wbits===0&&(r.wbits=j),j>15||j>r.wbits){e.msg="invalid window size",r.mode=Yr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?u_:Go,u=0,d=0;break;case r_:for(;d<16;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(r.flags=u,(r.flags&255)!==t_){e.msg="unknown compression method",r.mode=Yr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Yr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=ro(r.check,E,2,0)),u=0,d=0,r.mode=n_;case n_:for(;d<32;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=ro(r.check,E,4,0)),u=0,d=0,r.mode=s_;case s_:for(;d<16;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=ro(r.check,E,2,0)),u=0,d=0,r.mode=a_;case a_:if(r.flags&1024){for(;d<16;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(E[0]=u&255,E[1]=u>>>8&255,r.check=ro(r.check,E,2,0)),u=0,d=0}else r.head&&(r.head.extra=null);r.mode=i_;case i_:if(r.flags&1024&&(h=r.length,h>o&&(h=o),h&&(r.head&&(j=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),j)),r.flags&512&&r.wrap&4&&(r.check=ro(r.check,n,h,a)),o-=h,a+=h,r.length-=h),r.length))break e;r.length=0,r.mode=o_;case o_:if(r.flags&2048){if(o===0)break e;h=0;do j=n[a+h++],r.head&&j&&r.length<65536&&(r.head.name+=String.fromCharCode(j));while(j&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=ro(r.check,n,h,a)),o-=h,a+=h,j)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=l_;case l_:if(r.flags&4096){if(o===0)break e;h=0;do j=n[a+h++],r.head&&j&&r.length<65536&&(r.head.comment+=String.fromCharCode(j));while(j&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=ro(r.check,n,h,a)),o-=h,a+=h,j)break e}else r.head&&(r.head.comment=null);r.mode=c_;case c_:if(r.flags&512){for(;d<16;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Yr;break}u=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Go;break;case u_:for(;d<32;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}e.adler=r.check=S_(u),u=0,d=0,r.mode=G1;case G1:if(r.havedict===0)return e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=d,qQ;e.adler=r.check=1,r.mode=Go;case Go:if(t===zQ||t===sg)break e;case jv:if(r.last){u>>>=d&7,d-=d&7,r.mode=Tv;break}for(;d<3;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}switch(r.last=u&1,u>>>=1,d-=1,u&3){case 0:r.mode=d_;break;case 1:if(QQ(r),r.mode=ag,t===sg){u>>>=2,d-=2;break e}break;case 2:r.mode=h_;break;case 3:e.msg="invalid block type",r.mode=Yr}u>>>=2,d-=2;break;case d_:for(u>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Yr;break}if(r.length=u&65535,u=0,d=0,r.mode=Cv,t===sg)break e;case Cv:r.mode=f_;case f_:if(h=r.length,h){if(h>o&&(h=o),h>l&&(h=l),h===0)break e;s.set(n.subarray(a,a+h),i),o-=h,a+=h,l-=h,i+=h,r.length-=h;break}r.mode=Go;break;case h_:for(;d<14;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(r.nlen=(u&31)+257,u>>>=5,d-=5,r.ndist=(u&31)+1,u>>>=5,d-=5,r.ncode=(u&15)+4,u>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Yr;break}r.have=0,r.mode=p_;case p_:for(;r.have<r.ncode;){for(;d<3;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.lens[L[r.have++]]=u&7,u>>>=3,d-=3}for(;r.have<19;)r.lens[L[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,I={bits:r.lenbits},D=w0($Q,r.lens,0,19,r.lencode,0,r.work,I),r.lenbits=I.bits,D){e.msg="invalid code lengths set",r.mode=Yr;break}r.have=0,r.mode=m_;case m_:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,w=y>>>16&255,b=y&65535,!(x<=d);){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(b<16)u>>>=x,d-=x,r.lens[r.have++]=b;else{if(b===16){for(_=x+2;d<_;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(u>>>=x,d-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Yr;break}j=r.lens[r.have-1],h=3+(u&3),u>>>=2,d-=2}else if(b===17){for(_=x+3;d<_;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}u>>>=x,d-=x,j=0,h=3+(u&7),u>>>=3,d-=3}else{for(_=x+7;d<_;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}u>>>=x,d-=x,j=0,h=11+(u&127),u>>>=7,d-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Yr;break}for(;h--;)r.lens[r.have++]=j}}if(r.mode===Yr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Yr;break}if(r.lenbits=9,I={bits:r.lenbits},D=w0(J8,r.lens,0,r.nlen,r.lencode,0,r.work,I),r.lenbits=I.bits,D){e.msg="invalid literal/lengths set",r.mode=Yr;break}if(r.distbits=6,r.distcode=r.distdyn,I={bits:r.distbits},D=w0(Q8,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,I),r.distbits=I.bits,D){e.msg="invalid distances set",r.mode=Yr;break}if(r.mode=ag,t===sg)break e;case ag:r.mode=ig;case ig:if(o>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=d,RQ(e,p),i=e.next_out,s=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,u=r.hold,d=r.bits,r.mode===Go&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],x=y>>>24,w=y>>>16&255,b=y&65535,!(x<=d);){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(w&&!(w&240)){for(N=x,A=w,P=b;y=r.lencode[P+((u&(1<<N+A)-1)>>N)],x=y>>>24,w=y>>>16&255,b=y&65535,!(N+x<=d);){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}u>>>=N,d-=N,r.back+=N}if(u>>>=x,d-=x,r.back+=x,r.length=b,w===0){r.mode=w_;break}if(w&32){r.back=-1,r.mode=Go;break}if(w&64){e.msg="invalid literal/length code",r.mode=Yr;break}r.extra=w&15,r.mode=g_;case g_:if(r.extra){for(_=r.extra;d<_;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=x_;case x_:for(;y=r.distcode[u&(1<<r.distbits)-1],x=y>>>24,w=y>>>16&255,b=y&65535,!(x<=d);){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(!(w&240)){for(N=x,A=w,P=b;y=r.distcode[P+((u&(1<<N+A)-1)>>N)],x=y>>>24,w=y>>>16&255,b=y&65535,!(N+x<=d);){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}u>>>=N,d-=N,r.back+=N}if(u>>>=x,d-=x,r.back+=x,w&64){e.msg="invalid distance code",r.mode=Yr;break}r.offset=b,r.extra=w&15,r.mode=v_;case v_:if(r.extra){for(_=r.extra;d<_;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Yr;break}r.mode=y_;case y_:if(l===0)break e;if(h=p-l,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Yr;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=s,m=i-r.offset,h=r.length;h>l&&(h=l),l-=h,r.length-=h;do s[i++]=g[m++];while(--h);r.length===0&&(r.mode=ig);break;case w_:if(l===0)break e;s[i++]=r.length,l--,r.mode=ig;break;case Tv:if(r.wrap){for(;d<32;){if(o===0)break e;o--,u|=n[a++]<<d,d+=8}if(p-=l,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?ro(r.check,s,p,i-p):e5(r.check,s,p,i-p)),p=l,r.wrap&4&&(r.flags?u:S_(u))!==r.check){e.msg="incorrect data check",r.mode=Yr;break}u=0,d=0}r.mode=b_;case b_:if(r.wrap&&r.flags){for(;d<32;){if(o===0)break e;o--,u+=n[a++]<<d,d+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Yr;break}u=0,d=0}r.mode=N_;case N_:D=HQ;break e;case Yr:D=Z8;break e;case tP:return eP;case rP:default:return li}return e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=d,(r.wsize||p!==e.avail_out&&r.mode<Yr&&(r.mode<Tv||t!==e_))&&oP(e,e.output,e.next_out,p-e.avail_out),f-=e.avail_in,p-=e.avail_out,e.total_in+=f,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?ro(r.check,s,p,e.next_out-p):e5(r.check,s,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Go?128:0)+(r.mode===ag||r.mode===Cv?256:0),(f===0&&p===0||t===e_)&&D===qu&&(D=WQ),D},eZ=e=>{if(rd(e))return li;let t=e.state;return t.window&&(t.window=null),e.state=null,qu},tZ=(e,t)=>{if(rd(e))return li;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,qu):li},rZ=(e,t)=>{const r=t.length;let n,s,a;return rd(e)||(n=e.state,n.wrap!==0&&n.mode!==G1)?li:n.mode===G1&&(s=1,s=e5(s,t,r,0),s!==n.check)?Z8:(a=oP(e,t,r,r),a?(n.mode=tP,eP):(n.havedict=1,qu))};var nZ=sP,sZ=aP,aZ=nP,iZ=JQ,oZ=iP,lZ=ZQ,cZ=eZ,uZ=tZ,dZ=rZ,fZ="pako inflate (from Nodeca project)",Zo={inflateReset:nZ,inflateReset2:sZ,inflateResetKeep:aZ,inflateInit:iZ,inflateInit2:oZ,inflate:lZ,inflateEnd:cZ,inflateGetHeader:uZ,inflateSetDictionary:dZ,inflateInfo:fZ};function hZ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var pZ=hZ;const lP=Object.prototype.toString,{Z_NO_FLUSH:mZ,Z_FINISH:gZ,Z_OK:hp,Z_STREAM_END:Fv,Z_NEED_DICT:Dv,Z_STREAM_ERROR:xZ,Z_DATA_ERROR:__,Z_MEM_ERROR:vZ}=G8;function Mp(e){this.options=Y8.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new FQ,this.strm.avail_out=0;let r=Zo.inflateInit2(this.strm,t.windowBits);if(r!==hp)throw new Error(t5[r]);if(this.header=new pZ,Zo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=r5.string2buf(t.dictionary):lP.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Zo.inflateSetDictionary(this.strm,t.dictionary),r!==hp)))throw new Error(t5[r])}Mp.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,i,o;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?gZ:mZ,lP.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Zo.inflate(r,i),a===Dv&&s&&(a=Zo.inflateSetDictionary(r,s),a===hp?a=Zo.inflate(r,i):a===__&&(a=Dv));r.avail_in>0&&a===Fv&&r.state.wrap>0&&e[r.next_in]!==0;)Zo.inflateReset(r),a=Zo.inflate(r,i);switch(a){case xZ:case __:case Dv:case vZ:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===Fv))if(this.options.to==="string"){let l=r5.utf8border(r.output,r.next_out),u=r.next_out-l,d=r5.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(d)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===hp&&o===0)){if(a===Fv)return a=Zo.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Mp.prototype.onData=function(e){this.chunks.push(e)};Mp.prototype.onEnd=function(e){e===hp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Y8.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function yZ(e,t){const r=new Mp(t);if(r.push(e),r.err)throw r.msg||t5[r.err];return r.result}var wZ=Mp,bZ=yZ,NZ={Inflate:wZ,inflate:bZ};const{Inflate:SZ,inflate:kZ}=NZ;var E_=SZ,_Z=kZ;const cP=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;cP[e]=t}const A_=4294967295;function EZ(e,t,r){let n=e;for(let s=0;s<r;s++)n=cP[(n^t[s])&255]^n>>>8;return n}function AZ(e,t){return(EZ(A_,e,t)^A_)>>>0}function j_(e,t,r){const n=e.readUint32(),s=AZ(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function uP(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function dP(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function fP(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function hP(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-s]>>1)&255}else{for(;a<s;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-s]+r[a]>>1)&255}}function pP(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-s]&255}else{for(;a<s;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+jZ(t[a-s],r[a],r[a-s])&255}}function jZ(e,t,r){const n=e+t-r,s=Math.abs(n-e),a=Math.abs(n-t),i=Math.abs(n-r);return s<=a&&s<=i?e:a<=i?t:r}function CZ(e,t,r,n,s,a){switch(e){case 0:uP(t,r,s);break;case 1:dP(t,r,s,a);break;case 2:fP(t,r,n,s);break;case 3:hP(t,r,n,s,a);break;case 4:pP(t,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const TZ=new Uint16Array([255]),PZ=new Uint8Array(TZ.buffer),LZ=PZ[0]===255;function FZ(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*s,l=new Uint8Array(n*r*o);let u=0;for(let d=0;d<7;d++){const f=i[d],p=Math.ceil((r-f.x)/f.xStep),h=Math.ceil((n-f.y)/f.yStep);if(p<=0||h<=0)continue;const m=p*o,g=new Uint8Array(m);for(let y=0;y<h;y++){const x=t[u++],w=t.subarray(u,u+m);u+=m;const b=new Uint8Array(m);CZ(x,w,b,g,m,o),g.set(b);for(let N=0;N<p;N++){const A=f.x+N*f.xStep,P=f.y+y*f.yStep;if(!(A>=r||P>=n))for(let j=0;j<o;j++)l[(P*r+A)*o+j]=b[N*o+j]}}}if(a===16){const d=new Uint16Array(l.buffer);if(LZ)for(let f=0;f<d.length;f++)d[f]=DZ(d[f]);return d}else return l}function DZ(e){return(e&255)<<8|e>>8&255}const RZ=new Uint16Array([255]),IZ=new Uint8Array(RZ.buffer),OZ=IZ[0]===255,MZ=new Uint8Array(0);function C_(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=Math.ceil(a/8)*s,o=Math.ceil(a/8*s*r),l=new Uint8Array(n*o);let u=MZ,d=0,f,p;for(let h=0;h<n;h++){switch(f=t.subarray(d+1,d+1+o),p=l.subarray(h*o,(h+1)*o),t[d]){case 0:uP(f,p,o);break;case 1:dP(f,p,o,i);break;case 2:fP(f,p,u,o);break;case 3:hP(f,p,u,o,i);break;case 4:pP(f,p,u,o,i);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=p,d+=o+1}if(a===16){const h=new Uint16Array(l.buffer);if(OZ)for(let m=0;m<h.length;m++)h[m]=BZ(h[m]);return h}else return l}function BZ(e){return(e&255)<<8|e>>8&255}const zg=Uint8Array.of(137,80,78,71,13,10,26,10);function T_(e){if(!UZ(e.readBytes(zg.length)))throw new Error("wrong PNG signature")}function UZ(e){if(e.length<zg.length)return!1;for(let t=0;t<zg.length;t++)if(e[t]!==zg[t])return!1;return!0}const $Z="tEXt",zZ=0,mP=new TextDecoder("latin1");function HZ(e){if(WZ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const qZ=/^[\u0000-\u00FF]*$/;function WZ(e){if(!qZ.test(e))throw new Error("invalid latin1 text")}function VZ(e,t,r){const n=gP(t);e[n]=KZ(t,r-n.length-1)}function gP(e){for(e.mark();e.readByte()!==zZ;);const t=e.offset;e.reset();const r=mP.decode(e.readBytes(t-e.offset-1));return e.skip(1),HZ(r),r}function KZ(e,t){return mP.decode(e.readBytes(t))}const Aa={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Rv={UNKNOWN:-1,DEFLATE:0},P_={UNKNOWN:-1,ADAPTIVE:0},Iv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},og={NONE:0,BACKGROUND:1,PREVIOUS:2},Ov={SOURCE:0,OVER:1};class GZ extends v4{constructor(r,n={}){super(r);Tt(this,"_checkCrc");Tt(this,"_inflator");Tt(this,"_png");Tt(this,"_apng");Tt(this,"_end");Tt(this,"_hasPalette");Tt(this,"_palette");Tt(this,"_hasTransparency");Tt(this,"_transparency");Tt(this,"_compressionMethod");Tt(this,"_filterMethod");Tt(this,"_interlaceMethod");Tt(this,"_colorType");Tt(this,"_isAnimated");Tt(this,"_numberOfFrames");Tt(this,"_numberOfPlays");Tt(this,"_frames");Tt(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new E_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Rv.UNKNOWN,this._filterMethod=P_.UNKNOWN,this._interlaceMethod=Iv.UNKNOWN,this._colorType=Aa.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(T_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(T_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case $Z:VZ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?j_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?j_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=YZ(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case Aa.GREYSCALE:s=1;break;case Aa.TRUECOLOUR:s=3;break;case Aa.INDEXED_COLOUR:s=1;break;case Aa.GREYSCALE_ALPHA:s=2;break;case Aa.TRUECOLOUR_ALPHA:s=4;break;case Aa.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Rv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Aa.GREYSCALE:case Aa.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Aa.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Aa.UNKNOWN:case Aa.GREYSCALE_ALPHA:case Aa.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=gP(this),s=this.readUint8();if(s!==Rv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:_Z(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=C_({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case og.NONE:break;case og.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let i=0;i<this._png.width;i++){const o=(a*r.width+i)*this._png.channels;for(let l=0;l<this._png.channels;l++)s.data[o+l]=0}break;case og.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(i,o)=>{const l=((i+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,u=(i*n.width+o)*this._png.channels;return{index:l,frameIndex:u}};switch(n.blendOp){case Ov.SOURCE:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(i,o);for(let d=0;d<this._png.channels;d++)r.data[l+d]=n.data[u+d]}break;case Ov.OVER:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(i,o);for(let d=0;d<this._png.channels;d++){const f=n.data[u+this._png.channels-1]/s,p=d%(this._png.channels-1)===0?1:n.data[u+d],h=Math.floor(f*p+(1-f)*r.data[l+d]);r.data[l+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==P_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Iv.NO_INTERLACE)this._png.data=C_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Iv.ADAM7)this._png.data=FZ({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:og.NONE,blendOp:Ov.SOURCE,data:r}),this._inflator=new E_,this._writingDataChunks=!1}}function YZ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var L_;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(L_||(L_={}));function XZ(e,t){return new GZ(e,t).decode()}var Ht=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Mv(){Ht.console&&typeof Ht.console.log=="function"&&Ht.console.log.apply(Ht.console,arguments)}var Rr={log:Mv,warn:function(e){Ht.console&&(typeof Ht.console.warn=="function"?Ht.console.warn.apply(Ht.console,arguments):Mv.call(null,arguments))},error:function(e){Ht.console&&(typeof Ht.console.error=="function"?Ht.console.error.apply(Ht.console,arguments):Mv(e))}};function Bv(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){su(n.response,t,r)},n.onerror=function(){Rr.error("could not download file")},n.send()}function F_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function lg(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var su=Ht.saveAs||((typeof window>"u"?"undefined":Ar(window))!=="object"||window!==Ht?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ht.URL||Ht.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?F_(s.href)?Bv(e,t,r):lg(s,s.target="_blank"):lg(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){lg(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(F_(e))Bv(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){lg(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:Ar(a)!=="object"&&(Rr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Bv(e,t,r);var s=e.type==="application/octet-stream",a=/constructor/i.test(Ht.HTMLElement)||Ht.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":Ar(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=i?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},o.readAsDataURL(e)}else{var l=Ht.URL||Ht.webkitURL,u=l.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function xP(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,i=s.exec(e);i&&(t=a(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+o+l+u}}var Hg=Ht.atob.bind(Ht),D_=Ht.btoa.bind(Ht);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Uv(e,t){var r=e[0],n=e[1],s=e[2],a=e[3];r=As(r,n,s,a,t[0],7,-680876936),a=As(a,r,n,s,t[1],12,-389564586),s=As(s,a,r,n,t[2],17,606105819),n=As(n,s,a,r,t[3],22,-1044525330),r=As(r,n,s,a,t[4],7,-176418897),a=As(a,r,n,s,t[5],12,1200080426),s=As(s,a,r,n,t[6],17,-1473231341),n=As(n,s,a,r,t[7],22,-45705983),r=As(r,n,s,a,t[8],7,1770035416),a=As(a,r,n,s,t[9],12,-1958414417),s=As(s,a,r,n,t[10],17,-42063),n=As(n,s,a,r,t[11],22,-1990404162),r=As(r,n,s,a,t[12],7,1804603682),a=As(a,r,n,s,t[13],12,-40341101),s=As(s,a,r,n,t[14],17,-1502002290),r=js(r,n=As(n,s,a,r,t[15],22,1236535329),s,a,t[1],5,-165796510),a=js(a,r,n,s,t[6],9,-1069501632),s=js(s,a,r,n,t[11],14,643717713),n=js(n,s,a,r,t[0],20,-373897302),r=js(r,n,s,a,t[5],5,-701558691),a=js(a,r,n,s,t[10],9,38016083),s=js(s,a,r,n,t[15],14,-660478335),n=js(n,s,a,r,t[4],20,-405537848),r=js(r,n,s,a,t[9],5,568446438),a=js(a,r,n,s,t[14],9,-1019803690),s=js(s,a,r,n,t[3],14,-187363961),n=js(n,s,a,r,t[8],20,1163531501),r=js(r,n,s,a,t[13],5,-1444681467),a=js(a,r,n,s,t[2],9,-51403784),s=js(s,a,r,n,t[7],14,1735328473),r=Cs(r,n=js(n,s,a,r,t[12],20,-1926607734),s,a,t[5],4,-378558),a=Cs(a,r,n,s,t[8],11,-2022574463),s=Cs(s,a,r,n,t[11],16,1839030562),n=Cs(n,s,a,r,t[14],23,-35309556),r=Cs(r,n,s,a,t[1],4,-1530992060),a=Cs(a,r,n,s,t[4],11,1272893353),s=Cs(s,a,r,n,t[7],16,-155497632),n=Cs(n,s,a,r,t[10],23,-1094730640),r=Cs(r,n,s,a,t[13],4,681279174),a=Cs(a,r,n,s,t[0],11,-358537222),s=Cs(s,a,r,n,t[3],16,-722521979),n=Cs(n,s,a,r,t[6],23,76029189),r=Cs(r,n,s,a,t[9],4,-640364487),a=Cs(a,r,n,s,t[12],11,-421815835),s=Cs(s,a,r,n,t[15],16,530742520),r=Ts(r,n=Cs(n,s,a,r,t[2],23,-995338651),s,a,t[0],6,-198630844),a=Ts(a,r,n,s,t[7],10,1126891415),s=Ts(s,a,r,n,t[14],15,-1416354905),n=Ts(n,s,a,r,t[5],21,-57434055),r=Ts(r,n,s,a,t[12],6,1700485571),a=Ts(a,r,n,s,t[3],10,-1894986606),s=Ts(s,a,r,n,t[10],15,-1051523),n=Ts(n,s,a,r,t[1],21,-2054922799),r=Ts(r,n,s,a,t[8],6,1873313359),a=Ts(a,r,n,s,t[15],10,-30611744),s=Ts(s,a,r,n,t[6],15,-1560198380),n=Ts(n,s,a,r,t[13],21,1309151649),r=Ts(r,n,s,a,t[4],6,-145523070),a=Ts(a,r,n,s,t[11],10,-1120210379),s=Ts(s,a,r,n,t[2],15,718787259),n=Ts(n,s,a,r,t[9],21,-343485551),e[0]=pc(r,e[0]),e[1]=pc(n,e[1]),e[2]=pc(s,e[2]),e[3]=pc(a,e[3])}function zx(e,t,r,n,s,a){return t=pc(pc(t,e),pc(n,a)),pc(t<<s|t>>>32-s,r)}function As(e,t,r,n,s,a,i){return zx(t&r|~t&n,e,t,s,a,i)}function js(e,t,r,n,s,a,i){return zx(t&n|r&~n,e,t,s,a,i)}function Cs(e,t,r,n,s,a,i){return zx(t^r^n,e,t,s,a,i)}function Ts(e,t,r,n,s,a,i){return zx(r^(t|~n),e,t,s,a,i)}function vP(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Uv(n,JZ(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Uv(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Uv(n,s),n}function JZ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var R_="0123456789abcdef".split("");function QZ(e){for(var t="",r=0;r<4;r++)t+=R_[e>>8*r+4&15]+R_[e>>8*r&15];return t}function ZZ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function n5(e){return vP(e).map(ZZ).join("")}var eee=function(e){for(var t=0;t<e.length;t++)e[t]=QZ(e[t]);return e.join("")}(vP("hello"))!="5d41402abc4b2a76b9719d911017c592";function pc(e,t){if(eee){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function s5(e,t){var r,n,s,a;if(e!==r){for(var i=(s=e,a=1+(256/e.length|0),new Array(a+1).join(s)),o=[],l=0;l<256;l++)o[l]=l;var u=0;for(l=0;l<256;l++){var d=o[l];u=(u+d+i.charCodeAt(l))%256,o[l]=o[u],o[u]=d}r=e,n=o}else o=n;var f=t.length,p=0,h=0,m="";for(l=0;l<f;l++)h=(h+(d=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=d,i=o[(o[p]+o[h])%256],m+=String.fromCharCode(t.charCodeAt(l)^i);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var I_={print:4,modify:8,copy:16,"annot-forms":32};function Pd(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(o){if(I_.perm!==void 0)throw new Error("Invalid permission: "+o);s+=I_[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=n5(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=s5(this.encryptionKey,this.padding)}function Ld(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function O_(e){if(Ar(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in t[r]){var i=t[r][a];try{i[0].apply(e,n)}catch(o){Ht.console&&Rr.error("jsPDF PubSub Error",o.message,o)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Y1(e){if(!(this instanceof Y1))return new Y1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function yP(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function iu(e,t,r,n,s){if(!(this instanceof iu))return new iu(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,yP.call(this,n,s)}function Vd(e,t,r,n,s){if(!(this instanceof Vd))return new Vd(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,yP.call(this,n,s)}function jt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],o=1,l=16,u="S",d=null;Ar(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,a=e.compress||e.compressPdf||a,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),u=e.defaultPathOperation||"S"),i=e.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=O_;var m="1.3",g=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(k){m=k};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var x=h.__private__.getPageFormat=function(k){return y[k]};s=s||"a4";var w="compat",b="advanced",N=w;function A(){this.saveGraphicsState(),X(new Et(it,0,0,-it,0,qc()*it).toString()+" cm"),this.setFontSize(this.getFontSize()/it),u="n",N=b}function P(){this.restoreGraphicsState(),u="S",N=w}var j=h.__private__.combineFontStyleAndFontWeight=function(k,H){if(k=="bold"&&H=="normal"||k=="bold"&&H==400||k=="normal"&&H=="italic"||k=="bold"&&H=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return H&&(k=H==400||H==="normal"?k==="italic"?"italic":"normal":H!=700&&H!=="bold"||k!=="normal"?(H==700?"bold":H)+""+k:"bold"),k};h.advancedAPI=function(k){var H=N===w;return H&&A.call(this),typeof k!="function"||(k(this),H&&P.call(this)),this},h.compatAPI=function(k){var H=N===b;return H&&P.call(this),typeof k!="function"||(k(this),H&&A.call(this)),this},h.isAdvancedAPI=function(){return N===b};var D,E=function(k){if(N!==b)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},I=h.roundToPrecision=h.__private__.roundToPrecision=function(k,H){var de=t||H;if(isNaN(k)||isNaN(de))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(de).replace(/0+$/,"")};D=h.hpf=h.__private__.hpf=typeof l=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return I(k,l)}:l==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return I(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return I(k,16)};var _=h.f2=h.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return I(k,2)},L=h.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return I(k,3)},M=h.scale=h.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return N===w?k*it:N===b?k:void 0},K=function(k){return M(function(H){return N===w?qc()-H:N===b?H:void 0}(k))};h.__private__.setPrecision=h.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var Z,ae="00000000000000000000000000000000",he=h.__private__.getFileId=function(){return ae},re=h.__private__.setFileId=function(k){return ae=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():ae.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Mn=new Pd(d.userPermissions,d.userPassword,d.ownerPassword,ae)),ae};h.setFileId=function(k){return re(k),this},h.getFileId=function(){return he()};var U=h.__private__.convertDateToPDFDate=function(k){var H=k.getTimezoneOffset(),de=H<0?"+":"-",ve=Math.floor(Math.abs(H/60)),Se=Math.abs(H%60),Ve=[de,B(ve),"'",B(Se),"'"].join("");return["D:",k.getFullYear(),B(k.getMonth()+1),B(k.getDate()),B(k.getHours()),B(k.getMinutes()),B(k.getSeconds()),Ve].join("")},ue=h.__private__.convertPDFDateToDate=function(k){var H=parseInt(k.substr(2,4),10),de=parseInt(k.substr(6,2),10)-1,ve=parseInt(k.substr(8,2),10),Se=parseInt(k.substr(10,2),10),Ve=parseInt(k.substr(12,2),10),Xe=parseInt(k.substr(14,2),10);return new Date(H,de,ve,Se,Ve,Xe,0)},pe=h.__private__.setCreationDate=function(k){var H;if(k===void 0&&(k=new Date),k instanceof Date)H=U(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");H=k}return Z=H},C=h.__private__.getCreationDate=function(k){var H=Z;return k==="jsDate"&&(H=ue(Z)),H};h.setCreationDate=function(k){return pe(k),this},h.getCreationDate=function(k){return C(k)};var R,B=h.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},O=h.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},Y=0,ie=[],me=[],ge=0,xe=[],Le=[],z=!1,Re=me;h.__private__.setCustomOutputDestination=function(k){z=!0,Re=k};var Fe=function(k){z||(Re=k)};h.__private__.resetCustomOutputDestination=function(){z=!1,Re=me};var X=h.__private__.out=function(k){return k=k.toString(),ge+=k.length+1,Re.push(k),Re},Oe=h.__private__.write=function(k){return X(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},Me=h.__private__.getArrayBuffer=function(k){for(var H=k.length,de=new ArrayBuffer(H),ve=new Uint8Array(de);H--;)ve[H]=k.charCodeAt(H);return de},st=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return st};var Ue=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(k){return Ue=N===b?k/it:k,this};var xt,tt=h.__private__.getFontSize=h.getFontSize=function(){return N===w?Ue:Ue*it},gt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(k){return gt=k,this},h.__private__.getR2L=h.getR2L=function(){return gt};var ct,Mt=h.__private__.setZoomMode=function(k){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))xt=k;else if(isNaN(k)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');xt=k}else xt=parseInt(k,10)};h.__private__.getZoomMode=function(){return xt};var It,Pt=h.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');ct=k};h.__private__.getPageMode=function(){return ct};var Jt=h.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');It=k};h.__private__.getLayoutMode=function(){return It},h.__private__.setDisplayMode=h.setDisplayMode=function(k,H,de){return Mt(k),Jt(H),Pt(de),this};var Lt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(k){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Lt[k]},h.__private__.getDocumentProperties=function(){return Lt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(k){for(var H in Lt)Lt.hasOwnProperty(H)&&k[H]&&(Lt[H]=k[H]);return this},h.__private__.setDocumentProperty=function(k,H){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Lt[k]=H};var pt,it,ot,ir,Ft,Ot={},qt={},Ne=[],Ie={},Ge={},He={},Be={},$e=null,ft=0,Ye=[],Qe=new O_(h),zt=e.hotfixes||[],Dt={},_n={},wr=[],Et=function k(H,de,ve,Se,Ve,Xe){if(!(this instanceof k))return new k(H,de,ve,Se,Ve,Xe);isNaN(H)&&(H=1),isNaN(de)&&(de=0),isNaN(ve)&&(ve=0),isNaN(Se)&&(Se=1),isNaN(Ve)&&(Ve=0),isNaN(Xe)&&(Xe=0),this._matrix=[H,de,ve,Se,Ve,Xe]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(D).join(k)},Et.prototype.multiply=function(k){var H=k.sx*this.sx+k.shy*this.shx,de=k.sx*this.shy+k.shy*this.sy,ve=k.shx*this.sx+k.sy*this.shx,Se=k.shx*this.shy+k.sy*this.sy,Ve=k.tx*this.sx+k.ty*this.shx+this.tx,Xe=k.tx*this.shy+k.ty*this.sy+this.ty;return new Et(H,de,ve,Se,Ve,Xe)},Et.prototype.decompose=function(){var k=this.sx,H=this.shy,de=this.shx,ve=this.sy,Se=this.tx,Ve=this.ty,Xe=Math.sqrt(k*k+H*H),Nt=(k/=Xe)*de+(H/=Xe)*ve;de-=k*Nt,ve-=H*Nt;var At=Math.sqrt(de*de+ve*ve);return Nt/=At,k*(ve/=At)<H*(de/=At)&&(k=-k,H=-H,Nt=-Nt,Xe=-Xe),{scale:new Et(Xe,0,0,At,0,0),translate:new Et(1,0,0,1,Se,Ve),rotate:new Et(k,H,-H,k,0,0),skew:new Et(1,0,Nt,1,0,0)}},Et.prototype.toString=function(k){return this.join(" ")},Et.prototype.inversed=function(){var k=this.sx,H=this.shy,de=this.shx,ve=this.sy,Se=this.tx,Ve=this.ty,Xe=1/(k*ve-H*de),Nt=ve*Xe,At=-H*Xe,Wt=-de*Xe,Zt=k*Xe;return new Et(Nt,At,Wt,Zt,-Nt*Se-Wt*Ve,-At*Se-Zt*Ve)},Et.prototype.applyToPoint=function(k){var H=k.x*this.sx+k.y*this.shx+this.tx,de=k.x*this.shy+k.y*this.sy+this.ty;return new Fo(H,de)},Et.prototype.applyToRectangle=function(k){var H=this.applyToPoint(k),de=this.applyToPoint(new Fo(k.x+k.w,k.y+k.h));return new Zf(H.x,H.y,de.x-H.x,de.y-H.y)},Et.prototype.clone=function(){var k=this.sx,H=this.shy,de=this.shx,ve=this.sy,Se=this.tx,Ve=this.ty;return new Et(k,H,de,ve,Se,Ve)},h.Matrix=Et;var sr=h.matrixMult=function(k,H){return H.multiply(k)},va=new Et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=va;var pn=function(k,H){if(!Ge[k]){var de=(H instanceof iu?"Sh":"P")+(Object.keys(Ie).length+1).toString(10);H.id=de,Ge[k]=de,Ie[de]=H,Qe.publish("addPattern",H)}};h.ShadingPattern=iu,h.TilingPattern=Vd,h.addShadingPattern=function(k,H){return E("addShadingPattern()"),pn(k,H),this},h.beginTilingPattern=function(k){E("beginTilingPattern()"),eh(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},h.endTilingPattern=function(k,H){E("endTilingPattern()"),H.stream=Le[R].join(`
`),pn(k,H),Qe.publish("endTilingPattern",H),wr.pop().restore()};var Pr,fr=h.__private__.newObject=function(){var k=br();return W(k,!0),k},br=h.__private__.newObjectDeferred=function(){return Y++,ie[Y]=function(){return ge},Y},W=function(k,H){return H=typeof H=="boolean"&&H,ie[k]=ge,H&&X(k+" 0 obj"),k},te=h.__private__.newAdditionalObject=function(){var k={objId:br(),content:""};return xe.push(k),k},ee=br(),se=br(),oe=h.__private__.decodeColorString=function(k){var H=k.split(" ");if(H.length!==2||H[1]!=="g"&&H[1]!=="G")H.length!==5||H[4]!=="k"&&H[4]!=="K"||(H=[(1-H[0])*(1-H[3]),(1-H[1])*(1-H[3]),(1-H[2])*(1-H[3]),"r"]);else{var de=parseFloat(H[0]);H=[de,de,de,"r"]}for(var ve="#",Se=0;Se<3;Se++)ve+=("0"+Math.floor(255*parseFloat(H[Se])).toString(16)).slice(-2);return ve},fe=h.__private__.encodeColorString=function(k){var H;typeof k=="string"&&(k={ch1:k});var de=k.ch1,ve=k.ch2,Se=k.ch3,Ve=k.ch4,Xe=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof de=="string"&&de.charAt(0)!=="#"){var Nt=new xP(de);if(Nt.ok)de=Nt.toHex();else if(!/^\d*\.?\d*$/.test(de))throw new Error('Invalid color "'+de+'" passed to jsPDF.encodeColorString.')}if(typeof de=="string"&&/^#[0-9A-Fa-f]{3}$/.test(de)&&(de="#"+de[1]+de[1]+de[2]+de[2]+de[3]+de[3]),typeof de=="string"&&/^#[0-9A-Fa-f]{6}$/.test(de)){var At=parseInt(de.substr(1),16);de=At>>16&255,ve=At>>8&255,Se=255&At}if(ve===void 0||Ve===void 0&&de===ve&&ve===Se)H=typeof de=="string"?de+" "+Xe[0]:k.precision===2?_(de/255)+" "+Xe[0]:L(de/255)+" "+Xe[0];else if(Ve===void 0||Ar(Ve)==="object"){if(Ve&&!isNaN(Ve.a)&&Ve.a===0)return["1.","1.","1.",Xe[1]].join(" ");H=typeof de=="string"?[de,ve,Se,Xe[1]].join(" "):k.precision===2?[_(de/255),_(ve/255),_(Se/255),Xe[1]].join(" "):[L(de/255),L(ve/255),L(Se/255),Xe[1]].join(" ")}else H=typeof de=="string"?[de,ve,Se,Ve,Xe[2]].join(" "):k.precision===2?[_(de),_(ve),_(Se),_(Ve),Xe[2]].join(" "):[L(de),L(ve),L(Se),L(Ve),Xe[2]].join(" ");return H},_e=h.__private__.getFilters=function(){return i},De=h.__private__.putStream=function(k){var H=(k=k||{}).data||"",de=k.filters||_e(),ve=k.alreadyAppliedFilters||[],Se=k.addLength1||!1,Ve=H.length,Xe=k.objectId,Nt=function(Bn){return Bn};if(d!==null&&Xe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Nt=Mn.encryptor(Xe,0));var At={};de===!0&&(de=["FlateEncode"]);var Wt=k.additionalKeyValues||[],Zt=(At=jt.API.processDataByFilters!==void 0?jt.API.processDataByFilters(H,de):{data:H,reverseChain:[]}).reverseChain+(Array.isArray(ve)?ve.join(" "):ve.toString());if(At.data.length!==0&&(Wt.push({key:"Length",value:At.data.length}),Se===!0&&Wt.push({key:"Length1",value:Ve})),Zt.length!=0)if(Zt.split("/").length-1==1)Wt.push({key:"Filter",value:Zt});else{Wt.push({key:"Filter",value:"["+Zt+"]"});for(var gr=0;gr<Wt.length;gr+=1)if(Wt[gr].key==="DecodeParms"){for(var Zr=[],jn=0;jn<At.reverseChain.split("/").length-1;jn+=1)Zr.push("null");Zr.push(Wt[gr].value),Wt[gr].value="["+Zr.join(" ")+"]"}}X("<<");for(var Or=0;Or<Wt.length;Or++)X("/"+Wt[Or].key+" "+Wt[Or].value);X(">>"),At.data.length!==0&&(X("stream"),X(Nt(At.data)),X("endstream"))},Ee=h.__private__.putPage=function(k){var H=k.number,de=k.data,ve=k.objId,Se=k.contentsObjId;W(ve,!0),X("<</Type /Page"),X("/Parent "+k.rootDictionaryObjId+" 0 R"),X("/Resources "+k.resourceDictionaryObjId+" 0 R"),X("/MediaBox ["+parseFloat(D(k.mediaBox.bottomLeftX))+" "+parseFloat(D(k.mediaBox.bottomLeftY))+" "+D(k.mediaBox.topRightX)+" "+D(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&X("/CropBox ["+D(k.cropBox.bottomLeftX)+" "+D(k.cropBox.bottomLeftY)+" "+D(k.cropBox.topRightX)+" "+D(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&X("/BleedBox ["+D(k.bleedBox.bottomLeftX)+" "+D(k.bleedBox.bottomLeftY)+" "+D(k.bleedBox.topRightX)+" "+D(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&X("/TrimBox ["+D(k.trimBox.bottomLeftX)+" "+D(k.trimBox.bottomLeftY)+" "+D(k.trimBox.topRightX)+" "+D(k.trimBox.topRightY)+"]"),k.artBox!==null&&X("/ArtBox ["+D(k.artBox.bottomLeftX)+" "+D(k.artBox.bottomLeftY)+" "+D(k.artBox.topRightX)+" "+D(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&X("/UserUnit "+k.userUnit),Qe.publish("putPage",{objId:ve,pageContext:Ye[H],pageNumber:H,page:de}),X("/Contents "+Se+" 0 R"),X(">>"),X("endobj");var Ve=de.join(`
`);return N===b&&(Ve+=`
Q`),W(Se,!0),De({data:Ve,filters:_e(),objectId:Se}),X("endobj"),ve},Ae=h.__private__.putPages=function(){var k,H,de=[];for(k=1;k<=ft;k++)Ye[k].objId=br(),Ye[k].contentsObjId=br();for(k=1;k<=ft;k++)de.push(Ee({number:k,data:Le[k],objId:Ye[k].objId,contentsObjId:Ye[k].contentsObjId,mediaBox:Ye[k].mediaBox,cropBox:Ye[k].cropBox,bleedBox:Ye[k].bleedBox,trimBox:Ye[k].trimBox,artBox:Ye[k].artBox,userUnit:Ye[k].userUnit,rootDictionaryObjId:ee,resourceDictionaryObjId:se}));W(ee,!0),X("<</Type /Pages");var ve="/Kids [";for(H=0;H<ft;H++)ve+=de[H]+" 0 R ";X(ve+"]"),X("/Count "+ft),X(">>"),X("endobj"),Qe.publish("postPutPages")},Te=function(k){Qe.publish("putFont",{font:k,out:X,newObject:fr,putStream:De}),k.isAlreadyPutted!==!0&&(k.objectNumber=fr(),X("<<"),X("/Type /Font"),X("/BaseFont /"+Ld(k.postScriptName)),X("/Subtype /Type1"),typeof k.encoding=="string"&&X("/Encoding /"+k.encoding),X("/FirstChar 32"),X("/LastChar 255"),X(">>"),X("endobj"))},Ze=function(k){k.objectNumber=fr();var H=[];H.push({key:"Type",value:"/XObject"}),H.push({key:"Subtype",value:"/Form"}),H.push({key:"BBox",value:"["+[D(k.x),D(k.y),D(k.x+k.width),D(k.y+k.height)].join(" ")+"]"}),H.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var de=k.pages[1].join(`
`);De({data:de,additionalKeyValues:H,objectId:k.objectNumber}),X("endobj")},at=function(k,H){H||(H=21);var de=fr(),ve=function(Xe,Nt){var At,Wt=[],Zt=1/(Nt-1);for(At=0;At<1;At+=Zt)Wt.push(At);if(Wt.push(1),Xe[0].offset!=0){var gr={offset:0,color:Xe[0].color};Xe.unshift(gr)}if(Xe[Xe.length-1].offset!=1){var Zr={offset:1,color:Xe[Xe.length-1].color};Xe.push(Zr)}for(var jn="",Or=0,Bn=0;Bn<Wt.length;Bn++){for(At=Wt[Bn];At>Xe[Or+1].offset;)Or++;var Cn=Xe[Or].offset,as=(At-Cn)/(Xe[Or+1].offset-Cn),Io=Xe[Or].color,fi=Xe[Or+1].color;jn+=O(Math.round((1-as)*Io[0]+as*fi[0]).toString(16))+O(Math.round((1-as)*Io[1]+as*fi[1]).toString(16))+O(Math.round((1-as)*Io[2]+as*fi[2]).toString(16))}return jn.trim()}(k.colors,H),Se=[];Se.push({key:"FunctionType",value:"0"}),Se.push({key:"Domain",value:"[0.0 1.0]"}),Se.push({key:"Size",value:"["+H+"]"}),Se.push({key:"BitsPerSample",value:"8"}),Se.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Se.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),De({data:ve,additionalKeyValues:Se,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:de}),X("endobj"),k.objectNumber=fr(),X("<< /ShadingType "+k.type),X("/ColorSpace /DeviceRGB");var Ve="/Coords ["+D(parseFloat(k.coords[0]))+" "+D(parseFloat(k.coords[1]))+" ";k.type===2?Ve+=D(parseFloat(k.coords[2]))+" "+D(parseFloat(k.coords[3])):Ve+=D(parseFloat(k.coords[2]))+" "+D(parseFloat(k.coords[3]))+" "+D(parseFloat(k.coords[4]))+" "+D(parseFloat(k.coords[5])),X(Ve+="]"),k.matrix&&X("/Matrix ["+k.matrix.toString()+"]"),X("/Function "+de+" 0 R"),X("/Extend [true true]"),X(">>"),X("endobj")},ht=function(k,H){var de=br(),ve=fr();H.push({resourcesOid:de,objectOid:ve}),k.objectNumber=ve;var Se=[];Se.push({key:"Type",value:"/Pattern"}),Se.push({key:"PatternType",value:"1"}),Se.push({key:"PaintType",value:"1"}),Se.push({key:"TilingType",value:"1"}),Se.push({key:"BBox",value:"["+k.boundingBox.map(D).join(" ")+"]"}),Se.push({key:"XStep",value:D(k.xStep)}),Se.push({key:"YStep",value:D(k.yStep)}),Se.push({key:"Resources",value:de+" 0 R"}),k.matrix&&Se.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),De({data:k.stream,additionalKeyValues:Se,objectId:k.objectNumber}),X("endobj")},nt=function(k){for(var H in k.objectNumber=fr(),X("<<"),k)switch(H){case"opacity":X("/ca "+_(k[H]));break;case"stroke-opacity":X("/CA "+_(k[H]))}X(">>"),X("endobj")},ut=function(k){W(k.resourcesOid,!0),X("<<"),X("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var H in X("/Font <<"),Ot)Ot.hasOwnProperty(H)&&(f===!1||f===!0&&p.hasOwnProperty(H))&&X("/"+H+" "+Ot[H].objectNumber+" 0 R");X(">>")}(),function(){if(Object.keys(Ie).length>0){for(var H in X("/Shading <<"),Ie)Ie.hasOwnProperty(H)&&Ie[H]instanceof iu&&Ie[H].objectNumber>=0&&X("/"+H+" "+Ie[H].objectNumber+" 0 R");Qe.publish("putShadingPatternDict"),X(">>")}}(),function(H){if(Object.keys(Ie).length>0){for(var de in X("/Pattern <<"),Ie)Ie.hasOwnProperty(de)&&Ie[de]instanceof h.TilingPattern&&Ie[de].objectNumber>=0&&Ie[de].objectNumber<H&&X("/"+de+" "+Ie[de].objectNumber+" 0 R");Qe.publish("putTilingPatternDict"),X(">>")}}(k.objectOid),function(){if(Object.keys(He).length>0){var H;for(H in X("/ExtGState <<"),He)He.hasOwnProperty(H)&&He[H].objectNumber>=0&&X("/"+H+" "+He[H].objectNumber+" 0 R");Qe.publish("putGStateDict"),X(">>")}}(),function(){for(var H in X("/XObject <<"),Dt)Dt.hasOwnProperty(H)&&Dt[H].objectNumber>=0&&X("/"+H+" "+Dt[H].objectNumber+" 0 R");Qe.publish("putXobjectDict"),X(">>")}(),X(">>"),X("endobj")},Bt=function(k){qt[k.fontName]=qt[k.fontName]||{},qt[k.fontName][k.fontStyle]=k.id},Cr=function(k,H,de,ve,Se){var Ve={id:"F"+(Object.keys(Ot).length+1).toString(10),postScriptName:k,fontName:H,fontStyle:de,encoding:ve,isStandardFont:Se||!1,metadata:{}};return Qe.publish("addFont",{font:Ve,instance:this}),Ot[Ve.id]=Ve,Bt(Ve),Ve.id},or=h.__private__.pdfEscape=h.pdfEscape=function(k,H){return function(de,ve){var Se,Ve,Xe,Nt,At,Wt,Zt,gr,Zr;if(Xe=(ve=ve||{}).sourceEncoding||"Unicode",At=ve.outputEncoding,(ve.autoencode||At)&&Ot[pt].metadata&&Ot[pt].metadata[Xe]&&Ot[pt].metadata[Xe].encoding&&(Nt=Ot[pt].metadata[Xe].encoding,!At&&Ot[pt].encoding&&(At=Ot[pt].encoding),!At&&Nt.codePages&&(At=Nt.codePages[0]),typeof At=="string"&&(At=Nt[At]),At)){for(Zt=!1,Wt=[],Se=0,Ve=de.length;Se<Ve;Se++)(gr=At[de.charCodeAt(Se)])?Wt.push(String.fromCharCode(gr)):Wt.push(de[Se]),Wt[Se].charCodeAt(0)>>8&&(Zt=!0);de=Wt.join("")}for(Se=de.length;Zt===void 0&&Se!==0;)de.charCodeAt(Se-1)>>8&&(Zt=!0),Se--;if(!Zt)return de;for(Wt=ve.noBOM?[]:[254,255],Se=0,Ve=de.length;Se<Ve;Se++){if((Zr=(gr=de.charCodeAt(Se))>>8)>>8)throw new Error("Character at position "+Se+" of string '"+de+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Wt.push(Zr),Wt.push(gr-(Zr<<8))}return String.fromCharCode.apply(void 0,Wt)}(k,H).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},nn=h.__private__.beginPage=function(k){Le[++ft]=[],Ye[ft]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},Vi(ft),Fe(Le[R])},Wi=function(k,H){var de,ve,Se;switch(r=H||r,typeof k=="string"&&(de=x(k.toLowerCase()),Array.isArray(de)&&(ve=de[0],Se=de[1])),Array.isArray(k)&&(ve=k[0]*it,Se=k[1]*it),isNaN(ve)&&(ve=s[0],Se=s[1]),(ve>14400||Se>14400)&&(Rr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ve=Math.min(14400,ve),Se=Math.min(14400,Se)),s=[ve,Se],r.substr(0,1)){case"l":Se>ve&&(s=[Se,ve]);break;case"p":ve>Se&&(s=[Se,ve])}nn(s),Kt(Yf),X(od),Jf!==0&&X(Jf+" J"),Qf!==0&&X(Qf+" j"),Qe.publish("addPage",{pageNumber:ft})},ui=function(k){k>0&&k<=ft&&(Le.splice(k,1),Ye.splice(k,1),ft--,R>ft&&(R=ft),this.setPage(R))},Vi=function(k){k>0&&k<=ft&&(R=k)},Ua=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Le.length-1},_l=function(k,H,de){var ve,Se=void 0;return de=de||{},k=k!==void 0?k:Ot[pt].fontName,H=H!==void 0?H:Ot[pt].fontStyle,ve=k.toLowerCase(),qt[ve]!==void 0&&qt[ve][H]!==void 0?Se=qt[ve][H]:qt[k]!==void 0&&qt[k][H]!==void 0?Se=qt[k][H]:de.disableWarning===!1&&Rr.warn("Unable to look up font label for font '"+k+"', '"+H+"'. Refer to getFontList() for available fonts."),Se||de.noFallback||(Se=qt.times[H])==null&&(Se=qt.times.normal),Se},En=h.__private__.putInfo=function(){var k=fr(),H=function(ve){return ve};for(var de in d!==null&&(H=Mn.encryptor(k,0)),X("<<"),X("/Producer ("+or(H("jsPDF "+jt.version))+")"),Lt)Lt.hasOwnProperty(de)&&Lt[de]&&X("/"+de.substr(0,1).toUpperCase()+de.substr(1)+" ("+or(H(Lt[de]))+")");X("/CreationDate ("+or(H(Z))+")"),X(">>"),X("endobj")},sd=h.__private__.putCatalog=function(k){var H=(k=k||{}).rootDictionaryObjId||ee;switch(fr(),X("<<"),X("/Type /Catalog"),X("/Pages "+H+" 0 R"),xt||(xt="fullwidth"),xt){case"fullwidth":X("/OpenAction [3 0 R /FitH null]");break;case"fullheight":X("/OpenAction [3 0 R /FitV null]");break;case"fullpage":X("/OpenAction [3 0 R /Fit]");break;case"original":X("/OpenAction [3 0 R /XYZ null null 1]");break;default:var de=""+xt;de.substr(de.length-1)==="%"&&(xt=parseInt(xt)/100),typeof xt=="number"&&X("/OpenAction [3 0 R /XYZ null null "+_(xt)+"]")}switch(It||(It="continuous"),It){case"continuous":X("/PageLayout /OneColumn");break;case"single":X("/PageLayout /SinglePage");break;case"two":case"twoleft":X("/PageLayout /TwoColumnLeft");break;case"tworight":X("/PageLayout /TwoColumnRight")}ct&&X("/PageMode /"+ct),Qe.publish("putCatalog"),X(">>"),X("endobj")},Wx=h.__private__.putTrailer=function(){X("trailer"),X("<<"),X("/Size "+(Y+1)),X("/Root "+Y+" 0 R"),X("/Info "+(Y-1)+" 0 R"),d!==null&&X("/Encrypt "+Mn.oid+" 0 R"),X("/ID [ <"+ae+"> <"+ae+"> ]"),X(">>")},An=h.__private__.putHeader=function(){X("%PDF-"+m),X("%")},Bp=h.__private__.putXRef=function(){var k="0000000000";X("xref"),X("0 "+(Y+1)),X("0000000000 65535 f ");for(var H=1;H<=Y;H++)typeof ie[H]=="function"?X((k+ie[H]()).slice(-10)+" 00000 n "):ie[H]!==void 0?X((k+ie[H]).slice(-10)+" 00000 n "):X("0000000000 00000 n ")},Ki=h.__private__.buildDocument=function(){var k;Y=0,ge=0,me=[],ie=[],xe=[],ee=br(),se=br(),Fe(me),Qe.publish("buildDocument"),An(),Ae(),function(){Qe.publish("putAdditionalObjects");for(var de=0;de<xe.length;de++){var ve=xe[de];W(ve.objId,!0),X(ve.content),X("endobj")}Qe.publish("postPutAdditionalObjects")}(),k=[],function(){for(var de in Ot)Ot.hasOwnProperty(de)&&(f===!1||f===!0&&p.hasOwnProperty(de))&&Te(Ot[de])}(),function(){var de;for(de in He)He.hasOwnProperty(de)&&nt(He[de])}(),function(){for(var de in Dt)Dt.hasOwnProperty(de)&&Ze(Dt[de])}(),function(de){var ve;for(ve in Ie)Ie.hasOwnProperty(ve)&&(Ie[ve]instanceof iu?at(Ie[ve]):Ie[ve]instanceof Vd&&ht(Ie[ve],de))}(k),Qe.publish("putResources"),k.forEach(ut),ut({resourcesOid:se,objectOid:Number.MAX_SAFE_INTEGER}),Qe.publish("postPutResources"),d!==null&&(Mn.oid=fr(),X("<<"),X("/Filter /Standard"),X("/V "+Mn.v),X("/R "+Mn.r),X("/U <"+Mn.toHexString(Mn.U)+">"),X("/O <"+Mn.toHexString(Mn.O)+">"),X("/P "+Mn.P),X(">>"),X("endobj")),En(),sd();var H=ge;return Bp(),Wx(),X("startxref"),X(""+H),X("%%EOF"),Fe(Le[R]),me.join(`
`)},ad=h.__private__.getBlob=function(k){return new Blob([Me(k)],{type:"application/pdf"})},Up=h.output=h.__private__.output=(Pr=function(k,H){switch(typeof(H=H||{})=="string"?H={filename:H}:H.filename=H.filename||"generated.pdf",k){case void 0:return Ki();case"save":h.save(H.filename);break;case"arraybuffer":return Me(Ki());case"blob":return ad(Ki());case"bloburi":case"bloburl":if(Ht.URL!==void 0&&typeof Ht.URL.createObjectURL=="function")return Ht.URL&&Ht.URL.createObjectURL(ad(Ki()))||void 0;Rr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var de="",ve=Ki();try{de=D_(ve)}catch{de=D_(unescape(encodeURIComponent(ve)))}return"data:application/pdf;filename="+H.filename+";base64,"+de;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ht)==="[object Window]"){var Se="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ve=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';H.pdfObjectUrl&&(Se=H.pdfObjectUrl,Ve="");var Xe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Se+'"'+Ve+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(H)+");<\/script></body></html>",Nt=Ht.open();return Nt!==null&&Nt.document.write(Xe),Nt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ht)==="[object Window]"){var At='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(H.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+H.filename+'" width="500px" height="400px" /></body></html>',Wt=Ht.open();if(Wt!==null){Wt.document.write(At);var Zt=this;Wt.document.documentElement.querySelector("#pdfViewer").onload=function(){Wt.document.title=H.filename,Wt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Zt.output("bloburl"))}}return Wt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ht)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var gr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",H)+'"></iframe></body></html>',Zr=Ht.open();if(Zr!==null&&(Zr.document.write(gr),Zr.document.title=H.filename),Zr||typeof safari>"u")return Zr;break;case"datauri":case"dataurl":return Ht.document.location.href=this.output("datauristring",H);default:return null}},Pr.foo=function(){try{return Pr.apply(this,arguments)}catch(de){var k=de.stack||"";~k.indexOf(" at ")&&(k=k.split(" at ")[1]);var H="Error in function "+k.split(`
`)[0].split("<")[0]+": "+de.message;if(!Ht.console)throw new Error(H);Ht.console.error(H,de),Ht.alert&&alert(H)}},Pr.foo.bar=Pr,Pr.foo),$a=function(k){return Array.isArray(zt)===!0&&zt.indexOf(k)>-1};switch(n){case"pt":it=1;break;case"mm":it=72/25.4;break;case"cm":it=72/2.54;break;case"in":it=72;break;case"px":it=$a("px_scaling")==1?.75:96/72;break;case"pc":case"em":it=12;break;case"ex":it=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);it=n}var Mn=null;pe(),re();var Co=h.__private__.getPageInfo=h.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ye[k].objId,pageNumber:k,pageContext:Ye[k]}},$p=h.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var H in Ye)if(Ye[H].objId===k)break;return Co(H)},Vx=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:Ye[R].objId,pageNumber:R,pageContext:Ye[R]}};h.addPage=function(){return Wi.apply(this,arguments),this},h.setPage=function(){return Vi.apply(this,arguments),Fe.call(this,Le[R]),this},h.insertPage=function(k){return this.addPage(),this.movePage(R,k),this},h.movePage=function(k,H){var de,ve;if(k>H){de=Le[k],ve=Ye[k];for(var Se=k;Se>H;Se--)Le[Se]=Le[Se-1],Ye[Se]=Ye[Se-1];Le[H]=de,Ye[H]=ve,this.setPage(H)}else if(k<H){de=Le[k],ve=Ye[k];for(var Ve=k;Ve<H;Ve++)Le[Ve]=Le[Ve+1],Ye[Ve]=Ye[Ve+1];Le[H]=de,Ye[H]=ve,this.setPage(H)}return this},h.deletePage=function(){return ui.apply(this,arguments),this},h.__private__.text=h.text=function(k,H,de,ve,Se){var Ve,Xe,Nt,At,Wt,Zt,gr,Zr,jn,Or=(ve=ve||{}).scope||this;if(typeof k=="number"&&typeof H=="number"&&(typeof de=="string"||Array.isArray(de))){var Bn=de;de=H,H=k,k=Bn}if(arguments[3]instanceof Et==0?(Nt=arguments[4],At=arguments[5],Ar(gr=arguments[3])==="object"&&gr!==null||(typeof Nt=="string"&&(At=Nt,Nt=null),typeof gr=="string"&&(At=gr,gr=null),typeof gr=="number"&&(Nt=gr,gr=null),ve={flags:gr,angle:Nt,align:At})):(E("The transform parameter of text() with a Matrix value"),jn=Se),isNaN(H)||isNaN(de)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Or;var Cn,as="",Io=typeof ve.lineHeightFactor=="number"?ve.lineHeightFactor:$c,fi=Or.internal.scaleFactor;function Oo(Nr){return Nr=Nr.split("	").join(Array(ve.TabLen||9).join(" ")),or(Nr,gr)}function rh(Nr){for(var Lr,gn=Nr.concat(),Un=[],Uo=gn.length;Uo--;)typeof(Lr=gn.shift())=="string"?Un.push(Lr):Array.isArray(Nr)&&(Lr.length===1||Lr[1]===void 0&&Lr[2]===void 0)?Un.push(Lr[0]):Un.push([Lr[0],Lr[1],Lr[2]]);return Un}function cd(Nr,Lr){var gn;if(typeof Nr=="string")gn=Lr(Nr)[0];else if(Array.isArray(Nr)){for(var Un,Uo,fh=Nr.concat(),fd=[],Qp=fh.length;Qp--;)typeof(Un=fh.shift())=="string"?fd.push(Lr(Un)[0]):Array.isArray(Un)&&typeof Un[0]=="string"&&(Uo=Lr(Un[0],Un[1],Un[2]),fd.push([Uo[0],Uo[1],Uo[2]]));gn=fd}return gn}var El=!1,Wc=!0;if(typeof k=="string")El=!0;else if(Array.isArray(k)){var Vc=k.concat();Xe=[];for(var Al,is=Vc.length;is--;)(typeof(Al=Vc.shift())!="string"||Array.isArray(Al)&&typeof Al[0]!="string")&&(Wc=!1);El=Wc}if(El===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Kc=Ue/Or.internal.scaleFactor,Gc=Kc*(Io-1);switch(ve.baseline){case"bottom":de-=Gc;break;case"top":de+=Kc-Gc;break;case"hanging":de+=Kc-2*Gc;break;case"middle":de+=Kc/2-Gc}if((Zt=ve.maxWidth||0)>0&&(typeof k=="string"?k=Or.splitTextToSize(k,Zt):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(Nr,Lr){return Nr.concat(Or.splitTextToSize(Lr,Zt))},[]))),Ve={text:k,x:H,y:de,options:ve,mutex:{pdfEscape:or,activeFontKey:pt,fonts:Ot,activeFontSize:Ue}},Qe.publish("preProcessText",Ve),k=Ve.text,Nt=(ve=Ve.options).angle,jn instanceof Et==0&&Nt&&typeof Nt=="number"){Nt*=Math.PI/180,ve.rotationDirection===0&&(Nt=-Nt),N===b&&(Nt=-Nt);var nh=Math.cos(Nt),sh=Math.sin(Nt);jn=new Et(nh,sh,-sh,nh,0,0)}else Nt&&Nt instanceof Et&&(jn=Nt);N!==b||jn||(jn=va),(Wt=ve.charSpace||Lo)!==void 0&&(as+=D(M(Wt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Zr=ve.horizontalScale)!==void 0&&(as+=D(100*Zr)+` Tz
`),ve.lang;var Hs=-1,Mo=ve.renderingMode!==void 0?ve.renderingMode:ve.stroke,ud=Or.internal.getCurrentPageInfo().pageContext;switch(Mo){case 0:case!1:case"fill":Hs=0;break;case 1:case!0:case"stroke":Hs=1;break;case 2:case"fillThenStroke":Hs=2;break;case 3:case"invisible":Hs=3;break;case 4:case"fillAndAddForClipping":Hs=4;break;case 5:case"strokeAndAddPathForClipping":Hs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Hs=6;break;case 7:case"addToPathForClipping":Hs=7}var Xp=ud.usedRenderingMode!==void 0?ud.usedRenderingMode:-1;Hs!==-1?as+=Hs+` Tr
`:Xp!==-1&&(as+=`0 Tr
`),Hs!==-1&&(ud.usedRenderingMode=Hs),At=ve.align||"left";var za,Yc=Ue*Io,ah=Or.internal.pageSize.getWidth(),ih=Ot[pt];Wt=ve.charSpace||Lo,Zt=ve.maxWidth||0,gr=Object.assign({autoencode:!0,noBOM:!0},ve.flags);var jl=[],Xc=function(Nr){return Or.getStringUnitWidth(Nr,{font:ih,charSpace:Wt,fontSize:Ue,doKerning:!1})*Ue/fi};if(Object.prototype.toString.call(k)==="[object Array]"){var ya;Xe=rh(k),At!=="left"&&(za=Xe.map(Xc));var wa,Cl=0;if(At==="right"){H-=za[0],k=[],is=Xe.length;for(var Bo=0;Bo<is;Bo++)Bo===0?(wa=To(H),ya=Po(de)):(wa=M(Cl-za[Bo]),ya=-Yc),k.push([Xe[Bo],wa,ya]),Cl=za[Bo]}else if(At==="center"){H-=za[0]/2,k=[],is=Xe.length;for(var Tl=0;Tl<is;Tl++)Tl===0?(wa=To(H),ya=Po(de)):(wa=M((Cl-za[Tl])/2),ya=-Yc),k.push([Xe[Tl],wa,ya]),Cl=za[Tl]}else if(At==="left"){k=[],is=Xe.length;for(var oh=0;oh<is;oh++)k.push(Xe[oh])}else if(At==="justify"&&ih.encoding==="Identity-H"){k=[],is=Xe.length,Zt=Zt!==0?Zt:ah;for(var dd=0,mn=0;mn<is;mn++)if(ya=mn===0?Po(de):-Yc,wa=mn===0?To(H):dd,mn<is-1){var Jp=M((Zt-za[mn])/(Xe[mn].split(" ").length-1)),Yi=Xe[mn].split(" ");k.push([Yi[0]+" ",wa,ya]),dd=0;for(var Xi=1;Xi<Yi.length;Xi++){var lh=(Xc(Yi[Xi-1]+" "+Yi[Xi])-Xc(Yi[Xi]))*fi+Jp;Xi==Yi.length-1?k.push([Yi[Xi],lh,0]):k.push([Yi[Xi]+" ",lh,0]),dd-=lh}}else k.push([Xe[mn],wa,ya]);k.push(["",dd,0])}else{if(At!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],is=Xe.length,Zt=Zt!==0?Zt:ah,mn=0;mn<is;mn++){ya=mn===0?Po(de):-Yc,wa=mn===0?To(H):0;var ch=Xe[mn].split(" ").length-1,uh=ch>0?(Zt-za[mn])/ch:0;mn<is-1?jl.push(D(M(uh))):jl.push(0),k.push([Xe[mn],wa,ya])}}}(typeof ve.R2L=="boolean"?ve.R2L:gt)===!0&&(k=cd(k,function(Nr,Lr,gn){return[Nr.split("").reverse().join(""),Lr,gn]})),Ve={text:k,x:H,y:de,options:ve,mutex:{pdfEscape:or,activeFontKey:pt,fonts:Ot,activeFontSize:Ue}},Qe.publish("postProcessText",Ve),k=Ve.text,Cn=Ve.mutex.isHex||!1;var dh=Ot[pt].encoding;dh!=="WinAnsiEncoding"&&dh!=="StandardEncoding"||(k=cd(k,function(Nr,Lr,gn){return[Oo(Nr),Lr,gn]})),Xe=rh(k),k=[];for(var Pl,Ll,Fl,Jc=Array.isArray(Xe[0])?1:0,Dl="",Qc=function(Nr,Lr,gn){var Un="";return gn instanceof Et?(gn=typeof ve.angle=="number"?sr(gn,new Et(1,0,0,1,Nr,Lr)):sr(new Et(1,0,0,1,Nr,Lr),gn),N===b&&(gn=sr(new Et(1,0,0,-1,0,0),gn)),Un=gn.join(" ")+` Tm
`):Un=D(Nr)+" "+D(Lr)+` Td
`,Un},Ha=0;Ha<Xe.length;Ha++){switch(Dl="",Jc){case 1:Fl=(Cn?"<":"(")+Xe[Ha][0]+(Cn?">":")"),Pl=parseFloat(Xe[Ha][1]),Ll=parseFloat(Xe[Ha][2]);break;case 0:Fl=(Cn?"<":"(")+Xe[Ha]+(Cn?">":")"),Pl=To(H),Ll=Po(de)}jl!==void 0&&jl[Ha]!==void 0&&(Dl=jl[Ha]+` Tw
`),Ha===0?k.push(Dl+Qc(Pl,Ll,jn)+Fl):Jc===0?k.push(Dl+Fl):Jc===1&&k.push(Dl+Qc(Pl,Ll,jn)+Fl)}k=Jc===0?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var Ji=`BT
/`;return Ji+=pt+" "+Ue+` Tf
`,Ji+=D(Ue*Io)+` TL
`,Ji+=zc+`
`,Ji+=as,Ji+=k,X(Ji+="ET"),p[pt]=!0,Or};var Kx=h.__private__.clip=h.clip=function(k){return X(k==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Kx("evenodd")},h.__private__.discardPath=h.discardPath=function(){return X("n"),this};var Gi=h.__private__.isValidStyle=function(k){var H=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(H=!0),H};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(k){return Gi(k)&&(u=k),this};var zp=h.__private__.getStyle=h.getStyle=function(k){var H=u;switch(k){case"D":case"S":H="S";break;case"F":H="f";break;case"FD":case"DF":H="B";break;case"f":case"f*":case"B":case"B*":H=k}return H},Hp=h.close=function(){return X("h"),this};h.stroke=function(){return X("S"),this},h.fill=function(k){return id("f",k),this},h.fillEvenOdd=function(k){return id("f*",k),this},h.fillStroke=function(k){return id("B",k),this},h.fillStrokeEvenOdd=function(k){return id("B*",k),this};var id=function(k,H){Ar(H)==="object"?Yx(H,k):X(k)},Uc=function(k){k===null||N===b&&k===void 0||(k=zp(k),X(k))};function Gx(k,H,de,ve,Se){var Ve=new Vd(H||this.boundingBox,de||this.xStep,ve||this.yStep,this.gState,Se||this.matrix);Ve.stream=this.stream;var Xe=k+"$$"+this.cloneIndex+++"$$";return pn(Xe,Ve),Ve}var Yx=function(k,H){var de=Ge[k.key],ve=Ie[de];if(ve instanceof iu)X("q"),X(Xx(H)),ve.gState&&h.setGState(ve.gState),X(k.matrix.toString()+" cm"),X("/"+de+" sh"),X("Q");else if(ve instanceof Vd){var Se=new Et(1,0,0,-1,0,qc());k.matrix&&(Se=Se.multiply(k.matrix||va),de=Gx.call(ve,k.key,k.boundingBox,k.xStep,k.yStep,Se).id),X("q"),X("/Pattern cs"),X("/"+de+" scn"),ve.gState&&h.setGState(ve.gState),X(H),X("Q")}},Xx=function(k){switch(k){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Gf=h.moveTo=function(k,H){return X(D(M(k))+" "+D(K(H))+" m"),this},qp=h.lineTo=function(k,H){return X(D(M(k))+" "+D(K(H))+" l"),this},di=h.curveTo=function(k,H,de,ve,Se,Ve){return X([D(M(k)),D(K(H)),D(M(de)),D(K(ve)),D(M(Se)),D(K(Ve)),"c"].join(" ")),this};h.__private__.line=h.line=function(k,H,de,ve,Se){if(isNaN(k)||isNaN(H)||isNaN(de)||isNaN(ve)||!Gi(Se))throw new Error("Invalid arguments passed to jsPDF.line");return N===w?this.lines([[de-k,ve-H]],k,H,[1,1],Se||"S"):this.lines([[de-k,ve-H]],k,H,[1,1]).stroke()},h.__private__.lines=h.lines=function(k,H,de,ve,Se,Ve){var Xe,Nt,At,Wt,Zt,gr,Zr,jn,Or,Bn,Cn,as;if(typeof k=="number"&&(as=de,de=H,H=k,k=as),ve=ve||[1,1],Ve=Ve||!1,isNaN(H)||isNaN(de)||!Array.isArray(k)||!Array.isArray(ve)||!Gi(Se)||typeof Ve!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Gf(H,de),Xe=ve[0],Nt=ve[1],Wt=k.length,Bn=H,Cn=de,At=0;At<Wt;At++)(Zt=k[At]).length===2?(Bn=Zt[0]*Xe+Bn,Cn=Zt[1]*Nt+Cn,qp(Bn,Cn)):(gr=Zt[0]*Xe+Bn,Zr=Zt[1]*Nt+Cn,jn=Zt[2]*Xe+Bn,Or=Zt[3]*Nt+Cn,Bn=Zt[4]*Xe+Bn,Cn=Zt[5]*Nt+Cn,di(gr,Zr,jn,Or,Bn,Cn));return Ve&&Hp(),Uc(Se),this},h.path=function(k){for(var H=0;H<k.length;H++){var de=k[H],ve=de.c;switch(de.op){case"m":Gf(ve[0],ve[1]);break;case"l":qp(ve[0],ve[1]);break;case"c":di.apply(this,ve);break;case"h":Hp()}}return this},h.__private__.rect=h.rect=function(k,H,de,ve,Se){if(isNaN(k)||isNaN(H)||isNaN(de)||isNaN(ve)||!Gi(Se))throw new Error("Invalid arguments passed to jsPDF.rect");return N===w&&(ve=-ve),X([D(M(k)),D(K(H)),D(M(de)),D(M(ve)),"re"].join(" ")),Uc(Se),this},h.__private__.triangle=h.triangle=function(k,H,de,ve,Se,Ve,Xe){if(isNaN(k)||isNaN(H)||isNaN(de)||isNaN(ve)||isNaN(Se)||isNaN(Ve)||!Gi(Xe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[de-k,ve-H],[Se-de,Ve-ve],[k-Se,H-Ve]],k,H,[1,1],Xe,!0),this},h.__private__.roundedRect=h.roundedRect=function(k,H,de,ve,Se,Ve,Xe){if(isNaN(k)||isNaN(H)||isNaN(de)||isNaN(ve)||isNaN(Se)||isNaN(Ve)||!Gi(Xe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nt=4/3*(Math.SQRT2-1);return Se=Math.min(Se,.5*de),Ve=Math.min(Ve,.5*ve),this.lines([[de-2*Se,0],[Se*Nt,0,Se,Ve-Ve*Nt,Se,Ve],[0,ve-2*Ve],[0,Ve*Nt,-Se*Nt,Ve,-Se,Ve],[2*Se-de,0],[-Se*Nt,0,-Se,-Ve*Nt,-Se,-Ve],[0,2*Ve-ve],[0,-Ve*Nt,Se*Nt,-Ve,Se,-Ve]],k+Se,H,[1,1],Xe,!0),this},h.__private__.ellipse=h.ellipse=function(k,H,de,ve,Se){if(isNaN(k)||isNaN(H)||isNaN(de)||isNaN(ve)||!Gi(Se))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ve=4/3*(Math.SQRT2-1)*de,Xe=4/3*(Math.SQRT2-1)*ve;return Gf(k+de,H),di(k+de,H-Xe,k+Ve,H-ve,k,H-ve),di(k-Ve,H-ve,k-de,H-Xe,k-de,H),di(k-de,H+Xe,k-Ve,H+ve,k,H+ve),di(k+Ve,H+ve,k+de,H+Xe,k+de,H),Uc(Se),this},h.__private__.circle=h.circle=function(k,H,de,ve){if(isNaN(k)||isNaN(H)||isNaN(de)||!Gi(ve))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,H,de,de,ve)},h.setFont=function(k,H,de){return de&&(H=j(H,de)),pt=_l(k,H,{disableWarning:!1}),this};var Jx=h.__private__.getFont=h.getFont=function(){return Ot[_l.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var k,H,de={};for(k in qt)if(qt.hasOwnProperty(k))for(H in de[k]=[],qt[k])qt[k].hasOwnProperty(H)&&de[k].push(H);return de},h.addFont=function(k,H,de,ve,Se){var Ve=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ve.indexOf(arguments[3])!==-1?Se=arguments[3]:arguments[3]&&Ve.indexOf(arguments[3])==-1&&(de=j(de,ve)),Cr.call(this,k,H,de,Se=Se||"Identity-H")};var $c,Yf=e.lineWidth||.200025,Qx=h.__private__.getLineWidth=h.getLineWidth=function(){return Yf},Kt=h.__private__.setLineWidth=h.setLineWidth=function(k){return Yf=k,X(D(M(k))+" w"),this};h.__private__.setLineDash=jt.API.setLineDash=jt.API.setLineDashPattern=function(k,H){if(k=k||[],H=H||0,isNaN(H)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(de){return D(M(de))}).join(" "),H=D(M(H)),X("["+k+"] "+H+" d"),this};var Zx=h.__private__.getLineHeight=h.getLineHeight=function(){return Ue*$c};h.__private__.getLineHeight=h.getLineHeight=function(){return Ue*$c};var e2=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&($c=k),this},t2=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return $c};e2(e.lineHeight);var To=h.__private__.getHorizontalCoordinate=function(k){return M(k)},Po=h.__private__.getVerticalCoordinate=function(k){return N===b?k:Ye[R].mediaBox.topRightY-Ye[R].mediaBox.bottomLeftY-M(k)},r2=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(k){return D(To(k))},n2=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(k){return D(Po(k))},od=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return oe(od)},h.__private__.setStrokeColor=h.setDrawColor=function(k,H,de,ve){return od=fe({ch1:k,ch2:H,ch3:de,ch4:ve,pdfColorType:"draw",precision:2}),X(od),this};var Xf=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return oe(Xf)},h.__private__.setFillColor=h.setFillColor=function(k,H,de,ve){return Xf=fe({ch1:k,ch2:H,ch3:de,ch4:ve,pdfColorType:"fill",precision:2}),X(Xf),this};var zc=e.textColor||"0 g",s2=h.__private__.getTextColor=h.getTextColor=function(){return oe(zc)};h.__private__.setTextColor=h.setTextColor=function(k,H,de,ve){return zc=fe({ch1:k,ch2:H,ch3:de,ch4:ve,pdfColorType:"text",precision:3}),this};var Lo=e.charSpace,a2=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Lo||0)};h.__private__.setCharSpace=h.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Lo=k,this};var Jf=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(k){var H=h.CapJoinStyles[k];if(H===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Jf=H,X(H+" J"),this};var Qf=0;h.__private__.setLineJoin=h.setLineJoin=function(k){var H=h.CapJoinStyles[k];if(H===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qf=H,X(H+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return X(D(M(k))+" M"),this},h.GState=Y1,h.setGState=function(k){(k=typeof k=="string"?He[Be[k]]:Wp(null,k)).equals($e)||(X("/"+k.id+" gs"),$e=k)};var Wp=function(k,H){if(!k||!Be[k]){var de=!1;for(var ve in He)if(He.hasOwnProperty(ve)&&He[ve].equals(H)){de=!0;break}if(de)H=He[ve];else{var Se="GS"+(Object.keys(He).length+1).toString(10);He[Se]=H,H.id=Se}return k&&(Be[k]=H.id),Qe.publish("addGState",H),H}};h.addGState=function(k,H){return Wp(k,H),this},h.saveGraphicsState=function(){return X("q"),Ne.push({key:pt,size:Ue,color:zc}),this},h.restoreGraphicsState=function(){X("Q");var k=Ne.pop();return pt=k.key,Ue=k.size,zc=k.color,$e=null,this},h.setCurrentTransformationMatrix=function(k){return X(k.toString()+" cm"),this},h.comment=function(k){return X("#"+k),this};var Fo=function(k,H){var de=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return de},set:function(Ve){isNaN(Ve)||(de=parseFloat(Ve))}});var ve=H||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ve},set:function(Ve){isNaN(Ve)||(ve=parseFloat(Ve))}});var Se="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Se},set:function(Ve){Se=Ve.toString()}}),this},Zf=function(k,H,de,ve){Fo.call(this,k,H),this.type="rect";var Se=de||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Se},set:function(Xe){isNaN(Xe)||(Se=parseFloat(Xe))}});var Ve=ve||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ve},set:function(Xe){isNaN(Xe)||(Ve=parseFloat(Xe))}}),this},ld=function(){this.page=ft,this.currentPage=R,this.pages=Le.slice(0),this.pagesContext=Ye.slice(0),this.x=ot,this.y=ir,this.matrix=Ft,this.width=th(R),this.height=Kp(R),this.outputDestination=Re,this.id="",this.objectNumber=-1};ld.prototype.restore=function(){ft=this.page,R=this.currentPage,Ye=this.pagesContext,Le=this.pages,ot=this.x,ir=this.y,Ft=this.matrix,Vp(R,this.width),Do(R,this.height),Re=this.outputDestination};var eh=function(k,H,de,ve,Se){wr.push(new ld),ft=R=0,Le=[],ot=k,ir=H,Ft=Se,nn([de,ve])};for(var Hc in h.beginFormObject=function(k,H,de,ve,Se){return eh(k,H,de,ve,Se),this},h.endFormObject=function(k){return function(H){if(_n[H])wr.pop().restore();else{var de=new ld,ve="Xo"+(Object.keys(Dt).length+1).toString(10);de.id=ve,_n[H]=ve,Dt[ve]=de,Qe.publish("addFormObject",de),wr.pop().restore()}}(k),this},h.doFormObject=function(k,H){var de=Dt[_n[k]];return X("q"),X(H.toString()+" cm"),X("/"+de.id+" Do"),X("Q"),this},h.getFormObject=function(k){var H=Dt[_n[k]];return{x:H.x,y:H.y,width:H.width,height:H.height,matrix:H.matrix}},h.save=function(k,H){return k=k||"generated.pdf",(H=H||{}).returnPromise=H.returnPromise||!1,H.returnPromise===!1?(su(ad(Ki()),k),typeof su.unload=="function"&&Ht.setTimeout&&setTimeout(su.unload,911),this):new Promise(function(de,ve){try{var Se=su(ad(Ki()),k);typeof su.unload=="function"&&Ht.setTimeout&&setTimeout(su.unload,911),de(Se)}catch(Ve){ve(Ve.message)}})},jt.API)jt.API.hasOwnProperty(Hc)&&(Hc==="events"&&jt.API.events.length?function(k,H){var de,ve,Se;for(Se=H.length-1;Se!==-1;Se--)de=H[Se][0],ve=H[Se][1],k.subscribe.apply(k,[de].concat(typeof ve=="function"?[ve]:ve))}(Qe,jt.API.events):h[Hc]=jt.API[Hc]);function th(k){return Ye[k].mediaBox.topRightX-Ye[k].mediaBox.bottomLeftX}function Vp(k,H){Ye[k].mediaBox.topRightX=H+Ye[k].mediaBox.bottomLeftX}function Kp(k){return Ye[k].mediaBox.topRightY-Ye[k].mediaBox.bottomLeftY}function Do(k,H){Ye[k].mediaBox.topRightY=H+Ye[k].mediaBox.bottomLeftY}var Ro=h.getPageWidth=function(k){return th(k=k||R)/it},Gp=h.setPageWidth=function(k,H){Vp(k,H*it)},qc=h.getPageHeight=function(k){return Kp(k=k||R)/it},Yp=h.setPageHeight=function(k,H){Do(k,H*it)};return h.internal={pdfEscape:or,getStyle:zp,getFont:Jx,getFontSize:tt,getCharSpace:a2,getTextColor:s2,getLineHeight:Zx,getLineHeightFactor:t2,getLineWidth:Qx,write:Oe,getHorizontalCoordinate:To,getVerticalCoordinate:Po,getCoordinateString:r2,getVerticalCoordinateString:n2,collections:{},newObject:fr,newAdditionalObject:te,newObjectDeferred:br,newObjectDeferredBegin:W,getFilters:_e,putStream:De,events:Qe,scaleFactor:it,pageSize:{getWidth:function(){return Ro(R)},setWidth:function(k){Gp(R,k)},getHeight:function(){return qc(R)},setHeight:function(k){Yp(R,k)}},encryptionOptions:d,encryption:Mn,getEncryptor:function(k){return d!==null?Mn.encryptor(k,0):function(H){return H}},output:Up,getNumberOfPages:Ua,get pages(){return Le},out:X,f2:_,f3:L,getPageInfo:Co,getPageInfoByObjId:$p,getCurrentPageInfo:Vx,getPDFVersion:g,Point:Fo,Rectangle:Zf,Matrix:Et,hasHotfix:$a},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Ro(R)},set:function(k){Gp(R,k)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return qc(R)},set:function(k){Yp(R,k)},enumerable:!0,configurable:!0}),(function(k){for(var H=0,de=st.length;H<de;H++){var ve=Cr.call(this,k[H][0],k[H][1],k[H][2],st[H][3],!0);f===!1&&(p[ve]=!0);var Se=k[H][0].split("-");Bt({id:ve,fontName:Se[0],fontStyle:Se[1]||""})}Qe.publish("addFonts",{fonts:Ot,dictionary:qt})}).call(h,st),pt="F1",Wi(s,r),Qe.publish("initialized"),h}Pd.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Pd.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Pd.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Pd.prototype.processOwnerPassword=function(e,t){return s5(n5(t).substr(0,5),e)},Pd.prototype.encryptor=function(e,t){var r=n5(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return s5(r,n)}},Y1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Ar(e)!==Ar(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},jt.API={events:[]},jt.version="3.0.4";var cn=jt.API,y4=1,nd=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Sd=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Yt=function(e){return e.toFixed(2)},Wl=function(e){return e.toFixed(5)};cn.__acroform__={};var xa=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},M_=function(e){return e*y4},so=function(e){var t=new bP,r=bt.internal.getHeight(e)||0,n=bt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Yt(n)),Number(Yt(r))],t},tee=cn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},ree=cn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},nee=cn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},bn=cn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return nee(e,t-1)},Nn=cn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return tee(e,t-1)},Sn=cn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return ree(e,t-1)},see=cn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],a=e[1],i=e[2],o=e[3],l={};return l.lowerLeft_X=r(s)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=r(s+i)||0,l.upperRight_Y=n(a)||0,[Number(Yt(l.lowerLeft_X)),Number(Yt(l.lowerLeft_Y)),Number(Yt(l.upperRight_X)),Number(Yt(l.upperRight_Y))]},aee=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=a5(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+Yt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=so(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},a5=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(_){return _.split(`
`)}):s.map(function(_){return[_]});var a=r,i=bt.internal.getHeight(e)||0;i=i<0?-i:i;var o=bt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(_,L,M){if(_+1<s.length){var K=L+" "+s[_+1][0];return cg(K,e,M).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var u,d,f=cg("3",e,a).height,p=e.multiline?i-a:(i-f)/2,h=p+=2,m=0,g=0,y=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+cg(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var x="",w=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var N=!1;if(s[b].length!==1&&y!==s[b].length-1){if((f+2)*(w+2)+2>i)continue e;x+=s[b][y],N=!0,g=b,b--}else{x=(x+=s[b][y]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var A=parseInt(b),P=l(A,x,a),j=b>=s.length-1;if(P&&!j){x+=" ",y=0;continue}if(P||j){if(j)g=A;else if(e.multiline&&(f+2)*(w+2)+2>i)continue e}else{if(!e.multiline||(f+2)*(w+2)+2>i)continue e;g=A}}for(var D="",E=m;E<=g;E++){var I=s[E];if(e.multiline){if(E===g){D+=I[y]+" ",y=(y+1)%I.length;continue}if(E===m){D+=I[I.length-1]+" ";continue}}D+=I[0]+" "}switch(D=D.substr(D.length-1)==" "?D.substr(0,D.length-1):D,d=cg(D,e,a).width,e.textAlign){case"right":u=o-d-2;break;case"center":u=(o-d)/2;break;default:u=2}t+=Yt(u)+" "+Yt(h)+` Td
`,t+="("+nd(D)+`) Tj
`,t+=-Yt(u)+` 0 Td
`,h=-(a+2),d=0,m=N?g:g+1,w++,x=""}break}return n.text=t,n.fontSize=a,n},cg=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},iee={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},oee=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},lee=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Hi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(iee)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");y4=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new NP,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&oee(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],l=[],u=o.Rect;if(o.Rect&&(o.Rect=see(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=bt.createDefaultAppearanceStream(o),Ar(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=aee(o);l.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var f="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(f+="/"+p+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var i in h)if(h.hasOwnProperty(i)){var m=h[i];typeof m=="function"&&(m=m.call(s,o)),f+="/"+i+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,o)),f+="/"+i+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);f+=">>"}l.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:l,objectId:o.objId}),s.internal.out("endobj")}a&&function(g,y){for(var x in g)if(g.hasOwnProperty(x)){var w=x,b=g[x];y.internal.newObjectDeferredBegin(b.objId,!0),Ar(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete g[w]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},wP=cn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var s="[",a=0;a<e.length;a++)switch(a!==0&&(s+=" "),Ar(e[a])){case"boolean":case"number":case"object":s+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+nd(n(e[a].toString()))+")"):s+=e[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},$v=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+nd(n(e))+")"},po=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};po.prototype.toString=function(){return this.objId+" 0 R"},po.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},po.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:wP(s,this.objId,this.scope)}):s instanceof po?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var bP=function(){po.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};xa(bP,po);var NP=function(){po.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+nd(r(e))+")"}},set:function(r){e=r}})};xa(NP,po);var Hi=function e(){po.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bn(t,3)},set:function(x){x?this.F=Nn(t,3):this.F=Sn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof X1)return;a="FieldObject"+e.FieldNum++}var x=function(w){return w};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+nd(x(a))+")"},set:function(x){a=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(x){a=x}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(x){i=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/y4:u},set:function(x){u=x}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(x){d=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof X1||this instanceof Tu))return $v(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ts==0?$v(p,this.objId,this.scope):p},set:function(x){x=x.toString(),p=this instanceof ts==0?x.substr(0,1)==="("?Sd(x.substr(1,x.length-2)):Sd(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ts==1?Sd(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof ts==1?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ts==0?$v(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof ts==0?x.substr(0,1)==="("?Sd(x.substr(1,x.length-2)):Sd(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ts==1?Sd(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof ts==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(x){m=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,1)},set:function(x){x?this.Ff=Nn(this.Ff,1):this.Ff=Sn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,2)},set:function(x){x?this.Ff=Nn(this.Ff,2):this.Ff=Sn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,3)},set:function(x){x?this.Ff=Nn(this.Ff,3):this.Ff=Sn(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');y=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(y){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};xa(Hi,po);var lf=function(){Hi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return wP(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,i,o){o||(o=1);for(var l,u=[];l=i.exec(a);)u.push(l[o]);return u}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,18)},set:function(r){r?this.Ff=Nn(this.Ff,18):this.Ff=Sn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Nn(this.Ff,19):this.Ff=Sn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,20)},set:function(r){r?(this.Ff=Nn(this.Ff,20),t.sort()):this.Ff=Sn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,22)},set:function(r){r?this.Ff=Nn(this.Ff,22):this.Ff=Sn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(r){r?this.Ff=Nn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,27)},set:function(r){r?this.Ff=Nn(this.Ff,27):this.Ff=Sn(this.Ff,27)}}),this.hasAppearanceStream=!1};xa(lf,Hi);var cf=function(){lf.call(this),this.fontName="helvetica",this.combo=!1};xa(cf,lf);var uf=function(){cf.call(this),this.combo=!0};xa(uf,cf);var qg=function(){uf.call(this),this.edit=!0};xa(qg,uf);var ts=function(){Hi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,15)},set:function(r){r?this.Ff=Nn(this.Ff,15):this.Ff=Sn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,16)},set:function(r){r?this.Ff=Nn(this.Ff,16):this.Ff=Sn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,17)},set:function(r){r?this.Ff=Nn(this.Ff,17):this.Ff=Sn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(r){r?this.Ff=Nn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+nd(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){Ar(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};xa(ts,Hi);var Wg=function(){ts.call(this),this.pushButton=!0};xa(Wg,ts);var df=function(){ts.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};xa(df,ts);var X1=function(){var e,t;Hi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+nd(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){Ar(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=bt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};xa(X1,Hi),df.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},df.prototype.createOption=function(e){var t=new X1;return t.Parent=this,t.optionName=e,this.Kids.push(t),cee.call(this.scope,t),t};var Vg=function(){ts.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=bt.CheckBox.createAppearanceStream()};xa(Vg,ts);var Tu=function(){Hi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,13)},set:function(t){t?this.Ff=Nn(this.Ff,13):this.Ff=Sn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,21)},set:function(t){t?this.Ff=Nn(this.Ff,21):this.Ff=Sn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(t){t?this.Ff=Nn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,24)},set:function(t){t?this.Ff=Nn(this.Ff,24):this.Ff=Sn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,25)},set:function(t){t?this.Ff=Nn(this.Ff,25):this.Ff=Sn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(t){t?this.Ff=Nn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};xa(Tu,Hi);var Kg=function(){Tu.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,14)},set:function(e){e?this.Ff=Nn(this.Ff,14):this.Ff=Sn(this.Ff,14)}}),this.password=!0};xa(Kg,Tu);var bt={CheckBox:{createAppearanceStream:function(){return{N:{On:bt.CheckBox.YesNormal},D:{On:bt.CheckBox.YesPushDown,Off:bt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=so(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),a=a5(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Yt(bt.internal.getWidth(e))+" "+Yt(bt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Yt(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=so(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],a=bt.internal.getHeight(e),i=bt.internal.getWidth(e),o=a5(e,e.caption);return s.push("1 g"),s.push("0 0 "+Yt(i)+" "+Yt(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Yt(i-1)+" "+Yt(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Yt(o.fontSize)+" Tf "+n),s.push(o.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=so(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Yt(bt.internal.getWidth(e))+" "+Yt(bt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:bt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=bt.RadioButton.Circle.YesNormal,t.D[e]=bt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=so(e);t.scope=e.scope;var r=[],n=bt.internal.getWidth(e)<=bt.internal.getHeight(e)?bt.internal.getWidth(e)/4:bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=bt.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Wl(bt.internal.getWidth(e)/2)+" "+Wl(bt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=so(e);t.scope=e.scope;var r=[],n=bt.internal.getWidth(e)<=bt.internal.getHeight(e)?bt.internal.getWidth(e)/4:bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*bt.internal.Bezier_C).toFixed(5)),i=Number((n*bt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Wl(bt.internal.getWidth(e)/2)+" "+Wl(bt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Wl(bt.internal.getWidth(e)/2)+" "+Wl(bt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=so(e);t.scope=e.scope;var r=[],n=bt.internal.getWidth(e)<=bt.internal.getHeight(e)?bt.internal.getWidth(e)/4:bt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*bt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Wl(bt.internal.getWidth(e)/2)+" "+Wl(bt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:bt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=bt.RadioButton.Cross.YesNormal,t.D[e]=bt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=so(e);t.scope=e.scope;var r=[],n=bt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Yt(bt.internal.getWidth(e)-2)+" "+Yt(bt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Yt(n.x1.x)+" "+Yt(n.x1.y)+" m"),r.push(Yt(n.x2.x)+" "+Yt(n.x2.y)+" l"),r.push(Yt(n.x4.x)+" "+Yt(n.x4.y)+" m"),r.push(Yt(n.x3.x)+" "+Yt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=so(e);t.scope=e.scope;var r=bt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Yt(bt.internal.getWidth(e))+" "+Yt(bt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Yt(bt.internal.getWidth(e)-2)+" "+Yt(bt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Yt(r.x1.x)+" "+Yt(r.x1.y)+" m"),n.push(Yt(r.x2.x)+" "+Yt(r.x2.y)+" l"),n.push(Yt(r.x4.x)+" "+Yt(r.x4.y)+" m"),n.push(Yt(r.x3.x)+" "+Yt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=so(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Yt(bt.internal.getWidth(e))+" "+Yt(bt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};bt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=bt.internal.getWidth(e),r=bt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},bt.internal.getWidth=function(e){var t=0;return Ar(e)==="object"&&(t=M_(e.Rect[2])),t},bt.internal.getHeight=function(e){var t=0;return Ar(e)==="object"&&(t=M_(e.Rect[3])),t};var cee=cn.addField=function(e){if(lee(this,e),!(e instanceof Hi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};cn.AcroFormChoiceField=lf,cn.AcroFormListBox=cf,cn.AcroFormComboBox=uf,cn.AcroFormEditBox=qg,cn.AcroFormButton=ts,cn.AcroFormPushButton=Wg,cn.AcroFormRadioButton=df,cn.AcroFormCheckBox=Vg,cn.AcroFormTextField=Tu,cn.AcroFormPasswordField=Kg,cn.AcroFormAppearance=bt,cn.AcroForm={ChoiceField:lf,ListBox:cf,ComboBox:uf,EditBox:qg,Button:ts,PushButton:Wg,RadioButton:df,CheckBox:Vg,TextField:Tu,PasswordField:Kg,Appearance:bt},jt.AcroForm={ChoiceField:lf,ListBox:cf,ComboBox:uf,EditBox:qg,Button:ts,PushButton:Wg,RadioButton:df,CheckBox:Vg,TextField:Tu,PasswordField:Kg,Appearance:bt};jt.AcroForm;function SP(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(_,L){var M,K,Z,ae,he,re=r;if((L=L||r)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(P(_))for(he in n)for(Z=n[he],M=0;M<Z.length;M+=1){for(ae=!0,K=0;K<Z[M].length;K+=1)if(Z[M][K]!==void 0&&Z[M][K]!==_[K]){ae=!1;break}if(ae===!0){re=he;break}}else for(he in n)for(Z=n[he],M=0;M<Z.length;M+=1){for(ae=!0,K=0;K<Z[M].length;K+=1)if(Z[M][K]!==void 0&&Z[M][K]!==_.charCodeAt(K)){ae=!1;break}if(ae===!0){re=he;break}}return re===r&&L!==r&&(re=L),re},a=function _(L){for(var M=this.internal.write,K=this.internal.putStream,Z=(0,this.internal.getFilters)();Z.indexOf("FlateEncode")!==-1;)Z.splice(Z.indexOf("FlateEncode"),1);L.objectId=this.internal.newObject();var ae=[];if(ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Image"}),ae.push({key:"Width",value:L.width}),ae.push({key:"Height",value:L.height}),L.colorSpace===x.INDEXED?ae.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(L.palette.length/3-1)+" "+("sMask"in L&&L.sMask!==void 0?L.objectId+2:L.objectId+1)+" 0 R]"}):(ae.push({key:"ColorSpace",value:"/"+L.colorSpace}),L.colorSpace===x.DEVICE_CMYK&&ae.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ae.push({key:"BitsPerComponent",value:L.bitsPerComponent}),"decodeParameters"in L&&L.decodeParameters!==void 0&&ae.push({key:"DecodeParms",value:"<<"+L.decodeParameters+">>"}),"transparency"in L&&Array.isArray(L.transparency)&&L.transparency.length>0){for(var he="",re=0,U=L.transparency.length;re<U;re++)he+=L.transparency[re]+" "+L.transparency[re]+" ";ae.push({key:"Mask",value:"["+he+"]"})}L.sMask!==void 0&&ae.push({key:"SMask",value:L.objectId+1+" 0 R"});var ue=L.filter!==void 0?["/"+L.filter]:void 0;if(K({data:L.data,additionalKeyValues:ae,alreadyAppliedFilters:ue,objectId:L.objectId}),M("endobj"),"sMask"in L&&L.sMask!==void 0){var pe,C=(pe=L.sMaskBitsPerComponent)!==null&&pe!==void 0?pe:L.bitsPerComponent,R={width:L.width,height:L.height,colorSpace:"DeviceGray",bitsPerComponent:C,data:L.sMask};"filter"in L&&(R.decodeParameters="/Predictor ".concat(L.predictor," /Colors 1 /BitsPerComponent ").concat(C," /Columns ").concat(L.width),R.filter=L.filter),_.call(this,R)}if(L.colorSpace===x.INDEXED){var B=this.internal.newObject();K({data:D(new Uint8Array(L.palette)),objectId:B}),M("endobj")}},i=function(){var _=this.internal.collections[t+"images"];for(var L in _)a.call(this,_[L])},o=function(){var _,L=this.internal.collections[t+"images"],M=this.internal.write;for(var K in L)M("/I"+(_=L[K]).index,_.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var _=this.internal.collections[t+"images"];return l.call(this),_},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(_){return typeof e["process"+_.toUpperCase()]=="function"},p=function(_){return Ar(_)==="object"&&_.nodeType===1},h=function(_,L){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var M=""+_.getAttribute("src");if(M.indexOf("data:image/")===0)return Hg(unescape(M).split("base64,").pop());var K=e.loadFile(M,!0);if(K!==void 0)return K}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var Z;switch(L){case"PNG":Z="image/png";break;case"WEBP":Z="image/webp";break;default:Z="image/jpeg"}return Hg(_.toDataURL(Z,1).split("base64,").pop())}},m=function(_){var L=this.internal.collections[t+"images"];if(L){for(var M in L)if(_===L[M].alias)return L[M]}},g=function(_,L,M){return _||L||(_=-96,L=-96),_<0&&(_=-1*M.width*72/_/this.internal.scaleFactor),L<0&&(L=-1*M.height*72/L/this.internal.scaleFactor),_===0&&(_=L*M.width/M.height),L===0&&(L=_*M.height/M.width),[_,L]},y=function(_,L,M,K,Z,ae){var he=g.call(this,M,K,Z),re=this.internal.getCoordinateString,U=this.internal.getVerticalCoordinateString,ue=u.call(this);if(M=he[0],K=he[1],ue[Z.index]=Z,ae){ae*=Math.PI/180;var pe=Math.cos(ae),C=Math.sin(ae),R=function(O){return O.toFixed(4)},B=[R(pe),R(C),R(-1*C),R(pe),0,0,"cm"]}this.internal.write("q"),ae?(this.internal.write([1,"0","0",1,re(_),U(L+K),"cm"].join(" ")),this.internal.write(B.join(" ")),this.internal.write([re(M),"0","0",re(K),"0","0","cm"].join(" "))):this.internal.write([re(M),"0","0",re(K),re(_),U(L+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Z.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(_){var L,M,K=0;if(typeof _=="string")for(M=_.length,L=0;L<M;L++)K=(K<<5)-K+_.charCodeAt(L),K|=0;else if(P(_))for(M=_.byteLength/2,L=0;L<M;L++)K=(K<<5)-K+_[L],K|=0;return K},N=e.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var L=!0;return _.length===0&&(L=!1),_.length%4!=0&&(L=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(L=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(L=!1),L},A=e.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var L=_.indexOf(",");return L<0?null:_.substring(0,L).trim().endsWith("base64")?_.substring(L+1):null};e.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var P=e.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},j=e.__addimage__.binaryStringToUint8Array=function(_){for(var L=_.length,M=new Uint8Array(L),K=0;K<L;K++)M[K]=_.charCodeAt(K);return M},D=e.__addimage__.arrayBufferToBinaryString=function(_){for(var L="",M=P(_)?_:new Uint8Array(_),K=0;K<M.length;K+=8192)L+=String.fromCharCode.apply(null,M.subarray(K,K+8192));return L};e.addImage=function(){var _,L,M,K,Z,ae,he,re,U;if(typeof arguments[1]=="number"?(L=r,M=arguments[1],K=arguments[2],Z=arguments[3],ae=arguments[4],he=arguments[5],re=arguments[6],U=arguments[7]):(L=arguments[1],M=arguments[2],K=arguments[3],Z=arguments[4],ae=arguments[5],he=arguments[6],re=arguments[7],U=arguments[8]),Ar(_=arguments[0])==="object"&&!p(_)&&"imageData"in _){var ue=_;_=ue.imageData,L=ue.format||L||r,M=ue.x||M||0,K=ue.y||K||0,Z=ue.w||ue.width||Z,ae=ue.h||ue.height||ae,he=ue.alias||he,re=ue.compression||re,U=ue.rotation||ue.angle||U}var pe=this.internal.getFilters();if(re===void 0&&pe.indexOf("FlateEncode")!==-1&&(re="SLOW"),isNaN(M)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var C=E.call(this,_,L,he,re);return y.call(this,M,K,Z,ae,C,U),this};var E=function(_,L,M,K){var Z,ae,he;if(typeof _=="string"&&s(_)===r){_=unescape(_);var re=I(_,!1);(re!==""||(re=e.loadFile(_,!0))!==void 0)&&(_=re)}if(p(_)&&(_=h(_,L)),L=s(_,L),!f(L))throw new Error("addImage does not support files of type '"+L+"', please ensure that a plugin for '"+L+"' support is added.");if(((he=M)==null||he.length===0)&&(M=function(U){return typeof U=="string"||P(U)?b(U):P(U.data)?b(U.data):null}(_)),(Z=m.call(this,M))||(_ instanceof Uint8Array||L==="RGBA"||(ae=_,_=j(_)),Z=this["process"+L.toUpperCase()](_,d.call(this),M,function(U){return U&&typeof U=="string"&&(U=U.toUpperCase()),U in e.image_compression?U:w.NONE}(K),ae)),!Z)throw new Error("An unknown error occurred whilst processing the image.");return Z},I=e.__addimage__.convertBase64ToBinaryString=function(_,L){L=typeof L!="boolean"||L;var M,K="";if(typeof _=="string"){var Z;M=(Z=A(_))!==null&&Z!==void 0?Z:_;try{K=Hg(M)}catch(ae){if(L)throw N(M)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ae.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return K};e.getImageProperties=function(_){var L,M,K="";if(p(_)&&(_=h(_)),typeof _=="string"&&s(_)===r&&((K=I(_,!1))===""&&(K=e.loadFile(_)||""),_=K),M=s(_),!f(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(_ instanceof Uint8Array||(_=j(_)),!(L=this["process"+M.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return L.fileType=M,L}})(jt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};jt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((n=u[f]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),w=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(x(n.contents))+")",a+=" /Popup "+y.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+h(x(w))+") >>",g.content=a;var b=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",y.content=a,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var N=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var A=this.annotations._nameMap[n.options.name];n.options.pageNumber=A.page,n.options.top=A.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var P=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+P+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,a,i){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:u(n),w:l(r+s),h:u(n+a)},options:i,type:"link"})},e.textWithLink=function(r,n,s,a){var i,o,l=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var d=this.splitTextToSize(r,o).length;i=Math.ceil(u*d)}else o=l,i=u;return this.text(r,n,s,a),s+=.2*u,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,s-u,o,i,a),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(jt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(g){var y=0,x=r,w="",b=0;for(y=0;y<g.length;y+=1)x[g.charCodeAt(y)]!==void 0?(b++,typeof(x=x[g.charCodeAt(y)])=="number"&&(w+=String.fromCharCode(x),x=r,b=0),y===g.length-1&&(x=r,w+=g.charAt(y-(b-1)),y-=b-1,b=0)):(x=r,w+=g.charAt(y-b),y-=b,b=0);return w};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,y,x){return i(g)?a(g)===!1?-1:!u(g)||!i(y)&&!i(x)||!i(x)&&o(y)||o(g)&&!i(y)||o(g)&&l(y)||o(g)&&o(y)?0:d(g)&&i(y)&&!o(y)&&i(x)&&u(x)?3:o(g)||!i(x)?1:2:-1},h=function(g){var y=0,x=0,w=0,b="",N="",A="",P=(g=g||"").split("\\s+"),j=[];for(y=0;y<P.length;y+=1){for(j.push(""),x=0;x<P[y].length;x+=1)b=P[y][x],N=P[y][x-1],A=P[y][x+1],i(b)?(w=p(b,N,A),j[y]+=w!==-1?String.fromCharCode(t[b.charCodeAt(0)][w]):b):j[y]+=b;j[y]=f(j[y])}return j.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(y)){var w=0;for(x=[],w=0;w<y.length;w+=1)Array.isArray(y[w])?x.push([h(y[w][0]),y[w][1],y[w][2]]):x.push([h(y[w])]);g=x}else g=h(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(jt.API),jt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(jt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,u){n.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,m=0,g=0,y=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=u.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(b,N){return b.concat(y.splitTextToSize(N,x))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)h<(g=this.getStringUnitWidth(l[w],{font:f})*d)&&(h=g);return h!==0&&(m=l.length),{w:h/=p,h:Math.max((m*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=f.top,h&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-d,l.y+d,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+d,{align:"center",baseline:"top",maxWidth:l.width-d-d}):this.text(l.text,l.x+d,l.y+d,{align:"left",baseline:"top",maxWidth:l.width-d-d})),this.internal.__cell__.lastCell=l,this};e.table=function(l,u,d,f,p){if(n.call(this),!d)throw new Error("No data for PDF table.");var h,m,g,y,x=[],w=[],b=[],N={},A={},P=[],j=[],D=(p=p||{}).autoSize||!1,E=p.printHeaders!==!1,I=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,_=p.margins||Object.assign({width:this.getPageWidth()},t),L=typeof p.padding=="number"?p.padding:3,M=p.headerBackgroundColor||"#c8c8c8",K=p.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=E,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=I,this.internal.__cell__.padding=L,this.internal.__cell__.headerBackgroundColor=M,this.internal.__cell__.headerTextColor=K,this.setFontSize(I),f==null)w=x=Object.keys(d[0]),b=x.map(function(){return"left"});else if(Array.isArray(f)&&Ar(f[0])==="object")for(x=f.map(function(ue){return ue.name}),w=f.map(function(ue){return ue.prompt||ue.name||""}),b=f.map(function(ue){return ue.align||"left"}),h=0;h<f.length;h+=1)A[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(w=x=f,b=x.map(function(){return"left"}));if(D||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(N[y=x[h]]=d.map(function(ue){return ue[y]}),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=N[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)P.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);A[y]=Math.max.apply(null,P)+L+L,P=[]}if(E){var Z={};for(h=0;h<x.length;h+=1)Z[x[h]]={},Z[x[h]].text=w[h],Z[x[h]].align=b[h];var ae=o.call(this,Z,A);j=x.map(function(ue){return new a(l,u,A[ue],ae,Z[ue].text,void 0,Z[ue].align)}),this.setTableHeaderRow(j),this.printHeaderRow(1,!1)}var he=f.reduce(function(ue,pe){return ue[pe.name]=pe.align,ue},{});for(h=0;h<d.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:d[h]},this);var re=o.call(this,d[h],A);for(g=0;g<x.length;g+=1){var U=d[h][x[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:U},this),i.call(this,new a(l,u,A[x[g]],re,U,h+2,he[x[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var o=function(l,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(h){var m=l[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/p+d+d},this).reduce(function(h,m){return Math.max(h,m)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,p.push(d)),d.lineNumber=l;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,d),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(jt.API);var kP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},_P=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],i5=SP(_P),EP=[100,200,300,400,500,600,700,800,900],uee=SP(EP);function zv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return kP[a=a||"normal"]?a:"normal"}(e.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(e.weight),s=function(a){return typeof i5[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function B_(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var dee={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},U_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function $_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function z_(e){return e.trimLeft()}function fee(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function hee(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var ug,H_,q_,kd,dg,W_,V_,K_,Hv=["times"];function G_(e,t,r,n,s){var a=4,i=X_;switch(s){case jt.API.image_compression.FAST:a=1,i=Y_;break;case jt.API.image_compression.MEDIUM:a=6,i=J_;break;case jt.API.image_compression.SLOW:a=9,i=Q_}e=function(l,u,d,f){for(var p,h=l.length/u,m=new Uint8Array(l.length+h),g=[pee,Y_,X_,J_,Q_],y=0;y<h;y+=1){var x=y*u,w=l.subarray(x,x+u);if(f)m.set(f(w,d,p),x+y);else{for(var b=g.length,N=[],A=0;A<b;A+=1)N[A]=g[A](w,d,p);var P=gee(N.concat());m.set(N[P],x+y)}p=w}return m}(e,t,Math.ceil(r*n/8),i);var o=Zw(e,{level:a});return jt.API.__addimage__.arrayBufferToBinaryString(o)}function pee(e){var t=Array.apply([],e);return t.unshift(0),t}function Y_(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=e[s-t]||0;n[s+1]=e[s]-a+256&255}return n}function X_(e,t,r){var n=e.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var i=r&&r[a]||0;s[a+1]=e[a]-i+256&255}return s}function J_(e,t,r){var n=e.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var i=e[a-t]||0,o=r&&r[a]||0;s[a+1]=e[a]+256-(i+o>>>1)&255}return s}function Q_(e,t,r){var n=e.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var i=mee(e[a-t]||0,r&&r[a]||0,r&&r[a-t]||0);s[a+1]=e[a]-i+256&255}return s}function mee(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),a=Math.abs(e+t-r-r);return n<=s&&n<=a?e:s<=a?t:r}function gee(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function qv(e,t,r){var n=t*r,s=Math.floor(n/8),a=16-(n-8*s+r),i=(1<<r)-1;return AP(e,s)>>a&i}function Z_(e,t,r,n){var s=r*n,a=Math.floor(s/8),i=16-(s-8*a+n),o=(1<<n)-1,l=(t&o)<<i;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var p=f>>8&255;u.setUint8(d,p)}})(e,a,AP(e,a)&~(o<<i)&65535|l)}function AP(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function xee(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],a=s>>7,i=1<<1+(7&s);e[t++],e[t++];var o=null,l=null;a&&(o=t,l=i,t+=3*i);var u=!0,d=[],f=0,p=null,h=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];f=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,N=e[t++],A=N>>6&1,P=1<<1+(7&N),j=o,D=l,E=!1;N>>7&&(E=!0,j=t,D=P,t+=3*P);var I=t;for(t++;;){var _;if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}d.push({x:y,y:x,width:w,height:b,has_local_palette:E,palette_offset:j,palette_size:D,data_offset:I,data_length:t-I,transparent_index:p,interlaced:!!A,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return m},this.frameInfo=function(L){if(L<0||L>=d.length)throw new Error("Frame index out of range.");return d[L]},this.decodeAndBlitFrameBGRA=function(L,M){var K=this.frameInfo(L),Z=K.width*K.height,ae=new Uint8Array(Z);eE(e,K.data_offset,ae,Z);var he=K.palette_offset,re=K.transparent_index;re===null&&(re=256);var U=K.width,ue=r-U,pe=U,C=4*(K.y*r+K.x),R=4*((K.y+K.height)*r+K.x),B=C,O=4*ue;K.interlaced===!0&&(O+=4*r*7);for(var Y=8,ie=0,me=ae.length;ie<me;++ie){var ge=ae[ie];if(pe===0&&(pe=U,(B+=O)>=R&&(O=4*ue+4*r*(Y-1),B=C+(U+ue)*(Y<<1),Y>>=1)),ge===re)B+=4;else{var xe=e[he+3*ge],Le=e[he+3*ge+1],z=e[he+3*ge+2];M[B++]=z,M[B++]=Le,M[B++]=xe,M[B++]=255}--pe}},this.decodeAndBlitFrameRGBA=function(L,M){var K=this.frameInfo(L),Z=K.width*K.height,ae=new Uint8Array(Z);eE(e,K.data_offset,ae,Z);var he=K.palette_offset,re=K.transparent_index;re===null&&(re=256);var U=K.width,ue=r-U,pe=U,C=4*(K.y*r+K.x),R=4*((K.y+K.height)*r+K.x),B=C,O=4*ue;K.interlaced===!0&&(O+=4*r*7);for(var Y=8,ie=0,me=ae.length;ie<me;++ie){var ge=ae[ie];if(pe===0&&(pe=U,(B+=O)>=R&&(O=4*ue+4*r*(Y-1),B=C+(U+ue)*(Y<<1),Y>>=1)),ge===re)B+=4;else{var xe=e[he+3*ge],Le=e[he+3*ge+1],z=e[he+3*ge+2];M[B++]=xe,M[B++]=Le,M[B++]=z,M[B++]=255}--pe}}}function eE(e,t,r,n){for(var s=e[t++],a=1<<s,i=a+1,o=i+1,l=s+1,u=(1<<l)-1,d=0,f=0,p=0,h=e[t++],m=new Int32Array(4096),g=null;;){for(;d<16&&h!==0;)f|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<l)break;var y=f&u;if(f>>=l,d-=l,y!==a){if(y===i)break;for(var x=y<o?y:g,w=0,b=x;b>a;)b=m[b]>>8,++w;var N=b;if(p+w+(x!==y?1:0)>n)return void Rr.log("Warning, gif stream longer than expected.");r[p++]=N;var A=p+=w;for(x!==y&&(r[p++]=N),b=x;w--;)b=m[b],r[--A]=255&b,b>>=8;g!==null&&o<4096&&(m[o++]=g<<8|N,o>=u+1&&l<12&&(++l,u=u<<1|1)),g=y}else o=i+1,u=(1<<(l=s+1))-1,g=null}return p!==n&&Rr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Wv(e){var t,r,n,s,a,i=Math.floor,o=new Array(64),l=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),p=new Array(65535),h=new Array(64),m=new Array(64),g=[],y=0,x=7,w=new Array(64),b=new Array(64),N=new Array(64),A=new Array(256),P=new Array(2048),j=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],D=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],L=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],M=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ae(C,R){for(var B=0,O=0,Y=new Array,ie=1;ie<=16;ie++){for(var me=1;me<=C[ie];me++)Y[R[O]]=[],Y[R[O]][0]=B,Y[R[O]][1]=ie,O++,B++;B*=2}return Y}function he(C){for(var R=C[0],B=C[1]-1;B>=0;)R&1<<B&&(y|=1<<x),B--,--x<0&&(y==255?(re(255),re(0)):re(y),x=7,y=0)}function re(C){g.push(C)}function U(C){re(C>>8&255),re(255&C)}function ue(C,R,B,O,Y){for(var ie,me=Y[0],ge=Y[240],xe=function(Ue,xt){var tt,gt,ct,Mt,It,Pt,Jt,Lt,pt,it,ot=0;for(pt=0;pt<8;++pt){tt=Ue[ot],gt=Ue[ot+1],ct=Ue[ot+2],Mt=Ue[ot+3],It=Ue[ot+4],Pt=Ue[ot+5],Jt=Ue[ot+6];var ir=tt+(Lt=Ue[ot+7]),Ft=tt-Lt,Ot=gt+Jt,qt=gt-Jt,Ne=ct+Pt,Ie=ct-Pt,Ge=Mt+It,He=Mt-It,Be=ir+Ge,$e=ir-Ge,ft=Ot+Ne,Ye=Ot-Ne;Ue[ot]=Be+ft,Ue[ot+4]=Be-ft;var Qe=.707106781*(Ye+$e);Ue[ot+2]=$e+Qe,Ue[ot+6]=$e-Qe;var zt=.382683433*((Be=He+Ie)-(Ye=qt+Ft)),Dt=.5411961*Be+zt,_n=1.306562965*Ye+zt,wr=.707106781*(ft=Ie+qt),Et=Ft+wr,sr=Ft-wr;Ue[ot+5]=sr+Dt,Ue[ot+3]=sr-Dt,Ue[ot+1]=Et+_n,Ue[ot+7]=Et-_n,ot+=8}for(ot=0,pt=0;pt<8;++pt){tt=Ue[ot],gt=Ue[ot+8],ct=Ue[ot+16],Mt=Ue[ot+24],It=Ue[ot+32],Pt=Ue[ot+40],Jt=Ue[ot+48];var va=tt+(Lt=Ue[ot+56]),pn=tt-Lt,Pr=gt+Jt,fr=gt-Jt,br=ct+Pt,W=ct-Pt,te=Mt+It,ee=Mt-It,se=va+te,oe=va-te,fe=Pr+br,_e=Pr-br;Ue[ot]=se+fe,Ue[ot+32]=se-fe;var De=.707106781*(_e+oe);Ue[ot+16]=oe+De,Ue[ot+48]=oe-De;var Ee=.382683433*((se=ee+W)-(_e=fr+pn)),Ae=.5411961*se+Ee,Te=1.306562965*_e+Ee,Ze=.707106781*(fe=W+fr),at=pn+Ze,ht=pn-Ze;Ue[ot+40]=ht+Ae,Ue[ot+24]=ht-Ae,Ue[ot+8]=at+Te,Ue[ot+56]=at-Te,ot++}for(pt=0;pt<64;++pt)it=Ue[pt]*xt[pt],h[pt]=it>0?it+.5|0:it-.5|0;return h}(C,R),Le=0;Le<64;++Le)m[j[Le]]=xe[Le];var z=m[0]-B;B=m[0],z==0?he(O[0]):(he(O[p[ie=32767+z]]),he(f[ie]));for(var Re=63;Re>0&&m[Re]==0;)Re--;if(Re==0)return he(me),B;for(var Fe,X=1;X<=Re;){for(var Oe=X;m[X]==0&&X<=Re;)++X;var Me=X-Oe;if(Me>=16){Fe=Me>>4;for(var st=1;st<=Fe;++st)he(ge);Me&=15}ie=32767+m[X],he(Y[(Me<<4)+p[ie]]),he(f[ie]),X++}return Re!=63&&he(me),B}function pe(C){C=Math.min(Math.max(C,1),100),a!=C&&(function(R){for(var B=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],O=0;O<64;O++){var Y=i((B[O]*R+50)/100);Y=Math.min(Math.max(Y,1),255),o[j[O]]=Y}for(var ie=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var ge=i((ie[me]*R+50)/100);ge=Math.min(Math.max(ge,1),255),l[j[me]]=ge}for(var xe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,z=0;z<8;z++)for(var Re=0;Re<8;Re++)u[Le]=1/(o[j[Le]]*xe[z]*xe[Re]*8),d[Le]=1/(l[j[Le]]*xe[z]*xe[Re]*8),Le++}(C<50?Math.floor(5e3/C):Math.floor(200-2*C)),a=C)}this.encode=function(C,R){R&&pe(R),g=new Array,y=0,x=7,U(65496),U(65504),U(16),re(74),re(70),re(73),re(70),re(0),re(1),re(1),re(0),U(1),U(1),re(0),re(0),function(){U(65499),U(132),re(0);for(var gt=0;gt<64;gt++)re(o[gt]);re(1);for(var ct=0;ct<64;ct++)re(l[ct])}(),function(gt,ct){U(65472),U(17),re(8),U(ct),U(gt),re(3),re(1),re(17),re(0),re(2),re(17),re(1),re(3),re(17),re(1)}(C.width,C.height),function(){U(65476),U(418),re(0);for(var gt=0;gt<16;gt++)re(D[gt+1]);for(var ct=0;ct<=11;ct++)re(E[ct]);re(16);for(var Mt=0;Mt<16;Mt++)re(I[Mt+1]);for(var It=0;It<=161;It++)re(_[It]);re(1);for(var Pt=0;Pt<16;Pt++)re(L[Pt+1]);for(var Jt=0;Jt<=11;Jt++)re(M[Jt]);re(17);for(var Lt=0;Lt<16;Lt++)re(K[Lt+1]);for(var pt=0;pt<=161;pt++)re(Z[pt])}(),U(65498),U(12),re(3),re(1),re(0),re(2),re(17),re(3),re(17),re(0),re(63),re(0);var B=0,O=0,Y=0;y=0,x=7,this.encode.displayName="_encode_";for(var ie,me,ge,xe,Le,z,Re,Fe,X,Oe=C.data,Me=C.width,st=C.height,Ue=4*Me,xt=0;xt<st;){for(ie=0;ie<Ue;){for(Le=Ue*xt+ie,Re=-1,Fe=0,X=0;X<64;X++)z=Le+(Fe=X>>3)*Ue+(Re=4*(7&X)),xt+Fe>=st&&(z-=Ue*(xt+1+Fe-st)),ie+Re>=Ue&&(z-=ie+Re-Ue+4),me=Oe[z++],ge=Oe[z++],xe=Oe[z++],w[X]=(P[me]+P[ge+256|0]+P[xe+512|0]>>16)-128,b[X]=(P[me+768|0]+P[ge+1024|0]+P[xe+1280|0]>>16)-128,N[X]=(P[me+1280|0]+P[ge+1536|0]+P[xe+1792|0]>>16)-128;B=ue(w,u,B,t,n),O=ue(b,d,O,r,s),Y=ue(N,d,Y,r,s),ie+=32}xt+=8}if(x>=0){var tt=[];tt[1]=x+1,tt[0]=(1<<x+1)-1,he(tt)}return U(65497),new Uint8Array(g)},e=e||50,function(){for(var C=String.fromCharCode,R=0;R<256;R++)A[R]=C(R)}(),t=ae(D,E),r=ae(L,M),n=ae(I,_),s=ae(K,Z),function(){for(var C=1,R=2,B=1;B<=15;B++){for(var O=C;O<R;O++)p[32767+O]=B,f[32767+O]=[],f[32767+O][1]=B,f[32767+O][0]=O;for(var Y=-(R-1);Y<=-C;Y++)p[32767+Y]=B,f[32767+Y]=[],f[32767+Y][1]=B,f[32767+Y][0]=R-1+Y;C<<=1,R<<=1}}(),function(){for(var C=0;C<256;C++)P[C]=19595*C,P[C+256|0]=38470*C,P[C+512|0]=7471*C+32768,P[C+768|0]=-11059*C,P[C+1024|0]=-21709*C,P[C+1280|0]=32768*C+8421375,P[C+1536|0]=-27439*C,P[C+1792|0]=-5329*C}(),pe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function yi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function tE(e){function t(E){if(!E)throw Error("assert :P")}function r(E,I,_){for(var L=0;4>L;L++)if(E[I+L]!=_.charCodeAt(L))return!0;return!1}function n(E,I,_,L,M){for(var K=0;K<M;K++)E[I+K]=_[L+K]}function s(E,I,_,L){for(var M=0;M<L;M++)E[I+M]=_}function a(E){return new Int32Array(E)}function i(E,I){for(var _=[],L=0;L<E;L++)_.push(new I);return _}function o(E,I){var _=[];return function L(M,K,Z){for(var ae=Z[K],he=0;he<ae&&(M.push(Z.length>K+1?[]:new I),!(Z.length<K+1));he++)L(M[he],K+1,Z)}(_,0,E),_}var l=function(){var E=this;function I(v,S){for(var T=1<<S-1>>>0;v&T;)T>>>=1;return T?(v&T-1)+T:v}function _(v,S,T,F,q){t(!(F%T));do v[S+(F-=T)]=q;while(0<F)}function L(v,S,T,F,q){if(t(2328>=q),512>=q)var V=a(512);else if((V=a(q))==null)return 0;return function(G,Q,ne,le,ye,Ce){var ce,we,ke=Q,ze=1<<ne,je=a(16),qe=a(16);for(t(ye!=0),t(le!=null),t(G!=null),t(0<ne),we=0;we<ye;++we){if(15<le[we])return 0;++je[le[we]]}if(je[0]==ye)return 0;for(qe[1]=0,ce=1;15>ce;++ce){if(je[ce]>1<<ce)return 0;qe[ce+1]=qe[ce]+je[ce]}for(we=0;we<ye;++we)ce=le[we],0<le[we]&&(Ce[qe[ce]++]=we);if(qe[15]==1)return(le=new M).g=0,le.value=Ce[0],_(G,ke,1,ze,le),ze;var Ke,et=-1,Je=ze-1,Ct=0,wt=1,rr=1,kt=1<<ne;for(we=0,ce=1,ye=2;ce<=ne;++ce,ye<<=1){if(wt+=rr<<=1,0>(rr-=je[ce]))return 0;for(;0<je[ce];--je[ce])(le=new M).g=ce,le.value=Ce[we++],_(G,ke+Ct,ye,kt,le),Ct=I(Ct,ce)}for(ce=ne+1,ye=2;15>=ce;++ce,ye<<=1){if(wt+=rr<<=1,0>(rr-=je[ce]))return 0;for(;0<je[ce];--je[ce]){if(le=new M,(Ct&Je)!=et){for(ke+=kt,Ke=1<<(et=ce)-ne;15>et&&!(0>=(Ke-=je[et]));)++et,Ke<<=1;ze+=kt=1<<(Ke=et-ne),G[Q+(et=Ct&Je)].g=Ke+ne,G[Q+et].value=ke-Q-et}le.g=ce-ne,le.value=Ce[we++],_(G,ke+(Ct>>ne),ye,kt,le),Ct=I(Ct,ce)}}return wt!=2*qe[15]-1?0:ze}(v,S,T,F,q,V)}function M(){this.value=this.g=0}function K(){this.value=this.g=0}function Z(){this.G=i(5,M),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Xc,K)}function ae(v,S,T,F){t(v!=null),t(S!=null),t(2147483648>F),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=S,v.pa=T,v.Jd=S,v.Yc=T+F,v.Zc=4<=F?T+F-4+1:T,me(v)}function he(v,S){for(var T=0;0<S--;)T|=xe(v,128)<<S;return T}function re(v,S){var T=he(v,S);return ge(v)?-T:T}function U(v,S,T,F){var q,V=0;for(t(v!=null),t(S!=null),t(4294967288>F),v.Sb=F,v.Ra=0,v.u=0,v.h=0,4<F&&(F=4),q=0;q<F;++q)V+=S[T+q]<<8*q;v.Ra=V,v.bb=F,v.oa=S,v.pa=T}function ue(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<Cl-8>>>0,++v.bb,v.u-=8;O(v)&&(v.h=1,v.u=0)}function pe(v,S){if(t(0<=S),!v.h&&S<=wa){var T=B(v)&ya[S];return v.u+=S,ue(v),T}return v.h=1,v.u=0}function C(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function B(v){return v.Ra>>>(v.u&Cl-1)>>>0}function O(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>Cl}function Y(v,S){v.u=S,v.h=O(v)}function ie(v){v.u>=Bo&&(t(v.u>=Bo),ue(v))}function me(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function ge(v){return he(v,1)}function xe(v,S){var T=v.Ca;0>v.b&&me(v);var F=v.b,q=T*S>>>8,V=(v.I>>>F>q)+0;for(V?(T-=q,v.I-=q+1<<F>>>0):T=q+1,F=T,q=0;256<=F;)q+=8,F>>=8;return F=7^q+Tl[F],v.b-=F,v.Ca=(T<<F)-1,V}function Le(v,S,T){v[S+0]=T>>24&255,v[S+1]=T>>16&255,v[S+2]=T>>8&255,v[S+3]=255&T}function z(v,S){return v[S+0]|v[S+1]<<8}function Re(v,S){return z(v,S)|v[S+2]<<16}function Fe(v,S){return z(v,S)|z(v,S+2)<<16}function X(v,S){var T=1<<S;return t(v!=null),t(0<S),v.X=a(T),v.X==null?0:(v.Mb=32-S,v.Xa=S,1)}function Oe(v,S){t(v!=null),t(S!=null),t(v.Xa==S.Xa),n(S.X,0,v.X,0,1<<S.Xa)}function Me(){this.X=[],this.Xa=this.Mb=0}function st(v,S,T,F){t(T!=null),t(F!=null);var q=T[0],V=F[0];return q==0&&(q=(v*V+S/2)/S),V==0&&(V=(S*q+v/2)/v),0>=q||0>=V?0:(T[0]=q,F[0]=V,1)}function Ue(v,S){return v+(1<<S)-1>>>S}function xt(v,S){return((4278255360&v)+(4278255360&S)>>>0&4278255360)+((16711935&v)+(16711935&S)>>>0&16711935)>>>0}function tt(v,S){E[S]=function(T,F,q,V,G,Q,ne){var le;for(le=0;le<G;++le){var ye=E[v](Q[ne+le-1],q,V+le);Q[ne+le]=xt(T[F+le],ye)}}}function gt(){this.ud=this.hd=this.jd=0}function ct(v,S){return((4278124286&(v^S))>>>1)+(v&S)>>>0}function Mt(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function It(v,S){return Mt(v+(v-S+.5>>1))}function Pt(v,S,T){return Math.abs(S-T)-Math.abs(v-T)}function Jt(v,S,T,F,q,V,G){for(F=V[G-1],T=0;T<q;++T)V[G+T]=F=xt(v[S+T],F)}function Lt(v,S,T,F,q){var V;for(V=0;V<T;++V){var G=v[S+V],Q=G>>8&255,ne=16711935&(ne=(ne=16711935&G)+((Q<<16)+Q));F[q+V]=(4278255360&G)+ne>>>0}}function pt(v,S){S.jd=255&v,S.hd=v>>8&255,S.ud=v>>16&255}function it(v,S,T,F,q,V){var G;for(G=0;G<F;++G){var Q=S[T+G],ne=Q>>>8,le=Q,ye=255&(ye=(ye=Q>>>16)+((v.jd<<24>>24)*(ne<<24>>24)>>>5));le=255&(le=(le+=(v.hd<<24>>24)*(ne<<24>>24)>>>5)+((v.ud<<24>>24)*(ye<<24>>24)>>>5)),q[V+G]=(4278255360&Q)+(ye<<16)+le}}function ot(v,S,T,F,q){E[S]=function(V,G,Q,ne,le,ye,Ce,ce,we){for(ne=Ce;ne<ce;++ne)for(Ce=0;Ce<we;++Ce)le[ye++]=q(Q[F(V[G++])])},E[v]=function(V,G,Q,ne,le,ye,Ce){var ce=8>>V.b,we=V.Ea,ke=V.K[0],ze=V.w;if(8>ce)for(V=(1<<V.b)-1,ze=(1<<ce)-1;G<Q;++G){var je,qe=0;for(je=0;je<we;++je)je&V||(qe=F(ne[le++])),ye[Ce++]=q(ke[qe&ze]),qe>>=ce}else E["VP8LMapColor"+T](ne,le,ke,ze,ye,Ce,G,Q,we)}}function ir(v,S,T,F,q){for(T=S+T;S<T;){var V=v[S++];F[q++]=V>>16&255,F[q++]=V>>8&255,F[q++]=255&V}}function Ft(v,S,T,F,q){for(T=S+T;S<T;){var V=v[S++];F[q++]=V>>16&255,F[q++]=V>>8&255,F[q++]=255&V,F[q++]=V>>24&255}}function Ot(v,S,T,F,q){for(T=S+T;S<T;){var V=(G=v[S++])>>16&240|G>>12&15,G=240&G|G>>28&15;F[q++]=V,F[q++]=G}}function qt(v,S,T,F,q){for(T=S+T;S<T;){var V=(G=v[S++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;F[q++]=V,F[q++]=G}}function Ne(v,S,T,F,q){for(T=S+T;S<T;){var V=v[S++];F[q++]=255&V,F[q++]=V>>8&255,F[q++]=V>>16&255}}function Ie(v,S,T,F,q,V){if(V==0)for(T=S+T;S<T;)Le(F,((V=v[S++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),q+=32;else n(F,q,v,S,T)}function Ge(v,S){E[S][0]=E[v+"0"],E[S][1]=E[v+"1"],E[S][2]=E[v+"2"],E[S][3]=E[v+"3"],E[S][4]=E[v+"4"],E[S][5]=E[v+"5"],E[S][6]=E[v+"6"],E[S][7]=E[v+"7"],E[S][8]=E[v+"8"],E[S][9]=E[v+"9"],E[S][10]=E[v+"10"],E[S][11]=E[v+"11"],E[S][12]=E[v+"12"],E[S][13]=E[v+"13"],E[S][14]=E[v+"0"],E[S][15]=E[v+"0"]}function He(v){return v==l2||v==c2||v==sm||v==u2}function Be(){this.eb=[],this.size=this.A=this.fb=0}function $e(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ft(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Be,this.f.kb=new $e,this.sd=null}function Ye(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Qe(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function zt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function Dt(v,S){var T=v.T,F=S.ba.f.RGBA,q=F.eb,V=F.fb+v.ka*F.A,G=Wa[S.ba.S],Q=v.y,ne=v.O,le=v.f,ye=v.N,Ce=v.ea,ce=v.W,we=S.cc,ke=S.dc,ze=S.Mc,je=S.Nc,qe=v.ka,Ke=v.ka+v.T,et=v.U,Je=et+1>>1;for(qe==0?G(Q,ne,null,null,le,ye,Ce,ce,le,ye,Ce,ce,q,V,null,null,et):(G(S.ec,S.fc,Q,ne,we,ke,ze,je,le,ye,Ce,ce,q,V-F.A,q,V,et),++T);qe+2<Ke;qe+=2)we=le,ke=ye,ze=Ce,je=ce,ye+=v.Rc,ce+=v.Rc,V+=2*F.A,G(Q,(ne+=2*v.fa)-v.fa,Q,ne,we,ke,ze,je,le,ye,Ce,ce,q,V-F.A,q,V,et);return ne+=v.fa,v.j+Ke<v.o?(n(S.ec,S.fc,Q,ne,et),n(S.cc,S.dc,le,ye,Je),n(S.Mc,S.Nc,Ce,ce,Je),T--):1&Ke||G(Q,ne,null,null,le,ye,Ce,ce,le,ye,Ce,ce,q,V+F.A,null,null,et),T}function _n(v,S,T){var F=v.F,q=[v.J];if(F!=null){var V=v.U,G=S.ba.S,Q=G==nm||G==sm;S=S.ba.f.RGBA;var ne=[0],le=v.ka;ne[0]=v.T,v.Kb&&(le==0?--ne[0]:(--le,q[0]-=v.width),v.j+v.ka+v.T==v.o&&(ne[0]=v.o-v.j-le));var ye=S.eb;le=S.fb+le*S.A,v=A4(F,q[0],v.width,V,ne,ye,le+(Q?0:3),S.A),t(T==ne),v&&He(G)&&hh(ye,le,Q,V,ne,S.A)}return 0}function wr(v){var S=v.ma,T=S.ba.S,F=11>T,q=T==tm||T==rm||T==nm||T==o2||T==12||He(T);if(S.memory=null,S.Ib=null,S.Jb=null,S.Nd=null,!ah(S.Oa,v,q?11:12))return 0;if(q&&He(T)&&rh(),v.da)alert("todo:use_scaling");else{if(F){if(S.Ib=zt,v.Kb){if(T=v.U+1>>1,S.memory=a(v.U+2*T),S.memory==null)return 0;S.ec=S.memory,S.fc=0,S.cc=S.ec,S.dc=S.fc+v.U,S.Mc=S.cc,S.Nc=S.dc+T,S.Ib=Dt,rh()}}else alert("todo:EmitYUV");q&&(S.Jb=_n,F&&fi())}if(F&&!H4){for(v=0;256>v;++v)fL[v]=89858*(v-128)+im>>am,mL[v]=-22014*(v-128)+im,pL[v]=-45773*(v-128),hL[v]=113618*(v-128)+im>>am;for(v=mh;v<h2;++v)S=76283*(v-16)+im>>am,gL[v-mh]=En(S,255),xL[v-mh]=En(S+8>>4,15);H4=1}return 1}function Et(v){var S=v.ma,T=v.U,F=v.T;return t(!(1&v.ka)),0>=T||0>=F?0:(T=S.Ib(v,S),S.Jb!=null&&S.Jb(v,S,T),S.Dc+=T,1)}function sr(v){v.ma.memory=null}function va(v,S,T,F){return pe(v,8)!=47?0:(S[0]=pe(v,14)+1,T[0]=pe(v,14)+1,F[0]=pe(v,1),pe(v,3)!=0?0:!v.h)}function pn(v,S){if(4>v)return v+1;var T=v-2>>1;return(2+(1&v)<<T)+pe(S,T)+1}function Pr(v,S){return 120<S?S-120:1<=(T=((T=QP[S-1])>>4)*v+(8-(15&T)))?T:1;var T}function fr(v,S,T){var F=B(T),q=v[S+=255&F].g-8;return 0<q&&(Y(T,T.u+8),F=B(T),S+=v[S].value,S+=F&(1<<q)-1),Y(T,T.u+v[S].g),v[S].value}function br(v,S,T){return T.g+=v.g,T.value+=v.value<<S>>>0,t(8>=T.g),v.g}function W(v,S,T){var F=v.xc;return t((S=F==0?0:v.vc[v.md*(T>>F)+(S>>F)])<v.Wb),v.Ya[S]}function te(v,S,T,F){var q=v.ab,V=v.c*S,G=v.C;S=G+S;var Q=T,ne=F;for(F=v.Ta,T=v.Ua;0<q--;){var le=v.gc[q],ye=G,Ce=S,ce=Q,we=ne,ke=(ne=F,Q=T,le.Ea);switch(t(ye<Ce),t(Ce<=le.nc),le.hc){case 2:mn(ce,we,(Ce-ye)*ke,ne,Q);break;case 0:var ze=ye,je=Ce,qe=ne,Ke=Q,et=(kt=le).Ea;ze==0&&(oh(ce,we,null,null,1,qe,Ke),Jt(ce,we+1,0,0,et-1,qe,Ke+1),we+=et,Ke+=et,++ze);for(var Je=1<<kt.b,Ct=Je-1,wt=Ue(et,kt.b),rr=kt.K,kt=kt.w+(ze>>kt.b)*wt;ze<je;){var lr=rr,$n=kt,nr=1;for(dd(ce,we,qe,Ke-et,1,qe,Ke);nr<et;){var _t=(nr&~Ct)+Je;_t>et&&(_t=et),(0,ch[lr[$n++]>>8&15])(ce,we+ +nr,qe,Ke+nr-et,_t-nr,qe,Ke+nr),nr=_t}we+=et,Ke+=et,++ze&Ct||(kt+=wt)}Ce!=le.nc&&n(ne,Q-ke,ne,Q+(Ce-ye-1)*ke,ke);break;case 1:for(ke=ce,je=we,et=(ce=le.Ea)-(Ke=ce&~(qe=(we=1<<le.b)-1)),ze=Ue(ce,le.b),Je=le.K,le=le.w+(ye>>le.b)*ze;ye<Ce;){for(Ct=Je,wt=le,rr=new gt,kt=je+Ke,lr=je+ce;je<kt;)pt(Ct[wt++],rr),uh(rr,ke,je,we,ne,Q),je+=we,Q+=we;je<lr&&(pt(Ct[wt++],rr),uh(rr,ke,je,et,ne,Q),je+=et,Q+=et),++ye&qe||(le+=ze)}break;case 3:if(ce==ne&&we==Q&&0<le.b){for(je=ne,ce=ke=Q+(Ce-ye)*ke-(Ke=(Ce-ye)*Ue(le.Ea,le.b)),we=ne,qe=Q,ze=[],Ke=(et=Ke)-1;0<=Ke;--Ke)ze[Ke]=we[qe+Ke];for(Ke=et-1;0<=Ke;--Ke)je[ce+Ke]=ze[Ke];Jp(le,ye,Ce,ne,ke,ne,Q)}else Jp(le,ye,Ce,ce,we,ne,Q)}Q=F,ne=T}ne!=T&&n(F,T,Q,ne,V)}function ee(v,S){var T=v.V,F=v.Ba+v.c*v.C,q=S-v.C;if(t(S<=v.l.o),t(16>=q),0<q){var V=v.l,G=v.Ta,Q=v.Ua,ne=V.width;if(te(v,q,T,F),q=Q=[Q],t((T=v.C)<(F=S)),t(V.v<V.va),F>V.o&&(F=V.o),T<V.j){var le=V.j-T;T=V.j,q[0]+=le*ne}if(T>=F?T=0:(q[0]+=4*V.v,V.ka=T-V.j,V.U=V.va-V.v,V.T=F-T,T=1),T){if(Q=Q[0],11>(T=v.ca).S){var ye=T.f.RGBA,Ce=(F=T.S,q=V.U,V=V.T,le=ye.eb,ye.A),ce=V;for(ye=ye.fb+v.Ma*ye.A;0<ce--;){var we=G,ke=Q,ze=q,je=le,qe=ye;switch(F){case em:dh(we,ke,ze,je,qe);break;case tm:Pl(we,ke,ze,je,qe);break;case l2:Pl(we,ke,ze,je,qe),hh(je,qe,0,ze,1,0);break;case D4:Jc(we,ke,ze,je,qe);break;case rm:Ie(we,ke,ze,je,qe,1);break;case c2:Ie(we,ke,ze,je,qe,1),hh(je,qe,0,ze,1,0);break;case nm:Ie(we,ke,ze,je,qe,0);break;case sm:Ie(we,ke,ze,je,qe,0),hh(je,qe,1,ze,1,0);break;case o2:Ll(we,ke,ze,je,qe);break;case u2:Ll(we,ke,ze,je,qe),E4(je,qe,ze,1,0);break;case R4:Fl(we,ke,ze,je,qe);break;default:t(0)}Q+=ne,ye+=Ce}v.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=T.height)}}v.C=S,t(v.C<=v.i)}function se(v){var S;if(0<v.ua)return 0;for(S=0;S<v.Wb;++S){var T=v.Ya[S].G,F=v.Ya[S].H;if(0<T[1][F[1]+0].g||0<T[2][F[2]+0].g||0<T[3][F[3]+0].g)return 0}return 1}function oe(v,S,T,F,q,V){if(v.Z!=0){var G=v.qd,Q=v.rd;for(t(Il[v.Z]!=null);S<T;++S)Il[v.Z](G,Q,F,q,F,q,V),G=F,Q=q,q+=V;v.qd=G,v.rd=Q}}function fe(v,S){var T=v.l.ma,F=T.Z==0||T.Z==1?v.l.j:v.C;if(F=v.C<F?F:v.C,t(S<=v.l.o),S>F){var q=v.l.width,V=T.ca,G=T.tb+q*F,Q=v.V,ne=v.Ba+v.c*F,le=v.gc;t(v.ab==1),t(le[0].hc==3),Xi(le[0],F,S,Q,ne,V,G),oe(T,F,S,V,G,q)}v.C=v.Ma=S}function _e(v,S,T,F,q,V,G){var Q=v.$/F,ne=v.$%F,le=v.m,ye=v.s,Ce=T+v.$,ce=Ce;q=T+F*q;var we=T+F*V,ke=280+ye.ua,ze=v.Pb?Q:16777216,je=0<ye.ua?ye.Wa:null,qe=ye.wc,Ke=Ce<we?W(ye,ne,Q):null;t(v.C<V),t(we<=q);var et=!1;e:for(;;){for(;et||Ce<we;){var Je=0;if(Q>=ze){var Ct=Ce-T;t((ze=v).Pb),ze.wd=ze.m,ze.xd=Ct,0<ze.s.ua&&Oe(ze.s.Wa,ze.s.vb),ze=Q+eL}if(ne&qe||(Ke=W(ye,ne,Q)),t(Ke!=null),Ke.Qb&&(S[Ce]=Ke.qb,et=!0),!et)if(ie(le),Ke.jc){Je=le,Ct=S;var wt=Ce,rr=Ke.pd[B(Je)&Xc-1];t(Ke.jc),256>rr.g?(Y(Je,Je.u+rr.g),Ct[wt]=rr.value,Je=0):(Y(Je,Je.u+rr.g-256),t(256<=rr.value),Je=rr.value),Je==0&&(et=!0)}else Je=fr(Ke.G[0],Ke.H[0],le);if(le.h)break;if(et||256>Je){if(!et)if(Ke.nd)S[Ce]=(Ke.qb|Je<<8)>>>0;else{if(ie(le),et=fr(Ke.G[1],Ke.H[1],le),ie(le),Ct=fr(Ke.G[2],Ke.H[2],le),wt=fr(Ke.G[3],Ke.H[3],le),le.h)break;S[Ce]=(wt<<24|et<<16|Je<<8|Ct)>>>0}if(et=!1,++Ce,++ne>=F&&(ne=0,++Q,G!=null&&Q<=V&&!(Q%16)&&G(v,Q),je!=null))for(;ce<Ce;)Je=S[ce++],je.X[(506832829*Je&4294967295)>>>je.Mb]=Je}else if(280>Je){if(Je=pn(Je-256,le),Ct=fr(Ke.G[4],Ke.H[4],le),ie(le),Ct=Pr(F,Ct=pn(Ct,le)),le.h)break;if(Ce-T<Ct||q-Ce<Je)break e;for(wt=0;wt<Je;++wt)S[Ce+wt]=S[Ce+wt-Ct];for(Ce+=Je,ne+=Je;ne>=F;)ne-=F,++Q,G!=null&&Q<=V&&!(Q%16)&&G(v,Q);if(t(Ce<=q),ne&qe&&(Ke=W(ye,ne,Q)),je!=null)for(;ce<Ce;)Je=S[ce++],je.X[(506832829*Je&4294967295)>>>je.Mb]=Je}else{if(!(Je<ke))break e;for(et=Je-280,t(je!=null);ce<Ce;)Je=S[ce++],je.X[(506832829*Je&4294967295)>>>je.Mb]=Je;Je=Ce,t(!(et>>>(Ct=je).Xa)),S[Je]=Ct.X[et],et=!0}et||t(le.h==O(le))}if(v.Pb&&le.h&&Ce<q)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&Oe(v.s.vb,v.s.Wa);else{if(le.h)break e;G!=null&&G(v,Q>V?V:Q),v.a=0,v.$=Ce-T}return 1}return v.a=3,0}function De(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var S=v.Wa;S!=null&&(S.X=null),v.vb=null,t(v!=null)}function Ee(){var v=new Wt;return v==null?null:(v.a=0,v.xb=M4,Ge("Predictor","VP8LPredictors"),Ge("Predictor","VP8LPredictors_C"),Ge("PredictorAdd","VP8LPredictorsAdd"),Ge("PredictorAdd","VP8LPredictorsAdd_C"),mn=Lt,uh=it,dh=ir,Pl=Ft,Ll=Ot,Fl=qt,Jc=Ne,E.VP8LMapColor32b=Yi,E.VP8LMapColor8b=lh,v)}function Ae(v,S,T,F,q){var V=1,G=[v],Q=[S],ne=F.m,le=F.s,ye=null,Ce=0;e:for(;;){if(T)for(;V&&pe(ne,1);){var ce=G,we=Q,ke=F,ze=1,je=ke.m,qe=ke.gc[ke.ab],Ke=pe(je,2);if(ke.Oc&1<<Ke)V=0;else{switch(ke.Oc|=1<<Ke,qe.hc=Ke,qe.Ea=ce[0],qe.nc=we[0],qe.K=[null],++ke.ab,t(4>=ke.ab),Ke){case 0:case 1:qe.b=pe(je,3)+2,ze=Ae(Ue(qe.Ea,qe.b),Ue(qe.nc,qe.b),0,ke,qe.K),qe.K=qe.K[0];break;case 3:var et,Je=pe(je,8)+1,Ct=16<Je?0:4<Je?1:2<Je?2:3;if(ce[0]=Ue(qe.Ea,Ct),qe.b=Ct,et=ze=Ae(Je,1,0,ke,qe.K)){var wt,rr=Je,kt=qe,lr=1<<(8>>kt.b),$n=a(lr);if($n==null)et=0;else{var nr=kt.K[0],_t=kt.w;for($n[0]=kt.K[0][0],wt=1;wt<1*rr;++wt)$n[wt]=xt(nr[_t+wt],$n[wt-1]);for(;wt<4*lr;++wt)$n[wt]=0;kt.K[0]=null,kt.K[0]=$n,et=1}}ze=et;break;case 2:break;default:t(0)}V=ze}}if(G=G[0],Q=Q[0],V&&pe(ne,1)&&!(V=1<=(Ce=pe(ne,4))&&11>=Ce)){F.a=3;break e}var lt;if(lt=V)t:{var xn,Qt,hr,Hr=F,os=G,qs=Q,sn=Ce,Ns=T,Ws=Hr.m,zn=Hr.s,xr=[null],Sr=1,an=0,kr=ZP[sn];r:for(;;){if(Ns&&pe(Ws,1)){var ls=pe(Ws,3)+2,pi=Ue(os,ls),vn=Ue(qs,ls),oa=pi*vn;if(!Ae(pi,vn,0,Hr,xr))break r;for(xr=xr[0],zn.xc=ls,xn=0;xn<oa;++xn){var Fr=xr[xn]>>8&65535;xr[xn]=Fr,Fr>=Sr&&(Sr=Fr+1)}}if(Ws.h)break r;for(Qt=0;5>Qt;++Qt){var Hn=I4[Qt];!Qt&&0<sn&&(Hn+=1<<sn),an<Hn&&(an=Hn)}var Na=i(Sr*kr,M),Vs=Sr,Sa=i(Vs,Z);if(Sa==null)var ka=null;else t(65536>=Vs),ka=Sa;var la=a(an);if(ka==null||la==null||Na==null){Hr.a=1;break r}var _a=Na;for(xn=hr=0;xn<Sr;++xn){var Mr=ka[xn],Ea=Mr.G,mi=Mr.H,Zc=0,zo=1,cs=0;for(Qt=0;5>Qt;++Qt){Hn=I4[Qt],Ea[Qt]=_a,mi[Qt]=hr,!Qt&&0<sn&&(Hn+=1<<sn);s:{var lm,p2=Hn,cm=Hr,gh=la,wL=_a,bL=hr,m2=0,Ol=cm.m,NL=pe(Ol,1);if(s(gh,0,0,p2),NL){var SL=pe(Ol,1)+1,kL=pe(Ol,1),V4=pe(Ol,kL==0?1:8);gh[V4]=1,SL==2&&(gh[V4=pe(Ol,8)]=1);var um=1}else{var K4=a(19),G4=pe(Ol,4)+4;if(19<G4){cm.a=3;var dm=0;break s}for(lm=0;lm<G4;++lm)K4[JP[lm]]=pe(Ol,3);var g2=void 0,xh=void 0,Y4=cm,_L=K4,fm=p2,X4=gh,x2=0,Ml=Y4.m,J4=8,Q4=i(128,M);n:for(;L(Q4,0,7,_L,19);){if(pe(Ml,1)){var EL=2+2*pe(Ml,3);if((g2=2+pe(Ml,EL))>fm)break n}else g2=fm;for(xh=0;xh<fm&&g2--;){ie(Ml);var Z4=Q4[0+(127&B(Ml))];Y(Ml,Ml.u+Z4.g);var hd=Z4.value;if(16>hd)X4[xh++]=hd,hd!=0&&(J4=hd);else{var AL=hd==16,e3=hd-16,jL=YP[e3],t3=pe(Ml,GP[e3])+jL;if(xh+t3>fm)break n;for(var CL=AL?J4:0;0<t3--;)X4[xh++]=CL}}x2=1;break n}x2||(Y4.a=3),um=x2}(um=um&&!Ol.h)&&(m2=L(wL,bL,8,gh,p2)),um&&m2!=0?dm=m2:(cm.a=3,dm=0)}if(dm==0)break r;if(zo&&XP[Qt]==1&&(zo=_a[hr].g==0),Zc+=_a[hr].g,hr+=dm,3>=Qt){var vh,v2=la[0];for(vh=1;vh<Hn;++vh)la[vh]>v2&&(v2=la[vh]);cs+=v2}}if(Mr.nd=zo,Mr.Qb=0,zo&&(Mr.qb=(Ea[3][mi[3]+0].value<<24|Ea[1][mi[1]+0].value<<16|Ea[2][mi[2]+0].value)>>>0,Zc==0&&256>Ea[0][mi[0]+0].value&&(Mr.Qb=1,Mr.qb+=Ea[0][mi[0]+0].value<<8)),Mr.jc=!Mr.Qb&&6>cs,Mr.jc){var hm,Ho=Mr;for(hm=0;hm<Xc;++hm){var Bl=hm,Ul=Ho.pd[Bl],pm=Ho.G[0][Ho.H[0]+Bl];256<=pm.value?(Ul.g=pm.g+256,Ul.value=pm.value):(Ul.g=0,Ul.value=0,Bl>>=br(pm,8,Ul),Bl>>=br(Ho.G[1][Ho.H[1]+Bl],16,Ul),Bl>>=br(Ho.G[2][Ho.H[2]+Bl],0,Ul),br(Ho.G[3][Ho.H[3]+Bl],24,Ul))}}}zn.vc=xr,zn.Wb=Sr,zn.Ya=ka,zn.yc=Na,lt=1;break t}lt=0}if(!(V=lt)){F.a=3;break e}if(0<Ce){if(le.ua=1<<Ce,!X(le.Wa,Ce)){F.a=1,V=0;break e}}else le.ua=0;var y2=F,r3=G,TL=Q,w2=y2.s,b2=w2.xc;if(y2.c=r3,y2.i=TL,w2.md=Ue(r3,b2),w2.wc=b2==0?-1:(1<<b2)-1,T){F.xb=oL;break e}if((ye=a(G*Q))==null){F.a=1,V=0;break e}V=(V=_e(F,ye,0,G,Q,Q,null))&&!ne.h;break e}return V?(q!=null?q[0]=ye:(t(ye==null),t(T)),F.$=0,T||De(le)):De(le),V}function Te(v,S){var T=v.c*v.i,F=T+S+16*S;return t(v.c<=S),v.V=a(F),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+T+S,1)}function Ze(v,S){var T=v.C,F=S-T,q=v.V,V=v.Ba+v.c*T;for(t(S<=v.l.o);0<F;){var G=16<F?16:F,Q=v.l.ma,ne=v.l.width,le=ne*G,ye=Q.ca,Ce=Q.tb+ne*T,ce=v.Ta,we=v.Ua;te(v,G,q,V),j4(ce,we,ye,Ce,le),oe(Q,T,T+G,ye,Ce,ne),F-=G,q+=G*v.c,T+=G}t(T==S),v.C=v.Ma=S}function at(){this.ub=this.yd=this.td=this.Rb=0}function ht(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function ut(){this.Yb=function(){var v=[];return function S(T,F,q){for(var V=q[F],G=0;G<V&&(T.push(q.length>F+1?[]:0),!(q.length<F+1));G++)S(T[G],F+1,q)}(v,0,[3,11]),v}()}function Bt(){this.jb=a(3),this.Wc=o([4,8],ut),this.Xc=o([4,17],ut)}function Cr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function or(){this.ld=this.La=this.dd=this.tc=0}function nn(){this.Na=this.la=0}function Wi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ui(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Vi(){this.uc=this.M=this.Nb=0,this.wa=Array(new or),this.Y=0,this.ya=Array(new ui),this.aa=0,this.l=new sd}function Ua(){this.y=a(16),this.f=a(8),this.ea=a(8)}function _l(){this.cb=this.a=0,this.sc="",this.m=new C,this.Od=new at,this.Kc=new ht,this.ed=new Cr,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new Vi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,C),this.ia=0,this.pb=i(4,Wi),this.Pa=new Bt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ua),this.Hd=0,this.rb=Array(new nn),this.sb=0,this.wa=Array(new or),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ui),this.L=this.aa=0,this.gd=o([4,2],or),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function En(v,S){return 0>v?0:v>S?S:v}function sd(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wx(){var v=new _l;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,ph||(ph=ad)),v}function An(v,S,T){return v.a==0&&(v.a=S,v.sc=T,v.cb=0),0}function Bp(v,S,T){return 3<=T&&v[S+0]==157&&v[S+1]==1&&v[S+2]==42}function Ki(v,S){if(v==null)return 0;if(v.a=0,v.sc="OK",S==null)return An(v,2,"null VP8Io passed to VP8GetHeaders()");var T=S.data,F=S.w,q=S.ha;if(4>q)return An(v,7,"Truncated header.");var V=T[F+0]|T[F+1]<<8|T[F+2]<<16,G=v.Od;if(G.Rb=!(1&V),G.td=V>>1&7,G.yd=V>>4&1,G.ub=V>>5,3<G.td)return An(v,3,"Incorrect keyframe parameters.");if(!G.yd)return An(v,4,"Frame not displayable.");F+=3,q-=3;var Q=v.Kc;if(G.Rb){if(7>q)return An(v,7,"cannot parse picture header");if(!Bp(T,F,q))return An(v,3,"Bad code word");Q.c=16383&(T[F+4]<<8|T[F+3]),Q.Td=T[F+4]>>6,Q.i=16383&(T[F+6]<<8|T[F+5]),Q.Ud=T[F+6]>>6,F+=7,q-=7,v.za=Q.c+15>>4,v.Ub=Q.i+15>>4,S.width=Q.c,S.height=Q.i,S.Da=0,S.j=0,S.v=0,S.va=S.width,S.o=S.height,S.da=0,S.ib=S.width,S.hb=S.height,S.U=S.width,S.T=S.height,s((V=v.Pa).jb,0,255,V.jb.length),t((V=v.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,s(V.Zb,0,0,V.Zb.length),s(V.Lb,0,0,V.Lb)}if(G.ub>q)return An(v,7,"bad partition length");ae(V=v.m,T,F,G.ub),F+=G.ub,q-=G.ub,G.Rb&&(Q.Ld=ge(V),Q.Kd=ge(V)),Q=v.Qa;var ne,le=v.Pa;if(t(V!=null),t(Q!=null),Q.Cb=ge(V),Q.Cb){if(Q.Bb=ge(V),ge(V)){for(Q.Fb=ge(V),ne=0;4>ne;++ne)Q.Zb[ne]=ge(V)?re(V,7):0;for(ne=0;4>ne;++ne)Q.Lb[ne]=ge(V)?re(V,6):0}if(Q.Bb)for(ne=0;3>ne;++ne)le.jb[ne]=ge(V)?he(V,8):255}else Q.Bb=0;if(V.Ka)return An(v,3,"cannot parse segment header");if((Q=v.ed).zd=ge(V),Q.Tb=he(V,6),Q.wb=he(V,3),Q.Pc=ge(V),Q.Pc&&ge(V)){for(le=0;4>le;++le)ge(V)&&(Q.vd[le]=re(V,6));for(le=0;4>le;++le)ge(V)&&(Q.od[le]=re(V,6))}if(v.L=Q.Tb==0?0:Q.zd?1:2,V.Ka)return An(v,3,"cannot parse filter header");var ye=q;if(q=ne=F,F=ne+ye,Q=ye,v.Xb=(1<<he(v.m,2))-1,ye<3*(le=v.Xb))T=7;else{for(ne+=3*le,Q-=3*le,ye=0;ye<le;++ye){var Ce=T[q+0]|T[q+1]<<8|T[q+2]<<16;Ce>Q&&(Ce=Q),ae(v.Jc[+ye],T,ne,Ce),ne+=Ce,Q-=Ce,q+=3}ae(v.Jc[+le],T,ne,Q),T=ne<F?0:5}if(T!=0)return An(v,T,"cannot parse partitions");for(T=he(ne=v.m,7),q=ge(ne)?re(ne,4):0,F=ge(ne)?re(ne,4):0,Q=ge(ne)?re(ne,4):0,le=ge(ne)?re(ne,4):0,ne=ge(ne)?re(ne,4):0,ye=v.Qa,Ce=0;4>Ce;++Ce){if(ye.Cb){var ce=ye.Zb[Ce];ye.Fb||(ce+=T)}else{if(0<Ce){v.pb[Ce]=v.pb[0];continue}ce=T}var we=v.pb[Ce];we.Sc[0]=d2[En(ce+q,127)],we.Sc[1]=f2[En(ce+0,127)],we.Eb[0]=2*d2[En(ce+F,127)],we.Eb[1]=101581*f2[En(ce+Q,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=d2[En(ce+le,117)],we.Qc[1]=f2[En(ce+ne,127)],we.lc=ce+ne}if(!G.Rb)return An(v,4,"Not a key frame.");for(ge(V),G=v.Pa,T=0;4>T;++T){for(q=0;8>q;++q)for(F=0;3>F;++F)for(Q=0;11>Q;++Q)le=xe(V,aL[T][q][F][Q])?he(V,8):nL[T][q][F][Q],G.Wc[T][q].Yb[F][Q]=le;for(q=0;17>q;++q)G.Xc[T][q]=G.Wc[T][iL[q]]}return v.kc=ge(V),v.kc&&(v.Bd=he(V,8)),v.cb=1}function ad(v,S,T,F,q,V,G){var Q=S[q].Yb[T];for(T=0;16>q;++q){if(!xe(v,Q[T+0]))return q;for(;!xe(v,Q[T+1]);)if(Q=S[++q].Yb[0],T=0,q==16)return 16;var ne=S[q+1].Yb;if(xe(v,Q[T+2])){var le=v,ye=0;if(xe(le,(ce=Q)[(Ce=T)+3]))if(xe(le,ce[Ce+6])){for(Q=0,Ce=2*(ye=xe(le,ce[Ce+8]))+(ce=xe(le,ce[Ce+9+ye])),ye=0,ce=tL[Ce];ce[Q];++Q)ye+=ye+xe(le,ce[Q]);ye+=3+(8<<Ce)}else xe(le,ce[Ce+7])?(ye=7+2*xe(le,165),ye+=xe(le,145)):ye=5+xe(le,159);else ye=xe(le,ce[Ce+4])?3+xe(le,ce[Ce+5]):2;Q=ne[2]}else ye=1,Q=ne[1];ne=G+rL[q],0>(le=v).b&&me(le);var Ce,ce=le.b,we=(Ce=le.Ca>>1)-(le.I>>ce)>>31;--le.b,le.Ca+=we,le.Ca|=1,le.I-=(Ce+1&we)<<ce,V[ne]=((ye^we)-we)*F[(0<q)+0]}return 16}function Up(v){var S=v.rb[v.sb-1];S.la=0,S.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function $a(v,S,T,F,q){q=v[S+T+32*F]+(q>>3),v[S+T+32*F]=-256&q?0>q?0:255:q}function Mn(v,S,T,F,q,V){$a(v,S,0,T,F+q),$a(v,S,1,T,F+V),$a(v,S,2,T,F-V),$a(v,S,3,T,F-q)}function Co(v){return(20091*v>>16)+v}function $p(v,S,T,F){var q,V=0,G=a(16);for(q=0;4>q;++q){var Q=v[S+0]+v[S+8],ne=v[S+0]-v[S+8],le=(35468*v[S+4]>>16)-Co(v[S+12]),ye=Co(v[S+4])+(35468*v[S+12]>>16);G[V+0]=Q+ye,G[V+1]=ne+le,G[V+2]=ne-le,G[V+3]=Q-ye,V+=4,S++}for(q=V=0;4>q;++q)Q=(v=G[V+0]+4)+G[V+8],ne=v-G[V+8],le=(35468*G[V+4]>>16)-Co(G[V+12]),$a(T,F,0,0,Q+(ye=Co(G[V+4])+(35468*G[V+12]>>16))),$a(T,F,1,0,ne+le),$a(T,F,2,0,ne-le),$a(T,F,3,0,Q-ye),V++,F+=32}function Vx(v,S,T,F){var q=v[S+0]+4,V=35468*v[S+4]>>16,G=Co(v[S+4]),Q=35468*v[S+1]>>16;Mn(T,F,0,q+G,v=Co(v[S+1]),Q),Mn(T,F,1,q+V,v,Q),Mn(T,F,2,q-V,v,Q),Mn(T,F,3,q-G,v,Q)}function Kx(v,S,T,F,q){$p(v,S,T,F),q&&$p(v,S+16,T,F+4)}function Gi(v,S,T,F){Qc(v,S+0,T,F,1),Qc(v,S+32,T,F+128,1)}function zp(v,S,T,F){var q;for(v=v[S+0]+4,q=0;4>q;++q)for(S=0;4>S;++S)$a(T,F,S,q,v)}function Hp(v,S,T,F){v[S+0]&&Nr(v,S+0,T,F),v[S+16]&&Nr(v,S+16,T,F+4),v[S+32]&&Nr(v,S+32,T,F+128),v[S+48]&&Nr(v,S+48,T,F+128+4)}function id(v,S,T,F){var q,V=a(16);for(q=0;4>q;++q){var G=v[S+0+q]+v[S+12+q],Q=v[S+4+q]+v[S+8+q],ne=v[S+4+q]-v[S+8+q],le=v[S+0+q]-v[S+12+q];V[0+q]=G+Q,V[8+q]=G-Q,V[4+q]=le+ne,V[12+q]=le-ne}for(q=0;4>q;++q)G=(v=V[0+4*q]+3)+V[3+4*q],Q=V[1+4*q]+V[2+4*q],ne=V[1+4*q]-V[2+4*q],le=v-V[3+4*q],T[F+0]=G+Q>>3,T[F+16]=le+ne>>3,T[F+32]=G-Q>>3,T[F+48]=le-ne>>3,F+=64}function Uc(v,S,T){var F,q=S-32,V=ba,G=255-v[q-1];for(F=0;F<T;++F){var Q,ne=V,le=G+v[S-1];for(Q=0;Q<T;++Q)v[S+Q]=ne[le+v[q+Q]];S+=32}}function Gx(v,S){Uc(v,S,4)}function Yx(v,S){Uc(v,S,8)}function Xx(v,S){Uc(v,S,16)}function Gf(v,S){var T;for(T=0;16>T;++T)n(v,S+32*T,v,S-32,16)}function qp(v,S){var T;for(T=16;0<T;--T)s(v,S,v[S-1],16),S+=32}function di(v,S,T){var F;for(F=0;16>F;++F)s(S,T+32*F,v,16)}function Jx(v,S){var T,F=16;for(T=0;16>T;++T)F+=v[S-1+32*T]+v[S+T-32];di(F>>5,v,S)}function $c(v,S){var T,F=8;for(T=0;16>T;++T)F+=v[S-1+32*T];di(F>>4,v,S)}function Yf(v,S){var T,F=8;for(T=0;16>T;++T)F+=v[S+T-32];di(F>>4,v,S)}function Qx(v,S){di(128,v,S)}function Kt(v,S,T){return v+2*S+T+2>>2}function Zx(v,S){var T,F=S-32;for(F=new Uint8Array([Kt(v[F-1],v[F+0],v[F+1]),Kt(v[F+0],v[F+1],v[F+2]),Kt(v[F+1],v[F+2],v[F+3]),Kt(v[F+2],v[F+3],v[F+4])]),T=0;4>T;++T)n(v,S+32*T,F,0,F.length)}function e2(v,S){var T=v[S-1],F=v[S-1+32],q=v[S-1+64],V=v[S-1+96];Le(v,S+0,16843009*Kt(v[S-1-32],T,F)),Le(v,S+32,16843009*Kt(T,F,q)),Le(v,S+64,16843009*Kt(F,q,V)),Le(v,S+96,16843009*Kt(q,V,V))}function t2(v,S){var T,F=4;for(T=0;4>T;++T)F+=v[S+T-32]+v[S-1+32*T];for(F>>=3,T=0;4>T;++T)s(v,S+32*T,F,4)}function To(v,S){var T=v[S-1+0],F=v[S-1+32],q=v[S-1+64],V=v[S-1-32],G=v[S+0-32],Q=v[S+1-32],ne=v[S+2-32],le=v[S+3-32];v[S+0+96]=Kt(F,q,v[S-1+96]),v[S+1+96]=v[S+0+64]=Kt(T,F,q),v[S+2+96]=v[S+1+64]=v[S+0+32]=Kt(V,T,F),v[S+3+96]=v[S+2+64]=v[S+1+32]=v[S+0+0]=Kt(G,V,T),v[S+3+64]=v[S+2+32]=v[S+1+0]=Kt(Q,G,V),v[S+3+32]=v[S+2+0]=Kt(ne,Q,G),v[S+3+0]=Kt(le,ne,Q)}function Po(v,S){var T=v[S+1-32],F=v[S+2-32],q=v[S+3-32],V=v[S+4-32],G=v[S+5-32],Q=v[S+6-32],ne=v[S+7-32];v[S+0+0]=Kt(v[S+0-32],T,F),v[S+1+0]=v[S+0+32]=Kt(T,F,q),v[S+2+0]=v[S+1+32]=v[S+0+64]=Kt(F,q,V),v[S+3+0]=v[S+2+32]=v[S+1+64]=v[S+0+96]=Kt(q,V,G),v[S+3+32]=v[S+2+64]=v[S+1+96]=Kt(V,G,Q),v[S+3+64]=v[S+2+96]=Kt(G,Q,ne),v[S+3+96]=Kt(Q,ne,ne)}function r2(v,S){var T=v[S-1+0],F=v[S-1+32],q=v[S-1+64],V=v[S-1-32],G=v[S+0-32],Q=v[S+1-32],ne=v[S+2-32],le=v[S+3-32];v[S+0+0]=v[S+1+64]=V+G+1>>1,v[S+1+0]=v[S+2+64]=G+Q+1>>1,v[S+2+0]=v[S+3+64]=Q+ne+1>>1,v[S+3+0]=ne+le+1>>1,v[S+0+96]=Kt(q,F,T),v[S+0+64]=Kt(F,T,V),v[S+0+32]=v[S+1+96]=Kt(T,V,G),v[S+1+32]=v[S+2+96]=Kt(V,G,Q),v[S+2+32]=v[S+3+96]=Kt(G,Q,ne),v[S+3+32]=Kt(Q,ne,le)}function n2(v,S){var T=v[S+0-32],F=v[S+1-32],q=v[S+2-32],V=v[S+3-32],G=v[S+4-32],Q=v[S+5-32],ne=v[S+6-32],le=v[S+7-32];v[S+0+0]=T+F+1>>1,v[S+1+0]=v[S+0+64]=F+q+1>>1,v[S+2+0]=v[S+1+64]=q+V+1>>1,v[S+3+0]=v[S+2+64]=V+G+1>>1,v[S+0+32]=Kt(T,F,q),v[S+1+32]=v[S+0+96]=Kt(F,q,V),v[S+2+32]=v[S+1+96]=Kt(q,V,G),v[S+3+32]=v[S+2+96]=Kt(V,G,Q),v[S+3+64]=Kt(G,Q,ne),v[S+3+96]=Kt(Q,ne,le)}function od(v,S){var T=v[S-1+0],F=v[S-1+32],q=v[S-1+64],V=v[S-1+96];v[S+0+0]=T+F+1>>1,v[S+2+0]=v[S+0+32]=F+q+1>>1,v[S+2+32]=v[S+0+64]=q+V+1>>1,v[S+1+0]=Kt(T,F,q),v[S+3+0]=v[S+1+32]=Kt(F,q,V),v[S+3+32]=v[S+1+64]=Kt(q,V,V),v[S+3+64]=v[S+2+64]=v[S+0+96]=v[S+1+96]=v[S+2+96]=v[S+3+96]=V}function Xf(v,S){var T=v[S-1+0],F=v[S-1+32],q=v[S-1+64],V=v[S-1+96],G=v[S-1-32],Q=v[S+0-32],ne=v[S+1-32],le=v[S+2-32];v[S+0+0]=v[S+2+32]=T+G+1>>1,v[S+0+32]=v[S+2+64]=F+T+1>>1,v[S+0+64]=v[S+2+96]=q+F+1>>1,v[S+0+96]=V+q+1>>1,v[S+3+0]=Kt(Q,ne,le),v[S+2+0]=Kt(G,Q,ne),v[S+1+0]=v[S+3+32]=Kt(T,G,Q),v[S+1+32]=v[S+3+64]=Kt(F,T,G),v[S+1+64]=v[S+3+96]=Kt(q,F,T),v[S+1+96]=Kt(V,q,F)}function zc(v,S){var T;for(T=0;8>T;++T)n(v,S+32*T,v,S-32,8)}function s2(v,S){var T;for(T=0;8>T;++T)s(v,S,v[S-1],8),S+=32}function Lo(v,S,T){var F;for(F=0;8>F;++F)s(S,T+32*F,v,8)}function a2(v,S){var T,F=8;for(T=0;8>T;++T)F+=v[S+T-32]+v[S-1+32*T];Lo(F>>4,v,S)}function Jf(v,S){var T,F=4;for(T=0;8>T;++T)F+=v[S+T-32];Lo(F>>3,v,S)}function Qf(v,S){var T,F=4;for(T=0;8>T;++T)F+=v[S-1+32*T];Lo(F>>3,v,S)}function Wp(v,S){Lo(128,v,S)}function Fo(v,S,T){var F=v[S-T],q=v[S+0],V=3*(q-F)+i2[1020+v[S-2*T]-v[S+T]],G=Zp[112+(V+4>>3)];v[S-T]=ba[255+F+Zp[112+(V+3>>3)]],v[S+0]=ba[255+q-G]}function Zf(v,S,T,F){var q=v[S+0],V=v[S+T];return qa[255+v[S-2*T]-v[S-T]]>F||qa[255+V-q]>F}function ld(v,S,T,F){return 4*qa[255+v[S-T]-v[S+0]]+qa[255+v[S-2*T]-v[S+T]]<=F}function eh(v,S,T,F,q){var V=v[S-3*T],G=v[S-2*T],Q=v[S-T],ne=v[S+0],le=v[S+T],ye=v[S+2*T],Ce=v[S+3*T];return 4*qa[255+Q-ne]+qa[255+G-le]>F?0:qa[255+v[S-4*T]-V]<=q&&qa[255+V-G]<=q&&qa[255+G-Q]<=q&&qa[255+Ce-ye]<=q&&qa[255+ye-le]<=q&&qa[255+le-ne]<=q}function Hc(v,S,T,F){var q=2*F+1;for(F=0;16>F;++F)ld(v,S+F,T,q)&&Fo(v,S+F,T)}function th(v,S,T,F){var q=2*F+1;for(F=0;16>F;++F)ld(v,S+F*T,1,q)&&Fo(v,S+F*T,1)}function Vp(v,S,T,F){var q;for(q=3;0<q;--q)Hc(v,S+=4*T,T,F)}function Kp(v,S,T,F){var q;for(q=3;0<q;--q)th(v,S+=4,T,F)}function Do(v,S,T,F,q,V,G,Q){for(V=2*V+1;0<q--;){if(eh(v,S,T,V,G))if(Zf(v,S,T,Q))Fo(v,S,T);else{var ne=v,le=S,ye=T,Ce=ne[le-2*ye],ce=ne[le-ye],we=ne[le+0],ke=ne[le+ye],ze=ne[le+2*ye],je=27*(Ke=i2[1020+3*(we-ce)+i2[1020+Ce-ke]])+63>>7,qe=18*Ke+63>>7,Ke=9*Ke+63>>7;ne[le-3*ye]=ba[255+ne[le-3*ye]+Ke],ne[le-2*ye]=ba[255+Ce+qe],ne[le-ye]=ba[255+ce+je],ne[le+0]=ba[255+we-je],ne[le+ye]=ba[255+ke-qe],ne[le+2*ye]=ba[255+ze-Ke]}S+=F}}function Ro(v,S,T,F,q,V,G,Q){for(V=2*V+1;0<q--;){if(eh(v,S,T,V,G))if(Zf(v,S,T,Q))Fo(v,S,T);else{var ne=v,le=S,ye=T,Ce=ne[le-ye],ce=ne[le+0],we=ne[le+ye],ke=Zp[112+(4+(ze=3*(ce-Ce))>>3)],ze=Zp[112+(ze+3>>3)],je=ke+1>>1;ne[le-2*ye]=ba[255+ne[le-2*ye]+je],ne[le-ye]=ba[255+Ce+ze],ne[le+0]=ba[255+ce-ke],ne[le+ye]=ba[255+we-je]}S+=F}}function Gp(v,S,T,F,q,V){Do(v,S,T,1,16,F,q,V)}function qc(v,S,T,F,q,V){Do(v,S,1,T,16,F,q,V)}function Yp(v,S,T,F,q,V){var G;for(G=3;0<G;--G)Ro(v,S+=4*T,T,1,16,F,q,V)}function k(v,S,T,F,q,V){var G;for(G=3;0<G;--G)Ro(v,S+=4,1,T,16,F,q,V)}function H(v,S,T,F,q,V,G,Q){Do(v,S,q,1,8,V,G,Q),Do(T,F,q,1,8,V,G,Q)}function de(v,S,T,F,q,V,G,Q){Do(v,S,1,q,8,V,G,Q),Do(T,F,1,q,8,V,G,Q)}function ve(v,S,T,F,q,V,G,Q){Ro(v,S+4*q,q,1,8,V,G,Q),Ro(T,F+4*q,q,1,8,V,G,Q)}function Se(v,S,T,F,q,V,G,Q){Ro(v,S+4,1,q,8,V,G,Q),Ro(T,F+4,1,q,8,V,G,Q)}function Ve(){this.ba=new ft,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Qe,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Xe(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Nt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function At(){this.ua=0,this.Wa=new Me,this.vb=new Me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Z,this.yc=new M}function Wt(){this.xb=this.a=0,this.l=new sd,this.ca=new ft,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new At,this.ab=0,this.gc=i(4,Nt),this.Oc=0}function Zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new sd,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function gr(v,S,T,F,q,V,G){for(v=v==null?0:v[S+0],S=0;S<G;++S)q[V+S]=v+T[F+S]&255,v=q[V+S]}function Zr(v,S,T,F,q,V,G){var Q;if(v==null)gr(null,null,T,F,q,V,G);else for(Q=0;Q<G;++Q)q[V+Q]=v[S+Q]+T[F+Q]&255}function jn(v,S,T,F,q,V,G){if(v==null)gr(null,null,T,F,q,V,G);else{var Q,ne=v[S+0],le=ne,ye=ne;for(Q=0;Q<G;++Q)le=ye+(ne=v[S+Q])-le,ye=T[F+Q]+(-256&le?0>le?0:255:le)&255,le=ne,q[V+Q]=ye}}function Or(v,S,T,F){var q=S.width,V=S.o;if(t(v!=null&&S!=null),0>T||0>=F||T+F>V)return null;if(!v.Cc){if(v.ga==null){var G;if(v.ga=new Zt,(G=v.ga==null)||(G=S.width*S.o,t(v.Gb.length==0),v.Gb=a(G),v.Uc=0,v.Gb==null?G=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,G=1),G=!G),!G){G=v.ga;var Q=v.Fa,ne=v.P,le=v.qc,ye=v.mb,Ce=v.nb,ce=ne+1,we=le-1,ke=G.l;if(t(Q!=null&&ye!=null&&S!=null),Il[0]=null,Il[1]=gr,Il[2]=Zr,Il[3]=jn,G.ca=ye,G.tb=Ce,G.c=S.width,G.i=S.height,t(0<G.c&&0<G.i),1>=le)S=0;else if(G.$a=3&Q[ne+0],G.Z=Q[ne+0]>>2&3,G.Lc=Q[ne+0]>>4&3,ne=Q[ne+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||ne)S=0;else if(ke.put=Et,ke.ac=wr,ke.bc=sr,ke.ma=G,ke.width=S.width,ke.height=S.height,ke.Da=S.Da,ke.v=S.v,ke.va=S.va,ke.j=S.j,ke.o=S.o,G.$a)e:{t(G.$a==1),S=Ee();t:for(;;){if(S==null){S=0;break e}if(t(G!=null),G.mc=S,S.c=G.c,S.i=G.i,S.l=G.l,S.l.ma=G,S.l.width=G.c,S.l.height=G.i,S.a=0,U(S.m,Q,ce,we),!Ae(G.c,G.i,1,S,null)||(S.ab==1&&S.gc[0].hc==3&&se(S.s)?(G.ic=1,Q=S.c*S.i,S.Ta=null,S.Ua=0,S.V=a(Q),S.Ba=0,S.V==null?(S.a=1,S=0):S=1):(G.ic=0,S=Te(S,G.c)),!S))break t;S=1;break e}G.mc=null,S=0}else S=we>=G.c*G.i;G=!S}if(G)return null;v.ga.Lc!=1?v.Ga=0:F=V-T}t(v.ga!=null),t(T+F<=V);e:{if(S=(Q=v.ga).c,V=Q.l.o,Q.$a==0){if(ce=v.rc,we=v.Vc,ke=v.Fa,ne=v.P+1+T*S,le=v.mb,ye=v.nb+T*S,t(ne<=v.P+v.qc),Q.Z!=0)for(t(Il[Q.Z]!=null),G=0;G<F;++G)Il[Q.Z](ce,we,ke,ne,le,ye,S),ce=le,we=ye,ye+=S,ne+=S;else for(G=0;G<F;++G)n(le,ye,ke,ne,S),ce=le,we=ye,ye+=S,ne+=S;v.rc=ce,v.Vc=we}else{if(t(Q.mc!=null),S=T+F,t((G=Q.mc)!=null),t(S<=G.i),G.C>=S)S=1;else if(Q.ic||fi(),Q.ic){Q=G.V,ce=G.Ba,we=G.c;var ze=G.i,je=(ke=1,ne=G.$/we,le=G.$%we,ye=G.m,Ce=G.s,G.$),qe=we*ze,Ke=we*S,et=Ce.wc,Je=je<Ke?W(Ce,le,ne):null;t(je<=qe),t(S<=ze),t(se(Ce));t:for(;;){for(;!ye.h&&je<Ke;){if(le&et||(Je=W(Ce,le,ne)),t(Je!=null),ie(ye),256>(ze=fr(Je.G[0],Je.H[0],ye)))Q[ce+je]=ze,++je,++le>=we&&(le=0,++ne<=S&&!(ne%16)&&fe(G,ne));else{if(!(280>ze)){ke=0;break t}ze=pn(ze-256,ye);var Ct,wt=fr(Je.G[4],Je.H[4],ye);if(ie(ye),!(je>=(wt=Pr(we,wt=pn(wt,ye)))&&qe-je>=ze)){ke=0;break t}for(Ct=0;Ct<ze;++Ct)Q[ce+je+Ct]=Q[ce+je+Ct-wt];for(je+=ze,le+=ze;le>=we;)le-=we,++ne<=S&&!(ne%16)&&fe(G,ne);je<Ke&&le&et&&(Je=W(Ce,le,ne))}t(ye.h==O(ye))}fe(G,ne>S?S:ne);break t}!ke||ye.h&&je<qe?(ke=0,G.a=ye.h?5:3):G.$=je,S=ke}else S=_e(G,G.V,G.Ba,G.c,G.i,S,Ze);if(!S){F=0;break e}}T+F>=V&&(v.Cc=1),F=1}if(!F)return null;if(v.Cc&&((F=v.ga)!=null&&(F.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+T*q}function Bn(v,S,T,F,q,V){for(;0<q--;){var G,Q=v,ne=S+(T?1:0),le=v,ye=S+(T?0:3);for(G=0;G<F;++G){var Ce=le[ye+4*G];Ce!=255&&(Ce*=32897,Q[ne+4*G+0]=Q[ne+4*G+0]*Ce>>23,Q[ne+4*G+1]=Q[ne+4*G+1]*Ce>>23,Q[ne+4*G+2]=Q[ne+4*G+2]*Ce>>23)}S+=V}}function Cn(v,S,T,F,q){for(;0<F--;){var V;for(V=0;V<T;++V){var G=v[S+2*V+0],Q=15&(le=v[S+2*V+1]),ne=4369*Q,le=(240&le|le>>4)*ne>>16;v[S+2*V+0]=(240&G|G>>4)*ne>>16&240|(15&G|G<<4)*ne>>16>>4&15,v[S+2*V+1]=240&le|Q}S+=q}}function as(v,S,T,F,q,V,G,Q){var ne,le,ye=255;for(le=0;le<q;++le){for(ne=0;ne<F;++ne){var Ce=v[S+ne];V[G+4*ne]=Ce,ye&=Ce}S+=T,G+=Q}return ye!=255}function Io(v,S,T,F,q){var V;for(V=0;V<q;++V)T[F+V]=v[S+V]>>8}function fi(){hh=Bn,E4=Cn,A4=as,j4=Io}function Oo(v,S,T){E[v]=function(F,q,V,G,Q,ne,le,ye,Ce,ce,we,ke,ze,je,qe,Ke,et){var Je,Ct=et-1>>1,wt=Q[ne+0]|le[ye+0]<<16,rr=Ce[ce+0]|we[ke+0]<<16;t(F!=null);var kt=3*wt+rr+131074>>2;for(S(F[q+0],255&kt,kt>>16,ze,je),V!=null&&(kt=3*rr+wt+131074>>2,S(V[G+0],255&kt,kt>>16,qe,Ke)),Je=1;Je<=Ct;++Je){var lr=Q[ne+Je]|le[ye+Je]<<16,$n=Ce[ce+Je]|we[ke+Je]<<16,nr=wt+lr+rr+$n+524296,_t=nr+2*(lr+rr)>>3;kt=_t+wt>>1,wt=(nr=nr+2*(wt+$n)>>3)+lr>>1,S(F[q+2*Je-1],255&kt,kt>>16,ze,je+(2*Je-1)*T),S(F[q+2*Je-0],255&wt,wt>>16,ze,je+(2*Je-0)*T),V!=null&&(kt=nr+rr>>1,wt=_t+$n>>1,S(V[G+2*Je-1],255&kt,kt>>16,qe,Ke+(2*Je-1)*T),S(V[G+2*Je+0],255&wt,wt>>16,qe,Ke+(2*Je+0)*T)),wt=lr,rr=$n}1&et||(kt=3*wt+rr+131074>>2,S(F[q+et-1],255&kt,kt>>16,ze,je+(et-1)*T),V!=null&&(kt=3*rr+wt+131074>>2,S(V[G+et-1],255&kt,kt>>16,qe,Ke+(et-1)*T)))}}function rh(){Wa[em]=lL,Wa[tm]=B4,Wa[D4]=cL,Wa[rm]=U4,Wa[nm]=$4,Wa[o2]=z4,Wa[R4]=uL,Wa[l2]=B4,Wa[c2]=U4,Wa[sm]=$4,Wa[u2]=z4}function cd(v){return v&-16384?0>v?0:255:v>>dL}function El(v,S){return cd((19077*v>>8)+(26149*S>>8)-14234)}function Wc(v,S,T){return cd((19077*v>>8)-(6419*S>>8)-(13320*T>>8)+8708)}function Vc(v,S){return cd((19077*v>>8)+(33050*S>>8)-17685)}function Al(v,S,T,F,q){F[q+0]=El(v,T),F[q+1]=Wc(v,S,T),F[q+2]=Vc(v,S)}function is(v,S,T,F,q){F[q+0]=Vc(v,S),F[q+1]=Wc(v,S,T),F[q+2]=El(v,T)}function Kc(v,S,T,F,q){var V=Wc(v,S,T);S=V<<3&224|Vc(v,S)>>3,F[q+0]=248&El(v,T)|V>>5,F[q+1]=S}function Gc(v,S,T,F,q){var V=240&Vc(v,S)|15;F[q+0]=240&El(v,T)|Wc(v,S,T)>>4,F[q+1]=V}function nh(v,S,T,F,q){F[q+0]=255,Al(v,S,T,F,q+1)}function sh(v,S,T,F,q){is(v,S,T,F,q),F[q+3]=255}function Hs(v,S,T,F,q){Al(v,S,T,F,q),F[q+3]=255}function Mo(v,S,T){E[v]=function(F,q,V,G,Q,ne,le,ye,Ce){for(var ce=ye+(-2&Ce)*T;ye!=ce;)S(F[q+0],V[G+0],Q[ne+0],le,ye),S(F[q+1],V[G+0],Q[ne+0],le,ye+T),q+=2,++G,++ne,ye+=2*T;1&Ce&&S(F[q+0],V[G+0],Q[ne+0],le,ye)}}function ud(v,S,T){return T==0?v==0?S==0?6:5:S==0?4:0:T}function Xp(v,S,T,F,q){switch(v>>>30){case 3:Qc(S,T,F,q,0);break;case 2:Ha(S,T,F,q);break;case 1:Nr(S,T,F,q)}}function za(v,S){var T,F,q=S.M,V=S.Nb,G=v.oc,Q=v.pc+40,ne=v.oc,le=v.pc+584,ye=v.oc,Ce=v.pc+600;for(T=0;16>T;++T)G[Q+32*T-1]=129;for(T=0;8>T;++T)ne[le+32*T-1]=129,ye[Ce+32*T-1]=129;for(0<q?G[Q-1-32]=ne[le-1-32]=ye[Ce-1-32]=129:(s(G,Q-32-1,127,21),s(ne,le-32-1,127,9),s(ye,Ce-32-1,127,9)),F=0;F<v.za;++F){var ce=S.ya[S.aa+F];if(0<F){for(T=-1;16>T;++T)n(G,Q+32*T-4,G,Q+32*T+12,4);for(T=-1;8>T;++T)n(ne,le+32*T-4,ne,le+32*T+4,4),n(ye,Ce+32*T-4,ye,Ce+32*T+4,4)}var we=v.Gd,ke=v.Hd+F,ze=ce.ad,je=ce.Hc;if(0<q&&(n(G,Q-32,we[ke].y,0,16),n(ne,le-32,we[ke].f,0,8),n(ye,Ce-32,we[ke].ea,0,8)),ce.Za){var qe=G,Ke=Q-32+16;for(0<q&&(F>=v.za-1?s(qe,Ke,we[ke].y[15],4):n(qe,Ke,we[ke+1].y,0,4)),T=0;4>T;T++)qe[Ke+128+T]=qe[Ke+256+T]=qe[Ke+384+T]=qe[Ke+0+T];for(T=0;16>T;++T,je<<=2)qe=G,Ke=Q+q4[T],hi[ce.Ob[T]](qe,Ke),Xp(je,ze,16*+T,qe,Ke)}else if(qe=ud(F,q,ce.Ob[0]),Rl[qe](G,Q),je!=0)for(T=0;16>T;++T,je<<=2)Xp(je,ze,16*+T,G,Q+q4[T]);for(T=ce.Gc,qe=ud(F,q,ce.Dd),$o[qe](ne,le),$o[qe](ye,Ce),je=ze,qe=ne,Ke=le,255&(ce=0|T)&&(170&ce?Ji(je,256,qe,Ke):Lr(je,256,qe,Ke)),ce=ye,je=Ce,255&(T>>=8)&&(170&T?Ji(ze,320,ce,je):Lr(ze,320,ce,je)),q<v.Ub-1&&(n(we[ke].y,0,G,Q+480,16),n(we[ke].f,0,ne,le+224,8),n(we[ke].ea,0,ye,Ce+224,8)),T=8*V*v.B,we=v.sa,ke=v.ta+16*F+16*V*v.R,ze=v.qa,ce=v.ra+8*F+T,je=v.Ha,qe=v.Ia+8*F+T,T=0;16>T;++T)n(we,ke+T*v.R,G,Q+32*T,16);for(T=0;8>T;++T)n(ze,ce+T*v.B,ne,le+32*T,8),n(je,qe+T*v.B,ye,Ce+32*T,8)}}function Yc(v,S,T,F,q,V,G,Q,ne){var le=[0],ye=[0],Ce=0,ce=ne!=null?ne.kd:0,we=ne??new Xe;if(v==null||12>T)return 7;we.data=v,we.w=S,we.ha=T,S=[S],T=[T],we.gb=[we.gb];e:{var ke=S,ze=T,je=we.gb;if(t(v!=null),t(ze!=null),t(je!=null),je[0]=0,12<=ze[0]&&!r(v,ke[0],"RIFF")){if(r(v,ke[0]+8,"WEBP")){je=3;break e}var qe=Fe(v,ke[0]+4);if(12>qe||4294967286<qe){je=3;break e}if(ce&&qe>ze[0]-8){je=7;break e}je[0]=qe,ke[0]+=12,ze[0]-=12}je=0}if(je!=0)return je;for(qe=0<we.gb[0],T=T[0];;){e:{var Ke=v;ze=S,je=T;var et=le,Je=ye,Ct=ke=[0];if((kt=Ce=[Ce])[0]=0,8>je[0])je=7;else{if(!r(Ke,ze[0],"VP8X")){if(Fe(Ke,ze[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var wt=Fe(Ke,ze[0]+8),rr=1+Re(Ke,ze[0]+12);if(2147483648<=rr*(Ke=1+Re(Ke,ze[0]+15))){je=3;break e}Ct!=null&&(Ct[0]=wt),et!=null&&(et[0]=rr),Je!=null&&(Je[0]=Ke),ze[0]+=18,je[0]-=18,kt[0]=1}je=0}}if(Ce=Ce[0],ke=ke[0],je!=0)return je;if(ze=!!(2&ke),!qe&&Ce)return 3;if(V!=null&&(V[0]=!!(16&ke)),G!=null&&(G[0]=ze),Q!=null&&(Q[0]=0),G=le[0],ke=ye[0],Ce&&ze&&ne==null){je=0;break}if(4>T){je=7;break}if(qe&&Ce||!qe&&!Ce&&!r(v,S[0],"ALPH")){T=[T],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{wt=v,je=S,qe=T;var kt=we.gb;et=we.na,Je=we.P,Ct=we.Sa,rr=22,t(wt!=null),t(qe!=null),Ke=je[0];var lr=qe[0];for(t(et!=null),t(Ct!=null),et[0]=null,Je[0]=null,Ct[0]=0;;){if(je[0]=Ke,qe[0]=lr,8>lr){je=7;break e}var $n=Fe(wt,Ke+4);if(4294967286<$n){je=3;break e}var nr=8+$n+1&-2;if(rr+=nr,0<kt&&rr>kt){je=3;break e}if(!r(wt,Ke,"VP8 ")||!r(wt,Ke,"VP8L")){je=0;break e}if(lr[0]<nr){je=7;break e}r(wt,Ke,"ALPH")||(et[0]=wt,Je[0]=Ke+8,Ct[0]=$n),Ke+=nr,lr-=nr}}if(T=T[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],je!=0)break}T=[T],we.Ja=[we.Ja],we.xa=[we.xa];e:if(kt=v,je=S,qe=T,et=we.gb[0],Je=we.Ja,Ct=we.xa,wt=je[0],Ke=!r(kt,wt,"VP8 "),rr=!r(kt,wt,"VP8L"),t(kt!=null),t(qe!=null),t(Je!=null),t(Ct!=null),8>qe[0])je=7;else{if(Ke||rr){if(kt=Fe(kt,wt+4),12<=et&&kt>et-12){je=3;break e}if(ce&&kt>qe[0]-8){je=7;break e}Je[0]=kt,je[0]+=8,qe[0]-=8,Ct[0]=rr}else Ct[0]=5<=qe[0]&&kt[wt+0]==47&&!(kt[wt+4]>>5),Je[0]=qe[0];je=0}if(T=T[0],we.Ja=we.Ja[0],we.xa=we.xa[0],S=S[0],je!=0)break;if(4294967286<we.Ja)return 3;if(Q==null||ze||(Q[0]=we.xa?2:1),G=[G],ke=[ke],we.xa){if(5>T){je=7;break}Q=G,ce=ke,ze=V,v==null||5>T?v=0:5<=T&&v[S+0]==47&&!(v[S+4]>>5)?(qe=[0],kt=[0],et=[0],U(Je=new R,v,S,T),va(Je,qe,kt,et)?(Q!=null&&(Q[0]=qe[0]),ce!=null&&(ce[0]=kt[0]),ze!=null&&(ze[0]=et[0]),v=1):v=0):v=0}else{if(10>T){je=7;break}Q=ke,v==null||10>T||!Bp(v,S+3,T-3)?v=0:(ce=v[S+0]|v[S+1]<<8|v[S+2]<<16,ze=16383&(v[S+7]<<8|v[S+6]),v=16383&(v[S+9]<<8|v[S+8]),1&ce||3<(ce>>1&7)||!(ce>>4&1)||ce>>5>=we.Ja||!ze||!v?v=0:(G&&(G[0]=ze),Q&&(Q[0]=v),v=1))}if(!v||(G=G[0],ke=ke[0],Ce&&(le[0]!=G||ye[0]!=ke)))return 3;ne!=null&&(ne[0]=we,ne.offset=S-ne.w,t(4294967286>S-ne.w),t(ne.offset==ne.ha-T));break}return je==0||je==7&&Ce&&ne==null?(V!=null&&(V[0]|=we.na!=null&&0<we.na.length),F!=null&&(F[0]=G),q!=null&&(q[0]=ke),0):je}function ah(v,S,T){var F=S.width,q=S.height,V=0,G=0,Q=F,ne=q;if(S.Da=v!=null&&0<v.Da,S.Da&&(Q=v.cd,ne=v.bd,V=v.v,G=v.j,11>T||(V&=-2,G&=-2),0>V||0>G||0>=Q||0>=ne||V+Q>F||G+ne>q))return 0;if(S.v=V,S.j=G,S.va=V+Q,S.o=G+ne,S.U=Q,S.T=ne,S.da=v!=null&&0<v.da,S.da){if(!st(Q,ne,T=[v.ib],V=[v.hb]))return 0;S.ib=T[0],S.hb=V[0]}return S.ob=v!=null&&v.ob,S.Kb=v==null||!v.Sd,S.da&&(S.ob=S.ib<3*F/4&&S.hb<3*q/4,S.Kb=0),1}function ih(v){if(v==null)return 2;if(11>v.S){var S=v.f.RGBA;S.fb+=(v.height-1)*S.A,S.A=-S.A}else S=v.f.kb,v=v.height,S.O+=(v-1)*S.fa,S.fa=-S.fa,S.N+=(v-1>>1)*S.Ab,S.Ab=-S.Ab,S.W+=(v-1>>1)*S.Db,S.Db=-S.Db,S.F!=null&&(S.J+=(v-1)*S.lb,S.lb=-S.lb);return 0}function jl(v,S,T,F){if(F==null||0>=v||0>=S)return 2;if(T!=null){if(T.Da){var q=T.cd,V=T.bd,G=-2&T.v,Q=-2&T.j;if(0>G||0>Q||0>=q||0>=V||G+q>v||Q+V>S)return 2;v=q,S=V}if(T.da){if(!st(v,S,q=[T.ib],V=[T.hb]))return 2;v=q[0],S=V[0]}}F.width=v,F.height=S;e:{var ne=F.width,le=F.height;if(v=F.S,0>=ne||0>=le||!(v>=em&&13>v))v=2;else{if(0>=F.Rd&&F.sd==null){G=V=q=S=0;var ye=(Q=ne*W4[v])*le;if(11>v||(V=(le+1)/2*(S=(ne+1)/2),v==12&&(G=(q=ne)*le)),(le=a(ye+2*V+G))==null){v=1;break e}F.sd=le,11>v?((ne=F.f.RGBA).eb=le,ne.fb=0,ne.A=Q,ne.size=ye):((ne=F.f.kb).y=le,ne.O=0,ne.fa=Q,ne.Fd=ye,ne.f=le,ne.N=0+ye,ne.Ab=S,ne.Cd=V,ne.ea=le,ne.W=0+ye+V,ne.Db=S,ne.Ed=V,v==12&&(ne.F=le,ne.J=0+ye+2*V),ne.Tc=G,ne.lb=q)}if(S=1,q=F.S,V=F.width,G=F.height,q>=em&&13>q)if(11>q)v=F.f.RGBA,S&=(Q=Math.abs(v.A))*(G-1)+V<=v.size,S&=Q>=V*W4[q],S&=v.eb!=null;else{v=F.f.kb,Q=(V+1)/2,ye=(G+1)/2,ne=Math.abs(v.fa),le=Math.abs(v.Ab);var Ce=Math.abs(v.Db),ce=Math.abs(v.lb),we=ce*(G-1)+V;S&=ne*(G-1)+V<=v.Fd,S&=le*(ye-1)+Q<=v.Cd,S=(S&=Ce*(ye-1)+Q<=v.Ed)&ne>=V&le>=Q&Ce>=Q,S&=v.y!=null,S&=v.f!=null,S&=v.ea!=null,q==12&&(S&=ce>=V,S&=we<=v.Tc,S&=v.F!=null)}else S=0;v=S?0:2}}return v!=0||T!=null&&T.fd&&(v=ih(F)),v}var Xc=64,ya=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],wa=24,Cl=32,Bo=8,Tl=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];tt("Predictor0","PredictorAdd0"),E.Predictor0=function(){return 4278190080},E.Predictor1=function(v){return v},E.Predictor2=function(v,S,T){return S[T+0]},E.Predictor3=function(v,S,T){return S[T+1]},E.Predictor4=function(v,S,T){return S[T-1]},E.Predictor5=function(v,S,T){return ct(ct(v,S[T+1]),S[T+0])},E.Predictor6=function(v,S,T){return ct(v,S[T-1])},E.Predictor7=function(v,S,T){return ct(v,S[T+0])},E.Predictor8=function(v,S,T){return ct(S[T-1],S[T+0])},E.Predictor9=function(v,S,T){return ct(S[T+0],S[T+1])},E.Predictor10=function(v,S,T){return ct(ct(v,S[T-1]),ct(S[T+0],S[T+1]))},E.Predictor11=function(v,S,T){var F=S[T+0];return 0>=Pt(F>>24&255,v>>24&255,(S=S[T-1])>>24&255)+Pt(F>>16&255,v>>16&255,S>>16&255)+Pt(F>>8&255,v>>8&255,S>>8&255)+Pt(255&F,255&v,255&S)?F:v},E.Predictor12=function(v,S,T){var F=S[T+0];return(Mt((v>>24&255)+(F>>24&255)-((S=S[T-1])>>24&255))<<24|Mt((v>>16&255)+(F>>16&255)-(S>>16&255))<<16|Mt((v>>8&255)+(F>>8&255)-(S>>8&255))<<8|Mt((255&v)+(255&F)-(255&S)))>>>0},E.Predictor13=function(v,S,T){var F=S[T-1];return(It((v=ct(v,S[T+0]))>>24&255,F>>24&255)<<24|It(v>>16&255,F>>16&255)<<16|It(v>>8&255,F>>8&255)<<8|It(255&v,255&F))>>>0};var oh=E.PredictorAdd0;E.PredictorAdd1=Jt,tt("Predictor2","PredictorAdd2"),tt("Predictor3","PredictorAdd3"),tt("Predictor4","PredictorAdd4"),tt("Predictor5","PredictorAdd5"),tt("Predictor6","PredictorAdd6"),tt("Predictor7","PredictorAdd7"),tt("Predictor8","PredictorAdd8"),tt("Predictor9","PredictorAdd9"),tt("Predictor10","PredictorAdd10"),tt("Predictor11","PredictorAdd11"),tt("Predictor12","PredictorAdd12"),tt("Predictor13","PredictorAdd13");var dd=E.PredictorAdd2;ot("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),ot("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var mn,Jp=E.ColorIndexInverseTransform,Yi=E.MapARGB,Xi=E.VP8LColorIndexInverseTransformAlpha,lh=E.MapAlpha,ch=E.VP8LPredictorsAdd=[];ch.length=16,(E.VP8LPredictors=[]).length=16,(E.VP8LPredictorsAdd_C=[]).length=16,(E.VP8LPredictors_C=[]).length=16;var uh,dh,Pl,Ll,Fl,Jc,Dl,Qc,Ha,Ji,Nr,Lr,gn,Un,Uo,fh,fd,Qp,w4,b4,N4,S4,k4,_4,hh,E4,A4,j4,C4=a(511),T4=a(2041),P4=a(225),L4=a(767),F4=0,i2=T4,Zp=P4,ba=L4,qa=C4,em=0,tm=1,D4=2,rm=3,nm=4,o2=5,R4=6,l2=7,c2=8,sm=9,u2=10,GP=[2,3,7],YP=[3,3,11],I4=[280,256,256,256,40],XP=[0,1,1,1,0],JP=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],QP=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],ZP=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],eL=8,d2=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],f2=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ph=null,tL=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rL=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],O4=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],nL=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],sL=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],aL=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],iL=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Rl=[],hi=[],$o=[],oL=1,M4=2,Il=[],Wa=[];Oo("UpsampleRgbLinePair",Al,3),Oo("UpsampleBgrLinePair",is,3),Oo("UpsampleRgbaLinePair",Hs,4),Oo("UpsampleBgraLinePair",sh,4),Oo("UpsampleArgbLinePair",nh,4),Oo("UpsampleRgba4444LinePair",Gc,2),Oo("UpsampleRgb565LinePair",Kc,2);var lL=E.UpsampleRgbLinePair,cL=E.UpsampleBgrLinePair,B4=E.UpsampleRgbaLinePair,U4=E.UpsampleBgraLinePair,$4=E.UpsampleArgbLinePair,z4=E.UpsampleRgba4444LinePair,uL=E.UpsampleRgb565LinePair,am=16,im=1<<am-1,mh=-227,h2=482,dL=6,H4=0,fL=a(256),hL=a(256),pL=a(256),mL=a(256),gL=a(h2-mh),xL=a(h2-mh);Mo("YuvToRgbRow",Al,3),Mo("YuvToBgrRow",is,3),Mo("YuvToRgbaRow",Hs,4),Mo("YuvToBgraRow",sh,4),Mo("YuvToArgbRow",nh,4),Mo("YuvToRgba4444Row",Gc,2),Mo("YuvToRgb565Row",Kc,2);var q4=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],om=[0,2,8],vL=[8,7,6,4,4,2,2,2,1,1,1,1],yL=1;this.WebPDecodeRGBA=function(v,S,T,F,q){var V=tm,G=new Ve,Q=new ft;G.ba=Q,Q.S=V,Q.width=[Q.width],Q.height=[Q.height];var ne=Q.width,le=Q.height,ye=new Ye;if(ye==null||v==null)var Ce=2;else t(ye!=null),Ce=Yc(v,S,T,ye.width,ye.height,ye.Pd,ye.Qd,ye.format,null);if(Ce!=0?ne=0:(ne!=null&&(ne[0]=ye.width[0]),le!=null&&(le[0]=ye.height[0]),ne=1),ne){Q.width=Q.width[0],Q.height=Q.height[0],F!=null&&(F[0]=Q.width),q!=null&&(q[0]=Q.height);e:{if(F=new sd,(q=new Xe).data=v,q.w=S,q.ha=T,q.kd=1,S=[0],t(q!=null),((v=Yc(q.data,q.w,q.ha,null,null,null,S,null,q))==0||v==7)&&S[0]&&(v=4),(S=v)==0){if(t(G!=null),F.data=q.data,F.w=q.w+q.offset,F.ha=q.ha-q.offset,F.put=Et,F.ac=wr,F.bc=sr,F.ma=G,q.xa){if((v=Ee())==null){G=1;break e}if(function(ce,we){var ke=[0],ze=[0],je=[0];t:for(;;){if(ce==null)return 0;if(we==null)return ce.a=2,0;if(ce.l=we,ce.a=0,U(ce.m,we.data,we.w,we.ha),!va(ce.m,ke,ze,je)){ce.a=3;break t}if(ce.xb=M4,we.width=ke[0],we.height=ze[0],!Ae(ke[0],ze[0],1,ce,null))break t;return 1}return t(ce.a!=0),0}(v,F)){if(F=(S=jl(F.width,F.height,G.Oa,G.ba))==0){t:{F=v;r:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((T=F.l)!=null),t((q=T.ma)!=null),F.xb!=0){if(F.ca=q.ba,F.tb=q.tb,t(F.ca!=null),!ah(q.Oa,T,rm)){F.a=2;break r}if(!Te(F,T.width)||T.da)break r;if((T.da||He(F.ca.S))&&fi(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&fi()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!X(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!_e(F,F.V,F.Ba,F.c,F.i,T.o,ee))break r;q.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(S=v.a)}else S=v.a}else{if((v=new Wx)==null){G=1;break e}if(v.Fa=q.na,v.P=q.P,v.qc=q.Sa,Ki(v,F)){if((S=jl(F.width,F.height,G.Oa,G.ba))==0){if(v.Aa=0,T=G.Oa,t((q=v)!=null),T!=null){if(0<(ne=0>(ne=T.Md)?0:100<ne?255:255*ne/100)){for(le=ye=0;4>le;++le)12>(Ce=q.pb[le]).lc&&(Ce.ia=ne*vL[0>Ce.lc?0:Ce.lc]>>3),ye|=Ce.ia;ye&&(alert("todo:VP8InitRandom"),q.ia=1)}q.Ga=T.Id,100<q.Ga?q.Ga=100:0>q.Ga&&(q.Ga=0)}(function(ce,we){if(ce==null)return 0;if(we==null)return An(ce,2,"NULL VP8Io parameter in VP8Decode().");if(!ce.cb&&!Ki(ce,we))return 0;if(t(ce.cb),we.ac==null||we.ac(we)){we.ob&&(ce.L=0);var ke=om[ce.L];if(ce.L==2?(ce.yb=0,ce.zb=0):(ce.yb=we.v-ke>>4,ce.zb=we.j-ke>>4,0>ce.yb&&(ce.yb=0),0>ce.zb&&(ce.zb=0)),ce.Va=we.o+15+ke>>4,ce.Hb=we.va+15+ke>>4,ce.Hb>ce.za&&(ce.Hb=ce.za),ce.Va>ce.Ub&&(ce.Va=ce.Ub),0<ce.L){var ze=ce.ed;for(ke=0;4>ke;++ke){var je;if(ce.Qa.Cb){var qe=ce.Qa.Lb[ke];ce.Qa.Fb||(qe+=ze.Tb)}else qe=ze.Tb;for(je=0;1>=je;++je){var Ke=ce.gd[ke][je],et=qe;if(ze.Pc&&(et+=ze.vd[0],je&&(et+=ze.od[0])),0<(et=0>et?0:63<et?63:et)){var Je=et;0<ze.wb&&(Je=4<ze.wb?Je>>2:Je>>1)>9-ze.wb&&(Je=9-ze.wb),1>Je&&(Je=1),Ke.dd=Je,Ke.tc=2*et+Je,Ke.ld=40<=et?2:15<=et?1:0}else Ke.tc=0;Ke.La=je}}}ke=0}else An(ce,6,"Frame setup failed"),ke=ce.a;if(ke=ke==0){if(ke){ce.$c=0,0<ce.Aa||(ce.Ic=yL);t:{ke=ce.Ic,ze=4*(Je=ce.za);var Ct=32*Je,wt=Je+1,rr=0<ce.L?Je*(0<ce.Aa?2:1):0,kt=(ce.Aa==2?2:1)*Je;if((Ke=ze+832+(je=3*(16*ke+om[ce.L])/2*Ct)+(qe=ce.Fa!=null&&0<ce.Fa.length?ce.Kc.c*ce.Kc.i:0))!=Ke)ke=0;else{if(Ke>ce.Vb){if(ce.Vb=0,ce.Ec=a(Ke),ce.Fc=0,ce.Ec==null){ke=An(ce,1,"no memory during frame initialization.");break t}ce.Vb=Ke}Ke=ce.Ec,et=ce.Fc,ce.Ac=Ke,ce.Bc=et,et+=ze,ce.Gd=i(Ct,Ua),ce.Hd=0,ce.rb=i(wt+1,nn),ce.sb=1,ce.wa=rr?i(rr,or):null,ce.Y=0,ce.D.Nb=0,ce.D.wa=ce.wa,ce.D.Y=ce.Y,0<ce.Aa&&(ce.D.Y+=Je),t(!0),ce.oc=Ke,ce.pc=et,et+=832,ce.ya=i(kt,ui),ce.aa=0,ce.D.ya=ce.ya,ce.D.aa=ce.aa,ce.Aa==2&&(ce.D.aa+=Je),ce.R=16*Je,ce.B=8*Je,Je=(Ct=om[ce.L])*ce.R,Ct=Ct/2*ce.B,ce.sa=Ke,ce.ta=et+Je,ce.qa=ce.sa,ce.ra=ce.ta+16*ke*ce.R+Ct,ce.Ha=ce.qa,ce.Ia=ce.ra+8*ke*ce.B+Ct,ce.$c=0,et+=je,ce.mb=qe?Ke:null,ce.nb=qe?et:null,t(et+qe<=ce.Fc+ce.Vb),Up(ce),s(ce.Ac,ce.Bc,0,ze),ke=1}}if(ke){if(we.ka=0,we.y=ce.sa,we.O=ce.ta,we.f=ce.qa,we.N=ce.ra,we.ea=ce.Ha,we.Vd=ce.Ia,we.fa=ce.R,we.Rc=ce.B,we.F=null,we.J=0,!F4){for(ke=-255;255>=ke;++ke)C4[255+ke]=0>ke?-ke:ke;for(ke=-1020;1020>=ke;++ke)T4[1020+ke]=-128>ke?-128:127<ke?127:ke;for(ke=-112;112>=ke;++ke)P4[112+ke]=-16>ke?-16:15<ke?15:ke;for(ke=-255;510>=ke;++ke)L4[255+ke]=0>ke?0:255<ke?255:ke;F4=1}Dl=id,Qc=Kx,Ji=Gi,Nr=zp,Lr=Hp,Ha=Vx,gn=Gp,Un=qc,Uo=H,fh=de,fd=Yp,Qp=k,w4=ve,b4=Se,N4=Hc,S4=th,k4=Vp,_4=Kp,hi[0]=t2,hi[1]=Gx,hi[2]=Zx,hi[3]=e2,hi[4]=To,hi[5]=r2,hi[6]=Po,hi[7]=n2,hi[8]=Xf,hi[9]=od,Rl[0]=Jx,Rl[1]=Xx,Rl[2]=Gf,Rl[3]=qp,Rl[4]=$c,Rl[5]=Yf,Rl[6]=Qx,$o[0]=a2,$o[1]=Yx,$o[2]=zc,$o[3]=s2,$o[4]=Qf,$o[5]=Jf,$o[6]=Wp,ke=1}else ke=0}ke&&(ke=function(lr,$n){for(lr.M=0;lr.M<lr.Va;++lr.M){var nr,_t=lr.Jc[lr.M&lr.Xb],lt=lr.m,xn=lr;for(nr=0;nr<xn.za;++nr){var Qt=lt,hr=xn,Hr=hr.Ac,os=hr.Bc+4*nr,qs=hr.zc,sn=hr.ya[hr.aa+nr];if(hr.Qa.Bb?sn.$b=xe(Qt,hr.Pa.jb[0])?2+xe(Qt,hr.Pa.jb[2]):xe(Qt,hr.Pa.jb[1]):sn.$b=0,hr.kc&&(sn.Ad=xe(Qt,hr.Bd)),sn.Za=!xe(Qt,145)+0,sn.Za){var Ns=sn.Ob,Ws=0;for(hr=0;4>hr;++hr){var zn,xr=qs[0+hr];for(zn=0;4>zn;++zn){xr=sL[Hr[os+zn]][xr];for(var Sr=O4[xe(Qt,xr[0])];0<Sr;)Sr=O4[2*Sr+xe(Qt,xr[Sr])];xr=-Sr,Hr[os+zn]=xr}n(Ns,Ws,Hr,os,4),Ws+=4,qs[0+hr]=xr}}else xr=xe(Qt,156)?xe(Qt,128)?1:3:xe(Qt,163)?2:0,sn.Ob[0]=xr,s(Hr,os,xr,4),s(qs,0,xr,4);sn.Dd=xe(Qt,142)?xe(Qt,114)?xe(Qt,183)?1:3:2:0}if(xn.m.Ka)return An(lr,7,"Premature end-of-partition0 encountered.");for(;lr.ja<lr.za;++lr.ja){if(xn=_t,Qt=(lt=lr).rb[lt.sb-1],Hr=lt.rb[lt.sb+lt.ja],nr=lt.ya[lt.aa+lt.ja],os=lt.kc?nr.Ad:0)Qt.la=Hr.la=0,nr.Za||(Qt.Na=Hr.Na=0),nr.Hc=0,nr.Gc=0,nr.ia=0;else{var an,kr;if(Qt=Hr,Hr=xn,os=lt.Pa.Xc,qs=lt.ya[lt.aa+lt.ja],sn=lt.pb[qs.$b],hr=qs.ad,Ns=0,Ws=lt.rb[lt.sb-1],xr=zn=0,s(hr,Ns,0,384),qs.Za)var ls=0,pi=os[3];else{Sr=a(16);var vn=Qt.Na+Ws.Na;if(vn=ph(Hr,os[1],vn,sn.Eb,0,Sr,0),Qt.Na=Ws.Na=(0<vn)+0,1<vn)Dl(Sr,0,hr,Ns);else{var oa=Sr[0]+3>>3;for(Sr=0;256>Sr;Sr+=16)hr[Ns+Sr]=oa}ls=1,pi=os[0]}var Fr=15&Qt.la,Hn=15&Ws.la;for(Sr=0;4>Sr;++Sr){var Na=1&Hn;for(oa=kr=0;4>oa;++oa)Fr=Fr>>1|(Na=(vn=ph(Hr,pi,vn=Na+(1&Fr),sn.Sc,ls,hr,Ns))>ls)<<7,kr=kr<<2|(3<vn?3:1<vn?2:hr[Ns+0]!=0),Ns+=16;Fr>>=4,Hn=Hn>>1|Na<<7,zn=(zn<<8|kr)>>>0}for(pi=Fr,ls=Hn>>4,an=0;4>an;an+=2){for(kr=0,Fr=Qt.la>>4+an,Hn=Ws.la>>4+an,Sr=0;2>Sr;++Sr){for(Na=1&Hn,oa=0;2>oa;++oa)vn=Na+(1&Fr),Fr=Fr>>1|(Na=0<(vn=ph(Hr,os[2],vn,sn.Qc,0,hr,Ns)))<<3,kr=kr<<2|(3<vn?3:1<vn?2:hr[Ns+0]!=0),Ns+=16;Fr>>=2,Hn=Hn>>1|Na<<5}xr|=kr<<4*an,pi|=Fr<<4<<an,ls|=(240&Hn)<<an}Qt.la=pi,Ws.la=ls,qs.Hc=zn,qs.Gc=xr,qs.ia=43690&xr?0:sn.ia,os=!(zn|xr)}if(0<lt.L&&(lt.wa[lt.Y+lt.ja]=lt.gd[nr.$b][nr.Za],lt.wa[lt.Y+lt.ja].La|=!os),xn.Ka)return An(lr,7,"Premature end-of-file encountered.")}if(Up(lr),lt=$n,xn=1,nr=(_t=lr).D,Qt=0<_t.L&&_t.M>=_t.zb&&_t.M<=_t.Va,_t.Aa==0)t:{if(nr.M=_t.M,nr.uc=Qt,za(_t,nr),xn=1,nr=(kr=_t.D).Nb,Qt=(xr=om[_t.L])*_t.R,Hr=xr/2*_t.B,Sr=16*nr*_t.R,oa=8*nr*_t.B,os=_t.sa,qs=_t.ta-Qt+Sr,sn=_t.qa,hr=_t.ra-Hr+oa,Ns=_t.Ha,Ws=_t.Ia-Hr+oa,Hn=(Fr=kr.M)==0,zn=Fr>=_t.Va-1,_t.Aa==2&&za(_t,kr),kr.uc)for(Na=(vn=_t).D.M,t(vn.D.uc),kr=vn.yb;kr<vn.Hb;++kr){ls=kr,pi=Na;var Vs=(Sa=(cs=vn).D).Nb;an=cs.R;var Sa=Sa.wa[Sa.Y+ls],ka=cs.sa,la=cs.ta+16*Vs*an+16*ls,_a=Sa.dd,Mr=Sa.tc;if(Mr!=0)if(t(3<=Mr),cs.L==1)0<ls&&S4(ka,la,an,Mr+4),Sa.La&&_4(ka,la,an,Mr),0<pi&&N4(ka,la,an,Mr+4),Sa.La&&k4(ka,la,an,Mr);else{var Ea=cs.B,mi=cs.qa,Zc=cs.ra+8*Vs*Ea+8*ls,zo=cs.Ha,cs=cs.Ia+8*Vs*Ea+8*ls;Vs=Sa.ld,0<ls&&(Un(ka,la,an,Mr+4,_a,Vs),fh(mi,Zc,zo,cs,Ea,Mr+4,_a,Vs)),Sa.La&&(Qp(ka,la,an,Mr,_a,Vs),b4(mi,Zc,zo,cs,Ea,Mr,_a,Vs)),0<pi&&(gn(ka,la,an,Mr+4,_a,Vs),Uo(mi,Zc,zo,cs,Ea,Mr+4,_a,Vs)),Sa.La&&(fd(ka,la,an,Mr,_a,Vs),w4(mi,Zc,zo,cs,Ea,Mr,_a,Vs))}}if(_t.ia&&alert("todo:DitherRow"),lt.put!=null){if(kr=16*Fr,Fr=16*(Fr+1),Hn?(lt.y=_t.sa,lt.O=_t.ta+Sr,lt.f=_t.qa,lt.N=_t.ra+oa,lt.ea=_t.Ha,lt.W=_t.Ia+oa):(kr-=xr,lt.y=os,lt.O=qs,lt.f=sn,lt.N=hr,lt.ea=Ns,lt.W=Ws),zn||(Fr-=xr),Fr>lt.o&&(Fr=lt.o),lt.F=null,lt.J=null,_t.Fa!=null&&0<_t.Fa.length&&kr<Fr&&(lt.J=Or(_t,lt,kr,Fr-kr),lt.F=_t.mb,lt.F==null&&lt.F.length==0)){xn=An(_t,3,"Could not decode alpha data.");break t}kr<lt.j&&(xr=lt.j-kr,kr=lt.j,t(!(1&xr)),lt.O+=_t.R*xr,lt.N+=_t.B*(xr>>1),lt.W+=_t.B*(xr>>1),lt.F!=null&&(lt.J+=lt.width*xr)),kr<Fr&&(lt.O+=lt.v,lt.N+=lt.v>>1,lt.W+=lt.v>>1,lt.F!=null&&(lt.J+=lt.v),lt.ka=kr-lt.j,lt.U=lt.va-lt.v,lt.T=Fr-kr,xn=lt.put(lt))}nr+1!=_t.Ic||zn||(n(_t.sa,_t.ta-Qt,os,qs+16*_t.R,Qt),n(_t.qa,_t.ra-Hr,sn,hr+8*_t.B,Hr),n(_t.Ha,_t.Ia-Hr,Ns,Ws+8*_t.B,Hr))}if(!xn)return An(lr,6,"Output aborted.")}return 1}(ce,we)),we.bc!=null&&we.bc(we),ke&=1}return ke?(ce.cb=0,ke):0})(v,F)||(S=v.a)}}else S=v.a}S==0&&G.Oa!=null&&G.Oa.fd&&(S=ih(G.ba))}G=S}V=G!=0?null:11>V?Q.f.RGBA.eb:Q.f.kb.y}else V=null;return V};var W4=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(E,I){for(var _="",L=0;L<4;L++)_+=String.fromCharCode(E[I++]);return _}function d(E,I){return E[I+0]|E[I+1]<<8}function f(E,I){return(E[I+0]|E[I+1]<<8|E[I+2]<<16)>>>0}function p(E,I){return(E[I+0]|E[I+1]<<8|E[I+2]<<16|E[I+3]<<24)>>>0}new l;var h=[0],m=[0],g=[],y=new l,x=e,w=function(E,I){var _={},L=0,M=!1,K=0,Z=0;if(_.frames=[],!function(C,R){for(var B=0;B<4;B++)if(C[R+B]!="RIFF".charCodeAt(B))return!0;return!1}(E,I)){for(p(E,I+=4),I+=8;I<E.length;){var ae=u(E,I),he=p(E,I+=4);I+=4;var re=he+(1&he);switch(ae){case"VP8 ":case"VP8L":_.frames[L]===void 0&&(_.frames[L]={}),(pe=_.frames[L]).src_off=M?Z:I-8,pe.src_size=K+he+8,L++,M&&(M=!1,K=0,Z=0);break;case"VP8X":(pe=_.header={}).feature_flags=E[I];var U=I+4;pe.canvas_width=1+f(E,U),U+=3,pe.canvas_height=1+f(E,U),U+=3;break;case"ALPH":M=!0,K=re+8,Z=I-8;break;case"ANIM":(pe=_.header).bgcolor=p(E,I),U=I+4,pe.loop_count=d(E,U),U+=2;break;case"ANMF":var ue,pe;(pe=_.frames[L]={}).offset_x=2*f(E,I),I+=3,pe.offset_y=2*f(E,I),I+=3,pe.width=1+f(E,I),I+=3,pe.height=1+f(E,I),I+=3,pe.duration=f(E,I),I+=3,ue=E[I++],pe.dispose=1&ue,pe.blend=ue>>1&1}ae!="ANMF"&&(I+=re)}return _}}(x,0);w.response=x,w.rgbaoutput=!0,w.dataurl=!1;var b=w.header?w.header:null,N=w.frames?w.frames:null;if(b){b.loop_counter=b.loop_count,h=[b.canvas_height],m=[b.canvas_width];for(var A=0;A<N.length&&N[A].blend!=0;A++);}var P=N[0],j=y.WebPDecodeRGBA(x,P.src_off,P.src_size,m,h);P.rgba=j,P.imgwidth=m[0],P.imgheight=h[0];for(var D=0;D<m[0]*h[0]*4;D++)g[D]=j[D];return this.width=m,this.height=h,this.data=g,this}(function(e){var t,r,n,s,a,i,o,l,u,d=function(C){return C=C||{},this.isStrokeTransparent=C.isStrokeTransparent||!1,this.strokeOpacity=C.strokeOpacity||1,this.strokeStyle=C.strokeStyle||"#000000",this.fillStyle=C.fillStyle||"#000000",this.isFillTransparent=C.isFillTransparent||!1,this.fillOpacity=C.fillOpacity||1,this.font=C.font||"10px sans-serif",this.textBaseline=C.textBaseline||"alphabetic",this.textAlign=C.textAlign||"left",this.lineWidth=C.lineWidth||1,this.lineJoin=C.lineJoin||"miter",this.lineCap=C.lineCap||"butt",this.path=C.path||[],this.transform=C.transform!==void 0?C.transform.clone():new l,this.globalCompositeOperation=C.globalCompositeOperation||"normal",this.globalAlpha=C.globalAlpha||1,this.clip_path=C.clip_path||[],this.currentPoint=C.currentPoint||new i,this.miterLimit=C.miterLimit||10,this.lastPoint=C.lastPoint||new i,this.lineDashOffset=C.lineDashOffset||0,this.lineDash=C.lineDash||[],this.margin=C.margin||[0,0,0,0],this.prevPageLastElemOffset=C.prevPageLastElemOffset||0,this.ignoreClearRect=typeof C.ignoreClearRect!="boolean"||C.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,u=new d}]);var f=function(C){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=C;Object.defineProperty(this,"pdf",{get:function(){return R}});var B=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return B},set:function(X){B=!!X}});var O=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return O},set:function(X){O=!!X}});var Y=0;Object.defineProperty(this,"posX",{get:function(){return Y},set:function(X){isNaN(X)||(Y=X)}});var ie=0;Object.defineProperty(this,"posY",{get:function(){return ie},set:function(X){isNaN(X)||(ie=X)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(X){var Oe;typeof X=="number"?Oe=[X,X,X,X]:((Oe=new Array(4))[0]=X[0],Oe[1]=X.length>=2?X[1]:Oe[0],Oe[2]=X.length>=3?X[2]:Oe[0],Oe[3]=X.length>=4?X[3]:Oe[1]),u.margin=Oe}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(X){me=X}});var ge=0;Object.defineProperty(this,"lastBreak",{get:function(){return ge},set:function(X){ge=X}});var xe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return xe},set:function(X){xe=X}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(X){X instanceof d&&(u=X)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(X){u.path=X}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(X){Le=X}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(X){var Oe;Oe=p(X),this.ctx.fillStyle=Oe.style,this.ctx.isFillTransparent=Oe.a===0,this.ctx.fillOpacity=Oe.a,this.pdf.setFillColor(Oe.r,Oe.g,Oe.b,{a:Oe.a}),this.pdf.setTextColor(Oe.r,Oe.g,Oe.b,{a:Oe.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(X){var Oe=p(X);this.ctx.strokeStyle=Oe.style,this.ctx.isStrokeTransparent=Oe.a===0,this.ctx.strokeOpacity=Oe.a,Oe.a===0?this.pdf.setDrawColor(255,255,255):(Oe.a,this.pdf.setDrawColor(Oe.r,Oe.g,Oe.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(X){["butt","round","square"].indexOf(X)!==-1&&(this.ctx.lineCap=X,this.pdf.setLineCap(X))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(X){isNaN(X)||(this.ctx.lineWidth=X,this.pdf.setLineWidth(X))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(X){["bevel","round","miter"].indexOf(X)!==-1&&(this.ctx.lineJoin=X,this.pdf.setLineJoin(X))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(X){isNaN(X)||(this.ctx.miterLimit=X,this.pdf.setMiterLimit(X))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(X){this.ctx.textBaseline=X}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(X){["right","end","center","left","start"].indexOf(X)!==-1&&(this.ctx.textAlign=X)}});var z=null,Re=null,Fe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Fe},set:function(X){z=null,Re=null,Fe=X}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(X){var Oe;if(this.ctx.font=X,(Oe=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(X))!==null){var Me=Oe[1];Oe[2];var st=Oe[3],Ue=Oe[4];Oe[5];var xt=Oe[6],tt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ue)[2];Ue=Math.floor(tt==="px"?parseFloat(Ue)*this.pdf.internal.scaleFactor:tt==="em"?parseFloat(Ue)*this.pdf.getFontSize():parseFloat(Ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ue);var gt=function(ot){var ir,Ft,Ot=[],qt=ot.trim();if(qt==="")return Hv;if(qt in U_)return[U_[qt]];for(;qt!=="";){switch(Ft=null,ir=(qt=z_(qt)).charAt(0)){case'"':case"'":Ft=fee(qt.substring(1),ir);break;default:Ft=hee(qt)}if(Ft===null||(Ot.push(Ft[0]),(qt=z_(Ft[1]))!==""&&qt.charAt(0)!==","))return Hv;qt=qt.replace(/^,/,"")}return Ot}(xt);if(this.fontFaces){var ct=function(ot,ir){var Ft=ot.getFontList(),Ot=JSON.stringify(Ft);if(z===null||Re!==Ot){var qt=function(Ne){var Ie=[];return Object.keys(Ne).forEach(function(Ge){Ne[Ge].forEach(function(He){var Be=null;switch(He){case"bold":Be={family:Ge,weight:"bold"};break;case"italic":Be={family:Ge,style:"italic"};break;case"bolditalic":Be={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Be={family:Ge}}Be!==null&&(Be.ref={name:Ge,style:He},Ie.push(Be))})}),Ie}(Ft);z=function(Ne){for(var Ie={},Ge=0;Ge<Ne.length;++Ge){var He=zv(Ne[Ge]),Be=He.family,$e=He.stretch,ft=He.style,Ye=He.weight;Ie[Be]=Ie[Be]||{},Ie[Be][$e]=Ie[Be][$e]||{},Ie[Be][$e][ft]=Ie[Be][$e][ft]||{},Ie[Be][$e][ft][Ye]=He}return Ie}(qt.concat(ir)),Re=Ot}return z}(this.pdf,this.fontFaces),Mt=gt.map(function(ot){return{family:ot,stretch:"normal",weight:st,style:Me}}),It=function(ot,ir,Ft){for(var Ot=(Ft=Ft||{}).defaultFontFamily||"times",qt=Object.assign({},dee,Ft.genericFontFamilies||{}),Ne=null,Ie=null,Ge=0;Ge<ir.length;++Ge)if(qt[(Ne=zv(ir[Ge])).family]&&(Ne.family=qt[Ne.family]),ot.hasOwnProperty(Ne.family)){Ie=ot[Ne.family];break}if(!(Ie=Ie||ot[Ot]))throw new Error("Could not find a font-family for the rule '"+$_(Ne)+"' and default family '"+Ot+"'.");if(Ie=function(He,Be){if(Be[He])return Be[He];var $e=i5[He],ft=$e<=i5.normal?-1:1,Ye=B_(Be,_P,$e,ft);if(!Ye)throw new Error("Could not find a matching font-stretch value for "+He);return Ye}(Ne.stretch,Ie),Ie=function(He,Be){if(Be[He])return Be[He];for(var $e=kP[He],ft=0;ft<$e.length;++ft)if(Be[$e[ft]])return Be[$e[ft]];throw new Error("Could not find a matching font-style for "+He)}(Ne.style,Ie),!(Ie=function(He,Be){if(Be[He])return Be[He];if(He===400&&Be[500])return Be[500];if(He===500&&Be[400])return Be[400];var $e=uee[He],ft=B_(Be,EP,$e,He<400?-1:1);if(!ft)throw new Error("Could not find a matching font-weight for value "+He);return ft}(Ne.weight,Ie)))throw new Error("Failed to resolve a font for the rule '"+$_(Ne)+"'.");return Ie}(ct,Mt);this.pdf.setFont(It.ref.name,It.ref.style)}else{var Pt="";(st==="bold"||parseInt(st,10)>=700||Me==="bold")&&(Pt="bold"),Me==="italic"&&(Pt+="italic"),Pt.length===0&&(Pt="normal");for(var Jt="",Lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},pt=0;pt<gt.length;pt++){if(this.pdf.internal.getFont(gt[pt],Pt,{noFallback:!0,disableWarning:!0})!==void 0){Jt=gt[pt];break}if(Pt==="bolditalic"&&this.pdf.internal.getFont(gt[pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Jt=gt[pt],Pt="bold";else if(this.pdf.internal.getFont(gt[pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Jt=gt[pt],Pt="normal";break}}if(Jt===""){for(var it=0;it<gt.length;it++)if(Lt[gt[it]]){Jt=Lt[gt[it]];break}}Jt=Jt===""?"Times":Jt,this.pdf.setFont(Jt,Pt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(X){this.ctx.globalCompositeOperation=X}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(X){this.ctx.globalAlpha=X}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(X){this.ctx.lineDashOffset=X,pe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(X){this.ctx.lineDash=X,pe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(X){this.ctx.ignoreClearRect=!!X}})};f.prototype.setLineDash=function(C){this.lineDash=C},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){N.call(this,"fill",!1)},f.prototype.stroke=function(){N.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(C,R){if(isNaN(C)||isNaN(R))throw Rr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var B=this.ctx.transform.applyToPoint(new i(C,R));this.path.push({type:"mt",x:B.x,y:B.y}),this.ctx.lastPoint=new i(C,R)},f.prototype.closePath=function(){var C=new i(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&Ar(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){C=new i(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(C.x,C.y)},f.prototype.lineTo=function(C,R){if(isNaN(C)||isNaN(R))throw Rr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var B=this.ctx.transform.applyToPoint(new i(C,R));this.path.push({type:"lt",x:B.x,y:B.y}),this.ctx.lastPoint=new i(B.x,B.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},f.prototype.quadraticCurveTo=function(C,R,B,O){if(isNaN(B)||isNaN(O)||isNaN(C)||isNaN(R))throw Rr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var Y=this.ctx.transform.applyToPoint(new i(B,O)),ie=this.ctx.transform.applyToPoint(new i(C,R));this.path.push({type:"qct",x1:ie.x,y1:ie.y,x:Y.x,y:Y.y}),this.ctx.lastPoint=new i(Y.x,Y.y)},f.prototype.bezierCurveTo=function(C,R,B,O,Y,ie){if(isNaN(Y)||isNaN(ie)||isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O))throw Rr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new i(Y,ie)),ge=this.ctx.transform.applyToPoint(new i(C,R)),xe=this.ctx.transform.applyToPoint(new i(B,O));this.path.push({type:"bct",x1:ge.x,y1:ge.y,x2:xe.x,y2:xe.y,x:me.x,y:me.y}),this.ctx.lastPoint=new i(me.x,me.y)},f.prototype.arc=function(C,R,B,O,Y,ie){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O)||isNaN(Y))throw Rr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ie=!!ie,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new i(C,R));C=me.x,R=me.y;var ge=this.ctx.transform.applyToPoint(new i(0,B)),xe=this.ctx.transform.applyToPoint(new i(0,0));B=Math.sqrt(Math.pow(ge.x-xe.x,2)+Math.pow(ge.y-xe.y,2))}Math.abs(Y-O)>=2*Math.PI&&(O=0,Y=2*Math.PI),this.path.push({type:"arc",x:C,y:R,radius:B,startAngle:O,endAngle:Y,counterclockwise:ie})},f.prototype.arcTo=function(C,R,B,O,Y){throw new Error("arcTo not implemented.")},f.prototype.rect=function(C,R,B,O){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O))throw Rr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(C,R),this.lineTo(C+B,R),this.lineTo(C+B,R+O),this.lineTo(C,R+O),this.lineTo(C,R),this.lineTo(C+B,R),this.lineTo(C,R)},f.prototype.fillRect=function(C,R,B,O){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O))throw Rr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var Y={};this.lineCap!=="butt"&&(Y.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(Y.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(C,R,B,O),this.fill(),Y.hasOwnProperty("lineCap")&&(this.lineCap=Y.lineCap),Y.hasOwnProperty("lineJoin")&&(this.lineJoin=Y.lineJoin)}},f.prototype.strokeRect=function(C,R,B,O){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O))throw Rr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(C,R,B,O),this.stroke())},f.prototype.clearRect=function(C,R,B,O){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O))throw Rr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(C,R,B,O))},f.prototype.save=function(C){C=typeof C!="boolean"||C;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),C){this.ctx.fontSize=this.pdf.internal.getFontSize();var O=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=O}},f.prototype.restore=function(C){C=typeof C!="boolean"||C;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,B=0;B<this.pdf.internal.getNumberOfPages();B++)this.pdf.setPage(B+1),this.pdf.internal.out("Q");this.pdf.setPage(R),C&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(C){var R,B,O,Y;if(C.isCanvasGradient===!0&&(C=C.getColor()),!C)return{r:0,g:0,b:0,a:0,style:C};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(C))R=0,B=0,O=0,Y=0;else{var ie=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(C);if(ie!==null)R=parseInt(ie[1]),B=parseInt(ie[2]),O=parseInt(ie[3]),Y=1;else if((ie=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(C))!==null)R=parseInt(ie[1]),B=parseInt(ie[2]),O=parseInt(ie[3]),Y=parseFloat(ie[4]);else{if(Y=1,typeof C=="string"&&C.charAt(0)!=="#"){var me=new xP(C);C=me.ok?me.toHex():"#000000"}C.length===4?(R=C.substring(1,2),R+=R,B=C.substring(2,3),B+=B,O=C.substring(3,4),O+=O):(R=C.substring(1,3),B=C.substring(3,5),O=C.substring(5,7)),R=parseInt(R,16),B=parseInt(B,16),O=parseInt(O,16)}}return{r:R,g:B,b:O,a:Y,style:C}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(C,R,B,O){if(isNaN(R)||isNaN(B)||typeof C!="string")throw Rr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(O=isNaN(O)?void 0:O,!h.call(this)){var Y=re(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;L.call(this,{text:C,x:R,y:B,scale:ie,angle:Y,align:this.textAlign,maxWidth:O})}},f.prototype.strokeText=function(C,R,B,O){if(isNaN(R)||isNaN(B)||typeof C!="string")throw Rr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){O=isNaN(O)?void 0:O;var Y=re(this.ctx.transform.rotation),ie=this.ctx.transform.scaleX;L.call(this,{text:C,x:R,y:B,scale:ie,renderingMode:"stroke",angle:Y,align:this.textAlign,maxWidth:O})}},f.prototype.measureText=function(C){if(typeof C!="string")throw Rr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,B=this.pdf.internal.scaleFactor,O=R.internal.getFontSize(),Y=R.getStringUnitWidth(C)*O/R.internal.scaleFactor;return new function(ie){var me=(ie=ie||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:Y*=Math.round(96*B/72*1e4)/1e4})},f.prototype.scale=function(C,R){if(isNaN(C)||isNaN(R))throw Rr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var B=new l(C,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.rotate=function(C){if(isNaN(C))throw Rr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new l(Math.cos(C),Math.sin(C),-Math.sin(C),Math.cos(C),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},f.prototype.translate=function(C,R){if(isNaN(C)||isNaN(R))throw Rr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var B=new l(1,0,0,1,C,R);this.ctx.transform=this.ctx.transform.multiply(B)},f.prototype.transform=function(C,R,B,O,Y,ie){if(isNaN(C)||isNaN(R)||isNaN(B)||isNaN(O)||isNaN(Y)||isNaN(ie))throw Rr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new l(C,R,B,O,Y,ie);this.ctx.transform=this.ctx.transform.multiply(me)},f.prototype.setTransform=function(C,R,B,O,Y,ie){C=isNaN(C)?1:C,R=isNaN(R)?0:R,B=isNaN(B)?0:B,O=isNaN(O)?1:O,Y=isNaN(Y)?0:Y,ie=isNaN(ie)?0:ie,this.ctx.transform=new l(C,R,B,O,Y,ie)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(C,R,B,O,Y,ie,me,ge,xe){var Le=this.pdf.getImageProperties(C),z=1,Re=1,Fe=1,X=1;O!==void 0&&ge!==void 0&&(Fe=ge/O,X=xe/Y,z=Le.width/O*ge/O,Re=Le.height/Y*xe/Y),ie===void 0&&(ie=R,me=B,R=0,B=0),O!==void 0&&ge===void 0&&(ge=O,xe=Y),O===void 0&&ge===void 0&&(ge=Le.width,xe=Le.height);var Oe=this.ctx.transform.decompose(),Me=re(Oe.rotate.shx),st=new l,Ue=(st=(st=(st=st.multiply(Oe.translate)).multiply(Oe.skew)).multiply(Oe.scale)).applyToRectangle(new o(ie-R*Fe,me-B*X,O*z,Y*Re));if(this.autoPaging){for(var xt,tt=y.call(this,Ue),gt=[],ct=0;ct<tt.length;ct+=1)gt.indexOf(tt[ct])===-1&&gt.push(tt[ct]);b(gt);for(var Mt=gt[0],It=gt[gt.length-1],Pt=Mt;Pt<It+1;Pt++){this.pdf.setPage(Pt);var Jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=Pt===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],it=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ot=Pt===1?0:pt+(Pt-2)*it;if(this.ctx.clip_path.length!==0){var ir=this.path;xt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(xt,this.posX+this.margin[3],-ot+Lt+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=ir}var Ft=JSON.parse(JSON.stringify(Ue));Ft=w([Ft],this.posX+this.margin[3],-ot+Lt+this.ctx.prevPageLastElemOffset)[0];var Ot=(Pt>Mt||Pt<It)&&g.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Jt,it,null).clip().discardPath()),this.pdf.addImage(C,"JPEG",Ft.x,Ft.y,Ft.w,Ft.h,null,null,Me),Ot&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(C,"JPEG",Ue.x,Ue.y,Ue.w,Ue.h,null,null,Me)};var y=function(C,R,B){var O=[];R=R||this.pdf.internal.pageSize.width,B=B||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var Y=this.posY+this.ctx.prevPageLastElemOffset;switch(C.type){default:case"mt":case"lt":O.push(Math.floor((C.y+Y)/B)+1);break;case"arc":O.push(Math.floor((C.y+Y-C.radius)/B)+1),O.push(Math.floor((C.y+Y+C.radius)/B)+1);break;case"qct":var ie=U(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x,C.y);O.push(Math.floor((ie.y+Y)/B)+1),O.push(Math.floor((ie.y+ie.h+Y)/B)+1);break;case"bct":var me=ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,C.x1,C.y1,C.x2,C.y2,C.x,C.y);O.push(Math.floor((me.y+Y)/B)+1),O.push(Math.floor((me.y+me.h+Y)/B)+1);break;case"rect":O.push(Math.floor((C.y+Y)/B)+1),O.push(Math.floor((C.y+C.h+Y)/B)+1)}for(var ge=0;ge<O.length;ge+=1)for(;this.pdf.internal.getNumberOfPages()<O[ge];)x.call(this);return O},x=function(){var C=this.fillStyle,R=this.strokeStyle,B=this.font,O=this.lineCap,Y=this.lineWidth,ie=this.lineJoin;this.pdf.addPage(),this.fillStyle=C,this.strokeStyle=R,this.font=B,this.lineCap=O,this.lineWidth=Y,this.lineJoin=ie},w=function(C,R,B){for(var O=0;O<C.length;O++)switch(C[O].type){case"bct":C[O].x2+=R,C[O].y2+=B;case"qct":C[O].x1+=R,C[O].y1+=B;default:C[O].x+=R,C[O].y+=B}return C},b=function(C){return C.sort(function(R,B){return R-B})},N=function(C,R){var B=this.fillStyle,O=this.strokeStyle,Y=this.lineCap,ie=this.lineWidth,me=Math.abs(ie*this.ctx.transform.scaleX),ge=this.lineJoin;if(this.autoPaging){for(var xe,Le,z=JSON.parse(JSON.stringify(this.path)),Re=JSON.parse(JSON.stringify(this.path)),Fe=[],X=0;X<Re.length;X++)if(Re[X].x!==void 0)for(var Oe=y.call(this,Re[X]),Me=0;Me<Oe.length;Me+=1)Fe.indexOf(Oe[Me])===-1&&Fe.push(Oe[Me]);for(var st=0;st<Fe.length;st++)for(;this.pdf.internal.getNumberOfPages()<Fe[st];)x.call(this);b(Fe);for(var Ue=Fe[0],xt=Fe[Fe.length-1],tt=Ue;tt<xt+1;tt++){this.pdf.setPage(tt),this.fillStyle=B,this.strokeStyle=O,this.lineCap=Y,this.lineWidth=me,this.lineJoin=ge;var gt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=tt===1?this.posY+this.margin[0]:this.margin[0],Mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],It=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Pt=tt===1?0:Mt+(tt-2)*It;if(this.ctx.clip_path.length!==0){var Jt=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(xe,this.posX+this.margin[3],-Pt+ct+this.ctx.prevPageLastElemOffset),A.call(this,C,!0),this.path=Jt}if(Le=JSON.parse(JSON.stringify(z)),this.path=w(Le,this.posX+this.margin[3],-Pt+ct+this.ctx.prevPageLastElemOffset),R===!1||tt===0){var Lt=(tt>Ue||tt<xt)&&g.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gt,It,null).clip().discardPath()),A.call(this,C,R),Lt&&this.pdf.restoreGraphicsState()}this.lineWidth=ie}this.path=z}else this.lineWidth=me,A.call(this,C,R),this.lineWidth=ie},A=function(C,R){if((C!=="stroke"||R||!m.call(this))&&(C==="stroke"||R||!h.call(this))){for(var B,O,Y=[],ie=this.path,me=0;me<ie.length;me++){var ge=ie[me];switch(ge.type){case"begin":Y.push({begin:!0});break;case"close":Y.push({close:!0});break;case"mt":Y.push({start:ge,deltas:[],abs:[]});break;case"lt":var xe=Y.length;if(ie[me-1]&&!isNaN(ie[me-1].x)&&(B=[ge.x-ie[me-1].x,ge.y-ie[me-1].y],xe>0)){for(;xe>=0;xe--)if(Y[xe-1].close!==!0&&Y[xe-1].begin!==!0){Y[xe-1].deltas.push(B),Y[xe-1].abs.push(ge);break}}break;case"bct":B=[ge.x1-ie[me-1].x,ge.y1-ie[me-1].y,ge.x2-ie[me-1].x,ge.y2-ie[me-1].y,ge.x-ie[me-1].x,ge.y-ie[me-1].y],Y[Y.length-1].deltas.push(B);break;case"qct":var Le=ie[me-1].x+2/3*(ge.x1-ie[me-1].x),z=ie[me-1].y+2/3*(ge.y1-ie[me-1].y),Re=ge.x+2/3*(ge.x1-ge.x),Fe=ge.y+2/3*(ge.y1-ge.y),X=ge.x,Oe=ge.y;B=[Le-ie[me-1].x,z-ie[me-1].y,Re-ie[me-1].x,Fe-ie[me-1].y,X-ie[me-1].x,Oe-ie[me-1].y],Y[Y.length-1].deltas.push(B);break;case"arc":Y.push({deltas:[],abs:[],arc:!0}),Array.isArray(Y[Y.length-1].abs)&&Y[Y.length-1].abs.push(ge)}}O=R?null:C==="stroke"?"stroke":"fill";for(var Me=!1,st=0;st<Y.length;st++)if(Y[st].arc)for(var Ue=Y[st].abs,xt=0;xt<Ue.length;xt++){var tt=Ue[xt];tt.type==="arc"?D.call(this,tt.x,tt.y,tt.radius,tt.startAngle,tt.endAngle,tt.counterclockwise,void 0,R,!Me):M.call(this,tt.x,tt.y),Me=!0}else if(Y[st].close===!0)this.pdf.internal.out("h"),Me=!1;else if(Y[st].begin!==!0){var gt=Y[st].start.x,ct=Y[st].start.y;K.call(this,Y[st].deltas,gt,ct),Me=!0}O&&E.call(this,O),R&&I.call(this)}},P=function(C){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,B=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return C-B;case"top":return C+R-B;case"hanging":return C+R-2*B;case"middle":return C+R/2-B;default:return C}},j=function(C){return C+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var C=function(){};return C.colorStops=[],C.addColorStop=function(R,B){this.colorStops.push([R,B])},C.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},C.isCanvasGradient=!0,C},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var D=function(C,R,B,O,Y,ie,me,ge,xe){for(var Le=ae.call(this,B,O,Y,ie),z=0;z<Le.length;z++){var Re=Le[z];z===0&&(xe?_.call(this,Re.x1+C,Re.y1+R):M.call(this,Re.x1+C,Re.y1+R)),Z.call(this,C,R,Re.x2,Re.y2,Re.x3,Re.y3,Re.x4,Re.y4)}ge?I.call(this):E.call(this,me)},E=function(C){switch(C){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},I=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(C,R){this.pdf.internal.out(r(C)+" "+n(R)+" m")},L=function(C){var R;switch(C.align){case"right":case"end":R="right";break;case"center":R="center";break;default:R="left"}var B,O,Y,ie=this.pdf.getTextDimensions(C.text),me=P.call(this,C.y),ge=j.call(this,me)-ie.h,xe=this.ctx.transform.applyToPoint(new i(C.x,me));if(this.autoPaging){var Le=this.ctx.transform.decompose(),z=new l;z=(z=(z=z.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var Re=this.ctx.transform.applyToRectangle(new o(C.x,me,ie.w,ie.h)),Fe=z.applyToRectangle(new o(C.x,ge,ie.w,ie.h)),X=y.call(this,Fe),Oe=[],Me=0;Me<X.length;Me+=1)Oe.indexOf(X[Me])===-1&&Oe.push(X[Me]);b(Oe);for(var st=Oe[0],Ue=Oe[Oe.length-1],xt=st;xt<Ue+1;xt++){this.pdf.setPage(xt);var tt=xt===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[2],Mt=ct-this.margin[0],It=this.pdf.internal.pageSize.width-this.margin[1],Pt=It-this.margin[3],Jt=xt===1?0:gt+(xt-2)*Mt;if(this.ctx.clip_path.length!==0){var Lt=this.path;B=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(B,this.posX+this.margin[3],-1*Jt+tt),A.call(this,"fill",!0),this.path=Lt}var pt=w([JSON.parse(JSON.stringify(Fe))],this.posX+this.margin[3],-Jt+tt+this.ctx.prevPageLastElemOffset)[0];C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),Y=this.lineWidth,this.lineWidth=Y*C.scale);var it=this.autoPaging!=="text";if(it||pt.y+pt.h<=ct){if(it||pt.y>=tt&&pt.x<=It){var ot=it?C.text:this.pdf.splitTextToSize(C.text,C.maxWidth||It-pt.x)[0],ir=w([JSON.parse(JSON.stringify(Re))],this.posX+this.margin[3],-Jt+tt+this.ctx.prevPageLastElemOffset)[0],Ft=it&&(xt>st||xt<Ue)&&g.call(this);Ft&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,Mt,null).clip().discardPath()),this.pdf.text(ot,ir.x,ir.y,{angle:C.angle,align:R,renderingMode:C.renderingMode}),Ft&&this.pdf.restoreGraphicsState()}}else pt.y<ct&&(this.ctx.prevPageLastElemOffset+=ct-pt.y);C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=Y)}}else C.scale>=.01&&(O=this.pdf.internal.getFontSize(),this.pdf.setFontSize(O*C.scale),Y=this.lineWidth,this.lineWidth=Y*C.scale),this.pdf.text(C.text,xe.x+this.posX,xe.y+this.posY,{angle:C.angle,align:R,renderingMode:C.renderingMode,maxWidth:C.maxWidth}),C.scale>=.01&&(this.pdf.setFontSize(O),this.lineWidth=Y)},M=function(C,R,B,O){B=B||0,O=O||0,this.pdf.internal.out(r(C+B)+" "+n(R+O)+" l")},K=function(C,R,B){return this.pdf.lines(C,R,B,null,null)},Z=function(C,R,B,O,Y,ie,me,ge){this.pdf.internal.out([t(s(B+C)),t(a(O+R)),t(s(Y+C)),t(a(ie+R)),t(s(me+C)),t(a(ge+R)),"c"].join(" "))},ae=function(C,R,B,O){for(var Y=2*Math.PI,ie=Math.PI/2;R>B;)R-=Y;var me=Math.abs(B-R);me<Y&&O&&(me=Y-me);for(var ge=[],xe=O?-1:1,Le=R;me>1e-5;){var z=Le+xe*Math.min(me,ie);ge.push(he.call(this,C,Le,z)),me-=Math.abs(z-Le),Le=z}return ge},he=function(C,R,B){var O=(B-R)/2,Y=C*Math.cos(O),ie=C*Math.sin(O),me=Y,ge=-ie,xe=me*me+ge*ge,Le=xe+me*Y+ge*ie,z=4/3*(Math.sqrt(2*xe*Le)-Le)/(me*ie-ge*Y),Re=me-z*ge,Fe=ge+z*me,X=Re,Oe=-Fe,Me=O+R,st=Math.cos(Me),Ue=Math.sin(Me);return{x1:C*Math.cos(R),y1:C*Math.sin(R),x2:Re*st-Fe*Ue,y2:Re*Ue+Fe*st,x3:X*st-Oe*Ue,y3:X*Ue+Oe*st,x4:C*Math.cos(B),y4:C*Math.sin(B)}},re=function(C){return 180*C/Math.PI},U=function(C,R,B,O,Y,ie){var me=C+.5*(B-C),ge=R+.5*(O-R),xe=Y+.5*(B-Y),Le=ie+.5*(O-ie),z=Math.min(C,Y,me,xe),Re=Math.max(C,Y,me,xe),Fe=Math.min(R,ie,ge,Le),X=Math.max(R,ie,ge,Le);return new o(z,Fe,Re-z,X-Fe)},ue=function(C,R,B,O,Y,ie,me,ge){var xe,Le,z,Re,Fe,X,Oe,Me,st,Ue,xt,tt,gt,ct,Mt=B-C,It=O-R,Pt=Y-B,Jt=ie-O,Lt=me-Y,pt=ge-ie;for(Le=0;Le<41;Le++)st=(Oe=(z=C+(xe=Le/40)*Mt)+xe*((Fe=B+xe*Pt)-z))+xe*(Fe+xe*(Y+xe*Lt-Fe)-Oe),Ue=(Me=(Re=R+xe*It)+xe*((X=O+xe*Jt)-Re))+xe*(X+xe*(ie+xe*pt-X)-Me),Le==0?(xt=st,tt=Ue,gt=st,ct=Ue):(xt=Math.min(xt,st),tt=Math.min(tt,Ue),gt=Math.max(gt,st),ct=Math.max(ct,Ue));return new o(Math.round(xt),Math.round(tt),Math.round(gt-xt),Math.round(ct-tt))},pe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var C,R,B=(C=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:C,lineDashOffset:R}));this.prevLineDash!==B&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=B)}}})(jt.API),function(e){var t=function(i){var o,l,u,d,f,p,h,m,g,y;for(l=[],u=0,d=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;d>u;u+=4)(f=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(p=(f=((f=((f=((f=(f-(y=f%85))/85)-(g=f%85))/85)-(m=f%85))/85)-(h=f%85))/85)%85,l.push(p+33,h+33,m+33,g+33,y+33)):l.push(122);return function(x,w){for(var b=w;b>0;b--)x.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,u,d,f,p=String,h="length",m=255,g="charCodeAt",y="slice",x="replace";for(i[y](-2),i=i[y](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),u=[],d=0,f=(i+=o="uuuuu"[y](i[h]%5||5))[h];f>d;d+=5)l=52200625*(i[g](d)-33)+614125*(i[g](d+1)-33)+7225*(i[g](d+2)-33)+85*(i[g](d+3)-33)+(i[g](d+4)-33),u.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(w,b){for(var N=b;N>0;N--)w.pop()}(u,o[h]),p.fromCharCode.apply(p,u)},n=function(i){return i.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",u=0;u<i.length;u+=2)l+=String.fromCharCode("0x"+(i[u]+i[u+1]));return l},a=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return(o=Zw(o)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(i,o){var l=0,u=i||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(jt.API),function(e){e.loadFile=function(t,r,n){return function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=function(l,u,d){var f=new XMLHttpRequest,p=0,h=function(m){var g=m.length,y=[],x=String.fromCharCode;for(p=0;p<g;p+=1)y.push(x(255&m.charCodeAt(p)));return y.join("")};if(f.open("GET",l,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(s,a,i)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(jt.API),function(e){function t(){return(Ht.html2canvas?Promise.resolve(Ht.html2canvas):$g(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ht.DOMPurify?Promise.resolve(Ht.DOMPurify):$g(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=Ar(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(o,l){var u=document.createElement(o);for(var d in l.className&&(u.className=l.className),l.innerHTML&&l.dompurify&&(u.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)u.style[d]=l.style[d];return u},a=function o(l,u){for(var d=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),f=l.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(o(f,u));return l.nodeType===1&&(l.nodeName==="CANVAS"?(d.width=l.width,d.height=l.height,d.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(d.value=l.value),d.addEventListener("load",function(){d.scrollTop=l.scrollTop,d.scrollLeft=l.scrollLeft},!0)),d},i=function o(l){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),u);return(d=d.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),l){case"string":return this.then(r).then(function(u){return this.set({src:s("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,l(this.prop.container,u)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var m=d[h],g=m.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(u){if(u in i.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var u=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(u):u})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(o=o||jt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,u,d){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,u,d){return this.setProgress(o?this.progress.val+o:null,l||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},i.prototype.then=function(o,l){var u=this;return this.thenCore(o,l,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,d),p}).then(d,f).then(function(p){return u.updateProgress(1),p})})},i.prototype.thenCore=function(o,l,u){u=u||Promise.prototype.then;var d=this;o&&(o=o.bind(d)),l&&(l=l.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:i.convert(Object.assign({},d),Promise.prototype),p=u.call(f,o,l);return i.convert(p,d.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(u){l=l.thenCore(u)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,jt.getPageSize=function(o,l,u){if(Ar(o)==="object"){var d=o;o=d.orientation,l=d.unit||l,u=d.format||u}l=l||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var f,p=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+l}var m,g=0,y=0;if(h.hasOwnProperty(p))g=h[p][1]/f,y=h[p][0]/f;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",y>g&&(m=y,y=g,g=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:l,k:f,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(zv):null;var u=new i(l);return l.worker?u:u.from(o).doCallback()}}(jt.API),jt.API.addJS=function(e){return q_=e,this.internal.events.subscribe("postPutResources",function(){ug=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ug+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),H_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+q_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ug!==void 0&&H_!==void 0&&this.internal.out("/Names <</JavaScript "+ug+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],o=n.exec(i);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(a=0;a<u;a++){var f=r.internal.newObject();d.push(f);var p=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var l=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(jt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,a,i,o){var l,u=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,l=function(f){for(var p,h=256*f.charCodeAt(4)+f.charCodeAt(5),m=f.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=h,t.indexOf(f.charCodeAt(y+1))!==-1){p=256*f.charCodeAt(y+5)+f.charCodeAt(y+6),g={width:256*f.charCodeAt(y+7)+f.charCodeAt(y+8),height:p,numcomponents:f.charCodeAt(y+9)};break}h=256*f.charCodeAt(y+2)+f.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:s}}return d}}(jt.API),jt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,a=XZ(e,{checkCrc:!0}),i=a.width,o=a.height,l=a.channels,u=a.palette,d=a.depth;s=u&&l===1?function(D){for(var E=D.width,I=D.height,_=D.data,L=D.palette,M=D.depth,K=!1,Z=[],ae=[],he=void 0,re=!1,U=0,ue=0;ue<L.length;ue++){var pe=Gk(L[ue],4),C=pe[0],R=pe[1],B=pe[2],O=pe[3];Z.push(C,R,B),O!=null&&(O===0?(U++,ae.length<1&&ae.push(ue)):O<255&&(re=!0))}if(re||U>1){K=!0,ae=void 0;var Y=E*I;he=new Uint8Array(Y);for(var ie=new DataView(_.buffer),me=0;me<Y;me++){var ge=qv(ie,me,M),xe=Gk(L[ge],4)[3];he[me]=xe}}else U===0&&(ae=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:K?8:void 0,colorBytes:_,alphaBytes:he,needSMask:K,palette:Z,mask:ae}}(a):l===2||l===4?function(D){for(var E=D.data,I=D.width,_=D.height,L=D.channels,M=D.depth,K=L===2?"DeviceGray":"DeviceRGB",Z=L-1,ae=I*_,he=Z,re=ae*he,U=1*ae,ue=Math.ceil(re*M/8),pe=Math.ceil(U*M/8),C=new Uint8Array(ue),R=new Uint8Array(pe),B=new DataView(E.buffer),O=new DataView(C.buffer),Y=new DataView(R.buffer),ie=!1,me=0;me<ae;me++){for(var ge=me*L,xe=0;xe<he;xe++)Z_(O,qv(B,ge+xe,M),me*he+xe,M);var Le=qv(B,ge+he,M);Le<(1<<M)-1&&(ie=!0),Z_(Y,Le,1*me,M)}return{colorSpace:K,colorsPerPixel:Z,sMaskBitsPerComponent:ie?M:void 0,colorBytes:C,alphaBytes:R,needSMask:ie}}(a):function(D){var E=D.data,I=D.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:I,colorsPerPixel:I==="DeviceGray"?1:3,colorBytes:E instanceof Uint16Array?function(_){for(var L=_.length,M=new Uint8Array(2*L),K=new DataView(M.buffer,M.byteOffset,M.byteLength),Z=0;Z<L;Z++)K.setUint16(2*Z,_[Z],!1);return M}(E):E,needSMask:!1}}(a);var f,p,h,m=s,g=m.colorSpace,y=m.colorsPerPixel,x=m.sMaskBitsPerComponent,w=m.colorBytes,b=m.alphaBytes,N=m.needSMask,A=m.palette,P=m.mask,j=null;return n!==jt.API.image_compression.NONE&&typeof Zw=="function"?(j=function(D){var E;switch(D){case jt.API.image_compression.FAST:E=11;break;case jt.API.image_compression.MEDIUM:E=13;break;case jt.API.image_compression.SLOW:E=14;break;default:E=12}return E}(n),f=this.decode.FLATE_DECODE,p="/Predictor ".concat(j," /Colors ").concat(y," /BitsPerComponent ").concat(d," /Columns ").concat(i),e=G_(w,Math.ceil(i*y*d/8),y,d,n),N&&(h=G_(b,Math.ceil(i*x/8),1,x,n))):(f=void 0,p=void 0,e=w,N&&(h=b)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:f,decodeParameters:p,transparency:P,palette:A,sMask:h,predictor:j,width:i,height:o,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var a=new xee(t),i=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:i,height:o},d=new Wv(100).encode(u,100);return e.processJPEG.call(this,d,r,n,s)},e.processGIF87A=e.processGIF89A}(jt.API),yi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},yi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Rr.log("bit decode error:"+r)}},yi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}r!==0&&(this.pos+=4-r)}},yi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,o=a>>4,l=15&a,u=this.palette[o];if(this.data[i]=u.blue,this.data[i+1]=u.green,this.data[i+2]=u.red,this.data[i+3]=255,2*s+1>=this.width)break;u=this.palette[l],this.data[i+4]=u.blue,this.data[i+4+1]=u.green,this.data[i+4+2]=u.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},yi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},yi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,u=a>>15?255:0,d=n*this.width*4+4*s;this.data[d]=l,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=u}this.pos+=e}},yi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&r)/r*255|0,u=(i>>11)/t*255|0,d=s*this.width*4+4*a;this.data[d]=u,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},yi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},yi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=i}},yi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var a=new yi(t,!1),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},u=new Wv(100).encode(l,100);return e.processJPEG.call(this,u,r,n,s)}}(jt.API),tE.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var a=new tE(t),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},u=new Wv(100).encode(l,100);return e.processJPEG.call(this,u,r,n,s)}}(jt.API),jt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),o=0,l=0,u=0;u<s;u+=4){var d=n[u],f=n[u+1],p=n[u+2],h=n[u+3];a[o++]=d,a[o++]=f,a[o++]=p,i[l++]=h}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},jt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},kd=jt.API,dg=kd.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:s.metadata.Unicode.widths,l=o.fof?o.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,p=0,h=e.length,m=0,g=o[0]||l,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(p=f&&Ar(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/d:0,y.push((o[n]||g)/l+p)),m=n;return y},W_=kd.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return kd.processArabic&&(e=kd.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:dg.apply(this,arguments).reduce(function(a,i){return a+i},0)},V_=function(e,t,r,n){for(var s=[],a=0,i=e.length,o=0;a!==i&&o+t[a]<r;)o+=t[a],a++;s.push(e.slice(0,a));var l=a;for(o=0;a!==i;)o+t[a]>n&&(s.push(e.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&s.push(e.slice(l,a)),s},K_=function(e,t,r){r||(r={});var n,s,a,i,o,l,u,d=[],f=[d],p=r.textIndent||0,h=0,m=0,g=e.split(" "),y=dg.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),w=[];g.map(function(N){(N=N.split(/\s*\n/)).length>1?w=w.concat(N.map(function(A,P){return(P&&A.length?`
`:"")+A})):w.push(N[0])}),g=w,l=W_.apply(this,[x,r])}for(a=0,i=g.length;a<i;a++){var b=0;if(n=g[a],l&&n[0]==`
`&&(n=n.substr(1),b=1),p+h+(m=(s=dg.apply(this,[n,r])).reduce(function(N,A){return N+A},0))>t||b){if(m>t){for(o=V_.apply(this,[n,s,t-(p+h),t]),d.push(o.shift()),d=[o.pop()];o.length;)f.push([o.shift()]);m=s.slice(n.length-(d[0]?d[0].length:0)).reduce(function(N,A){return N+A},0)}else d=[n];f.push(d),p=m+l,h=y}else d.push(n),p+=h+m,h=y}return u=l?function(N,A){return(A?x:"")+N.join(" ")}:function(N){return N.join(" ")},f.map(u)},kd.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),p="Unicode";return f.metadata[p]?{widths:f.metadata[p].widths||{0:1},kerning:f.metadata[p].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=n.length;o<l;o++)u=u.concat(K_.apply(this,[n[o],i,a]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=t[a],s[t[a]]=r[a];var i=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var h,m,g,y,x=["{"];for(var w in p){if(h=p[w],isNaN(parseInt(w,10))?m="'"+w+"'":(w=parseInt(w,10),m=(m=i(w).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(g=i(h).slice(3),y="-"):(g=i(h).slice(2),y=""),g=y+g.slice(0,-1)+s[g.slice(-1)];else{if(Ar(h)!=="object")throw new Error("Don't know what to do with value type "+Ar(h)+".");g=o(h)}x.push(m+g)}return x.push("}"),x.join("")},l=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,g,y,x={},w=1,b=x,N=[],A="",P="",j=p.length-1,D=1;D<j;D+=1)(y=p[D])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(N.push([b,g]),b={},g=void 0):y=="}"?((m=N.pop())[0][m[1]]=b,g=void 0,b=m[0]):y=="-"?w=-1:g===void 0?n.hasOwnProperty(y)?(A+=n[y],g=parseInt(A,16)*w,w=1,A=""):A+=y:n.hasOwnProperty(y)?(P+=n[y],b[g]=parseInt(P,16)*w,w=1,g=void 0,P=""):P+=y;return x},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var h=p.font,m=f.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var g=d.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(jt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Hg(o)),i.metadata=e.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(jt),jt.API.addSvgAsImage=function(e,t,r,n,s,a,i,o){if(isNaN(t)||isNaN(r))throw Rr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Rr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=s;var u=l.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,l.width,l.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(Ht.canvg?Promise.resolve(Ht.canvg):$g(()=>import("./index.es-CQdQDK-g.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(d)}).then(function(){f.addImage(l.toDataURL("image/jpeg",1),t,r,n,s,i,o)})},jt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},jt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],u=0,d=0,f=0;function p(m,g){var y,x=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)r[o[f]].value=r[o[f]].defaultValue,r[o[f]].explicitSet=!1}if(Ar(e)==="object"){for(s in e)if(a=e[s],p(o,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&p(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")l.push(String(a[u]-1));else if(a[u].length>1){for(d=0;d<a[u].length;d+=1)typeof a[u][d]!="number"&&(n=!1);n===!0&&l.push([a[u][0]-1,a[u][1]-1].join(" "))}r[s].value="["+l.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+i.length+o.length+s.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(jt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,i){for(var o,l=i.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,p=a.length;f<p;++f){if(o=i.metadata.characterToGlyph(a.charCodeAt(f)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=a.charCodeAt(f),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(u[4-o.length],o)}return d.join("")},n=function(a){var i,o,l,u,d,f,p;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],f=0,p=(o=Object.keys(a).sort(function(h,m){return h-m})).length;f<p;f++)i=o[f],l.length>=100&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(u=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),l.push("<"+i+"><"+u+">"));return l.length&&(d+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,u=i.newObject,d=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",m=0;m<p.length;m++)h+=String.fromCharCode(p[m]);var g=u();d({data:h,addLength1:!0,objectId:g}),l("endobj");var y=u();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var x=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ld(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var w=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ld(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+e.API.PDFObject.convert(f)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+y+" 0 R"),l("/BaseFont /"+Ld(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,u=i.newObject,d=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,p="",h=0;h<f.length;h++)p+=String.fromCharCode(f[h]);var m=u();d({data:p,addLength1:!0,objectId:m}),l("endobj");var g=u();d({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var y=u();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+m+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Ld(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=u();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Ld(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,o=a.text||"",l=a.x,u=a.y,d=a.options||{},f=a.mutex||{},p=f.pdfEscape,h=f.activeFontKey,m=f.fonts,g=h,y="",x=0,w="",b=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:o,x:l,y:u,options:d,mutex:f};for(w=o,g=h,Array.isArray(o)&&(w=o[0]),x=0;x<w.length;x+=1)m[g].metadata.hasOwnProperty("cmap")&&(i=m[g].metadata.cmap.unicode.codeMap[w[x].charCodeAt(0)]),i||w[x].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=w[x]:y+="";var N="";return parseInt(g.slice(1))<14||b==="WinAnsiEncoding"?N=p(y,g).split("").map(function(A){return A.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(N=r(y,m[g])),f.isHex=!0,{text:N,x:l,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(a){var i=a.text||"",o=[],l={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var u=0;for(u=0;u<i.length;u+=1)Array.isArray(i[u])&&i[u].length===3?o.push([s(Object.assign({},l,{text:i[u][0]})).text,i[u][1],i[u][2]]):o.push(s(Object.assign({},l,{text:i[u]})).text);a.text=o}else a.text=s(Object.assign({},l,{text:i})).text}])}(jt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(jt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,a,i,o,l,u,d,f=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,b=0;this.__bidiEngine__={};var N=function(_){var L=_.charCodeAt(),M=L>>8,K=g[M];return K!==void 0?f[256*K+(255&L)]:M===252||M===253?"AL":x.test(M)?"L":M===8?"R":"N"},A=function(_){for(var L,M=0;M<_.length;M++){if((L=N(_.charAt(M)))==="L")return!1;if(L==="R")return!0}return!1},P=function(_,L,M,K){var Z,ae,he,re,U=L[K];switch(U){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"N":case"AN":break;case"EN":w&&(U="AN");break;case"AL":w=!0,U="R";break;case"WS":case"BN":U="N";break;case"CS":K<1||K+1>=L.length||(Z=M[K-1])!=="EN"&&Z!=="AN"||(ae=L[K+1])!=="EN"&&ae!=="AN"?U="N":w&&(ae="AN"),U=ae===Z?ae:"N";break;case"ES":U=(Z=K>0?M[K-1]:"B")==="EN"&&K+1<L.length&&L[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&M[K-1]==="EN"){U="EN";break}if(w){U="N";break}for(he=K+1,re=L.length;he<re&&L[he]==="ET";)he++;U=he<re&&L[he]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(re=L.length,he=K+1;he<re&&L[he]==="NSM";)he++;if(he<re){var ue=_[K],pe=ue>=1425&&ue<=2303||ue===64286;if(Z=L[he],pe&&(Z==="R"||Z==="AL")){U="R";break}}}U=K<1||(Z=L[K-1])==="B"?"N":M[K-1];break;case"B":w=!1,s=!0,U=b;break;case"S":a=!0,U="N"}return U},j=function(_,L,M){var K=_.split("");return M&&D(K,M,{hiLevel:b}),K.reverse(),L&&L.reverse(),K.join("")},D=function(_,L,M){var K,Z,ae,he,re,U=-1,ue=_.length,pe=0,C=[],R=b?h:p,B=[];for(w=!1,s=!1,a=!1,Z=0;Z<ue;Z++)B[Z]=N(_[Z]);for(ae=0;ae<ue;ae++){if(re=pe,C[ae]=P(_,B,C,ae),K=240&(pe=R[re][m[C[ae]]]),pe&=15,L[ae]=he=R[pe][5],K>0)if(K===16){for(Z=U;Z<ae;Z++)L[Z]=1;U=-1}else U=-1;if(R[pe][6])U===-1&&(U=ae);else if(U>-1){for(Z=U;Z<ae;Z++)L[Z]=he;U=-1}B[ae]==="B"&&(L[ae]=0),M.hiLevel|=he}a&&function(O,Y,ie){for(var me=0;me<ie;me++)if(O[me]==="S"){Y[me]=b;for(var ge=me-1;ge>=0&&O[ge]==="WS";ge--)Y[ge]=b}}(B,L,ue)},E=function(_,L,M,K,Z){if(!(Z.hiLevel<_)){if(_===1&&b===1&&!s)return L.reverse(),void(M&&M.reverse());for(var ae,he,re,U,ue=L.length,pe=0;pe<ue;){if(K[pe]>=_){for(re=pe+1;re<ue&&K[re]>=_;)re++;for(U=pe,he=re-1;U<he;U++,he--)ae=L[U],L[U]=L[he],L[he]=ae,M&&(ae=M[U],M[U]=M[he],M[he]=ae);pe=re}pe++}}},I=function(_,L,M){var K=_.split(""),Z={hiLevel:b};return M||(M=[]),D(K,M,Z),function(ae,he,re){if(re.hiLevel!==0&&d)for(var U,ue=0;ue<ae.length;ue++)he[ue]===1&&(U=y.indexOf(ae[ue]))>=0&&(ae[ue]=y[U+1])}(K,M,Z),E(2,K,L,M,Z),E(1,K,L,M,Z),K.join("")};return this.__bidiEngine__.doBidiReorder=function(_,L,M){if(function(Z,ae){if(ae)for(var he=0;he<Z.length;he++)ae[he]=he;o===void 0&&(o=A(Z)),u===void 0&&(u=A(Z))}(_,L),i||!l||u)if(i&&l&&o^u)b=o?1:0,_=j(_,L,M);else if(!i&&l&&u)b=o?1:0,_=I(_,L,M),_=j(_,L);else if(!i||o||l||u){if(i&&!l&&o^u)_=j(_,L),o?(b=0,_=I(_,L,M)):(b=1,_=I(_,L,M),_=j(_,L));else if(i&&o&&!l&&u)b=1,_=I(_,L,M),_=j(_,L);else if(!i&&!l&&o^u){var K=d;o?(b=1,_=I(_,L,M),b=0,d=!1,_=I(_,L,M),d=K):(b=0,_=I(_,L,M),_=j(_,L),b=1,d=!1,_=I(_,L,M),d=K,_=j(_,L))}}else b=0,_=I(_,L,M);else b=o?1:0,_=I(_,L,M);return _},this.__bidiEngine__.setOptions=function(_){_&&(i=_.isInputVisual,l=_.isOutputVisual,o=_.isInputRtl,u=_.isOutputRtl,d=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(i=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?i.push([r.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):i.push([r.doBidiReorder(s[o])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(jt),jt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Dc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new Lee(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new vee(this.contents),this.head=new wee(this),this.name=new _ee(this),this.cmap=new jP(this),this.toUnicode={},this.hhea=new bee(this),this.maxp=new Eee(this),this.hmtx=new Aee(this),this.post=new See(this),this.os2=new Nee(this),this.loca=new Pee(this),this.glyf=new jee(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,l,u;for(u=[],i=0,o=(l=this.bbox).length;i<o;i++)t=l[i],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,a,i,o;for(i=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)s=t.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var qi,Dc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,a,i,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*i+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,a;for(a=[],n=0,s=t.length;n<s;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),vee=function(){var e;function t(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,a,i,o,l,u,d,f,p,h,m,g;for(g in h=Object.keys(r).length,l=Math.log(2),f=16*Math.floor(Math.log(h)/l),i=Math.floor(f/l),d=16*h-f,(s=new Dc).writeInt(this.scalarType),s.writeShort(h),s.writeShort(f),s.writeShort(i),s.writeShort(d),a=16*h,u=s.pos+a,o=null,m=[],r)for(p=r[g],s.writeString(g),s.writeInt(e(p)),s.writeInt(u),s.writeInt(p.length),m=m.concat(p),g==="head"&&(o=u),u+=p.length;u%4;)m.push(0),u++;return s.write(m),n=2981146554-e(s.data),s.pos=o+8,s.writeUInt32(n),s.data},e=function(r){var n,s,a,i;for(r=CP.call(r);r.length%4;)r.push(0);for(a=new Dc(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},t}(),yee={}.hasOwnProperty,jo=function(e,t){for(var r in t)yee.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};qi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var wee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Dc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),rE=function(){function e(t,r){var n,s,a,i,o,l,u,d,f,p,h,m,g,y,x,w,b;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,a=function(){var N,A;for(A=[],l=N=0;0<=p?N<p:N>p;l=0<=p?++N:--N)A.push(t.readUInt16());return A}(),t.pos+=2,g=function(){var N,A;for(A=[],l=N=0;0<=p?N<p:N>p;l=0<=p?++N:--N)A.push(t.readUInt16());return A}(),u=function(){var N,A;for(A=[],l=N=0;0<=p?N<p:N>p;l=0<=p?++N:--N)A.push(t.readUInt16());return A}(),d=function(){var N,A;for(A=[],l=N=0;0<=p?N<p:N>p;l=0<=p?++N:--N)A.push(t.readUInt16());return A}(),s=(this.length-t.pos+this.offset)/2,o=function(){var N,A;for(A=[],l=N=0;0<=s?N<s:N>s;l=0<=s?++N:--N)A.push(t.readUInt16());return A}(),l=x=0,b=a.length;x<b;l=++x)for(y=a[l],n=w=m=g[l];m<=y?w<=y:w>=y;n=m<=y?++w:--w)d[l]===0?i=n+u[l]:(i=o[d[l]/2+(n-m)-(p-l)]||0)!==0&&(i+=u[l]),this.codeMap[n]=65535&i}t.pos=f}return e.encode=function(t,r){var n,s,a,i,o,l,u,d,f,p,h,m,g,y,x,w,b,N,A,P,j,D,E,I,_,L,M,K,Z,ae,he,re,U,ue,pe,C,R,B,O,Y,ie,me,ge,xe,Le,z;switch(K=new Dc,i=Object.keys(t).sort(function(Re,Fe){return Re-Fe}),r){case"macroman":for(g=0,y=function(){var Re=[];for(m=0;m<256;++m)Re.push(0);return Re}(),w={0:0},a={},Z=0,U=i.length;Z<U;Z++)w[ge=t[s=i[Z]]]==null&&(w[ge]=++g),a[s]={old:t[s],new:w[t[s]]},y[s]=w[t[s]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(y),{charMap:a,subtable:K.data,maxGlyphID:g+1};case"unicode":for(L=[],f=[],b=0,w={},n={},x=u=null,ae=0,ue=i.length;ae<ue;ae++)w[A=t[s=i[ae]]]==null&&(w[A]=++b),n[s]={old:A,new:w[A]},o=w[A]-s,x!=null&&o===u||(x&&f.push(x),L.push(s),u=o),x=s;for(x&&f.push(x),f.push(65535),L.push(65535),I=2*(E=L.length),D=2*Math.pow(Math.log(E)/Math.LN2,2),p=Math.log(D/2)/Math.LN2,j=2*E-D,l=[],P=[],h=[],m=he=0,pe=L.length;he<pe;m=++he){if(_=L[m],d=f[m],_===65535){l.push(0),P.push(0);break}if(_-(M=n[_].new)>=32768)for(l.push(0),P.push(2*(h.length+E-m)),s=re=_;_<=d?re<=d:re>=d;s=_<=d?++re:--re)h.push(n[s].new);else l.push(M-_),P.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*E+2*h.length),K.writeUInt16(0),K.writeUInt16(I),K.writeUInt16(D),K.writeUInt16(p),K.writeUInt16(j),ie=0,C=f.length;ie<C;ie++)s=f[ie],K.writeUInt16(s);for(K.writeUInt16(0),me=0,R=L.length;me<R;me++)s=L[me],K.writeUInt16(s);for(xe=0,B=l.length;xe<B;xe++)o=l[xe],K.writeUInt16(o);for(Le=0,O=P.length;Le<O;Le++)N=P[Le],K.writeUInt16(N);for(z=0,Y=h.length;z<Y;z++)g=h[z],K.writeUInt16(g);return{charMap:n,subtable:K.data,maxGlyphID:b+1}}},e}(),jP=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new rE(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=rE.encode(t,r),(s=new Dc).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),bee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Nee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),See=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var i,o,l;for(l=[],a=i=0,o=this.file.maxp.numGlyphs;0<=o?i<o:i>o;a=0<=o?++i:--i)l.push(t.readUInt32());return l}).call(this)}},e}(),kee=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},_ee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,a,i,o,l,u,d,f,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},a=d=0,f=n.length;d<f;a=++d)s=n[a],t.pos=s.offset,u=t.readString(s.length),i=new kee(u,s),l[p=s.nameID]==null&&(l[p]=[]),l[s.nameID].push(i);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),Eee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),Aee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,a,i,o,l;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,p;for(p=[],u=0,d=(f=this.metrics).length;u<d;u++)a=f[u],p.push(a.advance);return p}).call(this),n=this.widths[this.widths.length-1],l=[],r=i=0;0<=s?i<s:i>s;r=0<=s?++i:--i)l.push(this.widths.push(n));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),CP=[].slice,jee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,a,i,o,l,u,d,f;return t in this.cache?this.cache[t]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(o=new Dc(r.read(s))).readShort(),u=o.readShort(),f=o.readShort(),l=o.readShort(),d=o.readShort(),this.cache[t]=i===-1?new Tee(o,u,f,l,d):new Cee(o,i,u,f,l,d),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,a,i,o,l;for(i=[],a=[],o=0,l=r.length;o<l;o++)s=t[r[o]],a.push(i.length),s&&(i=i.concat(s.encode(n)));return a.push(i.length),{table:i,offsets:a}},e}(),Cee=function(){function e(t,r,n,s,a,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Tee=function(){function e(t,r,n,s,a){var i,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Dc(CP.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),Pee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return jo(e,qi),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,i=0;i<n.length;++i)if(n[i]=s,a<r.length&&r[a]==i){++a,n[i]=s;var o=this.offsets[i],l=this.offsets[i+1]-o;l>0&&(s+=l)}for(var u=new Array(4*n.length),d=0;d<n.length;++d)u[4*d+3]=255&n[d],u[4*d+2]=(65280&n[d])>>8,u[4*d+1]=(16711680&n[d])>>16,u[4*d]=(4278190080&n[d])>>24;return u},e}(),Lee=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,a,i,o,l;for(s={},i=0,o=t.length;i<o;i++)s[a=t[i]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in l=this.glyphsFor(r))n=l[a],s[a]=n;return s},e.prototype.encode=function(t,r){var n,s,a,i,o,l,u,d,f,p,h,m,g,y,x;for(s in n=jP.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),h={0:0},x=n.charMap)h[(l=x[s]).old]=l.new;for(m in p=n.maxGlyphID,i)m in h||(h[m]=p++);return d=function(w){var b,N;for(b in N={},w)N[w[b]]=b;return N}(h),f=Object.keys(d).sort(function(w,b){return w-b}),g=function(){var w,b,N;for(N=[],w=0,b=f.length;w<b;w++)o=f[w],N.push(d[o]);return N}(),a=this.font.glyf.encode(i,g,h),u=this.font.loca.encode(a.offsets,g),y={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();jt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,a,i;if(Array.isArray(r))return"["+function(){var o,l,u;for(u=[],o=0,l=r.length;o<l;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)i=r[s],a.push("/"+s+" "+t.convert(i));return a.push(">>"),a.join(`
`)}return""+r},t}();function TP(e,t,r,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,o=s.internal.getFontSize()/i,l=s.getLineHeightFactor?s.getLineHeightFactor():a,u=o*l,d=/\r\n|\r|\n/g,f="",p=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(f=typeof e=="string"?e.split(d):e,p=f.length||1),r+=o*(2-a),n.valign==="middle"?r-=p/2*u:n.valign==="bottom"&&(r-=p*u),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),f&&p>=1){for(var m=0;m<f.length;m++)s.text(f[m],t-s.getStringUnitWidth(f[m])*h,r),r+=u;return s}t-=s.getStringUnitWidth(e)*h}return n.halign==="justify"?s.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(e,t,r),s}var nE={},ff=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:nE=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,s,a;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,l=i.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var u=this.getFontList()[l];u&&u.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),o=u[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var d=e.unifyColor(t.fillColor);d&&(n=this.jsPDFDocument).setFillColor.apply(n,d),d=e.unifyColor(t.textColor),d&&(s=this.jsPDFDocument).setTextColor.apply(s,d),d=e.unifyColor(t.lineColor),d&&(a=this.jsPDFDocument).setDrawColor.apply(a,d),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,s,a){return this.jsPDFDocument.rect(t,r,n,s,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return nE||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),o5=function(e,t){return o5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},o5(e,t)};function PP(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");o5(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var LP=function(e){PP(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function Fee(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Dee(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function J1(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],s=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function FP(e,t,r,n){var s=t.settings.tableLineWidth,a=t.settings.tableLineColor;e.applyStyles({lineWidth:s,lineColor:a});var i=DP(s,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function DP(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function Hx(e,t){var r,n,s,a;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(s=e.right)!==null&&s!==void 0?s:t,bottom:(a=e.bottom)!==null&&a!==void 0?a:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function RP(e,t){var r=Hx(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function Ree(e,t,r,n,s){var a={},i=1.3333333333333333,o=Vv(t,function(b){return s.getComputedStyle(b).backgroundColor});o!=null&&(a.fillColor=o);var l=Vv(t,function(b){return s.getComputedStyle(b).color});l!=null&&(a.textColor=l);var u=Oee(n,r);u&&(a.cellPadding=u);var d="borderTopColor",f=i*r,p=n.borderTopWidth;if(n.borderBottomWidth===p&&n.borderRightWidth===p&&n.borderLeftWidth===p){var h=(parseFloat(p)||0)/f;h&&(a.lineWidth=h)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/f,right:(parseFloat(n.borderRightWidth)||0)/f,bottom:(parseFloat(n.borderBottomWidth)||0)/f,left:(parseFloat(n.borderLeftWidth)||0)/f},a.lineWidth.top||(a.lineWidth.right?d="borderRightColor":a.lineWidth.bottom?d="borderBottomColor":a.lineWidth.left&&(d="borderLeftColor"));var m=Vv(t,function(b){return s.getComputedStyle(b)[d]});m!=null&&(a.lineColor=m);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(a.fontSize=y/i);var x=Iee(n);x&&(a.fontStyle=x);var w=(n.fontFamily||"").toLowerCase();return e.indexOf(w)!==-1&&(a.font=w),a}function Iee(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Vv(e,t){var r=IP(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function IP(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:IP(e.parentElement,t):r}function Oee(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),s=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,a=r.map(function(o){return parseInt(o||"0")/n}),i=Hx(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function OP(e,t,r,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var l=Object.keys(e.getFontList()),u=e.scaleFactor(),d=[],f=[],p=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:d,body:f,foot:p};for(var h=0;h<o.rows.length;h++){var m=o.rows[h],g=(i=(a=m==null?void 0:m.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),y=Mee(l,u,r,m,n,s);y&&(g==="thead"?d.push(y):g==="tfoot"?p.push(y):f.push(y))}return{head:d,body:f,foot:p}}function Mee(e,t,r,n,s,a){for(var i=new LP(n),o=0;o<n.cells.length;o++){var l=n.cells[o],u=r.getComputedStyle(l);if(s||u.display!=="none"){var d=void 0;a&&(d=Ree(e,l,t,u,r)),i.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:d,_element:l,content:Bee(l)})}}var f=r.getComputedStyle(n);if(i.length>0&&(s||f.display!=="none"))return i}function Bee(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Uee(e,t,r){for(var n=0,s=[e,t,r];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function il(e,t,r,n,s){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])}return a}function MP(e,t){var r=new ff(e),n=r.getDocumentOptions(),s=r.getGlobalOptions();Uee(s,n,t);var a=il({},s,n,t),i;typeof window<"u"&&(i=window);var o=$ee(s,n,t),l=zee(s,n,t),u=Hee(r,a),d=Wee(r,a,i);return{id:t.tableId,content:d,hooks:l,styles:o,settings:u}}function $ee(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(l){if(l==="columnStyles"){var u=e[l],d=t[l],f=r[l];n.columnStyles=il({},u,d,f)}else{var p=[e,t,r],h=p.map(function(m){return m[l]||{}});n[l]=il({},h[0],h[1],h[2])}},a=0,i=Object.keys(n);a<i.length;a++){var o=i[a];s(o)}return n}function zee(e,t,r){for(var n=[e,t,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var o=i[a];o.didParseCell&&s.didParseCell.push(o.didParseCell),o.willDrawCell&&s.willDrawCell.push(o.willDrawCell),o.didDrawCell&&s.didDrawCell.push(o.didDrawCell),o.willDrawPage&&s.willDrawPage.push(o.willDrawPage),o.didDrawPage&&s.didDrawPage.push(o.didDrawPage)}return s}function Hee(e,t){var r,n,s,a,i,o,l,u,d,f,p,h,m=Hx(t.margin,40/e.scaleFactor()),g=(r=qee(e,t.startY))!==null&&r!==void 0?r:m.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(s=t.showHead)!==null&&s!==void 0?s:"everyPage";var w=(a=t.useCss)!==null&&a!==void 0?a:!1,b=t.theme||(w?"plain":"striped"),N=!!t.horizontalPageBreak,A=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:w,theme:b,startY:g,margin:m,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(u=t.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(d=t.tableWidth)!==null&&d!==void 0?d:"auto",showHead:x,showFoot:y,tableLineWidth:(f=t.tableLineWidth)!==null&&f!==void 0?f:0,tableLineColor:(p=t.tableLineColor)!==null&&p!==void 0?p:200,horizontalPageBreak:N,horizontalPageBreakRepeat:A,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function qee(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),s=e.pageNumber(),a=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;a=i===s}return typeof t=="number"?t:(t==null||t===!1)&&a&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function Wee(e,t,r){var n=t.head||[],s=t.body||[],a=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var o=OP(e,t.html,r,i,t.useCss)||{};n=o.head||n,s=o.body||n,a=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||Vee(n,s,a);return{columns:l,head:n,body:s,foot:a}}function Vee(e,t,r){var n=e[0]||t[0]||r[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,o;Array.isArray(n)?o=n[parseInt(a)]:o=n[a],typeof o=="object"&&!Array.isArray(o)&&(i=(o==null?void 0:o.colSpan)||1);for(var l=0;l<i;l++){var u=void 0;Array.isArray(n)?u=s.length:u=a+(l>0?"_".concat(l):"");var d={dataKey:u};s.push(d)}}),s}var l5=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),Kee=function(e){PP(t,e);function t(r,n,s,a,i,o){var l=e.call(this,r,n,o)||this;return l.cell=s,l.row=a,l.column=i,l.section=a.section,l}return t}(l5),Gee=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,s,a,i){for(var o=0,l=r;o<l.length;o++){var u=l[o],d=new Kee(t,this,n,s,a,i),f=u(d)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],f)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new l5(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new l5(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),BP=function(){function e(t,r,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof LP&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,s){var a;return Math.max(n,((a=r.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var o=r.getLineHeight(i.styles.fontSize),l=i.padding("vertical"),u=l+o;return u>s?u:s},0)},e}(),UP=function(){function e(t,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(s=t.content)!==null&&s!==void 0?s:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",o=/\r\n|\r|\n/g;this.text=i.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/t*r,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Hx(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),Yee=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,s=t.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function Xee(e,t){Jee(e,t);var r=[],n=0;t.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(t);i?a.width=i:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var s=t.getWidth(e.pageSize().width)-n;s&&(s=c5(r,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=c5(r,s,function(a){return a.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),Zee(t),ete(t,e),Qee(t)}function Jee(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,s=RP(e,t);t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u){var d=t.hooks.didParseCell;t.callCellHooks(e,d,u,a,l,null);var f=u.padding("horizontal");u.contentWidth=J1(u.text,u.styles,e)+f;var p=J1(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,e);if(u.minReadableWidth=p+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>s?(u.minWidth=s,u.wrappedWidth=s):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var h=10/r;u.minWidth=u.styles.minCellWidth||h,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u&&u.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,u.wrappedWidth),l.minWidth=Math.max(l.minWidth,u.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,u.minReadableWidth);else{var d=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},f=d.cellWidth||d.minCellWidth;f&&typeof f=="number"&&(l.minWidth=f,l.wrappedWidth=f)}u&&(u.colSpan>1&&!l.minWidth&&(l.minWidth=u.minWidth),u.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=u.minWidth))}})}function c5(e,t,r){for(var n=t,s=e.reduce(function(h,m){return h+m.wrappedWidth},0),a=0;a<e.length;a++){var i=e[a],o=i.wrappedWidth/s,l=n*o,u=i.width+l,d=r(i),f=u<d?d:u;t-=f-i.width,i.width=f}if(t=Math.round(t*1e10)/1e10,t){var p=e.filter(function(h){return t<0?h.width>r(h):!0});p.length&&(t=c5(p,t,r))}return t}function Qee(e){for(var t={},r=1,n=e.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,o=e.columns;i<o.length;i++){var l=o[i],u=t[l.index];if(r>1)r--,delete a.cells[l.index];else if(u)u.cell.height+=a.height,r=u.cell.colSpan,delete a.cells[l.index],u.left--,u.left<=1&&delete t[l.index];else{var d=a.cells[l.index];if(!d)continue;if(d.height=a.height,d.rowSpan>1){var f=n.length-s,p=d.rowSpan>f?f:d.rowSpan;t[l.index]={cell:d,left:p,row:a}}}}}function Zee(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],s=null,a=0,i=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if(i-=1,i>1&&e.columns[o+1])a+=l.width,delete n.cells[l.index];else if(s){var u=s;delete n.cells[l.index],s=null,u.width=l.width+a}else{var u=n.cells[l.index];if(!u)continue;if(i=u.colSpan,a=0,u.colSpan>1){s=u,a+=l.width;continue}u.width=l.width+a}}}function ete(e,t){for(var r={count:0,height:0},n=0,s=e.allRows();n<s.length;n++){for(var a=s[n],i=0,o=e.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u){t.applyStyles(u.styles,!0);var d=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=t.splitTextToSize(u.text,d+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=sE(u.text,d,u.styles,t,"...");else if(u.styles.overflow==="hidden")u.text=sE(u.text,d,u.styles,t,"");else if(typeof u.styles.overflow=="function"){var f=u.styles.overflow(u.text,d);typeof f=="string"?u.text=[f]:u.text=f}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var p=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<p*u.rowSpan?r={height:p,count:u.rowSpan}:r&&r.count>0&&r.height>p&&(p=r.height),p>a.height&&(a.height=p)}}r.count--}}function sE(e,t,r,n,s){return e.map(function(a){return tte(a,t,r,n,s)})}function tte(e,t,r,n,s){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=J1(e,r,n))return e;for(;t<J1(e+s,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+s}function $P(e,t){var r=new ff(e),n=rte(t,r.scaleFactor()),s=new Gee(t,n);return Xee(r,s),r.applyStyles(r.userStyles),s}function rte(e,t){var r=e.content,n=ste(r.columns);if(r.head.length===0){var s=aE(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=aE(n,"foot");s&&r.foot.push(s)}var a=e.settings.theme,i=e.styles;return{columns:n,head:Kv("head",r.head,n,i,a,t),body:Kv("body",r.body,n,i,a,t),foot:Kv("foot",r.foot,n,i,a,t)}}function Kv(e,t,r,n,s,a){var i={},o=t.map(function(l,u){for(var d=0,f={},p=0,h=0,m=0,g=r;m<g.length;m++){var y=g[m];if(i[y.index]==null||i[y.index].left===0)if(h===0){var x=void 0;Array.isArray(l)?x=l[y.index-p-d]:x=l[y.dataKey];var w={};typeof x=="object"&&!Array.isArray(x)&&(w=(x==null?void 0:x.styles)||{});var b=ate(e,y,u,s,n,a,w),N=new UP(x,b,e);f[y.dataKey]=N,f[y.index]=N,h=N.colSpan-1,i[y.index]={left:N.rowSpan-1,times:h}}else h--,p++;else i[y.index].left--,h=i[y.index].times,d++}return new BP(l,u,e,f)});return o}function aE(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var s=nte(t,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function nte(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function ste(e){return e.map(function(t,r){var n,s;return typeof t=="object"?s=(n=t.dataKey)!==null&&n!==void 0?n:r:s=r,new Yee(s,t,r)})}function ate(e,t,r,n,s,a,i){var o=Dee(n),l;e==="head"?l=s.headStyles:e==="body"?l=s.bodyStyles:e==="foot"&&(l=s.footStyles);var u=il({},o.table,o[e],s.styles,l),d=s.columnStyles[t.dataKey]||s.columnStyles[t.index]||{},f=e==="body"?d:{},p=e==="body"&&r%2===0?il({},o.alternateRow,s.alternateRowStyles):{},h=Fee(a),m=il({},h,u,p,f);return il(m,i)}function ite(e,t,r){var n;r===void 0&&(r={});var s=RP(e,t),a=new Map,i=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(p){var h=t.columns.find(function(m){return m.dataKey===p||m.index===p});h&&!a.has(h.index)&&(a.set(h.index,!0),i.push(h.index),o.push(t.columns[h.index]),s-=h.wrappedWidth)});for(var u=!0,d=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;d<t.columns.length;){if(a.has(d)){d++;continue}var f=t.columns[d].wrappedWidth;if(u||s>=f)u=!1,i.push(d),o.push(t.columns[d]),s-=f;else break;d++}return{colIndexes:i,columns:o,lastIndex:d-1}}function ote(e,t){for(var r=[],n=0;n<t.columns.length;n++){var s=ite(e,t,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function zP(e,t){var r=t.settings,n=r.startY,s=r.margin,a={x:s.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+s.bottom+i;if(r.pageBreak==="avoid"){var l=t.body,u=l.reduce(function(p,h){return p+h.height},0);o+=u}var d=new ff(e);(r.pageBreak==="always"||r.startY!=null&&o>d.pageSize().height)&&(qP(d),a.y=s.top),t.callWillDrawPageHooks(d,a);var f=il({},a);t.startPageNumber=d.pageNumber(),r.horizontalPageBreak?lte(d,t,f,a):(d.applyStyles(d.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(p){return wl(d,t,p,a,t.columns)}),d.applyStyles(d.userStyles),t.body.forEach(function(p,h){var m=h===t.body.length-1;Q1(d,t,p,m,f,a,t.columns)}),d.applyStyles(d.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(p){return wl(d,t,p,a,t.columns)})),FP(d,t,f,a),t.callEndPageHooks(d,a),t.finalY=a.y,e.lastAutoTable=t,d.applyStyles(d.userStyles)}function lte(e,t,r,n){var s=ote(e,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(u,d){e.applyStyles(e.userStyles),d>0?b0(e,t,r,n,u.columns,!0):iE(e,t,n,u.columns),cte(e,t,r,n,u.columns),Gv(e,t,n,u.columns)});else for(var i=-1,o=s[0],l=function(){var u=i;if(o){e.applyStyles(e.userStyles);var d=o.columns;i>=0?b0(e,t,r,n,d,!0):iE(e,t,n,d),u=oE(e,t,i+1,n,d),Gv(e,t,n,d)}var f=u-i;s.slice(1).forEach(function(p){e.applyStyles(e.userStyles),b0(e,t,r,n,p.columns,!0),oE(e,t,i+1,n,p.columns,f),Gv(e,t,n,p.columns)}),i=u};i<t.body.length-1;)l()}function iE(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&t.head.forEach(function(a){return wl(e,t,a,r,n)})}function cte(e,t,r,n,s){e.applyStyles(e.userStyles),t.body.forEach(function(a,i){var o=i===t.body.length-1;Q1(e,t,a,o,r,n,s)})}function oE(e,t,r,n,s,a){e.applyStyles(e.userStyles),a=a??t.body.length;var i=Math.min(r+a,t.body.length),o=-1;return t.body.slice(r,i).forEach(function(l,u){var d=r+u===t.body.length-1,f=HP(e,t,d,n);l.canEntireRowFit(f,s)&&(wl(e,t,l,n,s),o=r+u)}),o}function Gv(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&t.foot.forEach(function(a){return wl(e,t,a,r,n)})}function ute(e,t,r){var n=r.getLineHeight(e.styles.fontSize),s=e.padding("vertical"),a=Math.floor((t-s)/n);return Math.max(0,a)}function dte(e,t,r,n){var s={};e.spansMultiplePages=!0,e.height=0;for(var a=0,i=0,o=r.columns;i<o.length;i++){var l=o[i],u=e.cells[l.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var d=new UP(u.raw,u.styles,u.section);d=il(d,u),d.text=[];var f=ute(u,t,n);u.text.length>f&&(d.text=u.text.splice(f,u.text.length));var p=n.scaleFactor(),h=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(p,h),u.contentHeight>=t&&(u.contentHeight=t,d.styles.minCellHeight-=t),u.contentHeight>e.height&&(e.height=u.contentHeight),d.contentHeight=d.getContentHeight(p,h),d.contentHeight>a&&(a=d.contentHeight),s[l.index]=d}}var m=new BP(e.raw,-1,e.section,s,!0);m.height=a;for(var g=0,y=r.columns;g<y.length;g++){var l=y[g],d=m.cells[l.index];d&&(d.height=m.height);var u=e.cells[l.index];u&&(u.height=e.height)}return m}function fte(e,t,r,n){var s=e.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,o=s-i;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,e),u=l<r;if(l>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var d=t.hasRowSpan(n.columns),f=t.getMaxCellHeight(n.columns)>o;return f?(d&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(d||n.settings.rowPageBreak==="avoid")}function Q1(e,t,r,n,s,a,i){var o=HP(e,t,n,a);if(r.canEntireRowFit(o,i))wl(e,t,r,a,i);else if(fte(e,r,o,t)){var l=dte(r,o,t,e);wl(e,t,r,a,i),b0(e,t,s,a,i),Q1(e,t,l,n,s,a,i)}else b0(e,t,s,a,i),Q1(e,t,r,n,s,a,i)}function wl(e,t,r,n,s){n.x=t.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var o=i[a],l=r.cells[o.index];if(!l){n.x+=o.width;continue}e.applyStyles(l.styles),l.x=n.x,l.y=n.y;var u=t.callCellHooks(e,t.hooks.willDrawCell,l,r,o,n);if(u===!1){n.x+=o.width;continue}hte(e,l,n);var d=l.getTextPos();TP(l.text,d.x,d.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,o,n),n.x+=o.width}n.y+=r.height}function hte(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=DP(n.lineWidth,n.fillColor);s&&e.rect(t.x,r.y,t.width,t.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),pte(e,t,r,n.lineWidth))}function pte(e,t,r,n){var s,a,i,o;n.top&&(s=r.x,a=r.y,i=r.x+t.width,o=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.top,s,a,i,o)),n.bottom&&(s=r.x,a=r.y+t.height,i=r.x+t.width,o=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.bottom,s,a,i,o)),n.left&&(s=r.x,a=r.y,i=r.x,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,s,a,i,o)),n.right&&(s=r.x+t.width,a=r.y,i=r.x+t.width,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,s,a,i,o));function l(u,d,f,p,h){e.getDocument().setLineWidth(u),e.getDocument().line(d,f,p,h,"S")}}function HP(e,t,r,n){var s=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(s+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-s}function b0(e,t,r,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(o){return wl(e,t,o,n,s)}),t.callEndPageHooks(e,n);var i=t.settings.margin;FP(e,t,r,n),qP(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return wl(e,t,o,n,s)}),e.applyStyles(e.userStyles))}function qP(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function mte(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],s=MP(this,n),a=$P(this,s);return zP(this,a),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,s){TP(t,r,n,s,this)},e.API.autoTableSetDefaults=function(t){return ff.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){ff.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new ff(this),a=OP(s,t,window,r,!1),i=a.head,o=a.body,l=((n=i[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:l,rows:o,data:o}}}var Yv;function Z1(e,t){var r=MP(e,t),n=$P(e,r);zP(e,n)}try{if(typeof window<"u"&&window){var lE=window,cE=lE.jsPDF||((Yv=lE.jspdf)===null||Yv===void 0?void 0:Yv.jsPDF);cE&&mte(cE)}}catch(e){console.error("Could not apply autoTable plugin",e)}function gte(e){const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const l=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],u=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],d=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return l[o];if(o>=10&&o<20)return u[o-10];const f=Math.floor(o/10),p=o%10;if(f===7||f===9){const h=d[f],m=10+p;return m<20?h+"-"+u[m-10]:h+"-"+l[p]}return f===8?p===0?"quatre-vingts":"quatre-vingt-"+l[p]:p===0?d[f]:p===1&&f===2?"vingt et un":p===1&&(f===3||f===4||f===5||f===6)?d[f]+" et un":d[f]+"-"+l[p]},s=o=>{if(o===0)return"";const l=Math.floor(o/100),u=o%100;let d="";return l>1?(d=n(l)+" cent",u===0&&(d+="s")):l===1&&(d="cent"),u>0&&(d&&(d+=" "),d+=n(u)),d};let i=(o=>{if(o===0)return"zro";const l=Math.floor(o/1e6),u=Math.floor(o%1e6/1e3),d=o%1e3;let f="";return l>0&&(l===1?f+="un million":f+=s(l)+" millions"),u>0&&(f&&(f+=" "),u===1?f+="mille":f+=s(u)+" mille"),d>0&&(f&&(f+=" "),f+=s(d)),f})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i}function _d(e){return(Math.round(e*100)/100).toLocaleString("fr-MA",{minimumFractionDigits:2,maximumFractionDigits:2})}async function uE(e,t,r,n,s,a,i,o,l,u=[],d=!1){const f=new jt("portrait","mm","a4"),p=f.internal.pageSize.width,h=f.internal.pageSize.height;let m=15;f.setFontSize(10),f.setFont("helvetica","bold"),f.text("ROYAUME DU MAROC",55,m,{align:"center"}),m+=5,f.setFontSize(9),f.setFont("helvetica","normal"),f.text("MINISTERE DE L'AGRICULTURE ET DE LA PECHE MARITIME",55,m,{align:"center"}),m+=4,f.text("DU DEVELOPPEMENT RURAL ET DES EAUX ET FORETS",55,m,{align:"center"}),m+=4,f.text("DIRECTION PROVINCIALE DE L'AGRICULTURE",55,m,{align:"center"}),m+=4,f.text("TATA",55,m,{align:"center"}),m+=10;const g=p-60;if(f.setFontSize(8),f.setFont("helvetica","bold"),f.text("EXER: "+e.annee,g+2,20),f.text("Chapitre: "+(e.chapitre||""),g+2,25),f.text("Programme: "+(e.programme||""),g+2,30),f.text("Projet: "+(e.projet||""),g+2,35),f.text("Ligne: "+(e.ligne||""),g+2,40),m=55,f.setFontSize(10),f.setFont("helvetica","bold"),e.typeMarche==="negocie"){const R="MARCHE NEGOCIE N"+e.marcheNo;f.text(R,p/2,m,{align:"center"});const B=f.getTextWidth(R),O=(p-B)/2;f.setLineWidth(.3),f.line(O,m+1,O+B,m+1)}else f.text("MARCHE N"+e.marcheNo,p/2,m,{align:"center"});m+=6,f.setFontSize(9),f.setFont("helvetica","normal"),f.splitTextToSize(e.objet,p-20).forEach(R=>{f.text(R,p/2,m,{align:"center"}),m+=5}),m+=5,f.setFontSize(9),f.setFont("helvetica","normal");const x=m;e.societe&&(f.text("Socit: "+e.societe,10,m),m+=5),e.rc&&(f.text("R. C. n: "+e.rc,10,m),m+=5),e.cb&&(f.text("C.B n: "+e.cb,10,m),m+=5),e.cnss&&(f.text("C.N.S.S. n: "+e.cnss,10,m),m+=5),e.patente&&(f.text("Patente: "+e.patente,10,m),m+=5);const w=p-70,b=60;f.rect(w,x-4,b,12),f.setFont("helvetica","bold"),f.setFontSize(8),f.text("Montant de l'acompte en Dhs:",w+b/2,x,{align:"center"}),f.setFontSize(10),f.text(_d(s.montantAcompte),w+b/2,x+5,{align:"center"}),m===x?m+=10:m+=5,f.setFont("helvetica","bold"),f.setFontSize(11);const A=t.isDecompteDernier?" et dernier":"";f.text("DECOMPTE PROVISOIRE N"+t.numero+A,p/2,m,{align:"center"}),m+=5,f.setFont("helvetica","normal"),f.setFontSize(9);const P=`Des travaux excuts au: ${new Date(t.dateFin).toLocaleDateString("fr-FR")}`;f.text(P,p/2,m,{align:"center"}),m+=10;const j=n.map(R=>[R.prixNo,R.designation,R.unite,R.quantiteRealisee.toFixed(2),R.prixUnitaireHT.toFixed(2),(R.quantiteRealisee*R.prixUnitaireHT).toFixed(2)]);let D=0,E=0,I=0,_=0,L=0;Z1(f,{startY:m,head:[["Prix N","DESIGNATIONS DES PRESTATIONS","U","Quantit",`Prix U En DH
hors TVA`,`Prix Total En DH
hors TVA`]],body:j,foot:[[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral Hors TVA",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:_d(i),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:`Total TVA (${a}%)`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:_d(o),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral (T.T.C)",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:_d(l),styles:{halign:"right",fontStyle:"bold"}}]],theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[255,255,255],textColor:0,fontStyle:"bold"},tableLineWidth:.1,tableLineColor:[200,200,200],willDrawCell:R=>{R.section==="foot"&&R.column.index<3&&(R.cell.styles.lineWidth=0,R.cell.styles.lineColor=[255,255,255])},didDrawCell:R=>{R.section==="body"&&R.row.index===R.table.body.length-1&&R.column.index===0&&(_=R.cell.y+R.cell.height),R.section==="body"&&R.row.index===R.table.body.length-1&&R.column.index===3&&(D=R.cell.x),R.section==="body"&&R.row.index===R.table.body.length-1&&R.column.index===5&&(E=R.cell.x+R.cell.width),R.section==="body"&&R.row.index===0&&R.column.index===0&&(L=R.cell.x),R.section==="foot"&&R.row.index===2&&R.column.index===3&&(I=R.cell.y+R.cell.height),R.section==="foot"&&R.column.index>=3&&(f.setDrawColor(200,200,200),f.setLineWidth(.1),f.rect(R.cell.x,R.cell.y,R.cell.width,R.cell.height))},didDrawPage:()=>{},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:12,halign:"center"},3:{cellWidth:20,halign:"right"},4:{cellWidth:25,halign:"right"},5:{cellWidth:30,halign:"right"}}}),f.setDrawColor(200,200,200),f.setLineWidth(.1),f.line(D,_,D,I),f.line(E,_,E,I),f.line(L,_,D,_),f.setDrawColor(255,255,255),f.setLineWidth(1),f.line(L,_+.5,L,I+.5),f.line(L,I,D,I),f.addPage(),m=20,f.setFontSize(9),f.setFont("helvetica","normal");const M=e.osc?new Date(e.osc).toLocaleDateString("fr-FR"):"../../....";f.text("Ordre de service de commencer les travaux du: "+M,10,m),m+=10,f.text("Dlais d'excution: "+(e.delaisExecution||"10")+" mois",10,m),m+=5,console.log(" PDF - Dcomptes prcdents reus:",u),u&&u.length>0?(console.log(" PDF - Affichage de",u.length,"dcomptes prcdents"),u.forEach(R=>{f.setFontSize(9),f.setFont("helvetica","normal");const B=R.isDecompteDernier?" et dernier":"",O=`D.P.n ${R.numero}${B} du ${R.date} montant: ${_d(R.montant)} DH`;console.log(" PDF - Ligne:",O),f.text(O,10,m),m+=5})):console.log(" PDF - Aucun dcompte prcdent  afficher");const K=t.isDecompteDernier?" et dernier":"",Z=`D.P.n ${t.numero}${K} du ${new Date(t.dateFin).toLocaleDateString("fr-FR")} montant: ${_d(s.montantAcompte)} DH`;f.text(Z,10,m),m+=9,f.setFont("helvetica","bold"),f.setFontSize(11),f.text("RECAPITULATION",p/2,m,{align:"center"}),m+=10;const ae=t.isDecompteDernier?[["Travaux termins",s.travauxTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxTermines-s.retenueGarantie).toFixed(2)],["Travaux non termins","0.00","0.00","0.00"],["Approvisionnements",s.approvisionnements.toFixed(2),"0.00",s.approvisionnements.toFixed(2)]]:[["Travaux termins",s.travauxTermines.toFixed(2),"0.00","0.00"],["Travaux non termins",s.travauxNonTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxNonTermines-s.retenueGarantie).toFixed(2)],["Approvisionnements",s.approvisionnements.toFixed(2),"0.00",s.approvisionnements.toFixed(2)]];Z1(f,{startY:m,head:[["NATURE DES DEPENSES","MONTANTS","RETENUE DE","RESTES"]],body:ae,foot:[[{content:"TOTAUX",styles:{fontStyle:"bold"}},{content:s.totalAvantRetenue.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.retenueGarantie.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.resteAPayer.toFixed(2),styles:{halign:"right",fontStyle:"bold"}}],[{content:" dduire les dpenses imputes sur exercices antrieurs",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.depensesExercicesAnterieurs.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Reste  payer sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.resteAPayer.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:" dduire le montant des acomptes dlivrs sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:(s.totalADeduire-s.depensesExercicesAnterieurs).toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Montant de l'acompte  dlivrer:",colSpan:3,styles:{fontStyle:"bold",fillColor:[255,255,255],textColor:0}},{content:s.montantAcompte.toFixed(2),styles:{fontStyle:"bold",fontSize:10,fillColor:[255,255,255],textColor:0,halign:"right"}}]],theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"},footStyles:{fillColor:[255,255,255],textColor:0},didDrawCell:R=>{R.section==="foot"&&(f.setDrawColor(200,200,200),f.setLineWidth(.1),f.rect(R.cell.x,R.cell.y,R.cell.width,R.cell.height))},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:35,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:35,halign:"right"}}}),m=f.lastAutoTable.finalY+10,f.setFontSize(8),f.setFont("helvetica","italic"),f.splitTextToSize("Dress par 1. Le responsable du Service d'Amnagement Hydro-Agricole ou son reprsentant  et 2. Le Chef de Mission AT Gzouli Ingnieur Conseil; responsable de suivi des travaux, qui certifie que les quantits portes au prsent dcompte correspondent aux travaux rellement excuts conformment aux plans et aux stipulations du march.",p-20).forEach(R=>{m>h-40&&(f.addPage(),m=20),f.text(R,10,m),m+=4}),m+=10,f.setFontSize(9),f.setFont("helvetica","normal"),f.text("1-",10,m),f.text("2-",p/2,m),m+=20,f.text("Vu et vrifi",10,m),m+=25,f.setFillColor(255,255,255),f.rect(10,m,p-20,15,"F"),f.setDrawColor(0),f.setLineWidth(.2),f.rect(10,m,p-20,15,"S"),f.setFont("helvetica","normal"),f.setFontSize(9),f.setTextColor(0);const U=`Arrt par nous, Sous-Ordonnateur,  la somme de: ${gte(s.montantAcompte)}`,ue=f.splitTextToSize(U,p-25);let pe=m+5;ue.forEach(R=>{f.text(R,12,pe),pe+=4}),m+=20,f.text("A Tata, Le:",10,m),m+=10,f.text("Tata, le:",p/2,m);const C=`Decompte_${e.marcheNo}_Periode_${t.numero}_${new Date().toISOString().split("T")[0]}.pdf`;if(d){const R=f.output("blob"),B=URL.createObjectURL(R),O=document.createElement("iframe");O.style.position="fixed",O.style.right="0",O.style.bottom="0",O.style.width="0",O.style.height="0",O.style.border="none",O.src=B,document.body.appendChild(O),O.onload=()=>{setTimeout(()=>{var Y;(Y=O.contentWindow)==null||Y.print(),setTimeout(()=>{document.body.removeChild(O),URL.revokeObjectURL(B)},1e3)},500)}}else f.save(C)}const xte=(e,t)=>{const[r,n]=J.useState({isLoading:!0,error:null,isOnline:Ga(),lastRefresh:null}),s=J.useRef(!1),[a,i]=J.useState({project:null,bordereaux:[],periodes:[],metres:[],decompts:[]}),o=e?Ur("project",e):null,l=e?ei(e):null,u=Dn(()=>o?be.projects.get(o):void 0,[o]),d=Dn(async()=>o?be.bordereaux.where("projectId").equals(o).filter(y=>!y.deletedAt).toArray():[],[o]),f=Dn(async()=>o?be.periodes.where("projectId").equals(o).filter(y=>!y.deletedAt).toArray():[],[o]),p=Dn(async()=>o?be.metres.where("projectId").equals(o).filter(y=>!y.deletedAt).toArray():[],[o]),h=Dn(async()=>o?be.decompts.where("projectId").equals(o).filter(y=>!y.deletedAt).toArray():[],[o]),m=J.useCallback(async()=>{var y;if(!(!l||!t)){if(St()&&!Ga()){n(x=>({...x,isLoading:!1,error:"Vous devez tre connect pour voir les donnes",isOnline:!1}));return}n(x=>({...x,isLoading:!0,error:null}));try{console.log(` [SERVER-FIRST] Loading project ${l} details from server...`);let x=null,w=[],b=[],N=[],A=[];const P=await mt.getProject(l);x=P.data||P,x&&await be.projects.put({...x,id:Ur("project",x.id),userId:x.userId?Ur("user",x.userId):x.userId});try{const j=await mt.getBordereaux(l);w=j.data||j||[],Array.isArray(w)&&await be.transaction("rw",be.bordereaux,async()=>{const D=await be.bordereaux.where("projectId").equals(o).toArray();for(const E of D)await be.bordereaux.delete(E.id);for(const E of w)await be.bordereaux.put({...E,id:Ur("bordereau",E.id),projectId:o})})}catch{w=[]}try{const j=await((y=mt.getPeriodes)==null?void 0:y.call(mt,l));b=(j==null?void 0:j.data)||j||[],Array.isArray(b)&&await be.transaction("rw",be.periodes,async()=>{const D=await be.periodes.where("projectId").equals(o).toArray();for(const E of D)await be.periodes.delete(E.id);for(const E of b)await be.periodes.put({...E,id:Ur("periode",E.id),projectId:o})})}catch(j){console.warn(" [SERVER-FIRST] No periodes or error:",j),b=[]}try{console.log(` [SERVER-FIRST] Loading metres for project ${l}...`);const j=await mt.getMetres(l);console.log(" [SERVER-FIRST] Metres response:",j),N=j.data||j||[],console.log(" [SERVER-FIRST] Server metres:",(N==null?void 0:N.length)||0),Array.isArray(N)&&(await be.transaction("rw",be.metres,async()=>{const D=await be.metres.where("projectId").equals(o).toArray();for(const E of D)await be.metres.delete(E.id);for(const E of N)await be.metres.put({...E,id:Ur("metre",E.id),projectId:o,periodeId:E.periodeId?Ur("periode",E.periodeId):""})}),console.log(` [SERVER-FIRST] Saved ${N.length} metres to IndexedDB`))}catch(j){console.error(" [SERVER-FIRST] Error loading metres:",j),N=[]}try{const j=await mt.getDecompts(l);A=j.data||j||[],Array.isArray(A)&&await be.transaction("rw",be.decompts,async()=>{const D=await be.decompts.where("projectId").equals(o).toArray();for(const E of D)await be.decompts.delete(E.id);for(const E of A)await be.decompts.put({...E,id:Ur("decompt",E.id),projectId:o,periodeId:E.periodeId?Ur("periode",E.periodeId):""})})}catch{A=[]}console.log(` [SERVER-FIRST] Loaded project ${l} with all related data`),console.log(" [SERVER-FIRST] Setting serverData state:",{project:!!x,bordereaux:w.length,periodes:b.length,metres:N.length,decompts:A.length}),i({project:x,bordereaux:w,periodes:b,metres:N,decompts:A}),n(j=>({...j,isLoading:!1,error:null,isOnline:!0,lastRefresh:Date.now()}))}catch(x){console.error(" [SERVER-FIRST] Failed to load project details:",x),Eu()?n(w=>({...w,isLoading:!1,error:null})):n(w=>({...w,isLoading:!1,error:"Impossible de charger les donnes du serveur"}))}}},[l,o,t]);J.useEffect(()=>{l&&t&&!s.current&&(s.current=!0,St()||Ga()?m():n(y=>({...y,isLoading:!1})))},[l,t,m]);const g={project:a.project||u,bordereaux:a.bordereaux.length>0?a.bordereaux:d||[],periodes:a.periodes.length>0?a.periodes:f||[],metres:a.metres.length>0?a.metres:p||[],decompts:a.decompts.length>0?a.decompts:h||[],...r,refresh:m};return console.log(" [HOOK RETURN]",{serverDataMetres:a.metres.length,serverDataPeriodes:a.periodes.length,serverDataBordereaux:a.bordereaux.length,indexedDbMetres:(p==null?void 0:p.length)||0,indexedDbPeriodes:(f==null?void 0:f.length)||0,indexedDbBordereaux:(d==null?void 0:d.length)||0,returnMetres:g.metres.length,returnPeriodes:g.periodes.length,returnBordereaux:g.bordereaux.length,isLoading:r.isLoading}),g},WP=e=>Math.round((e+1e-7)*100)/100,qn=WP,on=e=>WP(e).toLocaleString("fr-MA",{minimumFractionDigits:2,maximumFractionDigits:2}),dE=()=>{const{projectId:e,periodeId:t}=Ku(),r=$s(),n=On(O=>O.user),[s,a]=J.useState(!1),[i,o]=J.useState([]),[l,u]=J.useState(20),[d,f]=J.useState(10),[p,h]=J.useState(0),[m,g]=J.useState(0),y=e!=null&&e.includes(":")?e.split(":").pop():e;t!=null&&t.includes(":")&&t.split(":").pop();const x=e!=null&&e.includes(":")?e:`project:${e}`,w=t!=null&&t.includes(":")?t:`periode:${t}`,{project:b,bordereaux:N,periodes:A,metres:P,decompts:j,isLoading:D,error:E,refresh:I}=xte(y||"",(n==null?void 0:n.id)||null),_=b,L=J.useMemo(()=>N==null?void 0:N.find(O=>!O.deletedAt),[N]),M=J.useMemo(()=>{if(!A||A.length===0)return;const O=(w==null?void 0:w.replace("periode:",""))||"",Y=A.find(ie=>ie.deletedAt?!1:(ie.id||"").replace("periode:","")===O);return console.log(" [DECOMPTE] Finding periode:",{urlPeriodeId:w,cleanUrlPeriodeId:O,serverPeriodesCount:A.length,serverPeriodesIds:A.map(ie=>ie.id),found:!!Y,foundId:Y==null?void 0:Y.id,foundNumero:Y==null?void 0:Y.numero}),Y},[A,w]),K=J.useMemo(()=>{if(!P||P.length===0)return console.log(" [DECOMPTE] No metres from server"),[];if(!M)return console.log(" [DECOMPTE] Periode not found yet, waiting..."),[];if(!A||A.length===0)return console.log(" [DECOMPTE] No periodes from server"),[];const O=M.numero||1,Y=A.filter(me=>(me.numero||1)<=O&&!me.deletedAt).map(me=>{const ge=me.id||"";return ge.includes(":")?ge.replace("periode:",""):ge});console.log(" [DECOMPTE] Filtering metres for periodes:",{currentNumero:O,validPeriodeIds:Y,serverMetresCount:P.length});const ie=P.filter(me=>{if(me.deletedAt)return!1;const ge=(me.periodeId||"").replace("periode:","");return Y.includes(ge)});return console.log(" [DECOMPTE] Filtered metres:",ie.length,"of",P.length),ie},[P,M,A]),Z=J.useMemo(()=>j==null?void 0:j.find(O=>{var ie;return((ie=O.periodeId)!=null&&ie.includes(":")?O.periodeId:`periode:${O.periodeId}`)===w&&!O.deletedAt}),[j,w]);console.log(" [DECOMPTE] Server data loaded:",{hasProject:!!_,hasBordereau:!!L,hasPeriode:!!M,metresCount:K.length,serverLoading:D,serverError:E}),J.useEffect(()=>{M&&(u(M.tauxTVA??20),f(M.tauxRetenue??10),g(qn(M.depensesExercicesAnterieurs??0)),h(qn(M.decomptesPrecedents??0)))},[M]),J.useEffect(()=>{(async()=>{if(!M||!x||!_)return;const Y=x.startsWith("project:")?x:`project:${x}`,ie=await be.decompts.where("projectId").equals(Y).and(z=>!z.deletedAt).toArray(),me=ie.filter(z=>z.numero<M.numero);if(console.log(" Calculating previous payments:",{queryProjectId:Y,currentPeriodeNumero:M.numero,allDecomptesCount:ie.length,previousDecomptesCount:me.length,decomptes:me.map(z=>({numero:z.numero,montant:z.montantTotal}))}),me.length===0){g(0),h(0);return}const ge=new Date(M.dateDebut).getFullYear();let xe=0,Le=0;for(const z of me){const Re=await be.periodes.get(z.periodeId);if(!Re){console.warn(" Priode not found for dcompte:",z.id);continue}const Fe=new Date(Re.dateDebut).getFullYear(),X=z.montantTotal||0;console.log(" Dcompte:",{numero:z.numero,anneeDecompt:Fe,anneePeriodeActuelle:ge,montant:X}),Fe<ge?xe+=X:Fe===ge&&(Le+=X)}console.log(" Calculated totals:",{totalExercicesAnterieurs:xe,totalExerciceEnCours:Le}),g(qn(xe)),h(qn(Le))})()},[M,x,_]);const ae=O=>O?O.replace(/^bordereau:/,""):"";J.useEffect(()=>{var Le;if(console.log(" [USEEFFECT ENTRY]",{serverLoading:D,hasBordereau:!!L,bordereauLignesCount:((Le=L==null?void 0:L.lignes)==null?void 0:Le.length)||0,hasPeriode:!!M,periodeNumero:M==null?void 0:M.numero,serverMetresLength:(P==null?void 0:P.length)||0,serverPeriodesLength:(A==null?void 0:A.length)||0}),D){console.log(" [DECOMPTE] Waiting for server data to load...");return}if(!L){console.log(" [DECOMPTE] No bordereau yet");return}if(!M){console.log(" [DECOMPTE] No periode yet");return}console.log("========================================"),console.log(" [CALC] RAW DATA FROM SERVER:"),console.log(" [CALC] bordereau:",L),console.log(" [CALC] bordereau.lignes:",L.lignes),console.log(" [CALC] serverMetres:",P),console.log(" [CALC] serverPeriodes:",A),console.log(" [CALC] current periode:",M),console.log("========================================");const O=ae(L.id),Y=M.numero||1,ie=(A||[]).filter(z=>(z.numero||1)<=Y&&!z.deletedAt).map(z=>(z.id||"").replace("periode:",""));console.log(" [CALC] validPeriodeIds:",ie);const me=(P||[]).filter(z=>{if(z.deletedAt)return!1;const Re=(z.periodeId||"").replace("periode:","");return ie.includes(Re)});console.log(" [CALC] filteredMetres count:",me.length),console.log(" [CALC] filteredMetres:",me);const ge=L.lignes.map(z=>{const Re=`${O}-ligne-${z.numero}`,Fe=me.find(st=>ae(st.bordereauLigneId)===Re),X=(Fe==null?void 0:Fe.totalCumule)||(Fe==null?void 0:Fe.totalPartiel)||0,Oe=z.prixUnitaire||0,Me=X*Oe;return console.log(` [CALC] Ligne ${z.numero}:`,{ligneId:Re,metreFound:!!Fe,metreId:Fe==null?void 0:Fe.id,quantite_from_metre:X,prix_unitaire_from_bordereau:Oe,montant_ht_calculated:Me}),{prixNo:z.numero,designation:z.designation,unite:z.unite,quantiteBordereau:z.quantite,quantiteRealisee:Math.round(X*100)/100,prixUnitaireHT:Math.round(Oe*100)/100,montantHT:Math.round(Me*100)/100,bordereauLigneId:Re,metreId:Fe==null?void 0:Fe.id}}),xe=ge.reduce((z,Re)=>z+Re.montantHT,0);console.log(" [CALC] TOTAL HT:",xe),console.log(" [CALC] decompteLines:",ge),console.log("========================================"),o(ge)},[L,P,A,D,M]);const he=qn(i.reduce((O,Y)=>O+Y.montantHT,0)),re=qn(he*l/100),U=qn(he+re);console.log(" [FINAL] lignes.length =",i.length),console.log(" [FINAL] lignes =",i),console.log(" [FINAL] totalHT =",he),console.log(" [FINAL] montantTVA =",re),console.log(" [FINAL] totalTTC =",U);const pe=(()=>{let O=0,Y=0;M!=null&&M.isDecompteDernier?(O=U,Y=0):(O=0,Y=U);const ie=0,me=U,ge=qn((L==null?void 0:L.lignes.reduce((Me,st)=>{const Ue=qn(st.quantite*(st.prixUnitaire||0));return Me+qn(Ue*1.2)},0))||0),xe=qn(U*.1),Le=qn(ge*.07),z=qn(Math.min(xe,Le)),Re=qn(me-z),Fe=qn(Re-m),X=qn(m+p),Oe=qn(Fe-p);return{travauxTermines:O,travauxNonTermines:Y,approvisionnements:ie,totalAvantRetenue:me,retenueGarantie:z,resteAPayer:Fe,depensesExercicesAnterieurs:m,totalADeduire:X,montantAcompte:Oe}})();J.useEffect(()=>{(async()=>{if(!n||!x||!w||!M||!Z||i.length===0)return;const Y=new Date().toISOString(),ie=pe.montantAcompte;(Z.montantTotal!==ie||Z.totalTTC!==U)&&(await be.decompts.update(Z.id,{lignes:i,montantTotal:ie,totalTTC:U,updatedAt:Y}),console.log(" Dcompte mis  jour automatiquement:",ie,"TTC:",U))})()},[i,pe.montantAcompte,Z,n,x,w,M]);const C=async()=>{if(!(!n||!x||!w||!M)){a(!0);try{const O=new Date().toISOString();if(await be.periodes.update(w,{tauxTVA:l,tauxRetenue:d,depensesExercicesAnterieurs:m,decomptesPrecedents:p,updatedAt:O}),await ps("UPDATE","periode",w.replace("periode:",""),{tauxTVA:l,tauxRetenue:d,depensesExercicesAnterieurs:m,decomptesPrecedents:p},n.id),Z)await be.decompts.update(Z.id,{lignes:i,montantTotal:pe.montantAcompte,totalTTC:U,statut:"draft",updatedAt:O}),await ps("UPDATE","decompt",Z.id.replace("decompt:",""),{montantTotal:pe.montantAcompte,lignesCount:i.length},n.id);else{const Y=`decompt:${Tr()}`,ie={id:Y,projectId:x,periodeId:w,userId:n.id,numero:M.numero,lignes:i,montantTotal:pe.montantAcompte,totalTTC:U,statut:"draft",createdAt:O,updatedAt:O};await be.decompts.add(ie),await ps("CREATE","decompt",Y.replace("decompt:",""),ie,n.id)}alert("Dcompte enregistr avec succs !")}catch(O){console.error("Erreur lors de la sauvegarde:",O),alert("Erreur lors de la sauvegarde du dcompte")}finally{a(!1)}}},R=async()=>{if(!_||!M||!L||!x){alert("Donnes manquantes pour gnrer le PDF");return}try{console.log(" Recherche des dcomptes prcdents..."),console.log(" Project ID:",x),console.log(" Priode actuelle:",M);const O=await be.decompts.where("projectId").equals(`project:${x}`).toArray();console.log(" TOUS les dcomptes du projet:",O);const Y=O.filter(me=>!me.deletedAt&&me.numero<M.numero);console.log(" Dcomptes prcdents filtrs:",Y);const ie=await Promise.all(Y.map(async me=>{const ge=await be.periodes.get(me.periodeId);return console.log(` Priode du dcompte ${me.numero}:`,ge),{numero:me.numero,date:ge?new Date(ge.dateFin).toLocaleDateString("fr-FR"):"",montant:me.montantTotal,isDecompteDernier:(ge==null?void 0:ge.isDecompteDernier)||!1}}));ie.sort((me,ge)=>me.numero-ge.numero),console.log(" Dcomptes prcdents avec dates (tris):",ie),await uE(_,M,L,i,pe,l,he,re,U,ie)}catch(O){console.error("Erreur lors de la gnration du PDF:",O),alert("Erreur lors de la gnration du PDF")}},B=async()=>{if(!_||!M||!L||!x){alert("Donnes manquantes pour imprimer");return}try{const O=(j||[]).filter(Y=>Y.numero<M.numero).map(Y=>{const ie=A==null?void 0:A.find(me=>me.id===Y.periodeId||me.id===Y.periodeId.replace("periode:","")||`periode:${me.id}`===Y.periodeId);return{numero:Y.numero,date:ie?new Date(ie.dateFin).toLocaleDateString("fr-FR"):"",montant:Y.montantTotal,isDecompteDernier:(ie==null?void 0:ie.isDecompteDernier)||!1}}).sort((Y,ie)=>Y.numero-ie.numero);await uE(_,M,L,i,pe,l,he,re,U,O,!0)}catch(O){console.error("Erreur lors de l'impression:",O),alert("Erreur lors de l'impression")}};return D?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement des donnes du serveur..."})]})}):E?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center text-red-600",children:[c.jsx("p",{className:"text-lg font-medium mb-2",children:"Erreur de chargement"}),c.jsx("p",{className:"text-sm",children:E}),c.jsx("button",{onClick:I,className:"mt-4 btn-primary",children:"Ressayer"})]})}):!_||!M||!L?(console.log(" [DECOMPTE] Missing data after server load:",{hasProject:!!_,hasPeriode:!!M,hasBordereau:!!L,projectId:x,periodeId:w,serverPeriodesCount:A==null?void 0:A.length,serverBordereauxCount:N==null?void 0:N.length}),c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."}),c.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Project: ",_?"":""," | Priode: ",M?"":""," | Bordereau: ",L?"":""]}),c.jsx("button",{onClick:I,className:"mt-4 text-sm text-primary-600 hover:underline",children:"Rafrachir les donnes"})]})})):c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r(`/projects/${e}`),className:"btn-secondary mb-4 flex items-center gap-2",children:[c.jsx(ii,{className:"w-4 h-4"}),"Retour au projet"]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Dcompte Provisoire N",M.numero.toString().padStart(2,"0"),M.isDecompteDernier?" et dernier":""]}),c.jsxs("p",{className:"text-gray-600",children:["Priode: ",M.libelle," "," ",Kn(new Date(M.dateDebut),"dd/MM/yyyy",{locale:Pc})," -"," ",Kn(new Date(M.dateFin),"dd/MM/yyyy",{locale:Pc})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:_.objet})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:R,className:"btn-secondary flex items-center gap-2",children:[c.jsx(Sl,{className:"w-5 h-5"}),"Exporter PDF"]}),c.jsxs("button",{onClick:B,className:"btn-secondary flex items-center gap-2",children:[c.jsx(DC,{className:"w-5 h-5"}),"Imprimer"]}),c.jsxs("button",{onClick:C,disabled:s,className:"btn-primary flex items-center gap-2",children:[c.jsx(Yu,{className:"w-5 h-5"}),s?"Enregistrement...":"Enregistrer"]})]})]})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[c.jsx(Wr,{className:"w-5 h-5 text-primary-600"}),"Informations du Projet"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Matre d'ouvrage:"}),c.jsx("p",{className:"text-gray-900",children:"ROYAUME DU MAROC - Ministre de l'Agriculture"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Projet:"}),c.jsx("p",{className:"text-gray-900",children:_.objet})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"March N:"}),c.jsx("p",{className:"text-gray-900",children:_.marcheNo})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Montant du march (TTC):"}),c.jsxs("p",{className:"text-gray-900 font-bold text-primary-600",children:[L.lignes.reduce((O,Y)=>{const me=Y.quantite*(Y.prixUnitaire||0)*1.2;return O+me},0).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g," ")," ","DH"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(PC,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length}),c.jsx("p",{className:"text-sm text-gray-600",children:"Lignes"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(Ci,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:on(he)}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total HT (DH)"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(dc,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:on(U)}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total TTC (DH)"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:c.jsx(bo,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:on(pe.montantAcompte)}),c.jsx("p",{className:"text-sm text-gray-600",children:" payer (DH)"})]})]})})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Dsignations des Prestations"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border border-gray-300",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"Prix N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation des Prestations"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"U"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-28",children:"Quantit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-32",children:"Prix U En DH hors TVA"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-36",children:"Prix Total En DH hors TVA"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(O=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-gray-700 font-medium border-r border-gray-200",children:O.prixNo}),c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:O.designation}),c.jsx("td",{className:"px-4 py-3 text-center border-r border-gray-200",children:c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:O.unite})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:on(O.quantiteRealisee)}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:on(O.prixUnitaireHT)}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:on(O.montantHT)})]},O.bordereauLigneId))}),c.jsxs("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:[c.jsxs("tr",{children:[c.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral Hors TVA"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:on(he)})]}),c.jsxs("tr",{children:[c.jsxs("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:["Total TVA (",l,"%)"]}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:on(re)})]}),c.jsxs("tr",{className:"bg-primary-50",children:[c.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral (T.T.C)"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:on(U)})]})]})]})})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Rcapitulation"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border border-gray-300",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Nature des Dpenses"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-40 whitespace-nowrap",children:"Montants"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-48 whitespace-nowrap",children:"Retenue de Garantie"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40 whitespace-nowrap",children:"Restes"})]})}),c.jsxs("tbody",{className:"divide-y divide-gray-200",children:[c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux termins"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:on(pe.travauxTermines)}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:M!=null&&M.isDecompteDernier?on(pe.retenueGarantie):""}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:M!=null&&M.isDecompteDernier?on(pe.travauxTermines-pe.retenueGarantie):""})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux non termins"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:on(pe.travauxNonTermines)}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:M!=null&&M.isDecompteDernier?"":on(pe.retenueGarantie)}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:M!=null&&M.isDecompteDernier?"":on(pe.travauxNonTermines-pe.retenueGarantie)})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Approvisionnements"}),c.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),c.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),c.jsx("td",{className:"px-4 py-3"})]}),c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 font-bold border-r border-gray-200",children:"TOTAUX"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:on(pe.totalAvantRetenue)}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:on(pe.retenueGarantie)}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:on(pe.totalAvantRetenue-pe.retenueGarantie)})]}),c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire les dpenses imputes sur exercices antrieurs"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:on(pe.depensesExercicesAnterieurs)})]}),c.jsxs("tr",{children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:"Reste  payer sur l'exercice en cours"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:on(pe.resteAPayer)})]}),c.jsxs("tr",{children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire le montant des acomptes dlivrs sur l'exercice en cours"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:on(p)})]}),c.jsxs("tr",{className:"bg-primary-50",children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-bold border-r border-gray-200",children:"Montant de l'acompte  dlivrer:"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:on(pe.montantAcompte)})]})]})]})}),c.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["Arrt par nous, Sous-Ordonnateur,  la somme de: ",c.jsx("span",{className:"font-bold",children:vte(pe.montantAcompte)})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Paramtres du Dcompte"}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taux TVA (%)"}),c.jsx("input",{type:"number",value:l,onChange:O=>u(parseFloat(O.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retenue de garantie (%)"}),c.jsx("input",{type:"number",value:d,onChange:O=>f(parseFloat(O.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dpenses exercices antrieurs (DH)"}),c.jsx("input",{type:"number",value:m,onChange:O=>g(qn(parseFloat(O.target.value)||0)),className:"input",min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dcomptes prcdents (DH)"}),c.jsx("input",{type:"number",value:p,onChange:O=>h(qn(parseFloat(O.target.value)||0)),className:"input",min:"0",step:"0.01"})]})]})]})]})},vte=e=>{const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const l=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],u=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],d=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return l[o];if(o>=10&&o<20)return u[o-10];const f=Math.floor(o/10),p=o%10;if(f===7||f===9){const h=d[f],m=10+p;return m<20?h+"-"+u[m-10]:h+"-"+l[p]}return f===8?p===0?"quatre-vingts":"quatre-vingt-"+l[p]:p===0?d[f]:p===1&&f===2?"vingt et un":p===1&&(f===3||f===4||f===5||f===6)?d[f]+" et un":d[f]+"-"+l[p]},s=o=>{if(o===0)return"";const l=Math.floor(o/100),u=o%100;let d="";return l>1?(d=n(l)+" cent",u===0&&(d+="s")):l===1&&(d="cent"),u>0&&(d&&(d+=" "),d+=n(u)),d};let i=(o=>{if(o===0)return"zro";const l=Math.floor(o/1e6),u=Math.floor(o%1e6/1e3),d=o%1e3;let f="";return l>0&&(l===1?f+="un million":f+=s(l)+" millions"),u>0&&(f&&(f+=" "),u===1?f+="mille":f+=s(u)+" mille"),d>0&&(f&&(f+=" "),f+=s(d)),f})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i},fE=()=>{const{projectId:e,periodeId:t}=Ku(),r=$s(),[n,s]=J.useState(!1),a=(e==null?void 0:e.replace("project:",""))||"",i=t?t.includes(":")?t:`periode:${t}`:null,o=(t==null?void 0:t.replace("periode:",""))||"",{project:l}=Rx(a||null),{bordereau:u}=Mb(a||null),{periodes:d}=Bb(a||null),{metres:f}=Ub(a||null),p=J.useMemo(()=>!d||!i?null:d.find(b=>b.id===i||b.id===o||b.id===`periode:${o}`)||null,[d,i,o]),h=b=>b?b.replace(/^periode:/,""):"",m=J.useMemo(()=>{if(!f||!p||!d)return[];const b=p.numero||1,N=d.filter(A=>(A.numero||1)<=b).map(A=>h(A.id));return f.filter(A=>{const P=h(A.periodeId);return N.includes(P)})},[f,p,d]),g=b=>b?b.replace(/^bordereau:/,""):"",x=!(u!=null&&u.lignes)||!m?[]:u.lignes.map((b,N)=>{const P=`${g(u.id)}-ligne-${b.numero}`,D=m.filter(E=>g(E.bordereauLigneId)===P).reduce((E,I)=>E+(Number(I.totalPartiel)||0),0);return{numero:N+1,designation:b.designation,unite:b.unite||"",quantiteCumulee:Number(D)||0}}).filter(b=>b.quantiteCumulee>0),w=async()=>{if(!(!l||!u)){s(!0);try{const b=new jt("p","mm","a4"),N=b.internal.pageSize.getWidth(),A=b.internal.pageSize.getHeight(),P=15;b.setFontSize(12),b.setFont("helvetica","bold"),b.text("Royaume du Maroc",N/2,12,{align:"center"});let j=45;try{const Z=new Image;Z.crossOrigin="anonymous",await new Promise((re,U)=>{Z.onload=()=>re(),Z.onerror=()=>U(),Z.src="/maroc-logo.png"});const ae=30,he=Z.height/Z.width*ae;b.addImage(Z,"PNG",(N-ae)/2,16,ae,he),j=16+he+4}catch{b.setFillColor(200,200,200),b.circle(N/2,28,12,"F"),j=45}b.setFontSize(9),b.setFont("helvetica","normal");const D=["Ministre de l'Agriculture, de la Pche Maritime,","du Dveloppement Rural et des Eaux et Fort","Direction Provinciale de l'Agriculture de Tata","Service des Amnagement hydro-agricole"];let E=j;D.forEach(Z=>{b.text(Z,N/2,E,{align:"center"}),E+=4}),E+=2,b.setFont("helvetica","bold"),b.setFontSize(10);const I=l.typeMarche==="negocie"?"MARCHE NEGOCIE":"MARCHE";if(b.text(`${I} N${l.marcheNo}`,N/2,E,{align:"center"}),E+=8,b.setFontSize(9),b.setFont("helvetica","bold"),b.splitTextToSize(l.objet.toUpperCase(),N-2*P).forEach(Z=>{b.text(Z,N/2,E,{align:"center"}),E+=4}),E+=6,b.setFontSize(12),b.setFont("helvetica","bold"),p){const Z=p.isDecompteDernier?" et dernier":"";b.text(`ATTACHEMENT PROVISOIRE  N${p.numero.toString().padStart(2,"0")}${Z}`,N/2,E,{align:"center"})}else b.text("ATTACHEMENT DES TRAVAUX",N/2,E,{align:"center"});E+=4,b.setLineWidth(.5),b.line(P,E,N-P,E),E+=6;const L=x.map(Z=>[Z.numero.toString(),Z.designation,Z.unite,Number(Z.quantiteCumulee).toFixed(2)]);Z1(b,{startY:E,head:[["N","Dsignation des ouvrages","U","Quantit"]],body:L,theme:"grid",styles:{fontSize:9,cellPadding:3,lineColor:[0,0,0],lineWidth:.3},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:20,halign:"center"},3:{cellWidth:30,halign:"right"}},didDrawPage:()=>{b.setFontSize(10),b.setFont("helvetica","normal");const Z=b.getCurrentPageInfo().pageNumber;b.text(`Page ${Z}`,N/2,A-10,{align:"center"})}});const M=b.lastAutoTable.finalY+15;Z1(b,{startY:M,head:[["Etabli par","Accept par","Vrifi par"]],body:[["","",""]],theme:"grid",styles:{fontSize:9,cellPadding:15,lineColor:[0,0,0],lineWidth:.3,minCellHeight:25},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}}});const K=p?`Attachement_${l.marcheNo}_P${p.numero}.pdf`:`Attachement_${l.marcheNo}.pdf`;b.save(K)}catch(b){console.error("Erreur export PDF:",b),alert("Erreur lors de l'export PDF")}finally{s(!1)}}};return!l||!u||i&&!p?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):c.jsxs("div",{className:"max-w-5xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>{r(i?`/projects/${a}/metre/${o}`:`/projects/${a}`)},className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ii,{className:"w-5 h-5"}),i?"Retour au mtr":"Retour au projet"]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:p?`Attachement Provisoire N ${p.numero.toString().padStart(2,"0")}${p.isDecompteDernier?" et dernier":""}`:"Attachement des Travaux"}),c.jsxs("p",{className:"text-gray-600",children:["March N ",l.marcheNo," - ",l.annee]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l.objet})]}),c.jsxs("button",{onClick:w,disabled:n||x.length===0,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Sl,{className:"w-4 h-4"}),n?"Export en cours...":"Exporter PDF"]})]})]}),c.jsxs("div",{className:"card bg-white",children:[c.jsxs("div",{className:"text-center border-b pb-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-bold mb-3",children:"Royaume du Maroc"}),c.jsx("img",{src:"/maroc-logo.png",alt:"Emblme du Royaume du Maroc",className:"h-24 mx-auto mb-3",onError:b=>{b.target.style.display="none"}}),c.jsx("p",{className:"text-sm text-gray-600",children:"Ministre de l'Agriculture, de la Pche Maritime,"}),c.jsx("p",{className:"text-sm text-gray-600",children:"du Dveloppement Rural et des Eaux et Fort"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Direction Provinciale de l'Agriculture de Tata"}),c.jsxs("p",{className:"font-bold text-sm mb-2",children:[l.typeMarche==="negocie"?"MARCHE NEGOCIE":"MARCHE"," N",l.marcheNo]}),c.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 px-8",children:l.objet.toUpperCase()}),c.jsx("h3",{className:"text-lg font-bold border-t border-b py-2 inline-block px-8",children:p?`ATTACHEMENT PROVISOIRE N${p.numero.toString().padStart(2,"0")}${p.isDecompteDernier?" et dernier":""}`:"ATTACHEMENT DES TRAVAUX"})]}),x.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse border border-gray-400",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-16",children:"N"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-left font-semibold",children:"Dsignation des ouvrages"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-20",children:"U"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-right font-semibold w-32",children:"Quantit"})]})}),c.jsx("tbody",{children:x.map(b=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:b.numero}),c.jsx("td",{className:"border border-gray-400 px-4 py-2",children:b.designation}),c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:b.unite}),c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-right font-medium",children:Number(b.quantiteCumulee).toFixed(2)})]},b.numero))})]})}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Wr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune quantit saisie"}),c.jsx("p",{className:"text-gray-600",children:"Saisissez d'abord les quantits dans le mtr pour gnrer l'attachement"})]}),x.length>0&&c.jsx("div",{className:"mt-8 pt-6 border-t",children:c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Etabli par"}),c.jsx("div",{className:"h-16"})]}),c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Accept par"}),c.jsx("div",{className:"h-16"})]}),c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Vrifi par"}),c.jsx("div",{className:"h-16"})]})]})})]})]})},yte=()=>{const{t:e,i18n:t}=$i(),[r,n]=J.useState(Op()),[s,a]=J.useState(localStorage.getItem("base_folder_name")),[i,o]=J.useState(!1),[l,u]=J.useState("storage"),d=[{type:"local",name:"Stockage Local",description:"Enregistrez vos projets sur votre ordinateur",icon:yB,available:!0},{type:"onedrive",name:"OneDrive",description:"Synchronisez avec Microsoft OneDrive",icon:NS,available:!1,comingSoon:!0},{type:"google-drive",name:"Google Drive",description:"Synchronisez avec Google Drive",icon:NS,available:!1,comingSoon:!0}],f=async()=>{const g=await EJ();g&&(a(g),n(y=>({...y,basePath:g})))},p=()=>{P8(r),o(!0),setTimeout(()=>o(!1),2e3)},h=g=>{const y=d.find(x=>x.type===g);y!=null&&y.available&&n(x=>({...x,type:g}))},m="showDirectoryPicker"in window;return c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[c.jsx(Ow,{className:"w-8 h-8 text-primary-600"}),e("settings.title")]}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Configurez les paramtres de l'application"})]}),c.jsxs("div",{className:"flex gap-6",children:[c.jsx("div",{className:"w-64 flex-shrink-0",children:c.jsxs("nav",{className:"space-y-1",children:[c.jsxs("button",{onClick:()=>u("storage"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="storage"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(Wm,{className:"w-5 h-5"}),"Stockage des fichiers",c.jsx(ul,{className:"w-4 h-4 ml-auto"})]}),c.jsxs("button",{onClick:()=>u("general"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="general"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(Ow,{className:"w-5 h-5"}),"Paramtres gnraux",c.jsx(ul,{className:"w-4 h-4 ml-auto"})]}),c.jsxs("button",{onClick:()=>u("about"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="about"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(SS,{className:"w-5 h-5"})," propos",c.jsx(ul,{className:"w-4 h-4 ml-auto"})]})]})}),c.jsxs("div",{className:"flex-1",children:[l==="storage"&&c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[c.jsx(Wm,{className:"w-6 h-6 text-primary-600"}),"Configuration du stockage"]}),c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx(SS,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-blue-800 font-medium",children:"Comment a fonctionne ?"}),c.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Choisissez un emplacement o tous vos dossiers de projets seront crs automatiquement. Chaque projet aura sa propre structure de dossiers organise (Bordereau, Mtr, Dcomptes, etc.)."})]})]})}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de stockage"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:d.map(g=>{const y=g.icon;return c.jsxs("button",{onClick:()=>h(g.type),disabled:!g.available,className:`relative p-4 rounded-lg border-2 text-left transition-all ${r.type===g.type?"border-primary-500 bg-primary-50":g.available?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"}`,children:[g.comingSoon&&c.jsx("span",{className:"absolute top-2 right-2 px-2 py-0.5 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Bientt"}),c.jsx(y,{className:`w-8 h-8 mb-2 ${r.type===g.type?"text-primary-600":"text-gray-400"}`}),c.jsx("p",{className:`font-medium ${r.type===g.type?"text-primary-900":"text-gray-900"}`,children:g.name}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:g.description}),r.type===g.type&&c.jsx("div",{className:"absolute top-2 left-2",children:c.jsx(bS,{className:"w-5 h-5 text-primary-600"})})]},g.type)})})]}),r.type==="local"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dossier de base"}),m?c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("div",{className:"flex-1 flex items-center gap-3 px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx(Iw,{className:"w-5 h-5 text-gray-400"}),c.jsx("span",{className:s?"text-gray-900":"text-gray-500",children:s||"Aucun dossier slectionn"})]}),c.jsxs("button",{onClick:f,className:"btn-primary flex items-center gap-2",children:[c.jsx(Wm,{className:"w-4 h-4"}),"Choisir un dossier"]})]}):c.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:c.jsxs("p",{className:"text-yellow-800 text-sm",children:[c.jsx("strong",{children:"Note :"})," Votre navigateur ne supporte pas la slection de dossiers. Les fichiers seront tlchargs dans votre dossier de tlchargements par dfaut.",c.jsx("br",{}),c.jsx("span",{className:"text-yellow-700",children:"Pour une meilleure exprience, utilisez Chrome, Edge ou Opera."})]})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Structure des dossiers"}),c.jsxs("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 font-mono text-sm",children:[c.jsxs("div",{className:"text-yellow-400",children:[" ",s||"MesProjetsBTP","/"]}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-blue-400",children:" 2025/"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-green-400",children:" 12-2025-dpa-ta/"}),c.jsxs("div",{className:"ml-4 text-gray-400",children:[c.jsx("div",{children:" Bordereau/"}),c.jsx("div",{children:" Mtr/"}),c.jsx("div",{children:" Dcomptes/"}),c.jsx("div",{children:" Attachements/"}),c.jsx("div",{children:" Photos/"}),c.jsx("div",{children:" PV/"}),c.jsx("div",{children:" Documents/"})]})]})]})]})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t flex justify-end",children:c.jsx("button",{onClick:p,className:"btn-primary flex items-center gap-2",children:i?c.jsxs(c.Fragment,{children:[c.jsx(bS,{className:"w-4 h-4"}),"Enregistr !"]}):c.jsxs(c.Fragment,{children:[c.jsx(Yu,{className:"w-4 h-4"}),"Enregistrer les paramtres"]})})})]}),l==="general"&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Paramtres gnraux"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Langue de l'interface"}),c.jsx("div",{className:"flex gap-2",children:[{code:"fr",label:"Franais",flag:""},{code:"ar",label:"",flag:""},{code:"en",label:"English",flag:""}].map(g=>c.jsxs("button",{onClick:()=>t.changeLanguage(g.code),className:`flex items-center gap-2 px-4 py-2 rounded-lg border-2 transition-colors ${t.language===g.code?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("span",{className:"text-xl",children:g.flag}),c.jsx("span",{children:g.label})]},g.code))})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[c.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-gray-300 text-primary-600 focus:ring-primary-500",defaultChecked:!0}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Sauvegarde automatique"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Enregistrer automatiquement les modifications"})]})]})}),c.jsxs("div",{className:"pt-6 border-t",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Gestion des donnes"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[c.jsx(No,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Exporter toutes les donnes"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Tlcharger une sauvegarde complte"})]})]}),c.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[c.jsx(Wm,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Importer des donnes"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Restaurer depuis une sauvegarde"})]})]})]})]})]}),l==="about"&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:" propos"}),c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:c.jsx(Iw,{className:"w-10 h-10 text-primary-600"})}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Suivi Chantier BTP"}),c.jsx("p",{className:"text-gray-500 mt-1",children:"Version 1.0.0"}),c.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[c.jsx("p",{children:"Application de gestion de projets BTP"}),c.jsxs("p",{className:"mt-2",children:["Dvelopp pour simplifier la gestion des marchs,",c.jsx("br",{}),"des mtrs, des dcomptes et des attachements."]})]}),c.jsx("div",{className:"mt-8 pt-6 border-t text-sm text-gray-500",children:c.jsx("p",{children:" 2025 - Tous droits rservs"})})]})]})]})]})]})};function wte(){const e=$s(),{user:t}=On(),[r,n]=J.useState({totalUsers:0,activeUsers:0,trialUsers:0,expiredTrials:0}),[s,a]=J.useState([]),[i,o]=J.useState(!0);J.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}l()},[t,e]);const l=async()=>{try{const d=await be.users.toArray(),f=await be.auditLogs.orderBy("timestamp").reverse().limit(10).toArray(),p=new Date,h=d.filter(y=>y.isActive).length,m=d.filter(y=>y.trialEndDate&&new Date(y.trialEndDate)>p).length,g=d.filter(y=>y.trialEndDate&&new Date(y.trialEndDate)<=p).length;n({totalUsers:d.length,activeUsers:h,trialUsers:m,expiredTrials:g}),a(f),o(!1)}catch(d){console.error("Error loading dashboard data:",d),o(!1)}},u=d=>({create_user:"Utilisateur cr",disable_user:"Utilisateur dsactiv",enable_user:"Utilisateur activ",delete_user:"Utilisateur supprim",extend_trial:"Essai prolong",update_role:"Rle modifi"})[d]||d;return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ii,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(F1,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Tableau de bord Admin"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Vue d'ensemble du systme"})]})]})]}),c.jsxs("button",{onClick:()=>e("/admin/users"),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Mw,{className:"w-4 h-4"}),"Grer les utilisateurs"]})]})})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsx(fg,{title:"Total Utilisateurs",value:r.totalUsers,icon:Mw,color:"blue"}),c.jsx(fg,{title:"Utilisateurs Actifs",value:r.activeUsers,icon:F1,color:"green"}),c.jsx(fg,{title:"Priodes d'essai",value:r.trialUsers,icon:Dx,color:"yellow"}),c.jsx(fg,{title:"Essais Expirs",value:r.expiredTrials,icon:ni,color:"red"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(uB,{className:"w-5 h-5 text-gray-400"}),c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activit Rcente"})]})}),c.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?c.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:"Aucune activit rcente"}):s.map(d=>c.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:d.userEmail}),c.jsx("span",{className:"text-sm text-gray-500",children:""}),c.jsx("span",{className:"text-sm text-gray-600",children:u(d.action)})]}),d.details&&c.jsxs("div",{className:"text-sm text-gray-500",children:[d.details.email&&c.jsxs("span",{children:["Email: ",d.details.email]}),d.details.role&&c.jsxs("span",{className:"ml-3",children:["Rle: ",d.details.role]})]})]}),c.jsx("div",{className:"text-xs text-gray-400",children:Kn(new Date(d.timestamp),"dd MMM yyyy HH:mm",{locale:Pc})})]})},d.id))})]})]})]})}function fg({title:e,value:t,icon:r,color:n}){const s={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600"};return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsx("div",{className:`p-3 rounded-lg ${s[n]}`,children:c.jsx(r,{className:"w-6 h-6"})})}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),c.jsx("p",{className:"text-sm text-gray-600",children:e})]})]})}function bte(){const e=$s(),{user:t}=On(),[r,n]=J.useState([]),[s,a]=J.useState(!1),[i,o]=J.useState(!0);J.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}l()},[t,e]);const l=async()=>{try{const p=await be.users.toArray();n(p.filter(h=>!h.email.includes("deleted"))),o(!1)}catch(p){console.error("Error loading users:",p),o(!1)}},u=async(p,h,m)=>{const g={id:`audit:${Tr()}`,userId:t.id,userEmail:t.email,action:p,entityType:"user",entityId:h,details:m,timestamp:new Date().toISOString()};await be.auditLogs.add(g)},d=async p=>{try{await be.users.update(p.id,{isActive:!p.isActive}),await u(p.isActive?"disable_user":"enable_user",p.id,{email:p.email,previousStatus:p.isActive}),l()}catch(h){console.error("Error toggling user status:",h),alert("Erreur lors de la modification du statut")}},f=async p=>{if(confirm(`tes-vous sr de vouloir supprimer ${p.firstName} ${p.lastName}?`))try{await be.users.delete(p.id),await u("delete_user",p.id,{email:p.email,name:`${p.firstName} ${p.lastName}`}),l()}catch(h){console.error("Error deleting user:",h),alert("Erreur lors de la suppression")}};return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ii,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-primary-100 text-primary-600 rounded-lg",children:c.jsx(Mw,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Gestion des Utilisateurs"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[r.length," utilisateurs"]})]})]})]}),c.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(ms,{className:"w-4 h-4"}),"Nouvel Utilisateur"]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rle"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priode d'essai"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(p=>{const h=p.trialEndDate&&new Date(p.trialEndDate)<new Date,m=p.trialEndDate?Math.ceil((new Date(p.trialEndDate).getTime()-new Date().getTime())/(1e3*60*60*24)):null;return c.jsxs("tr",{className:h?"bg-red-50":"",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{children:[c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[p.firstName," ",p.lastName]}),c.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.role==="super_admin"?"bg-purple-100 text-purple-800":p.role==="admin"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:p.role==="super_admin"?"Super Admin":p.role==="admin"?"Admin":"User"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.isActive?"Actif":"Dsactiv"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p.trialEndDate?c.jsx("div",{className:h?"text-red-600 font-medium":"",children:h?"Expir":c.jsxs("span",{children:[m," jours restants"]})}):c.jsx("span",{className:"text-gray-400",children:"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsx("div",{className:"flex items-center justify-end gap-2",children:p.role!=="super_admin"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>d(p),className:`p-2 rounded-lg transition-colors ${p.isActive?"hover:bg-red-50 text-red-600":"hover:bg-green-50 text-green-600"}`,title:p.isActive?"Dsactiver":"Activer",children:p.isActive?c.jsx(kB,{className:"w-4 h-4"}):c.jsx(RB,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>f(p),className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",title:"Supprimer",children:c.jsx(xs,{className:"w-4 h-4"})})]})})})]},p.id)})})]})})}),s&&c.jsx(Nte,{onClose:()=>a(!1),onCreated:()=>{a(!1),l()},currentUser:t})]})}function Nte({onClose:e,onCreated:t,currentUser:r}){const[n,s]=J.useState({email:"",password:"",firstName:"",lastName:"",role:"user",trialDays:30,hasTrial:!1}),a=async i=>{i.preventDefault();try{const o=n.hasTrial?new Date(Date.now()+n.trialDays*24*60*60*1e3).toISOString():void 0,l={id:`user:${Tr()}`,email:n.email,firstName:n.firstName,lastName:n.lastName,role:n.role,isActive:!0,trialEndDate:o,createdBy:r.id,createdAt:new Date().toISOString()};await be.users.add(l);const u={id:`audit:${Tr()}`,userId:r.id,userEmail:r.email,action:"create_user",entityType:"user",entityId:l.id,details:{email:l.email,role:l.role,hasTrial:n.hasTrial,trialDays:n.trialDays},timestamp:new Date().toISOString()};await be.auditLogs.add(u),alert(`Utilisateur cr avec succs!
Email: ${n.email}
Mot de passe: ${n.password}

Veuillez communiquer ces informations  l'utilisateur.`),t()}catch(o){console.error("Error creating user:",o),alert("Erreur lors de la cration de l'utilisateur")}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouvel Utilisateur"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx(ii,{className:"w-6 h-6"})})]}),c.jsxs("form",{onSubmit:a,className:"p-6 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Prnom ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.firstName,onChange:i=>s({...n,firstName:i.target.value}),className:"input w-full",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nom ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.lastName,onChange:i=>s({...n,lastName:i.target.value}),className:"input w-full",required:!0})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"email",value:n.email,onChange:i=>s({...n,email:i.target.value}),className:"input w-full",placeholder:"utilisateur@agriculture.gov.ma",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mot de passe ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.password,onChange:i=>s({...n,password:i.target.value}),className:"input w-full",placeholder:"Gnrer un mot de passe fort",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Rle ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{value:n.role,onChange:i=>s({...n,role:i.target.value}),className:"input w-full",children:[c.jsx("option",{value:"user",children:"Utilisateur"}),c.jsx("option",{value:"admin",children:"Administrateur"})]})]}),c.jsxs("div",{className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg",children:[c.jsx("input",{type:"checkbox",checked:n.hasTrial,onChange:i=>s({...n,hasTrial:i.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),c.jsx("label",{className:"text-sm font-medium text-gray-700 flex-1",children:"Priode d'essai"}),n.hasTrial&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",value:n.trialDays,onChange:i=>s({...n,trialDays:parseInt(i.target.value)||30}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-sm",min:"1"}),c.jsx("span",{className:"text-sm text-gray-600",children:"jours"})]})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),c.jsx("button",{type:"submit",className:"flex-1 btn btn-primary",children:"Crer"})]})]})]})})}const Ste=()=>{const{user:e}=On(),[t,r]=J.useState(null),[n,s]=J.useState([]),[a,i]=J.useState(!0),o=J.useMemo(()=>{if(!(e!=null&&e.id))return[];const d=e.id.includes(":")?e.id.split(":").pop():e.id;return[d,`user:${d}`]},[e==null?void 0:e.id]);J.useEffect(()=>{(async()=>{if(!(e!=null&&e.id)){s([]),i(!1);return}i(!0);try{if(St()){const f=await mt.getDeletedProjects();s(f.data||f||[])}else{const p=(await be.projects.filter(h=>!!h.deletedAt).toArray()).filter(h=>o.includes(h.userId));s(p)}}catch(f){console.error("Error loading deleted projects:",f),s([])}finally{i(!1)}})()},[e==null?void 0:e.id,o]);const l=async d=>{if(e){r(d);try{if(St()){await mt.restoreProject(d.replace("project:",""));const f=await mt.getDeletedProjects();s(f.data||f||[])}else{await mt.restoreProject(d),await be.projects.update(d,{deletedAt:void 0,updatedAt:new Date().toISOString()}),await ps("UPDATE","project",d,{deletedAt:null},e.id);const f=await be.projects.filter(p=>!!p.deletedAt).toArray();s(f.filter(p=>o.includes(p.userId)))}}catch(f){console.error("Error restoring project:",f),alert("   ")}finally{r(null)}}},u=async d=>{if(!(!e||!confirm("           !"))){r(d);try{if(St()){await mt.permanentDeleteProject(d.replace("project:",""));const f=await mt.getDeletedProjects();s(f.data||f||[])}else{await be.projects.delete(d);const f=await be.projects.filter(p=>!!p.deletedAt).toArray();s(f.filter(p=>o.includes(p.userId)))}}catch(f){console.error("Error deleting project permanently:",f),alert("    ")}finally{r(null)}}};return a?c.jsx("div",{className:"flex items-center justify-center h-96",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:c.jsx(xs,{className:"w-6 h-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),c.jsx("p",{className:"text-sm text-gray-500",children:"  "})]})]})}),c.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[c.jsx(ni,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-sm text-amber-800",children:[c.jsx("p",{className:"font-medium",children:"   "}),c.jsx("p",{className:"mt-1",children:"       .      ."})]})]}),n.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(xs,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),c.jsx("p",{className:"text-gray-500",children:"   "})]}):c.jsx("div",{className:"card overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),c.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-gray-700",children:""})]})}),c.jsx("tbody",{children:n.map(d=>c.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[c.jsxs("td",{className:"py-3 px-4",children:[c.jsx("div",{className:"font-medium text-gray-900",children:d.objet}),d.societe&&c.jsx("div",{className:"text-xs text-gray-500",children:d.societe})]}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:d.marcheNo}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:d.annee}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Dx,{className:"w-4 h-4 text-gray-400"}),d.deletedAt?Kn(new Date(d.deletedAt),"dd/MM/yyyy HH:mm"):"-"]})}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsxs("button",{onClick:()=>l(d.id),disabled:t===d.id,className:"flex items-center gap-1 px-3 py-1.5 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:"",children:[c.jsx(PB,{className:"w-4 h-4"}),""]}),c.jsxs("button",{onClick:()=>u(d.id),disabled:t===d.id,className:"flex items-center gap-1 px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:" ",children:[c.jsx(xs,{className:"w-4 h-4"})," "]})]})})]},d.id))})]})})})]})},us=({children:e})=>{var p,h;const{t,i18n:r}=$i(),n=Mf(),s=$s(),{user:a,logout:i}=On(),[o,l]=J.useState(!0),u=()=>{i(),s("/login")},d=m=>{r.changeLanguage(m)},f=[{path:"/",icon:bB,label:t("dashboard.title")},{path:"/projects",icon:Bu,label:t("project.projects")},{path:"/delais",icon:vl,label:"Gestion des Dlais"},{path:"/trash",icon:xs,label:" "},{path:"/settings",icon:Ow,label:t("settings.title")}];return(a==null?void 0:a.role)==="super_admin"&&f.splice(2,0,{path:"/admin",icon:F1,label:"Administration"}),c.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[c.jsxs("aside",{className:`${o?"w-64":"w-20"} bg-white border-r border-gray-200 transition-all duration-300 relative flex flex-col`,children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[o&&c.jsx("h1",{className:"text-xl font-bold text-primary-600",children:t("app.title")}),c.jsx("button",{onClick:()=>l(!o),className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(AB,{className:"w-5 h-5"})})]}),c.jsx("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:f.map(m=>{const g=m.icon,y=n.pathname===m.path;return c.jsxs(Pi,{to:m.path,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${y?"bg-primary-50 text-primary-600":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(g,{className:"w-5 h-5 flex-shrink-0"}),o&&c.jsx("span",{children:m.label})]},m.path)})}),c.jsxs("div",{className:"p-4 border-t mt-auto",children:[c.jsxs("div",{className:"mb-4",children:[o&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>d("fr"),className:`px-3 py-1 text-sm rounded ${r.language==="fr"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"FR"}),c.jsx("button",{onClick:()=>d("ar"),className:`px-3 py-1 text-sm rounded ${r.language==="ar"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"AR"}),c.jsx("button",{onClick:()=>d("en"),className:`px-3 py-1 text-sm rounded ${r.language==="en"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"EN"})]}),!o&&c.jsx(vB,{className:"w-5 h-5 mx-auto text-gray-500"})]}),c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsxs("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 font-semibold flex-shrink-0",children:[(p=a==null?void 0:a.firstName)==null?void 0:p[0],(h=a==null?void 0:a.lastName)==null?void 0:h[0]]}),o&&c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]}),c.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]}),c.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[c.jsx(EB,{className:"w-5 h-5 flex-shrink-0"}),o&&c.jsx("span",{children:t("auth.logout")})]})]})]}),c.jsx("main",{className:"flex-1 overflow-auto",children:c.jsx("div",{className:"p-8",children:e})})]})},kte=({syncState:e,onSync:t,onClearPending:r})=>{const{t:n}=$i(),[s,a]=J.useState(!1),[i,o]=J.useState(!1),l=()=>{if(e.realtimeConnected||e.status==="realtime")return c.jsx(TB,{className:"w-4 h-4 text-green-500 animate-pulse"});switch(e.status){case"offline":return c.jsx(Au,{className:"w-4 h-4 text-red-500"});case"syncing":case"pulling":return c.jsx(fv,{className:"w-4 h-4 text-blue-500 animate-spin"});case"synced":return c.jsx(T1,{className:"w-4 h-4 text-green-500"});case"error":return c.jsx(ni,{className:"w-4 h-4 text-red-500"});default:return c.jsx(OB,{className:"w-4 h-4 text-gray-500"})}},u=()=>e.realtimeConnected||e.status==="realtime"?n("sync.status.realtime","En direct"):n(`sync.status.${e.status}`),d=()=>{if(e.realtimeConnected||e.status==="realtime")return"bg-green-100 text-green-800 border-green-200";switch(e.status){case"offline":return"bg-red-100 text-red-800 border-red-200";case"syncing":case"pulling":return"bg-blue-100 text-blue-800 border-blue-200";case"synced":return"bg-green-100 text-green-800 border-green-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},f=async()=>{if(r){o(!0);try{await r(),a(!1)}finally{o(!1)}}};return c.jsxs("div",{className:"fixed top-4 right-4 z-50",children:[c.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border shadow-sm ${d()} cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>e.status==="error"?a(!s):t==null?void 0:t(),title:e.status==="error"?n("sync.clickForOptions","Cliquer pour options"):n("sync.clickToSync","Cliquer pour synchroniser"),children:[l(),c.jsx("span",{className:"text-sm font-medium",children:u()}),e.pendingOperations>0&&c.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-white rounded-full",children:e.pendingOperations}),t&&e.status!=="syncing"&&e.status!=="pulling"&&c.jsx(No,{className:"w-4 h-4 ml-1 opacity-60 hover:opacity-100"})]}),e.error&&c.jsxs("div",{className:"mt-2 p-2 text-xs text-red-700 bg-red-50 rounded-lg border border-red-200",children:[c.jsx("p",{children:e.error}),r&&e.pendingOperations>0&&c.jsxs("button",{onClick:f,disabled:i,className:"mt-2 flex items-center gap-1 px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded transition-colors disabled:opacity-50",children:[i?c.jsx(fv,{className:"w-3 h-3 animate-spin"}):c.jsx(xs,{className:"w-3 h-3"}),n("sync.clearPending","Effacer les oprations en attente")," (",e.pendingOperations,")"]})]}),s&&e.status==="error"&&c.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border shadow-lg",children:[c.jsxs("button",{onClick:()=>{t==null||t(),a(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[c.jsx(No,{className:"w-4 h-4"}),n("sync.retry","Ressayer la synchronisation")]}),r&&c.jsxs("button",{onClick:f,disabled:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-700 hover:bg-red-50 rounded disabled:opacity-50",children:[i?c.jsx(fv,{className:"w-4 h-4 animate-spin"}):c.jsx(xs,{className:"w-4 h-4"}),n("sync.clearAndRetry","Effacer et ressayer")]})]})]})};function _te(){const{isUpdateAvailable:e,updateInfo:t,isDownloading:r,downloadProgress:n,isUpdateDownloaded:s,error:a}=TC(),[i,o]=J.useState(!1);if(i||!e&&!s&&!a)return null;const l=async()=>{if(window.electron)try{const f=await window.electron.downloadUpdate();f.error&&console.error("Failed to download update:",f.error)}catch(f){console.error("Error downloading update:",f)}},u=async()=>{if(window.electron)try{await window.electron.installUpdate()}catch(f){console.error("Error installing update:",f)}},d=f=>{if(f===0)return"0 Bytes";const p=1024,h=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(f)/Math.log(p));return Math.round(f/Math.pow(p,m)*100)/100+" "+h[m]};return c.jsx("div",{className:"fixed top-4 right-4 z-50 w-96 animate-in slide-in-from-top-5",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:[c.jsxs("div",{className:"flex items-start justify-between p-4 bg-gradient-to-r from-blue-500 to-blue-600",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[s?c.jsx(T1,{className:"h-6 w-6 text-white"}):a?c.jsx(ni,{className:"h-6 w-6 text-white"}):c.jsx(No,{className:`h-6 w-6 text-white ${r?"animate-spin":""}`}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:s?"  ":a?"  ":r?"  ...":" "}),t&&c.jsxs("p",{className:"text-sm text-blue-100",children:[" ",t.version]})]})]}),c.jsx("button",{onClick:()=>o(!0),className:"text-white hover:text-gray-200 transition-colors",children:c.jsx(Bi,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"p-4",children:a?c.jsxs("div",{className:"text-sm text-red-600",children:[c.jsx("p",{className:"font-medium",children:"   :"}),c.jsx("p",{className:"mt-1 text-xs",children:a})]}):s?c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"   .       ."}),c.jsxs("button",{onClick:u,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[c.jsx(No,{className:"h-4 w-4"}),"  "]})]}):r&&n?c.jsxs("div",{children:[c.jsxs("div",{className:"mb-2 flex justify-between text-sm text-gray-600",children:[c.jsx("span",{children:" ..."}),c.jsxs("span",{children:[n.percent,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2 overflow-hidden",children:c.jsx("div",{className:"bg-blue-500 h-full transition-all duration-300 ease-out",style:{width:`${n.percent}%`}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[c.jsxs("span",{children:[d(n.transferred)," / ",d(n.total)]}),c.jsxs("span",{children:[d(n.bytesPerSecond),"/s"]})]})]}):c.jsxs("div",{children:[(t==null?void 0:t.releaseNotes)&&c.jsxs("div",{className:"mb-4 text-sm text-gray-700 max-h-32 overflow-y-auto",children:[c.jsx("p",{className:"font-medium mb-1",children:" :"}),c.jsx("div",{className:"text-xs whitespace-pre-wrap",children:t.releaseNotes})]}),c.jsxs("button",{onClick:l,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[c.jsx(Sl,{className:"h-4 w-4"})," "]})]})}),!a&&!s&&c.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:c.jsx("p",{className:"text-xs text-gray-500 text-center",children:"      "})})]})})}const Ete=()=>{const{projectId:e}=Ku();return c.jsx(Br,{to:`/projects/${e}`,replace:!0})};function Ate(){$i();const{user:e,isInitialized:t,checkAuth:r}=On(),{syncState:n,sync:s,clearPendingOperations:a}=iB(Eu()&&(e==null?void 0:e.id)||null),[i,o]=J.useState({isOnline:navigator.onLine,lastCheck:Date.now()});J.useEffect(()=>{if(!St())return;console.log(" [WEB] Server-First mode - No IndexedDB, No Sync Engine");const u=()=>o({isOnline:!0,lastCheck:Date.now()}),d=()=>o({isOnline:!1,lastCheck:Date.now()});return window.addEventListener("online",u),window.addEventListener("offline",d),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",d)}},[]),oB(),J.useEffect(()=>St()?(window.btpStatus=()=>({mode:"WEB SERVER-FIRST",online:i.isOnline,message:"Web mode - all data loaded directly from server, no local storage"}),()=>{delete window.btpStatus}):(window.btpSync={sync:s,clearPendingOperations:a,status:()=>({mode:"ELECTRON OFFLINE-FIRST",syncState:n,message:"Electron mode - IndexedDB + Sync Engine"})},()=>{delete window.btpSync}),[i,n,s,a]),J.useEffect(()=>{r()},[r]),J.useEffect(()=>{if(!t){console.log(" Waiting for auth to initialize...");return}if(!e){console.log(" No user, skipping sync");return}if(console.log(" Auth initialized for user:",e.id),St()){console.log(" [WEB] Server-First mode - No sync, no IndexedDB");return}console.log(" [ELECTRON] Offline-First mode - Starting sync...");const u=setTimeout(()=>{s().catch(d=>{var f;((f=d.response)==null?void 0:f.status)!==401&&console.error("Sync error:",d)})},300);return()=>clearTimeout(u)},[t,e==null?void 0:e.id,s]);const l=St()?{status:i.isOnline?"synced":"offline",lastSyncTime:i.lastCheck,pendingOperations:0,error:i.isOnline?null:"Mode hors ligne",lastPullCount:0,realtimeConnected:!1}:n;return c.jsxs(c.Fragment,{children:[c.jsx(kte,{syncState:l,onSync:Eu()?s:void 0,onClearPending:Eu()?a:void 0}),c.jsx(_te,{}),c.jsxs(QD,{children:[c.jsx(Dr,{path:"/login",element:c.jsx(UB,{})}),c.jsx(Dr,{path:"/register",element:c.jsx($B,{})}),c.jsx(Dr,{path:"/",element:e?c.jsx(us,{children:c.jsx(L$,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects",element:e?c.jsx(us,{children:c.jsx(F$,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/new",element:e?c.jsx(us,{children:c.jsx(PJ,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:id",element:e?c.jsx(us,{children:c.jsx(AJ,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:id/edit",element:e?c.jsx(us,{children:c.jsx(LJ,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/delais",element:e?c.jsx(us,{children:c.jsx(IJ,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/bordereau",element:e?c.jsx(us,{children:c.jsx(MJ,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/metre",element:e?c.jsx(us,{children:c.jsx(rg,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/metres",element:e?c.jsx(Ete,{}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/metre-v3",element:e?c.jsx(us,{children:c.jsx(rg,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/metre/:periodeId",element:e?c.jsx(us,{children:c.jsx(rg,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/decompte",element:c.jsx(Br,{to:"..",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/decomptes",element:c.jsx(Br,{to:"..",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/decompte/:periodeId",element:e?c.jsx(us,{children:c.jsx(dE,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/periodes",element:e?c.jsx(Br,{to:`/projects/${window.location.pathname.split("/")[2]}/metre`,replace:!0}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/periodes/:periodeId/metre",element:e?c.jsx(us,{children:c.jsx(rg,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/periodes/:periodeId/decompte",element:e?c.jsx(us,{children:c.jsx(dE,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/periodes/:periodeId/attachement",element:e?c.jsx(us,{children:c.jsx(fE,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/projects/:projectId/attachement",element:e?c.jsx(us,{children:c.jsx(fE,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/settings",element:e?c.jsx(us,{children:c.jsx(yte,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/trash",element:e?c.jsx(us,{children:c.jsx(Ste,{})}):c.jsx(Br,{to:"/login",replace:!0})}),c.jsx(Dr,{path:"/admin",element:(e==null?void 0:e.role)==="super_admin"?c.jsx(wte,{}):c.jsx(Br,{to:"/",replace:!0})}),c.jsx(Dr,{path:"/admin/users",element:(e==null?void 0:e.role)==="super_admin"?c.jsx(bte,{}):c.jsx(Br,{to:"/",replace:!0})}),c.jsx(Dr,{path:"*",element:c.jsx(Br,{to:"/",replace:!0})})]})]})}const Gt=e=>typeof e=="string",Dh=()=>{let e,t;const r=new Promise((n,s)=>{e=n,t=s});return r.resolve=e,r.reject=t,r},hE=e=>e==null?"":""+e,jte=(e,t,r)=>{e.forEach(n=>{t[n]&&(r[n]=t[n])})},Cte=/###/g,pE=e=>e&&e.indexOf("###")>-1?e.replace(Cte,"."):e,mE=e=>!e||Gt(e),N0=(e,t,r)=>{const n=Gt(t)?t.split("."):t;let s=0;for(;s<n.length-1;){if(mE(e))return{};const a=pE(n[s]);!e[a]&&r&&(e[a]=new r),Object.prototype.hasOwnProperty.call(e,a)?e=e[a]:e={},++s}return mE(e)?{}:{obj:e,k:pE(n[s])}},gE=(e,t,r)=>{const{obj:n,k:s}=N0(e,t,Object);if(n!==void 0||t.length===1){n[s]=r;return}let a=t[t.length-1],i=t.slice(0,t.length-1),o=N0(e,i,Object);for(;o.obj===void 0&&i.length;)a=`${i[i.length-1]}.${a}`,i=i.slice(0,i.length-1),o=N0(e,i,Object),o&&o.obj&&typeof o.obj[`${o.k}.${a}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${a}`]=r},Tte=(e,t,r,n)=>{const{obj:s,k:a}=N0(e,t,Object);s[a]=s[a]||[],s[a].push(r)},ex=(e,t)=>{const{obj:r,k:n}=N0(e,t);if(r)return r[n]},Pte=(e,t,r)=>{const n=ex(e,r);return n!==void 0?n:ex(t,r)},VP=(e,t,r)=>{for(const n in t)n!=="__proto__"&&n!=="constructor"&&(n in e?Gt(e[n])||e[n]instanceof String||Gt(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):VP(e[n],t[n],r):e[n]=t[n]);return e},Ed=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Lte={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Fte=e=>Gt(e)?e.replace(/[&<>"'\/]/g,t=>Lte[t]):e;class Dte{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}const Rte=[" ",",","?","!",";"],Ite=new Dte(20),Ote=(e,t,r)=>{t=t||"",r=r||"";const n=Rte.filter(i=>t.indexOf(i)<0&&r.indexOf(i)<0);if(n.length===0)return!0;const s=Ite.getRegExp(`(${n.map(i=>i==="?"?"\\?":i).join("|")})`);let a=!s.test(e);if(!a){const i=e.indexOf(r);i>0&&!s.test(e.substring(0,i))&&(a=!0)}return a},u5=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];const n=t.split(r);let s=e;for(let a=0;a<n.length;){if(!s||typeof s!="object")return;let i,o="";for(let l=a;l<n.length;++l)if(l!==a&&(o+=r),o+=n[l],i=s[o],i!==void 0){if(["string","number","boolean"].indexOf(typeof i)>-1&&l<n.length-1)continue;a+=l-a+1;break}s=i}return s},tx=e=>e&&e.replace("_","-"),Mte={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class rx{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||Mte,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,n,s){return s&&!this.debug?null:(Gt(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new rx(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new rx(this.logger,t)}}var mo=new rx;class qx{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const s=this.observers[n].get(r)||0;this.observers[n].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(i=>{let[o,l]=i;for(let u=0;u<l;u++)o(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(i=>{let[o,l]=i;for(let u=0;u<l;u++)o.apply(o,[t,...n])})}}class xE extends qx{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,i=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;t.indexOf(".")>-1?o=t.split("."):(o=[t,r],n&&(Array.isArray(n)?o.push(...n):Gt(n)&&a?o.push(...n.split(a)):o.push(n)));const l=ex(this.data,o);return!l&&!r&&!n&&t.indexOf(".")>-1&&(t=o[0],r=o[1],n=o.slice(2).join(".")),l||!i||!Gt(n)?l:u5(this.data&&this.data[t]&&this.data[t][r],n,a)}addResource(t,r,n,s){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let o=[t,r];n&&(o=o.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(o=t.split("."),s=r,r=o[1]),this.addNamespaces(r),gE(this.data,o,s),a.silent||this.emit("added",t,r,n,s)}addResources(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in n)(Gt(n[a])||Array.isArray(n[a]))&&this.addResource(t,r,a,n[a],{silent:!0});s.silent||this.emit("added",t,r,n)}addResourceBundle(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[t,r];t.indexOf(".")>-1&&(o=t.split("."),s=n,n=r,r=o[1]),this.addNamespaces(r);let l=ex(this.data,o)||{};i.skipCopy||(n=JSON.parse(JSON.stringify(n))),s?VP(l,n,a):l={...l,...n},gE(this.data,o,l),i.silent||this.emit("added",t,r,n)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var KP={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,s){return e.forEach(a=>{this.processors[a]&&(t=this.processors[a].process(t,r,n,s))}),t}};const vE={};class nx extends qx{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),jte(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=mo.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const n=this.resolve(t,r);return n&&n.res!==void 0}extractFromKey(t,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let a=r.ns||this.options.defaultNS||[];const i=n&&t.indexOf(n)>-1,o=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Ote(t,n,s);if(i&&!o){const l=t.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:t,namespaces:Gt(a)?[a]:a};const u=t.split(n);(n!==s||n===s&&this.options.ns.indexOf(u[0])>-1)&&(a=u.shift()),t=u.join(s)}return{key:t,namespaces:Gt(a)?[a]:a}}translate(t,r,n){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:i,namespaces:o}=this.extractFromKey(t[t.length-1],r),l=o[o.length-1],u=r.lng||this.language,d=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(d){const N=r.nsSeparator||this.options.nsSeparator;return s?{res:`${l}${N}${i}`,usedKey:i,exactUsedKey:i,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:`${l}${N}${i}`}return s?{res:i,usedKey:i,exactUsedKey:i,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:i}const f=this.resolve(t,r);let p=f&&f.res;const h=f&&f.usedKey||i,m=f&&f.exactUsedKey||i,g=Object.prototype.toString.apply(p),y=["[object Number]","[object Function]","[object RegExp]"],x=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,w=!this.i18nFormat||this.i18nFormat.handleAsObject,b=!Gt(p)&&typeof p!="boolean"&&typeof p!="number";if(w&&p&&b&&y.indexOf(g)<0&&!(Gt(x)&&Array.isArray(p))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const N=this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,p,{...r,ns:o}):`key '${i} (${this.language})' returned an object instead of string.`;return s?(f.res=N,f.usedParams=this.getUsedParamsDetails(r),f):N}if(a){const N=Array.isArray(p),A=N?[]:{},P=N?m:h;for(const j in p)if(Object.prototype.hasOwnProperty.call(p,j)){const D=`${P}${a}${j}`;A[j]=this.translate(D,{...r,joinArrays:!1,ns:o}),A[j]===D&&(A[j]=p[j])}p=A}}else if(w&&Gt(x)&&Array.isArray(p))p=p.join(x),p&&(p=this.extendTranslation(p,t,r,n));else{let N=!1,A=!1;const P=r.count!==void 0&&!Gt(r.count),j=nx.hasDefaultValue(r),D=P?this.pluralResolver.getSuffix(u,r.count,r):"",E=r.ordinal&&P?this.pluralResolver.getSuffix(u,r.count,{ordinal:!1}):"",I=P&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),_=I&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${D}`]||r[`defaultValue${E}`]||r.defaultValue;!this.isValidLookup(p)&&j&&(N=!0,p=_),this.isValidLookup(p)||(A=!0,p=i);const M=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&A?void 0:p,K=j&&_!==p&&this.options.updateMissing;if(A||N||K){if(this.logger.log(K?"updateKey":"missingKey",u,l,i,K?_:p),a){const re=this.resolve(i,{...r,keySeparator:!1});re&&re.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let Z=[];const ae=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&ae&&ae[0])for(let re=0;re<ae.length;re++)Z.push(ae[re]);else this.options.saveMissingTo==="all"?Z=this.languageUtils.toResolveHierarchy(r.lng||this.language):Z.push(r.lng||this.language);const he=(re,U,ue)=>{const pe=j&&ue!==p?ue:M;this.options.missingKeyHandler?this.options.missingKeyHandler(re,l,U,pe,K,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(re,l,U,pe,K,r),this.emit("missingKey",re,l,U,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&P?Z.forEach(re=>{const U=this.pluralResolver.getSuffixes(re,r);I&&r[`defaultValue${this.options.pluralSeparator}zero`]&&U.indexOf(`${this.options.pluralSeparator}zero`)<0&&U.push(`${this.options.pluralSeparator}zero`),U.forEach(ue=>{he([re],i+ue,r[`defaultValue${ue}`]||_)})}):he(Z,i,_))}p=this.extendTranslation(p,t,r,f,n),A&&p===i&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${i}`),(A||N)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${i}`:i,N?p:void 0):p=this.options.parseMissingKeyHandler(p))}return s?(f.res=p,f.usedParams=this.getUsedParamsDetails(r),f):p}extendTranslation(t,r,n,s,a){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const u=Gt(t)&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let d;if(u){const p=t.match(this.interpolator.nestingRegexp);d=p&&p.length}let f=n.replace&&!Gt(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(f={...this.options.interpolation.defaultVariables,...f}),t=this.interpolator.interpolate(t,f,n.lng||this.language||s.usedLng,n),u){const p=t.match(this.interpolator.nestingRegexp),h=p&&p.length;d<h&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&s&&s.res&&(n.lng=this.language||s.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var p=arguments.length,h=new Array(p),m=0;m<p;m++)h[m]=arguments[m];return a&&a[0]===h[0]&&!n.context?(i.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${r[0]}`),null):i.translate(...h,r)},n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,l=Gt(o)?[o]:o;return t!=null&&l&&l.length&&n.applyPostProcessor!==!1&&(t=KP.handle(l,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,s,a,i,o;return Gt(t)&&(t=[t]),t.forEach(l=>{if(this.isValidLookup(n))return;const u=this.extractFromKey(l,r),d=u.key;s=d;let f=u.namespaces;this.options.fallbackNS&&(f=f.concat(this.options.fallbackNS));const p=r.count!==void 0&&!Gt(r.count),h=p&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),m=r.context!==void 0&&(Gt(r.context)||typeof r.context=="number")&&r.context!=="",g=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);f.forEach(y=>{this.isValidLookup(n)||(o=y,!vE[`${g[0]}-${y}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(vE[`${g[0]}-${y}`]=!0,this.logger.warn(`key "${s}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(x=>{if(this.isValidLookup(n))return;i=x;const w=[d];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(w,d,x,y,r);else{let N;p&&(N=this.pluralResolver.getSuffix(x,r.count,r));const A=`${this.options.pluralSeparator}zero`,P=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(w.push(d+N),r.ordinal&&N.indexOf(P)===0&&w.push(d+N.replace(P,this.options.pluralSeparator)),h&&w.push(d+A)),m){const j=`${d}${this.options.contextSeparator}${r.context}`;w.push(j),p&&(w.push(j+N),r.ordinal&&N.indexOf(P)===0&&w.push(j+N.replace(P,this.options.pluralSeparator)),h&&w.push(j+A))}}let b;for(;b=w.pop();)this.isValidLookup(n)||(a=b,n=this.getResource(x,y,b,r))}))})}),{res:n,usedKey:s,exactUsedKey:a,usedLng:i,usedNS:o}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,n,s):this.resourceStore.getResource(t,r,n,s)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!Gt(t.replace);let s=n?t.replace:t;if(n&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!n){s={...s};for(const a of r)delete s[a]}return s}static hasDefaultValue(t){const r="defaultValue";for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r===n.substring(0,r.length)&&t[n]!==void 0)return!0;return!1}}const Xv=e=>e.charAt(0).toUpperCase()+e.slice(1);class yE{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=mo.create("languageUtils")}getScriptPartFromCode(t){if(t=tx(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=tx(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(Gt(t)&&t.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let s=Intl.getCanonicalLocales(t)[0];if(s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s)return s}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let n=t.split("-");return this.options.lowerCaseLng?n=n.map(s=>s.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Xv(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Xv(n[1].toLowerCase())),r.indexOf(n[2].toLowerCase())>-1&&(n[2]=Xv(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(n=>{if(r)return;const s=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(n=>{if(r)return;const s=this.getLanguagePartFromCode(n);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(a=>{if(a===s)return a;if(!(a.indexOf("-")<0&&s.indexOf("-")<0)&&(a.indexOf("-")>0&&s.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===s||a.indexOf(s)===0&&s.length>1))return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),Gt(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let n=t[r];return n||(n=t[this.getScriptPartFromCode(r)]),n||(n=t[this.formatLanguageCode(r)]),n||(n=t[this.getLanguagePartFromCode(r)]),n||(n=t.default),n||[]}toResolveHierarchy(t,r){const n=this.getFallbackCodes(r||this.options.fallbackLng||[],t),s=[],a=i=>{i&&(this.isSupportedCode(i)?s.push(i):this.logger.warn(`rejecting language code not found in supportedLngs: ${i}`))};return Gt(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):Gt(t)&&a(this.formatLanguageCode(t)),n.forEach(i=>{s.indexOf(i)<0&&a(this.formatLanguageCode(i))}),s}}let Bte=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Ute={1:e=>+(e>1),2:e=>+(e!=1),3:e=>0,4:e=>e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,5:e=>e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5,6:e=>e==1?0:e>=2&&e<=4?1:2,7:e=>e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,8:e=>e==1?0:e==2?1:e!=8&&e!=11?2:3,9:e=>+(e>=2),10:e=>e==1?0:e==2?1:e<7?2:e<11?3:4,11:e=>e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3,12:e=>+(e%10!=1||e%100==11),13:e=>+(e!==0),14:e=>e==1?0:e==2?1:e==3?2:3,15:e=>e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2,16:e=>e%10==1&&e%100!=11?0:e!==0?1:2,17:e=>e==1||e%10==1&&e%100!=11?0:1,18:e=>e==0?0:e==1?1:2,19:e=>e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3,20:e=>e==1?0:e==0||e%100>0&&e%100<20?1:2,21:e=>e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0,22:e=>e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3};const $te=["v1","v2","v3"],zte=["v4"],wE={zero:0,one:1,two:2,few:3,many:4,other:5},Hte=()=>{const e={};return Bte.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:Ute[t.fc]}})}),e};class qte{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=mo.create("pluralResolver"),(!this.options.compatibilityJSON||zte.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Hte(),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const n=tx(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:s});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let i;try{i=new Intl.PluralRules(n,{type:s})}catch{if(!t.match(/-|_/))return;const l=this.languageUtils.getLanguagePartFromCode(t);i=this.getRule(l,r)}return this.pluralRulesCache[a]=i,i}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(s=>`${r}${s}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((s,a)=>wE[s]-wE[a]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):n.numbers.map(s=>this.getSuffix(t,s,r)):[]}getSuffix(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(t,n);return s?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:this.getSuffixRetroCompatible(s,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){const n=t.noAbs?t.plurals(r):t.plurals(Math.abs(r));let s=t.numbers[n];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(s===2?s="plural":s===1&&(s=""));const a=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return this.options.compatibilityJSON==="v1"?s===1?"":typeof s=="number"?`_plural_${s.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!$te.includes(this.options.compatibilityJSON)}}const bE=function(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=Pte(e,t,r);return!a&&s&&Gt(r)&&(a=u5(e,r,n),a===void 0&&(a=u5(t,r,n))),a},Jv=e=>e.replace(/\$/g,"$$$$");class Wte{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=mo.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:s,prefix:a,prefixEscaped:i,suffix:o,suffixEscaped:l,formatSeparator:u,unescapeSuffix:d,unescapePrefix:f,nestingPrefix:p,nestingPrefixEscaped:h,nestingSuffix:m,nestingSuffixEscaped:g,nestingOptionsSeparator:y,maxReplaces:x,alwaysFormat:w}=t.interpolation;this.escape=r!==void 0?r:Fte,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=a?Ed(a):i||"{{",this.suffix=o?Ed(o):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=d?"":f||"-",this.unescapeSuffix=this.unescapePrefix?"":d||"",this.nestingPrefix=p?Ed(p):h||Ed("$t("),this.nestingSuffix=m?Ed(m):g||Ed(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=x||1e3,this.alwaysFormat=w!==void 0?w:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,n)=>r&&r.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,n,s){let a,i,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=h=>{if(h.indexOf(this.formatSeparator)<0){const x=bE(r,l,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(x,void 0,n,{...s,...r,interpolationkey:h}):x}const m=h.split(this.formatSeparator),g=m.shift().trim(),y=m.join(this.formatSeparator).trim();return this.format(bE(r,l,g,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...s,...r,interpolationkey:g})};this.resetRegExp();const d=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,f=s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>Jv(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?Jv(this.escape(h)):Jv(h)}].forEach(h=>{for(o=0;a=h.regex.exec(t);){const m=a[1].trim();if(i=u(m),i===void 0)if(typeof d=="function"){const y=d(t,a,s);i=Gt(y)?y:""}else if(s&&Object.prototype.hasOwnProperty.call(s,m))i="";else if(f){i=a[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${t}`),i="";else!Gt(i)&&!this.useRawValueToEscape&&(i=hE(i));const g=h.safeValue(i);if(t=t.replace(a[0],g),f?(h.regex.lastIndex+=i.length,h.regex.lastIndex-=a[0].length):h.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),t}nest(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,a,i;const o=(l,u)=>{const d=this.nestingOptionsSeparator;if(l.indexOf(d)<0)return l;const f=l.split(new RegExp(`${d}[ ]*{`));let p=`{${f[1]}`;l=f[0],p=this.interpolate(p,i);const h=p.match(/'/g),m=p.match(/"/g);(h&&h.length%2===0&&!m||m.length%2!==0)&&(p=p.replace(/'/g,'"'));try{i=JSON.parse(p),u&&(i={...u,...i})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,g),`${l}${d}${p}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,l};for(;s=this.nestingRegexp.exec(t);){let l=[];i={...n},i=i.replace&&!Gt(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;let u=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const d=s[1].split(this.formatSeparator).map(f=>f.trim());s[1]=d.shift(),l=d,u=!0}if(a=r(o.call(this,s[1].trim(),i),i),a&&s[0]===t&&!Gt(a))return a;Gt(a)||(a=hE(a)),a||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),a=""),u&&(a=l.reduce((d,f)=>this.format(d,f,n.lng,{...n,interpolationkey:s[1].trim()}),a.trim())),t=t.replace(s[0],a),this.regexp.lastIndex=0}return t}}const Vte=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const s=n[1].substring(0,n[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(i=>{if(i){const[o,...l]=i.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),d=o.trim();r[d]||(r[d]=u),u==="false"&&(r[d]=!1),u==="true"&&(r[d]=!0),isNaN(u)||(r[d]=parseInt(u,10))}})}return{formatName:t,formatOptions:r}},Ad=e=>{const t={};return(r,n,s)=>{let a=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(a={...a,[s.interpolationkey]:void 0});const i=n+JSON.stringify(a);let o=t[i];return o||(o=e(tx(n),s),t[i]=o),o(r)}};class Kte{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=mo.create("formatter"),this.options=t,this.formats={number:Ad((r,n)=>{const s=new Intl.NumberFormat(r,{...n});return a=>s.format(a)}),currency:Ad((r,n)=>{const s=new Intl.NumberFormat(r,{...n,style:"currency"});return a=>s.format(a)}),datetime:Ad((r,n)=>{const s=new Intl.DateTimeFormat(r,{...n});return a=>s.format(a)}),relativetime:Ad((r,n)=>{const s=new Intl.RelativeTimeFormat(r,{...n});return a=>s.format(a,n.range||"day")}),list:Ad((r,n)=>{const s=new Intl.ListFormat(r,{...n});return a=>s.format(a)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=Ad(r)}format(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(o=>o.indexOf(")")>-1)){const o=a.findIndex(l=>l.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,o)].join(this.formatSeparator)}return a.reduce((o,l)=>{const{formatName:u,formatOptions:d}=Vte(l);if(this.formats[u]){let f=o;try{const p=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},h=p.locale||p.lng||s.locale||s.lng||n;f=this.formats[u](o,h,{...d,...s,...p})}catch(p){this.logger.warn(p)}return f}else this.logger.warn(`there was no format function for ${u}`);return o},t)}}const Gte=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Yte extends qx{constructor(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=s,this.logger=mo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,s.backend,s)}queueLoad(t,r,n,s){const a={},i={},o={},l={};return t.forEach(u=>{let d=!0;r.forEach(f=>{const p=`${u}|${f}`;!n.reload&&this.store.hasResourceBundle(u,f)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?i[p]===void 0&&(i[p]=!0):(this.state[p]=1,d=!1,i[p]===void 0&&(i[p]=!0),a[p]===void 0&&(a[p]=!0),l[f]===void 0&&(l[f]=!0)))}),d||(o[u]=!0)}),(Object.keys(a).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(a),pending:Object.keys(i),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(t,r,n){const s=t.split("|"),a=s[0],i=s[1];r&&this.emit("failedLoading",a,i,r),!r&&n&&this.store.addResourceBundle(a,i,n,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&n&&(this.state[t]=0);const o={};this.queue.forEach(l=>{Tte(l.loaded,[a],i),Gte(l,t),r&&l.errors.push(r),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{o[u]||(o[u]={});const d=l.loaded[u];d.length&&d.forEach(f=>{o[u][f]===void 0&&(o[u][f]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!t.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:n,tried:s,wait:a,callback:i});return}this.readingCalls++;const o=(u,d)=>{if(this.readingCalls--,this.waitingReads.length>0){const f=this.waitingReads.shift();this.read(f.lng,f.ns,f.fcName,f.tried,f.wait,f.callback)}if(u&&d&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,n,s+1,a*2,i)},a);return}i(u,d)},l=this.backend[n].bind(this.backend);if(l.length===2){try{const u=l(t,r);u&&typeof u.then=="function"?u.then(d=>o(null,d)).catch(o):o(null,u)}catch(u){o(u)}return}return l(t,r,o)}prepareLoading(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();Gt(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Gt(r)&&(r=[r]);const a=this.queueLoad(t,r,n,s);if(!a.toLoad.length)return a.pending.length||s(),null;a.toLoad.forEach(i=>{this.loadOne(i)})}load(t,r,n){this.prepareLoading(t,r,{},n)}reload(t,r,n){this.prepareLoading(t,r,{reload:!0},n)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=t.split("|"),s=n[0],a=n[1];this.read(s,a,"read",void 0,void 0,(i,o)=>{i&&this.logger.warn(`${r}loading namespace ${a} for language ${s} failed`,i),!i&&o&&this.logger.log(`${r}loaded namespace ${a} for language ${s}`,o),this.loaded(t,i,o)})}saveMissing(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){const l={...i,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let d;u.length===5?d=u(t,r,n,s,l):d=u(t,r,n,s),d&&typeof d.then=="function"?d.then(f=>o(null,f)).catch(o):o(null,d)}catch(d){o(d)}else u(t,r,n,s,o,l)}!t||!t[0]||this.store.addResource(t[0],r,n,s)}}}const NE=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),Gt(e[1])&&(t.defaultValue=e[1]),Gt(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(n=>{t[n]=r[n]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),SE=e=>(Gt(e.ns)&&(e.ns=[e.ns]),Gt(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Gt(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),hg=()=>{},Xte=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class pp extends qx{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=SE(t),this.services={},this.logger=mo,this.modules={external:[]},Xte(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(n=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(Gt(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const s=NE();this.options={...s,...this.options,...SE(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const a=d=>d?typeof d=="function"?new d:d:null;if(!this.options.isClone){this.modules.logger?mo.init(a(this.modules.logger),this.options):mo.init(null,this.options);let d;this.modules.formatter?d=this.modules.formatter:typeof Intl<"u"&&(d=Kte);const f=new yE(this.options);this.store=new xE(this.options.resources,this.options);const p=this.services;p.logger=mo,p.resourceStore=this.store,p.languageUtils=f,p.pluralResolver=new qte(f,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),d&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(p.formatter=a(d),p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new Wte(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new Yte(a(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",function(h){for(var m=arguments.length,g=new Array(m>1?m-1:0),y=1;y<m;y++)g[y-1]=arguments[y];t.emit(h,...g)}),this.modules.languageDetector&&(p.languageDetector=a(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=a(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new nx(this.services,this.options),this.translator.on("*",function(h){for(var m=arguments.length,g=new Array(m>1?m-1:0),y=1;y<m;y++)g[y-1]=arguments[y];t.emit(h,...g)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,n||(n=hg),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const d=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);d.length>0&&d[0]!=="dev"&&(this.options.lng=d[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(d=>{this[d]=function(){return t.store[d](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(d=>{this[d]=function(){return t.store[d](...arguments),t}});const l=Dh(),u=()=>{const d=(f,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),n(f,p)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return d(null,this.t.bind(this));this.changeLanguage(this.options.lng,d)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hg;const s=Gt(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(s&&s.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],i=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(u=>{u!=="cimode"&&a.indexOf(u)<0&&a.push(u)})};s?i(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>i(l)),this.options.preload&&this.options.preload.forEach(o=>i(o)),this.services.backendConnector.load(a,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(o)})}else n(null)}reloadResources(t,r,n){const s=Dh();return typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),n||(n=hg),this.services.backendConnector.reload(t,r,a=>{s.resolve(),n(a)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&KP.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,r){var n=this;this.isLanguageChangingTo=t;const s=Dh();this.emit("languageChanging",t);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,u)=>{u?(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,s.resolve(function(){return n.t(...arguments)}),r&&r(l,function(){return n.t(...arguments)})},o=l=>{!t&&!l&&this.services.languageDetector&&(l=[]);const u=Gt(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||a(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,d=>{i(d,u)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),s}getFixedT(t,r,n){var s=this;const a=function(i,o){let l;if(typeof o!="object"){for(var u=arguments.length,d=new Array(u>2?u-2:0),f=2;f<u;f++)d[f-2]=arguments[f];l=s.options.overloadTranslationOptionHandler([i,o].concat(d))}else l={...o};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);const p=s.options.keySeparator||".";let h;return l.keyPrefix&&Array.isArray(i)?h=i.map(m=>`${l.keyPrefix}${p}${m}`):h=l.keyPrefix?`${l.keyPrefix}${p}${i}`:i,s.t(h,l)};return Gt(t)?a.lng=t:a.lngs=t,a.ns=r,a.keyPrefix=n,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,l)=>{const u=this.services.backendConnector.state[`${o}|${l}`];return u===-1||u===0||u===2};if(r.precheck){const o=r.precheck(this,i);if(o!==void 0)return o}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||i(n,t)&&(!s||i(a,t)))}loadNamespaces(t,r){const n=Dh();return this.options.ns?(Gt(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{n.resolve(),r&&r(s)}),n):(r&&r(),Promise.resolve())}loadLanguages(t,r){const n=Dh();Gt(t)&&(t=[t]);const s=this.options.preload||[],a=t.filter(i=>s.indexOf(i)<0&&this.services.languageUtils.isSupportedCode(i));return a.length?(this.options.preload=s.concat(a),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new yE(NE());return r.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new pp(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hg;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},a=new pp(s);return(t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(o=>{a[o]=this[o]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new xE(this.store.data,s),a.services.resourceStore=a.store),a.translator=new nx(a.services,s),a.translator.on("*",function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),d=1;d<l;d++)u[d-1]=arguments[d];a.emit(o,...u)}),a.init(s,r),a.translator.options=s,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const bs=pp.createInstance();bs.createInstance=pp.createInstance;bs.createInstance;bs.dir;bs.init;bs.loadResources;bs.reloadResources;bs.use;bs.changeLanguage;bs.getFixedT;bs.t;bs.exists;bs.setDefaultNamespace;bs.hasLoadedNamespace;bs.loadNamespaces;bs.loadLanguages;const Jte={title:"Gestion de Projets",subtitle:"Application de gestion de projets offline-first"},Qte={save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",edit:"Modifier",create:"Crer",search:"Rechercher",filter:"Filtrer",export:"Exporter",import:"Importer",back:"Retour",next:"Suivant",previous:"Prcdent",loading:"Chargement...",error:"Erreur",success:"Succs",warning:"Avertissement",info:"Information",confirm:"Confirmer",close:"Fermer",viewAll:"Voir tout"},Zte={login:"Connexion",register:"Inscription",logout:"Dconnexion",email:"Email",password:"Mot de passe",firstName:"Prnom",lastName:"Nom",forgotPassword:"Mot de passe oubli?",loginSuccess:"Connexion russie",loginError:"Erreur de connexion",registerSuccess:"Inscription russie",registerError:"Erreur lors de l'inscription"},ere={status:{offline:"Hors ligne",syncing:"Synchronisation...",synced:" jour",error:"Erreur de synchronisation",idle:"En attente"},lastSync:"Dernire sync: {{time}}",pendingOperations:"{{count}} oprations en attente",syncNow:"Synchroniser maintenant",autoSync:"Synchronisation automatique",conflicts:"Conflits dtects",resolveConflict:"Rsoudre le conflit"},tre={title:"Tableau de bord",totalProjects:"Projets totaux",activeProjects:"Projets actifs",completedProjects:"Projets termins",totalBudget:"Budget total",recentProjects:"Projets rcents",recentActivities:"Activits rcentes",upcomingDeadlines:"chances  venir",statistics:"Statistiques"},rre={title:"Projet",projects:"Projets",new:"Nouveau projet",newProject:"Nouveau projet",createDescription:"Crez un nouveau projet en remplissant les informations ci-dessous",editProject:"Modifier le projet",deleteProject:"Supprimer le projet",projectDetails:"Dtails du projet",noProjects:"Aucun projet pour le moment",objet:"Objet",marcheNo:"March N",annee:"Anne",dateOuverture:"Date d'ouverture",montant:"Montant (MAD)",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"Socit",patente:"Patente",delaisEntreeService:"Dlais d'entre en service",osc:"OSC",status:{draft:"Brouillon",active:"Actif",completed:"Termin",archived:"Archiv"},progress:"Avancement",folderPath:"Chemin du dossier"},nre={title:"Bordereau",bordereaux:"Bordereaux",newBordereau:"Nouveau bordereau",reference:"Rfrence",designation:"Dsignation",unite:"Unit",quantite:"Quantit",prixUnitaire:"Prix unitaire",montantTotal:"Montant total"},sre={title:"Mtr",metres:"Mtrs",newMetre:"Nouveau mtr",reference:"Rfrence",designation:"Dsignation",mesures:"Mesures",longueur:"Longueur",largeur:"Largeur",hauteur:"Hauteur",quantite:"Quantit",totalQuantite:"Quantit totale"},are={title:"Dcompte",decompts:"Dcomptes",newDecompt:"Nouveau dcompte",periode:"Priode",numero:"Numro",lignes:"Lignes",montantTotal:"Montant total",statut:{draft:"Brouillon",submitted:"Soumis",validated:"Valid",paid:"Pay"},generatePDF:"Gnrer PDF"},ire={title:"Photo",photos:"Photos",uploadPhoto:"Tlcharger une photo",description:"Description",tags:"tiquettes",location:"Localisation"},ore={title:"Procs-Verbal",pvs:"Procs-Verbaux",newPV:"Nouveau PV",type:{installation:"Installation",reception:"Rception",constat:"Constat",other:"Autre"},numero:"Numro",date:"Date",objet:"Objet",contenu:"Contenu",participants:"Participants",attachments:"Pices jointes"},lre={title:"Pice jointe",attachments:"Pices jointes",uploadFile:"Tlcharger un fichier",category:{facture:"Facture",bp:"Bon de paiement",plan:"Plan",autre:"Autre"}},cre={title:"Paramtres",language:"Langue",theme:"Thme",notifications:"Notifications",account:"Compte",sync:"Synchronisation"},ure={app:Jte,common:Qte,auth:Zte,sync:ere,dashboard:tre,project:rre,bordereau:nre,metre:sre,decompt:are,photo:ire,pv:ore,attachment:lre,settings:cre},dre={title:" ",subtitle:"     "},fre={save:"",cancel:"",delete:"",edit:"",create:"",search:"",filter:"",export:"",import:"",back:"",next:"",previous:"",loading:" ...",error:"",success:"",warning:"",info:"",confirm:"",close:""},hre={login:" ",register:"",logout:" ",email:" ",password:" ",firstName:" ",lastName:" ",forgotPassword:"   ",loginSuccess:"   ",loginError:"   ",registerSuccess:"  ",registerError:"  "},pre={status:{offline:" ",syncing:" ...",synced:"",error:"  ",idle:" "},lastSync:" : {{time}}",pendingOperations:"{{count}}  ",syncNow:" ",autoSync:" ",conflicts:" ",resolveConflict:" "},mre={title:" ",totalProjects:" ",activeProjects:" ",completedProjects:" ",totalBudget:" ",recentProjects:" ",recentActivities:" ",upcomingDeadlines:"  ",statistics:""},gre={title:"",projects:"",newProject:" ",editProject:" ",deleteProject:" ",projectDetails:" ",objet:"",marcheNo:" ",annee:"",dateOuverture:" ",montant:" ()",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"",patente:"",delaisEntreeService:"   ",osc:"OSC",status:{draft:"",active:"",completed:"",archived:""},progress:"",folderPath:" "},xre={title:" ",bordereaux:" ",newBordereau:"  ",reference:"",designation:"",unite:"",quantite:"",prixUnitaire:" ",montantTotal:" "},vre={title:"",metres:"",newMetre:" ",reference:"",designation:"",mesures:"",longueur:"",largeur:"",hauteur:"",quantite:"",totalQuantite:" "},yre={title:"",decompts:"",newDecompt:" ",periode:"",numero:"",lignes:"",montantTotal:" ",statut:{draft:"",submitted:"",validated:" ",paid:""},generatePDF:" PDF"},wre={title:"",photos:"",uploadPhoto:" ",description:"",tags:"",location:""},bre={title:"",pvs:"",newPV:" ",type:{installation:"",reception:"",constat:"",other:""},numero:"",date:"",objet:"",contenu:"",participants:"",attachments:""},Nre={title:"",attachments:"",uploadFile:" ",category:{facture:"",bp:" ",plan:"",autre:""}},Sre={title:"",language:"",theme:"",notifications:"",account:"",sync:""},kre={app:dre,common:fre,auth:hre,sync:pre,dashboard:mre,project:gre,bordereau:xre,metre:vre,decompt:yre,photo:wre,pv:bre,attachment:Nre,settings:Sre},_re={title:"Project Management",subtitle:"Offline-first project management application"},Ere={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",create:"Create",search:"Search",filter:"Filter",export:"Export",import:"Import",back:"Back",next:"Next",previous:"Previous",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",close:"Close"},Are={login:"Login",register:"Register",logout:"Logout",email:"Email",password:"Password",firstName:"First Name",lastName:"Last Name",forgotPassword:"Forgot password?",loginSuccess:"Login successful",loginError:"Login error",registerSuccess:"Registration successful",registerError:"Registration error"},jre={status:{offline:"Offline",syncing:"Syncing...",synced:"Up to date",error:"Sync error",idle:"Idle"},lastSync:"Last sync: {{time}}",pendingOperations:"{{count}} pending operations",syncNow:"Sync now",autoSync:"Auto sync",conflicts:"Conflicts detected",resolveConflict:"Resolve conflict"},Cre={title:"Dashboard",totalProjects:"Total Projects",activeProjects:"Active Projects",completedProjects:"Completed Projects",totalBudget:"Total Budget",recentProjects:"Recent Projects",recentActivities:"Recent Activities",upcomingDeadlines:"Upcoming Deadlines",statistics:"Statistics"},Tre={title:"Project",projects:"Projects",newProject:"New Project",editProject:"Edit Project",deleteProject:"Delete Project",projectDetails:"Project Details",objet:"Object",marcheNo:"Contract No.",annee:"Year",dateOuverture:"Opening Date",montant:"Amount (MAD)",snss:"SNSS",cbn:"C.B.No.",rcn:"R.C.No.",societe:"Company",patente:"License",delaisEntreeService:"Service Entry Deadline",osc:"OSC",status:{draft:"Draft",active:"Active",completed:"Completed",archived:"Archived"},progress:"Progress",folderPath:"Folder Path"},Pre={title:"Price Schedule",bordereaux:"Price Schedules",newBordereau:"New Price Schedule",reference:"Reference",designation:"Designation",unite:"Unit",quantite:"Quantity",prixUnitaire:"Unit Price",montantTotal:"Total Amount"},Lre={title:"Measurement",metres:"Measurements",newMetre:"New Measurement",reference:"Reference",designation:"Designation",mesures:"Measurements",longueur:"Length",largeur:"Width",hauteur:"Height",quantite:"Quantity",totalQuantite:"Total Quantity"},Fre={title:"Payment Statement",decompts:"Payment Statements",newDecompt:"New Payment Statement",periode:"Period",numero:"Number",lignes:"Lines",montantTotal:"Total Amount",statut:{draft:"Draft",submitted:"Submitted",validated:"Validated",paid:"Paid"},generatePDF:"Generate PDF"},Dre={title:"Photo",photos:"Photos",uploadPhoto:"Upload Photo",description:"Description",tags:"Tags",location:"Location"},Rre={title:"Report",pvs:"Reports",newPV:"New Report",type:{installation:"Installation",reception:"Reception",constat:"Finding",other:"Other"},numero:"Number",date:"Date",objet:"Subject",contenu:"Content",participants:"Participants",attachments:"Attachments"},Ire={title:"Attachment",attachments:"Attachments",uploadFile:"Upload File",category:{facture:"Invoice",bp:"Payment Slip",plan:"Plan",autre:"Other"}},Ore={title:"Settings",language:"Language",theme:"Theme",notifications:"Notifications",account:"Account",sync:"Synchronization"},Mre={app:_re,common:Ere,auth:Are,sync:jre,dashboard:Cre,project:Tre,bordereau:Pre,metre:Lre,decompt:Fre,photo:Dre,pv:Rre,attachment:Ire,settings:Ore},Bre={fr:{translation:ure},ar:{translation:kre},en:{translation:Mre}},Ure=localStorage.getItem("language")||"fr";bs.use(YR).init({resources:Bre,lng:Ure,fallbackLng:"fr",interpolation:{escapeValue:!1}});bs.on("languageChanged",e=>{document.documentElement.setAttribute("dir",e==="ar"?"rtl":"ltr"),document.documentElement.setAttribute("lang",e),localStorage.setItem("language",e)});function $re(e={}){const{immediate:t=!1,onNeedRefresh:r,onOfflineReady:n,onRegistered:s,onRegisteredSW:a,onRegisterError:i}=e;let o,l;const u=async(f=!0)=>{await l};async function d(){if("serviceWorker"in navigator){if(o=await $g(async()=>{const{Workbox:f}=await import("./workbox-window.prod.es5-vqzQaGvo.js");return{Workbox:f}},[]).then(({Workbox:f})=>new f("/sw.js",{scope:"/",type:"classic"})).catch(f=>{i==null||i(f)}),!o)return;o.addEventListener("activated",f=>{(f.isUpdate||f.isExternal)&&window.location.reload()}),o.addEventListener("installed",f=>{f.isUpdate||n==null||n()}),o.register({immediate:t}).then(f=>{a?a("/sw.js",f):s==null||s(f)}).catch(f=>{i==null||i(f)})}}return l=d(),u}const zre=$re({onNeedRefresh(){window.confirm(`   !

    

New update available! Refresh to update?`)&&zre(!0)},onOfflineReady(){console.log(" App ready to work offline")},onRegisteredSW(e,t){t&&setInterval(()=>{t.update()},60*1e3)}}),Hre=new DR({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1,staleTime:5*60*1e3}}});Qv.createRoot(document.getElementById("root")).render(c.jsx(Jl.StrictMode,{children:c.jsx(IR,{client:Hre,children:c.jsx(aR,{children:c.jsx(Ate,{})})})}));export{Ar as _,Wre as c,FE as g};
