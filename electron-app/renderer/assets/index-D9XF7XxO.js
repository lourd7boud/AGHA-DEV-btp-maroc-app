var tF=Object.defineProperty;var B4=e=>{throw TypeError(e)};var rF=(e,t,r)=>t in e?tF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var bt=(e,t,r)=>rF(e,typeof t!="symbol"?t+"":t,r),c2=(e,t,r)=>t.has(e)||B4("Cannot "+r);var Oe=(e,t,r)=>(c2(e,t,"read from private field"),r?r.call(e):t.get(e)),er=(e,t,r)=>t.has(e)?B4("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Ot=(e,t,r,n)=>(c2(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),ds=(e,t,r)=>(c2(e,t,"access private method"),r);var nm=(e,t,r,n)=>({set _(s){Ot(e,t,s,r)},get _(){return Oe(e,t,n)}});function nF(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Mte=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function i6(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var o6={exports:{}},Kg={},l6={exports:{}},Jt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var op=Symbol.for("react.element"),sF=Symbol.for("react.portal"),aF=Symbol.for("react.fragment"),iF=Symbol.for("react.strict_mode"),oF=Symbol.for("react.profiler"),lF=Symbol.for("react.provider"),cF=Symbol.for("react.context"),uF=Symbol.for("react.forward_ref"),fF=Symbol.for("react.suspense"),dF=Symbol.for("react.memo"),hF=Symbol.for("react.lazy"),U4=Symbol.iterator;function pF(e){return e===null||typeof e!="object"?null:(e=U4&&e[U4]||e["@@iterator"],typeof e=="function"?e:null)}var c6={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},u6=Object.assign,f6={};function _d(e,t,r){this.props=e,this.context=t,this.refs=f6,this.updater=r||c6}_d.prototype.isReactComponent={};_d.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};_d.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function d6(){}d6.prototype=_d.prototype;function e5(e,t,r){this.props=e,this.context=t,this.refs=f6,this.updater=r||c6}var t5=e5.prototype=new d6;t5.constructor=e5;u6(t5,_d.prototype);t5.isPureReactComponent=!0;var $4=Array.isArray,h6=Object.prototype.hasOwnProperty,r5={current:null},p6={key:!0,ref:!0,__self:!0,__source:!0};function m6(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)h6.call(t,n)&&!p6.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),f=0;f<o;f++)c[f]=arguments[f+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:op,type:e,key:a,ref:i,props:s,_owner:r5.current}}function mF(e,t){return{$$typeof:op,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function n5(e){return typeof e=="object"&&e!==null&&e.$$typeof===op}function gF(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var z4=/\/+/g;function u2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?gF(""+e.key):t.toString(36)}function n1(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case op:case sF:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+u2(i,0):n,$4(s)?(r="",e!=null&&(r=e.replace(z4,"$&/")+"/"),n1(s,t,r,"",function(f){return f})):s!=null&&(n5(s)&&(s=mF(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(z4,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",$4(e))for(var o=0;o<e.length;o++){a=e[o];var c=n+u2(a,o);i+=n1(a,t,r,c,s)}else if(c=pF(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=n+u2(a,o++),i+=n1(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function sm(e,t,r){if(e==null)return e;var n=[],s=0;return n1(e,n,"","",function(a){return t.call(r,a,s++)}),n}function xF(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Ys={current:null},s1={transition:null},vF={ReactCurrentDispatcher:Ys,ReactCurrentBatchConfig:s1,ReactCurrentOwner:r5};function g6(){throw Error("act(...) is not supported in production builds of React.")}Jt.Children={map:sm,forEach:function(e,t,r){sm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return sm(e,function(){t++}),t},toArray:function(e){return sm(e,function(t){return t})||[]},only:function(e){if(!n5(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Jt.Component=_d;Jt.Fragment=aF;Jt.Profiler=oF;Jt.PureComponent=e5;Jt.StrictMode=iF;Jt.Suspense=fF;Jt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=vF;Jt.act=g6;Jt.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=u6({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=r5.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)h6.call(t,c)&&!p6.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var f=0;f<c;f++)o[f]=arguments[f+2];n.children=o}return{$$typeof:op,type:e.type,key:s,ref:a,props:n,_owner:i}};Jt.createContext=function(e){return e={$$typeof:cF,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:lF,_context:e},e.Consumer=e};Jt.createElement=m6;Jt.createFactory=function(e){var t=m6.bind(null,e);return t.type=e,t};Jt.createRef=function(){return{current:null}};Jt.forwardRef=function(e){return{$$typeof:uF,render:e}};Jt.isValidElement=n5;Jt.lazy=function(e){return{$$typeof:hF,_payload:{_status:-1,_result:e},_init:xF}};Jt.memo=function(e,t){return{$$typeof:dF,type:e,compare:t===void 0?null:t}};Jt.startTransition=function(e){var t=s1.transition;s1.transition={};try{e()}finally{s1.transition=t}};Jt.unstable_act=g6;Jt.useCallback=function(e,t){return Ys.current.useCallback(e,t)};Jt.useContext=function(e){return Ys.current.useContext(e)};Jt.useDebugValue=function(){};Jt.useDeferredValue=function(e){return Ys.current.useDeferredValue(e)};Jt.useEffect=function(e,t){return Ys.current.useEffect(e,t)};Jt.useId=function(){return Ys.current.useId()};Jt.useImperativeHandle=function(e,t,r){return Ys.current.useImperativeHandle(e,t,r)};Jt.useInsertionEffect=function(e,t){return Ys.current.useInsertionEffect(e,t)};Jt.useLayoutEffect=function(e,t){return Ys.current.useLayoutEffect(e,t)};Jt.useMemo=function(e,t){return Ys.current.useMemo(e,t)};Jt.useReducer=function(e,t,r){return Ys.current.useReducer(e,t,r)};Jt.useRef=function(e){return Ys.current.useRef(e)};Jt.useState=function(e){return Ys.current.useState(e)};Jt.useSyncExternalStore=function(e,t,r){return Ys.current.useSyncExternalStore(e,t,r)};Jt.useTransition=function(){return Ys.current.useTransition()};Jt.version="18.3.1";l6.exports=Jt;var me=l6.exports;const Wl=i6(me),yF=nF({__proto__:null,default:Wl},[me]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wF=me,bF=Symbol.for("react.element"),NF=Symbol.for("react.fragment"),SF=Object.prototype.hasOwnProperty,_F=wF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kF={key:!0,ref:!0,__self:!0,__source:!0};function x6(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)SF.call(t,n)&&!kF.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:bF,type:e,key:a,ref:i,props:s,_owner:_F.current}}Kg.Fragment=NF;Kg.jsx=x6;Kg.jsxs=x6;o6.exports=Kg;var l=o6.exports,Mv={},v6={exports:{}},Da={},y6={exports:{}},w6={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,G){var ve=X.length;X.push(G);e:for(;0<ve;){var ye=ve-1>>>1,E=X[ye];if(0<s(E,G))X[ye]=G,X[ve]=E,ve=ye;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var G=X[0],ve=X.pop();if(ve!==G){X[0]=ve;e:for(var ye=0,E=X.length,M=E>>>1;ye<M;){var I=2*(ye+1)-1,z=X[I],te=I+1,fe=X[te];if(0>s(z,ve))te<E&&0>s(fe,z)?(X[ye]=fe,X[te]=ve,ye=te):(X[ye]=z,X[I]=ve,ye=I);else if(te<E&&0>s(fe,ve))X[ye]=fe,X[te]=ve,ye=te;else break e}}return G}function s(X,G){var ve=X.sortIndex-G.sortIndex;return ve!==0?ve:X.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],f=[],u=1,p=null,d=3,h=!1,m=!1,g=!1,y=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(X){for(var G=r(f);G!==null;){if(G.callback===null)n(f);else if(G.startTime<=X)n(f),G.sortIndex=G.expirationTime,t(c,G);else break;G=r(f)}}function S(X){if(g=!1,w(X),!m)if(r(c)!==null)m=!0,se(A);else{var G=r(f);G!==null&&ne(S,G.startTime-X)}}function A(X,G){m=!1,g&&(g=!1,v(O),O=-1),h=!0;var ve=d;try{for(w(G),p=r(c);p!==null&&(!(p.expirationTime>G)||X&&!k());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,d=p.priorityLevel;var E=ye(p.expirationTime<=G);G=e.unstable_now(),typeof E=="function"?p.callback=E:p===r(c)&&n(c),w(G)}else n(c);p=r(c)}if(p!==null)var M=!0;else{var I=r(f);I!==null&&ne(S,I.startTime-G),M=!1}return M}finally{p=null,d=ve,h=!1}}var F=!1,T=null,O=-1,C=5,R=-1;function k(){return!(e.unstable_now()-R<C)}function P(){if(T!==null){var X=e.unstable_now();R=X;var G=!0;try{G=T(!0,X)}finally{G?q():(F=!1,T=null)}}else F=!1}var q;if(typeof b=="function")q=function(){b(P)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,V=D.port2;D.port1.onmessage=P,q=function(){V.postMessage(null)}}else q=function(){y(P,0)};function se(X){T=X,F||(F=!0,q())}function ne(X,G){O=y(function(){X(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){m||h||(m=!0,se(A))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(X){switch(d){case 1:case 2:case 3:var G=3;break;default:G=d}var ve=d;d=G;try{return X()}finally{d=ve}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,G){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ve=d;d=X;try{return G()}finally{d=ve}},e.unstable_scheduleCallback=function(X,G,ve){var ye=e.unstable_now();switch(typeof ve=="object"&&ve!==null?(ve=ve.delay,ve=typeof ve=="number"&&0<ve?ye+ve:ye):ve=ye,X){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=ve+E,X={id:u++,callback:G,priorityLevel:X,startTime:ve,expirationTime:E,sortIndex:-1},ve>ye?(X.sortIndex=ve,t(f,X),r(c)===null&&X===r(f)&&(g?(v(O),O=-1):g=!0,ne(S,ve-ye))):(X.sortIndex=E,t(c,X),m||h||(m=!0,se(A))),X},e.unstable_shouldYield=k,e.unstable_wrapCallback=function(X){var G=d;return function(){var ve=d;d=G;try{return X.apply(this,arguments)}finally{d=ve}}}})(w6);y6.exports=w6;var EF=y6.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jF=me,Ca=EF;function Ve(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var b6=new Set,dh={};function Uu(e,t){dd(e,t),dd(e+"Capture",t)}function dd(e,t){for(dh[e]=t,e=0;e<t.length;e++)b6.add(t[e])}var cl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bv=Object.prototype.hasOwnProperty,AF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,q4={},H4={};function TF(e){return Bv.call(H4,e)?!0:Bv.call(q4,e)?!1:AF.test(e)?H4[e]=!0:(q4[e]=!0,!1)}function CF(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function PF(e,t,r,n){if(t===null||typeof t>"u"||CF(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Xs(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var ls={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ls[e]=new Xs(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ls[t]=new Xs(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ls[e]=new Xs(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ls[e]=new Xs(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ls[e]=new Xs(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ls[e]=new Xs(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ls[e]=new Xs(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ls[e]=new Xs(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ls[e]=new Xs(e,5,!1,e.toLowerCase(),null,!1,!1)});var s5=/[\-:]([a-z])/g;function a5(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(s5,a5);ls[t]=new Xs(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(s5,a5);ls[t]=new Xs(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(s5,a5);ls[t]=new Xs(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ls[e]=new Xs(e,1,!1,e.toLowerCase(),null,!1,!1)});ls.xlinkHref=new Xs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ls[e]=new Xs(e,1,!1,e.toLowerCase(),null,!0,!0)});function i5(e,t,r,n){var s=ls.hasOwnProperty(t)?ls[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(PF(t,r,s,n)&&(r=null),n||s===null?TF(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var gl=jF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,am=Symbol.for("react.element"),kf=Symbol.for("react.portal"),Ef=Symbol.for("react.fragment"),o5=Symbol.for("react.strict_mode"),Uv=Symbol.for("react.profiler"),N6=Symbol.for("react.provider"),S6=Symbol.for("react.context"),l5=Symbol.for("react.forward_ref"),$v=Symbol.for("react.suspense"),zv=Symbol.for("react.suspense_list"),c5=Symbol.for("react.memo"),zl=Symbol.for("react.lazy"),_6=Symbol.for("react.offscreen"),W4=Symbol.iterator;function u0(e){return e===null||typeof e!="object"?null:(e=W4&&e[W4]||e["@@iterator"],typeof e=="function"?e:null)}var Gr=Object.assign,f2;function E0(e){if(f2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);f2=t&&t[1]||""}return`
`+f2+e}var d2=!1;function h2(e,t){if(!e||d2)return"";d2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(f){var n=f}Reflect.construct(e,[],t)}else{try{t.call()}catch(f){n=f}e.call(t.prototype)}else{try{throw Error()}catch(f){n=f}e()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var s=f.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{d2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?E0(e):""}function FF(e){switch(e.tag){case 5:return E0(e.type);case 16:return E0("Lazy");case 13:return E0("Suspense");case 19:return E0("SuspenseList");case 0:case 2:case 15:return e=h2(e.type,!1),e;case 11:return e=h2(e.type.render,!1),e;case 1:return e=h2(e.type,!0),e;default:return""}}function qv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ef:return"Fragment";case kf:return"Portal";case Uv:return"Profiler";case o5:return"StrictMode";case $v:return"Suspense";case zv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case S6:return(e.displayName||"Context")+".Consumer";case N6:return(e._context.displayName||"Context")+".Provider";case l5:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case c5:return t=e.displayName||null,t!==null?t:qv(e.type)||"Memo";case zl:t=e._payload,e=e._init;try{return qv(e(t))}catch{}}return null}function LF(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qv(t);case 8:return t===o5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function k6(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function DF(e){var t=k6(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function im(e){e._valueTracker||(e._valueTracker=DF(e))}function E6(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=k6(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function I1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Hv(e,t){var r=t.checked;return Gr({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function V4(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=yc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function j6(e,t){t=t.checked,t!=null&&i5(e,"checked",t,!1)}function Wv(e,t){j6(e,t);var r=yc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Vv(e,t.type,r):t.hasOwnProperty("defaultValue")&&Vv(e,t.type,yc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function K4(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Vv(e,t,r){(t!=="number"||I1(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var j0=Array.isArray;function Bf(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+yc(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function Kv(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ve(91));return Gr({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function G4(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(Ve(92));if(j0(r)){if(1<r.length)throw Error(Ve(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:yc(r)}}function A6(e,t){var r=yc(t.value),n=yc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Y4(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function T6(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gv(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?T6(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var om,C6=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(om=om||document.createElement("div"),om.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=om.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function hh(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var M0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},OF=["Webkit","ms","Moz","O"];Object.keys(M0).forEach(function(e){OF.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),M0[t]=M0[e]})});function P6(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||M0.hasOwnProperty(e)&&M0[e]?(""+t).trim():t+"px"}function F6(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=P6(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var RF=Gr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yv(e,t){if(t){if(RF[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ve(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ve(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ve(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ve(62))}}function Xv(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jv=null;function u5(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Qv=null,Uf=null,$f=null;function X4(e){if(e=up(e)){if(typeof Qv!="function")throw Error(Ve(280));var t=e.stateNode;t&&(t=Qg(t),Qv(e.stateNode,e.type,t))}}function L6(e){Uf?$f?$f.push(e):$f=[e]:Uf=e}function D6(){if(Uf){var e=Uf,t=$f;if($f=Uf=null,X4(e),t)for(e=0;e<t.length;e++)X4(t[e])}}function O6(e,t){return e(t)}function R6(){}var p2=!1;function I6(e,t,r){if(p2)return e(t,r);p2=!0;try{return O6(e,t,r)}finally{p2=!1,(Uf!==null||$f!==null)&&(R6(),D6())}}function ph(e,t){var r=e.stateNode;if(r===null)return null;var n=Qg(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(Ve(231,t,typeof r));return r}var Zv=!1;if(cl)try{var f0={};Object.defineProperty(f0,"passive",{get:function(){Zv=!0}}),window.addEventListener("test",f0,f0),window.removeEventListener("test",f0,f0)}catch{Zv=!1}function IF(e,t,r,n,s,a,i,o,c){var f=Array.prototype.slice.call(arguments,3);try{t.apply(r,f)}catch(u){this.onError(u)}}var B0=!1,M1=null,B1=!1,ey=null,MF={onError:function(e){B0=!0,M1=e}};function BF(e,t,r,n,s,a,i,o,c){B0=!1,M1=null,IF.apply(MF,arguments)}function UF(e,t,r,n,s,a,i,o,c){if(BF.apply(this,arguments),B0){if(B0){var f=M1;B0=!1,M1=null}else throw Error(Ve(198));B1||(B1=!0,ey=f)}}function $u(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function M6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function J4(e){if($u(e)!==e)throw Error(Ve(188))}function $F(e){var t=e.alternate;if(!t){if(t=$u(e),t===null)throw Error(Ve(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return J4(s),e;if(a===n)return J4(s),t;a=a.sibling}throw Error(Ve(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(Ve(189))}}if(r.alternate!==n)throw Error(Ve(190))}if(r.tag!==3)throw Error(Ve(188));return r.stateNode.current===r?e:t}function B6(e){return e=$F(e),e!==null?U6(e):null}function U6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=U6(e);if(t!==null)return t;e=e.sibling}return null}var $6=Ca.unstable_scheduleCallback,Q4=Ca.unstable_cancelCallback,zF=Ca.unstable_shouldYield,qF=Ca.unstable_requestPaint,un=Ca.unstable_now,HF=Ca.unstable_getCurrentPriorityLevel,f5=Ca.unstable_ImmediatePriority,z6=Ca.unstable_UserBlockingPriority,U1=Ca.unstable_NormalPriority,WF=Ca.unstable_LowPriority,q6=Ca.unstable_IdlePriority,Gg=null,ho=null;function VF(e){if(ho&&typeof ho.onCommitFiberRoot=="function")try{ho.onCommitFiberRoot(Gg,e,void 0,(e.current.flags&128)===128)}catch{}}var Fi=Math.clz32?Math.clz32:YF,KF=Math.log,GF=Math.LN2;function YF(e){return e>>>=0,e===0?32:31-(KF(e)/GF|0)|0}var lm=64,cm=4194304;function A0(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function $1(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=A0(o):(a&=i,a!==0&&(n=A0(a)))}else i=r&~s,i!==0?n=A0(i):a!==0&&(n=A0(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Fi(t),s=1<<r,n|=e[r],t&=~s;return n}function XF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function JF(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Fi(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=XF(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function ty(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function H6(){var e=lm;return lm<<=1,!(lm&4194240)&&(lm=64),e}function m2(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function lp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Fi(t),e[t]=r}function QF(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Fi(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function d5(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Fi(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var vr=0;function W6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var V6,h5,K6,G6,Y6,ry=!1,um=[],lc=null,cc=null,uc=null,mh=new Map,gh=new Map,Vl=[],ZF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Z4(e,t){switch(e){case"focusin":case"focusout":lc=null;break;case"dragenter":case"dragleave":cc=null;break;case"mouseover":case"mouseout":uc=null;break;case"pointerover":case"pointerout":mh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gh.delete(t.pointerId)}}function d0(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=up(t),t!==null&&h5(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function eL(e,t,r,n,s){switch(t){case"focusin":return lc=d0(lc,e,t,r,n,s),!0;case"dragenter":return cc=d0(cc,e,t,r,n,s),!0;case"mouseover":return uc=d0(uc,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return mh.set(a,d0(mh.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,gh.set(a,d0(gh.get(a)||null,e,t,r,n,s)),!0}return!1}function X6(e){var t=su(e.target);if(t!==null){var r=$u(t);if(r!==null){if(t=r.tag,t===13){if(t=M6(r),t!==null){e.blockedOn=t,Y6(e.priority,function(){K6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function a1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=ny(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Jv=n,r.target.dispatchEvent(n),Jv=null}else return t=up(r),t!==null&&h5(t),e.blockedOn=r,!1;t.shift()}return!0}function e3(e,t,r){a1(e)&&r.delete(t)}function tL(){ry=!1,lc!==null&&a1(lc)&&(lc=null),cc!==null&&a1(cc)&&(cc=null),uc!==null&&a1(uc)&&(uc=null),mh.forEach(e3),gh.forEach(e3)}function h0(e,t){e.blockedOn===t&&(e.blockedOn=null,ry||(ry=!0,Ca.unstable_scheduleCallback(Ca.unstable_NormalPriority,tL)))}function xh(e){function t(s){return h0(s,e)}if(0<um.length){h0(um[0],e);for(var r=1;r<um.length;r++){var n=um[r];n.blockedOn===e&&(n.blockedOn=null)}}for(lc!==null&&h0(lc,e),cc!==null&&h0(cc,e),uc!==null&&h0(uc,e),mh.forEach(t),gh.forEach(t),r=0;r<Vl.length;r++)n=Vl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Vl.length&&(r=Vl[0],r.blockedOn===null);)X6(r),r.blockedOn===null&&Vl.shift()}var zf=gl.ReactCurrentBatchConfig,z1=!0;function rL(e,t,r,n){var s=vr,a=zf.transition;zf.transition=null;try{vr=1,p5(e,t,r,n)}finally{vr=s,zf.transition=a}}function nL(e,t,r,n){var s=vr,a=zf.transition;zf.transition=null;try{vr=4,p5(e,t,r,n)}finally{vr=s,zf.transition=a}}function p5(e,t,r,n){if(z1){var s=ny(e,t,r,n);if(s===null)k2(e,t,n,q1,r),Z4(e,n);else if(eL(s,e,t,r,n))n.stopPropagation();else if(Z4(e,n),t&4&&-1<ZF.indexOf(e)){for(;s!==null;){var a=up(s);if(a!==null&&V6(a),a=ny(e,t,r,n),a===null&&k2(e,t,n,q1,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else k2(e,t,n,null,r)}}var q1=null;function ny(e,t,r,n){if(q1=null,e=u5(n),e=su(e),e!==null)if(t=$u(e),t===null)e=null;else if(r=t.tag,r===13){if(e=M6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return q1=e,null}function J6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(HF()){case f5:return 1;case z6:return 4;case U1:case WF:return 16;case q6:return 536870912;default:return 16}default:return 16}}var rc=null,m5=null,i1=null;function Q6(){if(i1)return i1;var e,t=m5,r=t.length,n,s="value"in rc?rc.value:rc.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return i1=s.slice(e,1<n?1-n:void 0)}function o1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function fm(){return!0}function t3(){return!1}function Oa(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?fm:t3,this.isPropagationStopped=t3,this}return Gr(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=fm)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=fm)},persist:function(){},isPersistent:fm}),t}var kd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},g5=Oa(kd),cp=Gr({},kd,{view:0,detail:0}),sL=Oa(cp),g2,x2,p0,Yg=Gr({},cp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:x5,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==p0&&(p0&&e.type==="mousemove"?(g2=e.screenX-p0.screenX,x2=e.screenY-p0.screenY):x2=g2=0,p0=e),g2)},movementY:function(e){return"movementY"in e?e.movementY:x2}}),r3=Oa(Yg),aL=Gr({},Yg,{dataTransfer:0}),iL=Oa(aL),oL=Gr({},cp,{relatedTarget:0}),v2=Oa(oL),lL=Gr({},kd,{animationName:0,elapsedTime:0,pseudoElement:0}),cL=Oa(lL),uL=Gr({},kd,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),fL=Oa(uL),dL=Gr({},kd,{data:0}),n3=Oa(dL),hL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gL(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=mL[e])?!!t[e]:!1}function x5(){return gL}var xL=Gr({},cp,{key:function(e){if(e.key){var t=hL[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=o1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?pL[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:x5,charCode:function(e){return e.type==="keypress"?o1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?o1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),vL=Oa(xL),yL=Gr({},Yg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s3=Oa(yL),wL=Gr({},cp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:x5}),bL=Oa(wL),NL=Gr({},kd,{propertyName:0,elapsedTime:0,pseudoElement:0}),SL=Oa(NL),_L=Gr({},Yg,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),kL=Oa(_L),EL=[9,13,27,32],v5=cl&&"CompositionEvent"in window,U0=null;cl&&"documentMode"in document&&(U0=document.documentMode);var jL=cl&&"TextEvent"in window&&!U0,Z6=cl&&(!v5||U0&&8<U0&&11>=U0),a3=" ",i3=!1;function eE(e,t){switch(e){case"keyup":return EL.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tE(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var jf=!1;function AL(e,t){switch(e){case"compositionend":return tE(t);case"keypress":return t.which!==32?null:(i3=!0,a3);case"textInput":return e=t.data,e===a3&&i3?null:e;default:return null}}function TL(e,t){if(jf)return e==="compositionend"||!v5&&eE(e,t)?(e=Q6(),i1=m5=rc=null,jf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Z6&&t.locale!=="ko"?null:t.data;default:return null}}var CL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function o3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!CL[e.type]:t==="textarea"}function rE(e,t,r,n){L6(n),t=H1(t,"onChange"),0<t.length&&(r=new g5("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var $0=null,vh=null;function PL(e){hE(e,0)}function Xg(e){var t=Cf(e);if(E6(t))return e}function FL(e,t){if(e==="change")return t}var nE=!1;if(cl){var y2;if(cl){var w2="oninput"in document;if(!w2){var l3=document.createElement("div");l3.setAttribute("oninput","return;"),w2=typeof l3.oninput=="function"}y2=w2}else y2=!1;nE=y2&&(!document.documentMode||9<document.documentMode)}function c3(){$0&&($0.detachEvent("onpropertychange",sE),vh=$0=null)}function sE(e){if(e.propertyName==="value"&&Xg(vh)){var t=[];rE(t,vh,e,u5(e)),I6(PL,t)}}function LL(e,t,r){e==="focusin"?(c3(),$0=t,vh=r,$0.attachEvent("onpropertychange",sE)):e==="focusout"&&c3()}function DL(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Xg(vh)}function OL(e,t){if(e==="click")return Xg(t)}function RL(e,t){if(e==="input"||e==="change")return Xg(t)}function IL(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ri=typeof Object.is=="function"?Object.is:IL;function yh(e,t){if(Ri(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Bv.call(t,s)||!Ri(e[s],t[s]))return!1}return!0}function u3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function f3(e,t){var r=u3(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=u3(r)}}function aE(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?aE(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function iE(){for(var e=window,t=I1();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=I1(e.document)}return t}function y5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function ML(e){var t=iE(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&aE(r.ownerDocument.documentElement,r)){if(n!==null&&y5(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=f3(r,a);var i=f3(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var BL=cl&&"documentMode"in document&&11>=document.documentMode,Af=null,sy=null,z0=null,ay=!1;function d3(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ay||Af==null||Af!==I1(n)||(n=Af,"selectionStart"in n&&y5(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),z0&&yh(z0,n)||(z0=n,n=H1(sy,"onSelect"),0<n.length&&(t=new g5("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Af)))}function dm(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Tf={animationend:dm("Animation","AnimationEnd"),animationiteration:dm("Animation","AnimationIteration"),animationstart:dm("Animation","AnimationStart"),transitionend:dm("Transition","TransitionEnd")},b2={},oE={};cl&&(oE=document.createElement("div").style,"AnimationEvent"in window||(delete Tf.animationend.animation,delete Tf.animationiteration.animation,delete Tf.animationstart.animation),"TransitionEvent"in window||delete Tf.transitionend.transition);function Jg(e){if(b2[e])return b2[e];if(!Tf[e])return e;var t=Tf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in oE)return b2[e]=t[r];return e}var lE=Jg("animationend"),cE=Jg("animationiteration"),uE=Jg("animationstart"),fE=Jg("transitionend"),dE=new Map,h3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jc(e,t){dE.set(e,t),Uu(t,[e])}for(var N2=0;N2<h3.length;N2++){var S2=h3[N2],UL=S2.toLowerCase(),$L=S2[0].toUpperCase()+S2.slice(1);jc(UL,"on"+$L)}jc(lE,"onAnimationEnd");jc(cE,"onAnimationIteration");jc(uE,"onAnimationStart");jc("dblclick","onDoubleClick");jc("focusin","onFocus");jc("focusout","onBlur");jc(fE,"onTransitionEnd");dd("onMouseEnter",["mouseout","mouseover"]);dd("onMouseLeave",["mouseout","mouseover"]);dd("onPointerEnter",["pointerout","pointerover"]);dd("onPointerLeave",["pointerout","pointerover"]);Uu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var T0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zL=new Set("cancel close invalid load scroll toggle".split(" ").concat(T0));function p3(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,UF(n,t,void 0,e),e.currentTarget=null}function hE(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,f=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;p3(s,o,f),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,f=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;p3(s,o,f),a=c}}}if(B1)throw e=ey,B1=!1,ey=null,e}function Lr(e,t){var r=t[uy];r===void 0&&(r=t[uy]=new Set);var n=e+"__bubble";r.has(n)||(pE(t,e,2,!1),r.add(n))}function _2(e,t,r){var n=0;t&&(n|=4),pE(r,e,n,t)}var hm="_reactListening"+Math.random().toString(36).slice(2);function wh(e){if(!e[hm]){e[hm]=!0,b6.forEach(function(r){r!=="selectionchange"&&(zL.has(r)||_2(r,!1,e),_2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[hm]||(t[hm]=!0,_2("selectionchange",!1,t))}}function pE(e,t,r,n){switch(J6(t)){case 1:var s=rL;break;case 4:s=nL;break;default:s=p5}r=s.bind(null,t,r,e),s=void 0,!Zv||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function k2(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=su(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}I6(function(){var f=a,u=u5(r),p=[];e:{var d=dE.get(e);if(d!==void 0){var h=g5,m=e;switch(e){case"keypress":if(o1(r)===0)break e;case"keydown":case"keyup":h=vL;break;case"focusin":m="focus",h=v2;break;case"focusout":m="blur",h=v2;break;case"beforeblur":case"afterblur":h=v2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=r3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=iL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=bL;break;case lE:case cE:case uE:h=cL;break;case fE:h=SL;break;case"scroll":h=sL;break;case"wheel":h=kL;break;case"copy":case"cut":case"paste":h=fL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=s3}var g=(t&4)!==0,y=!g&&e==="scroll",v=g?d!==null?d+"Capture":null:d;g=[];for(var b=f,w;b!==null;){w=b;var S=w.stateNode;if(w.tag===5&&S!==null&&(w=S,v!==null&&(S=ph(b,v),S!=null&&g.push(bh(b,S,w)))),y)break;b=b.return}0<g.length&&(d=new h(d,m,null,r,u),p.push({event:d,listeners:g}))}}if(!(t&7)){e:{if(d=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",d&&r!==Jv&&(m=r.relatedTarget||r.fromElement)&&(su(m)||m[ul]))break e;if((h||d)&&(d=u.window===u?u:(d=u.ownerDocument)?d.defaultView||d.parentWindow:window,h?(m=r.relatedTarget||r.toElement,h=f,m=m?su(m):null,m!==null&&(y=$u(m),m!==y||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=f),h!==m)){if(g=r3,S="onMouseLeave",v="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(g=s3,S="onPointerLeave",v="onPointerEnter",b="pointer"),y=h==null?d:Cf(h),w=m==null?d:Cf(m),d=new g(S,b+"leave",h,r,u),d.target=y,d.relatedTarget=w,S=null,su(u)===f&&(g=new g(v,b+"enter",m,r,u),g.target=w,g.relatedTarget=y,S=g),y=S,h&&m)t:{for(g=h,v=m,b=0,w=g;w;w=cf(w))b++;for(w=0,S=v;S;S=cf(S))w++;for(;0<b-w;)g=cf(g),b--;for(;0<w-b;)v=cf(v),w--;for(;b--;){if(g===v||v!==null&&g===v.alternate)break t;g=cf(g),v=cf(v)}g=null}else g=null;h!==null&&m3(p,d,h,g,!1),m!==null&&y!==null&&m3(p,y,m,g,!0)}}e:{if(d=f?Cf(f):window,h=d.nodeName&&d.nodeName.toLowerCase(),h==="select"||h==="input"&&d.type==="file")var A=FL;else if(o3(d))if(nE)A=RL;else{A=DL;var F=LL}else(h=d.nodeName)&&h.toLowerCase()==="input"&&(d.type==="checkbox"||d.type==="radio")&&(A=OL);if(A&&(A=A(e,f))){rE(p,A,r,u);break e}F&&F(e,d,f),e==="focusout"&&(F=d._wrapperState)&&F.controlled&&d.type==="number"&&Vv(d,"number",d.value)}switch(F=f?Cf(f):window,e){case"focusin":(o3(F)||F.contentEditable==="true")&&(Af=F,sy=f,z0=null);break;case"focusout":z0=sy=Af=null;break;case"mousedown":ay=!0;break;case"contextmenu":case"mouseup":case"dragend":ay=!1,d3(p,r,u);break;case"selectionchange":if(BL)break;case"keydown":case"keyup":d3(p,r,u)}var T;if(v5)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else jf?eE(e,r)&&(O="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(O="onCompositionStart");O&&(Z6&&r.locale!=="ko"&&(jf||O!=="onCompositionStart"?O==="onCompositionEnd"&&jf&&(T=Q6()):(rc=u,m5="value"in rc?rc.value:rc.textContent,jf=!0)),F=H1(f,O),0<F.length&&(O=new n3(O,e,null,r,u),p.push({event:O,listeners:F}),T?O.data=T:(T=tE(r),T!==null&&(O.data=T)))),(T=jL?AL(e,r):TL(e,r))&&(f=H1(f,"onBeforeInput"),0<f.length&&(u=new n3("onBeforeInput","beforeinput",null,r,u),p.push({event:u,listeners:f}),u.data=T))}hE(p,t)})}function bh(e,t,r){return{instance:e,listener:t,currentTarget:r}}function H1(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=ph(e,r),a!=null&&n.unshift(bh(e,a,s)),a=ph(e,t),a!=null&&n.push(bh(e,a,s))),e=e.return}return n}function cf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function m3(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,f=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&f!==null&&(o=f,s?(c=ph(r,a),c!=null&&i.unshift(bh(r,c,o))):s||(c=ph(r,a),c!=null&&i.push(bh(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var qL=/\r\n?/g,HL=/\u0000|\uFFFD/g;function g3(e){return(typeof e=="string"?e:""+e).replace(qL,`
`).replace(HL,"")}function pm(e,t,r){if(t=g3(t),g3(e)!==t&&r)throw Error(Ve(425))}function W1(){}var iy=null,oy=null;function ly(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var cy=typeof setTimeout=="function"?setTimeout:void 0,WL=typeof clearTimeout=="function"?clearTimeout:void 0,x3=typeof Promise=="function"?Promise:void 0,VL=typeof queueMicrotask=="function"?queueMicrotask:typeof x3<"u"?function(e){return x3.resolve(null).then(e).catch(KL)}:cy;function KL(e){setTimeout(function(){throw e})}function E2(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),xh(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);xh(t)}function fc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function v3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Ed=Math.random().toString(36).slice(2),oo="__reactFiber$"+Ed,Nh="__reactProps$"+Ed,ul="__reactContainer$"+Ed,uy="__reactEvents$"+Ed,GL="__reactListeners$"+Ed,YL="__reactHandles$"+Ed;function su(e){var t=e[oo];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ul]||r[oo]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=v3(e);e!==null;){if(r=e[oo])return r;e=v3(e)}return t}e=r,r=e.parentNode}return null}function up(e){return e=e[oo]||e[ul],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Cf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ve(33))}function Qg(e){return e[Nh]||null}var fy=[],Pf=-1;function Ac(e){return{current:e}}function Rr(e){0>Pf||(e.current=fy[Pf],fy[Pf]=null,Pf--)}function Cr(e,t){Pf++,fy[Pf]=e.current,e.current=t}var wc={},As=Ac(wc),ia=Ac(!1),Eu=wc;function hd(e,t){var r=e.type.contextTypes;if(!r)return wc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function oa(e){return e=e.childContextTypes,e!=null}function V1(){Rr(ia),Rr(As)}function y3(e,t,r){if(As.current!==wc)throw Error(Ve(168));Cr(As,t),Cr(ia,r)}function mE(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(Ve(108,LF(e)||"Unknown",s));return Gr({},r,n)}function K1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wc,Eu=As.current,Cr(As,e),Cr(ia,ia.current),!0}function w3(e,t,r){var n=e.stateNode;if(!n)throw Error(Ve(169));r?(e=mE(e,t,Eu),n.__reactInternalMemoizedMergedChildContext=e,Rr(ia),Rr(As),Cr(As,e)):Rr(ia),Cr(ia,r)}var Ko=null,Zg=!1,j2=!1;function gE(e){Ko===null?Ko=[e]:Ko.push(e)}function XL(e){Zg=!0,gE(e)}function Tc(){if(!j2&&Ko!==null){j2=!0;var e=0,t=vr;try{var r=Ko;for(vr=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ko=null,Zg=!1}catch(s){throw Ko!==null&&(Ko=Ko.slice(e+1)),$6(f5,Tc),s}finally{vr=t,j2=!1}}return null}var Ff=[],Lf=0,G1=null,Y1=0,Ka=[],Ga=0,ju=null,Zo=1,el="";function Qc(e,t){Ff[Lf++]=Y1,Ff[Lf++]=G1,G1=e,Y1=t}function xE(e,t,r){Ka[Ga++]=Zo,Ka[Ga++]=el,Ka[Ga++]=ju,ju=e;var n=Zo;e=el;var s=32-Fi(n)-1;n&=~(1<<s),r+=1;var a=32-Fi(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Zo=1<<32-Fi(t)+s|r<<s|n,el=a+e}else Zo=1<<a|r<<s|n,el=e}function w5(e){e.return!==null&&(Qc(e,1),xE(e,1,0))}function b5(e){for(;e===G1;)G1=Ff[--Lf],Ff[Lf]=null,Y1=Ff[--Lf],Ff[Lf]=null;for(;e===ju;)ju=Ka[--Ga],Ka[Ga]=null,el=Ka[--Ga],Ka[Ga]=null,Zo=Ka[--Ga],Ka[Ga]=null}var Ta=null,ja=null,zr=!1,ki=null;function vE(e,t){var r=Xa(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function b3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ta=e,ja=fc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ta=e,ja=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=ju!==null?{id:Zo,overflow:el}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Xa(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ta=e,ja=null,!0):!1;default:return!1}}function dy(e){return(e.mode&1)!==0&&(e.flags&128)===0}function hy(e){if(zr){var t=ja;if(t){var r=t;if(!b3(e,t)){if(dy(e))throw Error(Ve(418));t=fc(r.nextSibling);var n=Ta;t&&b3(e,t)?vE(n,r):(e.flags=e.flags&-4097|2,zr=!1,Ta=e)}}else{if(dy(e))throw Error(Ve(418));e.flags=e.flags&-4097|2,zr=!1,Ta=e}}}function N3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ta=e}function mm(e){if(e!==Ta)return!1;if(!zr)return N3(e),zr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!ly(e.type,e.memoizedProps)),t&&(t=ja)){if(dy(e))throw yE(),Error(Ve(418));for(;t;)vE(e,t),t=fc(t.nextSibling)}if(N3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ve(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){ja=fc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}ja=null}}else ja=Ta?fc(e.stateNode.nextSibling):null;return!0}function yE(){for(var e=ja;e;)e=fc(e.nextSibling)}function pd(){ja=Ta=null,zr=!1}function N5(e){ki===null?ki=[e]:ki.push(e)}var JL=gl.ReactCurrentBatchConfig;function m0(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(Ve(309));var n=r.stateNode}if(!n)throw Error(Ve(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(Ve(284));if(!r._owner)throw Error(Ve(290,e))}return e}function gm(e,t){throw e=Object.prototype.toString.call(t),Error(Ve(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function S3(e){var t=e._init;return t(e._payload)}function wE(e){function t(v,b){if(e){var w=v.deletions;w===null?(v.deletions=[b],v.flags|=16):w.push(b)}}function r(v,b){if(!e)return null;for(;b!==null;)t(v,b),b=b.sibling;return null}function n(v,b){for(v=new Map;b!==null;)b.key!==null?v.set(b.key,b):v.set(b.index,b),b=b.sibling;return v}function s(v,b){return v=mc(v,b),v.index=0,v.sibling=null,v}function a(v,b,w){return v.index=w,e?(w=v.alternate,w!==null?(w=w.index,w<b?(v.flags|=2,b):w):(v.flags|=2,b)):(v.flags|=1048576,b)}function i(v){return e&&v.alternate===null&&(v.flags|=2),v}function o(v,b,w,S){return b===null||b.tag!==6?(b=D2(w,v.mode,S),b.return=v,b):(b=s(b,w),b.return=v,b)}function c(v,b,w,S){var A=w.type;return A===Ef?u(v,b,w.props.children,S,w.key):b!==null&&(b.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===zl&&S3(A)===b.type)?(S=s(b,w.props),S.ref=m0(v,b,w),S.return=v,S):(S=p1(w.type,w.key,w.props,null,v.mode,S),S.ref=m0(v,b,w),S.return=v,S)}function f(v,b,w,S){return b===null||b.tag!==4||b.stateNode.containerInfo!==w.containerInfo||b.stateNode.implementation!==w.implementation?(b=O2(w,v.mode,S),b.return=v,b):(b=s(b,w.children||[]),b.return=v,b)}function u(v,b,w,S,A){return b===null||b.tag!==7?(b=xu(w,v.mode,S,A),b.return=v,b):(b=s(b,w),b.return=v,b)}function p(v,b,w){if(typeof b=="string"&&b!==""||typeof b=="number")return b=D2(""+b,v.mode,w),b.return=v,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case am:return w=p1(b.type,b.key,b.props,null,v.mode,w),w.ref=m0(v,null,b),w.return=v,w;case kf:return b=O2(b,v.mode,w),b.return=v,b;case zl:var S=b._init;return p(v,S(b._payload),w)}if(j0(b)||u0(b))return b=xu(b,v.mode,w,null),b.return=v,b;gm(v,b)}return null}function d(v,b,w,S){var A=b!==null?b.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return A!==null?null:o(v,b,""+w,S);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case am:return w.key===A?c(v,b,w,S):null;case kf:return w.key===A?f(v,b,w,S):null;case zl:return A=w._init,d(v,b,A(w._payload),S)}if(j0(w)||u0(w))return A!==null?null:u(v,b,w,S,null);gm(v,w)}return null}function h(v,b,w,S,A){if(typeof S=="string"&&S!==""||typeof S=="number")return v=v.get(w)||null,o(b,v,""+S,A);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case am:return v=v.get(S.key===null?w:S.key)||null,c(b,v,S,A);case kf:return v=v.get(S.key===null?w:S.key)||null,f(b,v,S,A);case zl:var F=S._init;return h(v,b,w,F(S._payload),A)}if(j0(S)||u0(S))return v=v.get(w)||null,u(b,v,S,A,null);gm(b,S)}return null}function m(v,b,w,S){for(var A=null,F=null,T=b,O=b=0,C=null;T!==null&&O<w.length;O++){T.index>O?(C=T,T=null):C=T.sibling;var R=d(v,T,w[O],S);if(R===null){T===null&&(T=C);break}e&&T&&R.alternate===null&&t(v,T),b=a(R,b,O),F===null?A=R:F.sibling=R,F=R,T=C}if(O===w.length)return r(v,T),zr&&Qc(v,O),A;if(T===null){for(;O<w.length;O++)T=p(v,w[O],S),T!==null&&(b=a(T,b,O),F===null?A=T:F.sibling=T,F=T);return zr&&Qc(v,O),A}for(T=n(v,T);O<w.length;O++)C=h(T,v,O,w[O],S),C!==null&&(e&&C.alternate!==null&&T.delete(C.key===null?O:C.key),b=a(C,b,O),F===null?A=C:F.sibling=C,F=C);return e&&T.forEach(function(k){return t(v,k)}),zr&&Qc(v,O),A}function g(v,b,w,S){var A=u0(w);if(typeof A!="function")throw Error(Ve(150));if(w=A.call(w),w==null)throw Error(Ve(151));for(var F=A=null,T=b,O=b=0,C=null,R=w.next();T!==null&&!R.done;O++,R=w.next()){T.index>O?(C=T,T=null):C=T.sibling;var k=d(v,T,R.value,S);if(k===null){T===null&&(T=C);break}e&&T&&k.alternate===null&&t(v,T),b=a(k,b,O),F===null?A=k:F.sibling=k,F=k,T=C}if(R.done)return r(v,T),zr&&Qc(v,O),A;if(T===null){for(;!R.done;O++,R=w.next())R=p(v,R.value,S),R!==null&&(b=a(R,b,O),F===null?A=R:F.sibling=R,F=R);return zr&&Qc(v,O),A}for(T=n(v,T);!R.done;O++,R=w.next())R=h(T,v,O,R.value,S),R!==null&&(e&&R.alternate!==null&&T.delete(R.key===null?O:R.key),b=a(R,b,O),F===null?A=R:F.sibling=R,F=R);return e&&T.forEach(function(P){return t(v,P)}),zr&&Qc(v,O),A}function y(v,b,w,S){if(typeof w=="object"&&w!==null&&w.type===Ef&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case am:e:{for(var A=w.key,F=b;F!==null;){if(F.key===A){if(A=w.type,A===Ef){if(F.tag===7){r(v,F.sibling),b=s(F,w.props.children),b.return=v,v=b;break e}}else if(F.elementType===A||typeof A=="object"&&A!==null&&A.$$typeof===zl&&S3(A)===F.type){r(v,F.sibling),b=s(F,w.props),b.ref=m0(v,F,w),b.return=v,v=b;break e}r(v,F);break}else t(v,F);F=F.sibling}w.type===Ef?(b=xu(w.props.children,v.mode,S,w.key),b.return=v,v=b):(S=p1(w.type,w.key,w.props,null,v.mode,S),S.ref=m0(v,b,w),S.return=v,v=S)}return i(v);case kf:e:{for(F=w.key;b!==null;){if(b.key===F)if(b.tag===4&&b.stateNode.containerInfo===w.containerInfo&&b.stateNode.implementation===w.implementation){r(v,b.sibling),b=s(b,w.children||[]),b.return=v,v=b;break e}else{r(v,b);break}else t(v,b);b=b.sibling}b=O2(w,v.mode,S),b.return=v,v=b}return i(v);case zl:return F=w._init,y(v,b,F(w._payload),S)}if(j0(w))return m(v,b,w,S);if(u0(w))return g(v,b,w,S);gm(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,b!==null&&b.tag===6?(r(v,b.sibling),b=s(b,w),b.return=v,v=b):(r(v,b),b=D2(w,v.mode,S),b.return=v,v=b),i(v)):r(v,b)}return y}var md=wE(!0),bE=wE(!1),X1=Ac(null),J1=null,Df=null,S5=null;function _5(){S5=Df=J1=null}function k5(e){var t=X1.current;Rr(X1),e._currentValue=t}function py(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function qf(e,t){J1=e,S5=Df=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(sa=!0),e.firstContext=null)}function Za(e){var t=e._currentValue;if(S5!==e)if(e={context:e,memoizedValue:t,next:null},Df===null){if(J1===null)throw Error(Ve(308));Df=e,J1.dependencies={lanes:0,firstContext:e}}else Df=Df.next=e;return t}var au=null;function E5(e){au===null?au=[e]:au.push(e)}function NE(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,E5(t)):(r.next=s.next,s.next=r),t.interleaved=r,fl(e,n)}function fl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ql=!1;function j5(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function SE(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function sl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,cr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,fl(e,r)}return s=n.interleaved,s===null?(t.next=t,E5(n)):(t.next=s.next,s.next=t),n.interleaved=t,fl(e,r)}function l1(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,d5(e,r)}}function _3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Q1(e,t,r,n){var s=e.updateQueue;ql=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,f=c.next;c.next=null,i===null?a=f:i.next=f,i=c;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=f:o.next=f,u.lastBaseUpdate=c))}if(a!==null){var p=s.baseState;i=0,u=f=c=null,o=a;do{var d=o.lane,h=o.eventTime;if((n&d)===d){u!==null&&(u=u.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(d=t,h=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){p=m.call(h,p,d);break e}p=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,d=typeof m=="function"?m.call(h,p,d):m,d==null)break e;p=Gr({},p,d);break e;case 2:ql=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,d=s.effects,d===null?s.effects=[o]:d.push(o))}else h={eventTime:h,lane:d,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(f=u=h,c=p):u=u.next=h,i|=d;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;d=o,o=d.next,d.next=null,s.lastBaseUpdate=d,s.shared.pending=null}}while(!0);if(u===null&&(c=p),s.baseState=c,s.firstBaseUpdate=f,s.lastBaseUpdate=u,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Tu|=i,e.lanes=i,e.memoizedState=p}}function k3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(Ve(191,s));s.call(n)}}}var fp={},po=Ac(fp),Sh=Ac(fp),_h=Ac(fp);function iu(e){if(e===fp)throw Error(Ve(174));return e}function A5(e,t){switch(Cr(_h,t),Cr(Sh,e),Cr(po,fp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Gv(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Gv(t,e)}Rr(po),Cr(po,t)}function gd(){Rr(po),Rr(Sh),Rr(_h)}function _E(e){iu(_h.current);var t=iu(po.current),r=Gv(t,e.type);t!==r&&(Cr(Sh,e),Cr(po,r))}function T5(e){Sh.current===e&&(Rr(po),Rr(Sh))}var Wr=Ac(0);function Z1(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var A2=[];function C5(){for(var e=0;e<A2.length;e++)A2[e]._workInProgressVersionPrimary=null;A2.length=0}var c1=gl.ReactCurrentDispatcher,T2=gl.ReactCurrentBatchConfig,Au=0,Kr=null,Rn=null,Hn=null,eg=!1,q0=!1,kh=0,QL=0;function hs(){throw Error(Ve(321))}function P5(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ri(e[r],t[r]))return!1;return!0}function F5(e,t,r,n,s,a){if(Au=a,Kr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,c1.current=e===null||e.memoizedState===null?r7:n7,e=r(n,s),q0){a=0;do{if(q0=!1,kh=0,25<=a)throw Error(Ve(301));a+=1,Hn=Rn=null,t.updateQueue=null,c1.current=s7,e=r(n,s)}while(q0)}if(c1.current=tg,t=Rn!==null&&Rn.next!==null,Au=0,Hn=Rn=Kr=null,eg=!1,t)throw Error(Ve(300));return e}function L5(){var e=kh!==0;return kh=0,e}function to(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?Kr.memoizedState=Hn=e:Hn=Hn.next=e,Hn}function ei(){if(Rn===null){var e=Kr.alternate;e=e!==null?e.memoizedState:null}else e=Rn.next;var t=Hn===null?Kr.memoizedState:Hn.next;if(t!==null)Hn=t,Rn=e;else{if(e===null)throw Error(Ve(310));Rn=e,e={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},Hn===null?Kr.memoizedState=Hn=e:Hn=Hn.next=e}return Hn}function Eh(e,t){return typeof t=="function"?t(e):t}function C2(e){var t=ei(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=Rn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,f=a;do{var u=f.lane;if((Au&u)===u)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:e(n,f.action);else{var p={lane:u,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(o=c=p,i=n):c=c.next=p,Kr.lanes|=u,Tu|=u}f=f.next}while(f!==null&&f!==a);c===null?i=n:c.next=o,Ri(n,t.memoizedState)||(sa=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,Kr.lanes|=a,Tu|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function P2(e){var t=ei(),r=t.queue;if(r===null)throw Error(Ve(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);Ri(a,t.memoizedState)||(sa=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function kE(){}function EE(e,t){var r=Kr,n=ei(),s=t(),a=!Ri(n.memoizedState,s);if(a&&(n.memoizedState=s,sa=!0),n=n.queue,D5(TE.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Hn!==null&&Hn.memoizedState.tag&1){if(r.flags|=2048,jh(9,AE.bind(null,r,n,s,t),void 0,null),Vn===null)throw Error(Ve(349));Au&30||jE(r,t,s)}return s}function jE(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=Kr.updateQueue,t===null?(t={lastEffect:null,stores:null},Kr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function AE(e,t,r,n){t.value=r,t.getSnapshot=n,CE(t)&&PE(e)}function TE(e,t,r){return r(function(){CE(t)&&PE(e)})}function CE(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ri(e,r)}catch{return!0}}function PE(e){var t=fl(e,1);t!==null&&Li(t,e,1,-1)}function E3(e){var t=to();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eh,lastRenderedState:e},t.queue=e,e=e.dispatch=t7.bind(null,Kr,e),[t.memoizedState,e]}function jh(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=Kr.updateQueue,t===null?(t={lastEffect:null,stores:null},Kr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function FE(){return ei().memoizedState}function u1(e,t,r,n){var s=to();Kr.flags|=e,s.memoizedState=jh(1|t,r,void 0,n===void 0?null:n)}function ex(e,t,r,n){var s=ei();n=n===void 0?null:n;var a=void 0;if(Rn!==null){var i=Rn.memoizedState;if(a=i.destroy,n!==null&&P5(n,i.deps)){s.memoizedState=jh(t,r,a,n);return}}Kr.flags|=e,s.memoizedState=jh(1|t,r,a,n)}function j3(e,t){return u1(8390656,8,e,t)}function D5(e,t){return ex(2048,8,e,t)}function LE(e,t){return ex(4,2,e,t)}function DE(e,t){return ex(4,4,e,t)}function OE(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function RE(e,t,r){return r=r!=null?r.concat([e]):null,ex(4,4,OE.bind(null,t,e),r)}function O5(){}function IE(e,t){var r=ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&P5(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ME(e,t){var r=ei();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&P5(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function BE(e,t,r){return Au&21?(Ri(r,t)||(r=H6(),Kr.lanes|=r,Tu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,sa=!0),e.memoizedState=r)}function ZL(e,t){var r=vr;vr=r!==0&&4>r?r:4,e(!0);var n=T2.transition;T2.transition={};try{e(!1),t()}finally{vr=r,T2.transition=n}}function UE(){return ei().memoizedState}function e7(e,t,r){var n=pc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},$E(e))zE(t,r);else if(r=NE(e,t,r,n),r!==null){var s=qs();Li(r,e,n,s),qE(r,t,n)}}function t7(e,t,r){var n=pc(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if($E(e))zE(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Ri(o,i)){var c=t.interleaved;c===null?(s.next=s,E5(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=NE(e,t,s,n),r!==null&&(s=qs(),Li(r,e,n,s),qE(r,t,n))}}function $E(e){var t=e.alternate;return e===Kr||t!==null&&t===Kr}function zE(e,t){q0=eg=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function qE(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,d5(e,r)}}var tg={readContext:Za,useCallback:hs,useContext:hs,useEffect:hs,useImperativeHandle:hs,useInsertionEffect:hs,useLayoutEffect:hs,useMemo:hs,useReducer:hs,useRef:hs,useState:hs,useDebugValue:hs,useDeferredValue:hs,useTransition:hs,useMutableSource:hs,useSyncExternalStore:hs,useId:hs,unstable_isNewReconciler:!1},r7={readContext:Za,useCallback:function(e,t){return to().memoizedState=[e,t===void 0?null:t],e},useContext:Za,useEffect:j3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,u1(4194308,4,OE.bind(null,t,e),r)},useLayoutEffect:function(e,t){return u1(4194308,4,e,t)},useInsertionEffect:function(e,t){return u1(4,2,e,t)},useMemo:function(e,t){var r=to();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=to();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=e7.bind(null,Kr,e),[n.memoizedState,e]},useRef:function(e){var t=to();return e={current:e},t.memoizedState=e},useState:E3,useDebugValue:O5,useDeferredValue:function(e){return to().memoizedState=e},useTransition:function(){var e=E3(!1),t=e[0];return e=ZL.bind(null,e[1]),to().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=Kr,s=to();if(zr){if(r===void 0)throw Error(Ve(407));r=r()}else{if(r=t(),Vn===null)throw Error(Ve(349));Au&30||jE(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,j3(TE.bind(null,n,a,e),[e]),n.flags|=2048,jh(9,AE.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=to(),t=Vn.identifierPrefix;if(zr){var r=el,n=Zo;r=(n&~(1<<32-Fi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=kh++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=QL++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},n7={readContext:Za,useCallback:IE,useContext:Za,useEffect:D5,useImperativeHandle:RE,useInsertionEffect:LE,useLayoutEffect:DE,useMemo:ME,useReducer:C2,useRef:FE,useState:function(){return C2(Eh)},useDebugValue:O5,useDeferredValue:function(e){var t=ei();return BE(t,Rn.memoizedState,e)},useTransition:function(){var e=C2(Eh)[0],t=ei().memoizedState;return[e,t]},useMutableSource:kE,useSyncExternalStore:EE,useId:UE,unstable_isNewReconciler:!1},s7={readContext:Za,useCallback:IE,useContext:Za,useEffect:D5,useImperativeHandle:RE,useInsertionEffect:LE,useLayoutEffect:DE,useMemo:ME,useReducer:P2,useRef:FE,useState:function(){return P2(Eh)},useDebugValue:O5,useDeferredValue:function(e){var t=ei();return Rn===null?t.memoizedState=e:BE(t,Rn.memoizedState,e)},useTransition:function(){var e=P2(Eh)[0],t=ei().memoizedState;return[e,t]},useMutableSource:kE,useSyncExternalStore:EE,useId:UE,unstable_isNewReconciler:!1};function vi(e,t){if(e&&e.defaultProps){t=Gr({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function my(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Gr({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var tx={isMounted:function(e){return(e=e._reactInternals)?$u(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qs(),s=pc(e),a=sl(n,s);a.payload=t,r!=null&&(a.callback=r),t=dc(e,a,s),t!==null&&(Li(t,e,s,n),l1(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qs(),s=pc(e),a=sl(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=dc(e,a,s),t!==null&&(Li(t,e,s,n),l1(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qs(),n=pc(e),s=sl(r,n);s.tag=2,t!=null&&(s.callback=t),t=dc(e,s,n),t!==null&&(Li(t,e,n,r),l1(t,e,n))}};function A3(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!yh(r,n)||!yh(s,a):!0}function HE(e,t,r){var n=!1,s=wc,a=t.contextType;return typeof a=="object"&&a!==null?a=Za(a):(s=oa(t)?Eu:As.current,n=t.contextTypes,a=(n=n!=null)?hd(e,s):wc),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=tx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function T3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&tx.enqueueReplaceState(t,t.state,null)}function gy(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},j5(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Za(a):(a=oa(t)?Eu:As.current,s.context=hd(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(my(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&tx.enqueueReplaceState(s,s.state,null),Q1(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function xd(e,t){try{var r="",n=t;do r+=FF(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function F2(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function xy(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var a7=typeof WeakMap=="function"?WeakMap:Map;function WE(e,t,r){r=sl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){ng||(ng=!0,jy=n),xy(e,t)},r}function VE(e,t,r){r=sl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){xy(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){xy(e,t),typeof n!="function"&&(hc===null?hc=new Set([this]):hc.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function C3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new a7;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=y7.bind(null,e,t,r),t.then(e,e))}function P3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function F3(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=sl(-1,1),t.tag=2,dc(r,t,1))),r.lanes|=1),e)}var i7=gl.ReactCurrentOwner,sa=!1;function Is(e,t,r,n){t.child=e===null?bE(t,null,r,n):md(t,e.child,r,n)}function L3(e,t,r,n,s){r=r.render;var a=t.ref;return qf(t,s),n=F5(e,t,r,n,a,s),r=L5(),e!==null&&!sa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,dl(e,t,s)):(zr&&r&&w5(t),t.flags|=1,Is(e,t,n,s),t.child)}function D3(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!q5(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,KE(e,t,a,n,s)):(e=p1(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:yh,r(i,n)&&e.ref===t.ref)return dl(e,t,s)}return t.flags|=1,e=mc(a,n),e.ref=t.ref,e.return=t,t.child=e}function KE(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(yh(a,n)&&e.ref===t.ref)if(sa=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(sa=!0);else return t.lanes=e.lanes,dl(e,t,s)}return vy(e,t,r,n,s)}function GE(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Rf,Sa),Sa|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cr(Rf,Sa),Sa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Cr(Rf,Sa),Sa|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Cr(Rf,Sa),Sa|=n;return Is(e,t,s,r),t.child}function YE(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function vy(e,t,r,n,s){var a=oa(r)?Eu:As.current;return a=hd(t,a),qf(t,s),r=F5(e,t,r,n,a,s),n=L5(),e!==null&&!sa?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,dl(e,t,s)):(zr&&n&&w5(t),t.flags|=1,Is(e,t,r,s),t.child)}function O3(e,t,r,n,s){if(oa(r)){var a=!0;K1(t)}else a=!1;if(qf(t,s),t.stateNode===null)f1(e,t),HE(t,r,n),gy(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,f=r.contextType;typeof f=="object"&&f!==null?f=Za(f):(f=oa(r)?Eu:As.current,f=hd(t,f));var u=r.getDerivedStateFromProps,p=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==f)&&T3(t,i,n,f),ql=!1;var d=t.memoizedState;i.state=d,Q1(t,n,i,s),c=t.memoizedState,o!==n||d!==c||ia.current||ql?(typeof u=="function"&&(my(t,r,u,n),c=t.memoizedState),(o=ql||A3(t,r,o,n,d,c,f))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=f,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,SE(e,t),o=t.memoizedProps,f=t.type===t.elementType?o:vi(t.type,o),i.props=f,p=t.pendingProps,d=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=Za(c):(c=oa(r)?Eu:As.current,c=hd(t,c));var h=r.getDerivedStateFromProps;(u=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==p||d!==c)&&T3(t,i,n,c),ql=!1,d=t.memoizedState,i.state=d,Q1(t,n,i,s);var m=t.memoizedState;o!==p||d!==m||ia.current||ql?(typeof h=="function"&&(my(t,r,h,n),m=t.memoizedState),(f=ql||A3(t,r,f,n,d,m,c)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=c,n=f):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),n=!1)}return yy(e,t,r,n,a,s)}function yy(e,t,r,n,s,a){YE(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&w3(t,r,!1),dl(e,t,a);n=t.stateNode,i7.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=md(t,e.child,null,a),t.child=md(t,null,o,a)):Is(e,t,o,a),t.memoizedState=n.state,s&&w3(t,r,!0),t.child}function XE(e){var t=e.stateNode;t.pendingContext?y3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&y3(e,t.context,!1),A5(e,t.containerInfo)}function R3(e,t,r,n,s){return pd(),N5(s),t.flags|=256,Is(e,t,r,n),t.child}var wy={dehydrated:null,treeContext:null,retryLane:0};function by(e){return{baseLanes:e,cachePool:null,transitions:null}}function JE(e,t,r){var n=t.pendingProps,s=Wr.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Cr(Wr,s&1),e===null)return hy(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=sx(i,n,0,null),e=xu(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=by(r),t.memoizedState=wy,e):R5(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return o7(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=mc(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=mc(o,a):(a=xu(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?by(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=wy,n}return a=e.child,e=a.sibling,n=mc(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function R5(e,t){return t=sx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function xm(e,t,r,n){return n!==null&&N5(n),md(t,e.child,null,r),e=R5(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function o7(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=F2(Error(Ve(422))),xm(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=sx({mode:"visible",children:n.children},s,0,null),a=xu(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&md(t,e.child,null,i),t.child.memoizedState=by(i),t.memoizedState=wy,a);if(!(t.mode&1))return xm(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(Ve(419)),n=F2(a,n,void 0),xm(e,t,i,n)}if(o=(i&e.childLanes)!==0,sa||o){if(n=Vn,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,fl(e,s),Li(n,e,s,-1))}return z5(),n=F2(Error(Ve(421))),xm(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=w7.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,ja=fc(s.nextSibling),Ta=t,zr=!0,ki=null,e!==null&&(Ka[Ga++]=Zo,Ka[Ga++]=el,Ka[Ga++]=ju,Zo=e.id,el=e.overflow,ju=t),t=R5(t,n.children),t.flags|=4096,t)}function I3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),py(e.return,t,r)}function L2(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function QE(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Is(e,t,n.children,r),n=Wr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&I3(e,r,t);else if(e.tag===19)I3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Cr(Wr,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&Z1(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),L2(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&Z1(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}L2(t,!0,r,null,a);break;case"together":L2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function f1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Tu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ve(153));if(t.child!==null){for(e=t.child,r=mc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=mc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function l7(e,t,r){switch(t.tag){case 3:XE(t),pd();break;case 5:_E(t);break;case 1:oa(t.type)&&K1(t);break;case 4:A5(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Cr(X1,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Cr(Wr,Wr.current&1),t.flags|=128,null):r&t.child.childLanes?JE(e,t,r):(Cr(Wr,Wr.current&1),e=dl(e,t,r),e!==null?e.sibling:null);Cr(Wr,Wr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return QE(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Cr(Wr,Wr.current),n)break;return null;case 22:case 23:return t.lanes=0,GE(e,t,r)}return dl(e,t,r)}var ZE,Ny,ej,tj;ZE=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Ny=function(){};ej=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,iu(po.current);var a=null;switch(r){case"input":s=Hv(e,s),n=Hv(e,n),a=[];break;case"select":s=Gr({},s,{value:void 0}),n=Gr({},n,{value:void 0}),a=[];break;case"textarea":s=Kv(e,s),n=Kv(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=W1)}Yv(r,n);var i;r=null;for(f in s)if(!n.hasOwnProperty(f)&&s.hasOwnProperty(f)&&s[f]!=null)if(f==="style"){var o=s[f];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(dh.hasOwnProperty(f)?a||(a=[]):(a=a||[]).push(f,null));for(f in n){var c=n[f];if(o=s!=null?s[f]:void 0,n.hasOwnProperty(f)&&c!==o&&(c!=null||o!=null))if(f==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(f,r)),r=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(dh.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&Lr("scroll",e),a||o===c||(a=[])):(a=a||[]).push(f,c))}r&&(a=a||[]).push("style",r);var f=a;(t.updateQueue=f)&&(t.flags|=4)}};tj=function(e,t,r,n){r!==n&&(t.flags|=4)};function g0(e,t){if(!zr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ps(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function c7(e,t,r){var n=t.pendingProps;switch(b5(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(t),null;case 1:return oa(t.type)&&V1(),ps(t),null;case 3:return n=t.stateNode,gd(),Rr(ia),Rr(As),C5(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(mm(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ki!==null&&(Cy(ki),ki=null))),Ny(e,t),ps(t),null;case 5:T5(t);var s=iu(_h.current);if(r=t.type,e!==null&&t.stateNode!=null)ej(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(Ve(166));return ps(t),null}if(e=iu(po.current),mm(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[oo]=t,n[Nh]=a,e=(t.mode&1)!==0,r){case"dialog":Lr("cancel",n),Lr("close",n);break;case"iframe":case"object":case"embed":Lr("load",n);break;case"video":case"audio":for(s=0;s<T0.length;s++)Lr(T0[s],n);break;case"source":Lr("error",n);break;case"img":case"image":case"link":Lr("error",n),Lr("load",n);break;case"details":Lr("toggle",n);break;case"input":V4(n,a),Lr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Lr("invalid",n);break;case"textarea":G4(n,a),Lr("invalid",n)}Yv(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&pm(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&pm(n.textContent,o,e),s=["children",""+o]):dh.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Lr("scroll",n)}switch(r){case"input":im(n),K4(n,a,!0);break;case"textarea":im(n),Y4(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=W1)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=T6(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[oo]=t,e[Nh]=n,ZE(e,t,!1,!1),t.stateNode=e;e:{switch(i=Xv(r,n),r){case"dialog":Lr("cancel",e),Lr("close",e),s=n;break;case"iframe":case"object":case"embed":Lr("load",e),s=n;break;case"video":case"audio":for(s=0;s<T0.length;s++)Lr(T0[s],e);s=n;break;case"source":Lr("error",e),s=n;break;case"img":case"image":case"link":Lr("error",e),Lr("load",e),s=n;break;case"details":Lr("toggle",e),s=n;break;case"input":V4(e,n),s=Hv(e,n),Lr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Gr({},n,{value:void 0}),Lr("invalid",e);break;case"textarea":G4(e,n),s=Kv(e,n),Lr("invalid",e);break;default:s=n}Yv(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?F6(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&C6(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&hh(e,c):typeof c=="number"&&hh(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(dh.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Lr("scroll",e):c!=null&&i5(e,a,c,i))}switch(r){case"input":im(e),K4(e,n,!1);break;case"textarea":im(e),Y4(e);break;case"option":n.value!=null&&e.setAttribute("value",""+yc(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Bf(e,!!n.multiple,a,!1):n.defaultValue!=null&&Bf(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=W1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ps(t),null;case 6:if(e&&t.stateNode!=null)tj(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(Ve(166));if(r=iu(_h.current),iu(po.current),mm(t)){if(n=t.stateNode,r=t.memoizedProps,n[oo]=t,(a=n.nodeValue!==r)&&(e=Ta,e!==null))switch(e.tag){case 3:pm(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&pm(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[oo]=t,t.stateNode=n}return ps(t),null;case 13:if(Rr(Wr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(zr&&ja!==null&&t.mode&1&&!(t.flags&128))yE(),pd(),t.flags|=98560,a=!1;else if(a=mm(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(Ve(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(Ve(317));a[oo]=t}else pd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ps(t),a=!1}else ki!==null&&(Cy(ki),ki=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||Wr.current&1?In===0&&(In=3):z5())),t.updateQueue!==null&&(t.flags|=4),ps(t),null);case 4:return gd(),Ny(e,t),e===null&&wh(t.stateNode.containerInfo),ps(t),null;case 10:return k5(t.type._context),ps(t),null;case 17:return oa(t.type)&&V1(),ps(t),null;case 19:if(Rr(Wr),a=t.memoizedState,a===null)return ps(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)g0(a,!1);else{if(In!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=Z1(e),i!==null){for(t.flags|=128,g0(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Cr(Wr,Wr.current&1|2),t.child}e=e.sibling}a.tail!==null&&un()>vd&&(t.flags|=128,n=!0,g0(a,!1),t.lanes=4194304)}else{if(!n)if(e=Z1(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),g0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!zr)return ps(t),null}else 2*un()-a.renderingStartTime>vd&&r!==1073741824&&(t.flags|=128,n=!0,g0(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=un(),t.sibling=null,r=Wr.current,Cr(Wr,n?r&1|2:r&1),t):(ps(t),null);case 22:case 23:return $5(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Sa&1073741824&&(ps(t),t.subtreeFlags&6&&(t.flags|=8192)):ps(t),null;case 24:return null;case 25:return null}throw Error(Ve(156,t.tag))}function u7(e,t){switch(b5(t),t.tag){case 1:return oa(t.type)&&V1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return gd(),Rr(ia),Rr(As),C5(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return T5(t),null;case 13:if(Rr(Wr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ve(340));pd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Rr(Wr),null;case 4:return gd(),null;case 10:return k5(t.type._context),null;case 22:case 23:return $5(),null;case 24:return null;default:return null}}var vm=!1,bs=!1,f7=typeof WeakSet=="function"?WeakSet:Set,it=null;function Of(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){tn(e,t,n)}else r.current=null}function Sy(e,t,r){try{r()}catch(n){tn(e,t,n)}}var M3=!1;function d7(e,t){if(iy=z1,e=iE(),y5(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,f=0,u=0,p=e,d=null;t:for(;;){for(var h;p!==r||s!==0&&p.nodeType!==3||(o=i+s),p!==a||n!==0&&p.nodeType!==3||(c=i+n),p.nodeType===3&&(i+=p.nodeValue.length),(h=p.firstChild)!==null;)d=p,p=h;for(;;){if(p===e)break t;if(d===r&&++f===s&&(o=i),d===a&&++u===n&&(c=i),(h=p.nextSibling)!==null)break;p=d,d=p.parentNode}p=h}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(oy={focusedElem:e,selectionRange:r},z1=!1,it=t;it!==null;)if(t=it,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,it=e;else for(;it!==null;){t=it;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:vi(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ve(163))}}catch(S){tn(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,it=e;break}it=t.return}return m=M3,M3=!1,m}function H0(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Sy(t,r,a)}s=s.next}while(s!==n)}}function rx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function _y(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function rj(e){var t=e.alternate;t!==null&&(e.alternate=null,rj(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[oo],delete t[Nh],delete t[uy],delete t[GL],delete t[YL])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function nj(e){return e.tag===5||e.tag===3||e.tag===4}function B3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||nj(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function ky(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=W1));else if(n!==4&&(e=e.child,e!==null))for(ky(e,t,r),e=e.sibling;e!==null;)ky(e,t,r),e=e.sibling}function Ey(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Ey(e,t,r),e=e.sibling;e!==null;)Ey(e,t,r),e=e.sibling}var rs=null,Ni=!1;function Ol(e,t,r){for(r=r.child;r!==null;)sj(e,t,r),r=r.sibling}function sj(e,t,r){if(ho&&typeof ho.onCommitFiberUnmount=="function")try{ho.onCommitFiberUnmount(Gg,r)}catch{}switch(r.tag){case 5:bs||Of(r,t);case 6:var n=rs,s=Ni;rs=null,Ol(e,t,r),rs=n,Ni=s,rs!==null&&(Ni?(e=rs,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):rs.removeChild(r.stateNode));break;case 18:rs!==null&&(Ni?(e=rs,r=r.stateNode,e.nodeType===8?E2(e.parentNode,r):e.nodeType===1&&E2(e,r),xh(e)):E2(rs,r.stateNode));break;case 4:n=rs,s=Ni,rs=r.stateNode.containerInfo,Ni=!0,Ol(e,t,r),rs=n,Ni=s;break;case 0:case 11:case 14:case 15:if(!bs&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Sy(r,t,i),s=s.next}while(s!==n)}Ol(e,t,r);break;case 1:if(!bs&&(Of(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){tn(r,t,o)}Ol(e,t,r);break;case 21:Ol(e,t,r);break;case 22:r.mode&1?(bs=(n=bs)||r.memoizedState!==null,Ol(e,t,r),bs=n):Ol(e,t,r);break;default:Ol(e,t,r)}}function U3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new f7),t.forEach(function(n){var s=b7.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function hi(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:rs=o.stateNode,Ni=!1;break e;case 3:rs=o.stateNode.containerInfo,Ni=!0;break e;case 4:rs=o.stateNode.containerInfo,Ni=!0;break e}o=o.return}if(rs===null)throw Error(Ve(160));sj(a,i,s),rs=null,Ni=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(f){tn(s,t,f)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)aj(t,e),t=t.sibling}function aj(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(hi(t,e),Yi(e),n&4){try{H0(3,e,e.return),rx(3,e)}catch(g){tn(e,e.return,g)}try{H0(5,e,e.return)}catch(g){tn(e,e.return,g)}}break;case 1:hi(t,e),Yi(e),n&512&&r!==null&&Of(r,r.return);break;case 5:if(hi(t,e),Yi(e),n&512&&r!==null&&Of(r,r.return),e.flags&32){var s=e.stateNode;try{hh(s,"")}catch(g){tn(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&j6(s,a),Xv(o,i);var f=Xv(o,a);for(i=0;i<c.length;i+=2){var u=c[i],p=c[i+1];u==="style"?F6(s,p):u==="dangerouslySetInnerHTML"?C6(s,p):u==="children"?hh(s,p):i5(s,u,p,f)}switch(o){case"input":Wv(s,a);break;case"textarea":A6(s,a);break;case"select":var d=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?Bf(s,!!a.multiple,h,!1):d!==!!a.multiple&&(a.defaultValue!=null?Bf(s,!!a.multiple,a.defaultValue,!0):Bf(s,!!a.multiple,a.multiple?[]:"",!1))}s[Nh]=a}catch(g){tn(e,e.return,g)}}break;case 6:if(hi(t,e),Yi(e),n&4){if(e.stateNode===null)throw Error(Ve(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){tn(e,e.return,g)}}break;case 3:if(hi(t,e),Yi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xh(t.containerInfo)}catch(g){tn(e,e.return,g)}break;case 4:hi(t,e),Yi(e);break;case 13:hi(t,e),Yi(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(B5=un())),n&4&&U3(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(bs=(f=bs)||u,hi(t,e),bs=f):hi(t,e),Yi(e),n&8192){if(f=e.memoizedState!==null,(e.stateNode.isHidden=f)&&!u&&e.mode&1)for(it=e,u=e.child;u!==null;){for(p=it=u;it!==null;){switch(d=it,h=d.child,d.tag){case 0:case 11:case 14:case 15:H0(4,d,d.return);break;case 1:Of(d,d.return);var m=d.stateNode;if(typeof m.componentWillUnmount=="function"){n=d,r=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){tn(n,r,g)}}break;case 5:Of(d,d.return);break;case 22:if(d.memoizedState!==null){z3(p);continue}}h!==null?(h.return=d,it=h):z3(p)}u=u.sibling}e:for(u=null,p=e;;){if(p.tag===5){if(u===null){u=p;try{s=p.stateNode,f?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=P6("display",i))}catch(g){tn(e,e.return,g)}}}else if(p.tag===6){if(u===null)try{p.stateNode.nodeValue=f?"":p.memoizedProps}catch(g){tn(e,e.return,g)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;u===p&&(u=null),p=p.return}u===p&&(u=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:hi(t,e),Yi(e),n&4&&U3(e);break;case 21:break;default:hi(t,e),Yi(e)}}function Yi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(nj(r)){var n=r;break e}r=r.return}throw Error(Ve(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(hh(s,""),n.flags&=-33);var a=B3(e);Ey(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=B3(e);ky(e,o,i);break;default:throw Error(Ve(161))}}catch(c){tn(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function h7(e,t,r){it=e,ij(e)}function ij(e,t,r){for(var n=(e.mode&1)!==0;it!==null;){var s=it,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||vm;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||bs;o=vm;var f=bs;if(vm=i,(bs=c)&&!f)for(it=s;it!==null;)i=it,c=i.child,i.tag===22&&i.memoizedState!==null?q3(s):c!==null?(c.return=i,it=c):q3(s);for(;a!==null;)it=a,ij(a),a=a.sibling;it=s,vm=o,bs=f}$3(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,it=a):$3(e)}}function $3(e){for(;it!==null;){var t=it;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:bs||rx(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!bs)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:vi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&k3(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}k3(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var f=t.alternate;if(f!==null){var u=f.memoizedState;if(u!==null){var p=u.dehydrated;p!==null&&xh(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ve(163))}bs||t.flags&512&&_y(t)}catch(d){tn(t,t.return,d)}}if(t===e){it=null;break}if(r=t.sibling,r!==null){r.return=t.return,it=r;break}it=t.return}}function z3(e){for(;it!==null;){var t=it;if(t===e){it=null;break}var r=t.sibling;if(r!==null){r.return=t.return,it=r;break}it=t.return}}function q3(e){for(;it!==null;){var t=it;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{rx(4,t)}catch(c){tn(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){tn(t,s,c)}}var a=t.return;try{_y(t)}catch(c){tn(t,a,c)}break;case 5:var i=t.return;try{_y(t)}catch(c){tn(t,i,c)}}}catch(c){tn(t,t.return,c)}if(t===e){it=null;break}var o=t.sibling;if(o!==null){o.return=t.return,it=o;break}it=t.return}}var p7=Math.ceil,rg=gl.ReactCurrentDispatcher,I5=gl.ReactCurrentOwner,Ja=gl.ReactCurrentBatchConfig,cr=0,Vn=null,En=null,as=0,Sa=0,Rf=Ac(0),In=0,Ah=null,Tu=0,nx=0,M5=0,W0=null,na=null,B5=0,vd=1/0,Vo=null,ng=!1,jy=null,hc=null,ym=!1,nc=null,sg=0,V0=0,Ay=null,d1=-1,h1=0;function qs(){return cr&6?un():d1!==-1?d1:d1=un()}function pc(e){return e.mode&1?cr&2&&as!==0?as&-as:JL.transition!==null?(h1===0&&(h1=H6()),h1):(e=vr,e!==0||(e=window.event,e=e===void 0?16:J6(e.type)),e):1}function Li(e,t,r,n){if(50<V0)throw V0=0,Ay=null,Error(Ve(185));lp(e,r,n),(!(cr&2)||e!==Vn)&&(e===Vn&&(!(cr&2)&&(nx|=r),In===4&&Kl(e,as)),la(e,n),r===1&&cr===0&&!(t.mode&1)&&(vd=un()+500,Zg&&Tc()))}function la(e,t){var r=e.callbackNode;JF(e,t);var n=$1(e,e===Vn?as:0);if(n===0)r!==null&&Q4(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Q4(r),t===1)e.tag===0?XL(H3.bind(null,e)):gE(H3.bind(null,e)),VL(function(){!(cr&6)&&Tc()}),r=null;else{switch(W6(n)){case 1:r=f5;break;case 4:r=z6;break;case 16:r=U1;break;case 536870912:r=q6;break;default:r=U1}r=pj(r,oj.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function oj(e,t){if(d1=-1,h1=0,cr&6)throw Error(Ve(327));var r=e.callbackNode;if(Hf()&&e.callbackNode!==r)return null;var n=$1(e,e===Vn?as:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ag(e,n);else{t=n;var s=cr;cr|=2;var a=cj();(Vn!==e||as!==t)&&(Vo=null,vd=un()+500,gu(e,t));do try{x7();break}catch(o){lj(e,o)}while(!0);_5(),rg.current=a,cr=s,En!==null?t=0:(Vn=null,as=0,t=In)}if(t!==0){if(t===2&&(s=ty(e),s!==0&&(n=s,t=Ty(e,s))),t===1)throw r=Ah,gu(e,0),Kl(e,n),la(e,un()),r;if(t===6)Kl(e,n);else{if(s=e.current.alternate,!(n&30)&&!m7(s)&&(t=ag(e,n),t===2&&(a=ty(e),a!==0&&(n=a,t=Ty(e,a))),t===1))throw r=Ah,gu(e,0),Kl(e,n),la(e,un()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(Ve(345));case 2:Zc(e,na,Vo);break;case 3:if(Kl(e,n),(n&130023424)===n&&(t=B5+500-un(),10<t)){if($1(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){qs(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=cy(Zc.bind(null,e,na,Vo),t);break}Zc(e,na,Vo);break;case 4:if(Kl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-Fi(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=un()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*p7(n/1960))-n,10<n){e.timeoutHandle=cy(Zc.bind(null,e,na,Vo),n);break}Zc(e,na,Vo);break;case 5:Zc(e,na,Vo);break;default:throw Error(Ve(329))}}}return la(e,un()),e.callbackNode===r?oj.bind(null,e):null}function Ty(e,t){var r=W0;return e.current.memoizedState.isDehydrated&&(gu(e,t).flags|=256),e=ag(e,t),e!==2&&(t=na,na=r,t!==null&&Cy(t)),e}function Cy(e){na===null?na=e:na.push.apply(na,e)}function m7(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ri(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Kl(e,t){for(t&=~M5,t&=~nx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Fi(t),n=1<<r;e[r]=-1,t&=~n}}function H3(e){if(cr&6)throw Error(Ve(327));Hf();var t=$1(e,0);if(!(t&1))return la(e,un()),null;var r=ag(e,t);if(e.tag!==0&&r===2){var n=ty(e);n!==0&&(t=n,r=Ty(e,n))}if(r===1)throw r=Ah,gu(e,0),Kl(e,t),la(e,un()),r;if(r===6)throw Error(Ve(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Zc(e,na,Vo),la(e,un()),null}function U5(e,t){var r=cr;cr|=1;try{return e(t)}finally{cr=r,cr===0&&(vd=un()+500,Zg&&Tc())}}function Cu(e){nc!==null&&nc.tag===0&&!(cr&6)&&Hf();var t=cr;cr|=1;var r=Ja.transition,n=vr;try{if(Ja.transition=null,vr=1,e)return e()}finally{vr=n,Ja.transition=r,cr=t,!(cr&6)&&Tc()}}function $5(){Sa=Rf.current,Rr(Rf)}function gu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,WL(r)),En!==null)for(r=En.return;r!==null;){var n=r;switch(b5(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&V1();break;case 3:gd(),Rr(ia),Rr(As),C5();break;case 5:T5(n);break;case 4:gd();break;case 13:Rr(Wr);break;case 19:Rr(Wr);break;case 10:k5(n.type._context);break;case 22:case 23:$5()}r=r.return}if(Vn=e,En=e=mc(e.current,null),as=Sa=t,In=0,Ah=null,M5=nx=Tu=0,na=W0=null,au!==null){for(t=0;t<au.length;t++)if(r=au[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}au=null}return e}function lj(e,t){do{var r=En;try{if(_5(),c1.current=tg,eg){for(var n=Kr.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}eg=!1}if(Au=0,Hn=Rn=Kr=null,q0=!1,kh=0,I5.current=null,r===null||r.return===null){In=1,Ah=t,En=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=as,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,u=o,p=u.tag;if(!(u.mode&1)&&(p===0||p===11||p===15)){var d=u.alternate;d?(u.updateQueue=d.updateQueue,u.memoizedState=d.memoizedState,u.lanes=d.lanes):(u.updateQueue=null,u.memoizedState=null)}var h=P3(i);if(h!==null){h.flags&=-257,F3(h,i,o,a,t),h.mode&1&&C3(a,f,t),t=h,c=f;var m=t.updateQueue;if(m===null){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}else{if(!(t&1)){C3(a,f,t),z5();break e}c=Error(Ve(426))}}else if(zr&&o.mode&1){var y=P3(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),F3(y,i,o,a,t),N5(xd(c,o));break e}}a=c=xd(c,o),In!==4&&(In=2),W0===null?W0=[a]:W0.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var v=WE(a,c,t);_3(a,v);break e;case 1:o=c;var b=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof b.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(hc===null||!hc.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=VE(a,o,t);_3(a,S);break e}}a=a.return}while(a!==null)}fj(r)}catch(A){t=A,En===r&&r!==null&&(En=r=r.return);continue}break}while(!0)}function cj(){var e=rg.current;return rg.current=tg,e===null?tg:e}function z5(){(In===0||In===3||In===2)&&(In=4),Vn===null||!(Tu&268435455)&&!(nx&268435455)||Kl(Vn,as)}function ag(e,t){var r=cr;cr|=2;var n=cj();(Vn!==e||as!==t)&&(Vo=null,gu(e,t));do try{g7();break}catch(s){lj(e,s)}while(!0);if(_5(),cr=r,rg.current=n,En!==null)throw Error(Ve(261));return Vn=null,as=0,In}function g7(){for(;En!==null;)uj(En)}function x7(){for(;En!==null&&!zF();)uj(En)}function uj(e){var t=hj(e.alternate,e,Sa);e.memoizedProps=e.pendingProps,t===null?fj(e):En=t,I5.current=null}function fj(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=u7(r,t),r!==null){r.flags&=32767,En=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{In=6,En=null;return}}else if(r=c7(r,t,Sa),r!==null){En=r;return}if(t=t.sibling,t!==null){En=t;return}En=t=e}while(t!==null);In===0&&(In=5)}function Zc(e,t,r){var n=vr,s=Ja.transition;try{Ja.transition=null,vr=1,v7(e,t,r,n)}finally{Ja.transition=s,vr=n}return null}function v7(e,t,r,n){do Hf();while(nc!==null);if(cr&6)throw Error(Ve(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(Ve(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(QF(e,a),e===Vn&&(En=Vn=null,as=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ym||(ym=!0,pj(U1,function(){return Hf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Ja.transition,Ja.transition=null;var i=vr;vr=1;var o=cr;cr|=4,I5.current=null,d7(e,r),aj(r,e),ML(oy),z1=!!iy,oy=iy=null,e.current=r,h7(r),qF(),cr=o,vr=i,Ja.transition=a}else e.current=r;if(ym&&(ym=!1,nc=e,sg=s),a=e.pendingLanes,a===0&&(hc=null),VF(r.stateNode),la(e,un()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(ng)throw ng=!1,e=jy,jy=null,e;return sg&1&&e.tag!==0&&Hf(),a=e.pendingLanes,a&1?e===Ay?V0++:(V0=0,Ay=e):V0=0,Tc(),null}function Hf(){if(nc!==null){var e=W6(sg),t=Ja.transition,r=vr;try{if(Ja.transition=null,vr=16>e?16:e,nc===null)var n=!1;else{if(e=nc,nc=null,sg=0,cr&6)throw Error(Ve(331));var s=cr;for(cr|=4,it=e.current;it!==null;){var a=it,i=a.child;if(it.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var f=o[c];for(it=f;it!==null;){var u=it;switch(u.tag){case 0:case 11:case 15:H0(8,u,a)}var p=u.child;if(p!==null)p.return=u,it=p;else for(;it!==null;){u=it;var d=u.sibling,h=u.return;if(rj(u),u===f){it=null;break}if(d!==null){d.return=h,it=d;break}it=h}}}var m=a.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(g!==null)}}it=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,it=i;else e:for(;it!==null;){if(a=it,a.flags&2048)switch(a.tag){case 0:case 11:case 15:H0(9,a,a.return)}var v=a.sibling;if(v!==null){v.return=a.return,it=v;break e}it=a.return}}var b=e.current;for(it=b;it!==null;){i=it;var w=i.child;if(i.subtreeFlags&2064&&w!==null)w.return=i,it=w;else e:for(i=b;it!==null;){if(o=it,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:rx(9,o)}}catch(A){tn(o,o.return,A)}if(o===i){it=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,it=S;break e}it=o.return}}if(cr=s,Tc(),ho&&typeof ho.onPostCommitFiberRoot=="function")try{ho.onPostCommitFiberRoot(Gg,e)}catch{}n=!0}return n}finally{vr=r,Ja.transition=t}}return!1}function W3(e,t,r){t=xd(r,t),t=WE(e,t,1),e=dc(e,t,1),t=qs(),e!==null&&(lp(e,1,t),la(e,t))}function tn(e,t,r){if(e.tag===3)W3(e,e,r);else for(;t!==null;){if(t.tag===3){W3(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hc===null||!hc.has(n))){e=xd(r,e),e=VE(t,e,1),t=dc(t,e,1),e=qs(),t!==null&&(lp(t,1,e),la(t,e));break}}t=t.return}}function y7(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qs(),e.pingedLanes|=e.suspendedLanes&r,Vn===e&&(as&r)===r&&(In===4||In===3&&(as&130023424)===as&&500>un()-B5?gu(e,0):M5|=r),la(e,t)}function dj(e,t){t===0&&(e.mode&1?(t=cm,cm<<=1,!(cm&130023424)&&(cm=4194304)):t=1);var r=qs();e=fl(e,t),e!==null&&(lp(e,t,r),la(e,r))}function w7(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),dj(e,r)}function b7(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(Ve(314))}n!==null&&n.delete(t),dj(e,r)}var hj;hj=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ia.current)sa=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return sa=!1,l7(e,t,r);sa=!!(e.flags&131072)}else sa=!1,zr&&t.flags&1048576&&xE(t,Y1,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;f1(e,t),e=t.pendingProps;var s=hd(t,As.current);qf(t,r),s=F5(null,t,n,e,s,r);var a=L5();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,oa(n)?(a=!0,K1(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,j5(t),s.updater=tx,t.stateNode=s,s._reactInternals=t,gy(t,n,e,r),t=yy(null,t,n,!0,a,r)):(t.tag=0,zr&&a&&w5(t),Is(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(f1(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=S7(n),e=vi(n,e),s){case 0:t=vy(null,t,n,e,r);break e;case 1:t=O3(null,t,n,e,r);break e;case 11:t=L3(null,t,n,e,r);break e;case 14:t=D3(null,t,n,vi(n.type,e),r);break e}throw Error(Ve(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:vi(n,s),vy(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:vi(n,s),O3(e,t,n,s,r);case 3:e:{if(XE(t),e===null)throw Error(Ve(387));n=t.pendingProps,a=t.memoizedState,s=a.element,SE(e,t),Q1(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=xd(Error(Ve(423)),t),t=R3(e,t,n,r,s);break e}else if(n!==s){s=xd(Error(Ve(424)),t),t=R3(e,t,n,r,s);break e}else for(ja=fc(t.stateNode.containerInfo.firstChild),Ta=t,zr=!0,ki=null,r=bE(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(pd(),n===s){t=dl(e,t,r);break e}Is(e,t,n,r)}t=t.child}return t;case 5:return _E(t),e===null&&hy(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,ly(n,s)?i=null:a!==null&&ly(n,a)&&(t.flags|=32),YE(e,t),Is(e,t,i,r),t.child;case 6:return e===null&&hy(t),null;case 13:return JE(e,t,r);case 4:return A5(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=md(t,null,n,r):Is(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:vi(n,s),L3(e,t,n,s,r);case 7:return Is(e,t,t.pendingProps,r),t.child;case 8:return Is(e,t,t.pendingProps.children,r),t.child;case 12:return Is(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Cr(X1,n._currentValue),n._currentValue=i,a!==null)if(Ri(a.value,i)){if(a.children===s.children&&!ia.current){t=dl(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=sl(-1,r&-r),c.tag=2;var f=a.updateQueue;if(f!==null){f=f.shared;var u=f.pending;u===null?c.next=c:(c.next=u.next,u.next=c),f.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),py(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(Ve(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),py(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Is(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,qf(t,r),s=Za(s),n=n(s),t.flags|=1,Is(e,t,n,r),t.child;case 14:return n=t.type,s=vi(n,t.pendingProps),s=vi(n.type,s),D3(e,t,n,s,r);case 15:return KE(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:vi(n,s),f1(e,t),t.tag=1,oa(n)?(e=!0,K1(t)):e=!1,qf(t,r),HE(t,n,s),gy(t,n,s,r),yy(null,t,n,!0,e,r);case 19:return QE(e,t,r);case 22:return GE(e,t,r)}throw Error(Ve(156,t.tag))};function pj(e,t){return $6(e,t)}function N7(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xa(e,t,r,n){return new N7(e,t,r,n)}function q5(e){return e=e.prototype,!(!e||!e.isReactComponent)}function S7(e){if(typeof e=="function")return q5(e)?1:0;if(e!=null){if(e=e.$$typeof,e===l5)return 11;if(e===c5)return 14}return 2}function mc(e,t){var r=e.alternate;return r===null?(r=Xa(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function p1(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")q5(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ef:return xu(r.children,s,a,t);case o5:i=8,s|=8;break;case Uv:return e=Xa(12,r,t,s|2),e.elementType=Uv,e.lanes=a,e;case $v:return e=Xa(13,r,t,s),e.elementType=$v,e.lanes=a,e;case zv:return e=Xa(19,r,t,s),e.elementType=zv,e.lanes=a,e;case _6:return sx(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case N6:i=10;break e;case S6:i=9;break e;case l5:i=11;break e;case c5:i=14;break e;case zl:i=16,n=null;break e}throw Error(Ve(130,e==null?e:typeof e,""))}return t=Xa(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function xu(e,t,r,n){return e=Xa(7,e,n,t),e.lanes=r,e}function sx(e,t,r,n){return e=Xa(22,e,n,t),e.elementType=_6,e.lanes=r,e.stateNode={isHidden:!1},e}function D2(e,t,r){return e=Xa(6,e,null,t),e.lanes=r,e}function O2(e,t,r){return t=Xa(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function _7(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=m2(0),this.expirationTimes=m2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=m2(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function H5(e,t,r,n,s,a,i,o,c){return e=new _7(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Xa(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},j5(a),e}function k7(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kf,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function mj(e){if(!e)return wc;e=e._reactInternals;e:{if($u(e)!==e||e.tag!==1)throw Error(Ve(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(oa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ve(171))}if(e.tag===1){var r=e.type;if(oa(r))return mE(e,r,t)}return t}function gj(e,t,r,n,s,a,i,o,c){return e=H5(r,n,!0,e,s,a,i,o,c),e.context=mj(null),r=e.current,n=qs(),s=pc(r),a=sl(n,s),a.callback=t??null,dc(r,a,s),e.current.lanes=s,lp(e,s,n),la(e,n),e}function ax(e,t,r,n){var s=t.current,a=qs(),i=pc(s);return r=mj(r),t.context===null?t.context=r:t.pendingContext=r,t=sl(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=dc(s,t,i),e!==null&&(Li(e,s,i,a),l1(e,s,i)),i}function ig(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function V3(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function W5(e,t){V3(e,t),(e=e.alternate)&&V3(e,t)}function E7(){return null}var xj=typeof reportError=="function"?reportError:function(e){console.error(e)};function V5(e){this._internalRoot=e}ix.prototype.render=V5.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ve(409));ax(e,t,null,null)};ix.prototype.unmount=V5.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cu(function(){ax(null,e,null,null)}),t[ul]=null}};function ix(e){this._internalRoot=e}ix.prototype.unstable_scheduleHydration=function(e){if(e){var t=G6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Vl.length&&t!==0&&t<Vl[r].priority;r++);Vl.splice(r,0,e),r===0&&X6(e)}};function K5(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ox(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function K3(){}function j7(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var f=ig(i);a.call(f)}}var i=gj(t,n,e,0,null,!1,!1,"",K3);return e._reactRootContainer=i,e[ul]=i.current,wh(e.nodeType===8?e.parentNode:e),Cu(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var f=ig(c);o.call(f)}}var c=H5(e,0,!1,null,null,!1,!1,"",K3);return e._reactRootContainer=c,e[ul]=c.current,wh(e.nodeType===8?e.parentNode:e),Cu(function(){ax(t,c,r,n)}),c}function lx(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=ig(i);o.call(c)}}ax(t,i,e,s)}else i=j7(r,t,e,s,n);return ig(i)}V6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=A0(t.pendingLanes);r!==0&&(d5(t,r|1),la(t,un()),!(cr&6)&&(vd=un()+500,Tc()))}break;case 13:Cu(function(){var n=fl(e,1);if(n!==null){var s=qs();Li(n,e,1,s)}}),W5(e,1)}};h5=function(e){if(e.tag===13){var t=fl(e,134217728);if(t!==null){var r=qs();Li(t,e,134217728,r)}W5(e,134217728)}};K6=function(e){if(e.tag===13){var t=pc(e),r=fl(e,t);if(r!==null){var n=qs();Li(r,e,t,n)}W5(e,t)}};G6=function(){return vr};Y6=function(e,t){var r=vr;try{return vr=e,t()}finally{vr=r}};Qv=function(e,t,r){switch(t){case"input":if(Wv(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Qg(n);if(!s)throw Error(Ve(90));E6(n),Wv(n,s)}}}break;case"textarea":A6(e,r);break;case"select":t=r.value,t!=null&&Bf(e,!!r.multiple,t,!1)}};O6=U5;R6=Cu;var A7={usingClientEntryPoint:!1,Events:[up,Cf,Qg,L6,D6,U5]},x0={findFiberByHostInstance:su,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},T7={bundleType:x0.bundleType,version:x0.version,rendererPackageName:x0.rendererPackageName,rendererConfig:x0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=B6(e),e===null?null:e.stateNode},findFiberByHostInstance:x0.findFiberByHostInstance||E7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wm.isDisabled&&wm.supportsFiber)try{Gg=wm.inject(T7),ho=wm}catch{}}Da.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=A7;Da.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!K5(t))throw Error(Ve(200));return k7(e,t,null,r)};Da.createRoot=function(e,t){if(!K5(e))throw Error(Ve(299));var r=!1,n="",s=xj;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=H5(e,1,!1,null,null,r,!1,n,s),e[ul]=t.current,wh(e.nodeType===8?e.parentNode:e),new V5(t)};Da.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ve(188)):(e=Object.keys(e).join(","),Error(Ve(268,e)));return e=B6(t),e=e===null?null:e.stateNode,e};Da.flushSync=function(e){return Cu(e)};Da.hydrate=function(e,t,r){if(!ox(t))throw Error(Ve(200));return lx(null,e,t,!0,r)};Da.hydrateRoot=function(e,t,r){if(!K5(e))throw Error(Ve(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=xj;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=gj(t,null,e,1,r??null,s,!1,a,i),e[ul]=t.current,wh(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new ix(t)};Da.render=function(e,t,r){if(!ox(t))throw Error(Ve(200));return lx(null,e,t,!1,r)};Da.unmountComponentAtNode=function(e){if(!ox(e))throw Error(Ve(40));return e._reactRootContainer?(Cu(function(){lx(null,null,e,!1,function(){e._reactRootContainer=null,e[ul]=null})}),!0):!1};Da.unstable_batchedUpdates=U5;Da.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!ox(r))throw Error(Ve(200));if(e==null||e._reactInternals===void 0)throw Error(Ve(38));return lx(e,t,r,!1,n)};Da.version="18.3.1-next-f1338f8080-20240426";function vj(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vj)}catch(e){console.error(e)}}vj(),v6.exports=Da;var C7=v6.exports,G3=C7;Mv.createRoot=G3.createRoot,Mv.hydrateRoot=G3.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(this,arguments)}var sc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(sc||(sc={}));const Y3="popstate";function P7(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Py("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:og(s)}return L7(t,r,null,e)}function pn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function G5(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function F7(){return Math.random().toString(36).substr(2,8)}function X3(e,t){return{usr:e.state,key:e.key,idx:t}}function Py(e,t,r,n){return r===void 0&&(r=null),Th({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?jd(t):t,{state:r,key:t&&t.key||n||F7()})}function og(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function jd(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function L7(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=sc.Pop,c=null,f=u();f==null&&(f=0,i.replaceState(Th({},i.state,{idx:f}),""));function u(){return(i.state||{idx:null}).idx}function p(){o=sc.Pop;let y=u(),v=y==null?null:y-f;f=y,c&&c({action:o,location:g.location,delta:v})}function d(y,v){o=sc.Push;let b=Py(g.location,y,v);f=u()+1;let w=X3(b,f),S=g.createHref(b);try{i.pushState(w,"",S)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(S)}a&&c&&c({action:o,location:g.location,delta:1})}function h(y,v){o=sc.Replace;let b=Py(g.location,y,v);f=u();let w=X3(b,f),S=g.createHref(b);i.replaceState(w,"",S),a&&c&&c({action:o,location:g.location,delta:0})}function m(y){let v=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof y=="string"?y:og(y);return b=b.replace(/ $/,"%20"),pn(v,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,v)}let g={get action(){return o},get location(){return e(s,i)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Y3,p),c=y,()=>{s.removeEventListener(Y3,p),c=null}},createHref(y){return t(s,y)},createURL:m,encodeLocation(y){let v=m(y);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:d,replace:h,go(y){return i.go(y)}};return g}var J3;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(J3||(J3={}));function D7(e,t,r){return r===void 0&&(r="/"),O7(e,t,r)}function O7(e,t,r,n){let s=typeof t=="string"?jd(t):t,a=Y5(s.pathname||"/",r);if(a==null)return null;let i=yj(e);R7(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let f=G7(a);o=W7(i[c],f)}return o}function yj(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(pn(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let f=gc([n,c.relativePath]),u=r.concat(c);a.children&&a.children.length>0&&(pn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),yj(a.children,t,u,f)),!(a.path==null&&!a.index)&&t.push({path:f,score:q7(f,a.index),routesMeta:u})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of wj(a.path))s(a,i,c)}),t}function wj(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=wj(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function R7(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:H7(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const I7=/^:[\w-]+$/,M7=3,B7=2,U7=1,$7=10,z7=-2,Q3=e=>e==="*";function q7(e,t){let r=e.split("/"),n=r.length;return r.some(Q3)&&(n+=z7),t&&(n+=B7),r.filter(s=>!Q3(s)).reduce((s,a)=>s+(I7.test(a)?M7:a===""?U7:$7),n)}function H7(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function W7(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],f=o===n.length-1,u=a==="/"?t:t.slice(a.length)||"/",p=V7({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},u),d=c.route;if(!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:gc([a,p.pathname]),pathnameBase:Z7(gc([a,p.pathnameBase])),route:d}),p.pathnameBase!=="/"&&(a=gc([a,p.pathnameBase]))}return i}function V7(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=K7(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((f,u,p)=>{let{paramName:d,isOptional:h}=u;if(d==="*"){let g=o[p]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const m=o[p];return h&&!m?f[d]=void 0:f[d]=(m||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:i,pattern:e}}function K7(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),G5(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function G7(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return G5(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Y5(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const Y7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,X7=e=>Y7.test(e);function J7(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?jd(e):e,a;if(r)if(X7(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),G5(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=Z3(r.substring(1),"/"):a=Z3(r,t)}else a=t;return{pathname:a,search:eD(n),hash:tD(s)}}function Z3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function R2(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Q7(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function X5(e,t){let r=Q7(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function J5(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=jd(e):(s=Th({},e),pn(!s.pathname||!s.pathname.includes("?"),R2("?","pathname","search",s)),pn(!s.pathname||!s.pathname.includes("#"),R2("#","pathname","hash",s)),pn(!s.search||!s.search.includes("#"),R2("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let d=i.split("/");for(;d[0]==="..";)d.shift(),p-=1;s.pathname=d.join("/")}o=p>=0?t[p]:"/"}let c=J7(s,o),f=i&&i!=="/"&&i.endsWith("/"),u=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(f||u)&&(c.pathname+="/"),c}const gc=e=>e.join("/").replace(/\/\/+/g,"/"),Z7=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),eD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function rD(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const bj=["post","put","patch","delete"];new Set(bj);const nD=["get",...bj];new Set(nD);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ch.apply(this,arguments)}const Q5=me.createContext(null),sD=me.createContext(null),Cc=me.createContext(null),cx=me.createContext(null),xl=me.createContext({outlet:null,matches:[],isDataRoute:!1}),Nj=me.createContext(null);function aD(e,t){let{relative:r}=t===void 0?{}:t;Ad()||pn(!1);let{basename:n,navigator:s}=me.useContext(Cc),{hash:a,pathname:i,search:o}=_j(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:gc([n,i])),s.createHref({pathname:c,search:o,hash:a})}function Ad(){return me.useContext(cx)!=null}function Td(){return Ad()||pn(!1),me.useContext(cx).location}function Sj(e){me.useContext(Cc).static||me.useLayoutEffect(e)}function Gn(){let{isDataRoute:e}=me.useContext(xl);return e?vD():iD()}function iD(){Ad()||pn(!1);let e=me.useContext(Q5),{basename:t,future:r,navigator:n}=me.useContext(Cc),{matches:s}=me.useContext(xl),{pathname:a}=Td(),i=JSON.stringify(X5(s,r.v7_relativeSplatPath)),o=me.useRef(!1);return Sj(()=>{o.current=!0}),me.useCallback(function(f,u){if(u===void 0&&(u={}),!o.current)return;if(typeof f=="number"){n.go(f);return}let p=J5(f,JSON.parse(i),a,u.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:gc([t,p.pathname])),(u.replace?n.replace:n.push)(p,u.state,u)},[t,n,i,a,e])}function Pc(){let{matches:e}=me.useContext(xl),t=e[e.length-1];return t?t.params:{}}function _j(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=me.useContext(Cc),{matches:s}=me.useContext(xl),{pathname:a}=Td(),i=JSON.stringify(X5(s,n.v7_relativeSplatPath));return me.useMemo(()=>J5(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function oD(e,t){return lD(e,t)}function lD(e,t,r,n){Ad()||pn(!1);let{navigator:s}=me.useContext(Cc),{matches:a}=me.useContext(xl),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let f=Td(),u;if(t){var p;let y=typeof t=="string"?jd(t):t;c==="/"||(p=y.pathname)!=null&&p.startsWith(c)||pn(!1),u=y}else u=f;let d=u.pathname||"/",h=d;if(c!=="/"){let y=c.replace(/^\//,"").split("/");h="/"+d.replace(/^\//,"").split("/").slice(y.length).join("/")}let m=D7(e,{pathname:h}),g=hD(m&&m.map(y=>Object.assign({},y,{params:Object.assign({},o,y.params),pathname:gc([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:gc([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),a,r,n);return t&&g?me.createElement(cx.Provider,{value:{location:Ch({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:sc.Pop}},g):g}function cD(){let e=xD(),t=rD(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return me.createElement(me.Fragment,null,me.createElement("h2",null,"Unexpected Application Error!"),me.createElement("h3",{style:{fontStyle:"italic"}},t),r?me.createElement("pre",{style:s},r):null,null)}const uD=me.createElement(cD,null);class fD extends me.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?me.createElement(xl.Provider,{value:this.props.routeContext},me.createElement(Nj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function dD(e){let{routeContext:t,match:r,children:n}=e,s=me.useContext(Q5);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),me.createElement(xl.Provider,{value:t},n)}function hD(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let u=i.findIndex(p=>p.route.id&&(o==null?void 0:o[p.route.id])!==void 0);u>=0||pn(!1),i=i.slice(0,Math.min(i.length,u+1))}let c=!1,f=-1;if(r&&n&&n.v7_partialHydration)for(let u=0;u<i.length;u++){let p=i[u];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(f=u),p.route.id){let{loaderData:d,errors:h}=r,m=p.route.loader&&d[p.route.id]===void 0&&(!h||h[p.route.id]===void 0);if(p.route.lazy||m){c=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}return i.reduceRight((u,p,d)=>{let h,m=!1,g=null,y=null;r&&(h=o&&p.route.id?o[p.route.id]:void 0,g=p.route.errorElement||uD,c&&(f<0&&d===0?(yD("route-fallback"),m=!0,y=null):f===d&&(m=!0,y=p.route.hydrateFallbackElement||null)));let v=t.concat(i.slice(0,d+1)),b=()=>{let w;return h?w=g:m?w=y:p.route.Component?w=me.createElement(p.route.Component,null):p.route.element?w=p.route.element:w=u,me.createElement(dD,{match:p,routeContext:{outlet:u,matches:v,isDataRoute:r!=null},children:w})};return r&&(p.route.ErrorBoundary||p.route.errorElement||d===0)?me.createElement(fD,{location:r.location,revalidation:r.revalidation,component:g,error:h,children:b(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):b()},null)}var kj=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(kj||{}),Ej=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Ej||{});function pD(e){let t=me.useContext(Q5);return t||pn(!1),t}function mD(e){let t=me.useContext(sD);return t||pn(!1),t}function gD(e){let t=me.useContext(xl);return t||pn(!1),t}function jj(e){let t=gD(),r=t.matches[t.matches.length-1];return r.route.id||pn(!1),r.route.id}function xD(){var e;let t=me.useContext(Nj),r=mD(),n=jj();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function vD(){let{router:e}=pD(kj.UseNavigateStable),t=jj(Ej.UseNavigateStable),r=me.useRef(!1);return Sj(()=>{r.current=!0}),me.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Ch({fromRouteId:t},a)))},[e,t])}const eN={};function yD(e,t,r){eN[e]||(eN[e]=!0)}function wD(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function es(e){let{to:t,replace:r,state:n,relative:s}=e;Ad()||pn(!1);let{future:a,static:i}=me.useContext(Cc),{matches:o}=me.useContext(xl),{pathname:c}=Td(),f=Gn(),u=J5(t,X5(o,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(u);return me.useEffect(()=>f(JSON.parse(p),{replace:r,state:n,relative:s}),[f,p,s,r,n]),null}function Sn(e){pn(!1)}function bD(e){let{basename:t="/",children:r=null,location:n,navigationType:s=sc.Pop,navigator:a,static:i=!1,future:o}=e;Ad()&&pn(!1);let c=t.replace(/^\/*/,"/"),f=me.useMemo(()=>({basename:c,navigator:a,static:i,future:Ch({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=jd(n));let{pathname:u="/",search:p="",hash:d="",state:h=null,key:m="default"}=n,g=me.useMemo(()=>{let y=Y5(u,c);return y==null?null:{location:{pathname:y,search:p,hash:d,state:h,key:m},navigationType:s}},[c,u,p,d,h,m,s]);return g==null?null:me.createElement(Cc.Provider,{value:f},me.createElement(cx.Provider,{children:r,value:g}))}function ND(e){let{children:t,location:r}=e;return oD(Fy(t),r)}new Promise(()=>{});function Fy(e,t){t===void 0&&(t=[]);let r=[];return me.Children.forEach(e,(n,s)=>{if(!me.isValidElement(n))return;let a=[...t,s];if(n.type===me.Fragment){r.push.apply(r,Fy(n.props.children,a));return}n.type!==Sn&&pn(!1),!n.props.index||!n.props.children||pn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Fy(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ly(){return Ly=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ly.apply(this,arguments)}function SD(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function _D(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function kD(e,t){return e.button===0&&(!t||t==="_self")&&!_D(e)}const ED=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],jD="6";try{window.__reactRouterVersion=jD}catch{}const AD="startTransition",tN=yF[AD];function TD(e){let{basename:t,children:r,future:n,window:s}=e,a=me.useRef();a.current==null&&(a.current=P7({window:s,v5Compat:!0}));let i=a.current,[o,c]=me.useState({action:i.action,location:i.location}),{v7_startTransition:f}=n||{},u=me.useCallback(p=>{f&&tN?tN(()=>c(p)):c(p)},[c,f]);return me.useLayoutEffect(()=>i.listen(u),[i,u]),me.useEffect(()=>wD(n),[n]),me.createElement(bD,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const CD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",PD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ai=me.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:c,to:f,preventScrollReset:u,viewTransition:p}=t,d=SD(t,ED),{basename:h}=me.useContext(Cc),m,g=!1;if(typeof f=="string"&&PD.test(f)&&(m=f,CD))try{let w=new URL(window.location.href),S=f.startsWith("//")?new URL(w.protocol+f):new URL(f),A=Y5(S.pathname,h);S.origin===w.origin&&A!=null?f=A+S.search+S.hash:g=!0}catch{}let y=aD(f,{relative:s}),v=FD(f,{replace:i,state:o,target:c,preventScrollReset:u,relative:s,viewTransition:p});function b(w){n&&n(w),w.defaultPrevented||v(w)}return me.createElement("a",Ly({},d,{href:m||y,onClick:g||a?n:b,ref:r,target:c}))});var rN;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(rN||(rN={}));var nN;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(nN||(nN={}));function FD(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,c=Gn(),f=Td(),u=_j(e,{relative:i});return me.useCallback(p=>{if(kD(p,r)){p.preventDefault();let d=n!==void 0?n:og(f)===og(u);c(e,{replace:d,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[f,c,u,n,s,r,e,a,i,o])}var ux=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},LD={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Xl,Zw,Jk,DD=(Jk=class{constructor(){er(this,Xl,LD);er(this,Zw,!1)}setTimeoutProvider(e){Ot(this,Xl,e)}setTimeout(e,t){return Oe(this,Xl).setTimeout(e,t)}clearTimeout(e){Oe(this,Xl).clearTimeout(e)}setInterval(e,t){return Oe(this,Xl).setInterval(e,t)}clearInterval(e){Oe(this,Xl).clearInterval(e)}},Xl=new WeakMap,Zw=new WeakMap,Jk),Dy=new DD;function OD(e){setTimeout(e,0)}var fx=typeof window>"u"||"Deno"in globalThis;function yi(){}function RD(e,t){return typeof e=="function"?e(t):e}function ID(e){return typeof e=="number"&&e>=0&&e!==1/0}function MD(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Oy(e,t){return typeof e=="function"?e(t):e}function BD(e,t){return typeof e=="function"?e(t):e}function sN(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==Z5(i,t.options))return!1}else if(!Fh(t.queryKey,i))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||a&&!a(t))}function aN(e,t){const{exact:r,status:n,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(Ph(t.options.mutationKey)!==Ph(a))return!1}else if(!Fh(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function Z5(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ph)(e)}function Ph(e){return JSON.stringify(e,(t,r)=>Ry(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function Fh(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Fh(e[r],t[r])):!1}var UD=Object.prototype.hasOwnProperty;function Aj(e,t){if(e===t)return e;const r=iN(e)&&iN(t);if(!r&&!(Ry(e)&&Ry(t)))return t;const s=(r?e:Object.keys(e)).length,a=r?t:Object.keys(t),i=a.length,o=r?new Array(i):{};let c=0;for(let f=0;f<i;f++){const u=r?f:a[f],p=e[u],d=t[u];if(p===d){o[u]=p,(r?f<s:UD.call(e,u))&&c++;continue}if(p===null||d===null||typeof p!="object"||typeof d!="object"){o[u]=d;continue}const h=Aj(p,d);o[u]=h,h===p&&c++}return s===i&&c===s?e:o}function iN(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ry(e){if(!oN(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!oN(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function oN(e){return Object.prototype.toString.call(e)==="[object Object]"}function $D(e){return new Promise(t=>{Dy.setTimeout(t,e)})}function zD(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?Aj(e,t):t}function qD(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function HD(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var eb=Symbol();function Tj(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===eb?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var uu,Jl,sd,Qk,WD=(Qk=class extends ux{constructor(){super();er(this,uu);er(this,Jl);er(this,sd);Ot(this,sd,t=>{if(!fx&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Oe(this,Jl)||this.setEventListener(Oe(this,sd))}onUnsubscribe(){var t;this.hasListeners()||((t=Oe(this,Jl))==null||t.call(this),Ot(this,Jl,void 0))}setEventListener(t){var r;Ot(this,sd,t),(r=Oe(this,Jl))==null||r.call(this),Ot(this,Jl,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Oe(this,uu)!==t&&(Ot(this,uu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Oe(this,uu)=="boolean"?Oe(this,uu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},uu=new WeakMap,Jl=new WeakMap,sd=new WeakMap,Qk),Cj=new WD;function VD(){let e,t;const r=new Promise((s,a)=>{e=s,t=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}var KD=OD;function GD(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=KD;const a=o=>{t?e.push(o):s(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(c=>{r(c)})})})};return{batch:o=>{let c;t++;try{c=o()}finally{t--,t||i()}return c},batchCalls:o=>(...c)=>{a(()=>{o(...c)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var Bs=GD(),ad,Ql,id,Zk,YD=(Zk=class extends ux{constructor(){super();er(this,ad,!0);er(this,Ql);er(this,id);Ot(this,id,t=>{if(!fx&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Oe(this,Ql)||this.setEventListener(Oe(this,id))}onUnsubscribe(){var t;this.hasListeners()||((t=Oe(this,Ql))==null||t.call(this),Ot(this,Ql,void 0))}setEventListener(t){var r;Ot(this,id,t),(r=Oe(this,Ql))==null||r.call(this),Ot(this,Ql,t(this.setOnline.bind(this)))}setOnline(t){Oe(this,ad)!==t&&(Ot(this,ad,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Oe(this,ad)}},ad=new WeakMap,Ql=new WeakMap,id=new WeakMap,Zk),lg=new YD;function XD(e){return Math.min(1e3*2**e,3e4)}function Pj(e){return(e??"online")==="online"?lg.isOnline():!0}var Iy=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Fj(e){let t=!1,r=0,n;const s=VD(),a=()=>s.status!=="pending",i=g=>{var y;if(!a()){const v=new Iy(g);d(v),(y=e.onCancel)==null||y.call(e,v)}},o=()=>{t=!0},c=()=>{t=!1},f=()=>Cj.isFocused()&&(e.networkMode==="always"||lg.isOnline())&&e.canRun(),u=()=>Pj(e.networkMode)&&e.canRun(),p=g=>{a()||(n==null||n(),s.resolve(g))},d=g=>{a()||(n==null||n(),s.reject(g))},h=()=>new Promise(g=>{var y;n=v=>{(a()||f())&&g(v)},(y=e.onPause)==null||y.call(e)}).then(()=>{var g;n=void 0,a()||(g=e.onContinue)==null||g.call(e)}),m=()=>{if(a())return;let g;const y=r===0?e.initialPromise:void 0;try{g=y??e.fn()}catch(v){g=Promise.reject(v)}Promise.resolve(g).then(p).catch(v=>{var F;if(a())return;const b=e.retry??(fx?0:3),w=e.retryDelay??XD,S=typeof w=="function"?w(r,v):w,A=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,v);if(t||!A){d(v);return}r++,(F=e.onFail)==null||F.call(e,r,v),$D(S).then(()=>f()?void 0:h()).then(()=>{t?d(v):m()})})};return{promise:s,status:()=>s.status,cancel:i,continue:()=>(n==null||n(),s),cancelRetry:o,continueRetry:c,canStart:u,start:()=>(u()?m():h().then(m),s)}}var fu,e6,Lj=(e6=class{constructor(){er(this,fu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),ID(this.gcTime)&&Ot(this,fu,Dy.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(fx?1/0:5*60*1e3))}clearGcTimeout(){Oe(this,fu)&&(Dy.clearTimeout(Oe(this,fu)),Ot(this,fu,void 0))}},fu=new WeakMap,e6),du,od,Va,hu,zn,sp,pu,wi,Wo,t6,JD=(t6=class extends Lj{constructor(t){super();er(this,wi);er(this,du);er(this,od);er(this,Va);er(this,hu);er(this,zn);er(this,sp);er(this,pu);Ot(this,pu,!1),Ot(this,sp,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ot(this,hu,t.client),Ot(this,Va,Oe(this,hu).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ot(this,du,cN(this.options)),this.state=t.state??Oe(this,du),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Oe(this,zn))==null?void 0:t.promise}setOptions(t){if(this.options={...Oe(this,sp),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=cN(this.options);r.data!==void 0&&(this.setState(lN(r.data,r.dataUpdatedAt)),Ot(this,du,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Oe(this,Va).remove(this)}setData(t,r){const n=zD(this.state.data,t,this.options);return ds(this,wi,Wo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){ds(this,wi,Wo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=Oe(this,zn))==null?void 0:n.promise;return(s=Oe(this,zn))==null||s.cancel(t),r?r.then(yi).catch(yi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Oe(this,du))}isActive(){return this.observers.some(t=>BD(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===eb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Oy(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!MD(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Oe(this,zn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Oe(this,zn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Oe(this,Va).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Oe(this,zn)&&(Oe(this,pu)?Oe(this,zn).cancel({revert:!0}):Oe(this,zn).cancelRetry()),this.scheduleGc()),Oe(this,Va).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ds(this,wi,Wo).call(this,{type:"invalidate"})}async fetch(t,r){var c,f,u,p,d,h,m,g,y,v,b,w;if(this.state.fetchStatus!=="idle"&&((c=Oe(this,zn))==null?void 0:c.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Oe(this,zn))return Oe(this,zn).continueRetry(),Oe(this,zn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(A=>A.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,s=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(Ot(this,pu,!0),n.signal)})},a=()=>{const S=Tj(this.options,r),F=(()=>{const T={client:Oe(this,hu),queryKey:this.queryKey,meta:this.meta};return s(T),T})();return Ot(this,pu,!1),this.options.persister?this.options.persister(S,F,this):S(F)},o=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Oe(this,hu),state:this.state,fetchFn:a};return s(S),S})();(f=this.options.behavior)==null||f.onFetch(o,this),Ot(this,od,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((u=o.fetchOptions)==null?void 0:u.meta))&&ds(this,wi,Wo).call(this,{type:"fetch",meta:(p=o.fetchOptions)==null?void 0:p.meta}),Ot(this,zn,Fj({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:S=>{S instanceof Iy&&S.revert&&this.setState({...Oe(this,od),fetchStatus:"idle"}),n.abort()},onFail:(S,A)=>{ds(this,wi,Wo).call(this,{type:"failed",failureCount:S,error:A})},onPause:()=>{ds(this,wi,Wo).call(this,{type:"pause"})},onContinue:()=>{ds(this,wi,Wo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await Oe(this,zn).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(h=(d=Oe(this,Va).config).onSuccess)==null||h.call(d,S,this),(g=(m=Oe(this,Va).config).onSettled)==null||g.call(m,S,this.state.error,this),S}catch(S){if(S instanceof Iy){if(S.silent)return Oe(this,zn).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw ds(this,wi,Wo).call(this,{type:"error",error:S}),(v=(y=Oe(this,Va).config).onError)==null||v.call(y,S,this),(w=(b=Oe(this,Va).config).onSettled)==null||w.call(b,this.state.data,S,this),S}finally{this.scheduleGc()}}},du=new WeakMap,od=new WeakMap,Va=new WeakMap,hu=new WeakMap,zn=new WeakMap,sp=new WeakMap,pu=new WeakMap,wi=new WeakSet,Wo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...QD(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...lN(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ot(this,od,t.manual?s:void 0),s;case"error":const a=t.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Bs.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Oe(this,Va).notify({query:this,type:"updated",action:t})})},t6);function QD(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Pj(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function lN(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function cN(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function uN(e){return{onFetch:(t,r)=>{var u,p,d,h,m;const n=t.options,s=(d=(p=(u=t.fetchOptions)==null?void 0:u.meta)==null?void 0:p.fetchMore)==null?void 0:d.direction,a=((h=t.state.data)==null?void 0:h.pages)||[],i=((m=t.state.data)==null?void 0:m.pageParams)||[];let o={pages:[],pageParams:[]},c=0;const f=async()=>{let g=!1;const y=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},v=Tj(t.options,t.fetchOptions),b=async(w,S,A)=>{if(g)return Promise.reject();if(S==null&&w.pages.length)return Promise.resolve(w);const T=(()=>{const k={client:t.client,queryKey:t.queryKey,pageParam:S,direction:A?"backward":"forward",meta:t.options.meta};return y(k),k})(),O=await v(T),{maxPages:C}=t.options,R=A?HD:qD;return{pages:R(w.pages,O,C),pageParams:R(w.pageParams,S,C)}};if(s&&a.length){const w=s==="backward",S=w?ZD:fN,A={pages:a,pageParams:i},F=S(n,A);o=await b(A,F,w)}else{const w=e??a.length;do{const S=c===0?i[0]??n.initialPageParam:fN(n,o);if(c>0&&S==null)break;o=await b(o,S),c++}while(c<w)}return o};t.options.persister?t.fetchFn=()=>{var g,y;return(y=(g=t.options).persister)==null?void 0:y.call(g,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=f}}}function fN(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function ZD(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var ap,so,Rs,mu,ao,Ul,r6,eO=(r6=class extends Lj{constructor(t){super();er(this,ao);er(this,ap);er(this,so);er(this,Rs);er(this,mu);Ot(this,ap,t.client),this.mutationId=t.mutationId,Ot(this,Rs,t.mutationCache),Ot(this,so,[]),this.state=t.state||tO(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Oe(this,so).includes(t)||(Oe(this,so).push(t),this.clearGcTimeout(),Oe(this,Rs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ot(this,so,Oe(this,so).filter(r=>r!==t)),this.scheduleGc(),Oe(this,Rs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Oe(this,so).length||(this.state.status==="pending"?this.scheduleGc():Oe(this,Rs).remove(this))}continue(){var t;return((t=Oe(this,mu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,c,f,u,p,d,h,m,g,y,v,b,w,S,A,F,T,O,C;const r=()=>{ds(this,ao,Ul).call(this,{type:"continue"})},n={client:Oe(this,ap),meta:this.options.meta,mutationKey:this.options.mutationKey};Ot(this,mu,Fj({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(R,k)=>{ds(this,ao,Ul).call(this,{type:"failed",failureCount:R,error:k})},onPause:()=>{ds(this,ao,Ul).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Oe(this,Rs).canRun(this)}));const s=this.state.status==="pending",a=!Oe(this,mu).canStart();try{if(s)r();else{ds(this,ao,Ul).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=Oe(this,Rs).config).onMutate)==null?void 0:o.call(i,t,this,n));const k=await((f=(c=this.options).onMutate)==null?void 0:f.call(c,t,n));k!==this.state.context&&ds(this,ao,Ul).call(this,{type:"pending",context:k,variables:t,isPaused:a})}const R=await Oe(this,mu).start();return await((p=(u=Oe(this,Rs).config).onSuccess)==null?void 0:p.call(u,R,t,this.state.context,this,n)),await((h=(d=this.options).onSuccess)==null?void 0:h.call(d,R,t,this.state.context,n)),await((g=(m=Oe(this,Rs).config).onSettled)==null?void 0:g.call(m,R,null,this.state.variables,this.state.context,this,n)),await((v=(y=this.options).onSettled)==null?void 0:v.call(y,R,null,t,this.state.context,n)),ds(this,ao,Ul).call(this,{type:"success",data:R}),R}catch(R){try{throw await((w=(b=Oe(this,Rs).config).onError)==null?void 0:w.call(b,R,t,this.state.context,this,n)),await((A=(S=this.options).onError)==null?void 0:A.call(S,R,t,this.state.context,n)),await((T=(F=Oe(this,Rs).config).onSettled)==null?void 0:T.call(F,void 0,R,this.state.variables,this.state.context,this,n)),await((C=(O=this.options).onSettled)==null?void 0:C.call(O,void 0,R,t,this.state.context,n)),R}finally{ds(this,ao,Ul).call(this,{type:"error",error:R})}}finally{Oe(this,Rs).runNext(this)}}},ap=new WeakMap,so=new WeakMap,Rs=new WeakMap,mu=new WeakMap,ao=new WeakSet,Ul=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Bs.batch(()=>{Oe(this,so).forEach(n=>{n.onMutationUpdate(t)}),Oe(this,Rs).notify({mutation:this,type:"updated",action:t})})},r6);function tO(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Xo,bi,ip,n6,rO=(n6=class extends ux{constructor(t={}){super();er(this,Xo);er(this,bi);er(this,ip);this.config=t,Ot(this,Xo,new Set),Ot(this,bi,new Map),Ot(this,ip,0)}build(t,r,n){const s=new eO({client:t,mutationCache:this,mutationId:++nm(this,ip)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){Oe(this,Xo).add(t);const r=bm(t);if(typeof r=="string"){const n=Oe(this,bi).get(r);n?n.push(t):Oe(this,bi).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Oe(this,Xo).delete(t)){const r=bm(t);if(typeof r=="string"){const n=Oe(this,bi).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&Oe(this,bi).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=bm(t);if(typeof r=="string"){const n=Oe(this,bi).get(r),s=n==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=bm(t);if(typeof r=="string"){const s=(n=Oe(this,bi).get(r))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Bs.batch(()=>{Oe(this,Xo).forEach(t=>{this.notify({type:"removed",mutation:t})}),Oe(this,Xo).clear(),Oe(this,bi).clear()})}getAll(){return Array.from(Oe(this,Xo))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>aN(r,n))}findAll(t={}){return this.getAll().filter(r=>aN(t,r))}notify(t){Bs.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Bs.batch(()=>Promise.all(t.map(r=>r.continue().catch(yi))))}},Xo=new WeakMap,bi=new WeakMap,ip=new WeakMap,n6);function bm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var io,s6,nO=(s6=class extends ux{constructor(t={}){super();er(this,io);this.config=t,Ot(this,io,new Map)}build(t,r,n){const s=r.queryKey,a=r.queryHash??Z5(s,r);let i=this.get(a);return i||(i=new JD({client:t,queryKey:s,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){Oe(this,io).has(t.queryHash)||(Oe(this,io).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Oe(this,io).get(t.queryHash);r&&(t.destroy(),r===t&&Oe(this,io).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Bs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Oe(this,io).get(t)}getAll(){return[...Oe(this,io).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>sN(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>sN(t,n)):r}notify(t){Bs.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Bs.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Bs.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},io=new WeakMap,s6),Zr,Zl,ec,ld,cd,tc,ud,fd,a6,sO=(a6=class{constructor(e={}){er(this,Zr);er(this,Zl);er(this,ec);er(this,ld);er(this,cd);er(this,tc);er(this,ud);er(this,fd);Ot(this,Zr,e.queryCache||new nO),Ot(this,Zl,e.mutationCache||new rO),Ot(this,ec,e.defaultOptions||{}),Ot(this,ld,new Map),Ot(this,cd,new Map),Ot(this,tc,0)}mount(){nm(this,tc)._++,Oe(this,tc)===1&&(Ot(this,ud,Cj.subscribe(async e=>{e&&(await this.resumePausedMutations(),Oe(this,Zr).onFocus())})),Ot(this,fd,lg.subscribe(async e=>{e&&(await this.resumePausedMutations(),Oe(this,Zr).onOnline())})))}unmount(){var e,t;nm(this,tc)._--,Oe(this,tc)===0&&((e=Oe(this,ud))==null||e.call(this),Ot(this,ud,void 0),(t=Oe(this,fd))==null||t.call(this),Ot(this,fd,void 0))}isFetching(e){return Oe(this,Zr).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Oe(this,Zl).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Oe(this,Zr).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Oe(this,Zr).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(Oy(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return Oe(this,Zr).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=Oe(this,Zr).get(n.queryHash),a=s==null?void 0:s.state.data,i=RD(t,a);if(i!==void 0)return Oe(this,Zr).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return Bs.batch(()=>Oe(this,Zr).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Oe(this,Zr).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Oe(this,Zr);Bs.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Oe(this,Zr);return Bs.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Bs.batch(()=>Oe(this,Zr).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(yi).catch(yi)}invalidateQueries(e,t={}){return Bs.batch(()=>(Oe(this,Zr).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Bs.batch(()=>Oe(this,Zr).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(yi)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(yi)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Oe(this,Zr).build(this,t);return r.isStaleByTime(Oy(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(yi).catch(yi)}fetchInfiniteQuery(e){return e.behavior=uN(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(yi).catch(yi)}ensureInfiniteQueryData(e){return e.behavior=uN(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return lg.isOnline()?Oe(this,Zl).resumePausedMutations():Promise.resolve()}getQueryCache(){return Oe(this,Zr)}getMutationCache(){return Oe(this,Zl)}getDefaultOptions(){return Oe(this,ec)}setDefaultOptions(e){Ot(this,ec,e)}setQueryDefaults(e,t){Oe(this,ld).set(Ph(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Oe(this,ld).values()],r={};return t.forEach(n=>{Fh(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){Oe(this,cd).set(Ph(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Oe(this,cd).values()],r={};return t.forEach(n=>{Fh(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Oe(this,ec).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Z5(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===eb&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Oe(this,ec).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Oe(this,Zr).clear(),Oe(this,Zl).clear()}},Zr=new WeakMap,Zl=new WeakMap,ec=new WeakMap,ld=new WeakMap,cd=new WeakMap,tc=new WeakMap,ud=new WeakMap,fd=new WeakMap,a6),aO=me.createContext(void 0),iO=({client:e,children:t})=>(me.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),l.jsx(aO.Provider,{value:e,children:t}));function oO(){if(console&&console.warn){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];vu(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t)}}const dN={};function My(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];vu(t[0])&&dN[t[0]]||(vu(t[0])&&(dN[t[0]]=new Date),oO(...t))}const Dj=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},hN=(e,t,r)=>{e.loadNamespaces(t,Dj(e,r))},pN=(e,t,r,n)=>{vu(r)&&(r=[r]),r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,Dj(e,n))},lO=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=t.languages[0],s=t.options?t.options.fallbackLng:!1,a=t.languages[t.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,c)=>{const f=t.services.backendConnector.state[`${o}|${c}`];return f===-1||f===2};return r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e)?!1:!!(t.hasResourceBundle(n,e)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||i(n,e)&&(!s||i(a,e)))},cO=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!t.languages||!t.languages.length?(My("i18n.languages were undefined or empty",t.languages),!0):t.options.ignoreJSONStructure!==void 0?t.hasLoadedNamespace(e,{lng:r.lng,precheck:(s,a)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!a(s.isLanguageChangingTo,e))return!1}}):lO(e,t,r)},vu=e=>typeof e=="string",uO=e=>typeof e=="object"&&e!==null,fO=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,dO={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},hO=e=>dO[e],pO=e=>e.replace(fO,hO);let By={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:pO};const mO=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};By={...By,...e}},gO=()=>By;let Oj;const xO=e=>{Oj=e},vO=()=>Oj,yO={type:"3rdParty",init(e){mO(e.options.react),xO(e)}},wO=me.createContext();class bO{constructor(){bt(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}}const NO=(e,t)=>{const r=me.useRef();return me.useEffect(()=>{r.current=e},[e,t]),r.current},Rj=(e,t,r,n)=>e.getFixedT(t,r,n),SO=(e,t,r,n)=>me.useCallback(Rj(e,t,r,n),[e,t,r,n]),Mi=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:r}=t,{i18n:n,defaultNS:s}=me.useContext(wO)||{},a=r||n||vO();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new bO),!a){My("You will need to pass in an i18next instance by using initReactI18next");const S=(F,T)=>vu(T)?T:uO(T)&&vu(T.defaultValue)?T.defaultValue:Array.isArray(F)?F[F.length-1]:F,A=[S,{},!1];return A.t=S,A.i18n={},A.ready=!1,A}a.options.react&&a.options.react.wait!==void 0&&My("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const i={...gO(),...a.options.react,...t},{useSuspense:o,keyPrefix:c}=i;let f=s||a.options&&a.options.defaultNS;f=vu(f)?[f]:f||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(f);const u=(a.isInitialized||a.initializedStoreOnce)&&f.every(S=>cO(S,a,i)),p=SO(a,t.lng||null,i.nsMode==="fallback"?f:f[0],c),d=()=>p,h=()=>Rj(a,t.lng||null,i.nsMode==="fallback"?f:f[0],c),[m,g]=me.useState(d);let y=f.join();t.lng&&(y=`${t.lng}${y}`);const v=NO(y),b=me.useRef(!0);me.useEffect(()=>{const{bindI18n:S,bindI18nStore:A}=i;b.current=!0,!u&&!o&&(t.lng?pN(a,t.lng,f,()=>{b.current&&g(h)}):hN(a,f,()=>{b.current&&g(h)})),u&&v&&v!==y&&b.current&&g(h);const F=()=>{b.current&&g(h)};return S&&a&&a.on(S,F),A&&a&&a.store.on(A,F),()=>{b.current=!1,S&&a&&S.split(" ").forEach(T=>a.off(T,F)),A&&a&&A.split(" ").forEach(T=>a.store.off(T,F))}},[a,y]),me.useEffect(()=>{b.current&&u&&g(d)},[a,c,u]);const w=[m,a,u];if(w.t=m,w.i18n=a,w.ready=u,u||!u&&!o)return w;throw new Promise(S=>{t.lng?pN(a,t.lng,f,()=>S()):hN(a,f,()=>S())})},_O={},mN=e=>{let t;const r=new Set,n=(u,p)=>{const d=typeof u=="function"?u(t):u;if(!Object.is(d,t)){const h=t;t=p??(typeof d!="object"||d===null)?d:Object.assign({},t,d),r.forEach(m=>m(t,h))}},s=()=>t,c={setState:n,getState:s,getInitialState:()=>f,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(_O?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},f=t=e(n,s,c);return c},kO=e=>e?mN(e):mN;var Ij={exports:{}},Mj={},Bj={exports:{}},Uj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yd=me;function EO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var jO=typeof Object.is=="function"?Object.is:EO,AO=yd.useState,TO=yd.useEffect,CO=yd.useLayoutEffect,PO=yd.useDebugValue;function FO(e,t){var r=t(),n=AO({inst:{value:r,getSnapshot:t}}),s=n[0].inst,a=n[1];return CO(function(){s.value=r,s.getSnapshot=t,I2(s)&&a({inst:s})},[e,r,t]),TO(function(){return I2(s)&&a({inst:s}),e(function(){I2(s)&&a({inst:s})})},[e]),PO(r),r}function I2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!jO(e,r)}catch{return!0}}function LO(e,t){return t()}var DO=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?LO:FO;Uj.useSyncExternalStore=yd.useSyncExternalStore!==void 0?yd.useSyncExternalStore:DO;Bj.exports=Uj;var OO=Bj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dx=me,RO=OO;function IO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var MO=typeof Object.is=="function"?Object.is:IO,BO=RO.useSyncExternalStore,UO=dx.useRef,$O=dx.useEffect,zO=dx.useMemo,qO=dx.useDebugValue;Mj.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var a=UO(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=zO(function(){function c(h){if(!f){if(f=!0,u=h,h=n(h),s!==void 0&&i.hasValue){var m=i.value;if(s(m,h))return p=m}return p=h}if(m=p,MO(u,h))return m;var g=n(h);return s!==void 0&&s(m,g)?(u=h,m):(u=h,p=g)}var f=!1,u,p,d=r===void 0?null:r;return[function(){return c(t())},d===null?void 0:function(){return c(d())}]},[t,r,n,s]);var o=BO(e,a[0],a[1]);return $O(function(){i.hasValue=!0,i.value=o},[o]),qO(o),o};Ij.exports=Mj;var HO=Ij.exports;const WO=i6(HO),$j={},{useDebugValue:VO}=Wl,{useSyncExternalStoreWithSelector:KO}=WO;let gN=!1;const GO=e=>e;function YO(e,t=GO,r){($j?"production":void 0)!=="production"&&r&&!gN&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),gN=!0);const n=KO(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return VO(n),n}const xN=e=>{($j?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?kO(e):e,r=(n,s)=>YO(t,n,s);return Object.assign(r,t),r},zj=e=>e?xN(e):xN,XO={};function JO(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var a;const i=c=>c===null?null:JSON.parse(c,void 0),o=(a=r.getItem(s))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const Lh=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return Lh(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return Lh(n)(r)}}}},QO=(e,t)=>(r,n,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:y=>y,version:0,merge:(y,v)=>({...v,...y}),...t},i=!1;const o=new Set,c=new Set;let f;try{f=a.getStorage()}catch{}if(!f)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...y)},n,s);const u=Lh(a.serialize),p=()=>{const y=a.partialize({...n()});let v;const b=u({state:y,version:a.version}).then(w=>f.setItem(a.name,w)).catch(w=>{v=w});if(v)throw v;return b},d=s.setState;s.setState=(y,v)=>{d(y,v),p()};const h=e((...y)=>{r(...y),p()},n,s);let m;const g=()=>{var y;if(!f)return;i=!1,o.forEach(b=>b(n()));const v=((y=a.onRehydrateStorage)==null?void 0:y.call(a,n()))||void 0;return Lh(f.getItem.bind(f))(a.name).then(b=>{if(b)return a.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==a.version){if(a.migrate)return a.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var w;return m=a.merge(b,(w=n())!=null?w:h),r(m,!0),p()}).then(()=>{v==null||v(m,void 0),i=!0,c.forEach(b=>b(m))}).catch(b=>{v==null||v(void 0,b)})};return s.persist={setOptions:y=>{a={...a,...y},y.getStorage&&(f=y.getStorage())},clearStorage:()=>{f==null||f.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},g(),m||h},ZO=(e,t)=>(r,n,s)=>{let a={storage:JO(()=>localStorage),partialize:g=>g,version:0,merge:(g,y)=>({...y,...g}),...t},i=!1;const o=new Set,c=new Set;let f=a.storage;if(!f)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...g)},n,s);const u=()=>{const g=a.partialize({...n()});return f.setItem(a.name,{state:g,version:a.version})},p=s.setState;s.setState=(g,y)=>{p(g,y),u()};const d=e((...g)=>{r(...g),u()},n,s);s.getInitialState=()=>d;let h;const m=()=>{var g,y;if(!f)return;i=!1,o.forEach(b=>{var w;return b((w=n())!=null?w:d)});const v=((y=a.onRehydrateStorage)==null?void 0:y.call(a,(g=n())!=null?g:d))||void 0;return Lh(f.getItem.bind(f))(a.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==a.version){if(a.migrate)return[!0,a.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var w;const[S,A]=b;if(h=a.merge(A,(w=n())!=null?w:d),r(h,!0),S)return u()}).then(()=>{v==null||v(h,void 0),h=n(),i=!0,c.forEach(b=>b(h))}).catch(b=>{v==null||v(void 0,b)})};return s.persist={setOptions:g=>{a={...a,...g},g.storage&&(f=g.storage)},clearStorage:()=>{f==null||f.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(c.add(g),()=>{c.delete(g)})},a.skipHydration||m(),h||d},eR=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((XO?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),QO(e,t)):ZO(e,t),tR=eR;function qj(e,t){return function(){return e.apply(t,arguments)}}const{toString:rR}=Object.prototype,{getPrototypeOf:tb}=Object,{iterator:hx,toStringTag:Hj}=Symbol,px=(e=>t=>{const r=rR.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Bi=e=>(e=e.toLowerCase(),t=>px(t)===e),mx=e=>t=>typeof t===e,{isArray:Cd}=Array,wd=mx("undefined");function dp(e){return e!==null&&!wd(e)&&e.constructor!==null&&!wd(e.constructor)&&ca(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Wj=Bi("ArrayBuffer");function nR(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Wj(e.buffer),t}const sR=mx("string"),ca=mx("function"),Vj=mx("number"),hp=e=>e!==null&&typeof e=="object",aR=e=>e===!0||e===!1,m1=e=>{if(px(e)!=="object")return!1;const t=tb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Hj in e)&&!(hx in e)},iR=e=>{if(!hp(e)||dp(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},oR=Bi("Date"),lR=Bi("File"),cR=Bi("Blob"),uR=Bi("FileList"),fR=e=>hp(e)&&ca(e.pipe),dR=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ca(e.append)&&((t=px(e))==="formdata"||t==="object"&&ca(e.toString)&&e.toString()==="[object FormData]"))},hR=Bi("URLSearchParams"),[pR,mR,gR,xR]=["ReadableStream","Request","Response","Headers"].map(Bi),vR=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Cd(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(dp(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function Kj(e,t){if(dp(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const ou=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Gj=e=>!wd(e)&&e!==ou;function Uy(){const{caseless:e,skipUndefined:t}=Gj(this)&&this||{},r={},n=(s,a)=>{const i=e&&Kj(r,a)||a;m1(r[i])&&m1(s)?r[i]=Uy(r[i],s):m1(s)?r[i]=Uy({},s):Cd(s)?r[i]=s.slice():(!t||!wd(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&pp(arguments[s],n);return r}const yR=(e,t,r,{allOwnKeys:n}={})=>(pp(t,(s,a)=>{r&&ca(s)?e[a]=qj(s,r):e[a]=s},{allOwnKeys:n}),e),wR=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),bR=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},NR=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&tb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},SR=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},_R=e=>{if(!e)return null;if(Cd(e))return e;let t=e.length;if(!Vj(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},kR=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&tb(Uint8Array)),ER=(e,t)=>{const n=(e&&e[hx]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},jR=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},AR=Bi("HTMLFormElement"),TR=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),vN=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),CR=Bi("RegExp"),Yj=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};pp(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},PR=e=>{Yj(e,(t,r)=>{if(ca(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ca(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},FR=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return Cd(e)?n(e):n(String(e).split(t)),r},LR=()=>{},DR=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function OR(e){return!!(e&&ca(e.append)&&e[Hj]==="FormData"&&e[hx])}const RR=e=>{const t=new Array(10),r=(n,s)=>{if(hp(n)){if(t.indexOf(n)>=0)return;if(dp(n))return n;if(!("toJSON"in n)){t[s]=n;const a=Cd(n)?[]:{};return pp(n,(i,o)=>{const c=r(i,s+1);!wd(c)&&(a[o]=c)}),t[s]=void 0,a}}return n};return r(e,0)},IR=Bi("AsyncFunction"),MR=e=>e&&(hp(e)||ca(e))&&ca(e.then)&&ca(e.catch),Xj=((e,t)=>e?setImmediate:t?((r,n)=>(ou.addEventListener("message",({source:s,data:a})=>{s===ou&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),ou.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ca(ou.postMessage)),BR=typeof queueMicrotask<"u"?queueMicrotask.bind(ou):typeof process<"u"&&process.nextTick||Xj,UR=e=>e!=null&&ca(e[hx]),Ce={isArray:Cd,isArrayBuffer:Wj,isBuffer:dp,isFormData:dR,isArrayBufferView:nR,isString:sR,isNumber:Vj,isBoolean:aR,isObject:hp,isPlainObject:m1,isEmptyObject:iR,isReadableStream:pR,isRequest:mR,isResponse:gR,isHeaders:xR,isUndefined:wd,isDate:oR,isFile:lR,isBlob:cR,isRegExp:CR,isFunction:ca,isStream:fR,isURLSearchParams:hR,isTypedArray:kR,isFileList:uR,forEach:pp,merge:Uy,extend:yR,trim:vR,stripBOM:wR,inherits:bR,toFlatObject:NR,kindOf:px,kindOfTest:Bi,endsWith:SR,toArray:_R,forEachEntry:ER,matchAll:jR,isHTMLForm:AR,hasOwnProperty:vN,hasOwnProp:vN,reduceDescriptors:Yj,freezeMethods:PR,toObjectSet:FR,toCamelCase:TR,noop:LR,toFiniteNumber:DR,findKey:Kj,global:ou,isContextDefined:Gj,isSpecCompliantForm:OR,toJSONObject:RR,isAsyncFn:IR,isThenable:MR,setImmediate:Xj,asap:BR,isIterable:UR};function Vt(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Ce.inherits(Vt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ce.toJSONObject(this.config),code:this.code,status:this.status}}});const Jj=Vt.prototype,Qj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Qj[e]={value:e}});Object.defineProperties(Vt,Qj);Object.defineProperty(Jj,"isAxiosError",{value:!0});Vt.from=(e,t,r,n,s,a)=>{const i=Object.create(Jj);Ce.toFlatObject(e,i,function(u){return u!==Error.prototype},f=>f!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Vt.call(i,o,c,r,n,s),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const $R=null;function $y(e){return Ce.isPlainObject(e)||Ce.isArray(e)}function Zj(e){return Ce.endsWith(e,"[]")?e.slice(0,-2):e}function yN(e,t,r){return e?e.concat(t).map(function(s,a){return s=Zj(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function zR(e){return Ce.isArray(e)&&!e.some($y)}const qR=Ce.toFlatObject(Ce,{},null,function(t){return/^is[A-Z]/.test(t)});function gx(e,t,r){if(!Ce.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ce.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,y){return!Ce.isUndefined(y[g])});const n=r.metaTokens,s=r.visitor||u,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ce.isSpecCompliantForm(t);if(!Ce.isFunction(s))throw new TypeError("visitor must be a function");function f(m){if(m===null)return"";if(Ce.isDate(m))return m.toISOString();if(Ce.isBoolean(m))return m.toString();if(!c&&Ce.isBlob(m))throw new Vt("Blob is not supported. Use a Buffer instead.");return Ce.isArrayBuffer(m)||Ce.isTypedArray(m)?c&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,g,y){let v=m;if(m&&!y&&typeof m=="object"){if(Ce.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(Ce.isArray(m)&&zR(m)||(Ce.isFileList(m)||Ce.endsWith(g,"[]"))&&(v=Ce.toArray(m)))return g=Zj(g),v.forEach(function(w,S){!(Ce.isUndefined(w)||w===null)&&t.append(i===!0?yN([g],S,a):i===null?g:g+"[]",f(w))}),!1}return $y(m)?!0:(t.append(yN(y,g,a),f(m)),!1)}const p=[],d=Object.assign(qR,{defaultVisitor:u,convertValue:f,isVisitable:$y});function h(m,g){if(!Ce.isUndefined(m)){if(p.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));p.push(m),Ce.forEach(m,function(v,b){(!(Ce.isUndefined(v)||v===null)&&s.call(t,v,Ce.isString(b)?b.trim():b,g,d))===!0&&h(v,g?g.concat(b):[b])}),p.pop()}}if(!Ce.isObject(e))throw new TypeError("data must be an object");return h(e),t}function wN(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function rb(e,t){this._pairs=[],e&&gx(e,this,t)}const eA=rb.prototype;eA.append=function(t,r){this._pairs.push([t,r])};eA.toString=function(t){const r=t?function(n){return t.call(this,n,wN)}:wN;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function HR(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function tA(e,t,r){if(!t)return e;const n=r&&r.encode||HR;Ce.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=Ce.isURLSearchParams(t)?t.toString():new rb(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class bN{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ce.forEach(this.handlers,function(n){n!==null&&t(n)})}}const rA={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},WR=typeof URLSearchParams<"u"?URLSearchParams:rb,VR=typeof FormData<"u"?FormData:null,KR=typeof Blob<"u"?Blob:null,GR={isBrowser:!0,classes:{URLSearchParams:WR,FormData:VR,Blob:KR},protocols:["http","https","file","blob","url","data"]},nb=typeof window<"u"&&typeof document<"u",zy=typeof navigator=="object"&&navigator||void 0,YR=nb&&(!zy||["ReactNative","NativeScript","NS"].indexOf(zy.product)<0),XR=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",JR=nb&&window.location.href||"http://localhost",QR=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:nb,hasStandardBrowserEnv:YR,hasStandardBrowserWebWorkerEnv:XR,navigator:zy,origin:JR},Symbol.toStringTag,{value:"Module"})),Ns={...QR,...GR};function ZR(e,t){return gx(e,new Ns.classes.URLSearchParams,{visitor:function(r,n,s,a){return Ns.isNode&&Ce.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function eI(e){return Ce.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function tI(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function nA(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=a>=r.length;return i=!i&&Ce.isArray(s)?s.length:i,c?(Ce.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Ce.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Ce.isArray(s[i])&&(s[i]=tI(s[i])),!o)}if(Ce.isFormData(e)&&Ce.isFunction(e.entries)){const r={};return Ce.forEachEntry(e,(n,s)=>{t(eI(n),s,r,0)}),r}return null}function rI(e,t,r){if(Ce.isString(e))try{return(t||JSON.parse)(e),Ce.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const mp={transitional:rA,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Ce.isObject(t);if(a&&Ce.isHTMLForm(t)&&(t=new FormData(t)),Ce.isFormData(t))return s?JSON.stringify(nA(t)):t;if(Ce.isArrayBuffer(t)||Ce.isBuffer(t)||Ce.isStream(t)||Ce.isFile(t)||Ce.isBlob(t)||Ce.isReadableStream(t))return t;if(Ce.isArrayBufferView(t))return t.buffer;if(Ce.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return ZR(t,this.formSerializer).toString();if((o=Ce.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return gx(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),rI(t)):t}],transformResponse:[function(t){const r=this.transitional||mp.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Ce.isResponse(t)||Ce.isReadableStream(t))return t;if(t&&Ce.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?Vt.from(o,Vt.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ns.classes.FormData,Blob:Ns.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ce.forEach(["delete","get","head","post","put","patch"],e=>{mp.headers[e]={}});const nI=Ce.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),sI=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&nI[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},NN=Symbol("internals");function v0(e){return e&&String(e).trim().toLowerCase()}function g1(e){return e===!1||e==null?e:Ce.isArray(e)?e.map(g1):String(e)}function aI(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const iI=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function M2(e,t,r,n,s){if(Ce.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Ce.isString(t)){if(Ce.isString(n))return t.indexOf(n)!==-1;if(Ce.isRegExp(n))return n.test(t)}}function oI(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function lI(e,t){const r=Ce.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let ua=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,c,f){const u=v0(c);if(!u)throw new Error("header name must be a non-empty string");const p=Ce.findKey(s,u);(!p||s[p]===void 0||f===!0||f===void 0&&s[p]!==!1)&&(s[p||c]=g1(o))}const i=(o,c)=>Ce.forEach(o,(f,u)=>a(f,u,c));if(Ce.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Ce.isString(t)&&(t=t.trim())&&!iI(t))i(sI(t),r);else if(Ce.isObject(t)&&Ce.isIterable(t)){let o={},c,f;for(const u of t){if(!Ce.isArray(u))throw TypeError("Object iterator must return a key-value pair");o[f=u[0]]=(c=o[f])?Ce.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=v0(t),t){const n=Ce.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return aI(s);if(Ce.isFunction(r))return r.call(this,s,n);if(Ce.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=v0(t),t){const n=Ce.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||M2(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=v0(i),i){const o=Ce.findKey(n,i);o&&(!r||M2(n,n[o],o,r))&&(delete n[o],s=!0)}}return Ce.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||M2(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Ce.forEach(this,(s,a)=>{const i=Ce.findKey(n,a);if(i){r[i]=g1(s),delete r[a];return}const o=t?oI(a):String(a).trim();o!==a&&delete r[a],r[o]=g1(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ce.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Ce.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[NN]=this[NN]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=v0(i);n[o]||(lI(s,i),n[o]=!0)}return Ce.isArray(t)?t.forEach(a):a(t),this}};ua.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ce.reduceDescriptors(ua.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ce.freezeMethods(ua);function B2(e,t){const r=this||mp,n=t||r,s=ua.from(n.headers);let a=n.data;return Ce.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function sA(e){return!!(e&&e.__CANCEL__)}function Pd(e,t,r){Vt.call(this,e??"canceled",Vt.ERR_CANCELED,t,r),this.name="CanceledError"}Ce.inherits(Pd,Vt,{__CANCEL__:!0});function aA(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Vt("Request failed with status code "+r.status,[Vt.ERR_BAD_REQUEST,Vt.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function cI(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function uI(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const f=Date.now(),u=n[a];i||(i=f),r[s]=c,n[s]=f;let p=a,d=0;for(;p!==s;)d+=r[p++],p=p%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),f-i<t)return;const h=u&&f-u;return h?Math.round(d*1e3/h):void 0}}function fI(e,t){let r=0,n=1e3/t,s,a;const i=(f,u=Date.now())=>{r=u,s=null,a&&(clearTimeout(a),a=null),e(...f)};return[(...f)=>{const u=Date.now(),p=u-r;p>=n?i(f,u):(s=f,a||(a=setTimeout(()=>{a=null,i(s)},n-p)))},()=>s&&i(s)]}const cg=(e,t,r=3)=>{let n=0;const s=uI(50,250);return fI(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,c=i-n,f=s(c),u=i<=o;n=i;const p={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:f||void 0,estimated:f&&o&&u?(o-i)/f:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(p)},r)},SN=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},_N=e=>(...t)=>Ce.asap(()=>e(...t)),dI=Ns.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,Ns.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(Ns.origin),Ns.navigator&&/(msie|trident)/i.test(Ns.navigator.userAgent)):()=>!0,hI=Ns.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Ce.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Ce.isString(n)&&o.push(`path=${n}`),Ce.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),Ce.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function pI(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function mI(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function iA(e,t,r){let n=!pI(t);return e&&(n||r==!1)?mI(e,t):t}const kN=e=>e instanceof ua?{...e}:e;function Pu(e,t){t=t||{};const r={};function n(f,u,p,d){return Ce.isPlainObject(f)&&Ce.isPlainObject(u)?Ce.merge.call({caseless:d},f,u):Ce.isPlainObject(u)?Ce.merge({},u):Ce.isArray(u)?u.slice():u}function s(f,u,p,d){if(Ce.isUndefined(u)){if(!Ce.isUndefined(f))return n(void 0,f,p,d)}else return n(f,u,p,d)}function a(f,u){if(!Ce.isUndefined(u))return n(void 0,u)}function i(f,u){if(Ce.isUndefined(u)){if(!Ce.isUndefined(f))return n(void 0,f)}else return n(void 0,u)}function o(f,u,p){if(p in t)return n(f,u);if(p in e)return n(void 0,f)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(f,u,p)=>s(kN(f),kN(u),p,!0)};return Ce.forEach(Object.keys({...e,...t}),function(u){const p=c[u]||s,d=p(e[u],t[u],u);Ce.isUndefined(d)&&p!==o||(r[u]=d)}),r}const oA=e=>{const t=Pu({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=ua.from(i),t.url=tA(iA(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Ce.isFormData(r)){if(Ns.hasStandardBrowserEnv||Ns.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Ce.isFunction(r.getHeaders)){const c=r.getHeaders(),f=["content-type","content-length"];Object.entries(c).forEach(([u,p])=>{f.includes(u.toLowerCase())&&i.set(u,p)})}}if(Ns.hasStandardBrowserEnv&&(n&&Ce.isFunction(n)&&(n=n(t)),n||n!==!1&&dI(t.url))){const c=s&&a&&hI.read(a);c&&i.set(s,c)}return t},gI=typeof XMLHttpRequest<"u",xI=gI&&function(e){return new Promise(function(r,n){const s=oA(e);let a=s.data;const i=ua.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:f}=s,u,p,d,h,m;function g(){h&&h(),m&&m(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let y=new XMLHttpRequest;y.open(s.method.toUpperCase(),s.url,!0),y.timeout=s.timeout;function v(){if(!y)return;const w=ua.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:w,config:e,request:y};aA(function(T){r(T),g()},function(T){n(T),g()},A),y=null}"onloadend"in y?y.onloadend=v:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(v)},y.onabort=function(){y&&(n(new Vt("Request aborted",Vt.ECONNABORTED,e,y)),y=null)},y.onerror=function(S){const A=S&&S.message?S.message:"Network Error",F=new Vt(A,Vt.ERR_NETWORK,e,y);F.event=S||null,n(F),y=null},y.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const A=s.transitional||rA;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),n(new Vt(S,A.clarifyTimeoutError?Vt.ETIMEDOUT:Vt.ECONNABORTED,e,y)),y=null},a===void 0&&i.setContentType(null),"setRequestHeader"in y&&Ce.forEach(i.toJSON(),function(S,A){y.setRequestHeader(A,S)}),Ce.isUndefined(s.withCredentials)||(y.withCredentials=!!s.withCredentials),o&&o!=="json"&&(y.responseType=s.responseType),f&&([d,m]=cg(f,!0),y.addEventListener("progress",d)),c&&y.upload&&([p,h]=cg(c),y.upload.addEventListener("progress",p),y.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(u=w=>{y&&(n(!w||w.type?new Pd(null,e,y):w),y.abort(),y=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const b=cI(s.url);if(b&&Ns.protocols.indexOf(b)===-1){n(new Vt("Unsupported protocol "+b+":",Vt.ERR_BAD_REQUEST,e));return}y.send(a||null)})},vI=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(f){if(!s){s=!0,o();const u=f instanceof Error?f:this.reason;n.abort(u instanceof Vt?u:new Pd(u instanceof Error?u.message:u))}};let i=t&&setTimeout(()=>{i=null,a(new Vt(`timeout ${t} of ms exceeded`,Vt.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),e=null)};e.forEach(f=>f.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>Ce.asap(o),c}},yI=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},wI=async function*(e,t){for await(const r of bI(e))yield*yI(r,t)},bI=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},EN=(e,t,r,n)=>{const s=wI(e,t);let a=0,i,o=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:f,value:u}=await s.next();if(f){o(),c.close();return}let p=u.byteLength;if(r){let d=a+=p;r(d)}c.enqueue(new Uint8Array(u))}catch(f){throw o(f),f}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},jN=64*1024,{isFunction:Nm}=Ce,NI=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ce.global),{ReadableStream:AN,TextEncoder:TN}=Ce.global,CN=(e,...t)=>{try{return!!e(...t)}catch{return!1}},SI=e=>{e=Ce.merge.call({skipUndefined:!0},NI,e);const{fetch:t,Request:r,Response:n}=e,s=t?Nm(t):typeof fetch=="function",a=Nm(r),i=Nm(n);if(!s)return!1;const o=s&&Nm(AN),c=s&&(typeof TN=="function"?(m=>g=>m.encode(g))(new TN):async m=>new Uint8Array(await new r(m).arrayBuffer())),f=a&&o&&CN(()=>{let m=!1;const g=new r(Ns.origin,{body:new AN,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),u=i&&o&&CN(()=>Ce.isReadableStream(new n("").body)),p={stream:u&&(m=>m.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!p[m]&&(p[m]=(g,y)=>{let v=g&&g[m];if(v)return v.call(g);throw new Vt(`Response type '${m}' is not supported`,Vt.ERR_NOT_SUPPORT,y)})});const d=async m=>{if(m==null)return 0;if(Ce.isBlob(m))return m.size;if(Ce.isSpecCompliantForm(m))return(await new r(Ns.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(Ce.isArrayBufferView(m)||Ce.isArrayBuffer(m))return m.byteLength;if(Ce.isURLSearchParams(m)&&(m=m+""),Ce.isString(m))return(await c(m)).byteLength},h=async(m,g)=>{const y=Ce.toFiniteNumber(m.getContentLength());return y??d(g)};return async m=>{let{url:g,method:y,data:v,signal:b,cancelToken:w,timeout:S,onDownloadProgress:A,onUploadProgress:F,responseType:T,headers:O,withCredentials:C="same-origin",fetchOptions:R}=oA(m),k=t||fetch;T=T?(T+"").toLowerCase():"text";let P=vI([b,w&&w.toAbortSignal()],S),q=null;const D=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let V;try{if(F&&f&&y!=="get"&&y!=="head"&&(V=await h(O,v))!==0){let ye=new r(g,{method:"POST",body:v,duplex:"half"}),E;if(Ce.isFormData(v)&&(E=ye.headers.get("content-type"))&&O.setContentType(E),ye.body){const[M,I]=SN(V,cg(_N(F)));v=EN(ye.body,jN,M,I)}}Ce.isString(C)||(C=C?"include":"omit");const se=a&&"credentials"in r.prototype,ne={...R,signal:P,method:y.toUpperCase(),headers:O.normalize().toJSON(),body:v,duplex:"half",credentials:se?C:void 0};q=a&&new r(g,ne);let X=await(a?k(q,R):k(g,ne));const G=u&&(T==="stream"||T==="response");if(u&&(A||G&&D)){const ye={};["status","statusText","headers"].forEach(z=>{ye[z]=X[z]});const E=Ce.toFiniteNumber(X.headers.get("content-length")),[M,I]=A&&SN(E,cg(_N(A),!0))||[];X=new n(EN(X.body,jN,M,()=>{I&&I(),D&&D()}),ye)}T=T||"text";let ve=await p[Ce.findKey(p,T)||"text"](X,m);return!G&&D&&D(),await new Promise((ye,E)=>{aA(ye,E,{data:ve,headers:ua.from(X.headers),status:X.status,statusText:X.statusText,config:m,request:q})})}catch(se){throw D&&D(),se&&se.name==="TypeError"&&/Load failed|fetch/i.test(se.message)?Object.assign(new Vt("Network Error",Vt.ERR_NETWORK,m,q),{cause:se.cause||se}):Vt.from(se,se&&se.code,m,q)}}},_I=new Map,lA=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,c,f,u=_I;for(;o--;)c=a[o],f=u.get(c),f===void 0&&u.set(c,f=o?new Map:SI(t)),u=f;return f};lA();const sb={http:$R,xhr:xI,fetch:{get:lA}};Ce.forEach(sb,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const PN=e=>`- ${e}`,kI=e=>Ce.isFunction(e)||e===null||e===!1;function EI(e,t){e=Ce.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!kI(n)&&(s=sb[(o=String(n)).toLowerCase()],s===void 0))throw new Vt(`Unknown adapter '${o}'`);if(s&&(Ce.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(PN).join(`
`):" "+PN(i[0]):"as no adapter specified";throw new Vt("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const cA={getAdapter:EI,adapters:sb};function U2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Pd(null,e)}function FN(e){return U2(e),e.headers=ua.from(e.headers),e.data=B2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),cA.getAdapter(e.adapter||mp.adapter,e)(e).then(function(n){return U2(e),n.data=B2.call(e,e.transformResponse,n),n.headers=ua.from(n.headers),n},function(n){return sA(n)||(U2(e),n&&n.response&&(n.response.data=B2.call(e,e.transformResponse,n.response),n.response.headers=ua.from(n.response.headers))),Promise.reject(n)})}const uA="1.13.2",xx={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{xx[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const LN={};xx.transitional=function(t,r,n){function s(a,i){return"[Axios v"+uA+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new Vt(s(i," has been removed"+(r?" in "+r:"")),Vt.ERR_DEPRECATED);return r&&!LN[i]&&(LN[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};xx.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function jI(e,t,r){if(typeof e!="object")throw new Vt("options must be an object",Vt.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],c=o===void 0||i(o,a,e);if(c!==!0)throw new Vt("option "+a+" must be "+c,Vt.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Vt("Unknown option "+a,Vt.ERR_BAD_OPTION)}}const x1={assertOptions:jI,validators:xx},Xi=x1.validators;let yu=class{constructor(t){this.defaults=t||{},this.interceptors={request:new bN,response:new bN}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Pu(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&x1.assertOptions(n,{silentJSONParsing:Xi.transitional(Xi.boolean),forcedJSONParsing:Xi.transitional(Xi.boolean),clarifyTimeoutError:Xi.transitional(Xi.boolean)},!1),s!=null&&(Ce.isFunction(s)?r.paramsSerializer={serialize:s}:x1.assertOptions(s,{encode:Xi.function,serialize:Xi.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),x1.assertOptions(r,{baseUrl:Xi.spelling("baseURL"),withXsrfToken:Xi.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Ce.merge(a.common,a[r.method]);a&&Ce.forEach(["delete","get","head","post","put","patch","common"],m=>{delete a[m]}),r.headers=ua.concat(i,a);const o=[];let c=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(c=c&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const f=[];this.interceptors.response.forEach(function(g){f.push(g.fulfilled,g.rejected)});let u,p=0,d;if(!c){const m=[FN.bind(this),void 0];for(m.unshift(...o),m.push(...f),d=m.length,u=Promise.resolve(r);p<d;)u=u.then(m[p++],m[p++]);return u}d=o.length;let h=r;for(;p<d;){const m=o[p++],g=o[p++];try{h=m(h)}catch(y){g.call(this,y);break}}try{u=FN.call(this,h)}catch(m){return Promise.reject(m)}for(p=0,d=f.length;p<d;)u=u.then(f[p++],f[p++]);return u}getUri(t){t=Pu(this.defaults,t);const r=iA(t.baseURL,t.url,t.allowAbsoluteUrls);return tA(r,t.params,t.paramsSerializer)}};Ce.forEach(["delete","get","head","options"],function(t){yu.prototype[t]=function(r,n){return this.request(Pu(n||{},{method:t,url:r,data:(n||{}).data}))}});Ce.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(Pu(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}yu.prototype[t]=r(),yu.prototype[t+"Form"]=r(!0)});let AI=class fA{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new Pd(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new fA(function(s){t=s}),cancel:t}}};function TI(e){return function(r){return e.apply(null,r)}}function CI(e){return Ce.isObject(e)&&e.isAxiosError===!0}const qy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(qy).forEach(([e,t])=>{qy[t]=e});function dA(e){const t=new yu(e),r=qj(yu.prototype.request,t);return Ce.extend(r,yu.prototype,t,{allOwnKeys:!0}),Ce.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return dA(Pu(e,s))},r}const gn=dA(mp);gn.Axios=yu;gn.CanceledError=Pd;gn.CancelToken=AI;gn.isCancel=sA;gn.VERSION=uA;gn.toFormData=gx;gn.AxiosError=Vt;gn.Cancel=gn.CanceledError;gn.all=function(t){return Promise.all(t)};gn.spread=TI;gn.isAxiosError=CI;gn.mergeConfig=Pu;gn.AxiosHeaders=ua;gn.formToJSON=e=>nA(Ce.isHTMLForm(e)?new FormData(e):e);gn.getAdapter=cA.getAdapter;gn.HttpStatusCode=qy;gn.default=gn;const{Axios:$te,AxiosError:zte,CanceledError:qte,isCancel:Hte,CancelToken:Wte,VERSION:Vte,all:Kte,Cancel:Gte,isAxiosError:Yte,spread:Xte,toFormData:Jte,AxiosHeaders:Qte,HttpStatusCode:Zte,formToJSON:ere,getAdapter:tre,mergeConfig:rre}=gn,PI=()=>"http://162.55.219.151/api";class FI{constructor(){bt(this,"client");const t=PI();this.client=gn.create({baseURL:t,headers:{"Content-Type":"application/json"}}),console.log("API Service initialized with baseURL:",t),this.client.interceptors.request.use(r=>{var s;console.log("API Request:",(s=r.method)==null?void 0:s.toUpperCase(),r.url,r.data);const n=localStorage.getItem("authToken");return n&&(r.headers.Authorization=`Bearer ${n}`),r},r=>Promise.reject(r)),this.client.interceptors.response.use(r=>(console.log("API Response:",r.status,r.config.url,r.data),r),async r=>{var n,s,a,i,o,c;return console.error("API Error:",(n=r.response)==null?void 0:n.status,(s=r.config)==null?void 0:s.url,(a=r.response)==null?void 0:a.data),((i=r.response)==null?void 0:i.status)===401&&!((c=(o=r.config)==null?void 0:o.url)!=null&&c.includes("/auth/login"))&&(localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp"),window.location.hash.includes("/login")||(window.location.hash="#/login")),Promise.reject(r)})}async register(t){return(await this.client.post("/auth/register",t)).data}async login(t,r){return(await this.client.post("/auth/login",{email:t,password:r})).data}async getCurrentUser(){return(await this.client.get("/auth/me")).data}async getProjects(t){return(await this.client.get("/projects",{params:{status:t}})).data}async getProject(t){return(await this.client.get(`/projects/${t}`)).data}async createProject(t){return(await this.client.post("/projects",t)).data}async updateProject(t,r){return(await this.client.put(`/projects/${t}`,r)).data}async deleteProject(t){return(await this.client.delete(`/projects/${t}`)).data}async getDeletedProjects(){return(await this.client.get("/projects/deleted/list")).data}async restoreProject(t){return(await this.client.post(`/projects/${t}/restore`)).data}async getBordereaux(t){return(await this.client.get(`/bordereau/project/${t}`)).data}async getPeriodes(t){return(await this.client.get(`/pv/project/${t}/periodes`)).data}async createBordereau(t){return(await this.client.post("/bordereau",t)).data}async updateBordereau(t,r){return(await this.client.put(`/bordereau/${t}`,r)).data}async deleteBordereau(t){return(await this.client.delete(`/bordereau/${t}`)).data}async getMetres(t){return(await this.client.get(`/metre/project/${t}`)).data}async createMetre(t){return(await this.client.post("/metre",t)).data}async updateMetre(t,r){return(await this.client.put(`/metre/${t}`,r)).data}async deleteMetre(t){return(await this.client.delete(`/metre/${t}`)).data}async getDecompts(t){return(await this.client.get(`/decompt/project/${t}`)).data}async createDecompt(t){return(await this.client.post("/decompt",t)).data}async updateDecompt(t,r){return(await this.client.put(`/decompt/${t}`,r)).data}async deleteDecompt(t){return(await this.client.delete(`/decompt/${t}`)).data}async uploadPhoto(t,r,n){const s=new FormData;return s.append("photo",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/photos",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getPhotos(t){return(await this.client.get(`/photos/project/${t}`)).data}async deletePhoto(t){return(await this.client.delete(`/photos/${t}`)).data}async getPVs(t){return(await this.client.get(`/pv/project/${t}`)).data}async createPV(t){return(await this.client.post("/pv",t)).data}async updatePV(t,r){return(await this.client.put(`/pv/${t}`,r)).data}async deletePV(t){return(await this.client.delete(`/pv/${t}`)).data}async uploadAttachment(t,r,n){const s=new FormData;return s.append("file",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/attachments",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getAttachments(t,r){return(await this.client.get(`/attachments/project/${t}`,{params:{category:r}})).data}async deleteAttachment(t){return(await this.client.delete(`/attachments/${t}`)).data}async syncPush(t,r){return(await this.client.post("/sync/push",{operations:t,deviceId:r})).data}async syncPull(t,r){return(await this.client.get("/sync/pull",{params:{lastSync:t,deviceId:r}})).data}async getLastSyncTime(){return(await this.client.get("/sync/last")).data}async resolveConflict(t,r,n){return(await this.client.post(`/sync/conflict/${t}`,{resolution:r,mergedData:n})).data}}const ra=new FI,Dr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,An=Object.keys,ks=Array.isArray;function Ws(e,t){return typeof t!="object"||An(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||Dr.Promise||(Dr.Promise=Promise);const Dh=Object.getPrototypeOf,LI={}.hasOwnProperty;function Pa(e,t){return LI.call(e,t)}function bd(e,t){typeof t=="function"&&(t=t(Dh(e))),(typeof Reflect>"u"?An:Reflect.ownKeys)(t).forEach(r=>{al(e,r,t[r])})}const hA=Object.defineProperty;function al(e,t,r,n){hA(e,t,Ws(r&&Pa(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Wf(e){return{from:function(t){return e.prototype=Object.create(t.prototype),al(e.prototype,"constructor",e),{extend:bd.bind(null,e.prototype)}}}}const DI=Object.getOwnPropertyDescriptor;function ab(e,t){let r;return DI(e,t)||(r=Dh(e))&&ab(r,t)}const OI=[].slice;function ug(e,t,r){return OI.call(e,t,r)}function pA(e,t){return t(e)}function C0(e){if(!e)throw new Error("Assertion Failed")}function mA(e){Dr.setImmediate?setImmediate(e):setTimeout(e,0)}function gA(e,t){return e.reduce((r,n,s)=>{var a=t(n,s);return a&&(r[a[0]]=a[1]),r},{})}function il(e,t){if(typeof t=="string"&&Pa(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,s=t.length;n<s;++n){var a=il(e,t[n]);r.push(a)}return r}var i=t.indexOf(".");if(i!==-1){var o=e[t.substr(0,i)];return o==null?void 0:il(o,t.substr(i+1))}}function Di(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){C0(typeof r!="string"&&"length"in r);for(var n=0,s=t.length;n<s;++n)Di(e,t[n],r[n])}else{var a=t.indexOf(".");if(a!==-1){var i=t.substr(0,a),o=t.substr(a+1);if(o==="")r===void 0?ks(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=r;else{var c=e[i];c&&Pa(e,i)||(c=e[i]={}),Di(c,o,r)}}else r===void 0?ks(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function xA(e){var t={};for(var r in e)Pa(e,r)&&(t[r]=e[r]);return t}const RI=[].concat;function vA(e){return RI.apply([],e)}const yA="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(vA([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>Dr[e]),II=yA.map(e=>Dr[e]);gA(yA,e=>[e,!0]);let Hl=null;function gp(e){Hl=typeof WeakMap<"u"&&new WeakMap;const t=Hy(e);return Hl=null,t}function Hy(e){if(!e||typeof e!="object")return e;let t=Hl&&Hl.get(e);if(t)return t;if(ks(e)){t=[],Hl&&Hl.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Hy(e[r]))}else if(II.indexOf(e.constructor)>=0)t=e;else{const a=Dh(e);for(var s in t=a===Object.prototype?{}:Object.create(a),Hl&&Hl.set(e,t),e)Pa(e,s)&&(t[s]=Hy(e[s]))}return t}const{toString:MI}={};function Wy(e){return MI.call(e).slice(8,-1)}const Vy=typeof Symbol<"u"?Symbol.iterator:"@@iterator",BI=typeof Vy=="symbol"?function(e){var t;return e!=null&&(t=e[Vy])&&t.apply(e)}:function(){return null},bf={};function Jo(e){var t,r,n,s;if(arguments.length===1){if(ks(e))return e.slice();if(this===bf&&typeof e=="string")return[e];if(s=BI(e)){for(r=[];!(n=s.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const ib=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var bo=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function wA(e,t){bo=e,bA=t}var bA=()=>!0;const UI=!new Error("").stack;function zu(){if(UI)try{throw zu.arguments,new Error}catch(e){return e}return new Error}function Ky(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(bA).map(n=>`
`+n).join("")):""}var NA=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ob=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(NA),$I={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Vf(e,t){this._e=zu(),this.name=e,this.message=t}function SA(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,s)=>s.indexOf(r)===n).join(`
`)}function fg(e,t,r,n){this._e=zu(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=SA(e,t)}function K0(e,t){this._e=zu(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=SA(e,t)}Wf(Vf).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Ky(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Wf(fg).from(Vf),Wf(K0).from(Vf);var lb=ob.reduce((e,t)=>(e[t]=t+"Error",e),{});const zI=Vf;var At=ob.reduce((e,t)=>{var r=t+"Error";function n(s,a){this._e=zu(),this.name=r,s?typeof s=="string"?(this.message=`${s}${a?`
 `+a:""}`,this.inner=a||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=$I[t]||r,this.inner=null)}return Wf(n).from(zI),e[t]=n,e},{});At.Syntax=SyntaxError,At.Type=TypeError,At.Range=RangeError;var DN=NA.reduce((e,t)=>(e[t+"Error"]=At[t],e),{}),v1=ob.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=At[t]),e),{});function _r(){}function Oh(e){return e}function qI(e,t){return e==null||e===Oh?t:function(r){return t(e(r))}}function Fu(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function HI(e,t){return e===_r?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Fu(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Fu(s,this.onerror):s),a!==void 0?a:r}}function WI(e,t){return e===_r?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Fu(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Fu(n,this.onerror):n)}}function VI(e,t){return e===_r?t:function(r){var n=e.apply(this,arguments);Ws(r,n);var s=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Fu(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Fu(a,this.onerror):a),n===void 0?i===void 0?void 0:i:Ws(n,i)}}function KI(e,t){return e===_r?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function cb(e,t){return e===_r?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,s=arguments.length,a=new Array(s);s--;)a[s]=arguments[s];return r.then(function(){return t.apply(n,a)})}return t.apply(this,arguments)}}v1.ModifyError=fg,v1.DexieError=Vf,v1.BulkError=K0;var Rh={};const _A=100,[Gy,dg,Yy]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Dh(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Dh(t),e]})(),kA=dg&&dg.then,y1=Gy&&Gy.constructor,ub=!!Yy;var Xy=!1,GI=Yy?()=>{Yy.then(Sm)}:Dr.setImmediate?setImmediate.bind(null,Sm):Dr.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Sm(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Sm,0)},G0=function(e,t){P0.push([e,t]),hg&&(GI(),hg=!1)},Jy=!0,hg=!0,wu=[],w1=[],Qy=null,Zy=Oh,Kf={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:IN,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{IN(e[0],e[1])}catch{}})}},Nt=Kf,P0=[],bu=0,b1=[];function at(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=_r,this._lib=!1;var t=this._PSD=Nt;if(bo&&(this._stackHolder=zu(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Rh)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&tw(this,this._value))}this._state=null,this._value=null,++t.ref,jA(this,e)}const ew={get:function(){var e=Nt,t=pg;function r(n,s){var a=!e.global&&(e!==Nt||t!==pg);const i=a&&!hl();var o=new at((c,f)=>{fb(this,new EA(mg(n,e,a,i),mg(s,e,a,i),c,f,e))});return bo&&CA(o,this),o}return r.prototype=Rh,r},set:function(e){al(this,"then",e&&e.prototype===Rh?ew:{get:function(){return e},set:ew.set})}};function EA(e,t,r,n,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=s}function jA(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&xp();r&&typeof r.then=="function"?jA(e,(s,a)=>{r instanceof at?r._then(s,a):r.then(s,a)}):(e._state=!0,e._value=r,AA(e)),n&&vp()}},tw.bind(null,e))}catch(r){tw(e,r)}}function tw(e,t){if(w1.push(t),e._state===null){var r=e._lib&&xp();t=Zy(t),e._state=!1,e._value=t,bo&&t!==null&&typeof t=="object"&&!t._promise&&function(n,s,a){try{n.apply(null,a)}catch{}}(()=>{var n=ab(t,"stack");t._promise=e,al(t,"stack",{get:()=>Xy?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){wu.some(s=>s._value===n._value)||wu.push(n)}(e),AA(e),r&&vp()}}function AA(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)fb(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),bu===0&&(++bu,G0(()=>{--bu==0&&db()},[]))}function fb(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++bu,G0(YI,[r,e,t])}else e._listeners.push(t)}function YI(e,t,r){try{Qy=t;var n,s=t._value;t._state?n=e(s):(w1.length&&(w1=[]),n=e(s),w1.indexOf(s)===-1&&function(a){for(var i=wu.length;i;)if(wu[--i]._value===a._value)return void wu.splice(i,1)}(t)),r.resolve(n)}catch(a){r.reject(a)}finally{Qy=null,--bu==0&&db(),--r.psd.ref||r.psd.finalize()}}function TA(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var s,a,i=e._value;i!=null?(s=i.name||"Error",a=i.message||i,n=Ky(i,0)):(s=i,a=""),t.push(s+(a?": "+a:"")+n)}return bo&&((n=Ky(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&TA(e._prev,t,r)),t}function CA(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Sm(){xp()&&vp()}function xp(){var e=Jy;return Jy=!1,hg=!1,e}function vp(){var e,t,r;do for(;P0.length>0;)for(e=P0,P0=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(P0.length>0);Jy=!0,hg=!0}function db(){var e=wu;wu=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=b1.slice(0),r=t.length;r;)t[--r]()}function _m(e){return new at(Rh,!1,e)}function Ur(e,t){var r=Nt;return function(){var n=xp(),s=Nt;try{return Nc(r,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{Nc(s,!1),n&&vp()}}}bd(at.prototype,{then:ew,_then:function(e,t){fb(this,new EA(null,null,e,t,Nt))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):_m(n)):this.then(null,n=>n&&n.name===t?r(n):_m(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),_m(t)))},stack:{get:function(){if(this._stack)return this._stack;try{Xy=!0;var e=TA(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{Xy=!1}}},timeout:function(e,t){return e<1/0?new at((r,n)=>{var s=setTimeout(()=>n(new At.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&al(at.prototype,Symbol.toStringTag,"Dexie.Promise"),Kf.env=PA(),bd(at,{all:function(){var e=Jo.apply(null,arguments).map(km);return new at(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((s,a)=>at.resolve(s).then(i=>{e[a]=i,--n||t(e)},r))})},resolve:e=>{if(e instanceof at)return e;if(e&&typeof e.then=="function")return new at((r,n)=>{e.then(r,n)});var t=new at(Rh,!0,e);return CA(t,Qy),t},reject:_m,race:function(){var e=Jo.apply(null,arguments).map(km);return new at((t,r)=>{e.map(n=>at.resolve(n).then(t,r))})},PSD:{get:()=>Nt,set:e=>Nt=e},totalEchoes:{get:()=>pg},newPSD:bc,usePSD:Ld,scheduler:{get:()=>G0,set:e=>{G0=e}},rejectionMapper:{get:()=>Zy,set:e=>{Zy=e}},follow:(e,t)=>new at((r,n)=>bc((s,a)=>{var i=Nt;i.unhandleds=[],i.onunhandled=a,i.finalize=Fu(function(){(function(o){function c(){o(),b1.splice(b1.indexOf(c),1)}b1.push(c),++bu,G0(()=>{--bu==0&&db()},[])})(()=>{this.unhandleds.length===0?s():a(this.unhandleds[0])})},i.finalize),e()},t,r,n))}),y1&&(y1.allSettled&&al(at,"allSettled",function(){const e=Jo.apply(null,arguments).map(km);return new at(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((s,a)=>at.resolve(s).then(i=>n[a]={status:"fulfilled",value:i},i=>n[a]={status:"rejected",reason:i}).then(()=>--r||t(n)))})}),y1.any&&typeof AggregateError<"u"&&al(at,"any",function(){const e=Jo.apply(null,arguments).map(km);return new at((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const s=new Array(n);e.forEach((a,i)=>at.resolve(a).then(o=>t(o),o=>{s[i]=o,--n||r(new AggregateError(s))}))})}));const Ss={awaits:0,echoes:0,id:0};var XI=0,N1=[],$2=0,pg=0,JI=0;function bc(e,t,r,n){var s=Nt,a=Object.create(s);a.parent=s,a.ref=0,a.global=!1,a.id=++JI;var i=Kf.env;a.env=ub?{Promise:at,PromiseProp:{value:at,configurable:!0,writable:!0},all:at.all,race:at.race,allSettled:at.allSettled,any:at.any,resolve:at.resolve,reject:at.reject,nthen:ON(i.nthen,a),gthen:ON(i.gthen,a)}:{},t&&Ws(a,t),++s.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Ld(a,e,r,n);return a.ref===0&&a.finalize(),o}function Fd(){return Ss.id||(Ss.id=++XI),++Ss.awaits,Ss.echoes+=_A,Ss.id}function hl(){return!!Ss.awaits&&(--Ss.awaits==0&&(Ss.id=0),Ss.echoes=Ss.awaits*_A,!0)}function km(e){return Ss.echoes&&e&&e.constructor===y1?(Fd(),e.then(t=>(hl(),t),t=>(hl(),Bn(t)))):e}function QI(e){++pg,Ss.echoes&&--Ss.echoes!=0||(Ss.echoes=Ss.id=0),N1.push(Nt),Nc(e,!0)}function ZI(){var e=N1[N1.length-1];N1.pop(),Nc(e,!1)}function Nc(e,t){var r=Nt;if((t?!Ss.echoes||$2++&&e===Nt:!$2||--$2&&e===Nt)||FA(t?QI.bind(null,e):ZI),e!==Nt&&(Nt=e,r===Kf&&(Kf.env=PA()),ub)){var n=Kf.env.Promise,s=e.env;dg.then=s.nthen,n.prototype.then=s.gthen,(r.global||e.global)&&(Object.defineProperty(Dr,"Promise",s.PromiseProp),n.all=s.all,n.race=s.race,n.resolve=s.resolve,n.reject=s.reject,s.allSettled&&(n.allSettled=s.allSettled),s.any&&(n.any=s.any))}}function PA(){var e=Dr.Promise;return ub?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Dr,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:dg.then,gthen:e.prototype.then}:{}}function Ld(e,t,r,n,s){var a=Nt;try{return Nc(e,!0),t(r,n,s)}finally{Nc(a,!1)}}function FA(e){kA.call(Gy,e)}function mg(e,t,r,n){return typeof e!="function"?e:function(){var s=Nt;r&&Fd(),Nc(t,!0);try{return e.apply(this,arguments)}finally{Nc(s,!1),n&&FA(hl)}}}function ON(e,t){return function(r,n){return e.call(this,mg(r,t),mg(n,t))}}(""+kA).indexOf("[native code]")===-1&&(Fd=hl=_r);const RN="unhandledrejection";function IN(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,s={promise:t,reason:e};if(Dr.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(RN,!0,!0),Ws(n,s)):Dr.CustomEvent&&Ws(n=new CustomEvent(RN,{detail:s}),s),n&&Dr.dispatchEvent&&(dispatchEvent(n),!Dr.PromiseRejectionEvent&&Dr.onunhandledrejection))try{Dr.onunhandledrejection(n)}catch{}bo&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Bn=at.reject;function rw(e,t,r,n){if(e.idbdb&&(e._state.openComplete||Nt.letThrough||e._vip)){var s=e._createTransaction(t,r,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===lb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>rw(e,t,r,n))):Bn(a)}return s._promise(t,(a,i)=>bc(()=>(Nt.trans=s,n(a,i,s)))).then(a=>s._completion.then(()=>a))}if(e._state.openComplete)return Bn(new At.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Bn(new At.DatabaseClosed);e.open().catch(_r)}return e._state.dbReadyPromise.then(()=>rw(e,t,r,n))}const MN="3.2.7",lu="",nw=-1/0,$o="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",LA="String expected.",Y0=[],vx=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),eM=vx,tM=vx,DA=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),yx="__dbnames",z2="readonly",q2="readwrite";function Lu(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const OA={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Em(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=gp(t))[e],t)}let rM=class{_trans(t,r,n){const s=this._tx||Nt.trans,a=this.name;function i(c,f,u){if(!u.schema[a])throw new At.NotFound("Table "+a+" not part of transaction");return r(u.idbtrans,u)}const o=xp();try{return s&&s.db===this.db?s===Nt.trans?s._promise(t,i,n):bc(()=>s._promise(t,i,n),{trans:s,transless:Nt.transless||Nt}):rw(this.db,t,[this.name],i)}finally{o&&vp()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(s=>this.hook.reading.fire(s))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(ks(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=An(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(f=>{if(f.compound&&r.every(u=>f.keyPath.indexOf(u)>=0)){for(let u=0;u<r.length;++u)if(r.indexOf(f.keyPath[u])===-1)return!1;return!0}return!1}).sort((f,u)=>f.keyPath.length-u.keyPath.length)[0];if(n&&this.db._maxKey!==lu){const f=n.keyPath.slice(0,r.length);return this.where(f).equals(f.map(u=>t[u]))}!n&&bo&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:s}=this.schema,a=this.db._deps.indexedDB;function i(f,u){try{return a.cmp(f,u)===0}catch{return!1}}const[o,c]=r.reduce(([f,u],p)=>{const d=s[p],h=t[p];return[f||d,f||!d?Lu(u,d&&d.multi?m=>{const g=il(m,p);return ks(g)&&g.some(y=>i(h,y))}:m=>i(h,il(m,p))):u]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(c):n?this.filter(c):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,ks(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const s=Object.create(t.prototype);for(var a in n)if(Pa(n,a))try{s[a]=n[a]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Ws(this,t)})}add(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Em(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:r!=null?[r]:null,values:[a]})).then(i=>i.numFailures?at.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Di(t,s,i)}catch{}return i})}update(t,r){if(typeof t!="object"||ks(t))return this.where(":id").equals(t).modify(r);{const n=il(t,this.schema.primKey.keyPath);if(n===void 0)return Bn(new At.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?An(r).forEach(s=>{Di(t,s,r[s])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Em(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[a],keys:r!=null?[r]:null})).then(i=>i.numFailures?at.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Di(t,s,i)}catch{}return i})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?at.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:OA})).then(t=>t.numFailures?at.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:c}=this.schema.primKey;if(c&&s)throw new At.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new At.InvalidArgument("Arguments objects and keys must have the same length");const f=t.length;let u=c&&o?t.map(Em(c)):t;return this.core.mutate({trans:i,type:"add",keys:s,values:u,wantResults:a}).then(({numFailures:p,results:d,lastResult:h,failures:m})=>{if(p===0)return a?d:h;throw new K0(`${this.name}.bulkAdd(): ${p} of ${f} operations failed`,m)})})}bulkPut(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:c}=this.schema.primKey;if(c&&s)throw new At.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new At.InvalidArgument("Arguments objects and keys must have the same length");const f=t.length;let u=c&&o?t.map(Em(c)):t;return this.core.mutate({trans:i,type:"put",keys:s,values:u,wantResults:a}).then(({numFailures:p,results:d,lastResult:h,failures:m})=>{if(p===0)return a?d:h;throw new K0(`${this.name}.bulkPut(): ${p} of ${f} operations failed`,m)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:s,failures:a})=>{if(n===0)return s;throw new K0(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,a)})}};function X0(e){var t={},r=function(i,o){if(o){for(var c=arguments.length,f=new Array(c-1);--c;)f[c-1]=arguments[c];return t[i].subscribe.apply(null,f),e}if(typeof i=="string")return t[i]};r.addEventType=a;for(var n=1,s=arguments.length;n<s;++n)a(arguments[n]);return r;function a(i,o,c){if(typeof i!="object"){var f;o||(o=KI),c||(c=_r);var u={subscribers:[],fire:c,subscribe:function(p){u.subscribers.indexOf(p)===-1&&(u.subscribers.push(p),u.fire=o(u.fire,p))},unsubscribe:function(p){u.subscribers=u.subscribers.filter(function(d){return d!==p}),u.fire=u.subscribers.reduce(o,c)}};return t[i]=r[i]=u,u}An(f=i).forEach(function(p){var d=f[p];if(ks(d))a(p,f[p][0],f[p][1]);else{if(d!=="asap")throw new At.InvalidArgument("Invalid event config");var h=a(p,Oh,function(){for(var m=arguments.length,g=new Array(m);m--;)g[m]=arguments[m];h.subscribers.forEach(function(y){mA(function(){y.apply(null,g)})})})}})}}function y0(e,t){return Wf(t).from({prototype:e}),t}function uf(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function H2(e,t){e.filter=Lu(e.filter,t)}function W2(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>Lu(n(),t()):t,e.justLimit=r&&!n}function S1(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new At.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function BN(e,t,r){const n=S1(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function jm(e,t,r,n){const s=e.replayFilter?Lu(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},i=(o,c,f)=>{if(!s||s(c,f,d=>c.stop(d),d=>c.fail(d))){var u=c.primaryKey,p=""+u;p==="[object ArrayBuffer]"&&(p=""+new Uint8Array(u)),Pa(a,p)||(a[p]=!0,t(o,c,f))}};return Promise.all([e.or._iterate(i,r),UN(BN(e,n,r),e.algorithm,i,!e.keysOnly&&e.valueMapper)])}return UN(BN(e,n,r),Lu(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function UN(e,t,r,n){var s=Ur(n?(a,i,o)=>r(n(a),i,o):r);return e.then(a=>{if(a)return a.start(()=>{var i=()=>a.continue();t&&!t(a,o=>i=o,o=>{a.stop(o),i=_r},o=>{a.fail(o),i=_r})||s(a.value,a,o=>i=o),i()})})}function $s(e,t){try{const r=$N(e),n=$N(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(s,a){const i=s.length,o=a.length,c=i<o?i:o;for(let f=0;f<c;++f)if(s[f]!==a[f])return s[f]<a[f]?-1:1;return i===o?0:i<o?-1:1}(zN(e),zN(t));case"Array":return function(s,a){const i=s.length,o=a.length,c=i<o?i:o;for(let f=0;f<c;++f){const u=$s(s[f],a[f]);if(u!==0)return u}return i===o?0:i<o?-1:1}(e,t)}}catch{}return NaN}function $N(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=Wy(e);return r==="ArrayBuffer"?"binary":r}function zN(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}let nM=class{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Bn.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Bn.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=Lu(r.algorithm,t)}_iterate(t,r){return jm(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Ws(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>jm(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,s=n.table.core;if(uf(n,!0))return s.count({trans:r,query:{index:S1(n,s.schema),range:n.range}}).then(i=>Math.min(i,n.limit));var a=0;return jm(n,()=>(++a,!1),r,s).then(()=>a)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),s=n[0],a=n.length-1;function i(f,u){return u?i(f[n[u]],u-1):f[s]}var o=this._ctx.dir==="next"?1:-1;function c(f,u){var p=i(f,a),d=i(u,a);return p<d?-o:p>d?o:0}return this.toArray(function(f){return f.sort(c)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&uf(n,!0)&&n.limit>0){const{valueMapper:s}=n,a=S1(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:a,range:n.range}}).then(({result:i})=>s?i.map(s):i)}{const s=[];return jm(n,a=>s.push(a),r,n.table.core).then(()=>s)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,uf(r)?W2(r,()=>{var n=t;return(s,a)=>n===0||(n===1?(--n,!1):(a(()=>{s.advance(n),n=0}),!1))}):W2(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),W2(this._ctx,()=>{var r=t;return function(n,s,a){return--r<=0&&s(a),r>=0}},!0),this}until(t,r){return H2(this._ctx,function(n,s,a){return!t(n.value)||(s(a),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return H2(this._ctx,function(s){return t(s.value)}),r=this._ctx,n=t,r.isMatch=Lu(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.primaryKey,s)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&uf(r,!0)&&r.limit>0)return this._read(s=>{var a=S1(r,r.table.core.schema);return r.table.core.query({trans:s,values:!1,limit:r.limit,query:{index:a,range:r.range}})}).then(({result:s})=>s).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return H2(this._ctx,function(s){var a=s.primaryKey.toString(),i=Pa(n,a);return n[a]=!0,!i}),this}modify(t){var r=this._ctx;return this._write(n=>{var s;if(typeof t=="function")s=t;else{var a=An(t),i=a.length;s=function(g){for(var y=!1,v=0;v<i;++v){var b=a[v],w=t[b];il(g,b)!==w&&(Di(g,b,w),y=!0)}return y}}const o=r.table.core,{outbound:c,extractKey:f}=o.schema.primaryKey,u=this.db._options.modifyChunkSize||200,p=[];let d=0;const h=[],m=(g,y)=>{const{failures:v,numFailures:b}=y;d+=g-b;for(let w of An(v))p.push(v[w])};return this.clone().primaryKeys().then(g=>{const y=v=>{const b=Math.min(u,g.length-v);return o.getMany({trans:n,keys:g.slice(v,v+b),cache:"immutable"}).then(w=>{const S=[],A=[],F=c?[]:null,T=[];for(let C=0;C<b;++C){const R=w[C],k={value:gp(R),primKey:g[v+C]};s.call(k,k.value,k)!==!1&&(k.value==null?T.push(g[v+C]):c||$s(f(R),f(k.value))===0?(A.push(k.value),c&&F.push(g[v+C])):(T.push(g[v+C]),S.push(k.value)))}const O=uf(r)&&r.limit===1/0&&(typeof t!="function"||t===V2)&&{index:r.index,range:r.range};return Promise.resolve(S.length>0&&o.mutate({trans:n,type:"add",values:S}).then(C=>{for(let R in C.failures)T.splice(parseInt(R),1);m(S.length,C)})).then(()=>(A.length>0||O&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:F,values:A,criteria:O,changeSpec:typeof t!="function"&&t}).then(C=>m(A.length,C))).then(()=>(T.length>0||O&&t===V2)&&o.mutate({trans:n,type:"delete",keys:T,criteria:O}).then(C=>m(T.length,C))).then(()=>g.length>v+b&&y(v+u))})};return y(0).then(()=>{if(p.length>0)throw new fg("Error modifying one or more objects",p,d,h);return g.length})})})}delete(){var t=this._ctx,r=t.range;return uf(t)&&(t.isPrimKey&&!tM||r.type===3)?this._write(n=>{const{primaryKey:s}=t.table.core.schema,a=r;return t.table.core.count({trans:n,query:{index:s,range:a}}).then(i=>t.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(({failures:o,lastResult:c,results:f,numFailures:u})=>{if(u)throw new fg("Could not delete some values",Object.keys(o).map(p=>o[p]),i-u);return i-u}))}):this.modify(V2)}};const V2=(e,t)=>t.value=null;function sM(e,t){return e<t?-1:e===t?0:1}function aM(e,t){return e>t?-1:e===t?0:1}function Na(e,t,r){var n=e instanceof IA?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function ff(e){return new e.Collection(e,()=>RA("")).limit(0)}function iM(e,t,r,n,s,a){for(var i=Math.min(e.length,n.length),o=-1,c=0;c<i;++c){var f=t[c];if(f!==n[c])return s(e[c],r[c])<0?e.substr(0,c)+r[c]+r.substr(c+1):s(e[c],n[c])<0?e.substr(0,c)+n[c]+r.substr(c+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;s(e[c],f)<0&&(o=c)}return i<n.length&&a==="next"?e+r.substr(e.length):i<e.length&&a==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function Am(e,t,r,n){var s,a,i,o,c,f,u,p=r.length;if(!r.every(g=>typeof g=="string"))return Na(e,LA);function d(g){s=function(v){return v==="next"?b=>b.toUpperCase():b=>b.toLowerCase()}(g),a=function(v){return v==="next"?b=>b.toLowerCase():b=>b.toUpperCase()}(g),i=g==="next"?sM:aM;var y=r.map(function(v){return{lower:a(v),upper:s(v)}}).sort(function(v,b){return i(v.lower,b.lower)});o=y.map(function(v){return v.upper}),c=y.map(function(v){return v.lower}),f=g,u=g==="next"?"":n}d("next");var h=new e.Collection(e,()=>$l(o[0],c[p-1]+n));h._ondirectionchange=function(g){d(g)};var m=0;return h._addAlgorithm(function(g,y,v){var b=g.key;if(typeof b!="string")return!1;var w=a(b);if(t(w,c,m))return!0;for(var S=null,A=m;A<p;++A){var F=iM(b,w,o[A],c[A],i,f);F===null&&S===null?m=A+1:(S===null||i(S,F)>0)&&(S=F)}return y(S!==null?function(){g.continue(S+u)}:v),!1}),h}function $l(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function RA(e){return{type:1,lower:e,upper:e}}class IA{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,s){n=n!==!1,s=s===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||s)&&(!n||!s)?ff(this):new this.Collection(this,()=>$l(t,r,!n,!s))}catch{return Na(this,$o)}}equals(t){return t==null?Na(this,$o):new this.Collection(this,()=>RA(t))}above(t){return t==null?Na(this,$o):new this.Collection(this,()=>$l(t,void 0,!0))}aboveOrEqual(t){return t==null?Na(this,$o):new this.Collection(this,()=>$l(t,void 0,!1))}below(t){return t==null?Na(this,$o):new this.Collection(this,()=>$l(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Na(this,$o):new this.Collection(this,()=>$l(void 0,t))}startsWith(t){return typeof t!="string"?Na(this,LA):this.between(t,t+lu,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Am(this,(r,n)=>r.indexOf(n[0])===0,[t],lu)}equalsIgnoreCase(t){return Am(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=Jo.apply(bf,arguments);return t.length===0?ff(this):Am(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Jo.apply(bf,arguments);return t.length===0?ff(this):Am(this,(r,n)=>n.some(s=>r.indexOf(s)===0),t,lu)}anyOf(){const t=Jo.apply(bf,arguments);let r=this._cmp;try{t.sort(r)}catch{return Na(this,$o)}if(t.length===0)return ff(this);const n=new this.Collection(this,()=>$l(t[0],t[t.length-1]));n._ondirectionchange=a=>{r=a==="next"?this._ascending:this._descending,t.sort(r)};let s=0;return n._addAlgorithm((a,i,o)=>{const c=a.key;for(;r(c,t[s])>0;)if(++s,s===t.length)return i(o),!1;return r(c,t[s])===0||(i(()=>{a.continue(t[s])}),!1)}),n}notEqual(t){return this.inAnyRange([[nw,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Jo.apply(bf,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Na(this,$o)}const r=t.reduce((n,s)=>n?n.concat([[n[n.length-1][1],s]]):[[nw,s]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,s=this._ascending,a=this._descending,i=this._min,o=this._max;if(t.length===0)return ff(this);if(!t.every(b=>b[0]!==void 0&&b[1]!==void 0&&s(b[0],b[1])<=0))return Na(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",At.InvalidArgument);const c=!r||r.includeLowers!==!1,f=r&&r.includeUppers===!0;let u,p=s;function d(b,w){return p(b[0],w[0])}try{u=t.reduce(function(b,w){let S=0,A=b.length;for(;S<A;++S){const F=b[S];if(n(w[0],F[1])<0&&n(w[1],F[0])>0){F[0]=i(F[0],w[0]),F[1]=o(F[1],w[1]);break}}return S===A&&b.push(w),b},[]),u.sort(d)}catch{return Na(this,$o)}let h=0;const m=f?b=>s(b,u[h][1])>0:b=>s(b,u[h][1])>=0,g=c?b=>a(b,u[h][0])>0:b=>a(b,u[h][0])>=0;let y=m;const v=new this.Collection(this,()=>$l(u[0][0],u[u.length-1][1],!c,!f));return v._ondirectionchange=b=>{b==="next"?(y=m,p=s):(y=g,p=a),u.sort(d)},v._addAlgorithm((b,w,S)=>{for(var A=b.key;y(A);)if(++h,h===u.length)return w(S),!1;return!!function(F){return!m(F)&&!g(F)}(A)||(this._cmp(A,u[h][1])===0||this._cmp(A,u[h][0])===0||w(()=>{p===s?b.continue(u[h][0]):b.continue(u[h][1])}),!1)}),v}startsWithAnyOf(){const t=Jo.apply(bf,arguments);return t.every(r=>typeof r=="string")?t.length===0?ff(this):this.inAnyRange(t.map(r=>[r,r+lu])):Na(this,"startsWithAnyOf() only works with strings")}}function ro(e){return Ur(function(t){return Ih(t),e(t.target.error),!1})}function Ih(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Mh="storagemutated",Gl="x-storagemutated-1",Sc=X0(null,Mh);class oM{_lock(){return C0(!Nt.global),++this._reculock,this._reculock!==1||Nt.global||(Nt.lockOwnerFor=this),this}_unlock(){if(C0(!Nt.global),--this._reculock==0)for(Nt.global||(Nt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Ld(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Nt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(C0(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new At.DatabaseClosed(n);case"MissingAPIError":throw new At.MissingAPI(n.message,n);default:throw new At.OpenFailed(n)}if(!this.active)throw new At.TransactionInactive;return C0(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Ur(s=>{Ih(s),this._reject(t.error)}),t.onabort=Ur(s=>{Ih(s),this.active&&this._reject(new At.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=Ur(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&Sc.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Bn(new At.ReadOnly("Transaction is readonly"));if(!this.active)return Bn(new At.TransactionInactive);if(this._locked())return new at((a,i)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(a,i)},Nt])});if(n)return bc(()=>{var a=new at((i,o)=>{this._lock();const c=r(i,o,this);c&&c.then&&c.then(i,o)});return a.finally(()=>this._unlock()),a._lib=!0,a});var s=new at((a,i)=>{var o=r(a,i,this);o&&o.then&&o.then(a,i)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=at.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var s=r.idbtrans.objectStore(r.storeNames[0]);(function i(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(s.get(-1/0).onsuccess=i)})()}var a=r._waitingFor;return new at((i,o)=>{n.then(c=>r._waitingQueue.push(Ur(i.bind(null,c))),c=>r._waitingQueue.push(Ur(o.bind(null,c)))).finally(()=>{r._waitingFor===a&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new At.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Pa(r,t))return r[t];const n=this.schema[t];if(!n)throw new At.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,n,this);return s.core=this.db.core.table(t),r[t]=s,s}}function sw(e,t,r,n,s,a,i){return{name:e,keyPath:t,unique:r,multi:n,auto:s,compound:a,src:(r&&!i?"&":"")+(n?"*":"")+(s?"++":"")+MA(t)}}function MA(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function BA(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:gA(r,n=>[n.name,n])}}let Bh=e=>{try{return e.only([[]]),Bh=()=>[[]],[[]]}catch{return Bh=()=>lu,lu}};function aw(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>il(n,t)}(e):t=>il(t,e)}function qN(e){return[].slice.call(e)}let lM=0;function J0(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function cM(e,t,r){function n(c){if(c.type===3)return null;if(c.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:f,upper:u,lowerOpen:p,upperOpen:d}=c;return f===void 0?u===void 0?null:t.upperBound(u,!!d):u===void 0?t.lowerBound(f,!!p):t.bound(f,u,!!p,!!d)}const{schema:s,hasGetAll:a}=function(c,f){const u=qN(c.objectStoreNames);return{schema:{name:c.name,tables:u.map(p=>f.objectStore(p)).map(p=>{const{keyPath:d,autoIncrement:h}=p,m=ks(d),g=d==null,y={},v={name:p.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:m,keyPath:d,autoIncrement:h,unique:!0,extractKey:aw(d)},indexes:qN(p.indexNames).map(b=>p.index(b)).map(b=>{const{name:w,unique:S,multiEntry:A,keyPath:F}=b,T={name:w,compound:ks(F),keyPath:F,unique:S,multiEntry:A,extractKey:aw(F)};return y[J0(F)]=T,T}),getIndexByKeyPath:b=>y[J0(b)]};return y[":id"]=v.primaryKey,d!=null&&(y[J0(d)]=v.primaryKey),v})},hasGetAll:u.length>0&&"getAll"in f.objectStore(u[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),i=s.tables.map(c=>function(f){const u=f.name;return{name:u,schema:f,mutate:function({trans:p,type:d,keys:h,values:m,range:g}){return new Promise((y,v)=>{y=Ur(y);const b=p.objectStore(u),w=b.keyPath==null,S=d==="put"||d==="add";if(!S&&d!=="delete"&&d!=="deleteRange")throw new Error("Invalid operation type: "+d);const{length:A}=h||m||{length:1};if(h&&m&&h.length!==m.length)throw new Error("Given keys array must have same length as given values array.");if(A===0)return y({numFailures:0,failures:{},results:[],lastResult:void 0});let F;const T=[],O=[];let C=0;const R=P=>{++C,Ih(P)};if(d==="deleteRange"){if(g.type===4)return y({numFailures:C,failures:O,results:[],lastResult:void 0});g.type===3?T.push(F=b.clear()):T.push(F=b.delete(n(g)))}else{const[P,q]=S?w?[m,h]:[m,null]:[h,null];if(S)for(let D=0;D<A;++D)T.push(F=q&&q[D]!==void 0?b[d](P[D],q[D]):b[d](P[D])),F.onerror=R;else for(let D=0;D<A;++D)T.push(F=b[d](P[D])),F.onerror=R}const k=P=>{const q=P.target.result;T.forEach((D,V)=>D.error!=null&&(O[V]=D.error)),y({numFailures:C,failures:O,results:d==="delete"?h:T.map(D=>D.result),lastResult:q})};F.onerror=P=>{R(P),k(P)},F.onsuccess=k})},getMany:({trans:p,keys:d})=>new Promise((h,m)=>{h=Ur(h);const g=p.objectStore(u),y=d.length,v=new Array(y);let b,w=0,S=0;const A=T=>{const O=T.target;v[O._pos]=O.result,++S===w&&h(v)},F=ro(m);for(let T=0;T<y;++T)d[T]!=null&&(b=g.get(d[T]),b._pos=T,b.onsuccess=A,b.onerror=F,++w);w===0&&h(v)}),get:({trans:p,key:d})=>new Promise((h,m)=>{h=Ur(h);const g=p.objectStore(u).get(d);g.onsuccess=y=>h(y.target.result),g.onerror=ro(m)}),query:function(p){return d=>new Promise((h,m)=>{h=Ur(h);const{trans:g,values:y,limit:v,query:b}=d,w=v===1/0?void 0:v,{index:S,range:A}=b,F=g.objectStore(u),T=S.isPrimaryKey?F:F.index(S.name),O=n(A);if(v===0)return h({result:[]});if(p){const C=y?T.getAll(O,w):T.getAllKeys(O,w);C.onsuccess=R=>h({result:R.target.result}),C.onerror=ro(m)}else{let C=0;const R=y||!("openKeyCursor"in T)?T.openCursor(O):T.openKeyCursor(O),k=[];R.onsuccess=P=>{const q=R.result;return q?(k.push(y?q.value:q.primaryKey),++C===v?h({result:k}):void q.continue()):h({result:k})},R.onerror=ro(m)}})}(a),openCursor:function({trans:p,values:d,query:h,reverse:m,unique:g}){return new Promise((y,v)=>{y=Ur(y);const{index:b,range:w}=h,S=p.objectStore(u),A=b.isPrimaryKey?S:S.index(b.name),F=m?g?"prevunique":"prev":g?"nextunique":"next",T=d||!("openKeyCursor"in A)?A.openCursor(n(w),F):A.openKeyCursor(n(w),F);T.onerror=ro(v),T.onsuccess=Ur(O=>{const C=T.result;if(!C)return void y(null);C.___id=++lM,C.done=!1;const R=C.continue.bind(C);let k=C.continuePrimaryKey;k&&(k=k.bind(C));const P=C.advance.bind(C),q=()=>{throw new Error("Cursor not stopped")};C.trans=p,C.stop=C.continue=C.continuePrimaryKey=C.advance=()=>{throw new Error("Cursor not started")},C.fail=Ur(v),C.next=function(){let D=1;return this.start(()=>D--?this.continue():this.stop()).then(()=>this)},C.start=D=>{const V=new Promise((ne,X)=>{ne=Ur(ne),T.onerror=ro(X),C.fail=X,C.stop=G=>{C.stop=C.continue=C.continuePrimaryKey=C.advance=q,ne(G)}}),se=()=>{if(T.result)try{D()}catch(ne){C.fail(ne)}else C.done=!0,C.start=()=>{throw new Error("Cursor behind last entry")},C.stop()};return T.onsuccess=Ur(ne=>{T.onsuccess=se,se()}),C.continue=R,C.continuePrimaryKey=k,C.advance=P,se(),V},y(C)},v)})},count({query:p,trans:d}){const{index:h,range:m}=p;return new Promise((g,y)=>{const v=d.objectStore(u),b=h.isPrimaryKey?v:v.index(h.name),w=n(m),S=w?b.count(w):b.count();S.onsuccess=Ur(A=>g(A.target.result)),S.onerror=ro(y)})}}}(c)),o={};return i.forEach(c=>o[c.name]=c),{stack:"dbcore",transaction:e.transaction.bind(e),table(c){if(!o[c])throw new Error(`Table '${c}' not found`);return o[c]},MIN_KEY:-1/0,MAX_KEY:Bh(t),schema:s}}function iw({_novip:e},t){const r=t.db,n=function(s,a,{IDBKeyRange:i,indexedDB:o},c){return{dbcore:function(u,p){return p.reduce((d,{create:h})=>({...d,...h(d)}),u)}(cM(a,i,c),s.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(s=>{const a=s.name;e.core.schema.tables.some(i=>i.name===a)&&(s.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=s.core))})}function gg({_novip:e},t,r,n){r.forEach(s=>{const a=n[s];t.forEach(i=>{const o=ab(i,s);(!o||"value"in o&&o.value===void 0)&&(i===e.Transaction.prototype||i instanceof e.Transaction?al(i,s,{get(){return this.table(s)},set(c){hA(this,s,{value:c,writable:!0,configurable:!0,enumerable:!0})}}):i[s]=new e.Table(s,a))})})}function ow({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function uM(e,t){return e._cfg.version-t._cfg.version}function fM(e,t,r,n){const s=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,s);a.create(r),a._completion.catch(n);const i=a._reject.bind(a),o=Nt.transless||Nt;bc(()=>{Nt.trans=a,Nt.transless=o,t===0?(An(s).forEach(c=>{K2(r,c,s[c].primKey,s[c].indexes)}),iw(e,r),at.follow(()=>e.on.populate.fire(a)).catch(i)):function({_novip:c},f,u,p){const d=[],h=c._versions;let m=c._dbSchema=cw(c,c.idbdb,p),g=!1;const y=h.filter(b=>b._cfg.version>=f);function v(){return d.length?at.resolve(d.shift()(u.idbtrans)).then(v):at.resolve()}return y.forEach(b=>{d.push(()=>{const w=m,S=b._cfg.dbschema;uw(c,w,p),uw(c,S,p),m=c._dbSchema=S;const A=UA(w,S);A.add.forEach(T=>{K2(p,T[0],T[1].primKey,T[1].indexes)}),A.change.forEach(T=>{if(T.recreate)throw new At.Upgrade("Not yet support for changing primary key");{const O=p.objectStore(T.name);T.add.forEach(C=>lw(O,C)),T.change.forEach(C=>{O.deleteIndex(C.name),lw(O,C)}),T.del.forEach(C=>O.deleteIndex(C))}});const F=b._cfg.contentUpgrade;if(F&&b._cfg.version>f){iw(c,p),u._memoizedTables={},g=!0;let T=xA(S);A.del.forEach(k=>{T[k]=w[k]}),ow(c,[c.Transaction.prototype]),gg(c,[c.Transaction.prototype],An(T),T),u.schema=T;const O=ib(F);let C;O&&Fd();const R=at.follow(()=>{if(C=F(u),C&&O){var k=hl.bind(null,null);C.then(k,k)}});return C&&typeof C.then=="function"?at.resolve(C):R.then(()=>C)}}),d.push(w=>{(!g||!eM)&&function(S,A){[].slice.call(A.db.objectStoreNames).forEach(F=>S[F]==null&&A.db.deleteObjectStore(F))}(b._cfg.dbschema,w),ow(c,[c.Transaction.prototype]),gg(c,[c.Transaction.prototype],c._storeNames,c._dbSchema),u.schema=c._dbSchema})}),v().then(()=>{var b,w;w=p,An(b=m).forEach(S=>{w.db.objectStoreNames.contains(S)||K2(w,S,b[S].primKey,b[S].indexes)})})}(e,t,a,r).catch(i)})}function UA(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const s=e[n],a=t[n];if(s){const i={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||s.primKey.auto!==a.primKey.auto&&!vx)i.recreate=!0,r.change.push(i);else{const o=s.idxByName,c=a.idxByName;let f;for(f in o)c[f]||i.del.push(f);for(f in c){const u=o[f],p=c[f];u?u.src!==p.src&&i.change.push(p):i.add.push(p)}(i.del.length>0||i.add.length>0||i.change.length>0)&&r.change.push(i)}}else r.add.push([n,a])}return r}function K2(e,t,r,n){const s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(a=>lw(s,a)),s}function lw(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function cw(e,t,r){const n={};return ug(t.objectStoreNames,0).forEach(s=>{const a=r.objectStore(s);let i=a.keyPath;const o=sw(MA(i),i||"",!1,!1,!!a.autoIncrement,i&&typeof i!="string",!0),c=[];for(let u=0;u<a.indexNames.length;++u){const p=a.index(a.indexNames[u]);i=p.keyPath;var f=sw(p.name,i,!!p.unique,!!p.multiEntry,!1,i&&typeof i!="string",!1);c.push(f)}n[s]=BA(s,o,c)}),n}function uw({_novip:e},t,r){const n=r.db.objectStoreNames;for(let s=0;s<n.length;++s){const a=n[s],i=r.objectStore(a);e._hasGetAll="getAll"in i;for(let o=0;o<i.indexNames.length;++o){const c=i.indexNames[o],f=i.index(c).keyPath,u=typeof f=="string"?f:"["+ug(f).join("+")+"]";if(t[a]){const p=t[a].idxByName[u];p&&(p.name=c,delete t[a].idxByName[u],t[a].idxByName[c]=p)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Dr.WorkerGlobalScope&&Dr instanceof Dr.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class dM{_parseStoresSpec(t,r){An(t).forEach(n=>{if(t[n]!==null){var s=t[n].split(",").map((i,o)=>{const c=(i=i.trim()).replace(/([&*]|\+\+)/g,""),f=/^\[/.test(c)?c.match(/^\[(.*)\]$/)[1].split("+"):c;return sw(c,f||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),ks(f),o===0)}),a=s.shift();if(a.multi)throw new At.Schema("Primary key cannot be multi-valued");s.forEach(i=>{if(i.auto)throw new At.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new At.Schema("Index must have a name and cannot be an empty string")}),r[n]=BA(n,a,s)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Ws(this._cfg.storesSource,t):t;const n=r._versions,s={};let a={};return n.forEach(i=>{Ws(s,i._cfg.storesSource),a=i._cfg.dbschema={},i._parseStoresSpec(s,a)}),r._dbSchema=a,ow(r,[r._allTables,r,r.Transaction.prototype]),gg(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],An(a),a),r._storeNames=An(a),this}upgrade(t){return this._cfg.contentUpgrade=cb(this._cfg.contentUpgrade||_r,t),this}}function hb(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new Nu(yx,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function pb(e){return e&&typeof e.databases=="function"}function fw(e){return bc(function(){return Nt.letThrough=!0,e()})}function hM(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function pM(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Bn(t.dbOpenError):e);bo&&(t.openCanceller._stackHolder=zu()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function s(){if(t.openCanceller!==n)throw new At.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,i=null,o=!1;const c=()=>new at((f,u)=>{if(s(),!r)throw new At.MissingAPI;const p=e.name,d=t.autoSchema?r.open(p):r.open(p,Math.round(10*e.verno));if(!d)throw new At.MissingAPI;d.onerror=ro(u),d.onblocked=Ur(e._fireOnBlocked),d.onupgradeneeded=Ur(h=>{if(i=d.transaction,t.autoSchema&&!e._options.allowEmptyDB){d.onerror=Ih,i.abort(),d.result.close();const g=r.deleteDatabase(p);g.onsuccess=g.onerror=Ur(()=>{u(new At.NoSuchDatabase(`Database ${p} doesnt exist`))})}else{i.onerror=ro(u);var m=h.oldVersion>Math.pow(2,62)?0:h.oldVersion;o=m<1,e._novip.idbdb=d.result,fM(e,m/10,i,u)}},u),d.onsuccess=Ur(()=>{i=null;const h=e._novip.idbdb=d.result,m=ug(h.objectStoreNames);if(m.length>0)try{const y=h.transaction((g=m).length===1?g[0]:g,"readonly");t.autoSchema?function({_novip:v},b,w){v.verno=b.version/10;const S=v._dbSchema=cw(0,b,w);v._storeNames=ug(b.objectStoreNames,0),gg(v,[v._allTables],An(S),S)}(e,h,y):(uw(e,e._dbSchema,y),function(v,b){const w=UA(cw(0,v.idbdb,b),v._dbSchema);return!(w.add.length||w.change.some(S=>S.add.length||S.change.length))}(e,y)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),iw(e,y)}catch{}var g;Y0.push(e),h.onversionchange=Ur(y=>{t.vcFired=!0,e.on("versionchange").fire(y)}),h.onclose=Ur(y=>{e.on("close").fire(y)}),o&&function({indexedDB:y,IDBKeyRange:v},b){!pb(y)&&b!==yx&&hb(y,v).put({name:b}).catch(_r)}(e._deps,p),f()},u)}).catch(f=>f&&f.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),c()):at.reject(f));return at.race([n,(typeof navigator>"u"?at.resolve():hM()).then(c)]).then(()=>(s(),t.onReadyBeingFired=[],at.resolve(fw(()=>e.on.ready.fire(e.vip))).then(function f(){if(t.onReadyBeingFired.length>0){let u=t.onReadyBeingFired.reduce(cb,_r);return t.onReadyBeingFired=[],at.resolve(fw(()=>u(e.vip))).then(f)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(f=>{t.dbOpenError=f;try{i&&i.abort()}catch{}return n===t.openCanceller&&e._close(),Bn(f)}).finally(()=>{t.openComplete=!0,a()})}function dw(e){var t=a=>e.next(a),r=s(t),n=s(a=>e.throw(a));function s(a){return i=>{var o=a(i),c=o.value;return o.done?c:c&&typeof c.then=="function"?c.then(r,n):ks(c)?Promise.all(c).then(r,n):r(c)}}return s(t)()}function mM(e,t,r){var n=arguments.length;if(n<2)throw new At.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return r=s.pop(),[e,vA(s),r]}function $A(e,t,r,n,s){return at.resolve().then(()=>{const a=Nt.transless||Nt,i=e._createTransaction(t,r,e._dbSchema,n),o={trans:i,transless:a};if(n)i.idbtrans=n.idbtrans;else try{i.create(),e._state.PR1398_maxLoop=3}catch(p){return p.name===lb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>$A(e,t,r,null,s))):Bn(p)}const c=ib(s);let f;c&&Fd();const u=at.follow(()=>{if(f=s.call(i,i),f)if(c){var p=hl.bind(null,null);f.then(p,p)}else typeof f.next=="function"&&typeof f.throw=="function"&&(f=dw(f))},o);return(f&&typeof f.then=="function"?at.resolve(f).then(p=>i.active?p:Bn(new At.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):u.then(()=>f)).then(p=>(n&&i._resolve(),i._completion.then(()=>p))).catch(p=>(i._reject(p),Bn(p)))})}function Tm(e,t,r){const n=ks(e)?e.slice():[e];for(let s=0;s<r;++s)n.push(t);return n}const gM={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,s={},a=[];function i(u,p,d){const h=J0(u),m=s[h]=s[h]||[],g=u==null?0:typeof u=="string"?1:u.length,y=p>0,v={...d,isVirtual:y,keyTail:p,keyLength:g,extractKey:aw(u),unique:!y&&d.unique};return m.push(v),v.isPrimaryKey||a.push(v),g>1&&i(g===2?u[0]:u.slice(0,g-1),p+1,d),m.sort((b,w)=>b.keyTail-w.keyTail),v}const o=i(n.primaryKey.keyPath,0,n.primaryKey);s[":id"]=[o];for(const u of n.indexes)i(u.keyPath,0,u);function c(u){const p=u.query.index;return p.isVirtual?{...u,query:{index:p,range:(d=u.query.range,h=p.keyTail,{type:d.type===1?2:d.type,lower:Tm(d.lower,d.lowerOpen?e.MAX_KEY:e.MIN_KEY,h),lowerOpen:!0,upper:Tm(d.upper,d.upperOpen?e.MIN_KEY:e.MAX_KEY,h),upperOpen:!0})}}:u;var d,h}return{...r,schema:{...n,primaryKey:o,indexes:a,getIndexByKeyPath:function(u){const p=s[J0(u)];return p&&p[0]}},count:u=>r.count(c(u)),query:u=>r.query(c(u)),openCursor(u){const{keyTail:p,isVirtual:d,keyLength:h}=u.query.index;return d?r.openCursor(c(u)).then(m=>m&&function(g){return Object.create(g,{continue:{value:function(v){v!=null?g.continue(Tm(v,u.reverse?e.MAX_KEY:e.MIN_KEY,p)):u.unique?g.continue(g.key.slice(0,h).concat(u.reverse?e.MIN_KEY:e.MAX_KEY,p)):g.continue()}},continuePrimaryKey:{value(v,b){g.continuePrimaryKey(Tm(v,e.MAX_KEY,p),b)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const v=g.key;return h===1?v[0]:v.slice(0,h)}},value:{get:()=>g.value}})}(m)):r.openCursor(u)}}}}}};function mb(e,t,r,n){return r=r||{},n=n||"",An(e).forEach(s=>{if(Pa(t,s)){var a=e[s],i=t[s];if(typeof a=="object"&&typeof i=="object"&&a&&i){const o=Wy(a);o!==Wy(i)?r[n+s]=t[s]:o==="Object"?mb(a,i,r,n+s+"."):a!==i&&(r[n+s]=t[s])}else a!==i&&(r[n+s]=t[s])}else r[n+s]=void 0}),An(t).forEach(s=>{Pa(e,s)||(r[n+s]=t[s])}),r}const xM={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(a){const i=Nt.trans,{deleting:o,creating:c,updating:f}=i.table(t).hook;switch(a.type){case"add":if(c.fire===_r)break;return i._promise("readwrite",()=>u(a),!0);case"put":if(c.fire===_r&&f.fire===_r)break;return i._promise("readwrite",()=>u(a),!0);case"delete":if(o.fire===_r)break;return i._promise("readwrite",()=>u(a),!0);case"deleteRange":if(o.fire===_r)break;return i._promise("readwrite",()=>function(d){return p(d.trans,d.range,1e4)}(a),!0)}return r.mutate(a);function u(d){const h=Nt.trans,m=d.keys||function(g,y){return y.type==="delete"?y.keys:y.keys||y.values.map(g.extractKey)}(n,d);if(!m)throw new Error("Keys missing");return(d=d.type==="add"||d.type==="put"?{...d,keys:m}:{...d}).type!=="delete"&&(d.values=[...d.values]),d.keys&&(d.keys=[...d.keys]),function(g,y,v){return y.type==="add"?Promise.resolve([]):g.getMany({trans:y.trans,keys:v,cache:"immutable"})}(r,d,m).then(g=>{const y=m.map((v,b)=>{const w=g[b],S={onerror:null,onsuccess:null};if(d.type==="delete")o.fire.call(S,v,w,h);else if(d.type==="add"||w===void 0){const A=c.fire.call(S,v,d.values[b],h);v==null&&A!=null&&(v=A,d.keys[b]=v,n.outbound||Di(d.values[b],n.keyPath,v))}else{const A=mb(w,d.values[b]),F=f.fire.call(S,A,v,w,h);if(F){const T=d.values[b];Object.keys(F).forEach(O=>{Pa(T,O)?T[O]=F[O]:Di(T,O,F[O])})}}return S});return r.mutate(d).then(({failures:v,results:b,numFailures:w,lastResult:S})=>{for(let A=0;A<m.length;++A){const F=b?b[A]:m[A],T=y[A];F==null?T.onerror&&T.onerror(v[A]):T.onsuccess&&T.onsuccess(d.type==="put"&&g[A]?d.values[A]:F)}return{failures:v,results:b,numFailures:w,lastResult:S}}).catch(v=>(y.forEach(b=>b.onerror&&b.onerror(v)),Promise.reject(v)))})}function p(d,h,m){return r.query({trans:d,values:!1,query:{index:n,range:h},limit:m}).then(({result:g})=>u({type:"delete",keys:g,trans:d}).then(y=>y.numFailures>0?Promise.reject(y.failures[0]):g.length<m?{failures:[],numFailures:0,lastResult:void 0}:p(d,{...h,lower:g[g.length-1],lowerOpen:!0},m)))}}}}})};function zA(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let s=0,a=0;s<t.keys.length&&a<e.length;++s)$s(t.keys[s],e[a])===0&&(n.push(r?gp(t.values[s]):t.values[s]),++a);return n.length===e.length?n:null}catch{return null}}const vM={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const s=zA(n.keys,n.trans._cache,n.cache==="clone");return s?at.resolve(s):r.getMany(n).then(a=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?gp(a):a},a))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function gb(e){return!("from"in e)}const Go=function(e,t){if(!this){const r=new Go;return e&&"d"in e&&Ws(r,e),r}Ws(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Uh(e,t,r){const n=$s(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(gb(e))return Ws(e,{from:t,to:r,d:1});const s=e.l,a=e.r;if($s(r,e.from)<0)return s?Uh(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},HN(e);if($s(t,e.to)>0)return a?Uh(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},HN(e);$s(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),$s(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const i=!e.r;s&&!e.l&&xg(e,s),a&&i&&xg(e,a)}function xg(e,t){gb(t)||function r(n,{from:s,to:a,l:i,r:o}){Uh(n,s,a),i&&r(n,i),o&&r(n,o)}(e,t)}function yM(e,t){const r=hw(t);let n=r.next();if(n.done)return!1;let s=n.value;const a=hw(e);let i=a.next(s.from),o=i.value;for(;!n.done&&!i.done;){if($s(o.from,s.to)<=0&&$s(o.to,s.from)>=0)return!0;$s(s.from,o.from)<0?s=(n=r.next(o.from)).value:o=(i=a.next(s.from)).value}return!1}function hw(e){let t=gb(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&$s(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||$s(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function HN(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=n>1?"r":n<-1?"l":"";if(s){const a=s==="r"?"l":"r",i={...e},o=e[s];e.from=o.from,e.to=o.to,e[s]=o[s],i[s]=o[a],e[a]=i,i.d=WN(i)}e.d=WN(e)}function WN({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}bd(Go.prototype,{add(e){return xg(this,e),this},addKey(e){return Uh(this,e,e),this},addKeys(e){return e.forEach(t=>Uh(this,t,t)),this},[Vy](){return hw(this)}});const wM={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new Go(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const s=e.table(n),{schema:a}=s,{primaryKey:i}=a,{extractKey:o,outbound:c}=i,f={...s,mutate:d=>{const h=d.trans,m=h.mutatedParts||(h.mutatedParts={}),g=F=>{const T=`idb://${t}/${n}/${F}`;return m[T]||(m[T]=new Go)},y=g(""),v=g(":dels"),{type:b}=d;let[w,S]=d.type==="deleteRange"?[d.range]:d.type==="delete"?[d.keys]:d.values.length<50?[[],d.values]:[];const A=d.trans._cache;return s.mutate(d).then(F=>{if(ks(w)){b!=="delete"&&(w=F.results),y.addKeys(w);const T=zA(w,A);T||b==="add"||v.addKeys(w),(T||S)&&function(O,C,R,k){function P(q){const D=O(q.name||"");function V(ne){return ne!=null?q.extractKey(ne):null}const se=ne=>q.multiEntry&&ks(ne)?ne.forEach(X=>D.addKey(X)):D.addKey(ne);(R||k).forEach((ne,X)=>{const G=R&&V(R[X]),ve=k&&V(k[X]);$s(G,ve)!==0&&(G!=null&&se(G),ve!=null&&se(ve))})}C.indexes.forEach(P)}(g,a,T,S)}else if(w){const T={from:w.lower,to:w.upper};v.add(T),y.add(T)}else y.add(r),v.add(r),a.indexes.forEach(T=>g(T.name).add(r));return F})}},u=({query:{index:d,range:h}})=>{var m,g;return[d,new Go((m=h.lower)!==null&&m!==void 0?m:e.MIN_KEY,(g=h.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},p={get:d=>[i,new Go(d.key)],getMany:d=>[i,new Go().addKeys(d.keys)],count:u,query:u,openCursor:u};return An(p).forEach(d=>{f[d]=function(h){const{subscr:m}=Nt;if(m){const g=S=>{const A=`idb://${t}/${n}/${S}`;return m[A]||(m[A]=new Go)},y=g(""),v=g(":dels"),[b,w]=p[d](h);if(g(b.name||"").add(w),!b.isPrimaryKey){if(d!=="count"){const S=d==="query"&&c&&h.values&&s.query({...h,values:!1});return s[d].apply(this,arguments).then(A=>{if(d==="query"){if(c&&h.values)return S.then(({result:T})=>(y.addKeys(T),A));const F=h.values?A.result.map(o):A.result;h.values?y.addKeys(F):v.addKeys(F)}else if(d==="openCursor"){const F=A,T=h.values;return F&&Object.create(F,{key:{get:()=>(v.addKey(F.primaryKey),F.key)},primaryKey:{get(){const O=F.primaryKey;return v.addKey(O),O}},value:{get:()=>(T&&y.addKey(F.primaryKey),F.value)}})}return A})}v.add(r)}}return s[d].apply(this,arguments)}}),f}}}};class Nu{constructor(t,r){this._middlewares={},this.verno=0;const n=Nu.dependencies;this._options=r={addons:Nu.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:s}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:_r,dbReadyPromise:null,cancelOpen:_r,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;a.dbReadyPromise=new at(o=>{a.dbReadyResolve=o}),a.openCanceller=new at((o,c)=>{a.cancelOpen=c}),this._state=a,this.name=t,this.on=X0(this,"populate","blocked","versionchange","close",{ready:[cb,_r]}),this.on.ready.subscribe=pA(this.on.ready.subscribe,o=>(c,f)=>{Nu.vip(()=>{const u=this._state;if(u.openComplete)u.dbOpenError||at.resolve().then(c),f&&o(c);else if(u.onReadyBeingFired)u.onReadyBeingFired.push(c),f&&o(c);else{o(c);const p=this;f||o(function d(){p.on.ready.unsubscribe(c),p.on.ready.unsubscribe(d)})}})}),this.Collection=(i=this,y0(nM.prototype,function(o,c){this.db=i;let f=OA,u=null;if(c)try{f=c()}catch(m){u=m}const p=o._ctx,d=p.table,h=d.hook.reading.fire;this._ctx={table:d,index:p.index,isPrimKey:!p.index||d.schema.primKey.keyPath&&p.index===d.schema.primKey.name,range:f,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:p.or,valueMapper:h!==Oh?h:null}})),this.Table=function(o){return y0(rM.prototype,function(c,f,u){this.db=o,this._tx=u,this.name=c,this.schema=f,this.hook=o._allTables[c]?o._allTables[c].hook:X0(null,{creating:[HI,_r],reading:[qI,Oh],updating:[VI,_r],deleting:[WI,_r]})})}(this),this.Transaction=function(o){return y0(oM.prototype,function(c,f,u,p,d){this.db=o,this.mode=c,this.storeNames=f,this.schema=u,this.chromeTransactionDurability=p,this.idbtrans=null,this.on=X0(this,"complete","error","abort"),this.parent=d||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new at((h,m)=>{this._resolve=h,this._reject=m}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},h=>{var m=this.active;return this.active=!1,this.on.error.fire(h),this.parent?this.parent._reject(h):m&&this.idbtrans&&this.idbtrans.abort(),Bn(h)})})}(this),this.Version=function(o){return y0(dM.prototype,function(c){this.db=o,this._cfg={version:c,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return y0(IA.prototype,function(c,f,u){this.db=o,this._ctx={table:c,index:f===":id"?null:f,or:u};const p=o._deps.indexedDB;if(!p)throw new At.MissingAPI;this._cmp=this._ascending=p.cmp.bind(p),this._descending=(d,h)=>p.cmp(h,d),this._max=(d,h)=>p.cmp(d,h)>0?d:h,this._min=(d,h)=>p.cmp(d,h)<0?d:h,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=Bh(r.IDBKeyRange),this._createTransaction=(o,c,f,u)=>new this.Transaction(o,c,f,this._options.chromeTransactionDurability,u),this._fireOnBlocked=o=>{this.on("blocked").fire(o),Y0.filter(c=>c.name===this.name&&c!==this&&!c._state.vcFired).map(c=>c.on("versionchange").fire(o))},this.use(gM),this.use(xM),this.use(wM),this.use(vM),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new At.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new At.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(s=>s._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(uM),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Nt.letThrough||this._vip)?t():new at((r,n)=>{if(this._state.openComplete)return n(new At.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new At.DatabaseClosed);this.open().catch(_r)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:s}){s&&this.unuse({stack:t,name:s});const a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:r,level:n??10,name:s}),a.sort((i,o)=>i.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>n?s.create!==n:!!r&&s.name!==r)),this}open(){return pM(this)}_close(){const t=this._state,r=Y0.indexOf(this);if(r>=0&&Y0.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new at(n=>{t.dbReadyResolve=n}),t.openCanceller=new at((n,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new At.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new at((n,s)=>{const a=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Ur(()=>{(function({indexedDB:o,IDBKeyRange:c},f){!pb(o)&&f!==yx&&hb(o,c).delete(f).catch(_r)})(this._deps,this.name),n()}),i.onerror=ro(s),i.onblocked=this._fireOnBlocked};if(t)throw new At.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return An(this._allTables).map(t=>this._allTables[t])}transaction(){const t=mM.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let s=Nt.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const a=t.indexOf("?")!==-1;let i,o;t=t.replace("!","").replace("?","");try{if(o=r.map(f=>{var u=f instanceof this.Table?f.name:f;if(typeof u!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return u}),t=="r"||t===z2)i=z2;else{if(t!="rw"&&t!=q2)throw new At.InvalidArgument("Invalid transaction mode: "+t);i=q2}if(s){if(s.mode===z2&&i===q2){if(!a)throw new At.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(f=>{if(s&&s.storeNames.indexOf(f)===-1){if(!a)throw new At.SubTransaction("Table "+f+" not included in parent transaction.");s=null}}),a&&s&&!s.active&&(s=null)}}catch(f){return s?s._promise(null,(u,p)=>{p(f)}):Bn(f)}const c=$A.bind(null,this,i,o,s,n);return s?s._promise(i,c,"lock"):Nt.trans?Ld(Nt.transless,()=>this._whenReady(c)):this._whenReady(c)}table(t){if(!Pa(this._allTables,t))throw new At.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const bM=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class NM{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[bM](){return this}}function qA(e,t){return An(t).forEach(r=>{xg(e[r]||(e[r]=new Go),t[r])}),e}function HA(e){let t,r=!1;const n=new NM(s=>{const a=ib(e);let i=!1,o={},c={};const f={get closed(){return i},unsubscribe:()=>{i=!0,Sc.storagemutated.unsubscribe(h)}};s.start&&s.start(f);let u=!1,p=!1;function d(){return An(c).some(g=>o[g]&&yM(o[g],c[g]))}const h=g=>{qA(o,g),d()&&m()},m=()=>{if(u||i)return;o={};const g={},y=function(v){a&&Fd();const b=()=>bc(e,{subscr:v,trans:null}),w=Nt.trans?Ld(Nt.transless,b):b();return a&&w.then(hl,hl),w}(g);p||(Sc(Mh,h),p=!0),u=!0,Promise.resolve(y).then(v=>{r=!0,t=v,u=!1,i||(d()?m():(o={},c=g,s.next&&s.next(v)))},v=>{u=!1,r=!1,s.error&&s.error(v),f.unsubscribe()})};return m(),f});return n.hasValue=()=>r,n.getValue=()=>t,n}let pw;try{pw={indexedDB:Dr.indexedDB||Dr.mozIndexedDB||Dr.webkitIndexedDB||Dr.msIndexedDB,IDBKeyRange:Dr.IDBKeyRange||Dr.webkitIDBKeyRange}}catch{pw={indexedDB:null,IDBKeyRange:null}}const Gc=Nu;function _1(e){let t=tl;try{tl=!0,Sc.storagemutated.fire(e)}finally{tl=t}}bd(Gc,{...v1,delete:e=>new Gc(e,{addons:[]}).delete(),exists:e=>new Gc(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return pb(t)?Promise.resolve(t.databases()).then(n=>n.map(s=>s.name).filter(s=>s!==yx)):hb(t,r).toCollection().primaryKeys()}(Gc.dependencies).then(e)}catch{return Bn(new At.MissingAPI)}},defineClass:()=>function(e){Ws(this,e)},ignoreTransaction:e=>Nt.trans?Ld(Nt.transless,e):e(),vip:fw,async:function(e){return function(){try{var t=dw(e.apply(this,arguments));return t&&typeof t.then=="function"?t:at.resolve(t)}catch(r){return Bn(r)}}},spawn:function(e,t,r){try{var n=dw(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:at.resolve(n)}catch(s){return Bn(s)}},currentTransaction:{get:()=>Nt.trans||null},waitFor:function(e,t){const r=at.resolve(typeof e=="function"?Gc.ignoreTransaction(e):e).timeout(t||6e4);return Nt.trans?Nt.trans.waitFor(r):r},Promise:at,debug:{get:()=>bo,set:e=>{wA(e,e==="dexie"?()=>!0:DA)}},derive:Wf,extend:Ws,props:bd,override:pA,Events:X0,on:Sc,liveQuery:HA,extendObservabilitySet:qA,getByKeyPath:il,setByKeyPath:Di,delByKeyPath:function(e,t){typeof t=="string"?Di(e,t,void 0):"length"in t&&[].map.call(t,function(r){Di(e,r,void 0)})},shallowClone:xA,deepClone:gp,getObjectDiff:mb,cmp:$s,asap:mA,minKey:nw,addons:[],connections:Y0,errnames:lb,dependencies:pw,semVer:MN,version:MN.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),Gc.maxKey=Bh(Gc.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Sc(Mh,e=>{if(!tl){let t;vx?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Gl,!0,!0,e)):t=new CustomEvent(Gl,{detail:e}),tl=!0,dispatchEvent(t),tl=!1}}),addEventListener(Gl,({detail:e})=>{tl||_1(e)}));let tl=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Gl);typeof e.unref=="function"&&e.unref(),Sc(Mh,t=>{tl||e.postMessage(t)}),e.onmessage=t=>{t.data&&_1(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Sc(Mh,t=>{try{tl||(typeof localStorage<"u"&&localStorage.setItem(Gl,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Gl,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Gl){const r=JSON.parse(t.newValue);r&&_1(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Gl&&_1(t.changedParts)})}at.rejectionMapper=function(e,t){if(!e||e instanceof Vf||e instanceof TypeError||e instanceof SyntaxError||!e.name||!DN[e.name])return e;var r=new DN[e.name](t||e.message,e);return"stack"in e&&al(r,"stack",{get:function(){return this.inner.stack}}),r},wA(bo,DA);class SM extends Nu{constructor(){super("ProjetGestionDB");bt(this,"users");bt(this,"projects");bt(this,"bordereaux");bt(this,"periodes");bt(this,"metres");bt(this,"decompts");bt(this,"photos");bt(this,"pvs");bt(this,"attachments");bt(this,"syncOperations");bt(this,"auditLogs");bt(this,"companies");this.version(1).stores({users:"id, email",projects:"id, userId, status, annee, marcheNo",bordereaux:"id, projectId, userId, reference",metres:"id, projectId, bordereauLigneId, userId, reference",decompts:"id, projectId, userId, periode, numero",photos:"id, projectId, userId, syncStatus",pvs:"id, projectId, userId, type, date",attachments:"id, projectId, userId, category, syncStatus",syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(2).stores({syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(3).stores({periodes:"id, projectId, userId, numero, statut",metres:"id, projectId, periodeId, bordereauLigneId, userId, reference",decompts:"id, projectId, periodeId, userId, numero"}),this.version(4).stores({periodes:"id, projectId, userId, numero, statut"}),this.version(5).stores({projects:"id, userId, status, annee, marcheNo"}),this.version(6).stores({users:"id, email, role, isActive, createdBy",auditLogs:"id, userId, action, entityType, timestamp"}),this.version(7).stores({companies:"id, userId, nom, rc, cnss, usageCount, lastUsed"}),this.version(8).stores({syncOperations:"id, userId, deviceId, entity, entityId, timestamp, synced, syncedAt, [userId+synced]",projects:"id, userId, status, annee, marcheNo, deletedAt",bordereaux:"id, projectId, userId, reference, deletedAt",metres:"id, projectId, periodeId, bordereauLigneId, userId, deletedAt",decompts:"id, projectId, periodeId, userId, numero, deletedAt",periodes:"id, projectId, userId, numero, statut, deletedAt"})}}const Se=new SM,Yr=zj()(tR(e=>({user:null,token:null,isLoading:!1,error:null,login:async(t,r)=>{var n,s,a;e({isLoading:!0,error:null});try{const i=await ra.login(t,r),{user:o,token:c}=i.data;if(localStorage.removeItem("lastSyncTimestamp"),console.log(" Cleared lastSyncTimestamp for full sync"),o.trialEndDate&&new Date(o.trialEndDate)<new Date)throw await Se.users.update(o.id,{isActive:!1}),new Error("Votre priode d'essai a expir. Veuillez contacter l'administrateur.");if(o.isActive===!1)throw new Error("Votre compte est dsactiv. Veuillez contacter l'administrateur.");await Se.users.update(o.id,{lastLogin:new Date().toISOString()}),localStorage.setItem("authToken",c),await Se.users.put({id:o.id,email:o.email,firstName:o.firstName,lastName:o.lastName,role:o.role||"user",isActive:o.isActive??!0,trialEndDate:o.trialEndDate,createdBy:o.createdBy,createdAt:o.createdAt||new Date().toISOString(),lastLogin:new Date().toISOString(),token:c}),e({user:o,token:c,isLoading:!1})}catch(i){throw e({error:((a=(s=(n=i.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:a.message)||i.message||"Login failed",isLoading:!1}),i}},register:async t=>{var r,n,s;e({isLoading:!0,error:null});try{console.log(" Sending registration request:",t);const a=await ra.register(t);console.log(" Registration response:",a);const{user:i,token:o}=a.data;localStorage.setItem("authToken",o),await Se.users.put({id:i.id,email:i.email,firstName:i.firstName,lastName:i.lastName,role:i.role,isActive:i.isActive??!0,createdAt:i.createdAt||new Date().toISOString(),token:o}),e({user:i,token:o,isLoading:!1})}catch(a){console.error(" Registration error:",a),console.error(" Error response:",a.response);const i=((s=(n=(r=a.response)==null?void 0:r.data)==null?void 0:n.error)==null?void 0:s.message)||a.message||"Registration failed";throw e({error:i,isLoading:!1}),a}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("lastSyncTimestamp"),localStorage.removeItem("auth-storage"),e({user:null,token:null,error:null})},checkAuth:async()=>{var r;const t=localStorage.getItem("authToken");if(!t){e({user:null,token:null,error:null});return}try{const s=(await ra.getCurrentUser()).data;e({user:s,token:t,error:null})}catch(n){console.log(" Auth check failed, logging out:",(r=n.response)==null?void 0:r.status),localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp"),e({user:null,token:null,error:null})}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token})}));let Cm;const _M=new Uint8Array(16);function kM(){if(!Cm&&(Cm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Cm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Cm(_M)}const ts=[];for(let e=0;e<256;++e)ts.push((e+256).toString(16).slice(1));function EM(e,t=0){return ts[e[t+0]]+ts[e[t+1]]+ts[e[t+2]]+ts[e[t+3]]+"-"+ts[e[t+4]]+ts[e[t+5]]+"-"+ts[e[t+6]]+ts[e[t+7]]+"-"+ts[e[t+8]]+ts[e[t+9]]+"-"+ts[e[t+10]]+ts[e[t+11]]+ts[e[t+12]]+ts[e[t+13]]+ts[e[t+14]]+ts[e[t+15]]}const jM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),VN={randomUUID:jM};function Ir(e,t,r){if(VN.randomUUID&&!e)return VN.randomUUID();e=e||{};const n=e.random||(e.rng||kM)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,EM(n)}const vg={DEVICE_ID_KEY:"sync-device-id",LAST_SYNC_KEY:"lastSyncTimestamp"},KN=()=>typeof window>"u"?!1:window.navigator.userAgent.includes("Electron")||window.location.protocol==="app:"||window.electronAPI!==void 0,k1=()=>{const e=KN()?`${vg.DEVICE_ID_KEY}-electron`:`${vg.DEVICE_ID_KEY}-browser`;let t=localStorage.getItem(e);return t||(t=`${KN()?"electron":"browser"}-${Ir()}`,localStorage.setItem(e,t),console.log(" Generated new deviceId:",t)),t},GN=()=>{const e=localStorage.getItem(vg.LAST_SYNC_KEY);return e?parseInt(e,10):0},YN=e=>{localStorage.setItem(vg.LAST_SYNC_KEY,e.toString())},mn=async(e,t,r,n,s)=>{const a=Ir(),i={id:a,userId:s,deviceId:k1(),type:e,entity:t,entityId:r,data:n,timestamp:Date.now(),synced:!1};return await Se.syncOperations.add(i),console.log(` Logged ${e} operation for ${t}:${r} (op_id: ${a})`),a},Yc=()=>navigator.onLine,AM=(e,t)=>(window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}),go=Object.create(null);go.open="0";go.close="1";go.ping="2";go.pong="3";go.message="4";go.upgrade="5";go.noop="6";const E1=Object.create(null);Object.keys(go).forEach(e=>{E1[go[e]]=e});const mw={type:"error",data:"parser error"},WA=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",VA=typeof ArrayBuffer=="function",KA=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,xb=({type:e,data:t},r,n)=>WA&&t instanceof Blob?r?n(t):XN(t,n):VA&&(t instanceof ArrayBuffer||KA(t))?r?n(t):XN(new Blob([t]),n):n(go[e]+(t||"")),XN=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function JN(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let G2;function TM(e,t){if(WA&&e.data instanceof Blob)return e.data.arrayBuffer().then(JN).then(t);if(VA&&(e.data instanceof ArrayBuffer||KA(e.data)))return t(JN(e.data));xb(e,!1,r=>{G2||(G2=new TextEncoder),t(G2.encode(r))})}const QN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",F0=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<QN.length;e++)F0[QN.charCodeAt(e)]=e;const CM=e=>{let t=e.length*.75,r=e.length,n,s=0,a,i,o,c;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const f=new ArrayBuffer(t),u=new Uint8Array(f);for(n=0;n<r;n+=4)a=F0[e.charCodeAt(n)],i=F0[e.charCodeAt(n+1)],o=F0[e.charCodeAt(n+2)],c=F0[e.charCodeAt(n+3)],u[s++]=a<<2|i>>4,u[s++]=(i&15)<<4|o>>2,u[s++]=(o&3)<<6|c&63;return f},PM=typeof ArrayBuffer=="function",vb=(e,t)=>{if(typeof e!="string")return{type:"message",data:GA(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:FM(e.substring(1),t)}:E1[r]?e.length>1?{type:E1[r],data:e.substring(1)}:{type:E1[r]}:mw},FM=(e,t)=>{if(PM){const r=CM(e);return GA(r,t)}else return{base64:!0,data:e}},GA=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},YA="",LM=(e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach((a,i)=>{xb(a,!1,o=>{n[i]=o,++s===r&&t(n.join(YA))})})},DM=(e,t)=>{const r=e.split(YA),n=[];for(let s=0;s<r.length;s++){const a=vb(r[s],t);if(n.push(a),a.type==="error")break}return n};function OM(){return new TransformStream({transform(e,t){TM(e,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let Y2;function Pm(e){return e.reduce((t,r)=>t+r.length,0)}function Fm(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function RM(e,t){Y2||(Y2=new TextDecoder);const r=[];let n=0,s=-1,a=!1;return new TransformStream({transform(i,o){for(r.push(i);;){if(n===0){if(Pm(r)<1)break;const c=Fm(r,1);a=(c[0]&128)===128,s=c[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(Pm(r)<2)break;const c=Fm(r,2);s=new DataView(c.buffer,c.byteOffset,c.length).getUint16(0),n=3}else if(n===2){if(Pm(r)<8)break;const c=Fm(r,8),f=new DataView(c.buffer,c.byteOffset,c.length),u=f.getUint32(0);if(u>Math.pow(2,21)-1){o.enqueue(mw);break}s=u*Math.pow(2,32)+f.getUint32(4),n=3}else{if(Pm(r)<s)break;const c=Fm(r,s);o.enqueue(vb(a?c:Y2.decode(c),t)),n=0}if(s===0||s>e){o.enqueue(mw);break}}}})}const XA=4;function jn(e){if(e)return IM(e)}function IM(e){for(var t in jn.prototype)e[t]=jn.prototype[t];return e}jn.prototype.on=jn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};jn.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};jn.prototype.off=jn.prototype.removeListener=jn.prototype.removeAllListeners=jn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};jn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,t)}return this};jn.prototype.emitReserved=jn.prototype.emit;jn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};jn.prototype.hasListeners=function(e){return!!this.listeners(e).length};const wx=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Ya=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),MM="arraybuffer";function JA(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const BM=Ya.setTimeout,UM=Ya.clearTimeout;function bx(e,t){t.useNativeTimers?(e.setTimeoutFn=BM.bind(Ya),e.clearTimeoutFn=UM.bind(Ya)):(e.setTimeoutFn=Ya.setTimeout.bind(Ya),e.clearTimeoutFn=Ya.clearTimeout.bind(Ya))}const $M=1.33;function zM(e){return typeof e=="string"?qM(e):Math.ceil((e.byteLength||e.size)*$M)}function qM(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function QA(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function HM(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function WM(e){let t={},r=e.split("&");for(let n=0,s=r.length;n<s;n++){let a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class VM extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class yb extends jn{constructor(t){super(),this.writable=!1,bx(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new VM(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=vb(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=HM(t);return r.length?"?"+r:""}}class KM extends yb{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};DM(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,LM(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=QA()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let ZA=!1;try{ZA=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const GM=ZA;function YM(){}class XM extends KM{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class mo extends jn{constructor(t,r,n){super(),this.createRequest=t,bx(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=JA(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=mo.requestsCount++,mo.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=YM,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete mo.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}mo.requestsCount=0;mo.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",ZN);else if(typeof addEventListener=="function"){const e="onpagehide"in Ya?"pagehide":"unload";addEventListener(e,ZN,!1)}}function ZN(){for(let e in mo.requests)mo.requests.hasOwnProperty(e)&&mo.requests[e].abort()}const JM=function(){const e=eT({xdomain:!1});return e&&e.responseType!==null}();class QM extends XM{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=JM&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new mo(eT,this.uri(),t)}}function eT(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||GM))return new XMLHttpRequest}catch{}if(!t)try{return new Ya[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const tT=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class ZM extends yb{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=tT?{}:JA(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;xb(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}s&&wx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=QA()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const X2=Ya.WebSocket||Ya.MozWebSocket;class e9 extends ZM{createSocket(t,r,n){return tT?new X2(t,r,n):r?new X2(t,r):new X2(t)}doWrite(t,r){this.ws.send(r)}}class t9 extends yb{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=RM(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),s=OM();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const a=()=>{n.read().then(({done:o,value:c})=>{o||(this.onPacket(c),a())}).catch(o=>{})};a();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;this._writer.write(n).then(()=>{s&&wx(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const r9={websocket:e9,webtransport:t9,polling:QM},n9=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,s9=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function gw(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=n9.exec(e||""),a={},i=14;for(;i--;)a[s9[i]]=s[i]||"";return r!=-1&&n!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=a9(a,a.path),a.queryKey=i9(a,a.query),a}function a9(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function i9(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,a){s&&(r[s]=a)}),r}const xw=typeof addEventListener=="function"&&typeof removeEventListener=="function",j1=[];xw&&addEventListener("offline",()=>{j1.forEach(e=>e())},!1);class xc extends jn{constructor(t,r){if(super(),this.binaryType=MM,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=gw(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=gw(r.host).host);bx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=WM(this.opts.query)),xw&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},j1.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=XA,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&xc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",xc.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=zM(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,wx(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:t,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(xc.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),xw&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=j1.indexOf(this._offlineEventListener);n!==-1&&j1.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}xc.protocol=XA;class o9 extends xc{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;xc.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",p=>{if(!n)if(p.type==="pong"&&p.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;xc.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(u(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const d=new Error("probe error");d.transport=r.name,this.emitReserved("upgradeError",d)}}))};function a(){n||(n=!0,u(),r.close(),r=null)}const i=p=>{const d=new Error("probe error: "+p);d.transport=r.name,a(),this.emitReserved("upgradeError",d)};function o(){i("transport closed")}function c(){i("socket closed")}function f(p){r&&p.name!==r.name&&a()}const u=()=>{r.removeListener("open",s),r.removeListener("error",i),r.removeListener("close",o),this.off("close",c),this.off("upgrading",f)};r.once("open",s),r.once("error",i),r.once("close",o),this.once("close",c),this.once("upgrading",f),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let l9=class extends o9{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>r9[s]).filter(s=>!!s)),super(t,n)}};function c9(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=gw(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const u9=typeof ArrayBuffer=="function",f9=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,rT=Object.prototype.toString,d9=typeof Blob=="function"||typeof Blob<"u"&&rT.call(Blob)==="[object BlobConstructor]",h9=typeof File=="function"||typeof File<"u"&&rT.call(File)==="[object FileConstructor]";function wb(e){return u9&&(e instanceof ArrayBuffer||f9(e))||d9&&e instanceof Blob||h9&&e instanceof File}function A1(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(A1(e[r]))return!0;return!1}if(wb(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return A1(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&A1(e[r]))return!0;return!1}function p9(e){const t=[],r=e.data,n=e;return n.data=vw(r,t),n.attachments=t.length,{packet:n,buffers:t}}function vw(e,t){if(!e)return e;if(wb(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=vw(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=vw(e[n],t));return r}return e}function m9(e,t){return e.data=yw(e.data,t),delete e.attachments,e}function yw(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=yw(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=yw(e[r],t));return e}const g9=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],x9=5;var tr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(tr||(tr={}));class v9{constructor(t){this.replacer=t}encode(t){return(t.type===tr.EVENT||t.type===tr.ACK)&&A1(t)?this.encodeAsBinary({type:t.type===tr.EVENT?tr.BINARY_EVENT:tr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===tr.BINARY_EVENT||t.type===tr.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=p9(t),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function eS(e){return Object.prototype.toString.call(e)==="[object Object]"}class bb extends jn{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===tr.BINARY_EVENT;n||r.type===tr.BINARY_ACK?(r.type=n?tr.EVENT:tr.ACK,this.reconstructor=new y9(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(wb(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(tr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===tr.BINARY_EVENT||n.type===tr.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const i=t.substring(a,r);if(i!=Number(i)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(a,r)}else n.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const i=t.charAt(r);if(i==null||Number(i)!=i){--r;break}if(r===t.length)break}n.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(bb.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case tr.CONNECT:return eS(r);case tr.DISCONNECT:return r===void 0;case tr.CONNECT_ERROR:return typeof r=="string"||eS(r);case tr.EVENT:case tr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&g9.indexOf(r[0])===-1);case tr.ACK:case tr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class y9{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=m9(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const w9=Object.freeze(Object.defineProperty({__proto__:null,Decoder:bb,Encoder:v9,get PacketType(){return tr},protocol:x9},Symbol.toStringTag,{value:"Module"}));function Si(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const b9=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class nT extends jn{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Si(t,"open",this.onopen.bind(this)),Si(t,"packet",this.onpacket.bind(this)),Si(t,"error",this.onerror.bind(this)),Si(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,s,a;if(b9.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:tr.EVENT,data:r};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const u=this.ids++,p=r.pop();this._registerAckCallback(u,p),i.id=u}const o=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,c=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(c?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);r.call(this,new Error("operation has timed out"))},s),i=(...o)=>{this.io.clearTimeoutFn(a),r.apply(this,o)};i.withError=!0,this.acks[t]=i}emitWithAck(t,...r){return new Promise((n,s)=>{const a=(i,o)=>i?s(i):n(o);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...a)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:tr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case tr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case tr.EVENT:case tr.BINARY_EVENT:this.onevent(t);break;case tr.ACK:case tr.BINARY_ACK:this.onack(t);break;case tr.DISCONNECT:this.ondisconnect();break;case tr.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:tr.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:tr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Dd(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Dd.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Dd.prototype.reset=function(){this.attempts=0};Dd.prototype.setMin=function(e){this.ms=e};Dd.prototype.setMax=function(e){this.max=e};Dd.prototype.setJitter=function(e){this.jitter=e};class ww extends jn{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,bx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Dd({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||w9;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new l9(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=Si(r,"open",function(){n.onopen(),t&&t()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},i=Si(r,"error",a);if(this._timeout!==!1){const o=this._timeout,c=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},o);this.opts.autoUnref&&c.unref(),this.subs.push(()=>{this.clearTimeoutFn(c)})}return this.subs.push(s),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Si(t,"ping",this.onping.bind(this)),Si(t,"data",this.ondata.bind(this)),Si(t,"error",this.onerror.bind(this)),Si(t,"close",this.onclose.bind(this)),Si(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){wx(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new nT(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const w0={};function T1(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=c9(e,t.path||"/socket.io"),n=r.source,s=r.id,a=r.path,i=w0[s]&&a in w0[s].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||i;let c;return o?c=new ww(n,t):(w0[s]||(w0[s]=new ww(n,t)),c=w0[s]),r.query&&!t.query&&(t.query=r.queryKey),c.socket(r.path,t)}Object.assign(T1,{Manager:ww,Socket:nT,io:T1,connect:T1});const Xc={RECONNECT_DELAY_MIN:1e3,RECONNECT_DELAY_MAX:3e4,RECONNECT_ATTEMPTS_MAX:10,SERVER_SEQ_KEY:"realtime-server-seq",FALLBACK_POLL_INTERVAL:5e3};class N9{constructor(){bt(this,"socket",null);bt(this,"state",{status:"disconnected",lastConnected:null,reconnectAttempts:0,serverSeq:0});bt(this,"operationListeners",new Set);bt(this,"statusListeners",new Set);bt(this,"reconnectTimer",null);bt(this,"fallbackPollTimer",null);bt(this,"token",null);bt(this,"deviceId",null);bt(this,"userId",null);bt(this,"subscribedProjects",new Set);const t=localStorage.getItem(Xc.SERVER_SEQ_KEY);t&&(this.state.serverSeq=parseInt(t,10)||0)}connect(t,r,n,s){var i;if(this.token=r,this.deviceId=n,this.userId=s,(i=this.socket)!=null&&i.connected){console.log(" Already connected to realtime server");return}console.log(" Connecting to realtime server:",t),this.updateStatus("connecting");let a=t.replace(/\/api\/?$/,"");!a.startsWith("http://")&&!a.startsWith("https://")&&(a=`http://${a}`),console.log(" Socket.IO URL:",a),this.socket=T1(a,{path:"/socket.io/",auth:{token:r,deviceId:n},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:Xc.RECONNECT_DELAY_MIN,reconnectionDelayMax:Xc.RECONNECT_DELAY_MAX,reconnectionAttempts:Xc.RECONNECT_ATTEMPTS_MAX,timeout:2e4,forceNew:!0}),this.setupEventListeners()}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{var t;console.log(" Connected to realtime server"),this.updateStatus("connected"),this.state.lastConnected=Date.now(),this.state.reconnectAttempts=0,this.stopFallbackPolling();for(const r of this.subscribedProjects)(t=this.socket)==null||t.emit("join:project",r);this.requestMissedOperations()}),this.socket.on("disconnect",t=>{console.log(" Disconnected from realtime server:",t),this.updateStatus("disconnected"),t!=="io client disconnect"&&this.startFallbackPolling()}),this.socket.on("connect_error",t=>{console.error(" Connection error:",t.message),this.updateStatus("error"),this.state.reconnectAttempts++,this.state.reconnectAttempts>=3&&this.startFallbackPolling()}),this.socket.on("sync:op",t=>{console.log(" Received realtime op:",t.opId,t.type,t.entity),this.handleOperation(t)}),this.socket.on("sync:state",t=>{console.log(" Received sync state:",t.operations.length,"operations");for(const r of t.operations)this.handleOperation(r)}),this.socket.on("sync:error",t=>{console.error(" Sync error:",t.message)}),this.socket.on("error",t=>{console.error(" Socket error:",t)}))}async handleOperation(t){if(t.clientId===this.deviceId){console.log(" Skipping own operation:",t.opId);return}if(t.serverSeq<=this.state.serverSeq){console.log(" Skipping already processed operation:",t.opId);return}await this.applyOperation(t),this.state.serverSeq=Math.max(this.state.serverSeq,t.serverSeq),localStorage.setItem(Xc.SERVER_SEQ_KEY,this.state.serverSeq.toString());for(const r of this.operationListeners)try{r(t)}catch(n){console.error("Error in operation listener:",n)}}async applyOperation(t){const n={project:Se.projects,bordereau:Se.bordereaux,periode:Se.periodes,metre:Se.metres,decompt:Se.decompts,photo:Se.photos,pv:Se.pvs,attachment:Se.attachments,company:Se.companies}[t.entity];if(!n){console.warn("Unknown entity type:",t.entity);return}const s=this.normalizeEntityId(t.entity,t.entityId);try{switch(t.type){case"CREATE":case"UPDATE":{const a=this.normalizeData(t.entity,t.data,s);await n.put(a),console.log(` Applied ${t.type} to ${t.entity}:${s}`);break}case"DELETE":{await n.delete(s),console.log(` Applied DELETE to ${t.entity}:${s}`);break}}}catch(a){console.error(` Failed to apply ${t.type} to ${t.entity}:${s}:`,a.message)}}normalizeEntityId(t,r){if(!r)return"";const n=r.includes(":")?r.split(":").pop():r;return`${t}:${n}`}normalizeData(t,r,n){const s={...r,id:n};return s.projectId&&(s.projectId=this.normalizeEntityId("project",s.projectId)),s.periodeId&&s.periodeId.trim()!==""&&(s.periodeId=this.normalizeEntityId("periode",s.periodeId)),s.bordereauId&&(s.bordereauId=this.normalizeEntityId("bordereau",s.bordereauId)),s.userId&&(s.userId=this.normalizeEntityId("user",s.userId)),s}requestMissedOperations(){var t;(t=this.socket)!=null&&t.connected&&(console.log(" Requesting operations since seq:",this.state.serverSeq),this.socket.emit("sync:request",{since:this.state.serverSeq}))}subscribeToProject(t){var r;this.subscribedProjects.add(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("join:project",t),console.log(" Subscribed to project:",t))}unsubscribeFromProject(t){var r;this.subscribedProjects.delete(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("leave:project",t),console.log(" Unsubscribed from project:",t))}startFallbackPolling(){this.fallbackPollTimer||(console.log(" Starting fallback polling..."),this.fallbackPollTimer=setInterval(async()=>{var t;if((t=this.socket)!=null&&t.connected){this.stopFallbackPolling();return}await this.pollForUpdates()},Xc.FALLBACK_POLL_INTERVAL))}stopFallbackPolling(){this.fallbackPollTimer&&(clearInterval(this.fallbackPollTimer),this.fallbackPollTimer=null,console.log(" Stopped fallback polling"))}async pollForUpdates(){var t;if(this.token)try{const r=await fetch(`/api/sync/pull?since=${this.state.serverSeq}&deviceId=${this.deviceId}`,{headers:{Authorization:`Bearer ${this.token}`}});if(r.ok){const s=((t=(await r.json()).data)==null?void 0:t.operations)||[];for(const a of s)await this.handleOperation({serverSeq:a.serverSeq,opId:a.opId||a.id,clientId:a.clientId,type:a.type,entity:a.entity,entityId:a.entityId,data:a.data,timestamp:a.timestamp,userId:a.userId||this.userId||""})}}catch(r){console.error("Polling error:",r)}}onOperation(t){return this.operationListeners.add(t),()=>this.operationListeners.delete(t)}onStatusChange(t){return this.statusListeners.add(t),t(this.state.status),()=>this.statusListeners.delete(t)}updateStatus(t){this.state.status=t;for(const r of this.statusListeners)try{r(t)}catch(n){console.error("Error in status listener:",n)}}getState(){return{...this.state}}isConnected(){var t;return((t=this.socket)==null?void 0:t.connected)??!1}getServerSeq(){return this.state.serverSeq}setServerSeq(t){this.state.serverSeq=t,localStorage.setItem(Xc.SERVER_SEQ_KEY,t.toString())}disconnect(){console.log(" Disconnecting from realtime server"),this.stopFallbackPolling(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.socket&&(this.socket.disconnect(),this.socket=null),this.updateStatus("disconnected"),this.subscribedProjects.clear()}reconnect(){if(this.token&&this.deviceId&&this.userId){const t=this.getServerUrl();this.disconnect(),this.connect(t,this.token,this.deviceId,this.userId)}}getServerUrl(){var r,n;const t=(n=(r=import.meta)==null?void 0:r.env)==null?void 0:n.VITE_API_URL;return t?t.replace("/api",""):typeof window<"u"&&window.location.hostname!=="localhost"?window.location.origin:"http://localhost:3000"}}const Jc=new N9,df=new Map,tS={emit(e,t){const r=df.get(e);if(r)for(const n of r)try{n(t)}catch(s){console.error("Event listener error:",s)}},on(e,t){return df.has(e)||df.set(e,new Set),df.get(e).add(t),()=>{var r;(r=df.get(e))==null||r.delete(t)}},off(e,t){var r;(r=df.get(e))==null||r.delete(t)}},zo={PROJECT_UPDATED:"project:updated",BORDEREAU_UPDATED:"bordereau:updated",PERIODE_UPDATED:"periode:updated",METRE_UPDATED:"metre:updated",DECOMPT_UPDATED:"decompt:updated",PHOTO_UPDATED:"photo:updated",PV_UPDATED:"pv:updated",ATTACHMENT_UPDATED:"attachment:updated",DATA_CHANGED:"data:changed"},rS={project:"projects",bordereau:"bordereaux",metre:"metres",decompt:"decompts",pv:"pvs",periode:"periodes",photo:"photos",attachment:"attachments",user:"users",company:"companies",auditLog:"auditLogs"},ns=(e,t)=>{if(!t)return"";const r=t.includes(":")?t.split(":").pop():t;return`${e}:${r}`},Qo=e=>e?e.includes(":")?e.split(":").pop():e:"",Q0=[],S9=500,Tr=e=>{Q0.unshift({...e,timestamp:new Date}),Q0.length>S9&&Q0.pop();const t=e.success?"":"";console.log(`${t} [SYNC] ${e.action}`,e.entity?`${e.entity}:${e.entityId}`:"",e.error||"")},_9=()=>[...Q0],k9=()=>{Q0.length=0},E9=async e=>{const t={localCounts:{},missingEntities:[],orphanedEntities:[],errors:[]};try{t.localCounts={projects:await Se.projects.count(),bordereaux:await Se.bordereaux.count(),metres:await Se.metres.count(),decompts:await Se.decompts.count(),periodes:await Se.periodes.count(),pvs:await Se.pvs.count(),photos:await Se.photos.count(),attachments:await Se.attachments.count()};const r=await ra.getProjects(),n=r.data||r;if(Array.isArray(n))for(const a of n){const i=ns("project",a.id);await Se.projects.get(i)||t.missingEntities.push({entity:"project",id:a.id})}const s=await Se.projects.toArray();for(const a of s){const i=Qo(a.id);!(Array.isArray(n)&&n.some(c=>Qo(c.id)===i||c.id===i))&&!a.deletedAt&&t.orphanedEntities.push({entity:"project",id:a.id})}Tr({action:"INSPECT",success:!0,data:t})}catch(r){t.errors.push(r.message),Tr({action:"INSPECT",success:!1,error:r.message})}return t},j9=e=>{const t={CREATE:0,UPDATE:1,DELETE:2};return[...e].sort((r,n)=>{const s=t[r.type]-t[n.type];if(s!==0)return s;const a=typeof r.timestamp=="string"?new Date(r.timestamp).getTime():r.timestamp,i=typeof n.timestamp=="string"?new Date(n.timestamp).getTime():n.timestamp;return a-i})},A9=async e=>{const t={applied:0,skipped:0,errors:[]};if(e.length===0)return t;const r=j9(e);console.log(` Applying ${r.length} operations (sorted: CREATEUPDATEDELETE)...`);const n={};for(const s of r){const a=rS[s.entity];if(!a){t.skipped++,Tr({action:"SKIP",entity:s.entity,entityId:s.entityId,success:!1,error:`Unknown entity: ${s.entity}`});continue}n[a]||(n[a]={creates:[],updates:[],deletes:[]});const i=ns(s.entity,s.entityId),o=s.data?{...s.data}:{};switch(o.projectId&&(o.projectId=ns("project",o.projectId)),o.periodeId&&o.periodeId.trim()!==""&&(o.periodeId=ns("periode",o.periodeId)),o.bordereauId&&(o.bordereauId=ns("bordereau",o.bordereauId)),o.userId&&(o.userId=ns("user",o.userId)),s.type){case"CREATE":n[a].creates.push({...o,id:i});break;case"UPDATE":n[a].updates.push({id:i,data:o});break;case"DELETE":n[a].deletes.push(i);break}}try{const s=[Se.projects,Se.bordereaux,Se.metres,Se.decompts,Se.periodes,Se.pvs,Se.photos];await Se.transaction("rw",s,async()=>{for(const[a,i]of Object.entries(n)){const o=Se[a];if(o){if(i.creates.length>0)try{await o.bulkPut(i.creates),t.applied+=i.creates.length,Tr({action:"BULK_CREATE",entity:a,success:!0,data:{count:i.creates.length}})}catch{for(const f of i.creates)try{await o.put(f),t.applied++,Tr({action:"CREATE",entity:a,entityId:f.id,success:!0})}catch(u){t.errors.push({op:{type:"CREATE",entity:a,entityId:f.id,data:f},error:u.message}),Tr({action:"CREATE",entity:a,entityId:f.id,success:!1,error:u.message})}}for(const c of i.updates)try{await o.get(c.id)?await o.update(c.id,c.data):await o.put({...c.data,id:c.id}),t.applied++,Tr({action:"UPDATE",entity:a,entityId:c.id,success:!0})}catch(f){t.errors.push({op:{type:"UPDATE",entity:a,entityId:c.id,data:c.data},error:f.message}),Tr({action:"UPDATE",entity:a,entityId:c.id,success:!1,error:f.message})}if(i.deletes.length>0)try{await o.bulkDelete(i.deletes),t.applied+=i.deletes.length,Tr({action:"BULK_DELETE",entity:a,success:!0,data:{count:i.deletes.length}})}catch{for(const f of i.deletes)try{await o.delete(f),t.applied++,Tr({action:"DELETE",entity:a,entityId:f,success:!0})}catch(u){t.errors.push({op:{type:"DELETE",entity:a,entityId:f},error:u.message}),Tr({action:"DELETE",entity:a,entityId:f,success:!1,error:u.message})}}}}})}catch(s){console.error(" Transaction error:",s),Tr({action:"TRANSACTION",success:!1,error:s.message});for(const a of r)try{const i=rS[a.entity];if(!i)continue;const o=Se[i];if(!o)continue;const c=ns(a.entity,a.entityId),f=a.data?{...a.data}:{};switch(f.projectId&&(f.projectId=ns("project",f.projectId)),a.type){case"CREATE":await o.put({...f,id:c});break;case"UPDATE":await o.put({...f,id:c});break;case"DELETE":await o.delete(c);break}t.applied++,Tr({action:a.type,entity:a.entity,entityId:c,success:!0})}catch(i){t.errors.push({op:a,error:i.message}),Tr({action:a.type,entity:a.entity,entityId:a.entityId,success:!1,error:i.message})}}return console.log(` Applied: ${t.applied}, Skipped: ${t.skipped}, Errors: ${t.errors.length}`),t},Lm=async e=>{var r;let t=0;console.log(" Starting direct data pull...",e?`for project: ${e}`:"all data"),Tr({action:"PULL_START",success:!0,data:{projectId:e}});try{const n=await ra.getProjects(),s=n.data||n;if(Array.isArray(s)){await Se.transaction("rw",Se.projects,async()=>{for(const i of s){if(e&&Qo(i.id)!==Qo(e))continue;const o=ns("project",i.id);await Se.projects.put({...i,id:o,userId:i.userId?ns("user",i.userId):i.userId}),t++}});const a=e?s.filter(i=>Qo(i.id)===Qo(e)):s;for(const i of a){const o=Qo(i.id),c=ns("project",o);try{const f=await ra.getBordereaux(o),u=f.data||f;Array.isArray(u)&&u.length>0&&await Se.transaction("rw",Se.bordereaux,async()=>{for(const p of u)await Se.bordereaux.put({...p,id:ns("bordereau",p.id),projectId:c}),t++})}catch{console.log("No bordereaux for project:",o)}try{const f=await((r=ra.getPeriodes)==null?void 0:r.call(ra,o)),u=(f==null?void 0:f.data)||f;Array.isArray(u)&&u.length>0&&await Se.transaction("rw",Se.periodes,async()=>{for(const p of u)await Se.periodes.put({...p,id:ns("periode",p.id),projectId:c}),t++})}catch{console.log("No periodes for project:",o)}try{const f=await ra.getMetres(o),u=f.data||f;Array.isArray(u)&&u.length>0&&await Se.transaction("rw",Se.metres,async()=>{for(const p of u)await Se.metres.put({...p,id:ns("metre",p.id),projectId:c,periodeId:p.periodeId?ns("periode",p.periodeId):""}),t++})}catch{console.log("No metres for project:",o)}try{const f=await ra.getDecompts(o),u=f.data||f;Array.isArray(u)&&u.length>0&&await Se.transaction("rw",Se.decompts,async()=>{for(const p of u)await Se.decompts.put({...p,id:ns("decompt",p.id),projectId:c,periodeId:p.periodeId?ns("periode",p.periodeId):""}),t++})}catch{console.log("No decompts for project:",o)}}}Tr({action:"PULL_COMPLETE",success:!0,data:{totalPulled:t}}),console.log(` Direct pull complete: ${t} items`)}catch(n){throw console.error(" Direct pull error:",n),Tr({action:"PULL_ERROR",success:!1,error:n.message}),n}return t},T9=e=>{const[t,r]=me.useState({status:Yc()?"idle":"offline",lastSyncTime:GN()||null,pendingOperations:0,error:null,lastPullCount:0,realtimeConnected:!1}),[n,s]=me.useState(!0),a=me.useRef(!1),i=me.useRef(!1),o=me.useCallback(()=>{if(!e||i.current)return;const m=localStorage.getItem("authToken");if(!m)return;const g=k1();let y="http://localhost:3000";typeof window<"u"&&window.location.hostname!=="localhost"&&(y=window.location.origin),(window.navigator.userAgent.includes("Electron")||window.electronAPI)&&(y="http://162.55.219.151"),console.log(" Connecting to realtime server:",y),Jc.connect(y,m,g,e),i.current=!0;const v=Jc.onStatusChange(w=>{r(S=>({...S,realtimeConnected:w==="connected",status:w==="connected"?"realtime":S.status}))}),b=Jc.onOperation(w=>{console.log(" Realtime op in sync manager:",w.type,w.entity);const A={project:zo.PROJECT_UPDATED,bordereau:zo.BORDEREAU_UPDATED,periode:zo.PERIODE_UPDATED,metre:zo.METRE_UPDATED,decompt:zo.DECOMPT_UPDATED,photo:zo.PHOTO_UPDATED,pv:zo.PV_UPDATED,attachment:zo.ATTACHMENT_UPDATED}[w.entity];A&&tS.emit(A,{type:w.type,entityId:w.entityId,data:w.data}),tS.emit(zo.DATA_CHANGED,{entity:w.entity,type:w.type,entityId:w.entityId,data:w.data})});return()=>{v(),b()}},[e]),c=me.useCallback(async()=>{if(e)try{const m=await Se.syncOperations.where("synced").equals(0).count();r(g=>({...g,pendingOperations:m}))}catch(m){console.error("Error updating pending count:",m)}},[e]),f=me.useCallback(async()=>{var m,g;if(!e||!Yc()){console.log(" Cannot push: user not authenticated or offline");return}console.log(" [v3] Starting sync push..."),Tr({action:"PUSH_START",success:!0});try{const y=await Se.syncOperations.filter(A=>!A.synced&&A.userId===e).toArray();if(y.length===0){console.log(" No pending operations");return}console.log(` Found ${y.length} pending operations`);const v=y.map(A=>({id:A.id,type:A.type,entity:A.entity,entityId:Qo(A.entityId),data:A.data,timestamp:A.timestamp})),b=await ra.syncPush(v,k1());console.log(" Server response:",b);const w=((m=b.data)==null?void 0:m.success)||b.success||[];if(Array.isArray(w)&&w.length>0){const A=y.filter(F=>w.includes(F.id)||w.includes(Qo(F.entityId))).map(F=>F.id);A.length>0&&await Se.transaction("rw",Se.syncOperations,async()=>{for(const F of A)await Se.syncOperations.update(F,{synced:!0,syncedAt:new Date().toISOString()})})}const S=((g=b.data)==null?void 0:g.failed)||b.failed||[];S.length>0&&(console.error(" Some operations failed:",S),Tr({action:"PUSH_ERRORS",success:!1,data:{errors:S}})),Tr({action:"PUSH_COMPLETE",success:!0,data:{pushed:w.length}})}catch(y){throw console.error(" Push error:",y),Tr({action:"PUSH_ERROR",success:!1,error:y.message}),y}},[e]),u=me.useCallback(async()=>{var m,g,y;if(!e||!Yc()){console.log(" Cannot pull: user not authenticated or offline");return}console.log(" [v3] Starting sync pull..."),r(v=>({...v,status:"pulling"})),Tr({action:"PULL_START",success:!0});try{const v=GN(),b=await ra.syncPull(v,k1());console.log(" Pull response received");const w=((m=b.data)==null?void 0:m.operations)||b.operations||[],S=((g=b.data)==null?void 0:g.serverTime)||b.serverTime||Date.now();if(w.length===0&&v===0){console.log(" No sync operations, performing direct fetch...");const A=await Lm();r(F=>({...F,lastPullCount:A}))}else if(w.length>0){const A=await A9(w);r(F=>({...F,lastPullCount:A.applied})),A.errors.length>0&&console.error(" Some operations failed to apply:",A.errors)}YN(S),Tr({action:"PULL_COMPLETE",success:!0})}catch(v){if(console.error(" Pull error:",v),Tr({action:"PULL_ERROR",success:!1,error:v.message}),((y=v.response)==null?void 0:y.status)!==401)throw v}},[e]),p=me.useCallback(async()=>{if(a.current){console.log(" Sync already in progress");return}if(!e||!Yc()){r(m=>({...m,status:"offline",error:"Cannot sync while offline"}));return}a.current=!0,r(m=>({...m,status:"syncing",error:null}));try{await f(),await u(),await c();const m=new Date;m.setDate(m.getDate()-30),await Se.syncOperations.where("syncedAt").below(m.toISOString()).delete(),r(g=>({...g,status:"synced",lastSyncTime:Date.now(),error:null})),Tr({action:"SYNC_COMPLETE",success:!0})}catch(m){r(g=>({...g,status:"error",error:m.message||"Sync failed"})),Tr({action:"SYNC_ERROR",success:!1,error:m.message})}finally{a.current=!1}},[e,f,u,c]);me.useEffect(()=>AM(()=>{r(v=>({...v,status:"idle"})),n&&setTimeout(()=>p(),1e3)},()=>{r(v=>({...v,status:"offline"}))}),[p,n]),me.useEffect(()=>{if(!n||!Yc())return;const m=setInterval(()=>{p().catch(console.error)},5*60*1e3);return()=>clearInterval(m)},[p,n]),me.useEffect(()=>{c()},[c]),me.useEffect(()=>{if(e&&Yc()){const m=o();return()=>{m&&m(),i.current=!1}}},[e,o]),me.useEffect(()=>{const m=()=>{e&&!Jc.isConnected()&&(console.log(" Back online, reconnecting realtime..."),o())};return window.addEventListener("online",m),()=>window.removeEventListener("online",m)},[e,o]);const d=me.useCallback(async()=>{try{const m=await Se.syncOperations.filter(y=>y.synced===!1||y.synced===void 0).toArray();if(m.length===0)return console.log(" No pending operations to clear"),{cleared:0};console.log(` Clearing ${m.length} pending operations...`);const g=m.map(y=>y.id).filter(y=>y!=null);return await Se.syncOperations.bulkDelete(g),r(y=>({...y,pendingOperations:0,error:null,status:"idle"})),console.log(` Cleared ${m.length} pending operations`),{cleared:m.length}}catch(m){return console.error(" Failed to clear pending operations:",m),{cleared:0,error:m.message}}},[]),h=me.useCallback(async()=>{if(e)try{console.log(" Starting full reset and resync..."),await d(),YN(0),await Lm(),console.log(" Reset and resync completed")}catch(m){console.error(" Reset and resync failed:",m)}},[e,d,Lm]);return{syncState:t,sync:p,syncPush:f,syncPull:u,pullLatestData:Lm,updatePendingCount:c,autoSyncEnabled:n,setAutoSyncEnabled:s,isOnline:Yc(),isRealtimeConnected:t.realtimeConnected,connectRealtime:o,disconnectRealtime:()=>Jc.disconnect(),subscribeToProject:m=>Jc.subscribeToProject(m),unsubscribeFromProject:m=>Jc.unsubscribeFromProject(m),clearPendingOperations:d,resetAndResync:h,getSyncLogs:_9,clearSyncLogs:k9,inspectSync:()=>e?E9():Promise.resolve({localCounts:{},missingEntities:[],orphanedEntities:[],errors:["No user ID"]})}},sT=zj(e=>({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null,currentVersion:"",setUpdateAvailable:t=>e({isUpdateAvailable:!0,updateInfo:t,error:null}),setDownloading:t=>e({isDownloading:t}),setDownloadProgress:t=>e({downloadProgress:t}),setUpdateDownloaded:t=>e({isUpdateDownloaded:!0,isDownloading:!1,downloadProgress:null}),setError:t=>e({error:t,isDownloading:!1}),setCurrentVersion:t=>e({currentVersion:t}),reset:()=>e({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null})}));function C9(){const{setUpdateAvailable:e,setDownloadProgress:t,setUpdateDownloaded:r,setError:n,setCurrentVersion:s}=sT();me.useEffect(()=>{if(!window.electron){console.log("Not running in Electron, auto-updater disabled");return}window.electron.getAppVersion().then(u=>{s(u),console.log("Current app version:",u)});const a=window.electron.onUpdateAvailable(u=>{console.log("Update available:",u),e(u)}),i=window.electron.onUpdateNotAvailable(u=>{console.log("No updates available, current version:",u.version)}),o=window.electron.onDownloadProgress(u=>{console.log("Download progress:",u.percent+"%"),t(u)}),c=window.electron.onUpdateDownloaded(u=>{console.log("Update downloaded:",u.version),r(u)}),f=window.electron.onUpdateError(u=>{console.error("Update error:",u.message),n(u.message)});return()=>{a(),i(),o(),c(),f()}},[e,t,r,n,s])}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var P9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),st=(e,t)=>{const r=me.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:c,...f},u)=>me.createElement("svg",{ref:u,...P9,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${F9(e)}`,o].join(" "),...f},[...t.map(([p,d])=>me.createElement(p,d)),...Array.isArray(c)?c:[c]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=st("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=st("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $h=st("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=st("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=st("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=st("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=st("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aT=st("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=st("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=st("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=st("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=st("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R9=st("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=st("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=st("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=st("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wg=st("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=st("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qu=st("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=st("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=st("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=st("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=st("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=st("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=st("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sw=st("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dm=st("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=st("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=st("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=st("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=st("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=st("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q9=st("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iT=st("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=st("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J2=st("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W9=st("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V9=st("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K9=st("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G9=st("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y9=st("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Om=st("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=st("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=st("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X9=st("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=st("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J9=st("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=st("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zh=st("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q9=st("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=st("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=st("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kw=st("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=st("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bg=st("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=st("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=st("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=st("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aa=st("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=st("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nb=st("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=st("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ew=st("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=st("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=st("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oT=st("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vo=st("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=st("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),oB=()=>{const{t:e}=Mi(),t=Gn(),{login:r,isLoading:n,error:s}=Yr(),[a,i]=me.useState({email:"",password:""}),o=async c=>{c.preventDefault();try{await r(a.email,a.password),t("/")}catch{}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:l.jsx("div",{className:"w-full max-w-md",children:l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("app.title")}),l.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),l.jsxs("form",{onSubmit:o,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),l.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:c=>i({...a,email:c.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),l.jsx("input",{id:"password",type:"password",required:!0,className:"input",value:a.password,onChange:c=>i({...a,password:c.target.value})})]}),s&&l.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),l.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?l.jsx("span",{children:e("common.loading")}):l.jsxs(l.Fragment,{children:[l.jsx(V9,{className:"w-5 h-5"}),l.jsx("span",{children:e("auth.login")})]})})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[l.jsx("p",{className:"font-medium mb-1",children:"Accs restreint"}),l.jsx("p",{className:"text-xs",children:"Les comptes utilisateurs sont crs uniquement par l'administrateur systme. Pour demander un accs, veuillez contacter votre administrateur."})]})})]})})})},lB=()=>{const{t:e}=Mi(),t=Gn(),{register:r,isLoading:n,error:s}=Yr(),[a,i]=me.useState({email:"",password:"",firstName:"",lastName:""}),o=async c=>{c.preventDefault();try{await r(a),t("/")}catch{}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:l.jsx("div",{className:"w-full max-w-md",children:l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("auth.register")}),l.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),l.jsxs("form",{onSubmit:o,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.firstName")}),l.jsx("input",{id:"firstName",type:"text",required:!0,className:"input",value:a.firstName,onChange:c=>i({...a,firstName:c.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.lastName")}),l.jsx("input",{id:"lastName",type:"text",required:!0,className:"input",value:a.lastName,onChange:c=>i({...a,lastName:c.target.value})})]})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),l.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:c=>i({...a,email:c.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),l.jsx("input",{id:"password",type:"password",required:!0,minLength:6,className:"input",value:a.password,onChange:c=>i({...a,password:c.target.value})})]}),s&&l.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),l.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?l.jsx("span",{children:e("common.loading")}):l.jsxs(l.Fragment,{children:[l.jsx(nB,{className:"w-5 h-5"}),l.jsx("span",{children:e("auth.register")})]})})]}),l.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[e("auth.login")," ",l.jsx(Ai,{to:"/login",className:"text-primary-600 hover:text-primary-700 font-medium",children:e("auth.login")})]})]})})})};function cB(e,t,r){var n,s;typeof e=="function"?(n=t||[],s=r):(n=[],s=t);var a=Wl.useRef({hasResult:!1,result:s,error:null}),i=Wl.useReducer(function(f){return f+1},0);i[0];var o=i[1],c=Wl.useMemo(function(){var f=typeof e=="function"?e():e;if(!f||typeof f.subscribe!="function")throw e===f?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!a.current.hasResult&&typeof window<"u"&&(typeof f.hasValue!="function"||f.hasValue()))if(typeof f.getValue=="function")a.current.result=f.getValue(),a.current.hasResult=!0;else{var u=f.subscribe(function(p){a.current.result=p,a.current.hasResult=!0});typeof u=="function"?u():u.unsubscribe()}return f},n);if(Wl.useDebugValue(a.current.result),Wl.useEffect(function(){var f=c.subscribe(function(u){var p=a.current;(p.error!==null||p.result!==u)&&(p.error=null,p.result=u,p.hasResult=!0,o())},function(u){var p=a.current;p.error!==u&&(p.error=u,o())});return typeof f=="function"?f:f.unsubscribe.bind(f)},n),a.current.error)throw a.current.error;return a.current.result}function $t(e,t,r){return cB(function(){return HA(e)},t||[],r)}function Ks(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function yo(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function uB(e,t){const r=Ks(e);return isNaN(t)?yo(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function L0(e,t){const r=Ks(e);if(isNaN(t))return yo(e,NaN);if(!t)return r;const n=r.getDate(),s=yo(e,r.getTime());s.setMonth(r.getMonth()+t+1,0);const a=s.getDate();return n>=a?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}const lT=6048e5,fB=864e5,cT=6e4,uT=36e5;let dB={};function Sx(){return dB}function qh(e,t){var o,c,f,u;const r=Sx(),n=(t==null?void 0:t.weekStartsOn)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.weekStartsOn)??r.weekStartsOn??((u=(f=r.locale)==null?void 0:f.options)==null?void 0:u.weekStartsOn)??0,s=Ks(e),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function Ng(e){return qh(e,{weekStartsOn:1})}function fT(e){const t=Ks(e),r=t.getFullYear(),n=yo(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=Ng(n),a=yo(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const i=Ng(a);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function lS(e){const t=Ks(e);return t.setHours(0,0,0,0),t}function cS(e){const t=Ks(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function dT(e,t){const r=lS(e),n=lS(t),s=+r-cS(r),a=+n-cS(n);return Math.round((s-a)/fB)}function hB(e){const t=fT(e),r=yo(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Ng(r)}function pB(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Sg(e){if(!pB(e)&&typeof e!="number")return!1;const t=Ks(e);return!isNaN(Number(t))}function _i(e,t){const r=Ks(e),n=Ks(t),s=uS(r,n),a=Math.abs(dT(r,n));r.setDate(r.getDate()-s*a);const i=+(uS(r,n)===-s),o=s*(a-i);return o===0?0:o}function uS(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function mB(e){const t=Ks(e),r=yo(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const gB={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xB=(e,t,r)=>{let n;const s=gB[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Yf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const vB={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yB={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wB={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},bB={date:Yf({formats:vB,defaultWidth:"full"}),time:Yf({formats:yB,defaultWidth:"full"}),dateTime:Yf({formats:wB,defaultWidth:"full"})},NB={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},SB=(e,t,r,n)=>NB[e];function lo(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[i]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const _B={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},kB={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},EB={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},jB={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},AB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},TB={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},CB=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},PB={ordinalNumber:CB,era:lo({values:_B,defaultWidth:"wide"}),quarter:lo({values:kB,defaultWidth:"wide",argumentCallback:e=>e-1}),month:lo({values:EB,defaultWidth:"wide"}),day:lo({values:jB,defaultWidth:"wide"}),dayPeriod:lo({values:AB,defaultWidth:"wide",formattingValues:TB,defaultFormattingWidth:"wide"})};function co(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const i=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?LB(o,p=>p.test(i)):FB(o,p=>p.test(i));let f;f=e.valueCallback?e.valueCallback(c):c,f=r.valueCallback?r.valueCallback(f):f;const u=t.slice(i.length);return{value:f,rest:u}}}function FB(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function LB(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function hT(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let i=e.valueCallback?e.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(s.length);return{value:i,rest:o}}}const DB=/^(\d+)(th|st|nd|rd)?/i,OB=/\d+/i,RB={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},IB={any:[/^b/i,/^(a|c)/i]},MB={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},BB={any:[/1/i,/2/i,/3/i,/4/i]},UB={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$B={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},zB={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},qB={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},HB={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},WB={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},VB={ordinalNumber:hT({matchPattern:DB,parsePattern:OB,valueCallback:e=>parseInt(e,10)}),era:co({matchPatterns:RB,defaultMatchWidth:"wide",parsePatterns:IB,defaultParseWidth:"any"}),quarter:co({matchPatterns:MB,defaultMatchWidth:"wide",parsePatterns:BB,defaultParseWidth:"any",valueCallback:e=>e+1}),month:co({matchPatterns:UB,defaultMatchWidth:"wide",parsePatterns:$B,defaultParseWidth:"any"}),day:co({matchPatterns:zB,defaultMatchWidth:"wide",parsePatterns:qB,defaultParseWidth:"any"}),dayPeriod:co({matchPatterns:HB,defaultMatchWidth:"any",parsePatterns:WB,defaultParseWidth:"any"})},KB={code:"en-US",formatDistance:xB,formatLong:bB,formatRelative:SB,localize:PB,match:VB,options:{weekStartsOn:0,firstWeekContainsDate:1}};function GB(e){const t=Ks(e);return dT(t,mB(t))+1}function YB(e){const t=Ks(e),r=+Ng(t)-+hB(t);return Math.round(r/lT)+1}function pT(e,t){var u,p,d,h;const r=Ks(e),n=r.getFullYear(),s=Sx(),a=(t==null?void 0:t.firstWeekContainsDate)??((p=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??s.firstWeekContainsDate??((h=(d=s.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,i=yo(e,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=qh(i,t),c=yo(e,0);c.setFullYear(n,0,a),c.setHours(0,0,0,0);const f=qh(c,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=f.getTime()?n:n-1}function XB(e,t){var o,c,f,u;const r=Sx(),n=(t==null?void 0:t.firstWeekContainsDate)??((c=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:c.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(f=r.locale)==null?void 0:f.options)==null?void 0:u.firstWeekContainsDate)??1,s=pT(e,t),a=yo(e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),qh(a,t)}function JB(e,t){const r=Ks(e),n=+qh(r,t)-+XB(r,t);return Math.round(n/lT)+1}function gr(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Rl={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return gr(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):gr(r+1,2)},d(e,t){return gr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return gr(e.getHours()%12||12,t.length)},H(e,t){return gr(e.getHours(),t.length)},m(e,t){return gr(e.getMinutes(),t.length)},s(e,t){return gr(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return gr(s,t.length)}},hf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},fS={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Rl.y(e,t)},Y:function(e,t,r,n){const s=pT(e,n),a=s>0?s:1-s;if(t==="YY"){const i=a%100;return gr(i,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):gr(a,t.length)},R:function(e,t){const r=fT(e);return gr(r,t.length)},u:function(e,t){const r=e.getFullYear();return gr(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return gr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return gr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Rl.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return gr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=JB(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):gr(s,t.length)},I:function(e,t,r){const n=YB(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):gr(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Rl.d(e,t)},D:function(e,t,r){const n=GB(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):gr(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return gr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return gr(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return gr(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=hf.noon:n===0?s=hf.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=hf.evening:n>=12?s=hf.afternoon:n>=4?s=hf.morning:s=hf.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Rl.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Rl.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):gr(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):gr(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Rl.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Rl.s(e,t)},S:function(e,t){return Rl.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return hS(n);case"XXXX":case"XX":return eu(n);case"XXXXX":case"XXX":default:return eu(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return hS(n);case"xxxx":case"xx":return eu(n);case"xxxxx":case"xxx":default:return eu(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+dS(n,":");case"OOOO":default:return"GMT"+eu(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+dS(n,":");case"zzzz":default:return"GMT"+eu(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return gr(n,t.length)},T:function(e,t,r){const n=e.getTime();return gr(n,t.length)}};function dS(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+gr(a,2)}function hS(e,t){return e%60===0?(e>0?"-":"+")+gr(Math.abs(e)/60,2):eu(e,t)}function eu(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=gr(Math.trunc(n/60),2),a=gr(n%60,2);return r+s+t+a}const pS=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},mT=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},QB=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return pS(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",pS(n,t)).replace("{{time}}",mT(s,t))},ZB={p:mT,P:QB},eU=/^D+$/,tU=/^Y+$/,rU=["D","DD","YY","YYYY"];function nU(e){return eU.test(e)}function sU(e){return tU.test(e)}function aU(e,t,r){const n=iU(e,t,r);if(console.warn(n),rU.includes(e))throw new RangeError(n)}function iU(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const oU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cU=/^'([^]*?)'?$/,uU=/''/g,fU=/[a-zA-Z]/;function Vr(e,t,r){var u,p,d,h,m,g,y,v;const n=Sx(),s=(r==null?void 0:r.locale)??n.locale??KB,a=(r==null?void 0:r.firstWeekContainsDate)??((p=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((h=(d=n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((g=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((v=(y=n.locale)==null?void 0:y.options)==null?void 0:v.weekStartsOn)??0,o=Ks(e);if(!Sg(o))throw new RangeError("Invalid time value");let c=t.match(lU).map(b=>{const w=b[0];if(w==="p"||w==="P"){const S=ZB[w];return S(b,s.formatLong)}return b}).join("").match(oU).map(b=>{if(b==="''")return{isToken:!1,value:"'"};const w=b[0];if(w==="'")return{isToken:!1,value:dU(b)};if(fS[w])return{isToken:!0,value:b};if(w.match(fU))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");return{isToken:!1,value:b}});s.localize.preprocessor&&(c=s.localize.preprocessor(o,c));const f={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return c.map(b=>{if(!b.isToken)return b.value;const w=b.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&sU(w)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&nU(w))&&aU(w,t,String(e));const S=fS[w[0]];return S(o,w,s.localize,f)}).join("")}function dU(e){const t=e.match(cU);return t?t[1].replace(uU,"'"):e}function no(e,t){const n=gU(e);let s;if(n.date){const c=xU(n.date,2);s=vU(c.restDateString,c.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const a=s.getTime();let i=0,o;if(n.time&&(i=yU(n.time),isNaN(i)))return new Date(NaN);if(n.timezone){if(o=wU(n.timezone),isNaN(o))return new Date(NaN)}else{const c=new Date(a+i),f=new Date(0);return f.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),f.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),f}return new Date(a+i+o)}const Rm={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},hU=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,pU=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,mU=/^([+-])(\d{2})(?::?(\d{2}))?$/;function gU(e){const t={},r=e.split(Rm.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Rm.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Rm.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=Rm.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function xU(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function vU(e,t){if(t===null)return new Date(NaN);const r=e.match(hU);if(!r)return new Date(NaN);const n=!!r[4],s=N0(r[1]),a=N0(r[2])-1,i=N0(r[3]),o=N0(r[4]),c=N0(r[5])-1;if(n)return kU(t,o,c)?bU(t,o,c):new Date(NaN);{const f=new Date(0);return!SU(t,a,i)||!_U(t,s)?new Date(NaN):(f.setUTCFullYear(t,a,Math.max(s,i)),f)}}function N0(e){return e?parseInt(e):1}function yU(e){const t=e.match(pU);if(!t)return NaN;const r=Q2(t[1]),n=Q2(t[2]),s=Q2(t[3]);return EU(r,n,s)?r*uT+n*cT+s*1e3:NaN}function Q2(e){return e&&parseFloat(e.replace(",","."))||0}function wU(e){if(e==="Z")return 0;const t=e.match(mU);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return jU(n,s)?r*(n*uT+s*cT):NaN}function bU(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const NU=[31,null,31,30,31,30,31,31,30,31,30,31];function gT(e){return e%400===0||e%4===0&&e%100!==0}function SU(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(NU[t]||(gT(e)?29:28))}function _U(e,t){return t>=1&&t<=(gT(e)?366:365)}function kU(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function EU(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function jU(e,t){return t>=0&&t<=59}const AU=()=>{Mi();const{user:e}=Yr(),t=Gn(),r=$t(()=>Se.projects.where("userId").equals((e==null?void 0:e.id)||"").and(u=>!u.deletedAt).toArray(),[e==null?void 0:e.id]),n=$t(()=>Se.decompts.filter(u=>!u.deletedAt).toArray(),[]),s=$t(()=>Se.bordereaux.filter(u=>!u.deletedAt).toArray(),[]),a=me.useMemo(()=>{if(!r)return{totalProjects:0,activeProjects:0,completedProjects:0,totalBudget:0,totalRealized:0,averageProgress:0,projectsNeedingDecompte:0,upcomingDeadlines:0};const u=r.filter(v=>v.status==="active"),p=r.filter(v=>v.status==="completed"),d=(s==null?void 0:s.reduce((v,b)=>{const w=b.lignes.reduce((S,A)=>{const F=parseFloat(String(A.quantite))||0,T=parseFloat(String(A.prixUnitaire))||0;return S+F*T},0);return v+w*1.2},0))||0,h=(n==null?void 0:n.reduce((v,b)=>{const w=parseFloat(String(b.montantTotal))||0;return v+w},0))||0,m=u.length>0?u.reduce((v,b)=>v+(b.progress||0),0)/u.length:0,g=u.filter(v=>{const b=(n==null?void 0:n.filter(S=>S.projectId===v.id))||[];if(b.length===0)return!0;const w=b.sort((S,A)=>new Date(A.createdAt).getTime()-new Date(S.createdAt).getTime())[0];return _i(new Date,new Date(w.createdAt))>30}),y=u.filter(v=>{if(!v.osc||!v.delaisExecution)return!1;const b=L0(new Date(v.osc),v.delaisExecution),w=_i(b,new Date);return w<=30&&w>=0});return{totalProjects:r.length,activeProjects:u.length,completedProjects:p.length,totalBudget:d,totalRealized:h,averageProgress:Math.round(m),projectsNeedingDecompte:g.length,upcomingDeadlines:y.length}},[r,n,s]),i=me.useMemo(()=>{if(!r)return[];const u=[],p=new Date;return r.forEach(d=>{const h=d.id.replace("project:","");if(d.status==="active"&&d.osc&&d.delaisExecution){const m=L0(new Date(d.osc),d.delaisExecution),g=_i(p,m);g>0?u.push({id:`overdue-${d.id}`,type:"danger",icon:$h,title:`Dlai dpass de ${g} jours`,description:`${d.objet} (${d.marcheNo})`,action:{label:"Voir",path:`/projects/${h}`},projectId:d.id,priority:1}):g>-30&&u.push({id:`deadline-${d.id}`,type:"warning",icon:tB,title:`Fin de dlai dans ${Math.abs(g)} jours`,description:`${d.objet} (${d.marcheNo})`,action:{label:"Voir",path:`/projects/${h}`},projectId:d.id,priority:2})}if(d.status==="active"){const m=(n==null?void 0:n.filter(g=>g.projectId===d.id))||[];if(m.length===0)_i(p,new Date(d.createdAt))>15&&u.push({id:`no-decompte-${d.id}`,type:"warning",icon:ka,title:"Aucun dcompte cr",description:`${d.objet}`,action:{label:"Crer",path:`/projects/${h}`},projectId:d.id,priority:2});else{const g=m.sort((v,b)=>new Date(b.createdAt).getTime()-new Date(v.createdAt).getTime())[0],y=_i(p,new Date(g.createdAt));y>30&&u.push({id:`old-decompte-${d.id}`,type:"info",icon:oS,title:`Dcompte ancien (${y}j)`,description:`${d.objet}`,action:{label:"Nouveau",path:`/projects/${h}`},projectId:d.id,priority:3})}}if(d.dateReceptionProvisoire&&!d.dateReceptionDefinitive){const m=new Date(d.dateReceptionProvisoire),g=L0(m,12),y=_i(g,p);y<=30&&y>=0&&u.push({id:`garantie-${d.id}`,type:"warning",icon:bg,title:`Fin garantie dans ${y}j`,description:`${d.objet}`,action:{label:"Planifier",path:`/projects/${h}/edit`},projectId:d.id,priority:2})}d.status==="active"&&((s==null?void 0:s.filter(g=>g.projectId===d.id))||[]).length===0&&u.push({id:`no-bordereau-${d.id}`,type:"danger",icon:Sr,title:"Bordereau manquant",description:`${d.objet}`,action:{label:"Crer",path:`/projects/${h}`},projectId:d.id,priority:1})}),u.sort((d,h)=>d.priority-h.priority)},[r,n,s]),o=me.useMemo(()=>r?r.filter(u=>u.status==="active").map(u=>{const d=((n==null?void 0:n.filter(v=>v.projectId===u.id))||[]).sort((v,b)=>new Date(b.createdAt).getTime()-new Date(v.createdAt).getTime())[0],m=((s==null?void 0:s.filter(v=>v.projectId===u.id))||[]).reduce((v,b)=>{const w=b.lignes.reduce((S,A)=>S+A.quantite*(A.prixUnitaire||0),0);return v+w*1.2},0);let g="normal",y="";if(u.osc&&u.delaisExecution){const v=L0(new Date(u.osc),u.delaisExecution),b=_i(v,new Date);b<0?(g="critical",y=`Retard ${Math.abs(b)}j`):b<15?(g="high",y=`${b}j restants`):b<30&&(g="medium",y=`${b}j restants`)}return{...u,lastDecompte:d,urgency:g,reason:y,montantTTC:m}}).sort((u,p)=>{const d={critical:0,high:1,medium:2,normal:3};return(d[u.urgency]||3)-(d[p.urgency]||3)}).slice(0,8):[],[r,n,s]),c=u=>({danger:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800"})[u],f=u=>({danger:"text-red-500",warning:"text-yellow-500",info:"text-blue-500",success:"text-green-500"})[u];return l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord"}),l.jsxs("p",{className:"text-gray-600 mt-1",children:["Bienvenue, ",e==null?void 0:e.firstName," ! Voici l'tat de vos projets."]})]}),l.jsxs(Ai,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-5 h-5"}),"Nouveau projet"]})]}),i.length>0&&l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(O9,{className:"w-5 h-5 text-gray-700"}),l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Alertes (",i.length,")"]})]}),l.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:i.slice(0,4).map(u=>{const p=u.icon;return l.jsxs("div",{className:`p-4 rounded-lg border ${c(u.type)} flex items-start gap-3`,children:[l.jsx(p,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${f(u.type)}`}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium",children:u.title}),l.jsx("p",{className:"text-sm opacity-80 truncate",children:u.description})]}),u.action&&l.jsxs(Ai,{to:u.action.path,className:"flex-shrink-0 text-sm font-medium hover:underline flex items-center gap-1",children:[u.action.label,l.jsx(Gf,{className:"w-4 h-4"})]})]},u.id)})}),i.length>4&&l.jsxs("p",{className:"text-sm text-gray-500",children:["+ ",i.length-4," autres alertes"]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-500 rounded-xl text-white",children:l.jsx(Du,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-700",children:"Total projets"}),l.jsx("p",{className:"text-2xl font-bold text-blue-900",children:a.totalProjects})]})]})}),l.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-500 rounded-xl text-white",children:l.jsx(xo,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-green-700",children:"En cours"}),l.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.activeProjects})]})]})}),l.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-500 rounded-xl text-white",children:l.jsx(eB,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-purple-700",children:"Progression"}),l.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[a.averageProgress,"%"]})]})]})}),l.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-orange-500 rounded-xl text-white",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-orange-700",children:"Budget"}),l.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[isNaN(a.totalBudget)||a.totalBudget===0?"0":(a.totalBudget/1e6).toFixed(1),"M"]})]})]})})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[l.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:l.jsx(Qa,{className:"w-5 h-5 text-red-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.upcomingDeadlines}),l.jsx("p",{className:"text-xs text-gray-500",children:"Dlais proches"})]})]}),l.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[l.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:l.jsx(oS,{className:"w-5 h-5 text-yellow-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.projectsNeedingDecompte}),l.jsx("p",{className:"text-xs text-gray-500",children:"Besoins dcompte"})]})]}),l.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[l.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:l.jsx(Fa,{className:"w-5 h-5 text-green-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.completedProjects}),l.jsx("p",{className:"text-xs text-gray-500",children:"Termins"})]})]}),l.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(ka,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[isNaN(a.totalRealized)||a.totalRealized===0?"0":(a.totalRealized/1e6).toFixed(1),"M"]}),l.jsx("p",{className:"text-xs text-gray-500",children:"Ralis"})]})]})]}),l.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-2 card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[l.jsx(iB,{className:"w-5 h-5 text-yellow-500"}),"Mes projets"]}),l.jsx(Ai,{to:"/projects",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Voir tout"})]}),!r||r.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Du,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-500 mb-3",children:"Aucun projet"}),l.jsxs(Ai,{to:"/projects/new",className:"btn btn-primary btn-sm inline-flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Crer un projet"]})]}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-blue-50 border-y border-blue-200",children:[l.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"N March"}),l.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Objet"}),l.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"CT"}),l.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Titulaire du march"}),l.jsx("th",{className:"py-2 px-3 text-right font-semibold text-blue-900",children:"Montant march DH"}),l.jsx("th",{className:"py-2 px-3 text-center font-semibold text-blue-900",children:"Dlai du march"})]})}),l.jsx("tbody",{children:o.map((u,p)=>l.jsxs("tr",{onClick:()=>t(`/projects/${u.id.replace("project:","")}`),className:`border-b border-gray-200 hover:bg-blue-50 cursor-pointer transition-colors ${p%2===0?"bg-white":"bg-gray-50"}`,children:[l.jsx("td",{className:"py-3 px-3 font-medium text-gray-900",children:u.marcheNo}),l.jsx("td",{className:"py-3 px-3 text-gray-700 max-w-xs",children:l.jsx("p",{className:"line-clamp-2",children:u.objet})}),l.jsx("td",{className:"py-3 px-3 text-gray-600",children:u.commune||"-"}),l.jsx("td",{className:"py-3 px-3 text-gray-600",children:u.societe||"-"}),l.jsx("td",{className:"py-3 px-3 text-right font-medium text-gray-900",children:u.montantTTC>0?u.montantTTC.toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),l.jsx("td",{className:"py-3 px-3 text-center text-gray-600",children:u.delaisExecution?`${String(u.delaisExecution).padStart(2,"0")} Mois`:"-"})]},u.id))})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rsum financier"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Budget total"}),l.jsxs("span",{className:"font-medium",children:[(a.totalBudget/1e6).toFixed(2)," M DH"]})]}),l.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:"100%"}})})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Montant ralis"}),l.jsxs("span",{className:"font-medium",children:[(a.totalRealized/1e6).toFixed(2)," M DH"]})]}),l.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${a.totalBudget>0?a.totalRealized/a.totalBudget*100:0}%`}})})]}),l.jsx("div",{className:"pt-3 border-t border-gray-100",children:l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Reste  raliser"}),l.jsxs("span",{className:"font-medium text-orange-600",children:[((a.totalBudget-a.totalRealized)/1e6).toFixed(2)," M DH"]})]})}),l.jsx("div",{className:"pt-3 border-t border-gray-100",children:l.jsxs("div",{className:"flex justify-between text-sm",children:[l.jsx("span",{className:"text-gray-600",children:"Taux de ralisation"}),l.jsxs("span",{className:`font-bold ${a.totalBudget>0&&a.totalRealized/a.totalBudget>=.7?"text-green-600":a.totalBudget>0&&a.totalRealized/a.totalBudget>=.4?"text-yellow-600":"text-red-600"}`,children:[a.totalBudget>0?(a.totalRealized/a.totalBudget*100).toFixed(1):0,"%"]})]})}),l.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Rpartition des projets"}),l.jsxs("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:[a.activeProjects>0&&l.jsx("div",{className:"bg-green-500",style:{width:`${a.activeProjects/a.totalProjects*100}%`},title:`En cours: ${a.activeProjects}`}),a.completedProjects>0&&l.jsx("div",{className:"bg-blue-500",style:{width:`${a.completedProjects/a.totalProjects*100}%`},title:`Termins: ${a.completedProjects}`}),a.totalProjects-a.activeProjects-a.completedProjects>0&&l.jsx("div",{className:"bg-gray-300",style:{width:`${(a.totalProjects-a.activeProjects-a.completedProjects)/a.totalProjects*100}%`},title:"Autres"})]}),l.jsxs("div",{className:"flex gap-4 mt-2 text-xs",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"En cours (",a.activeProjects,")"]}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Termins (",a.completedProjects,")"]})]})]})]})]})]})]})},TU=()=>{const{t:e}=Mi(),{user:t}=Yr(),r=Gn(),[n,s]=me.useState(""),[a,i]=me.useState("all"),[o,c]=me.useState("all"),[f,u]=me.useState("grid"),p=$t(()=>Se.projects.where("userId").equals((t==null?void 0:t.id)||"").and(S=>!S.deletedAt).toArray(),[t==null?void 0:t.id]),d=$t(()=>Se.bordereaux.where("userId").equals((t==null?void 0:t.id)||"").and(S=>!S.deletedAt).toArray(),[t==null?void 0:t.id]),h=S=>{if(!d)return 0;const A=d.find(T=>T.projectId===S);return A?A.lignes.reduce((T,O)=>T+O.quantite*(O.prixUnitaire||0),0)*1.2:0},m=Array.from(new Set((p==null?void 0:p.map(S=>S.annee))||[])).sort().reverse(),g=p==null?void 0:p.filter(S=>{var O;const A=S.objet.toLowerCase().includes(n.toLowerCase())||S.marcheNo.toLowerCase().includes(n.toLowerCase())||((O=S.societe)==null?void 0:O.toLowerCase().includes(n.toLowerCase())),F=a==="all"||S.status===a,T=o==="all"||S.annee===o;return A&&F&&T}),y=async(S,A)=>{if(A.preventDefault(),A.stopPropagation(),!t||!confirm("tes-vous sr de vouloir supprimer ce projet?"))return;const F=await Se.projects.get(S);F&&(await Se.projects.update(S,{deletedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),await mn("DELETE","project",S.replace("project:",""),F,t.id))},v={total:(g==null?void 0:g.length)||0,active:(g==null?void 0:g.filter(S=>S.status==="active").length)||0,completed:(g==null?void 0:g.filter(S=>S.status==="completed").length)||0,draft:(g==null?void 0:g.filter(S=>S.status==="draft").length)||0,totalBudget:(g==null?void 0:g.reduce((S,A)=>S+h(A.id),0))||0},b=S=>{switch(S){case"active":return l.jsx(xo,{className:"w-4 h-4"});case"completed":return l.jsx(Fa,{className:"w-4 h-4"});case"archived":return l.jsx(D9,{className:"w-4 h-4"});default:return l.jsx(Sr,{className:"w-4 h-4"})}},w=S=>{switch(S){case"active":return"bg-green-100 text-green-700";case"completed":return"bg-blue-100 text-blue-700";case"archived":return"bg-gray-100 text-gray-700";default:return"bg-yellow-100 text-yellow-700"}};return l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.projects")}),l.jsxs("p",{className:"text-gray-600 mt-1",children:[v.total," ",v.total>1?"projets":"projet"]})]}),l.jsxs(Ai,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-5 h-5"}),e("project.newProject")]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(Du,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.total}),l.jsx("p",{className:"text-xs text-gray-600",children:"Total"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-green-100 text-green-600 rounded-lg",children:l.jsx(xo,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.active}),l.jsx("p",{className:"text-xs text-gray-600",children:"Actifs"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(Fa,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.completed}),l.jsx("p",{className:"text-xs text-gray-600",children:"Termins"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-yellow-100 text-yellow-600 rounded-lg",children:l.jsx(Sr,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.draft}),l.jsx("p",{className:"text-xs text-gray-600",children:"Brouillons"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(aa,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[(v.totalBudget/1e6).toFixed(1),"M"]}),l.jsx("p",{className:"text-xs text-gray-600",children:"MAD"})]})]})})]}),l.jsx("div",{className:"card mb-6",children:l.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(Nx,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),l.jsx("input",{type:"text",placeholder:"Rechercher (Objet, March, Socit...)",className:"input pl-10",value:n,onChange:S=>s(S.target.value)})]}),l.jsxs("select",{className:"input md:w-48",value:a,onChange:S=>i(S.target.value),children:[l.jsx("option",{value:"all",children:"Tous les statuts"}),l.jsx("option",{value:"draft",children:e("project.status.draft")}),l.jsx("option",{value:"active",children:e("project.status.active")}),l.jsx("option",{value:"completed",children:e("project.status.completed")}),l.jsx("option",{value:"archived",children:e("project.status.archived")})]}),l.jsxs("select",{className:"input md:w-32",value:o,onChange:S=>c(S.target.value),children:[l.jsx("option",{value:"all",children:"Toutes"}),m.map(S=>l.jsx("option",{value:S,children:S},S))]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>u("grid"),className:`p-2 rounded-lg border ${f==="grid"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:l.jsx(q9,{className:"w-5 h-5"})}),l.jsx("button",{onClick:()=>u("list"),className:`p-2 rounded-lg border ${f==="list"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:l.jsx(H9,{className:"w-5 h-5"})})]})]})}),!g||g.length===0?l.jsxs("div",{className:"card text-center py-12",children:[l.jsx(Du,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 mb-4",children:n||a!=="all"||o!=="all"?"Aucun rsultat trouv":"Aucun projet pour le moment"}),!n&&a==="all"&&o==="all"&&l.jsxs(Ai,{to:"/projects/new",className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Vs,{className:"w-5 h-5"}),e("project.newProject")]})]}):f==="grid"?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(S=>{const A=S.id.includes(":")?S.id.split(":").pop():S.id;return l.jsxs("div",{className:"card hover:shadow-lg transition-shadow relative group",children:[l.jsxs(Ai,{to:`/projects/${A}`,className:"block",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsx("h3",{className:"font-semibold text-lg text-gray-900 flex-1 pr-2 line-clamp-2",children:S.objet}),l.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full flex-shrink-0 ${w(S.status)}`,children:[b(S.status),e(`project.status.${S.status}`)]})]}),l.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"March:"}),l.jsx("span",{className:"font-medium",children:S.marcheNo})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Anne:"}),l.jsx("span",{className:"font-medium",children:S.annee})]}),S.societe&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Socit:"}),l.jsx("span",{className:"font-medium truncate ml-2",children:S.societe})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Montant (TTC):"}),l.jsxs("span",{className:"font-medium text-primary-600",children:[h(S.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),l.jsxs("div",{className:"flex justify-between text-xs",children:[l.jsx("span",{children:"Cr le:"}),l.jsx("span",{children:Vr(new Date(S.createdAt),"dd/MM/yyyy")})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[l.jsx("span",{children:e("project.progress")}),l.jsxs("span",{className:"font-medium",children:[S.progress,"%"]})]}),l.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${S.progress}%`}})})]})]}),l.jsxs("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2",children:[l.jsx("button",{onClick:F=>{F.preventDefault(),r(`/projects/${A}`)},className:"p-2 bg-white rounded-lg shadow-md hover:bg-primary-50 text-primary-600",title:"Voir",children:l.jsx(Nw,{className:"w-4 h-4"})}),l.jsx("button",{onClick:F=>y(S.id,F),className:"p-2 bg-white rounded-lg shadow-md hover:bg-red-50 text-red-600",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})]})]},S.id)})}):l.jsx("div",{className:"card overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{className:"border-b border-gray-200",children:[l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Objet"}),l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"March"}),l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Anne"}),l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Montant (TTC)"}),l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Statut"}),l.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Avancement"}),l.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:"Actions"})]})}),l.jsx("tbody",{children:g.map(S=>{const A=S.id.includes(":")?S.id.split(":").pop():S.id;return l.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/projects/${A}`),children:[l.jsxs("td",{className:"py-3 px-4",children:[l.jsx("div",{className:"font-medium text-gray-900",children:S.objet}),S.societe&&l.jsx("div",{className:"text-xs text-gray-500",children:S.societe})]}),l.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:S.marcheNo}),l.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:S.annee}),l.jsxs("td",{className:"py-3 px-4 text-sm font-medium text-primary-600",children:[h(S.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${w(S.status)}`,children:[b(S.status),e(`project.status.${S.status}`)]})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:"h-full bg-primary-500",style:{width:`${S.progress}%`}})}),l.jsxs("span",{className:"text-xs text-gray-600 w-10",children:[S.progress,"%"]})]})}),l.jsx("td",{className:"py-3 px-4 text-right",children:l.jsxs("div",{className:"flex items-center justify-end gap-2",children:[l.jsx("button",{onClick:F=>{F.stopPropagation(),r(`/projects/${A}`)},className:"p-1.5 hover:bg-primary-50 text-primary-600 rounded",title:"Voir",children:l.jsx(Nw,{className:"w-4 h-4"})}),l.jsx("button",{onClick:F=>y(S.id,F),className:"p-1.5 hover:bg-red-50 text-red-600 rounded",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})]})})]},S.id)})})]})})})]})},CU={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},PU=(e,t,r)=>{let n;const s=CU[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},FU={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},LU={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},DU={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},OU={date:Yf({formats:FU,defaultWidth:"full"}),time:Yf({formats:LU,defaultWidth:"full"}),dateTime:Yf({formats:DU,defaultWidth:"full"})},RU={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},IU=(e,t,r,n)=>RU[e],MU={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},BU={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},UU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},$U={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},zU={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},qU=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const s=["year","week","hour","minute","second"];let a;return r===1?a=n&&s.includes(n)?"re":"er":a="me",r+a},HU=["MMM","MMMM"],WU={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&HU.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:qU,era:lo({values:MU,defaultWidth:"wide"}),quarter:lo({values:BU,defaultWidth:"wide",argumentCallback:e=>e-1}),month:lo({values:UU,defaultWidth:"wide"}),day:lo({values:$U,defaultWidth:"wide"}),dayPeriod:lo({values:zU,defaultWidth:"wide"})},VU=/^(\d+)(ime|re|me|er|e)?/i,KU=/\d+/i,GU={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},YU={any:[/^av/i,/^ap/i]},XU={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},JU={any:[/1/i,/2/i,/3/i,/4/i]},QU={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},ZU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},e$={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},t$={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},r$={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},n$={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},s$={ordinalNumber:hT({matchPattern:VU,parsePattern:KU,valueCallback:e=>parseInt(e)}),era:co({matchPatterns:GU,defaultMatchWidth:"wide",parsePatterns:YU,defaultParseWidth:"any"}),quarter:co({matchPatterns:XU,defaultMatchWidth:"wide",parsePatterns:JU,defaultParseWidth:"any",valueCallback:e=>e+1}),month:co({matchPatterns:QU,defaultMatchWidth:"wide",parsePatterns:ZU,defaultParseWidth:"any"}),day:co({matchPatterns:e$,defaultMatchWidth:"wide",parsePatterns:t$,defaultParseWidth:"any"}),dayPeriod:co({matchPatterns:r$,defaultMatchWidth:"any",parsePatterns:n$,defaultParseWidth:"any"})},Ti={code:"fr",formatDistance:PU,formatLong:OU,formatRelative:IU,localize:WU,match:s$,options:{weekStartsOn:1,firstWeekContainsDate:4}},Hh=[{id:"DEB-001",code:"1.1",designation:"Dblais pour ouvrages excuts dans l'eau en terrain de toute nature y compris la roche et  toute profondeur LE METRE CUBE",unite:"M",prixReference:48,categorie:"Terrassement",tags:["dblais","eau","terrain","roche"]},{id:"FOU-001",code:"1.2",designation:"Fourniture et mise en place de gabions y compris cage, enrochement et terrassements LE METRE CUBE",unite:"M",prixReference:400,categorie:"Terrassement",tags:["fourniture","gabions","cage","enrochement"]},{id:"BET-001",code:"1.3",designation:"Gros bton dos  300kg/m3 de ciment CPJ 45 y compris coffrage et dcoffrage et toutes sujtions LE METRE CUBE",unite:"M",prixReference:753.5,categorie:"Bton",tags:["bton","ciment","coffrage","dcoffrage"]},{id:"REM-001",code:"1.4",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:30,categorie:"Terrassement",tags:["remblais","compact","ouvrages"]},{id:"DEB-002",code:"2.1",designation:"Dblais pour ouvrages et canaux excuts dans le lit de l'oued y compris rocher et terrassement dans l'eau toutes sujtions. LE METRE CUBE",unite:"M",prixReference:70,categorie:"Hydro-Agricole",tags:["dblais","canaux","oued","rocher"]},{id:"HER-001",code:"2.2",designation:"Hrissonnage de gros pierres sches poses  la main sur le sol et point en l'air  recopiissage  la pierre casse et fortement dame. LE METRE CARRE",unite:"M",prixReference:50,categorie:"Hydro-Agricole",tags:["hrissonnage","pierres","casse","dame"]},{id:"BET-002",code:"2.3",designation:"Bton pour bton arm dos  350kg/m3 de ciment CPJ 45 y compris coffrage, dcoffrage et toutes sujtions. LE METRE CUBE",unite:"M",prixReference:1150,categorie:"Bton",tags:["bton arm","ciment","coffrage"]},{id:"FOU-002",code:"2.4",designation:"Fourniture et pose des aciers mi-durs  haute adhrence pour armatures de tout diamtre y compris toutes sujtions de mise en dpts. LE KILOGRAMME",unite:"KG",prixReference:15,categorie:"Ferraillage",tags:["fourniture","aciers","armatures","adhrence"]},{id:"CUR-001",code:"2.5",designation:"Curage et reprofilage de khettaras LE METRE LINEAIRE",unite:"ML",prixReference:400,categorie:"Hydro-Agricole",tags:["curage","reprofilage","khettaras"]},{id:"REM-002",code:"2.6",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:40,categorie:"Terrassement",tags:["remblais","ordinaire","compact"]},{id:"JOI-001",code:"2.7",designation:"Joint de retrait ralis au moyen d'un produit bitumineux y compris toutes sujtions LE METRE LINEAIRE",unite:"ML",prixReference:100,categorie:"tanchit",tags:["joint","retrait","bitumineux"]},{id:"FOU-003",code:"2.8",designation:"Fourniture et pose de tle mtalliques pour vannette LE KILOGRAMME",unite:"KG",prixReference:60,categorie:"Mtallerie",tags:["fourniture","tle","vannette"]},{id:"MUR-001",code:"3.1",designation:"Mur en moellons de pierre y compris mortier et toutes sujtions LE METRE CUBE",unite:"M",prixReference:850,categorie:"Maonnerie",tags:["mur","moellons","pierre","mortier"]},{id:"END-001",code:"3.2",designation:"Enduit de ciment liss sur murs y compris toutes sujtions LE METRE CARRE",unite:"M",prixReference:45,categorie:"Finition",tags:["enduit","ciment","liss","murs"]},{id:"CHA-001",code:"4.1",designation:"Charpente mtallique y compris peinture antirouille LE KILOGRAMME",unite:"KG",prixReference:25,categorie:"Charpente",tags:["charpente","mtallique","peinture"]},{id:"TUI-001",code:"4.2",designation:"Tuiles mcaniques y compris pose et accessoires LE METRE CARRE",unite:"M",prixReference:120,categorie:"Couverture",tags:["tuiles","mcaniques","pose"]}],a$=["Terrassement","Bton","Ferraillage","Hydro-Agricole","Maonnerie","Finition","tanchit","Mtallerie","Charpente","Couverture"],i$=e=>{if(!e)return Hh;const t=e.toLowerCase();return Hh.filter(r=>r.designation.toLowerCase().includes(t)||r.code.includes(t)||r.categorie.toLowerCase().includes(t)||r.tags.some(n=>n.includes(t)))},o$=e=>Hh.filter(t=>t.categorie===e),xT=({bordereauId:e,onClose:t})=>{const{user:r}=Yr(),[n,s]=me.useState([]),[a,i]=me.useState(null),[o,c]=me.useState(""),[f,u]=me.useState(!1),[p,d]=me.useState(0),h=me.useRef({}),m=$t(()=>Se.bordereaux.get(e),[e]),g=o.length>=2?i$(o).slice(0,5):[];me.useEffect(()=>{m!=null&&m.lignes&&s(m.lignes)},[m]);const y=()=>{const k=n.reduce((D,V)=>D+V.montant,0),P=k*.2,q=k+P;return{montantHT:k,tva:P,montantTTC:q}},v=()=>{const k={id:Ir(),numero:n.length+1,designation:"",unite:"",quantite:0,prixUnitaire:0,montant:0};s([...n,k]),i(k.id),setTimeout(()=>{var P;(P=h.current[`designation-${k.id}`])==null||P.focus()},50)},b=(k,P,q)=>{s(D=>D.map(V=>{if(V.id===k){const se={...V,[P]:q};return(P==="quantite"||P==="prixUnitaire")&&(se.montant=se.quantite*se.prixUnitaire),se}return V}))},w=k=>{const q=n.filter(D=>D.id!==k).map((D,V)=>({...D,numero:V+1}));s(q)},S=k=>{if(!a||!g[k])return;const P=g[k];b(a,"designation",P.designation),b(a,"unite",P.unite),b(a,"prixUnitaire",P.prixReference),c(""),u(!1),d(0),setTimeout(()=>{var q;(q=h.current[`quantite-${a}`])==null||q.focus()},50)},A=(k,P,q)=>{q==="designation"&&f?k.key==="ArrowDown"?(k.preventDefault(),d(D=>Math.min(D+1,g.length-1))):k.key==="ArrowUp"?(k.preventDefault(),d(D=>Math.max(D-1,0))):k.key==="Enter"?(k.preventDefault(),S(p)):k.key==="Escape"&&(u(!1),c("")):k.key==="Enter"&&(k.preventDefault(),(q==="montant"||q==="prixUnitaire")&&v())},F=async()=>{if(!r||!m)return;const{montantHT:k}=y(),P={...m,lignes:n,montantTotal:k,updatedAt:new Date().toISOString()};await Se.bordereaux.update(e,P),await mn("UPDATE","bordereau",e.replace("bordereau:",""),P,r.id),alert("Bordereau enregistr avec succs !")},T=()=>{if(!m)return;const{montantHT:k,tva:P,montantTTC:q}=y();let D=`N,Dsignation des ouvrages,U,Quantit,Prix unitaire (MAD),Montant (MAD)
`;n.forEach(ne=>{D+=`${ne.numero},"${ne.designation}",${ne.unite},${ne.quantite},${ne.prixUnitaire},${ne.montant}
`}),D+=`
,,,Total HT:,,${k.toFixed(2)}
`,D+=`,,,TVA 20%:,,${P.toFixed(2)}
`,D+=`,,,Total TTC:,,${q.toFixed(2)}
`;const V=new Blob([D],{type:"text/csv;charset=utf-8;"}),se=document.createElement("a");se.href=URL.createObjectURL(V),se.download=`${m.reference}.csv`,se.click()};if(!m)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})});const{montantHT:O,tva:C,montantTTC:R}=y();return l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Ts,{className:"w-5 h-5"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m.reference}),l.jsx("p",{className:"text-sm text-gray-600",children:m.designation})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:T,className:"btn btn-secondary flex items-center gap-2",children:[l.jsx(qu,{className:"w-4 h-4"}),"Exporter CSV"]}),l.jsxs("button",{onClick:F,className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Fc,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50 border-b-2 border-gray-200",children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-16",children:"N"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Dsignation des ouvrages"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-24",children:"Unit"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-32",children:"Quantit"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Prix unitaire (MAD)"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Montant (MAD)"}),l.jsx("th",{className:"px-4 py-3 w-12"})]})}),l.jsx("tbody",{children:n.map(k=>l.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-2 text-gray-700",children:k.numero}),l.jsxs("td",{className:"px-4 py-2 relative",children:[l.jsx("input",{ref:P=>h.current[`designation-${k.id}`]=P,type:"text",value:a===k.id&&o||k.designation,onChange:P=>{const q=P.target.value;b(k.id,"designation",q),a===k.id&&(c(q),u(q.length>=2),d(0))},onFocus:()=>{i(k.id),c(k.designation),k.designation.length>=2&&u(!0)},onBlur:()=>{setTimeout(()=>{u(!1),i(null),c("")},200)},onKeyDown:P=>A(P,k.id,"designation"),className:"input text-sm w-full",placeholder:"Rechercher ou taper..."}),a===k.id&&f&&g.length>0&&l.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:g.map((P,q)=>l.jsxs("div",{onClick:()=>S(q),className:`px-4 py-2 cursor-pointer ${q===p?"bg-primary-50":"hover:bg-gray-50"}`,children:[l.jsx("div",{className:"font-medium text-sm text-gray-900",children:P.code}),l.jsx("div",{className:"text-xs text-gray-600 truncate",children:P.designation}),l.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[l.jsxs("span",{className:"font-medium text-primary-600",children:[P.prixReference," MAD"]}),l.jsx("span",{children:""}),l.jsx("span",{children:P.unite})]})]},P.id))})]}),l.jsx("td",{className:"px-2 py-2 w-24",children:l.jsxs("select",{value:k.unite||"",onChange:P=>b(k.id,"unite",P.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[l.jsx("option",{value:"",children:"--"}),l.jsx("option",{value:"M",children:"M"}),l.jsx("option",{value:"ML",children:"ML"}),l.jsx("option",{value:"M",children:"M"}),l.jsx("option",{value:"KG",children:"KG"}),l.jsx("option",{value:"T",children:"T"}),l.jsx("option",{value:"U",children:"U"}),l.jsx("option",{value:"ENS",children:"ENS"}),l.jsx("option",{value:"M",children:"M"}),l.jsx("option",{value:"FF",children:"FF"}),l.jsx("option",{value:"L",children:"L"})]})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{ref:P=>h.current[`quantite-${k.id}`]=P,type:"number",step:"0.01",value:k.quantite||"",onChange:P=>b(k.id,"quantite",parseFloat(P.target.value)||0),onKeyDown:P=>A(P,k.id,"quantite"),className:"input text-sm text-right w-full"})}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"number",step:"0.01",value:k.prixUnitaire||"",onChange:P=>b(k.id,"prixUnitaire",parseFloat(P.target.value)||0),onKeyDown:P=>A(P,k.id,"prixUnitaire"),className:"input text-sm text-right w-full"})}),l.jsx("td",{className:"px-4 py-2 text-right font-medium text-gray-900",children:k.montant.toFixed(2)}),l.jsx("td",{className:"px-4 py-2",children:l.jsx("button",{onClick:()=>w(k.id),className:"p-1 hover:bg-red-50 text-red-600 rounded transition-colors",children:l.jsx(fa,{className:"w-4 h-4"})})})]},k.id))}),l.jsx("tfoot",{children:l.jsx("tr",{children:l.jsx("td",{colSpan:7,className:"px-4 py-2",children:l.jsxs("button",{onClick:v,className:"flex items-center gap-2 text-primary-600 hover:text-primary-700 font-medium text-sm",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Ajouter une ligne"]})})})})]})}),l.jsx("div",{className:"mt-6 pt-6 border-t",children:l.jsxs("div",{className:"max-w-md ml-auto space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[l.jsx("span",{children:"Total HT:"}),l.jsxs("span",{className:"font-semibold",children:[O.toFixed(2)," MAD"]})]}),l.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[l.jsx("span",{children:"TVA 20%:"}),l.jsxs("span",{className:"font-semibold",children:[C.toFixed(2)," MAD"]})]}),l.jsxs("div",{className:"flex items-center justify-between text-lg font-bold text-gray-900 pt-2 border-t",children:[l.jsx("span",{children:"Total TTC:"}),l.jsxs("span",{className:"text-primary-600",children:[R.toFixed(2)," MAD"]})]})]})})]})},vT=({onClose:e,onCreate:t})=>{const[r,n]=me.useState(""),[s,a]=me.useState(""),i=o=>{o.preventDefault(),r.trim()&&s.trim()&&t({reference:r.trim(),designation:s.trim()})};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full mx-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau bordereau"}),l.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(vo,{className:"w-5 h-5"})})]}),l.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),l.jsx("input",{type:"text",value:r,onChange:o=>n(o.target.value),className:"input",placeholder:"Ex: BPU-2024-01",required:!0,autoFocus:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),l.jsx("textarea",{value:s,onChange:o=>a(o.target.value),className:"input",rows:3,placeholder:"Ex: Bordereau des Prix Unitaires - Terrassement",required:!0})]}),l.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary flex-1",children:"Annuler"}),l.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"Crer"})]})]})]})})},yT=({projectId:e,onClose:t,onCreated:r})=>{const{user:n}=Yr(),[s,a]=me.useState(""),[i,o]=me.useState(""),[c,f]=me.useState(new Set),u=i?o$(i):Hh.filter(h=>s===""||h.designation.toLowerCase().includes(s.toLowerCase())||h.code.toLowerCase().includes(s.toLowerCase())||h.tags.some(m=>m.toLowerCase().includes(s.toLowerCase()))),p=h=>{const m=new Set(c);m.has(h)?m.delete(h):m.add(h),f(m)},d=async()=>{if(!n||c.size===0){alert("Veuillez slectionner au moins un article");return}const h=`bordereau:${Ir()}`,m=new Date().toISOString(),g=new Date().getFullYear(),y=Array.from(c).map((b,w)=>{const S=Hh.find(A=>A.id===b);return S?{id:Ir(),numero:w+1,designation:S.designation,unite:S.unite,quantite:0,prixUnitaire:S.prixReference,montant:0}:null}).filter(b=>b!==null),v={id:h,projectId:e,userId:n.id,reference:`BPU-${g}`,designation:"Bordereau des Prix Unitaires",lignes:y,montantTotal:0,createdAt:m,updatedAt:m};await Se.bordereaux.add(v),await mn("CREATE","bordereau",h.replace("bordereau:",""),v,n.id),r(h)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bibliothque de modles"}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[c.size," article(s) slectionn(s)"]})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(vo,{className:"w-5 h-5"})})]}),l.jsx("div",{className:"p-6 border-b space-y-4",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("div",{className:"flex-1 relative",children:[l.jsx(Nx,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),l.jsx("input",{type:"text",value:s,onChange:h=>a(h.target.value),className:"input pl-10",placeholder:"Rechercher par dsignation, code ou tag..."})]}),l.jsxs("select",{value:i,onChange:h=>o(h.target.value),className:"input w-64",children:[l.jsx("option",{value:"",children:"Toutes les catgories"}),a$.map(h=>l.jsx("option",{value:h,children:h},h))]})]})}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.map(h=>l.jsx("div",{onClick:()=>p(h.id),className:`card cursor-pointer transition-all border-2 ${c.has(h.id)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("input",{type:"checkbox",checked:c.has(h.id),onChange:()=>{},className:"mt-1"}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-start justify-between gap-2",children:[l.jsxs("div",{children:[l.jsx("div",{className:"font-medium text-gray-900",children:h.code}),l.jsx("div",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:h.designation})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"font-semibold text-primary-600",children:[h.prixReference," MAD"]}),l.jsx("div",{className:"text-xs text-gray-500 mt-1",children:h.unite})]})]}),l.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[l.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded",children:h.categorie}),h.tags.slice(0,2).map((m,g)=>l.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:m},g))]})]})]})},h.id))}),u.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(B9,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-500",children:"Aucun modle trouv"})]})]}),l.jsx("div",{className:"p-6 border-t bg-gray-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),l.jsxs("button",{onClick:d,disabled:c.size===0,className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:["Crer avec ",c.size," article(s)"]})]})})]})})},wT=({currentProjectId:e,onClose:t,onCopied:r})=>{var y;const{user:n}=Yr(),[s,a]=me.useState(""),[i,o]=me.useState(""),[c,f]=me.useState(""),[u,p]=me.useState(""),d=$t(()=>Se.projects.where("userId").equals((n==null?void 0:n.id)||"").and(v=>!v.deletedAt&&v.id!==`project:${e}`).toArray(),[n,e]),h=$t(()=>s?Se.bordereaux.where("projectId").equals(s).and(v=>!v.deletedAt).toArray():Promise.resolve([]),[s]),m=$t(()=>i?Se.bordereaux.get(i):Promise.resolve(null),[i]),g=async()=>{if(!n||!m||!c.trim()||!u.trim()){alert("Veuillez remplir tous les champs et slectionner un bordereau");return}const v=`bordereau:${Ir()}`,b=new Date().toISOString(),w=m.lignes.map((A,F)=>({...A,id:Ir(),numero:F+1,quantite:0,montant:0})),S={id:v,projectId:e,userId:n.id,reference:c.trim(),designation:u.trim(),lignes:w,montantTotal:0,createdAt:b,updatedAt:b};await Se.bordereaux.add(S),await mn("CREATE","bordereau",v.replace("bordereau:",""),S,n.id),r(v)};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Copier depuis un projet"}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(vo,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"1. Slectionner le projet source"}),l.jsxs("select",{value:s,onChange:v=>{a(v.target.value),o("")},className:"input w-full",children:[l.jsx("option",{value:"",children:"Choisir un projet..."}),d==null?void 0:d.map(v=>l.jsxs("option",{value:v.id,children:[v.objet," - March N ",v.marcheNo]},v.id))]})]}),s&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2. Slectionner le bordereau  copier"}),h&&h.length>0?l.jsx("div",{className:"space-y-2",children:h.map(v=>{var b,w;return l.jsx("div",{onClick:()=>o(v.id),className:`card cursor-pointer transition-all border-2 ${i===v.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 bg-primary-100 text-primary-600 rounded-lg flex items-center justify-center",children:l.jsx(Sr,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-medium text-gray-900",children:v.reference}),l.jsx("div",{className:"text-sm text-gray-600",children:v.designation}),l.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[((b=v.lignes)==null?void 0:b.length)||0," lignes  ",(w=v.montantTotal)==null?void 0:w.toLocaleString()," MAD"]})]})]})},v.id)})}):l.jsxs("div",{className:"text-center py-8 text-gray-500",children:[l.jsx(Sr,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),l.jsx("p",{children:"Aucun bordereau dans ce projet"})]})]}),i&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"3. Informations du nouveau bordereau"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Rfrence *"}),l.jsx("input",{type:"text",value:c,onChange:v=>f(v.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-02"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Dsignation *"}),l.jsx("input",{type:"text",value:u,onChange:v=>p(v.target.value),className:"input w-full",placeholder:"Ex: Bordereau copi"})]}),m&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start gap-2",children:[l.jsx(wg,{className:"w-5 h-5 text-blue-600 mt-0.5"}),l.jsxs("div",{className:"text-sm text-blue-900",children:[l.jsx("p",{className:"font-medium mb-1",children:"Contenu  copier:"}),l.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[l.jsxs("li",{children:[((y=m.lignes)==null?void 0:y.length)||0," lignes de bordereau"]}),l.jsx("li",{children:"Dsignations et units"}),l.jsx("li",{children:"Prix unitaires de rfrence"}),l.jsx("li",{className:"font-medium",children:"Les quantits seront remises  0"})]})]})]})})]})]})]}),l.jsx("div",{className:"p-6 border-t bg-gray-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),l.jsxs("button",{onClick:g,disabled:!i||!c.trim()||!u.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[l.jsx(wg,{className:"w-4 h-4"}),"Copier le bordereau"]})]})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var bT=1252,l$=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sb={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},_b=function(e){l$.indexOf(e)!=-1&&(bT=Sb[0]=e)};function c$(){_b(1252)}var Ci=function(e){_b(e)};function NT(){Ci(1200),c$()}function mS(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function u$(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function ST(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var D0=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?u$(e.slice(2)):t==254&&r==255?ST(e.slice(2)):t==65279?e.slice(1):e},Im=function(t){return String.fromCharCode(t)},gS=function(t){return String.fromCharCode(t)},Wh,ac="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function xS(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,f=0;f<e.length;)r=e.charCodeAt(f++),a=r>>2,n=e.charCodeAt(f++),i=(r&3)<<4|n>>4,s=e.charCodeAt(f++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=ac.charAt(a)+ac.charAt(i)+ac.charAt(o)+ac.charAt(c);return t}function La(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<e.length;)a=ac.indexOf(e.charAt(f++)),i=ac.indexOf(e.charAt(f++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=ac.indexOf(e.charAt(f++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=ac.indexOf(e.charAt(f++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var rr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Hu=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function _c(e){return rr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function vS(e){return rr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ji=function(t){return rr?Hu(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function kb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return kb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Yl=rr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Hu(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function f$(e){for(var t=[],r=0,n=e.length+250,s=_c(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=_c(65535),n=65530)}return t.push(s.slice(0,r)),Yl(t)}var Hs=/\u0000/g,O0=/[\u0001-\u0006]/g;function Xf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Pi(e,t){var r=""+e;return r.length>=t?r:rn("0",t-r.length)+r}function Eb(e,t){var r=""+e;return r.length>=t?r:rn(" ",t-r.length)+r}function _g(e,t){var r=""+e;return r.length>=t?r:r+rn(" ",t-r.length)}function d$(e,t){var r=""+Math.round(e);return r.length>=t?r:rn("0",t-r.length)+r}function h$(e,t){var r=""+e;return r.length>=t?r:rn("0",t-r.length)+r}var yS=Math.pow(2,32);function pf(e,t){if(e>yS||e<-yS)return d$(e,t);var r=Math.round(e);return h$(r,t)}function kg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var wS=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Z2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function p$(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Wt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},bS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},m$={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Eg(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,f=0,u=0,p=Math.floor(s);f<t&&(p=Math.floor(s),o=p*i+a,u=p*f+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=o,c=f,f=u;if(u>t&&(f>t?(u=c,o=a):(u=f,o=i)),!r)return[0,n*o,u];var d=Math.floor(n*o/u);return[d,n*o-d*u,u]}function cu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=b$(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var _T=new Date(1899,11,31,0,0,0),g$=_T.getTime(),x$=new Date(1900,2,1,0,0,0);function kT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=x$&&(r+=24*60*60*1e3),(r-(g$+(e.getTimezoneOffset()-_T.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function jb(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function v$(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function y$(e){var t=e<0?12:11,r=jb(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function w$(e){var t=jb(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Vh(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=y$(e):t===10?r=e.toFixed(10).substr(0,12):r=w$(e),jb(v$(r.toUpperCase()))}function Ou(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vh(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ti(14,kT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function b$(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function N$(e,t,r,n){var s="",a=0,i=0,o=r.y,c,f=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,f=2;break;default:c=o%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,f=t.length;break;case 3:return Z2[r.m-1][1];case 5:return Z2[r.m-1][0];default:return Z2[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,f=t.length;break;case 3:return wS[r.q][0];default:return wS[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Pi(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Pi(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:c=o,f=1;break}var u=f>0?Pi(c,f):"";return u}function ic(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var ET=/%/g;function S$(e,t,r){var n=t.replace(ET,""),s=t.length-n.length;return ol(e,n,r*Math.pow(10,2*s))+rn("%",s)}function _$(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function jT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+jT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,u){return c+f+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var AT=/# (\?+)( ?)\/( ?)(\d+)/;function k$(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?rn(" ",e[1].length+1+e[4].length):Eb(i,e[1].length)+e[2]+"/"+e[3]+Pi(o,e[4].length))}function E$(e,t,r){return r+(t===0?"":""+t)+rn(" ",e[1].length+2+e[4].length)}var TT=/^#*0*\.([0#]+)/,CT=/\).*[0#]/,PT=/\(###\) ###\\?-####/;function Ms(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function NS(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function SS(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function j$(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function A$(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ha(e,t,r){if(e.charCodeAt(0)===40&&!t.match(CT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ha("n",n,r):"("+Ha("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _$(e,t,r);if(t.indexOf("%")!==-1)return S$(e,t,r);if(t.indexOf("E")!==-1)return jT(t,r);if(t.charCodeAt(0)===36)return"$"+Ha(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+pf(c,t.length);if(t.match(/^[#?]+$/))return s=pf(r,0),s==="0"&&(s=""),s.length>t.length?s:Ms(t.substr(0,t.length-s.length))+s;if(a=t.match(AT))return k$(a,c,f);if(t.match(/^#+0+$/))return f+pf(c,t.length-t.indexOf("0"));if(a=t.match(TT))return s=NS(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Ms(a[1])).replace(/\.$/,"."+Ms(a[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+rn("0",Ms(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+NS(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ic(pf(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ha(e,t,-r):ic(""+(Math.floor(r)+j$(r,a[1].length)))+"."+Pi(SS(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Ha(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xf(Ha(e,t.replace(/[\\-]/g,""),r)),i=0,Xf(Xf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(PT))return s=Ha(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Eg(c,Math.pow(10,i)-1,!1),s=""+f,u=ol("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_g(o[2],i),u.length<a[4].length&&(u=Ms(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Eg(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eb(o[1],i)+a[2]+"/"+a[3]+_g(o[2],i):rn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=pf(r,0),t.length<=s.length?s:Ms(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,d=t.length-s.length-p;return Ms(t.substr(0,p)+s+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=SS(r,a[1].length),r<0?"-"+Ha(e,t,-r):ic(A$(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Pi(0,3-m.length):"")+m})+"."+Pi(i,a[1].length);switch(t){case"###,##0.00":return Ha(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=ic(pf(c,0));return h!=="0"?f+h:"";case"###,###.00":return Ha(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ha(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function T$(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function C$(e,t,r){var n=t.replace(ET,""),s=t.length-n.length;return ol(e,n,r*Math.pow(10,2*s))+rn("%",s)}function FT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+FT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,f,u){return c+f+u.substr(0,(s+a)%s)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(CT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zi("n",n,r):"("+Zi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return T$(e,t,r);if(t.indexOf("%")!==-1)return C$(e,t,r);if(t.indexOf("E")!==-1)return FT(t,r);if(t.charCodeAt(0)===36)return"$"+Zi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),f=r<0?"-":"";if(t.match(/^00+$/))return f+Pi(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Ms(t.substr(0,t.length-s.length))+s;if(a=t.match(AT))return E$(a,c,f);if(t.match(/^#+0+$/))return f+Pi(c,t.length-t.indexOf("0"));if(a=t.match(TT))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Ms(a[1])).replace(/\.$/,"."+Ms(a[1])),s=s.replace(/\.(\d*)$/,function(m,g){return"."+g+rn("0",Ms(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ic(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zi(e,t,-r):ic(""+r)+"."+rn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Zi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Xf(Zi(e,t.replace(/[\\-]/g,""),r)),i=0,Xf(Xf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(PT))return s=Zi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Eg(c,Math.pow(10,i)-1,!1),s=""+f,u=ol("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),s+=u+a[2]+"/"+a[3],u=_g(o[2],i),u.length<a[4].length&&(u=Ms(a[4].substr(a[4].length-u.length))+u),s+=u,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Eg(c,Math.pow(10,i)-1,!0),f+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eb(o[1],i)+a[2]+"/"+a[3]+_g(o[2],i):rn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Ms(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,d=t.length-s.length-p;return Ms(t.substr(0,p)+s+t.substr(t.length-d))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zi(e,t,-r):ic(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Pi(0,3-m.length):"")+m})+"."+Pi(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=ic(""+c);return h!=="0"?f+h:"";default:if(t.match(/\.[0#?]*$/))return Zi(e,t.slice(0,t.lastIndexOf(".")),r)+Ms(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ol(e,t,r){return(r|0)===r?Zi(e,t,r):Ha(e,t,r)}function P$(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var LT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Od(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":kg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(LT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function F$(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",f,u,p,d="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!kg(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var h=e.charAt(++i),m=h==="("||h===")"?h:"t";s[s.length]={t:m,v:h},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(f==null&&(f=cu(t,r,e.charAt(i+1)==="2"),f==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=cu(t,r),f==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var g={t:o,v:o};if(f==null&&(f=cu(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(f!=null&&(g.v=f.H>=12?"P":"A"),g.t="T",d="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(f!=null&&(g.v=f.H>=12?"PM":"AM"),g.t="T",i+=5,d="h"):e.substr(i,5).toUpperCase()==="/"?(f!=null&&(g.v=f.H>=12?"":""),g.t="T",i+=5,d="h"):(g.t="t",++i),f==null&&g.t==="T")return"";s[s.length]=g,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(LT)){if(f==null&&(f=cu(t,r),f==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Od(e)||(s[s.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var y=0,v=0,b;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=d,c="h",y<1&&(y=1);break;case"s":(b=s[i].v.match(/\.0+$/))&&(v=Math.max(v,b[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&s[i].v.match(/[Hh]/)&&(y=1),y<2&&s[i].v.match(/[Mm]/)&&(y=2),y<3&&s[i].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var w="",S;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=N$(s[i].t.charCodeAt(0),s[i].v,f,v),s[i].t="t";break;case"n":case"?":for(S=i+1;s[S]!=null&&((o=s[S].t)==="?"||o==="D"||(o===" "||o==="t")&&s[S+1]!=null&&(s[S+1].t==="?"||s[S+1].t==="t"&&s[S+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[S].v==="/"||s[S].v===" "&&s[S+1]!=null&&s[S+1].t=="?"));)s[i].v+=s[S].v,s[S]={v:"",t:";"},++S;w+=s[i].v,i=S-1;break;case"G":s[i].t="t",s[i].v=Ou(t,r);break}var A="",F,T;if(w.length>0){w.charCodeAt(0)==40?(F=t<0&&w.charCodeAt(0)===45?-t:t,T=ol("n",w,F)):(F=t<0&&n>1?-t:t,T=ol("n",w,F),F<0&&s[0]&&s[0].t=="t"&&(T=T.substr(1),s[0].v="-"+s[0].v)),S=T.length-1;var O=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){O=i;break}var C=s.length;if(O===s.length&&T.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(S>=s[i].v.length-1?(S-=s[i].v.length,s[i].v=T.substr(S+1,s[i].v.length)):S<0?s[i].v="":(s[i].v=T.substr(0,S+1),S=-1),s[i].t="t",C=i);S>=0&&C<s.length&&(s[C].v=T.substr(0,S+1)+s[C].v)}else if(O!==s.length&&T.indexOf("E")===-1){for(S=T.indexOf(".")-1,i=O;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(u=s[i].v.indexOf(".")>-1&&i===O?s[i].v.indexOf(".")-1:s[i].v.length-1,A=s[i].v.substr(u+1);u>=0;--u)S>=0&&(s[i].v.charAt(u)==="0"||s[i].v.charAt(u)==="#")&&(A=T.charAt(S--)+A);s[i].v=A,s[i].t="t",C=i}for(S>=0&&C<s.length&&(s[C].v=T.substr(0,S+1)+s[C].v),S=T.indexOf(".")+1,i=O;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==O)){for(u=s[i].v.indexOf(".")>-1&&i===O?s[i].v.indexOf(".")+1:0,A=s[i].v.substr(0,u);u<s[i].v.length;++u)S<T.length&&(A+=T.charAt(S++));s[i].v=A,s[i].t="t",C=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(F=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=ol(s[i].t,s[i].v,F),s[i].t="t");var R="";for(i=0;i!==s.length;++i)s[i]!=null&&(R+=s[i].v);return R}var _S=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function kS(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function L$(e,t){var r=P$(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(_S),o=r[1].match(_S);return kS(t,i)?[n,r[0]]:kS(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function ti(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Wt)[e],n==null&&(n=r.table&&r.table[bS[e]]||Wt[bS[e]]),n==null&&(n=m$[e]||"General");break}if(kg(n,0))return Ou(t,r);t instanceof Date&&(t=kT(t,r.date1904));var s=L$(n,t);if(kg(s[1]))return Ou(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return F$(s[1],t,r,s[0])}function Su(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wt[r]==null){t<0&&(t=r);continue}if(Wt[r]==e){t=r;break}}t<0&&(t=391)}return Wt[t]=e,t}function DT(){Wt=p$()}var D$={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},OT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function O$(e){var t=typeof e=="number"?Wt[e]:e;return t=t.replace(OT,"(\\d+)"),new RegExp("^"+t+"$")}function R$(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(OT)||[]).forEach(function(p,d){var h=parseInt(r[d+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":i=h;break;case"s":c=h;break;case"m":i>=0?o=h:s=h;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var f=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var u=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?f:n==-1&&s==-1&&a==-1?u:f+"T"+u}var I$=function(){var e={};e.version="1.2.0";function t(){for(var T=0,O=new Array(256),C=0;C!=256;++C)T=C,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,O[C]=T;return typeof Int32Array<"u"?new Int32Array(O):O}var r=t();function n(T){var O=0,C=0,R=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(R=0;R!=256;++R)k[R]=T[R];for(R=0;R!=256;++R)for(C=T[R],O=256+R;O<4096;O+=256)C=k[O]=C>>>8^T[C&255];var P=[];for(R=1;R!=16;++R)P[R-1]=typeof Int32Array<"u"?k.subarray(R*256,R*256+256):k.slice(R*256,R*256+256);return P}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],f=s[4],u=s[5],p=s[6],d=s[7],h=s[8],m=s[9],g=s[10],y=s[11],v=s[12],b=s[13],w=s[14];function S(T,O){for(var C=O^-1,R=0,k=T.length;R<k;)C=C>>>8^r[(C^T.charCodeAt(R++))&255];return~C}function A(T,O){for(var C=O^-1,R=T.length-15,k=0;k<R;)C=w[T[k++]^C&255]^b[T[k++]^C>>8&255]^v[T[k++]^C>>16&255]^y[T[k++]^C>>>24]^g[T[k++]]^m[T[k++]]^h[T[k++]]^d[T[k++]]^p[T[k++]]^u[T[k++]]^f[T[k++]]^c[T[k++]]^o[T[k++]]^i[T[k++]]^a[T[k++]]^r[T[k++]];for(R+=15;k<R;)C=C>>>8^r[(C^T[k++])&255];return~C}function F(T,O){for(var C=O^-1,R=0,k=T.length,P=0,q=0;R<k;)P=T.charCodeAt(R++),P<128?C=C>>>8^r[(C^P)&255]:P<2048?(C=C>>>8^r[(C^(192|P>>6&31))&255],C=C>>>8^r[(C^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,q=T.charCodeAt(R++)&1023,C=C>>>8^r[(C^(240|P>>8&7))&255],C=C>>>8^r[(C^(128|P>>2&63))&255],C=C>>>8^r[(C^(128|q>>6&15|(P&3)<<4))&255],C=C>>>8^r[(C^(128|q&63))&255]):(C=C>>>8^r[(C^(224|P>>12&15))&255],C=C>>>8^r[(C^(128|P>>6&63))&255],C=C>>>8^r[(C^(128|P&63))&255]);return~C}return e.table=r,e.bstr=S,e.buf=A,e.str=F,e}(),ar=function(){var t={};t.version="1.2.1";function r(H,oe){for(var Q=H.split("/"),re=oe.split("/"),le=0,ue=0,_e=Math.min(Q.length,re.length);le<_e;++le){if(ue=Q[le].length-re[le].length)return ue;if(Q[le]!=re[le])return Q[le]<re[le]?-1:1}return Q.length-re.length}function n(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:n(H.slice(0,-1));var oe=H.lastIndexOf("/");return oe===-1?H:H.slice(0,oe+1)}function s(H){if(H.charAt(H.length-1)=="/")return s(H.slice(0,-1));var oe=H.lastIndexOf("/");return oe===-1?H:H.slice(oe+1)}function a(H,oe){typeof oe=="string"&&(oe=new Date(oe));var Q=oe.getHours();Q=Q<<6|oe.getMinutes(),Q=Q<<5|oe.getSeconds()>>>1,H.write_shift(2,Q);var re=oe.getFullYear()-1980;re=re<<4|oe.getMonth()+1,re=re<<5|oe.getDate(),H.write_shift(2,re)}function i(H){var oe=H.read_shift(2)&65535,Q=H.read_shift(2)&65535,re=new Date,le=Q&31;Q>>>=5;var ue=Q&15;Q>>>=4,re.setMilliseconds(0),re.setFullYear(Q+1980),re.setMonth(ue-1),re.setDate(le);var _e=oe&31;oe>>>=5;var Pe=oe&63;return oe>>>=6,re.setHours(oe),re.setMinutes(Pe),re.setSeconds(_e<<1),re}function o(H){ss(H,0);for(var oe={},Q=0;H.l<=H.length-4;){var re=H.read_shift(2),le=H.read_shift(2),ue=H.l+le,_e={};switch(re){case 21589:Q=H.read_shift(1),Q&1&&(_e.mtime=H.read_shift(4)),le>5&&(Q&2&&(_e.atime=H.read_shift(4)),Q&4&&(_e.ctime=H.read_shift(4))),_e.mtime&&(_e.mt=new Date(_e.mtime*1e3));break}H.l=ue,oe[re]=_e}return oe}var c;function f(){return c||(c={})}function u(H,oe){if(H[0]==80&&H[1]==75)return Lt(H,oe);if((H[0]|32)==109&&(H[1]|32)==105)return Et(H,oe);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var Q=3,re=512,le=0,ue=0,_e=0,Pe=0,ke=0,Ee=[],Te=H.slice(0,512);ss(Te,0);var qe=p(Te);switch(Q=qe[0],Q){case 3:re=512;break;case 4:re=4096;break;case 0:if(qe[1]==0)return Lt(H,oe);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}re!==512&&(Te=H.slice(0,re),ss(Te,28));var Ye=H.slice(0,re);d(Te,Q);var tt=Te.read_shift(4,"i");if(Q===3&&tt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+tt);Te.l+=4,_e=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Pe=Te.read_shift(4,"i"),le=Te.read_shift(4,"i"),ke=Te.read_shift(4,"i"),ue=Te.read_shift(4,"i");for(var Ke=-1,Ze=0;Ze<109&&(Ke=Te.read_shift(4,"i"),!(Ke<0));++Ze)Ee[Ze]=Ke;var jt=h(H,re);y(ke,ue,jt,re,Ee);var yr=b(jt,_e,Ee,re);yr[_e].name="!Directory",le>0&&Pe!==q&&(yr[Pe].name="!MiniFAT"),yr[Ee[0]].name="!FAT",yr.fat_addrs=Ee,yr.ssz=re;var Qt={},Xr=[],zi=[],oi=[];w(_e,yr,jt,Xr,le,Qt,zi,Pe),m(zi,oi,Xr),Xr.shift();var qi={FileIndex:zi,FullPaths:oi};return oe&&oe.raw&&(qi.raw={header:Ye,sectors:jt}),qi}function p(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(D,"Header Signature: "),H.l+=16;var oe=H.read_shift(2,"u");return[H.read_shift(2,"u"),oe]}function d(H,oe){var Q=9;switch(H.l+=2,Q=H.read_shift(2)){case 9:if(oe!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(oe!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function h(H,oe){for(var Q=Math.ceil(H.length/oe)-1,re=[],le=1;le<Q;++le)re[le-1]=H.slice(le*oe,(le+1)*oe);return re[Q-1]=H.slice(Q*oe),re}function m(H,oe,Q){for(var re=0,le=0,ue=0,_e=0,Pe=0,ke=Q.length,Ee=[],Te=[];re<ke;++re)Ee[re]=Te[re]=re,oe[re]=Q[re];for(;Pe<Te.length;++Pe)re=Te[Pe],le=H[re].L,ue=H[re].R,_e=H[re].C,Ee[re]===re&&(le!==-1&&Ee[le]!==le&&(Ee[re]=Ee[le]),ue!==-1&&Ee[ue]!==ue&&(Ee[re]=Ee[ue])),_e!==-1&&(Ee[_e]=re),le!==-1&&re!=Ee[re]&&(Ee[le]=Ee[re],Te.lastIndexOf(le)<Pe&&Te.push(le)),ue!==-1&&re!=Ee[re]&&(Ee[ue]=Ee[re],Te.lastIndexOf(ue)<Pe&&Te.push(ue));for(re=1;re<ke;++re)Ee[re]===re&&(ue!==-1&&Ee[ue]!==ue?Ee[re]=Ee[ue]:le!==-1&&Ee[le]!==le&&(Ee[re]=Ee[le]));for(re=1;re<ke;++re)if(H[re].type!==0){if(Pe=re,Pe!=Ee[Pe])do Pe=Ee[Pe],oe[re]=oe[Pe]+"/"+oe[re];while(Pe!==0&&Ee[Pe]!==-1&&Pe!=Ee[Pe]);Ee[re]=-1}for(oe[0]+="/",re=1;re<ke;++re)H[re].type!==2&&(oe[re]+="/")}function g(H,oe,Q){for(var re=H.start,le=H.size,ue=[],_e=re;Q&&le>0&&_e>=0;)ue.push(oe.slice(_e*P,_e*P+P)),le-=P,_e=ru(Q,_e*4);return ue.length===0?On(0):Yl(ue).slice(0,H.size)}function y(H,oe,Q,re,le){var ue=q;if(H===q){if(oe!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var _e=Q[H],Pe=(re>>>2)-1;if(!_e)return;for(var ke=0;ke<Pe&&(ue=ru(_e,ke*4))!==q;++ke)le.push(ue);y(ru(_e,re-4),oe-1,Q,re,le)}}function v(H,oe,Q,re,le){var ue=[],_e=[];le||(le=[]);var Pe=re-1,ke=0,Ee=0;for(ke=oe;ke>=0;){le[ke]=!0,ue[ue.length]=ke,_e.push(H[ke]);var Te=Q[Math.floor(ke*4/re)];if(Ee=ke*4&Pe,re<4+Ee)throw new Error("FAT boundary crossed: "+ke+" 4 "+re);if(!H[Te])break;ke=ru(H[Te],Ee)}return{nodes:ue,data:OS([_e])}}function b(H,oe,Q,re){var le=H.length,ue=[],_e=[],Pe=[],ke=[],Ee=re-1,Te=0,qe=0,Ye=0,tt=0;for(Te=0;Te<le;++Te)if(Pe=[],Ye=Te+oe,Ye>=le&&(Ye-=le),!_e[Ye]){ke=[];var Ke=[];for(qe=Ye;qe>=0;){Ke[qe]=!0,_e[qe]=!0,Pe[Pe.length]=qe,ke.push(H[qe]);var Ze=Q[Math.floor(qe*4/re)];if(tt=qe*4&Ee,re<4+tt)throw new Error("FAT boundary crossed: "+qe+" 4 "+re);if(!H[Ze]||(qe=ru(H[Ze],tt),Ke[qe]))break}ue[Ye]={nodes:Pe,data:OS([ke])}}return ue}function w(H,oe,Q,re,le,ue,_e,Pe){for(var ke=0,Ee=re.length?2:0,Te=oe[H].data,qe=0,Ye=0,tt;qe<Te.length;qe+=128){var Ke=Te.slice(qe,qe+128);ss(Ke,64),Ye=Ke.read_shift(2),tt=Fb(Ke,0,Ye-Ee),re.push(tt);var Ze={name:tt,type:Ke.read_shift(1),color:Ke.read_shift(1),L:Ke.read_shift(4,"i"),R:Ke.read_shift(4,"i"),C:Ke.read_shift(4,"i"),clsid:Ke.read_shift(16),state:Ke.read_shift(4,"i"),start:0,size:0},jt=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);jt!==0&&(Ze.ct=S(Ke,Ke.l-8));var yr=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);yr!==0&&(Ze.mt=S(Ke,Ke.l-8)),Ze.start=Ke.read_shift(4,"i"),Ze.size=Ke.read_shift(4,"i"),Ze.size<0&&Ze.start<0&&(Ze.size=Ze.type=0,Ze.start=q,Ze.name=""),Ze.type===5?(ke=Ze.start,le>0&&ke!==q&&(oe[ke].name="!StreamData")):Ze.size>=4096?(Ze.storage="fat",oe[Ze.start]===void 0&&(oe[Ze.start]=v(Q,Ze.start,oe.fat_addrs,oe.ssz)),oe[Ze.start].name=Ze.name,Ze.content=oe[Ze.start].data.slice(0,Ze.size)):(Ze.storage="minifat",Ze.size<0?Ze.size=0:ke!==q&&Ze.start!==q&&oe[ke]&&(Ze.content=g(Ze,oe[ke].data,(oe[Pe]||{}).data))),Ze.content&&ss(Ze.content,0),ue[tt]=Ze,_e.push(Ze)}}function S(H,oe){return new Date((_a(H,oe+4)/1e7*Math.pow(2,32)+_a(H,oe)/1e7-11644473600)*1e3)}function A(H,oe){return f(),u(c.readFileSync(H),oe)}function F(H,oe){var Q=oe&&oe.type;switch(Q||rr&&Buffer.isBuffer(H)&&(Q="buffer"),Q||"base64"){case"file":return A(H,oe);case"base64":return u(ji(La(H)),oe);case"binary":return u(ji(H),oe)}return u(H,oe)}function T(H,oe){var Q=oe||{},re=Q.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=re+"/",H.FileIndex[0]={name:re,type:5}),Q.CLSID&&(H.FileIndex[0].clsid=Q.CLSID),O(H)}function O(H){var oe="Sh33tJ5";if(!ar.find(H,"/"+oe)){var Q=On(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,H.FileIndex.push({name:oe,type:2,content:Q,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+oe),C(H)}}function C(H,oe){T(H);for(var Q=!1,re=!1,le=H.FullPaths.length-1;le>=0;--le){var ue=H.FileIndex[le];switch(ue.type){case 0:re?Q=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:re=!0,isNaN(ue.R*ue.L*ue.C)&&(Q=!0),ue.R>-1&&ue.L>-1&&ue.R==ue.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!oe)){var _e=new Date(1987,1,19),Pe=0,ke=Object.create?Object.create(null):{},Ee=[];for(le=0;le<H.FullPaths.length;++le)ke[H.FullPaths[le]]=!0,H.FileIndex[le].type!==0&&Ee.push([H.FullPaths[le],H.FileIndex[le]]);for(le=0;le<Ee.length;++le){var Te=n(Ee[le][0]);re=ke[Te],re||(Ee.push([Te,{name:s(Te).replace("/",""),type:1,clsid:se,ct:_e,mt:_e,content:null}]),ke[Te]=!0)}for(Ee.sort(function(tt,Ke){return r(tt[0],Ke[0])}),H.FullPaths=[],H.FileIndex=[],le=0;le<Ee.length;++le)H.FullPaths[le]=Ee[le][0],H.FileIndex[le]=Ee[le][1];for(le=0;le<Ee.length;++le){var qe=H.FileIndex[le],Ye=H.FullPaths[le];if(qe.name=s(Ye).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||se,le===0)qe.C=Ee.length>1?1:-1,qe.size=0,qe.type=5;else if(Ye.slice(-1)=="/"){for(Pe=le+1;Pe<Ee.length&&n(H.FullPaths[Pe])!=Ye;++Pe);for(qe.C=Pe>=Ee.length?-1:Pe,Pe=le+1;Pe<Ee.length&&n(H.FullPaths[Pe])!=n(Ye);++Pe);qe.R=Pe>=Ee.length?-1:Pe,qe.type=1}else n(H.FullPaths[le+1]||"")==n(Ye)&&(qe.R=le+1),qe.type=2}}}function R(H,oe){var Q=oe||{};if(Q.fileType=="mad")return ai(H,Q);switch(C(H),Q.fileType){case"zip":return Xt(H,Q)}var re=function(tt){for(var Ke=0,Ze=0,jt=0;jt<tt.FileIndex.length;++jt){var yr=tt.FileIndex[jt];if(yr.content){var Qt=yr.content.length;Qt>0&&(Qt<4096?Ke+=Qt+63>>6:Ze+=Qt+511>>9)}}for(var Xr=tt.FullPaths.length+3>>2,zi=Ke+7>>3,oi=Ke+127>>7,qi=zi+Ze+Xr+oi,Ia=qi+127>>7,yl=Ia<=109?0:Math.ceil((Ia-109)/127);qi+Ia+yl+127>>7>Ia;)yl=++Ia<=109?0:Math.ceil((Ia-109)/127);var vn=[1,yl,Ia,oi,Xr,Ze,Ke,0];return tt.FileIndex[0].size=Ke<<6,vn[7]=(tt.FileIndex[0].start=vn[0]+vn[1]+vn[2]+vn[3]+vn[4]+vn[5])+(vn[6]+7>>3),vn}(H),le=On(re[7]<<9),ue=0,_e=0;{for(ue=0;ue<8;++ue)le.write_shift(1,V[ue]);for(ue=0;ue<8;++ue)le.write_shift(2,0);for(le.write_shift(2,62),le.write_shift(2,3),le.write_shift(2,65534),le.write_shift(2,9),le.write_shift(2,6),ue=0;ue<3;++ue)le.write_shift(2,0);for(le.write_shift(4,0),le.write_shift(4,re[2]),le.write_shift(4,re[0]+re[1]+re[2]+re[3]-1),le.write_shift(4,0),le.write_shift(4,4096),le.write_shift(4,re[3]?re[0]+re[1]+re[2]-1:q),le.write_shift(4,re[3]),le.write_shift(-4,re[1]?re[0]-1:q),le.write_shift(4,re[1]),ue=0;ue<109;++ue)le.write_shift(-4,ue<re[2]?re[1]+ue:-1)}if(re[1])for(_e=0;_e<re[1];++_e){for(;ue<236+_e*127;++ue)le.write_shift(-4,ue<re[2]?re[1]+ue:-1);le.write_shift(-4,_e===re[1]-1?q:_e+1)}var Pe=function(tt){for(_e+=tt;ue<_e-1;++ue)le.write_shift(-4,ue+1);tt&&(++ue,le.write_shift(-4,q))};for(_e=ue=0,_e+=re[1];ue<_e;++ue)le.write_shift(-4,ne.DIFSECT);for(_e+=re[2];ue<_e;++ue)le.write_shift(-4,ne.FATSECT);Pe(re[3]),Pe(re[4]);for(var ke=0,Ee=0,Te=H.FileIndex[0];ke<H.FileIndex.length;++ke)Te=H.FileIndex[ke],Te.content&&(Ee=Te.content.length,!(Ee<4096)&&(Te.start=_e,Pe(Ee+511>>9)));for(Pe(re[6]+7>>3);le.l&511;)le.write_shift(-4,ne.ENDOFCHAIN);for(_e=ue=0,ke=0;ke<H.FileIndex.length;++ke)Te=H.FileIndex[ke],Te.content&&(Ee=Te.content.length,!(!Ee||Ee>=4096)&&(Te.start=_e,Pe(Ee+63>>6)));for(;le.l&511;)le.write_shift(-4,ne.ENDOFCHAIN);for(ue=0;ue<re[4]<<2;++ue){var qe=H.FullPaths[ue];if(!qe||qe.length===0){for(ke=0;ke<17;++ke)le.write_shift(4,0);for(ke=0;ke<3;++ke)le.write_shift(4,-1);for(ke=0;ke<12;++ke)le.write_shift(4,0);continue}Te=H.FileIndex[ue],ue===0&&(Te.start=Te.size?Te.start-1:q);var Ye=ue===0&&Q.root||Te.name;if(Ee=2*(Ye.length+1),le.write_shift(64,Ye,"utf16le"),le.write_shift(2,Ee),le.write_shift(1,Te.type),le.write_shift(1,Te.color),le.write_shift(-4,Te.L),le.write_shift(-4,Te.R),le.write_shift(-4,Te.C),Te.clsid)le.write_shift(16,Te.clsid,"hex");else for(ke=0;ke<4;++ke)le.write_shift(4,0);le.write_shift(4,Te.state||0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,Te.start),le.write_shift(4,Te.size),le.write_shift(4,0)}for(ue=1;ue<H.FileIndex.length;++ue)if(Te=H.FileIndex[ue],Te.size>=4096)if(le.l=Te.start+1<<9,rr&&Buffer.isBuffer(Te.content))Te.content.copy(le,le.l,0,Te.size),le.l+=Te.size+511&-512;else{for(ke=0;ke<Te.size;++ke)le.write_shift(1,Te.content[ke]);for(;ke&511;++ke)le.write_shift(1,0)}for(ue=1;ue<H.FileIndex.length;++ue)if(Te=H.FileIndex[ue],Te.size>0&&Te.size<4096)if(rr&&Buffer.isBuffer(Te.content))Te.content.copy(le,le.l,0,Te.size),le.l+=Te.size+63&-64;else{for(ke=0;ke<Te.size;++ke)le.write_shift(1,Te.content[ke]);for(;ke&63;++ke)le.write_shift(1,0)}if(rr)le.l=le.length;else for(;le.l<le.length;)le.write_shift(1,0);return le}function k(H,oe){var Q=H.FullPaths.map(function(ke){return ke.toUpperCase()}),re=Q.map(function(ke){var Ee=ke.split("/");return Ee[Ee.length-(ke.slice(-1)=="/"?2:1)]}),le=!1;oe.charCodeAt(0)===47?(le=!0,oe=Q[0].slice(0,-1)+oe):le=oe.indexOf("/")!==-1;var ue=oe.toUpperCase(),_e=le===!0?Q.indexOf(ue):re.indexOf(ue);if(_e!==-1)return H.FileIndex[_e];var Pe=!ue.match(O0);for(ue=ue.replace(Hs,""),Pe&&(ue=ue.replace(O0,"!")),_e=0;_e<Q.length;++_e)if((Pe?Q[_e].replace(O0,"!"):Q[_e]).replace(Hs,"")==ue||(Pe?re[_e].replace(O0,"!"):re[_e]).replace(Hs,"")==ue)return H.FileIndex[_e];return null}var P=64,q=-2,D="d0cf11e0a1b11ae1",V=[208,207,17,224,161,177,26,225],se="00000000000000000000000000000000",ne={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:D,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function X(H,oe,Q){f();var re=R(H,Q);c.writeFileSync(oe,re)}function G(H){for(var oe=new Array(H.length),Q=0;Q<H.length;++Q)oe[Q]=String.fromCharCode(H[Q]);return oe.join("")}function ve(H,oe){var Q=R(H,oe);switch(oe&&oe.type||"buffer"){case"file":return f(),c.writeFileSync(oe.filename,Q),Q;case"binary":return typeof Q=="string"?Q:G(Q);case"base64":return xS(typeof Q=="string"?Q:G(Q));case"buffer":if(rr)return Buffer.isBuffer(Q)?Q:Hu(Q);case"array":return typeof Q=="string"?ji(Q):Q}return Q}var ye;function E(H){try{var oe=H.InflateRaw,Q=new oe;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)ye=H;else throw new Error("zlib does not expose bytesRead")}catch(re){console.error("cannot use native zlib: "+(re.message||re))}}function M(H,oe){if(!ye)return hr(H,oe);var Q=ye.InflateRaw,re=new Q,le=re._processChunk(H.slice(H.l),re._finishFlushFlag);return H.l+=re.bytesRead,le}function I(H){return ye?ye.deflateRawSync(H):Xe(H)}var z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ge(H){var oe=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(oe>>16|oe>>8|oe)&255}for(var he=typeof Uint8Array<"u",pe=he?new Uint8Array(256):[],Le=0;Le<256;++Le)pe[Le]=ge(Le);function ee(H,oe){var Q=pe[H&255];return oe<=8?Q>>>8-oe:(Q=Q<<8|pe[H>>8&255],oe<=16?Q>>>16-oe:(Q=Q<<8|pe[H>>16&255],Q>>>24-oe))}function We(H,oe){var Q=oe&7,re=oe>>>3;return(H[re]|(Q<=6?0:H[re+1]<<8))>>>Q&3}function Ge(H,oe){var Q=oe&7,re=oe>>>3;return(H[re]|(Q<=5?0:H[re+1]<<8))>>>Q&7}function J(H,oe){var Q=oe&7,re=oe>>>3;return(H[re]|(Q<=4?0:H[re+1]<<8))>>>Q&15}function Ue(H,oe){var Q=oe&7,re=oe>>>3;return(H[re]|(Q<=3?0:H[re+1]<<8))>>>Q&31}function Me(H,oe){var Q=oe&7,re=oe>>>3;return(H[re]|(Q<=1?0:H[re+1]<<8))>>>Q&127}function rt(H,oe,Q){var re=oe&7,le=oe>>>3,ue=(1<<Q)-1,_e=H[le]>>>re;return Q<8-re||(_e|=H[le+1]<<8-re,Q<16-re)||(_e|=H[le+2]<<16-re,Q<24-re)||(_e|=H[le+3]<<24-re),_e&ue}function Be(H,oe,Q){var re=oe&7,le=oe>>>3;return re<=5?H[le]|=(Q&7)<<re:(H[le]|=Q<<re&255,H[le+1]=(Q&7)>>8-re),oe+3}function ft(H,oe,Q){var re=oe&7,le=oe>>>3;return Q=(Q&1)<<re,H[le]|=Q,oe+1}function et(H,oe,Q){var re=oe&7,le=oe>>>3;return Q<<=re,H[le]|=Q&255,Q>>>=8,H[le+1]=Q,oe+8}function gt(H,oe,Q){var re=oe&7,le=oe>>>3;return Q<<=re,H[le]|=Q&255,Q>>>=8,H[le+1]=Q&255,H[le+2]=Q>>>8,oe+16}function ct(H,oe){var Q=H.length,re=2*Q>oe?2*Q:oe+5,le=0;if(Q>=oe)return H;if(rr){var ue=vS(re);if(H.copy)H.copy(ue);else for(;le<H.length;++le)ue[le]=H[le];return ue}else if(he){var _e=new Uint8Array(re);if(_e.set)_e.set(H);else for(;le<Q;++le)_e[le]=H[le];return _e}return H.length=re,H}function Mt(H){for(var oe=new Array(H),Q=0;Q<H;++Q)oe[Q]=0;return oe}function Ft(H,oe,Q){var re=1,le=0,ue=0,_e=0,Pe=0,ke=H.length,Ee=he?new Uint16Array(32):Mt(32);for(ue=0;ue<32;++ue)Ee[ue]=0;for(ue=ke;ue<Q;++ue)H[ue]=0;ke=H.length;var Te=he?new Uint16Array(ke):Mt(ke);for(ue=0;ue<ke;++ue)Ee[le=H[ue]]++,re<le&&(re=le),Te[ue]=0;for(Ee[0]=0,ue=1;ue<=re;++ue)Ee[ue+16]=Pe=Pe+Ee[ue-1]<<1;for(ue=0;ue<ke;++ue)Pe=H[ue],Pe!=0&&(Te[ue]=Ee[Pe+16]++);var qe=0;for(ue=0;ue<ke;++ue)if(qe=H[ue],qe!=0)for(Pe=ee(Te[ue],re)>>re-qe,_e=(1<<re+4-qe)-1;_e>=0;--_e)oe[Pe|_e<<qe]=qe&15|ue<<4;return re}var St=he?new Uint16Array(512):Mt(512),Kt=he?new Uint16Array(32):Mt(32);if(!he){for(var _t=0;_t<512;++_t)St[_t]=0;for(_t=0;_t<32;++_t)Kt[_t]=0}(function(){for(var H=[],oe=0;oe<32;oe++)H.push(5);Ft(H,Kt,32);var Q=[];for(oe=0;oe<=143;oe++)Q.push(8);for(;oe<=255;oe++)Q.push(9);for(;oe<=279;oe++)Q.push(7);for(;oe<=287;oe++)Q.push(8);Ft(Q,St,288)})();var nt=function(){for(var oe=he?new Uint8Array(32768):[],Q=0,re=0;Q<fe.length-1;++Q)for(;re<fe[Q+1];++re)oe[re]=Q;for(;re<32768;++re)oe[re]=29;var le=he?new Uint8Array(259):[];for(Q=0,re=0;Q<te.length-1;++Q)for(;re<te[Q+1];++re)le[re]=Q;function ue(Pe,ke){for(var Ee=0;Ee<Pe.length;){var Te=Math.min(65535,Pe.length-Ee),qe=Ee+Te==Pe.length;for(ke.write_shift(1,+qe),ke.write_shift(2,Te),ke.write_shift(2,~Te&65535);Te-- >0;)ke[ke.l++]=Pe[Ee++]}return ke.l}function _e(Pe,ke){for(var Ee=0,Te=0,qe=he?new Uint16Array(32768):[];Te<Pe.length;){var Ye=Math.min(65535,Pe.length-Te);if(Ye<10){for(Ee=Be(ke,Ee,+(Te+Ye==Pe.length)),Ee&7&&(Ee+=8-(Ee&7)),ke.l=Ee/8|0,ke.write_shift(2,Ye),ke.write_shift(2,~Ye&65535);Ye-- >0;)ke[ke.l++]=Pe[Te++];Ee=ke.l*8;continue}Ee=Be(ke,Ee,+(Te+Ye==Pe.length)+2);for(var tt=0;Ye-- >0;){var Ke=Pe[Te];tt=(tt<<5^Ke)&32767;var Ze=-1,jt=0;if((Ze=qe[tt])&&(Ze|=Te&-32768,Ze>Te&&(Ze-=32768),Ze<Te))for(;Pe[Ze+jt]==Pe[Te+jt]&&jt<250;)++jt;if(jt>2){Ke=le[jt],Ke<=22?Ee=et(ke,Ee,pe[Ke+1]>>1)-1:(et(ke,Ee,3),Ee+=5,et(ke,Ee,pe[Ke-23]>>5),Ee+=3);var yr=Ke<8?0:Ke-4>>2;yr>0&&(gt(ke,Ee,jt-te[Ke]),Ee+=yr),Ke=oe[Te-Ze],Ee=et(ke,Ee,pe[Ke]>>3),Ee-=3;var Qt=Ke<4?0:Ke-2>>1;Qt>0&&(gt(ke,Ee,Te-Ze-fe[Ke]),Ee+=Qt);for(var Xr=0;Xr<jt;++Xr)qe[tt]=Te&32767,tt=(tt<<5^Pe[Te])&32767,++Te;Ye-=jt-1}else Ke<=143?Ke=Ke+48:Ee=ft(ke,Ee,1),Ee=et(ke,Ee,pe[Ke]),qe[tt]=Te&32767,++Te}Ee=et(ke,Ee,0)-1}return ke.l=(Ee+7)/8|0,ke.l}return function(ke,Ee){return ke.length<8?ue(ke,Ee):_e(ke,Ee)}}();function Xe(H){var oe=On(50+Math.floor(H.length*1.1)),Q=nt(H,oe);return oe.slice(0,Q)}var Je=he?new Uint16Array(32768):Mt(32768),nr=he?new Uint16Array(32768):Mt(32768),wt=he?new Uint16Array(128):Mt(128),Ct=1,qt=1;function kr(H,oe){var Q=Ue(H,oe)+257;oe+=5;var re=Ue(H,oe)+1;oe+=5;var le=J(H,oe)+4;oe+=4;for(var ue=0,_e=he?new Uint8Array(19):Mt(19),Pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ke=1,Ee=he?new Uint8Array(8):Mt(8),Te=he?new Uint8Array(8):Mt(8),qe=_e.length,Ye=0;Ye<le;++Ye)_e[z[Ye]]=ue=Ge(H,oe),ke<ue&&(ke=ue),Ee[ue]++,oe+=3;var tt=0;for(Ee[0]=0,Ye=1;Ye<=ke;++Ye)Te[Ye]=tt=tt+Ee[Ye-1]<<1;for(Ye=0;Ye<qe;++Ye)(tt=_e[Ye])!=0&&(Pe[Ye]=Te[tt]++);var Ke=0;for(Ye=0;Ye<qe;++Ye)if(Ke=_e[Ye],Ke!=0){tt=pe[Pe[Ye]]>>8-Ke;for(var Ze=(1<<7-Ke)-1;Ze>=0;--Ze)wt[tt|Ze<<Ke]=Ke&7|Ye<<3}var jt=[];for(ke=1;jt.length<Q+re;)switch(tt=wt[Me(H,oe)],oe+=tt&7,tt>>>=3){case 16:for(ue=3+We(H,oe),oe+=2,tt=jt[jt.length-1];ue-- >0;)jt.push(tt);break;case 17:for(ue=3+Ge(H,oe),oe+=3;ue-- >0;)jt.push(0);break;case 18:for(ue=11+Me(H,oe),oe+=7;ue-- >0;)jt.push(0);break;default:jt.push(tt),ke<tt&&(ke=tt);break}var yr=jt.slice(0,Q),Qt=jt.slice(Q);for(Ye=Q;Ye<286;++Ye)yr[Ye]=0;for(Ye=re;Ye<30;++Ye)Qt[Ye]=0;return Ct=Ft(yr,Je,286),qt=Ft(Qt,nr,30),oe}function vt(H,oe){if(H[0]==3&&!(H[1]&3))return[_c(oe),2];for(var Q=0,re=0,le=vS(oe||1<<18),ue=0,_e=le.length>>>0,Pe=0,ke=0;!(re&1);){if(re=Ge(H,Q),Q+=3,re>>>1)re>>1==1?(Pe=9,ke=5):(Q=kr(H,Q),Pe=Ct,ke=qt);else{Q&7&&(Q+=8-(Q&7));var Ee=H[Q>>>3]|H[(Q>>>3)+1]<<8;if(Q+=32,Ee>0)for(!oe&&_e<ue+Ee&&(le=ct(le,ue+Ee),_e=le.length);Ee-- >0;)le[ue++]=H[Q>>>3],Q+=8;continue}for(;;){!oe&&_e<ue+32767&&(le=ct(le,ue+32767),_e=le.length);var Te=rt(H,Q,Pe),qe=re>>>1==1?St[Te]:Je[Te];if(Q+=qe&15,qe>>>=4,!(qe>>>8&255))le[ue++]=qe;else{if(qe==256)break;qe-=257;var Ye=qe<8?0:qe-4>>2;Ye>5&&(Ye=0);var tt=ue+te[qe];Ye>0&&(tt+=rt(H,Q,Ye),Q+=Ye),Te=rt(H,Q,ke),qe=re>>>1==1?Kt[Te]:nr[Te],Q+=qe&15,qe>>>=4;var Ke=qe<4?0:qe-2>>1,Ze=fe[qe];for(Ke>0&&(Ze+=rt(H,Q,Ke),Q+=Ke),!oe&&_e<tt&&(le=ct(le,tt+100),_e=le.length);ue<tt;)le[ue]=le[ue-Ze],++ue}}}return oe?[le,Q+7>>>3]:[le.slice(0,ue),Q+7>>>3]}function hr(H,oe){var Q=H.slice(H.l||0),re=vt(Q,oe);return H.l+=re[1],re[0]}function kt(H,oe){if(H)typeof console<"u"&&console.error(oe);else throw new Error(oe)}function Lt(H,oe){var Q=H;ss(Q,0);var re=[],le=[],ue={FileIndex:re,FullPaths:le};T(ue,{root:oe.root});for(var _e=Q.length-4;(Q[_e]!=80||Q[_e+1]!=75||Q[_e+2]!=5||Q[_e+3]!=6)&&_e>=0;)--_e;Q.l=_e+4,Q.l+=4;var Pe=Q.read_shift(2);Q.l+=6;var ke=Q.read_shift(4);for(Q.l=ke,_e=0;_e<Pe;++_e){Q.l+=20;var Ee=Q.read_shift(4),Te=Q.read_shift(4),qe=Q.read_shift(2),Ye=Q.read_shift(2),tt=Q.read_shift(2);Q.l+=8;var Ke=Q.read_shift(4),Ze=o(Q.slice(Q.l+qe,Q.l+qe+Ye));Q.l+=qe+Ye+tt;var jt=Q.l;Q.l=Ke+4,Er(Q,Ee,Te,ue,Ze),Q.l=jt}return ue}function Er(H,oe,Q,re,le){H.l+=2;var ue=H.read_shift(2),_e=H.read_shift(2),Pe=i(H);if(ue&8257)throw new Error("Unsupported ZIP encryption");for(var ke=H.read_shift(4),Ee=H.read_shift(4),Te=H.read_shift(4),qe=H.read_shift(2),Ye=H.read_shift(2),tt="",Ke=0;Ke<qe;++Ke)tt+=String.fromCharCode(H[H.l++]);if(Ye){var Ze=o(H.slice(H.l,H.l+Ye));(Ze[21589]||{}).mt&&(Pe=Ze[21589].mt),((le||{})[21589]||{}).mt&&(Pe=le[21589].mt)}H.l+=Ye;var jt=H.slice(H.l,H.l+Ee);switch(_e){case 8:jt=M(H,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+_e)}var yr=!1;ue&8&&(ke=H.read_shift(4),ke==134695760&&(ke=H.read_shift(4),yr=!0),Ee=H.read_shift(4),Te=H.read_shift(4)),Ee!=oe&&kt(yr,"Bad compressed size: "+oe+" != "+Ee),Te!=Q&&kt(yr,"Bad uncompressed size: "+Q+" != "+Te),us(re,tt,jt,{unsafe:!0,mt:Pe})}function Xt(H,oe){var Q=oe||{},re=[],le=[],ue=On(1),_e=Q.compression?8:0,Pe=0,ke=0,Ee=0,Te=0,qe=0,Ye=H.FullPaths[0],tt=Ye,Ke=H.FileIndex[0],Ze=[],jt=0;for(ke=1;ke<H.FullPaths.length;++ke)if(tt=H.FullPaths[ke].slice(Ye.length),Ke=H.FileIndex[ke],!(!Ke.size||!Ke.content||tt=="Sh33tJ5")){var yr=Te,Qt=On(tt.length);for(Ee=0;Ee<tt.length;++Ee)Qt.write_shift(1,tt.charCodeAt(Ee)&127);Qt=Qt.slice(0,Qt.l),Ze[qe]=I$.buf(Ke.content,0);var Xr=Ke.content;_e==8&&(Xr=I(Xr)),ue=On(30),ue.write_shift(4,67324752),ue.write_shift(2,20),ue.write_shift(2,Pe),ue.write_shift(2,_e),Ke.mt?a(ue,Ke.mt):ue.write_shift(4,0),ue.write_shift(-4,Ze[qe]),ue.write_shift(4,Xr.length),ue.write_shift(4,Ke.content.length),ue.write_shift(2,Qt.length),ue.write_shift(2,0),Te+=ue.length,re.push(ue),Te+=Qt.length,re.push(Qt),Te+=Xr.length,re.push(Xr),ue=On(46),ue.write_shift(4,33639248),ue.write_shift(2,0),ue.write_shift(2,20),ue.write_shift(2,Pe),ue.write_shift(2,_e),ue.write_shift(4,0),ue.write_shift(-4,Ze[qe]),ue.write_shift(4,Xr.length),ue.write_shift(4,Ke.content.length),ue.write_shift(2,Qt.length),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(4,0),ue.write_shift(4,yr),jt+=ue.l,le.push(ue),jt+=Qt.length,le.push(Qt),++qe}return ue=On(22),ue.write_shift(4,101010256),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,qe),ue.write_shift(2,qe),ue.write_shift(4,jt),ue.write_shift(4,Te),ue.write_shift(2,0),Yl([Yl(re),Yl(le),ue])}var yt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function fr(H,oe){if(H.ctype)return H.ctype;var Q=H.name||"",re=Q.match(/\.([^\.]+)$/);return re&&yt[re[1]]||oe&&(re=(Q=oe).match(/[\.\\]([^\.\\])+$/),re&&yt[re[1]])?yt[re[1]]:"application/octet-stream"}function ko(H){for(var oe=xS(H),Q=[],re=0;re<oe.length;re+=76)Q.push(oe.slice(re,re+76));return Q.join(`\r
`)+`\r
`}function $n(H){var oe=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Te=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});oe=oe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),oe.charAt(0)==`
`&&(oe="=0D"+oe.slice(1)),oe=oe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],re=oe.split(`\r
`),le=0;le<re.length;++le){var ue=re[le];if(ue.length==0){Q.push("");continue}for(var _e=0;_e<ue.length;){var Pe=76,ke=ue.slice(_e,_e+Pe);ke.charAt(Pe-1)=="="?Pe--:ke.charAt(Pe-2)=="="?Pe-=2:ke.charAt(Pe-3)=="="&&(Pe-=3),ke=ue.slice(_e,_e+Pe),_e+=Pe,_e<ue.length&&(ke+="="),Q.push(ke)}}return Q.join(`\r
`)}function si(H){for(var oe=[],Q=0;Q<H.length;++Q){for(var re=H[Q];Q<=H.length&&re.charAt(re.length-1)=="=";)re=re.slice(0,re.length-1)+H[++Q];oe.push(re)}for(var le=0;le<oe.length;++le)oe[le]=oe[le].replace(/[=][0-9A-Fa-f]{2}/g,function(ue){return String.fromCharCode(parseInt(ue.slice(1),16))});return ji(oe.join(`\r
`))}function Ra(H,oe,Q){for(var re="",le="",ue="",_e,Pe=0;Pe<10;++Pe){var ke=oe[Pe];if(!ke||ke.match(/^\s*$/))break;var Ee=ke.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":re=Ee[2].trim();break;case"content-type":ue=Ee[2].trim();break;case"content-transfer-encoding":le=Ee[2].trim();break}}switch(++Pe,le.toLowerCase()){case"base64":_e=ji(La(oe.slice(Pe).join("")));break;case"quoted-printable":_e=si(oe.slice(Pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+le)}var Te=us(H,re.slice(Q.length),_e,{unsafe:!0});ue&&(Te.ctype=ue)}function Et(H,oe){if(G(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=oe&&oe.root||"",re=(rr&&Buffer.isBuffer(H)?H.toString("binary"):G(H)).split(`\r
`),le=0,ue="";for(le=0;le<re.length;++le)if(ue=re[le],!!/^Content-Location:/i.test(ue)&&(ue=ue.slice(ue.indexOf("file")),Q||(Q=ue.slice(0,ue.lastIndexOf("/")+1)),ue.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ue.slice(0,Q.length)!=Q););var _e=(re[1]||"").match(/boundary="(.*?)"/);if(!_e)throw new Error("MAD cannot find boundary");var Pe="--"+(_e[1]||""),ke=[],Ee=[],Te={FileIndex:ke,FullPaths:Ee};T(Te);var qe,Ye=0;for(le=0;le<re.length;++le){var tt=re[le];tt!==Pe&&tt!==Pe+"--"||(Ye++&&Ra(Te,re.slice(qe,le),Q),qe=le)}return Te}function ai(H,oe){var Q=oe||{},re=Q.boundary||"SheetJS";re="------="+re;for(var le=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+re.slice(2)+'"',"","",""],ue=H.FullPaths[0],_e=ue,Pe=H.FileIndex[0],ke=1;ke<H.FullPaths.length;++ke)if(_e=H.FullPaths[ke].slice(ue.length),Pe=H.FileIndex[ke],!(!Pe.size||!Pe.content||_e=="Sh33tJ5")){_e=_e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(jt){return"_x"+jt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(jt){return"_u"+jt.charCodeAt(0).toString(16)+"_"});for(var Ee=Pe.content,Te=rr&&Buffer.isBuffer(Ee)?Ee.toString("binary"):G(Ee),qe=0,Ye=Math.min(1024,Te.length),tt=0,Ke=0;Ke<=Ye;++Ke)(tt=Te.charCodeAt(Ke))>=32&&tt<128&&++qe;var Ze=qe>=Ye*4/5;le.push(re),le.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+_e),le.push("Content-Transfer-Encoding: "+(Ze?"quoted-printable":"base64")),le.push("Content-Type: "+fr(Pe,_e)),le.push(""),le.push(Ze?$n(Te):ko(Te))}return le.push(re+`--\r
`),le.join(`\r
`)}function ii(H){var oe={};return T(oe,H),oe}function us(H,oe,Q,re){var le=re&&re.unsafe;le||T(H);var ue=!le&&ar.find(H,oe);if(!ue){var _e=H.FullPaths[0];oe.slice(0,_e.length)==_e?_e=oe:(_e.slice(-1)!="/"&&(_e+="/"),_e=(_e+oe).replace("//","/")),ue={name:s(oe),type:2},H.FileIndex.push(ue),H.FullPaths.push(_e),le||ar.utils.cfb_gc(H)}return ue.content=Q,ue.size=Q?Q.length:0,re&&(re.CLSID&&(ue.clsid=re.CLSID),re.mt&&(ue.mt=re.mt),re.ct&&(ue.ct=re.ct)),ue}function Js(H,oe){T(H);var Q=ar.find(H,oe);if(Q){for(var re=0;re<H.FileIndex.length;++re)if(H.FileIndex[re]==Q)return H.FileIndex.splice(re,1),H.FullPaths.splice(re,1),!0}return!1}function Mr(H,oe,Q){T(H);var re=ar.find(H,oe);if(re){for(var le=0;le<H.FileIndex.length;++le)if(H.FileIndex[le]==re)return H.FileIndex[le].name=s(Q),H.FullPaths[le]=Q,!0}return!1}function xn(H){C(H,!0)}return t.find=k,t.read=F,t.parse=u,t.write=ve,t.writeFile=X,t.utils={cfb_new:ii,cfb_add:us,cfb_del:Js,cfb_mov:Mr,cfb_gc:xn,ReadShift:Z0,CheckField:nC,prep_blob:ss,bconcat:Yl,use_zlib:E,_deflateRaw:Xe,_inflateRaw:hr,consts:ne},t}();function M$(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function wo(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Ab(e){for(var t=[],r=wo(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var jg=new Date(1899,11,30,0,0,0);function Gs(e,t){var r=e.getTime(),n=jg.getTime()+(e.getTimezoneOffset()-jg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var RT=new Date,B$=jg.getTime()+(RT.getTimezoneOffset()-jg.getTimezoneOffset())*6e4,ES=RT.getTimezoneOffset();function _x(e){var t=new Date;return t.setTime(e*24*60*60*1e3+B$),t.getTimezoneOffset()!==ES&&t.setTime(t.getTime()+(t.getTimezoneOffset()-ES)*6e4),t}function U$(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var jS=new Date("2017-02-19T19:06:09.000Z"),IT=isNaN(jS.getFullYear())?new Date("2/19/17"):jS,$$=IT.getFullYear()==2017;function Kn(e,t){var r=new Date(e);if($$)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(IT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ru(e,t){if(rr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return I0(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return I0(ST(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return I0(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return I0(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function is(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=is(e[r]));return t}function rn(e,t){for(var r="";r.length<t;)r+=e;return r}function Oi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var z$=["january","february","march","april","may","june","july","august","september","october","november","december"];function Nd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&z$.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var q$=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function MT(e){return e?e.content&&e.type?Ru(e.content,!0):e.data?D0(e.data):e.asNodeBuffer&&rr?D0(e.asNodeBuffer().toString("binary")):e.asBinary?D0(e.asBinary()):e._data&&e._data.getContent?D0(Ru(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function BT(e){if(!e)return null;if(e.data)return mS(e.data);if(e.asNodeBuffer&&rr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?mS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function H$(e){return e&&e.name.slice(-4)===".bin"?BT(e):MT(e)}function Wa(e,t){for(var r=e.FullPaths||wo(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Tb(e,t){var r=Wa(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function _n(e,t,r){if(!r)return H$(Tb(e,t));if(!t)return null;try{return _n(e,t)}catch{return null}}function Ea(e,t,r){if(!r)return MT(Tb(e,t));if(!t)return null;try{return Ea(e,t)}catch{return null}}function W$(e,t,r){return BT(Tb(e,t))}function AS(e){for(var t=e.FullPaths||wo(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function V$(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return rr?n=Hu(r):n=f$(r),ar.utils.cfb_add(e,t,n)}ar.utils.cfb_add(e,t,r)}else e.file(t,r)}function UT(e,t){switch(t.type){case"base64":return ar.read(e,{type:"base64"});case"binary":return ar.read(e,{type:"binary"});case"buffer":case"array":return ar.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function R0(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var $T=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,K$=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,TS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,G$=/<[^>]*>/g,Ps=$T.match(TS)?TS:G$,Y$=/<\w*:/,X$=/<(\/?)\w+:/;function Tt(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(K$),o=0,c="",f=0,u="",p="",d=1;if(i)for(f=0;f!=i.length;++f){for(p=i[f],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(u=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(d=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+d,p.length-d),o=0;o!=u.length&&u.charCodeAt(o)!==58;++o);if(o===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=c,n[u.toLowerCase()]=c;else{var h=(o===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(o+1);if(n[h]&&u.slice(o-3,o)=="ext")continue;n[h]=c,n[h.toLowerCase()]=c}}return n}function No(e){return e.replace(X$,"<$1")}var zT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},J$=Ab(zT),ur=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return zT[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),Q$=/[&<>'"]/g,Z$=/[\u0000-\u001f]/g;function Cb(e){var t=e+"";return t.replace(Q$,function(r){return J$[r]}).replace(/\n/g,"<br/>").replace(Z$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var CS=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function $r(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ev(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function PS(e){var t=_c(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function FS(e){return Hu(e,"binary").toString("utf8")}var Mm="foo bar baz",Pr=rr&&(FS(Mm)==ev(Mm)&&FS||PS(Mm)==ev(Mm)&&PS)||ev,I0=rr?function(e){return Hu(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Kh=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),qT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),ez=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),tz=/<\/?(?:vt:)?variant>/g,rz=/<(?:vt:)([^>]*)>([\s\S]*)</;function LS(e,t){var r=Tt(e),n=e.match(ez(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(tz,"").match(rz);i&&s.push({v:Pr(i[2]),t:i[1]})}),s}var nz=/(^\s|\s$|\n)/;function sz(e){return wo(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function az(e,t,r){return"<"+e+(r!=null?sz(r):"")+(t!=null?(t.match(nz)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Pb(e){if(rr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Pr(Wu(kb(e)));throw new Error("Bad input format: expected Buffer or string")}var Gh=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,iz={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},oz=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function lz(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function cz(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var DS=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},OS=rr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Hu(t)})):DS(e)}:DS,RS=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(rl(e,s)));return n.join("").replace(Hs,"")},Fb=rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Hs,""):RS(e,t,r)}:RS,IS=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},HT=rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):IS(e,t,r)}:IS,MS=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Nf(e,s)));return n.join("")},yp=rr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):MS(t,r,n)}:MS,WT=function(e,t){var r=_a(e,t);return r>0?yp(e,t+4,t+4+r-1):""},VT=WT,KT=function(e,t){var r=_a(e,t);return r>0?yp(e,t+4,t+4+r-1):""},GT=KT,YT=function(e,t){var r=2*_a(e,t);return r>0?yp(e,t+4,t+4+r-1):""},XT=YT,JT=function(t,r){var n=_a(t,r);return n>0?Fb(t,r+4,r+4+n):""},QT=JT,ZT=function(e,t){var r=_a(e,t);return r>0?yp(e,t+4,t+4+r):""},eC=ZT,tC=function(e,t){return lz(e,t)},Ag=tC,rC=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};rr&&(VT=function(t,r){if(!Buffer.isBuffer(t))return WT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},GT=function(t,r){if(!Buffer.isBuffer(t))return KT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},XT=function(t,r){if(!Buffer.isBuffer(t))return YT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},QT=function(t,r){if(!Buffer.isBuffer(t))return JT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},eC=function(t,r){if(!Buffer.isBuffer(t))return ZT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Ag=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):tC(t,r)},rC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Nf=function(e,t){return e[t]},rl=function(e,t){return e[t+1]*256+e[t]},uz=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},_a=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ru=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},fz=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Z0(e,t){var r="",n,s,a=[],i,o,c,f;switch(t){case"dbcs":if(f=this.l,rr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(rl(this,f)),f+=2;e*=2;break;case"utf8":r=yp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fb(this,this.l,this.l+e);break;case"wstr":return Z0.call(this,e,"dbcs");case"lpstr-ansi":r=VT(this,this.l),e=4+_a(this,this.l);break;case"lpstr-cp":r=GT(this,this.l),e=4+_a(this,this.l);break;case"lpwstr":r=XT(this,this.l),e=4+2*_a(this,this.l);break;case"lpp4":e=4+_a(this,this.l),r=QT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+_a(this,this.l),r=eC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Nf(this,this.l+e++))!==0;)a.push(Im(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=rl(this,this.l+e))!==0;)a.push(Im(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",f=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=Nf(this,f),this.l=f+1,o=Z0.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Im(rl(this,f))),f+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",f=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return i=Nf(this,f),this.l=f+1,o=Z0.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Im(Nf(this,f))),f+=1}r=a.join("");break;default:switch(e){case 1:return n=Nf(this,this.l),this.l++,n;case 2:return n=(t==="i"?uz:rl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ru:fz)(this,this.l),this.l+=4,n):(s=_a(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Ag(this,this.l):s=Ag([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=HT(this,this.l,e);break}}return this.l+=e,r}var dz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},hz=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},pz=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function mz(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)pz(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,dz(this,t,this.l);break;case 8:if(n=8,r==="f"){cz(this,t,this.l);break}case 16:break;case-4:n=4,hz(this,t,this.l);break}return this.l+=n,this}function nC(e,t){var r=HT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ss(e,t){e.l=t,e.read_shift=Z0,e.chk=nC,e.write_shift=mz}function Cs(e,t){e.l+=t}function On(e){var t=_c(e);return ss(t,0),t}function vl(e,t,r){if(e){var n,s,a;ss(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var f=Dg[o]||Dg[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var u=f.f&&f.f(e,a,r);if(e.l=c,t(u,f,o))return}}}function jw(){var e=[],t=rr?256:2048,r=function(f){var u=On(f);return ss(u,0),u},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(f){return n&&f<n.length-n.l?n:(s(),n=r(Math.max(f+1,t)))},i=function(){return s(),Yl(e)},o=function(f){s(),n=f,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function eh(e,t,r){var n=is(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BS(e,t,r){var n=is(e);return n.s=eh(n.s,t.s,r),n.e=eh(n.e,t.s,r),n}function th(e,t){if(e.cRel&&e.c<0)for(e=is(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=is(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Ut(e);return!e.cRel&&e.cRel!=null&&(r=vz(r)),!e.rRel&&e.rRel!=null&&(r=gz(r)),r}function tv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Mn(e.s.c)+":"+(e.e.cRel?"":"$")+Mn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+os(e.s.r)+":"+(e.e.rRel?"":"$")+os(e.e.r):th(e.s,t.biff)+":"+th(e.e,t.biff)}function Lb(e){return parseInt(xz(e),10)-1}function os(e){return""+(e+1)}function gz(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xz(e){return e.replace(/\$(\d+)$/,"$1")}function Db(e){for(var t=yz(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Mn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function vz(e){return e.replace(/^([A-Z])/,"$$$1")}function yz(e){return e.replace(/^\$([A-Z])/,"$1")}function wz(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function zs(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Ut(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Rd(e){var t=e.indexOf(":");return t==-1?{s:zs(e),e:zs(e)}:{s:zs(e.slice(0,t)),e:zs(e.slice(t+1))}}function ir(e,t){return typeof t>"u"||typeof t=="number"?ir(e.s,e.e):(typeof e!="string"&&(e=Ut(e)),typeof t!="string"&&(t=Ut(t)),e==t?e:e+":"+t)}function nn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function US(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ti(e.z,r?Gs(t):t)}catch{}try{return e.w=ti((e.XF||{}).numFmtId||(r?14:0),r?Gs(t):t)}catch{return""+t}}function pl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Gu[e.v]||e.v:t==null?US(e,e.v):US(e,t))}function Lc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function sC(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?zs(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=nn(a["!ref"]);f.s.c=u.s.c,f.s.r=u.s.r,f.e.c=Math.max(f.e.c,u.e.c),f.e.r=Math.max(f.e.r,u.e.r),i==-1&&(f.e.r=i=u.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[p].length;++d)if(!(typeof t[p][d]>"u")){var h={v:t[p][d]},m=i+p,g=o+d;if(f.s.r>m&&(f.s.r=m),f.s.c>g&&(f.s.c=g),f.e.r<m&&(f.e.r=m),f.e.c<g&&(f.e.c=g),t[p][d]&&typeof t[p][d]=="object"&&!Array.isArray(t[p][d])&&!(t[p][d]instanceof Date))h=t[p][d];else if(Array.isArray(h.v)&&(h.f=t[p][d][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Wt[14],n.cellDates?(h.t="d",h.w=ti(h.z,Gs(h.v))):(h.t="n",h.v=Gs(h.v),h.w=ti(h.z,h.v))):h.t="s";if(s)a[m]||(a[m]=[]),a[m][g]&&a[m][g].z&&(h.z=a[m][g].z),a[m][g]=h;else{var y=Ut({c:g,r:m});a[y]&&a[y].z&&(h.z=a[y].z),a[y]=h}}}return f.s.c<1e7&&(a["!ref"]=ir(f)),a}function Id(e,t){return sC(null,e,t)}function bz(e){return e.read_shift(4,"i")}function js(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Nz(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ob(e,t){var r=e.l,n=e.read_shift(1),s=js(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(Nz(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var Sz=Ob;function ni(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var _z=js;function Rb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var kz=js,Aw=Rb;function Ib(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Ag([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ru(t,0)>>2;return r?s/100:s}function aC(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ku=aC;function _s(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ez(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var f=_u[s];f&&(t.rgb=Xh(f));break;case 2:t.rgb=Xh([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function jz(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function iC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Az(e){return iC(e,1)}function Tz(e){return iC(e,2)}var Mb=2,ta=3,Bm=11,$S=12,Tg=19,Um=64,Cz=65,Pz=71,Fz=4108,Lz=4126,qn=80,oC=81,Dz=[qn,oC],Oz={1:{n:"CodePage",t:Mb},2:{n:"Category",t:qn},3:{n:"PresentationFormat",t:qn},4:{n:"ByteCount",t:ta},5:{n:"LineCount",t:ta},6:{n:"ParagraphCount",t:ta},7:{n:"SlideCount",t:ta},8:{n:"NoteCount",t:ta},9:{n:"HiddenCount",t:ta},10:{n:"MultimediaClipCount",t:ta},11:{n:"ScaleCrop",t:Bm},12:{n:"HeadingPairs",t:Fz},13:{n:"TitlesOfParts",t:Lz},14:{n:"Manager",t:qn},15:{n:"Company",t:qn},16:{n:"LinksUpToDate",t:Bm},17:{n:"CharacterCount",t:ta},19:{n:"SharedDoc",t:Bm},22:{n:"HyperlinksChanged",t:Bm},23:{n:"AppVersion",t:ta,p:"version"},24:{n:"DigSig",t:Cz},26:{n:"ContentType",t:qn},27:{n:"ContentStatus",t:qn},28:{n:"Language",t:qn},29:{n:"Version",t:qn},255:{},2147483648:{n:"Locale",t:Tg},2147483651:{n:"Behavior",t:Tg},1919054434:{}},Rz={1:{n:"CodePage",t:Mb},2:{n:"Title",t:qn},3:{n:"Subject",t:qn},4:{n:"Author",t:qn},5:{n:"Keywords",t:qn},6:{n:"Comments",t:qn},7:{n:"Template",t:qn},8:{n:"LastAuthor",t:qn},9:{n:"RevNumber",t:qn},10:{n:"EditTime",t:Um},11:{n:"LastPrinted",t:Um},12:{n:"CreatedDate",t:Um},13:{n:"ModifiedDate",t:Um},14:{n:"PageCount",t:ta},15:{n:"WordCount",t:ta},16:{n:"CharCount",t:ta},17:{n:"Thumbnail",t:Pz},18:{n:"Application",t:qn},19:{n:"DocSecurity",t:ta},255:{},2147483648:{n:"Locale",t:Tg},2147483651:{n:"Behavior",t:Tg},1919054434:{}},zS={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Iz=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Mz(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Bz=Mz([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_u=is(Bz),Gu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},lC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},qS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function Uz(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function $z(e){var t=Uz();if(!e||!e.match)return t;var r={};if((e.match(Ps)||[]).forEach(function(n){var s=Tt(n);switch(s[0].replace(Y$,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[qS[s.ContentType]]!==void 0&&t[qS[s.ContentType]].push(s.PartName);break}}),t.xmlns!==iz.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var If={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tw(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function rh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ps)||[]).forEach(function(s){var a=Tt(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:R0(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var zz="application/vnd.oasis.opendocument.spreadsheet";function qz(e,t){for(var r=Pb(e),n,s;n=Gh.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Tt(n[0],!1),s.path=="/"&&s.type!==zz)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var nh=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Hz=function(){for(var e=new Array(nh.length),t=0;t<nh.length;++t){var r=nh[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function cC(e){var t={};e=Pr(e);for(var r=0;r<nh.length;++r){var n=nh[r],s=e.match(Hz[r]);s!=null&&s.length>0&&(t[n[1]]=ur(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Kn(t[n[1]]))}return t}var Wz=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function uC(e,t,r,n){var s=[];if(typeof e=="string")s=LS(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(u){return{v:u}}));var i=typeof t=="string"?LS(t,n).map(function(u){return u.v}):t,o=0,c=0;if(i.length>0)for(var f=0;f!==s.length;f+=2){switch(c=+s[f+1].v,s[f].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function Vz(e,t,r){var n={};return t||(t={}),e=Pr(e),Wz.forEach(function(s){var a=(e.match(Kh(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=ur(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&uC(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Kz=/<[^>]+>[^<]*/g;function Gz(e,t){var r={},n="",s=e.match(Kz);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Tt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ur(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),f=c[0].slice(4),u=c[1];switch(f){case"lpstr":case"bstr":case"lpwstr":r[n]=ur(u);break;case"bool":r[n]=$r(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Kn(u);break;case"cy":case"error":r[n]=ur(u);break;default:if(f.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,f,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Yz={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},rv;function Xz(e,t,r){rv||(rv=Ab(Yz)),t=rv[t]||t,e[t]=r}function Bb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function fC(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function dC(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function hC(e,t,r){return t===31?dC(e):fC(e,t,r)}function Cw(e,t,r){return hC(e,t,r===!1?0:4)}function Jz(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return hC(e,t,0)}function Qz(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Hs,""),e.l-s&2&&(e.l+=2)}return r}function Zz(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Hs,"");return r}function eq(e){var t=e.l,r=Cg(e,oC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Cg(e,ta);return[r,n]}function tq(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(eq(e));return r}function HS(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Hs,"").replace(O0,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function pC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function rq(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Cg(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==$S&&n!==t&&Dz.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$S?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return fC(e,n,4).replace(Hs,"");case 31:return dC(e);case 64:return Bb(e);case 65:return pC(e);case 71:return rq(e);case 80:return Cw(e,n,!a.raw).replace(Hs,"");case 81:return Jz(e,n).replace(Hs,"");case 4108:return tq(e);case 4126:case 4127:return n==4127?Qz(e):Zz(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function WS(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,f={};for(i=0;i!=s;++i){var u=e.read_shift(4),p=e.read_shift(4);a[i]=[u,p+r]}a.sort(function(b,w){return b[1]-w[1]});var d={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var h=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,h=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],h=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],h=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(h=!1,e.l=a[i][1]),h)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[a[i][0]];if(d[m.n]=Cg(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ci(o=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(a[i][0]===1){if(o=d.CodePage=Cg(e,Mb),Ci(o),c!==-1){var g=e.l;e.l=a[c][1],f=HS(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}f=HS(e,o)}else{var y=f[a[i][0]],v;switch(e[e.l]){case 65:e.l+=4,v=pC(e);break;case 30:e.l+=4,v=Cw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,v=Cw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,v=e.read_shift(4,"i");break;case 19:e.l+=4,v=e.read_shift(4);break;case 5:e.l+=4,v=e.read_shift(8,"f");break;case 11:e.l+=4,v=cn(e,4);break;case 64:e.l+=4,v=Kn(Bb(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[y]=v}}return e.l=r+n,d}function VS(e,t,r){var n=e.content;if(!n)return{};ss(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var f=n.read_shift(4),u=n.read_shift(16);if(u!==ar.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=WS(n,t),d={SystemIdentifier:f};for(var h in p)d[h]=p[h];if(d.FMTID=a,s===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var m;try{m=WS(n,null)}catch{}for(h in m)d[h]=m[h];return d.FMTID=[a,i],d}function Il(e,t){return e.read_shift(t),null}function nq(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function cn(e,t){return e.read_shift(t)===1}function kn(e){return e.read_shift(2,"u")}function mC(e,t){return nq(e,t,kn)}function sq(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function wp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function aq(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var f=a==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,f);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=u,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Iu(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function bp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Iu(e,n,r)}function Yu(e,t,r){if(r.biff>5)return bp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function iq(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function oq(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Hs,"");return n&&(e.l+=24),s}function lq(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Hs,"");return r+i}function cq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return oq(e);case"0303000000000000c000000000000046":return lq(e);default:throw new Error("Unsupported Moniker "+r)}}function $m(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Hs,""):"";return r}function uq(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,f="",u,p;s&16&&(a=$m(e,r-e.l)),s&128&&(i=$m(e,r-e.l)),(s&257)===257&&(o=$m(e,r-e.l)),(s&257)===1&&(c=cq(e,r-e.l)),s&8&&(f=$m(e,r-e.l)),s&32&&(u=e.read_shift(16)),s&64&&(p=Bb(e)),e.l=r;var d=i||o||c||"";d&&f&&(d+="#"+f),d||(d="#"+f),s&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var h={Target:d};return u&&(h.guid=u),p&&(h.time=p),a&&(h.Tooltip=a),h}function gC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function xC(e,t){var r=gC(e);return r[3]=0,r}function So(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function fq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function dq(e,t,r){return t===0?"":Yu(e,t,r)}function hq(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function vC(e){var t=e.read_shift(2),r=Ib(e);return[t,r]}function pq(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=wp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function kx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function yC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var mq=yC;function wC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function gq(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function xq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ms(e){e.l+=2,e.l+=e.read_shift(2)}var vq={0:ms,4:ms,5:ms,6:ms,7:xq,8:ms,9:ms,10:ms,11:ms,12:ms,13:gq,14:ms,15:ms,16:ms,17:ms,18:ms,19:ms,20:ms,21:wC};function yq(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(vq[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function zm(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function wq(e,t){return t===0||e.read_shift(2),1200}function bq(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Yu(e,0,r);return e.read_shift(t+n-e.l),s}function Nq(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Sq(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=wp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function _q(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(aq(e));return a.Count=n,a.Unique=s,a}function kq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Eq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function jq(e){var t=fq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Aq(e){return e.read_shift(2),e.read_shift(4)}function KS(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function Tq(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:f}}function Cq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Pq(){}function Fq(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=wp(e,0,r),n}function Lq(e){var t=So(e);return t.isst=e.read_shift(4),t}function Dq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=So(e);r.biff==2&&e.l++;var a=bp(e,n-e.l,r);return s.val=a,s}function Oq(e,t,r){var n=e.read_shift(2),s=Yu(e,0,r);return[n,s]}var Rq=Yu;function GS(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function Iq(e){var t=e.read_shift(2),r=e.read_shift(2),n=vC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Mq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(vC(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function Bq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Uq(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=Iz[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function $q(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Uq(e,t,n.fStyle,r),n}function zq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function YS(e,t,r){var n=So(e);(r.biff==2||t==9)&&++e.l;var s=sq(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function qq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=So(e),s=_s(e);return n.val=s,n}var XS=dq;function Hq(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Iu(e,a),o=[];n>e.l;)o.push(bp(e));return[a,s,i,o]}function JS(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=pq(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Wq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function QS(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var f=Iu(e,i,r);s&32&&(f=Wq[f.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var p=n==e.l||o===0||!(u>0)?[]:EK(e,u,r,o);return{chKey:a,Name:f,itab:c,rgce:p}}function bC(e,t,r){if(r.biff<8)return Vq(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(hq(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Vq(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=wp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Kq(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Iu(e,n,r),i=Iu(e,s,r);return[a,i]}function Gq(e,t,r){var n=yC(e);e.l++;var s=e.read_shift(1);return t-=8,[jK(e,t,r),s,n]}function ZS(e,t,r){var n=mq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,_K(e,t,r)]}function Yq(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Xq(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Yu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Jq(e,t,r){return Xq(e,t,r)}function Qq(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(kx(e));return r}function Zq(e,t,r){if(r&&r.biff<8)return tH(e,t,r);var n=wC(e),s=yq(e,t-22,n[1]);return{cmo:n,ft:s}}var eH={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function tH(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((eH[n]||Cs)(e,t,r)),{cmo:[s,n,a],ft:i}}function rH(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=iq(e,6,r);var o=e.read_shift(2);e.read_shift(2),kn(e,2);var c=e.read_shift(2);e.l+=c;for(var f=1;f<e.lens.length-1;++f){if(e.l-n!=e.lens[f])throw new Error("TxO: bad continue record");var u=e[e.l],p=Iu(e,e.lens[f+1]-e.lens[f]-1);if(s+=p,s.length>=(u?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function nH(e,t){var r=kx(e);e.l+=16;var n=uq(e,t-24);return[r,n]}function sH(e,t){e.read_shift(2);var r=kx(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Hs,""),[r,n]}function aH(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=zS[r]||r,r=e.read_shift(2),t[1]=zS[r]||r,t}function iH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xC(e));return r}function oH(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(xC(e));return r}function lH(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function NC(e,t,r){if(!r.cellStyles)return Cs(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var f={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(f.level=c>>8&7),f}function cH(e,t){var r={};return t<32||(e.l+=16,r.header=_s(e),r.footer=_s(e),e.l+=2),r}function uH(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var fH=So,dH=mC,hH=bp;function pH(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function mH(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=So(e);++e.l;var s=Yu(e,t-7,r);return n.t="str",n.val=s,n}function gH(e){var t=So(e);++e.l;var r=_s(e);return t.t="n",t.val=r,t}function xH(e){var t=So(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function vH(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function yH(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function wH(e,t,r){var n=e.l+t,s=So(e),a=e.read_shift(2),i=Iu(e,a,r);return e.l=n,s.t="str",s.val=i,s}var bH=[2,3,48,49,131,139,140,245],e_=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Ab({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var f=[],u=_c(1);switch(c.type){case"base64":u=ji(La(o));break;case"binary":u=ji(o);break;case"buffer":case"array":u=o;break}ss(u,0);var p=u.read_shift(1),d=!!(p&136),h=!1,m=!1;switch(p){case 2:break;case 3:break;case 48:h=!0,d=!0;break;case 49:h=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var g=0,y=521;p==2&&(g=u.read_shift(2)),u.l+=3,p!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),p!=2&&(y=u.read_shift(2));var v=u.read_shift(2),b=c.codepage||1252;p!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(b=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var w=[],S={},A=Math.min(u.length,p==2?521:y-10-(h?264:0)),F=m?32:11;u.l<A&&u[u.l]!=13;)switch(S={},S.name=Wh.utils.decode(b,u.slice(u.l,u.l+F)).replace(/[\u0000\r\n].*$/g,""),u.l+=F,S.type=String.fromCharCode(u.read_shift(1)),p!=2&&!m&&(S.offset=u.read_shift(4)),S.len=u.read_shift(1),p==2&&(S.offset=u.read_shift(2)),S.dec=u.read_shift(1),S.name.length&&w.push(S),p!=2&&(u.l+=m?13:14),S.type){case"B":(!h||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var T=0,O=0;for(f[0]=[],O=0;O!=w.length;++O)f[0][O]=w[O].name;for(;g-- >0;){if(u[u.l]===42){u.l+=v;continue}for(++u.l,f[++T]=[],O=0,O=0;O!=w.length;++O){var C=u.slice(u.l,u.l+w[O].len);u.l+=w[O].len,ss(C,0);var R=Wh.utils.decode(b,C);switch(w[O].type){case"C":R.trim().length&&(f[T][O]=R.replace(/\s+$/,""));break;case"D":R.length===8?f[T][O]=new Date(+R.slice(0,4),+R.slice(4,6)-1,+R.slice(6,8)):f[T][O]=R;break;case"F":f[T][O]=parseFloat(R.trim());break;case"+":case"I":f[T][O]=m?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(R.trim().toUpperCase()){case"Y":case"T":f[T][O]=!0;break;case"N":case"F":f[T][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+R+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));f[T][O]="##MEMO##"+(m?parseInt(R.trim(),10):C.read_shift(4));break;case"N":R=R.replace(/\u0000/g,"").trim(),R&&R!="."&&(f[T][O]=+R||0);break;case"@":f[T][O]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":f[T][O]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":f[T][O]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[T][O]=-C.read_shift(-8,"f");break;case"B":if(h&&w[O].len==8){f[T][O]=C.read_shift(8,"f");break}case"G":case"P":C.l+=w[O].len;break;case"0":if(w[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[O].type)}}}if(p!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=w,f}function n(o,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var u=Id(r(o,f),f);return u["!cols"]=f.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete f.DBF,u}function s(o,c){try{return Lc(n(o,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var f=c||{};if(+f.codepage>=0&&Ci(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var u=jw(),p=Iw(o,{header:1,raw:!0,cellDates:!0}),d=p[0],h=p.slice(1),m=o["!cols"]||[],g=0,y=0,v=0,b=1;for(g=0;g<d.length;++g){if(((m[g]||{}).DBF||{}).name){d[g]=m[g].DBF.name,++v;continue}if(d[g]!=null){if(++v,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(y=0;y<1024;++y)if(d.indexOf(d[g]+"_"+y)==-1){d[g]+="_"+y;break}}}}var w=nn(o["!ref"]),S=[],A=[],F=[];for(g=0;g<=w.e.c-w.s.c;++g){var T="",O="",C=0,R=[];for(y=0;y<h.length;++y)h[y][g]!=null&&R.push(h[y][g]);if(R.length==0||d[g]==null){S[g]="?";continue}for(y=0;y<R.length;++y){switch(typeof R[y]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=R[y]instanceof Date?"D":"C";break;default:O="C"}C=Math.max(C,String(R[y]).length),T=T&&T!=O?"C":O}C>250&&(C=250),O=((m[g]||{}).DBF||{}).type,O=="C"&&m[g].DBF.len>C&&(C=m[g].DBF.len),T=="B"&&O=="N"&&(T="N",F[g]=m[g].DBF.dec,C=m[g].DBF.len),A[g]=T=="C"||O=="N"?C:a[T]||0,b+=A[g],S[g]=T}var k=u.next(32);for(k.write_shift(4,318902576),k.write_shift(4,h.length),k.write_shift(2,296+32*v),k.write_shift(2,b),g=0;g<4;++g)k.write_shift(4,0);for(k.write_shift(4,0|(+t[bT]||3)<<8),g=0,y=0;g<d.length;++g)if(d[g]!=null){var P=u.next(32),q=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,q,"sbcs"),P.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),P.write_shift(4,y),P.write_shift(1,A[g]||a[S[g]]||0),P.write_shift(1,F[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),y+=A[g]||a[S[g]]||0}var D=u.next(264);for(D.write_shift(4,13),g=0;g<65;++g)D.write_shift(4,0);for(g=0;g<h.length;++g){var V=u.next(b);for(V.write_shift(1,0),y=0;y<d.length;++y)if(d[y]!=null)switch(S[y]){case"L":V.write_shift(1,h[g][y]==null?63:h[g][y]?84:70);break;case"B":V.write_shift(8,h[g][y]||0,"f");break;case"N":var se="0";for(typeof h[g][y]=="number"&&(se=h[g][y].toFixed(F[y]||0)),v=0;v<A[y]-se.length;++v)V.write_shift(1,32);V.write_shift(1,se,"sbcs");break;case"D":h[g][y]?(V.write_shift(4,("0000"+h[g][y].getFullYear()).slice(-4),"sbcs"),V.write_shift(2,("00"+(h[g][y].getMonth()+1)).slice(-2),"sbcs"),V.write_shift(2,("00"+h[g][y].getDate()).slice(-2),"sbcs")):V.write_shift(8,"00000000","sbcs");break;case"C":var ne=String(h[g][y]!=null?h[g][y]:"").slice(0,A[y]);for(V.write_shift(1,ne,"sbcs"),v=0;v<A[y]-ne.length;++v)V.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),NH=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+wo(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,h){var m=e[h];return typeof m=="number"?gS(m):m},n=function(d,h,m){var g=h.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?d:gS(g)};e["|"]=254;function s(d,h){switch(h.type){case"base64":return a(La(d),h);case"binary":return a(d,h);case"buffer":return a(rr&&Buffer.isBuffer(d)?d.toString("binary"):Wu(d),h);case"array":return a(Ru(d),h)}throw new Error("Unrecognized type "+h.type)}function a(d,h){var m=d.split(/[\n\r]+/),g=-1,y=-1,v=0,b=0,w=[],S=[],A=null,F={},T=[],O=[],C=[],R=0,k;for(+h.codepage>=0&&Ci(+h.codepage);v!==m.length;++v){R=0;var P=m[v].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=P.replace(/;;/g,"\0").split(";").map(function(z){return z.replace(/\u0000/g,";")}),D=q[0],V;if(P.length>0)switch(D){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var se=!1,ne=!1,X=!1,G=!1,ve=-1,ye=-1;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"A":break;case"X":y=parseInt(q[b].slice(1))-1,ne=!0;break;case"Y":for(g=parseInt(q[b].slice(1))-1,ne||(y=0),k=w.length;k<=g;++k)w[k]=[];break;case"K":V=q[b].slice(1),V.charAt(0)==='"'?V=V.slice(1,V.length-1):V==="TRUE"?V=!0:V==="FALSE"?V=!1:isNaN(Oi(V))?isNaN(Nd(V).getDate())||(V=Kn(V)):(V=Oi(V),A!==null&&Od(A)&&(V=_x(V))),se=!0;break;case"E":G=!0;var E=Jf(q[b].slice(1),{r:g,c:y});w[g][y]=[w[g][y],E];break;case"S":X=!0,w[g][y]=[w[g][y],"S5S"];break;case"G":break;case"R":ve=parseInt(q[b].slice(1))-1;break;case"C":ye=parseInt(q[b].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}if(se&&(w[g][y]&&w[g][y].length==2?w[g][y][0]=V:w[g][y]=V,A=null),X){if(G)throw new Error("SYLK shared formula cannot have own formula");var M=ve>-1&&w[ve][ye];if(!M||!M[1])throw new Error("SYLK shared formula cannot find base");w[g][y][1]=FC(M[1],{r:g-ve,c:y-ye})}break;case"F":var I=0;for(b=1;b<q.length;++b)switch(q[b].charAt(0)){case"X":y=parseInt(q[b].slice(1))-1,++I;break;case"Y":for(g=parseInt(q[b].slice(1))-1,k=w.length;k<=g;++k)w[k]=[];break;case"M":R=parseInt(q[b].slice(1))/20;break;case"F":break;case"G":break;case"P":A=S[parseInt(q[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=q[b].slice(1).split(" "),k=parseInt(C[0],10);k<=parseInt(C[1],10);++k)R=parseInt(C[2],10),O[k-1]=R===0?{hidden:!0}:{wch:R},Sd(O[k-1]);break;case"C":y=parseInt(q[b].slice(1))-1,O[y]||(O[y]={});break;case"R":g=parseInt(q[b].slice(1))-1,T[g]||(T[g]={}),R>0?(T[g].hpt=R,T[g].hpx=Jh(R)):R===0&&(T[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}I<1&&(A=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+P)}}return T.length>0&&(F["!rows"]=T),O.length>0&&(F["!cols"]=O),h&&h.sheetRows&&(w=w.slice(0,h.sheetRows)),[w,F]}function i(d,h){var m=s(d,h),g=m[0],y=m[1],v=Id(g,h);return wo(y).forEach(function(b){v[b]=y[b]}),v}function o(d,h){return Lc(i(d,h),h)}function c(d,h,m,g){var y="C;Y"+(m+1)+";X"+(g+1)+";K";switch(d.t){case"n":y+=d.v||0,d.f&&!d.F&&(y+=";E"+lV(d.f,{r:m,c:g}));break;case"b":y+=d.v?"TRUE":"FALSE";break;case"e":y+=d.w||d.v;break;case"d":y+='"'+(d.w||d.v)+'"';break;case"s":y+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function f(d,h){h.forEach(function(m,g){var y="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?y+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Fg(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Lg(m.wpx)),typeof m.wch=="number"&&(y+=Math.round(m.wch))),y.charAt(y.length-1)!=" "&&d.push(y)})}function u(d,h){h.forEach(function(m,g){var y="F;";m.hidden?y+="M0;":m.hpt?y+="M"+20*m.hpt+";":m.hpx&&(y+="M"+20*TC(m.hpx)+";"),y.length>2&&d.push(y+"R"+(g+1))})}function p(d,h){var m=["ID;PWXL;N;E"],g=[],y=nn(d["!ref"]),v,b=Array.isArray(d),w=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&f(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var S=y.s.r;S<=y.e.r;++S)for(var A=y.s.c;A<=y.e.c;++A){var F=Ut({r:S,c:A});v=b?(d[S]||[])[A]:d[F],!(!v||v.v==null&&(!v.f||v.F))&&g.push(c(v,d,S,A))}return m.join(w)+w+g.join(w)+w+"E"+w}return{to_workbook:o,to_sheet:i,from_sheet:p}}(),SH=function(){function e(a,i){switch(i.type){case"base64":return t(La(a),i);case"binary":return t(a,i);case"buffer":return t(rr&&Buffer.isBuffer(a)?a.toString("binary"):Wu(a),i);case"array":return t(Ru(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,f=-1,u=0,p=[];u!==o.length;++u){if(o[u].trim()==="BOT"){p[++c]=[],f=0;continue}if(!(c<0)){var d=o[u].trim().split(","),h=d[0],m=d[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+h){case-1:if(g==="BOT"){p[++c]=[],f=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?p[c][f]=!0:g==="FALSE"?p[c][f]=!1:isNaN(Oi(m))?isNaN(Nd(m).getDate())?p[c][f]=m:p[c][f]=Kn(m):p[c][f]=Oi(m),++f;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),p[c][f++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return Id(e(a,i),i)}function n(a,i){return Lc(r(a,i),i)}var s=function(){var a=function(c,f,u,p,d){c.push(f),c.push(u+","+p),c.push('"'+d.replace(/"/g,'""')+'"')},i=function(c,f,u,p){c.push(f+","+u),c.push(f==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var f=[],u=nn(c["!ref"]),p,d=Array.isArray(c);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,u.e.r-u.s.r+1,""),a(f,"TUPLES",0,u.e.c-u.s.c+1,""),a(f,"DATA",0,0,"");for(var h=u.s.r;h<=u.e.r;++h){i(f,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var g=Ut({r:h,c:m});if(p=d?(c[h]||[])[m]:c[g],!p){i(f,1,0,"");continue}switch(p.t){case"n":var y=p.w;!y&&p.v!=null&&(y=p.v),y==null?p.f&&!p.F?i(f,1,0,"="+p.f):i(f,1,0,""):i(f,0,y,"V");break;case"b":i(f,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(f,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=ti(p.z||Wt[14],Gs(Kn(p.v)))),i(f,0,p.w,"V");break;default:i(f,1,0,"")}}}i(f,-1,0,"EOD");var v=`\r
`,b=f.join(v);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),_H=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,d){for(var h=p.split(`
`),m=-1,g=-1,y=0,v=[];y!==h.length;++y){var b=h[y].trim().split(":");if(b[0]==="cell"){var w=zs(b[1]);if(v.length<=w.r)for(m=v.length;m<=w.r;++m)v[m]||(v[m]=[]);switch(m=w.r,g=w.c,b[2]){case"t":v[m][g]=e(b[3]);break;case"v":v[m][g]=+b[3];break;case"vtf":var S=b[b.length-1];case"vtc":switch(b[3]){case"nl":v[m][g]=!!+b[4];break;default:v[m][g]=+b[4];break}b[2]=="vtf"&&(v[m][g]=[v[m][g],S])}}}return d&&d.sheetRows&&(v=v.slice(0,d.sheetRows)),v}function n(p,d){return Id(r(p,d),d)}function s(p,d){return Lc(n(p,d),d)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(p){if(!p||!p["!ref"])return"";for(var d=[],h=[],m,g="",y=Rd(p["!ref"]),v=Array.isArray(p),b=y.s.r;b<=y.e.r;++b)for(var w=y.s.c;w<=y.e.c;++w)if(g=Ut({r:b,c:w}),m=v?(p[b]||[])[w]:p[g],!(!m||m.v==null||m.t==="z")){switch(h=["cell",g,"t"],m.t){case"s":case"str":h.push(t(m.v));break;case"n":m.f?(h[2]="vtf",h[3]="n",h[4]=m.v,h[5]=t(m.f)):(h[2]="v",h[3]=m.v);break;case"b":h[2]="vt"+(m.f?"f":"c"),h[3]="nl",h[4]=m.v?"1":"0",h[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=Gs(Kn(m.v));h[2]="vtc",h[3]="nd",h[4]=""+S,h[5]=m.w||ti(m.z||Wt[14],S);break;case"e":continue}d.push(h.join(":"))}return d.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(p){return[a,i,o,i,f(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:u}}(),Yh=function(){function e(u,p,d,h,m){m.raw?p[d][h]=u:u===""||(u==="TRUE"?p[d][h]=!0:u==="FALSE"?p[d][h]=!1:isNaN(Oi(u))?isNaN(Nd(u).getDate())?p[d][h]=u:p[d][h]=Kn(u):p[d][h]=Oi(u))}function t(u,p){var d=p||{},h=[];if(!u||u.length===0)return h;for(var m=u.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var y=10,v=0,b=0;b<=g;++b)v=m[b].indexOf(" "),v==-1?v=m[b].length:v++,y=Math.max(y,v);for(b=0;b<=g;++b){h[b]=[];var w=0;for(e(m[b].slice(0,y).trim(),h,b,w,d),w=1;w<=(m[b].length-y)/10+1;++w)e(m[b].slice(y+(w-1)*10,y+w*10).trim(),h,b,w,d)}return d.sheetRows&&(h=h.slice(0,d.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(u){for(var p={},d=!1,h=0,m=0;h<u.length;++h)(m=u.charCodeAt(h))==34?d=!d:!d&&m in r&&(p[m]=(p[m]||0)+1);m=[];for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&m.push([p[h],h]);if(!m.length){p=n;for(h in p)Object.prototype.hasOwnProperty.call(p,h)&&m.push([p[h],h])}return m.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[m.pop()[1]]||44}function a(u,p){var d=p||{},h="",m=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(h=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(h=u.charAt(4),u=u.slice(6)):h=s(u.slice(0,1024)):d&&d.FS?h=d.FS:h=s(u.slice(0,1024));var y=0,v=0,b=0,w=0,S=0,A=h.charCodeAt(0),F=!1,T=0,O=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var C=d.dateNF!=null?O$(d.dateNF):null;function R(){var k=u.slice(w,S),P={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)P.t="z";else if(d.raw)P.t="s",P.v=k;else if(k.trim().length===0)P.t="s",P.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(P.t="s",P.v=k.slice(2,-1).replace(/""/g,'"')):uV(k)?(P.t="n",P.f=k.slice(1)):(P.t="s",P.v=k);else if(k=="TRUE")P.t="b",P.v=!0;else if(k=="FALSE")P.t="b",P.v=!1;else if(!isNaN(b=Oi(k)))P.t="n",d.cellText!==!1&&(P.w=k),P.v=b;else if(!isNaN(Nd(k).getDate())||C&&k.match(C)){P.z=d.dateNF||Wt[14];var q=0;C&&k.match(C)&&(k=R$(k,d.dateNF,k.match(C)||[]),q=1),d.cellDates?(P.t="d",P.v=Kn(k,q)):(P.t="n",P.v=Gs(Kn(k,q))),d.cellText!==!1&&(P.w=ti(P.z,P.v instanceof Date?Gs(P.v):P.v)),d.cellNF||delete P.z}else P.t="s",P.v=k;if(P.t=="z"||(d.dense?(m[y]||(m[y]=[]),m[y][v]=P):m[Ut({c:v,r:y})]=P),w=S+1,O=u.charCodeAt(w),g.e.c<v&&(g.e.c=v),g.e.r<y&&(g.e.r=y),T==A)++v;else if(v=0,++y,d.sheetRows&&d.sheetRows<=y)return!0}e:for(;S<u.length;++S)switch(T=u.charCodeAt(S)){case 34:O===34&&(F=!F);break;case A:case 10:case 13:if(!F&&R())break e;break}return S-w>0&&R(),m["!ref"]=ir(g),m}function i(u,p){return!(p&&p.PRN)||p.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,p):Id(t(u,p),p)}function o(u,p){var d="",h=p.type=="string"?[0,0,0,0]:Kb(u,p);switch(p.type){case"base64":d=La(u);break;case"binary":d=u;break;case"buffer":p.codepage==65001?d=u.toString("utf8"):p.codepage&&typeof Wh<"u"||(d=rr&&Buffer.isBuffer(u)?u.toString("binary"):Wu(u));break;case"array":d=Ru(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+p.type)}return h[0]==239&&h[1]==187&&h[2]==191?d=Pr(d.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?d=Pr(d):p.type=="binary"&&typeof Wh<"u",d.slice(0,19)=="socialcalc:version:"?_H.to_sheet(p.type=="string"?d:Pr(d),p):i(d,p)}function c(u,p){return Lc(o(u,p),p)}function f(u){for(var p=[],d=nn(u["!ref"]),h,m=Array.isArray(u),g=d.s.r;g<=d.e.r;++g){for(var y=[],v=d.s.c;v<=d.e.c;++v){var b=Ut({r:g,c:v});if(h=m?(u[g]||[])[v]:u[b],!h||h.v==null){y.push("          ");continue}for(var w=(h.w||(pl(h),h.w)||"").slice(0,10);w.length<10;)w+=" ";y.push(w+(v===0?" ":""))}p.push(y.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:f}}();function kH(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=NH.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Yh.to_workbook(e,t)}}var sh=function(){function e(E,M,I){if(E){ss(E,E.l||0);for(var z=I.Enum||ve;E.l<E.length;){var te=E.read_shift(2),fe=z[te]||z[65535],ge=E.read_shift(2),he=E.l+ge,pe=fe.f&&fe.f(E,ge,I);if(E.l=he,M(pe,fe,te))return}}}function t(E,M){switch(M.type){case"base64":return r(ji(La(E)),M);case"binary":return r(ji(E),M);case"buffer":case"array":return r(E,M)}throw"Unsupported type "+M.type}function r(E,M){if(!E)return E;var I=M||{},z=I.dense?[]:{},te="Sheet1",fe="",ge=0,he={},pe=[],Le=[],ee={s:{r:0,c:0},e:{r:0,c:0}},We=I.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)I.Enum=ve,e(E,function(Me,rt,Be){switch(Be){case 0:I.vers=Me,Me>=4096&&(I.qpro=!0);break;case 6:ee=Me;break;case 204:Me&&(fe=Me);break;case 222:fe=Me;break;case 15:case 51:I.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:Be==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=I.dateNF||Wt[14],I.cellDates&&(Me[1].t="d",Me[1].v=_x(Me[1].v))),I.qpro&&Me[3]>ge&&(z["!ref"]=ir(ee),he[te]=z,pe.push(te),z=I.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ge=Me[3],te=fe||"Sheet"+(ge+1),fe="");var ft=I.dense?(z[Me[0].r]||[])[Me[0].c]:z[Ut(Me[0])];if(ft){ft.t=Me[1].t,ft.v=Me[1].v,Me[1].z!=null&&(ft.z=Me[1].z),Me[1].f!=null&&(ft.f=Me[1].f);break}I.dense?(z[Me[0].r]||(z[Me[0].r]=[]),z[Me[0].r][Me[0].c]=Me[1]):z[Ut(Me[0])]=Me[1];break}},I);else if(E[2]==26||E[2]==14)I.Enum=ye,E[2]==14&&(I.qpro=!0,E.l=0),e(E,function(Me,rt,Be){switch(Be){case 204:te=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>ge&&(z["!ref"]=ir(ee),he[te]=z,pe.push(te),z=I.dense?[]:{},ee={s:{r:0,c:0},e:{r:0,c:0}},ge=Me[3],te="Sheet"+(ge+1)),We>0&&Me[0].r>=We)break;I.dense?(z[Me[0].r]||(z[Me[0].r]=[]),z[Me[0].r][Me[0].c]=Me[1]):z[Ut(Me[0])]=Me[1],ee.e.c<Me[0].c&&(ee.e.c=Me[0].c),ee.e.r<Me[0].r&&(ee.e.r=Me[0].r);break;case 27:Me[14e3]&&(Le[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Le[Me[0]]=Me[1],Me[0]==ge&&(te=Me[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(z["!ref"]=ir(ee),he[fe||te]=z,pe.push(fe||te),!Le.length)return{SheetNames:pe,Sheets:he};for(var Ge={},J=[],Ue=0;Ue<Le.length;++Ue)he[pe[Ue]]?(J.push(Le[Ue]||pe[Ue]),Ge[Le[Ue]]=he[Le[Ue]]||he[pe[Ue]]):(J.push(Le[Ue]),Ge[Le[Ue]]={"!ref":"A1"});return{SheetNames:J,Sheets:Ge}}function n(E,M){var I=M||{};if(+I.codepage>=0&&Ci(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var z=jw(),te=nn(E["!ref"]),fe=Array.isArray(E),ge=[];mi(z,0,a(1030)),mi(z,6,c(te));for(var he=Math.min(te.e.r,8191),pe=te.s.r;pe<=he;++pe)for(var Le=os(pe),ee=te.s.c;ee<=te.e.c;++ee){pe===te.s.r&&(ge[ee]=Mn(ee));var We=ge[ee]+Le,Ge=fe?(E[pe]||[])[ee]:E[We];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?mi(z,13,h(pe,ee,Ge.v)):mi(z,14,g(pe,ee,Ge.v));else{var J=pl(Ge);mi(z,15,p(pe,ee,J.slice(0,239)))}}return mi(z,1),z.end()}function s(E,M){var I=M||{};if(+I.codepage>=0&&Ci(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var z=jw();mi(z,0,i(E));for(var te=0,fe=0;te<E.SheetNames.length;++te)(E.Sheets[E.SheetNames[te]]||{})["!ref"]&&mi(z,27,G(E.SheetNames[te],fe++));var ge=0;for(te=0;te<E.SheetNames.length;++te){var he=E.Sheets[E.SheetNames[te]];if(!(!he||!he["!ref"])){for(var pe=nn(he["!ref"]),Le=Array.isArray(he),ee=[],We=Math.min(pe.e.r,8191),Ge=pe.s.r;Ge<=We;++Ge)for(var J=os(Ge),Ue=pe.s.c;Ue<=pe.e.c;++Ue){Ge===pe.s.r&&(ee[Ue]=Mn(Ue));var Me=ee[Ue]+J,rt=Le?(he[Ge]||[])[Ue]:he[Me];if(!(!rt||rt.t=="z"))if(rt.t=="n")mi(z,23,R(Ge,Ue,ge,rt.v));else{var Be=pl(rt);mi(z,22,T(Ge,Ue,ge,Be.slice(0,239)))}}++ge}}return mi(z,1),z.end()}function a(E){var M=On(2);return M.write_shift(2,E),M}function i(E){var M=On(26);M.write_shift(2,4096),M.write_shift(2,4),M.write_shift(4,0);for(var I=0,z=0,te=0,fe=0;fe<E.SheetNames.length;++fe){var ge=E.SheetNames[fe],he=E.Sheets[ge];if(!(!he||!he["!ref"])){++te;var pe=Rd(he["!ref"]);I<pe.e.r&&(I=pe.e.r),z<pe.e.c&&(z=pe.e.c)}}return I>8191&&(I=8191),M.write_shift(2,I),M.write_shift(1,te),M.write_shift(1,z),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(1,1),M.write_shift(1,2),M.write_shift(4,0),M.write_shift(4,0),M}function o(E,M,I){var z={s:{c:0,r:0},e:{c:0,r:0}};return M==8&&I.qpro?(z.s.c=E.read_shift(1),E.l++,z.s.r=E.read_shift(2),z.e.c=E.read_shift(1),E.l++,z.e.r=E.read_shift(2),z):(z.s.c=E.read_shift(2),z.s.r=E.read_shift(2),M==12&&I.qpro&&(E.l+=2),z.e.c=E.read_shift(2),z.e.r=E.read_shift(2),M==12&&I.qpro&&(E.l+=2),z.s.c==65535&&(z.s.c=z.e.c=z.s.r=z.e.r=0),z)}function c(E){var M=On(8);return M.write_shift(2,E.s.c),M.write_shift(2,E.s.r),M.write_shift(2,E.e.c),M.write_shift(2,E.e.r),M}function f(E,M,I){var z=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(z[0].c=E.read_shift(1),z[3]=E.read_shift(1),z[0].r=E.read_shift(2),E.l+=2):(z[2]=E.read_shift(1),z[0].c=E.read_shift(2),z[0].r=E.read_shift(2)),z}function u(E,M,I){var z=E.l+M,te=f(E,M,I);if(te[1].t="s",I.vers==20768){E.l++;var fe=E.read_shift(1);return te[1].v=E.read_shift(fe,"utf8"),te}return I.qpro&&E.l++,te[1].v=E.read_shift(z-E.l,"cstr"),te}function p(E,M,I){var z=On(7+I.length);z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,E),z.write_shift(1,39);for(var te=0;te<z.length;++te){var fe=I.charCodeAt(te);z.write_shift(1,fe>=128?95:fe)}return z.write_shift(1,0),z}function d(E,M,I){var z=f(E,M,I);return z[1].v=E.read_shift(2,"i"),z}function h(E,M,I){var z=On(7);return z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,E),z.write_shift(2,I,"i"),z}function m(E,M,I){var z=f(E,M,I);return z[1].v=E.read_shift(8,"f"),z}function g(E,M,I){var z=On(13);return z.write_shift(1,255),z.write_shift(2,M),z.write_shift(2,E),z.write_shift(8,I,"f"),z}function y(E,M,I){var z=E.l+M,te=f(E,M,I);if(te[1].v=E.read_shift(8,"f"),I.qpro)E.l=z;else{var fe=E.read_shift(2);S(E.slice(E.l,E.l+fe),te),E.l+=fe}return te}function v(E,M,I){var z=M&32768;return M&=-32769,M=(z?E:0)+(M>=8192?M-16384:M),(z?"":"$")+(I?Mn(M):os(M))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(E,M){ss(E,0);for(var I=[],z=0,te="",fe="",ge="",he="";E.l<E.length;){var pe=E[E.l++];switch(pe){case 0:I.push(E.read_shift(8,"f"));break;case 1:fe=v(M[0].c,E.read_shift(2),!0),te=v(M[0].r,E.read_shift(2),!1),I.push(fe+te);break;case 2:{var Le=v(M[0].c,E.read_shift(2),!0),ee=v(M[0].r,E.read_shift(2),!1);fe=v(M[0].c,E.read_shift(2),!0),te=v(M[0].r,E.read_shift(2),!1),I.push(Le+ee+":"+fe+te)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(E.read_shift(2));break;case 6:{for(var We="";pe=E[E.l++];)We+=String.fromCharCode(pe);I.push('"'+We.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:he=I.pop(),ge=I.pop(),I.push(["AND","OR"][pe-20]+"("+ge+","+he+")");break;default:if(pe<32&&w[pe])he=I.pop(),ge=I.pop(),I.push(ge+w[pe]+he);else if(b[pe]){if(z=b[pe][1],z==69&&(z=E[E.l++]),z>I.length){console.error("WK1 bad formula parse 0x"+pe.toString(16)+":|"+I.join("|")+"|");return}var Ge=I.slice(-z);I.length-=z,I.push(b[pe][0]+"("+Ge.join(",")+")")}else return pe<=7?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=24?console.error("WK1 unsupported op "+pe.toString(16)):pe<=30?console.error("WK1 invalid opcode "+pe.toString(16)):pe<=115?console.error("WK1 unsupported function opcode "+pe.toString(16)):console.error("WK1 unrecognized opcode "+pe.toString(16))}}I.length==1?M[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function A(E){var M=[{c:0,r:0},{t:"n",v:0},0];return M[0].r=E.read_shift(2),M[3]=E[E.l++],M[0].c=E[E.l++],M}function F(E,M){var I=A(E);return I[1].t="s",I[1].v=E.read_shift(M-4,"cstr"),I}function T(E,M,I,z){var te=On(6+z.length);te.write_shift(2,E),te.write_shift(1,I),te.write_shift(1,M),te.write_shift(1,39);for(var fe=0;fe<z.length;++fe){var ge=z.charCodeAt(fe);te.write_shift(1,ge>=128?95:ge)}return te.write_shift(1,0),te}function O(E,M){var I=A(E);I[1].v=E.read_shift(2);var z=I[1].v>>1;if(I[1].v&1)switch(z&7){case 0:z=(z>>3)*5e3;break;case 1:z=(z>>3)*500;break;case 2:z=(z>>3)/20;break;case 3:z=(z>>3)/200;break;case 4:z=(z>>3)/2e3;break;case 5:z=(z>>3)/2e4;break;case 6:z=(z>>3)/16;break;case 7:z=(z>>3)/64;break}return I[1].v=z,I}function C(E,M){var I=A(E),z=E.read_shift(4),te=E.read_shift(4),fe=E.read_shift(2);if(fe==65535)return z===0&&te===3221225472?(I[1].t="e",I[1].v=15):z===0&&te===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var ge=fe&32768;return fe=(fe&32767)-16446,I[1].v=(1-ge*2)*(te*Math.pow(2,fe+32)+z*Math.pow(2,fe)),I}function R(E,M,I,z){var te=On(14);if(te.write_shift(2,E),te.write_shift(1,I),te.write_shift(1,M),z==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var fe=0,ge=0,he=0,pe=0;return z<0&&(fe=1,z=-z),ge=Math.log2(z)|0,z/=Math.pow(2,ge-31),pe=z>>>0,pe&2147483648||(z/=2,++ge,pe=z>>>0),z-=pe,pe|=2147483648,pe>>>=0,z*=Math.pow(2,32),he=z>>>0,te.write_shift(4,he),te.write_shift(4,pe),ge+=16383+(fe?32768:0),te.write_shift(2,ge),te}function k(E,M){var I=C(E);return E.l+=M-14,I}function P(E,M){var I=A(E),z=E.read_shift(4);return I[1].v=z>>6,I}function q(E,M){var I=A(E),z=E.read_shift(8,"f");return I[1].v=z,I}function D(E,M){var I=q(E);return E.l+=M-10,I}function V(E,M){return E[E.l+M-1]==0?E.read_shift(M,"cstr"):""}function se(E,M){var I=E[E.l++];I>M-1&&(I=M-1);for(var z="";z.length<I;)z+=String.fromCharCode(E[E.l++]);return z}function ne(E,M,I){if(!(!I.qpro||M<21)){var z=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var te=E.read_shift(M-21,"cstr");return[z,te]}}function X(E,M){for(var I={},z=E.l+M;E.l<z;){var te=E.read_shift(2);if(te==14e3){for(I[te]=[0,""],I[te][0]=E.read_shift(2);E[E.l];)I[te][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return I}function G(E,M){var I=On(5+E.length);I.write_shift(2,14e3),I.write_shift(2,M);for(var z=0;z<E.length;++z){var te=E.charCodeAt(z);I[I.l++]=te>127?95:te}return I[I.l++]=0,I}var ve={0:{n:"BOF",f:kn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:V},222:{n:"SHEETNAMELP",f:se},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:D},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:V},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ne},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function EH(e){var t={},r=e.match(Ps),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Tt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Sb[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var jH=function(){var e=Kh("t"),t=Kh("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ur(i[1])},c=a.match(t);return c&&(o.s=EH(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),AH=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),TH=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,CH=/<(?:\w+:)?r>/,PH=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Ub(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ur(Pr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Pr(e),r&&(n.h=Cb(n.t))):e.match(CH)&&(n.r=Pr(e),n.t=ur(Pr((e.replace(PH,"").match(TH)||[]).join("").replace(Ps,""))),r&&(n.h=AH(jH(n.r)))),n):{t:""}}var FH=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,LH=/<(?:\w+:)?(?:si|sstItem)>/g,DH=/<\/(?:\w+:)?(?:si|sstItem)>/;function OH(e,t){var r=[],n="";if(!e)return r;var s=e.match(FH);if(s){n=s[2].replace(LH,"").split(DH);for(var a=0;a!=n.length;++a){var i=Ub(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Tt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function RH(e){return[e.read_shift(4),e.read_shift(4)]}function IH(e,t){var r=[],n=!1;return vl(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function SC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ll(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function MH(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function BH(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function UH(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(BH(e));return t}function $H(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function zH(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function qH(e){var t=zH(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function _C(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function kC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function HH(e){var t=ll(e);switch(t.Minor){case 2:return[t.Minor,WH(e)];case 3:return[t.Minor,VH()];case 4:return[t.Minor,KH(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function WH(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=_C(e,r),s=kC(e,e.length-e.l);return{t:"Std",h:n,v:s}}function VH(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KH(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ps,function(a){var i=Tt(a);switch(No(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function GH(e,t){var r={},n=r.EncryptionVersionInfo=ll(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=_C(e,s),t-=s,r.EncryptionVerifier=kC(e,t),r}function YH(e){var t={},r=t.EncryptionVersionInfo=ll(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function XH(e){var t=0,r,n=SC(e),s=n.length+1,a,i,o,c,f;for(r=_c(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,f=o|c,t=f^i;return t^52811}var EC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,f=i.length-1;f>=0;--f)for(var u=i[f],p=0;p!=7;++p)u&64&&(o^=r[c]),u*=2,--c;return o};return function(i){for(var o=SC(i),c=a(o),f=o.length,u=_c(16),p=0;p!=16;++p)u[p]=0;var d,h,m;for((f&1)===1&&(d=c>>8,u[f]=s(e[0],d),--f,d=c&255,h=o[o.length-1],u[f]=s(h,d));f>0;)--f,d=c>>8,u[f]=s(o[f],d),--f,d=c&255,u[f]=s(o[f],d);for(f=15,m=15-o.length;m>0;)d=c>>8,u[f]=s(e[m],d),--f,--m,d=c&255,u[f]=s(o[f],d),--f,--m;return u}}(),JH=function(e,t,r,n,s){s||(s=t),n||(n=EC(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},QH=function(e){var t=0,r=EC(e);return function(n){var s=JH("",n,t,r);return t=s[1],s[0]}};function ZH(e,t,r,n){var s={key:kn(e),verificationBytes:kn(e)};return r.password&&(s.verifier=XH(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=QH(r.password)),s}function eW(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=YH(e):n.Data=GH(e,t),n}function tW(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?eW(e,t-2,n):ZH(e,r.biff>=8?t:t-2,r,n),n}var rW=function(){function e(s,a){switch(a.type){case"base64":return t(La(s),a);case"binary":return t(s,a);case"buffer":return t(rr&&Buffer.isBuffer(s)?s.toString("binary"):Wu(s),a);case"array":return t(Ru(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(u,p){Array.isArray(o)&&(o[p]=[]);for(var d=/\\\w+\b/g,h=0,m,g=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var y=u.slice(h,d.lastIndex-m[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var v={v:y,t:"s"};Array.isArray(o)?o[p][g]=v:o[Ut({r:p,c:g})]=v}break}h=d.lastIndex}g>f.e.c&&(f.e.c=g)}),o["!ref"]=ir(f),o}function r(s,a){return Lc(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=nn(s["!ref"]),o,c=Array.isArray(s),f=i.s.r;f<=i.e.r;++f){a.push("\\trowd\\trautofit1");for(var u=i.s.c;u<=i.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=i.s.c;u<=i.e.c;++u){var p=Ut({r:f,c:u});o=c?(s[f]||[])[u]:s[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(pl(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function nW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Xh(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function sW(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,f=s+a;switch(c=i/(f>1?2-f:f),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,f/2]}function aW(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var f=0;f!=3;++f)i[f]=Math.round(i[f]*255);return i}function Pg(e,t){if(t===0)return e;var r=sW(nW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Xh(aW(r))}var jC=6,iW=15,oW=1,Us=jC;function Fg(e){return Math.floor((e+Math.round(128/Us)/256)*Us)}function Lg(e){return Math.floor((e-5)/Us*100+.5)/100}function Pw(e){return Math.round((e*Us+5)/Us*256)/256}function nv(e){return Pw(Lg(Fg(e)))}function $b(e){var t=Math.abs(e-nv(e)),r=Us;if(t>.005)for(Us=oW;Us<iW;++Us)Math.abs(e-nv(e))<=t&&(t=Math.abs(e-nv(e)),r=Us);Us=r}function Sd(e){e.width?(e.wpx=Fg(e.width),e.wch=Lg(e.wpx),e.MDW=Us):e.wpx?(e.wch=Lg(e.wpx),e.width=Pw(e.wch),e.MDW=Us):typeof e.wch=="number"&&(e.width=Pw(e.wch),e.wpx=Fg(e.width),e.MDW=Us),e.customWidth&&delete e.customWidth}var lW=96,AC=lW;function TC(e){return e*96/AC}function Jh(e){return e*AC/96}var cW={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function uW(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Ps)||[]).forEach(function(i){var o=Tt(i);switch(No(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=$r(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=$r(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function fW(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Ps)||[]).forEach(function(i){var o=Tt(i);switch(No(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function dW(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Ps)||[]).forEach(function(i){var o=Tt(i);switch(No(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Pr(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?$r(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?$r(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?$r(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?$r(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?$r(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?$r(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?$r(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Sb[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=$r(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=_u[s.color.index];s.color.index==81&&(c=_u[1]),c||(c=_u[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Pg(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function hW(e,t,r){t.NumberFmt=[];for(var n=wo(Wt),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Wt[n[s]];var a=e[0].match(Ps);if(a)for(s=0;s<a.length;++s){var i=Tt(a[s]);switch(No(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ur(Pr(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}Su(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var qm=["numFmtId","fillId","fontId","borderId","xfId"],Hm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pW(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Ps)||[]).forEach(function(a){var i=Tt(a),o=0;switch(No(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<qm.length;++o)n[qm[o]]&&(n[qm[o]]=parseInt(n[qm[o]],10));for(o=0;o<Hm.length;++o)n[Hm[o]]&&(n[Hm[o]]=$r(n[Hm[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=$r(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var mW=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,f){var u={};if(!o)return u;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&hW(p,u,f),(p=o.match(s))&&dW(p,u,c,f),(p=o.match(n))&&fW(p,u,c,f),(p=o.match(a))&&uW(p,u,c,f),(p=o.match(r))&&pW(p,u,f),u}}();function gW(e,t){var r=e.read_shift(2),n=js(e);return[r,n]}function xW(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=jz(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Ez(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=js(e),n}var vW=Cs;function yW(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var wW=Cs;function bW(e,t,r){var n={};n.NumberFmt=[];for(var s in Wt)n.NumberFmt[s]=Wt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return vl(e,function(c,f,u){switch(u){case 44:n.NumberFmt[c[0]]=c[1],Su(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Pg(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(u),i=!0;break;case 38:a.pop(),i=!1;break;default:if(f.T>0)a.push(u);else if(f.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}var NW=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function SW(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ps)||[]).forEach(function(s){var a=Tt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[NW.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function _W(){}function kW(){}var EW=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,jW=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,AW=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function TW(e,t,r){t.themeElements={};var n;[["clrScheme",EW,SW],["fontScheme",jW,_W],["fmtScheme",AW,kW]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var CW=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function CC(e,t){(!e||e.length===0)&&(e=PW());var r,n={};if(!(r=e.match(CW)))throw new Error("themeElements not found in theme");return TW(r[0],n,t),n.raw=e,n}function PW(e,t){var r=[$T];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function FW(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=UT(a,{type:"array"})}catch{return}var o=Ea(i,"theme/theme/theme1.xml",!0);if(o)return CC(o,r)}}function LW(e){return e.read_shift(4)}function DW(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=OW(e,4);break;case 2:t.xclrValue=gC(e);break;case 3:t.xclrValue=LW(e);break;case 4:e.l+=4;break}return e.l+=8,t}function OW(e,t){return Cs(e,t)}function RW(e,t){return Cs(e,t)}function IW(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=DW(e);break;case 6:n[1]=RW(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function MW(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(IW(e,r-e.l));return{ixfe:n,ext:a}}function BW(e,t){t.forEach(function(r){switch(r[0]){}})}function UW(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:js(e)}}function $W(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zW(e){return e.l+=4,e.read_shift(4)!=0}function qW(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return vl(e,function(c,f,u){switch(u){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(u),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!f.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function HW(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Ps,function(o){var c=Tt(o);switch(No(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var f=0;f<n.Types.length;++f)n.Types[f].name==c.name&&(i=n.Types[f]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function WW(e){var t=[];if(!e)return t;var r=1;return(e.match(Ps)||[]).forEach(function(n){var s=Tt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function VW(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Ut(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function KW(e,t,r){var n=[];return vl(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function GW(e,t,r,n){if(!e)return e;var s=n||{},a=!1;vl(e,function(o,c,f){switch(f){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}},s)}function YW(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function t_(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=zs(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=nn(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var f=ir(c);f!==e["!ref"]&&(e["!ref"]=f)}a.c||(a.c=[]);var u={a:i.author,t:i.t,r:i.r,T:r};i.h&&(u.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(u.a==n[p].id){u.a=n[p].name||u.a;break}}a.c.push(u)})}function XW(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Tt(o[0]),f={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},u=zs(c.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!p&&!!p[1]&&Ub(p[1])||{r:"",t:"",h:""};f.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),f.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(f.h=d.h),n.push(f)}}}}),n}function JW(e,t){var r=[],n=!1,s={},a=0;return e.replace(Ps,function(o,c){var f=Tt(o);switch(No(f[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:f.personId,guid:f.id,ref:f.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in threaded comments")}return o}),r}function QW(e,t){var r=[],n=!1;return e.replace(Ps,function(a){var i=Tt(a);switch(No(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function ZW(e){var t={};t.iauthor=e.read_shift(4);var r=Ku(e);return t.rfx=r.s,t.ref=Ut(r.s),e.l+=16,t}var eV=js;function tV(e,t){var r=[],n=[],s={},a=!1;return vl(e,function(o,c,f){switch(f){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}),r}var rV="application/vnd.ms-office.vbaProject";function nV(e){var t=ar.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ar.utils.cfb_add(t,s,e.FileIndex[n].content)}}),ar.write(t)}function sV(){return{"!type":"dialog"}}function aV(){return{"!type":"dialog"}}function iV(){return{"!type":"macro"}}function oV(){return{"!type":"macro"}}var Jf=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,u=i.length>0?parseInt(i,10)|0:0;return o?u+=t.c:--u,c?f+=t.r:--f,s+(o?"":"$")+Mn(u)+(c?"":"$")+os(f)}return function(s,a){return t=a,s.replace(e,r)}}(),PC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lV=function(){return function(t,r){return t.replace(PC,function(n,s,a,i,o,c){var f=Db(i)-(a?0:r.c),u=Lb(c)-(o?0:r.r),p=u==0?"":o?u+1:"["+u+"]",d=f==0?"":a?f+1:"["+f+"]";return s+"R"+p+"C"+d})}}();function FC(e,t){return e.replace(PC,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Mn(Db(a)+t.c))+(i=="$"?i+o:os(Lb(o)+t.r))})}function cV(e,t,r){var n=Rd(t),s=n.s,a=zs(r),i={r:a.r-s.r,c:a.c-s.c};return FC(e,i)}function uV(e){return e.length!=1}function r_(e){return e.replace(/_xlfn\./g,"")}function Nn(e){e.l+=1}function kc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function LC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return DC(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=kc(e),o=kc(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function DC(e){var t=kc(e),r=kc(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function fV(e,t,r){if(r.biff<8)return DC(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=kc(e),i=kc(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function OC(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return dV(e);var n=e.read_shift(r&&r.biff==12?4:2),s=kc(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function dV(e){var t=kc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function hV(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function pV(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return mV(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function mV(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function gV(e,t,r){var n=(e[e.l++]&96)>>5,s=LC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function xV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=LC(e,a,r);return[n,s,i]}function vV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function yV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function wV(e,t,r){var n=(e[e.l++]&96)>>5,s=fV(e,t-1,r);return[n,s]}function bV(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function n_(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function NV(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function SV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function _V(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function kV(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function EV(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function RC(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function jV(e){return e.read_shift(2),RC(e)}function AV(e){return e.read_shift(2),RC(e)}function TV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=OC(e,0,r);return[n,s]}function CV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=pV(e,0,r);return[n,s]}function PV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=OC(e,0,r);return[n,s,a]}function FV(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[LK[s],BC[s],n]}function LV(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:DV(e);return[s,(a[0]===0?BC:FK)[a[1]]]}function DV(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function OV(e,t,r){e.l+=r&&r.biff==2?3:4}function RV(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function IV(e){return e.l++,Gu[e.read_shift(1)]}function MV(e){return e.l++,e.read_shift(2)}function BV(e){return e.l++,e.read_shift(1)!==0}function UV(e){return e.l++,_s(e)}function $V(e,t,r){return e.l++,wp(e,t-1,r)}function zV(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=cn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Gu[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=_s(e);break;case 2:r[1]=Yu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function qV(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Ku:kx)(e));return s}function HV(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=zV(e,r.biff);return i}function WV(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function VV(e,t,r){if(r.biff==5)return KV(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function KV(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function GV(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function YV(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function XV(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function JV(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var QV=Cs,ZV=Cs,eK=Cs;function Np(e,t,r){return e.l+=2,[hV(e)]}function zb(e){return e.l+=6,[]}var tK=Np,rK=zb,nK=zb,sK=Np;function IC(e){return e.l+=2,[kn(e),e.read_shift(2)&1]}var aK=Np,iK=IC,oK=zb,lK=Np,cK=Np,uK=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function fK(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=uK[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function dK(e){return e.l+=2,[e.read_shift(4)]}function hK(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function pK(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function mK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function gK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function xK(e){return e.l+=4,[0,0]}var s_={1:{n:"PtgExp",f:RV},2:{n:"PtgTbl",f:eK},3:{n:"PtgAdd",f:Nn},4:{n:"PtgSub",f:Nn},5:{n:"PtgMul",f:Nn},6:{n:"PtgDiv",f:Nn},7:{n:"PtgPower",f:Nn},8:{n:"PtgConcat",f:Nn},9:{n:"PtgLt",f:Nn},10:{n:"PtgLe",f:Nn},11:{n:"PtgEq",f:Nn},12:{n:"PtgGe",f:Nn},13:{n:"PtgGt",f:Nn},14:{n:"PtgNe",f:Nn},15:{n:"PtgIsect",f:Nn},16:{n:"PtgUnion",f:Nn},17:{n:"PtgRange",f:Nn},18:{n:"PtgUplus",f:Nn},19:{n:"PtgUminus",f:Nn},20:{n:"PtgPercent",f:Nn},21:{n:"PtgParen",f:Nn},22:{n:"PtgMissArg",f:Nn},23:{n:"PtgStr",f:$V},26:{n:"PtgSheet",f:hK},27:{n:"PtgEndSheet",f:pK},28:{n:"PtgErr",f:IV},29:{n:"PtgBool",f:BV},30:{n:"PtgInt",f:MV},31:{n:"PtgNum",f:UV},32:{n:"PtgArray",f:bV},33:{n:"PtgFunc",f:FV},34:{n:"PtgFuncVar",f:LV},35:{n:"PtgName",f:WV},36:{n:"PtgRef",f:TV},37:{n:"PtgArea",f:gV},38:{n:"PtgMemArea",f:GV},39:{n:"PtgMemErr",f:QV},40:{n:"PtgMemNoMem",f:ZV},41:{n:"PtgMemFunc",f:YV},42:{n:"PtgRefErr",f:XV},43:{n:"PtgAreaErr",f:vV},44:{n:"PtgRefN",f:CV},45:{n:"PtgAreaN",f:wV},46:{n:"PtgMemAreaN",f:mK},47:{n:"PtgMemNoMemN",f:gK},57:{n:"PtgNameX",f:VV},58:{n:"PtgRef3d",f:PV},59:{n:"PtgArea3d",f:xV},60:{n:"PtgRefErr3d",f:JV},61:{n:"PtgAreaErr3d",f:yV},255:{}},vK={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},yK={1:{n:"PtgElfLel",f:IC},2:{n:"PtgElfRw",f:lK},3:{n:"PtgElfCol",f:tK},6:{n:"PtgElfRwV",f:cK},7:{n:"PtgElfColV",f:sK},10:{n:"PtgElfRadical",f:aK},11:{n:"PtgElfRadicalS",f:oK},13:{n:"PtgElfColS",f:rK},15:{n:"PtgElfColSV",f:nK},16:{n:"PtgElfRadicalLel",f:iK},25:{n:"PtgList",f:fK},29:{n:"PtgSxName",f:dK},255:{}},wK={0:{n:"PtgAttrNoop",f:xK},1:{n:"PtgAttrSemi",f:EV},2:{n:"PtgAttrIf",f:_V},4:{n:"PtgAttrChoose",f:NV},8:{n:"PtgAttrGoto",f:SV},16:{n:"PtgAttrSum",f:OV},32:{n:"PtgAttrBaxcel",f:n_},33:{n:"PtgAttrBaxcel",f:n_},64:{n:"PtgAttrSpace",f:jV},65:{n:"PtgAttrSpaceSemi",f:AV},128:{n:"PtgAttrIfError",f:kV},255:{}};function Sp(e,t,r,n){if(n.biff<8)return Cs(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=HV(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=qV(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Cs(e,t)),a}function _p(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=s_[a]||s_[vK[a]],(a===24||a===25)&&(s=(a===24?yK:wK)[e[e.l+1]]),!s||!s.f?Cs(e,t):i.push([s.n,s.f(e,t,r)]);return i}function bK(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var NK={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function SK(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function MC(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function a_(e,t,r){var n=MC(e,t,r);return n=="#REF"?n:SK(n,r)}function ws(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,f,u,p=0,d=0,h,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",v=0,b=e[0].length;v<b;++v){var w=e[0][v];switch(w[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),f=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=rn(" ",e[0][g][1][1]);break;case 1:y=rn("\r",e[0][g][1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}f=f+y,g=-1}o.push(f+NK[w[0]]+c);break;case"PtgIsect":c=o.pop(),f=o.pop(),o.push(f+" "+c);break;case"PtgUnion":c=o.pop(),f=o.pop(),o.push(f+","+c);break;case"PtgRange":c=o.pop(),f=o.pop(),o.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=eh(w[1][1],i,s),o.push(th(u,a));break;case"PtgRefN":u=r?eh(w[1][1],r,s):w[1][1],o.push(th(u,a));break;case"PtgRef3d":p=w[1][1],u=eh(w[1][2],i,s),m=a_(n,p,s),o.push(m+"!"+th(u,a));break;case"PtgFunc":case"PtgFuncVar":var S=w[1][0],A=w[1][1];S||(S=0),S&=127;var F=S==0?[]:o.slice(-S);o.length-=S,A==="User"&&(A=F.shift()),o.push(A+"("+F.join(",")+")");break;case"PtgBool":o.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(w[1]);break;case"PtgNum":o.push(String(w[1]));break;case"PtgStr":o.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(w[1]);break;case"PtgAreaN":h=BS(w[1][1],r?{s:r}:i,s),o.push(tv(h,s));break;case"PtgArea":h=BS(w[1][1],i,s),o.push(tv(h,s));break;case"PtgArea3d":p=w[1][1],h=w[1][2],m=a_(n,p,s),o.push(m+"!"+tv(h,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=w[1][2];var T=(n.names||[])[d-1]||(n[0]||[])[d],O=T?T.Name:"SH33TJSNAME"+String(d);O&&O.slice(0,6)=="_xlfn."&&!s.xlfn&&(O=O.slice(6)),o.push(O);break;case"PtgNameX":var C=w[1][1];d=w[1][2];var R;if(s.biff<=5)C<0&&(C=-C),n[C]&&(R=n[C][d]);else{var k="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(k=n.SheetNames[n[C][d].itab-1]+"!"):k=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])k+=n[C][d].Name;else if(n[0]&&n[0][d])k+=n[0][d].Name;else{var P=(MC(n,C,s)||"").split(";;");P[d-1]?k=P[d-1]:k+="SH33TJSERRX"}o.push(k);break}R||(R={Name:"SH33TJSERRY"}),o.push(R.Name);break;case"PtgParen":var q="(",D=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:q=rn(" ",e[0][g][1][1])+q;break;case 3:q=rn("\r",e[0][g][1][1])+q;break;case 4:D=rn(" ",e[0][g][1][1])+D;break;case 5:D=rn("\r",e[0][g][1][1])+D;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(q+o.pop()+D);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:w[1][1],r:w[1][0]};var V={c:r.c,r:r.r};if(n.sharedf[Ut(u)]){var se=n.sharedf[Ut(u)];o.push(ws(se,i,V,n,s))}else{var ne=!1;for(c=0;c!=n.arrayf.length;++c)if(f=n.arrayf[c],!(u.c<f[0].s.c||u.c>f[0].e.c)&&!(u.r<f[0].s.r||u.r>f[0].e.r)){o.push(ws(f[1],i,V,n,s)),ne=!0;break}ne||o.push(w[1])}break;case"PtgArray":o.push("{"+bK(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=v;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var X=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&X.indexOf(e[0][v][0])==-1){w=e[0][g];var G=!0;switch(w[1][0]){case 4:G=!1;case 0:y=rn(" ",w[1][1]);break;case 5:G=!1;case 1:y=rn("\r",w[1][1]);break;default:if(y="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}o.push((G?y:"")+o.pop()+(G?"":y)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function _K(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Cs(e,t-2)];var o=_p(e,i,r);return t!==i+s&&(a=Sp(e,t-i-s,o,r)),e.l=n,[o,a]}function kK(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Cs(e,t-2)];var o=_p(e,i,r);return t!==i+s&&(a=Sp(e,t-i-s,o,r)),e.l=n,[o,a]}function EK(e,t,r,n){var s=e.l+t,a=_p(e,n,r),i;return s!==e.l&&(i=Sp(e,s-e.l,a,r)),[a,i]}function jK(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=_p(e,a,r);return a==65535?[[],Cs(e,t-2)]:(t!==a+2&&(s=Sp(e,n-a-2,i,r)),[i,s])}function AK(e){var t;if(rl(e,e.l+6)!==65535)return[_s(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function sv(e,t,r){var n=e.l+t,s=So(e);r.biff==2&&++e.l;var a=AK(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=kK(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Ex(e,t,r){var n=e.read_shift(4),s=_p(e,n,r),a=e.read_shift(4),i=a>0?Sp(e,a,s,r):null;return[s,i]}var TK=Ex,jx=Ex,CK=Ex,PK=Ex,FK={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},BC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},LK={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function i_(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function av(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ah={},Qf={};function ih(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function UC(e,t,r,n,s,a){try{n.cellNF&&(e.z=Wt[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Kn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Wt[t]==null&&Su(D$[t]||"General",t),e.t==="e")e.w=e.w||Gu[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v);else if(e.t==="d"){var i=Gs(e.v);(i|0)===i?e.w=i.toString(10):e.w=Vh(i)}else{if(e.v===void 0)return"";e.w=Ou(e.v,Qf)}else e.t==="d"?e.w=ti(t,Gs(e.v),Qf):e.w=ti(t,e.v,Qf)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Pg(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Pg(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function DK(e,t){var r=nn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=ir(r))}var OK=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,RK=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IK=/<(?:\w:)?hyperlink [^>]*>/mg,MK=/"(\w*:\w*)"/,BK=/<(?:\w:)?col\b[^>]*[\/]?>/g,UK=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,$K=/<(?:\w:)?pageMargins[^>]*\/>/g,$C=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,zK=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qK=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function HK(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},f="",u="",p=e.match(RK);p?(f=e.slice(0,p.index),u=e.slice(p.index+p[0].length)):f=u=e;var d=f.match($C);d?qb(d[0],o,s,r):(d=f.match(zK))&&WK(d[0],d[1]||"",o,s,r);var h=(f.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(h>0){var m=f.slice(h,h+50).match(MK);m&&DK(o,m[1])}var g=f.match(qK);g&&g[1]&&JK(g[1],s);var y=[];if(t.cellStyles){var v=f.match(BK);v&&GK(y,v)}p&&QK(p[1],o,t,c,a,i);var b=u.match(UK);b&&(o["!autofilter"]=YK(b[0]));var w=[],S=u.match(OK);if(S)for(h=0;h!=S.length;++h)w[h]=nn(S[h].slice(S[h].indexOf('"')+1));var A=u.match(IK);A&&VK(o,A,n);var F=u.match($K);if(F&&(o["!margins"]=KK(Tt(F[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=ir(c)),t.sheetRows>0&&o["!ref"]){var T=nn(o["!ref"]);t.sheetRows<=+T.e.r&&(T.e.r=t.sheetRows-1,T.e.r>c.e.r&&(T.e.r=c.e.r),T.e.r<T.s.r&&(T.s.r=T.e.r),T.e.c>c.e.c&&(T.e.c=c.e.c),T.e.c<T.s.c&&(T.s.c=T.e.c),o["!fullref"]=o["!ref"],o["!ref"]=ir(T))}return y.length>0&&(o["!cols"]=y),w.length>0&&(o["!merges"]=w),o}function qb(e,t,r,n){var s=Tt(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=ur(Pr(s.codeName)))}function WK(e,t,r,n,s){qb(e.slice(0,e.indexOf(">")),r,n,s)}function VK(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Tt(Pr(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+ur(a.location))):(a.Target="#"+ur(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=nn(a.ref),c=o.s.r;c<=o.e.r;++c)for(var f=o.s.c;f<=o.e.c;++f){var u=Ut({c:f,r:c});n?(e[c]||(e[c]=[]),e[c][f]||(e[c][f]={t:"z",v:void 0}),e[c][f].l=a):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=a)}}}function KK(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function GK(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Tt(t[n],!0);s.hidden&&(s.hidden=$r(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,$b(s.width)),Sd(s);a<=i;)e[a++]=is(s)}}function YK(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var XK=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function JK(e,t){t.Views||(t.Views=[{}]),(e.match(XK)||[]).forEach(function(r,n){var s=Tt(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),$r(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var QK=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Kh("v"),i=Kh("f");return function(c,f,u,p,d,h){for(var m=0,g="",y=[],v=[],b=0,w=0,S=0,A="",F,T,O=0,C=0,R,k,P=0,q=0,D=Array.isArray(h.CellXf),V,se=[],ne=[],X=Array.isArray(f),G=[],ve={},ye=!1,E=!!u.sheetStubs,M=c.split(t),I=0,z=M.length;I!=z;++I){g=M[I].trim();var te=g.length;if(te!==0){var fe=0;e:for(m=0;m<te;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(T=Tt(g.slice(fe,m),!0),O=T.r!=null?parseInt(T.r,10):O+1,C=-1,u.sheetRows&&u.sheetRows<O)continue;ve={},ye=!1,T.ht&&(ye=!0,ve.hpt=parseFloat(T.ht),ve.hpx=Jh(ve.hpt)),T.hidden=="1"&&(ye=!0,ve.hidden=!0),T.outlineLevel!=null&&(ye=!0,ve.level=+T.outlineLevel),ye&&(G[O-1]=ve)}break;case"<":fe=m;break}if(fe>=m)break;if(T=Tt(g.slice(fe,m),!0),O=T.r!=null?parseInt(T.r,10):O+1,C=-1,!(u.sheetRows&&u.sheetRows<O)){p.s.r>O-1&&(p.s.r=O-1),p.e.r<O-1&&(p.e.r=O-1),u&&u.cellStyles&&(ve={},ye=!1,T.ht&&(ye=!0,ve.hpt=parseFloat(T.ht),ve.hpx=Jh(ve.hpt)),T.hidden=="1"&&(ye=!0,ve.hidden=!0),T.outlineLevel!=null&&(ye=!0,ve.level=+T.outlineLevel),ye&&(G[O-1]=ve)),y=g.slice(m).split(e);for(var ge=0;ge!=y.length&&y[ge].trim().charAt(0)=="<";++ge);for(y=y.slice(ge),m=0;m!=y.length;++m)if(g=y[m].trim(),g.length!==0){if(v=g.match(r),b=m,w=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,v!=null&&v.length===2){for(b=0,A=v[1],w=0;w!=A.length&&!((S=A.charCodeAt(w)-64)<1||S>26);++w)b=26*b+S;--b,C=b}else++C;for(w=0;w!=g.length&&g.charCodeAt(w)!==62;++w);if(++w,T=Tt(g.slice(0,w),!0),T.r||(T.r=Ut({r:O-1,c:C})),A=g.slice(w),F={t:""},(v=A.match(a))!=null&&v[1]!==""&&(F.v=ur(v[1])),u.cellFormula){if((v=A.match(i))!=null&&v[1]!==""){if(F.f=ur(Pr(v[1])).replace(/\r\n/g,`
`),u.xlfn||(F.f=r_(F.f)),v[0].indexOf('t="array"')>-1)F.F=(A.match(s)||[])[1],F.F.indexOf(":")>-1&&se.push([nn(F.F),F.F]);else if(v[0].indexOf('t="shared"')>-1){k=Tt(v[0]);var he=ur(Pr(v[1]));u.xlfn||(he=r_(he)),ne[parseInt(k.si,10)]=[k,he,T.r]}}else(v=A.match(/<f[^>]*\/>/))&&(k=Tt(v[0]),ne[k.si]&&(F.f=cV(ne[k.si][1],ne[k.si][2],T.r)));var pe=zs(T.r);for(w=0;w<se.length;++w)pe.r>=se[w][0].s.r&&pe.r<=se[w][0].e.r&&pe.c>=se[w][0].s.c&&pe.c<=se[w][0].e.c&&(F.F=se[w][1])}if(T.t==null&&F.v===void 0)if(F.f||F.F)F.v=0,F.t="n";else if(E)F.t="z";else continue;else F.t=T.t||"n";switch(p.s.c>C&&(p.s.c=C),p.e.c<C&&(p.e.c=C),F.t){case"n":if(F.v==""||F.v==null){if(!E)continue;F.t="z"}else F.v=parseFloat(F.v);break;case"s":if(typeof F.v>"u"){if(!E)continue;F.t="z"}else R=ah[parseInt(F.v,10)],F.v=R.t,F.r=R.r,u.cellHTML&&(F.h=R.h);break;case"str":F.t="s",F.v=F.v!=null?Pr(F.v):"",u.cellHTML&&(F.h=Cb(F.v));break;case"inlineStr":v=A.match(n),F.t="s",v!=null&&(R=Ub(v[1]))?(F.v=R.t,u.cellHTML&&(F.h=R.h)):F.v="";break;case"b":F.v=$r(F.v);break;case"d":u.cellDates?F.v=Kn(F.v,1):(F.v=Gs(Kn(F.v,1)),F.t="n");break;case"e":(!u||u.cellText!==!1)&&(F.w=F.v),F.v=lC[F.v];break}if(P=q=0,V=null,D&&T.s!==void 0&&(V=h.CellXf[T.s],V!=null&&(V.numFmtId!=null&&(P=V.numFmtId),u.cellStyles&&V.fillId!=null&&(q=V.fillId))),UC(F,P,q,u,d,h),u.cellDates&&D&&F.t=="n"&&Od(Wt[P])&&(F.t="d",F.v=_x(F.v)),T.cm&&u.xlmeta){var Le=(u.xlmeta.Cell||[])[+T.cm-1];Le&&Le.type=="XLDAPR"&&(F.D=!0)}if(X){var ee=zs(T.r);f[ee.r]||(f[ee.r]=[]),f[ee.r][ee.c]=F}else f[T.r]=F}}}}G.length>0&&(f["!rows"]=G)}}();function ZK(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var eG=Ku;function tG(){}function rG(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=_z(e),r}function nG(e){var t=ni(e);return[t]}function sG(e){var t=Vu(e);return[t]}function aG(e){var t=ni(e),r=e.read_shift(1);return[t,r,"b"]}function iG(e){var t=Vu(e),r=e.read_shift(1);return[t,r,"b"]}function oG(e){var t=ni(e),r=e.read_shift(1);return[t,r,"e"]}function lG(e){var t=Vu(e),r=e.read_shift(1);return[t,r,"e"]}function cG(e){var t=ni(e),r=e.read_shift(4);return[t,r,"s"]}function uG(e){var t=Vu(e),r=e.read_shift(4);return[t,r,"s"]}function fG(e){var t=ni(e),r=_s(e);return[t,r,"n"]}function zC(e){var t=Vu(e),r=_s(e);return[t,r,"n"]}function dG(e){var t=ni(e),r=Ib(e);return[t,r,"n"]}function hG(e){var t=Vu(e),r=Ib(e);return[t,r,"n"]}function pG(e){var t=ni(e),r=Ob(e);return[t,r,"is"]}function mG(e){var t=ni(e),r=js(e);return[t,r,"str"]}function gG(e){var t=Vu(e),r=js(e);return[t,r,"str"]}function xG(e,t,r){var n=e.l+t,s=ni(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=jx(e,n-e.l,r);i[3]=ws(o,null,s,r.supbooks,r)}else e.l=n;return i}function vG(e,t,r){var n=e.l+t,s=ni(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=jx(e,n-e.l,r);i[3]=ws(o,null,s,r.supbooks,r)}else e.l=n;return i}function yG(e,t,r){var n=e.l+t,s=ni(e);s.r=r["!row"];var a=_s(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=jx(e,n-e.l,r);i[3]=ws(o,null,s,r.supbooks,r)}else e.l=n;return i}function wG(e,t,r){var n=e.l+t,s=ni(e);s.r=r["!row"];var a=js(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=jx(e,n-e.l,r);i[3]=ws(o,null,s,r.supbooks,r)}else e.l=n;return i}var bG=Ku;function NG(e,t){var r=e.l+t,n=Ku(e),s=Rb(e),a=js(e),i=js(e),o=js(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function SG(){}function _G(e,t,r){var n=e.l+t,s=aC(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=TK(e,n-e.l,r);i[1]=o}else e.l=n;return i}function kG(e,t,r){var n=e.l+t,s=Ku(e),a=[s];if(r.cellFormula){var i=PK(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var EG=["left","right","top","bottom","header","footer"];function jG(e){var t={};return EG.forEach(function(r){t[r]=_s(e)}),t}function AG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function TG(){}function CG(){}function PG(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},f,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,d=!1,h,m,g,y,v,b,w,S,A,F=[];o.biff=12,o["!row"]=0;var T=0,O=!1,C=[],R={},k=o.supbooks||s.supbooks||[[]];if(k.sharedf=R,k.arrayf=C,k.SheetNames=s.SheetNames||s.Sheets.map(function(X){return X.name}),!o.supbooks&&(o.supbooks=k,s.Names))for(var P=0;P<s.Names.length;++P)k[0][P+1]=s.Names[P];var q=[],D=[],V=!1;Dg[16]={n:"BrtShortReal",f:zC};var se;if(vl(e,function(G,ve,ye){if(!d)switch(ye){case 148:f=G;break;case 0:h=G,o.sheetRows&&o.sheetRows<=h.r&&(d=!0),S=os(y=h.r),o["!row"]=h.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=Jh(G.hpt)),D[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:G[2]},G[2]){case"n":m.v=G[1];break;case"s":w=ah[G[1]],m.v=w.t,m.r=w.r;break;case"b":m.v=!!G[1];break;case"e":m.v=G[1],o.cellText!==!1&&(m.w=Gu[m.v]);break;case"str":m.t="s",m.v=G[1];break;case"is":m.t="s",m.v=G[1].t;break}if((g=i.CellXf[G[0].iStyleRef])&&UC(m,g.numFmtId,null,o,a,i),v=G[0].c==-1?v+1:G[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=m):c[Mn(v)+S]=m,o.cellFormula){for(O=!1,T=0;T<C.length;++T){var E=C[T];h.r>=E[0].s.r&&h.r<=E[0].e.r&&v>=E[0].s.c&&v<=E[0].e.c&&(m.F=ir(E[0]),O=!0)}!O&&G.length>3&&(m.f=G[3])}if(u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),o.cellDates&&g&&m.t=="n"&&Od(Wt[g.numFmtId])){var M=cu(m.v);M&&(m.t="d",m.v=new Date(M.y,M.m-1,M.d,M.H,M.M,M.S,M.u))}se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;m={t:"z",v:void 0},v=G[0].c==-1?v+1:G[0].c,o.dense?(c[y]||(c[y]=[]),c[y][v]=m):c[Mn(v)+S]=m,u.s.r>h.r&&(u.s.r=h.r),u.s.c>v&&(u.s.c=v),u.e.r<h.r&&(u.e.r=h.r),u.e.c<v&&(u.e.c=v),se&&(se.type=="XLDAPR"&&(m.D=!0),se=void 0);break;case 176:F.push(G);break;case 49:se=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var I=n["!id"][G.relId];for(I?(G.Target=I.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=I):G.relId==""&&(G.Target="#"+G.loc),y=G.rfx.s.r;y<=G.rfx.e.r;++y)for(v=G.rfx.s.c;v<=G.rfx.e.c;++v)o.dense?(c[y]||(c[y]=[]),c[y][v]||(c[y][v]={t:"z",v:void 0}),c[y][v].l=G):(b=Ut({c:v,r:y}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=G);break;case 426:if(!o.cellFormula)break;C.push(G),A=o.dense?c[y][v]:c[Mn(v)+S],A.f=ws(G[1],u,{r:h.r,c:v},k,o),A.F=ir(G[0]);break;case 427:if(!o.cellFormula)break;R[Ut(G[0].s)]=G[1],A=o.dense?c[y][v]:c[Mn(v)+S],A.f=ws(G[1],u,{r:h.r,c:v},k,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)q[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},V||(V=!0,$b(G.w/256)),Sd(q[G.e+1]);break;case 161:c["!autofilter"]={ref:ir(G)};break;case 476:c["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(c["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!ve.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+ye.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(u.s.r<2e6||f&&(f.e.r>0||f.e.c>0||f.s.r>0||f.s.c>0))&&(c["!ref"]=ir(f||u)),o.sheetRows&&c["!ref"]){var ne=nn(c["!ref"]);o.sheetRows<=+ne.e.r&&(ne.e.r=o.sheetRows-1,ne.e.r>u.e.r&&(ne.e.r=u.e.r),ne.e.r<ne.s.r&&(ne.s.r=ne.e.r),ne.e.c>u.e.c&&(ne.e.c=u.e.c),ne.e.c<ne.s.c&&(ne.s.c=ne.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ir(ne))}return F.length>0&&(c["!merges"]=F),q.length>0&&(c["!cols"]=q),D.length>0&&(c["!rows"]=D),c}function FG(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=ur((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function LG(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,f="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var d=FG(p);u.s.r=u.s.c=0,u.e.c=o,f=Mn(o),d[0].forEach(function(h,m){i[f+os(m)]={t:"n",v:h,z:d[1]},c=m}),u.e.r<c&&(u.e.r=c),++o}),o>0&&(i["!ref"]=ir(u)),i}function DG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match($C);return o&&qb(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function OG(e,t){e.l+=10;var r=js(e);return{name:r}}function RG(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return vl(e,function(c,f,u){switch(u){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(f.T>0)){if(!(f.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var qC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],IG=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],MG=[],BG=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function o_(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=$r(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function l_(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=$r(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function HC(e){l_(e.WBProps,qC),l_(e.CalcPr,BG),o_(e.WBView,IG),o_(e.Sheets,MG),Qf.date1904=$r(e.WBProps.date1904)}var UG="][*?/\\".split("");function $G(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return UG.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var zG=/<\w+:workbook/;function qG(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Ps,function(c,f){var u=Tt(c);switch(No(u[0])){case"<?xml":break;case"<workbook":c.match(zG)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=u[s];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":qC.forEach(function(p){if(u[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=$r(u[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(u[p[0]],10);break;default:r.WBProps[p[0]]=u[p[0]]}}),u.codeName&&(r.WBProps.CodeName=Pr(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=ur(Pr(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Pr(u.name),u.comment&&(a.Comment=u.comment),u.localSheetId&&(a.Sheet=+u.localSheetId),$r(u.hidden||"0")&&(a.Hidden=!0),i=f+c.length;break;case"</definedName>":a.Ref=ur(Pr(e.slice(i,f))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return c}),oz.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HC(r),r}function HG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Aw(e),r.name=js(e),r}function WG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?js(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function VG(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function KG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=kz(e),i=CK(e,0,r),o=Rb(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function GG(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Dg[16]={n:"BrtFRTArchID$",f:VG},vl(e,function(c,f,u){switch(u){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=ws(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([u,c]):i[0]=[u,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(u),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!f.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),HC(r),r.Names=a,r.supbooks=i,r}function YG(e,t,r){return t.slice(-4)===".bin"?GG(e,r):qG(e,r)}function XG(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?PG(e,n,r,s,a,i,o):HK(e,n,r,s,a,i,o)}function JG(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?RG(e,n,r,s,a):DG(e,n,r,s,a)}function QG(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?iV():oV()}function ZG(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?sV():aV()}function eY(e,t,r,n){return t.slice(-4)===".bin"?bW(e,r,n):mW(e,r,n)}function tY(e,t,r){return CC(e,r)}function rY(e,t,r){return t.slice(-4)===".bin"?IH(e,r):OH(e,r)}function nY(e,t,r){return t.slice(-4)===".bin"?tV(e,r):XW(e,r)}function sY(e,t,r){return t.slice(-4)===".bin"?KW(e):WW(e)}function aY(e,t,r,n){return r.slice(-4)===".bin"?GW(e,t,r,n):void 0}function iY(e,t,r){return t.slice(-4)===".bin"?qW(e,t,r):HW(e,t,r)}var WC=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,VC=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function pi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(WC),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(VC),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function oY(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(WC),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(VC),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var oh;function lY(e,t){var r=oh[e]||ur(e);return r==="General"?Ou(t):ti(r,t)}function cY(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=$r(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Kn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ur(t)]=s}function uY(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Gu[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v):e.w=Ou(e.v):e.w=lY(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=oh[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Od(n)){var s=cu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function fY(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=cW[n.Pattern]||n.Pattern)}e[t.ID]=t}function dY(e,t,r,n,s,a,i,o,c,f){var u="General",p=n.StyleID,d={};f=f||{};var h=[],m=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(u=a[p].nf),a[p].Interior&&h.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=$r(e);break;case"String":n.t="s",n.r=CS(ur(e)),n.v=e.indexOf("<")>-1?ur(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Kn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ur(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=lC[e],f.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=CS(t||e));break}if(uY(n,u,f),f.cellFormula!==!1)if(n.Formula){var g=ur(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Jf(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Jf("RC:RC",s):n.ArrayRange&&(n.F=Jf(n.ArrayRange,s),c.push([nn(n.F),n.F]))}else for(m=0;m<c.length;++m)s.r>=c[m][0].s.r&&s.r<=c[m][0].e.r&&s.c>=c[m][0].s.c&&s.c<=c[m][0].e.c&&(n.F=c[m][1]);f.cellStyles&&(h.forEach(function(y){!d.patternType&&y.patternType&&(d.patternType=y.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function hY(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function iv(e,t){var r=t||{};DT();var n=D0(Pb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Pr(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=is(r);return i.type="string",Yh.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(rt){s.indexOf("<"+rt)>=0&&(a=!0)}),a)return NY(n,r);oh={"General Number":"General","General Date":Wt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Wt[15],"Short Date":Wt[14],"Long Time":Wt[19],"Medium Time":Wt[18],"Short Time":Wt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Wt[2],Standard:Wt[4],Percent:Wt[10],Scientific:Wt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],f,u={},p=[],d=r.dense?[]:{},h="",m={},g={},y=pi('<Data ss:Type="String">'),v=0,b=0,w=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},F={},T="",O=0,C=[],R={},k={},P=0,q=[],D=[],V={},se=[],ne,X=!1,G=[],ve=[],ye={},E=0,M=0,I={Sheets:[],WBProps:{date1904:!1}},z={};Gh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=Gh.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?dY(n.slice(v,o.index),T,y,c[c.length-1][0]=="comment"?V:m,{c:b,r:w},A,se[b],g,G,r):(T="",y=pi(o[0]),v=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(D.length>0&&(m.c=D),(!r.sheetRows||r.sheetRows>w)&&m.v!==void 0&&(r.dense?(d[w]||(d[w]=[]),d[w][b]=m):d[Mn(b)+os(w)]=m),m.HRef&&(m.l={Target:ur(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(E=b+(parseInt(m.MergeAcross,10)|0),M=w+(parseInt(m.MergeDown,10)|0),C.push({s:{c:b,r:w},e:{c:E,r:M}})),!r.sheetStubs)m.MergeAcross?b=E+1:++b;else if(m.MergeAcross||m.MergeDown){for(var fe=b;fe<=E;++fe)for(var ge=w;ge<=M;++ge)(fe>b||ge>w)&&(r.dense?(d[ge]||(d[ge]=[]),d[ge][fe]={t:"z"}):d[Mn(fe)+os(ge)]={t:"z"});b=E+1}else++b;else m=oY(o[0]),m.Index&&(b=+m.Index-1),b<S.s.c&&(S.s.c=b),b>S.e.c&&(S.e.c=b),o[0].slice(-2)==="/>"&&++b,D=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(w<S.s.r&&(S.s.r=w),w>S.e.r&&(S.e.r=w),o[0].slice(-2)==="/>"&&(g=pi(o[0]),g.Index&&(w=+g.Index-1)),b=0,++w):(g=pi(o[0]),g.Index&&(w=+g.Index-1),ye={},(g.AutoFitHeight=="0"||g.Height)&&(ye.hpx=parseInt(g.Height,10),ye.hpt=TC(ye.hpx),ve[w]=ye),g.Hidden=="1"&&(ye.hidden=!0,ve[w]=ye));break;case"worksheet":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));p.push(h),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(d["!ref"]=ir(S),r.sheetRows&&r.sheetRows<=S.e.r&&(d["!fullref"]=d["!ref"],S.e.r=r.sheetRows-1,d["!ref"]=ir(S))),C.length&&(d["!merges"]=C),se.length>0&&(d["!cols"]=se),ve.length>0&&(d["!rows"]=ve),u[h]=d}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},w=b=0,c.push([o[3],!1]),f=pi(o[0]),h=ur(f.Name),d=r.dense?[]:{},C=[],G=[],ve=[],z={name:h,Hidden:0},I.Sheets.push(z);break;case"table":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),se=[],X=!1}break;case"style":o[1]==="/"?fY(A,F,r):F=pi(o[0]);break;case"numberformat":F.nf=ur(pi(o[0]).Format||"General"),oh[F.nf]&&(F.nf=oh[F.nf]);for(var he=0;he!=392&&Wt[he]!=F.nf;++he);if(he==392){for(he=57;he!=392;++he)if(Wt[he]==null){Su(F.nf,he);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(ne=pi(o[0]),ne.Hidden&&(ne.hidden=!0,delete ne.Hidden),ne.Width&&(ne.wpx=parseInt(ne.Width,10)),!X&&ne.wpx>10){X=!0,Us=jC;for(var pe=0;pe<se.length;++pe)se[pe]&&Sd(se[pe])}X&&Sd(ne),se[ne.Index-1||se.length]=ne;for(var Le=0;Le<+ne.Span;++Le)se[se.length]=is(ne);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var ee=Tt(o[0]),We={Name:ee.Name,Ref:Jf(ee.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(We.Sheet=I.Sheets.length-1),I.Names.push(We);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?T+=n.slice(O,o.index):O=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;F.Interior=pi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?Xz(R,te,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"));hY(V),D.push(V)}else c.push([o[3],!1]),f=pi(o[0]),V={a:f.Author};break;case"autofilter":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ge=pi(o[0]);d["!autofilter"]={ref:Jf(Ge.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((f=c.pop())[0]!==o[3])throw new Error("Bad state: "+f.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return p_(n,r);var J=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":z.Hidden=1;break;case"SheetVeryHidden":z.Hidden=2;break}else P=o.index+o[0].length;break;case"header":d["!margins"]||ih(d["!margins"]={},"xlml"),isNaN(+Tt(o[0]).Margin)||(d["!margins"].header=+Tt(o[0]).Margin);break;case"footer":d["!margins"]||ih(d["!margins"]={},"xlml"),isNaN(+Tt(o[0]).Margin)||(d["!margins"].footer=+Tt(o[0]).Margin);break;case"pagemargins":var Ue=Tt(o[0]);d["!margins"]||ih(d["!margins"]={},"xlml"),isNaN(+Ue.Top)||(d["!margins"].top=+Ue.Top),isNaN(+Ue.Left)||(d["!margins"].left=+Ue.Left),isNaN(+Ue.Right)||(d["!margins"].right=+Ue.Right),isNaN(+Ue.Bottom)||(d["!margins"].bottom=+Ue.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?cY(k,te,q,n.slice(P,o.index)):(q=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Me={};return!r.bookSheets&&!r.bookProps&&(Me.Sheets=u),Me.SheetNames=p,Me.Workbook=I,Me.SSF=is(Wt),Me.Props=R,Me.Custprops=k,Me}function Fw(e,t){switch(Vb(t=t||{}),t.type||"base64"){case"base64":return iv(La(e),t);case"binary":case"buffer":case"file":return iv(e,t);case"array":return iv(Wu(e),t)}}function pY(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Az(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Tz(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var mY=[60,1084,2066,2165,2175];function gY(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=rl(r,r.l),f=Lw[c],u=0;f!=null&&mY.indexOf(c)>-1;)a=rl(r,r.l+2),u=r.l+4,c==2066?u+=4:(c==2165||c==2175)&&(u+=12),o=r.slice(u,r.l+4+a),i.push(o),r.l+=4+a,f=Lw[c=rl(r,r.l)];var p=Yl(i);ss(p,0);var d=0;p.lens=[];for(var h=0;h<i.length;++h)p.lens.push(d),d+=i[h].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function Ji(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Wt[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Gu[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vh(e.v):e.w=Ou(e.v):e.w=ti(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Od(Wt[n]||String(n))){var s=cu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Wm(e,t,r){return{v:e,ixfe:t,t:r}}function xY(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],f="",u={},p,d="",h,m,g,y,v={},b=[],w,S,A=[],F=[],T={Sheets:[],WBProps:{date1904:!1},Views:[{}]},O={},C=function(Xe){return Xe<8?_u[Xe]:Xe<64&&F[Xe-8]||_u[Xe]},R=function(Xe,Je,nr){var wt=Je.XF.data;if(!(!wt||!wt.patternType||!nr||!nr.cellStyles)){Je.s={},Je.s.patternType=wt.patternType;var Ct;(Ct=Xh(C(wt.icvFore)))&&(Je.s.fgColor={rgb:Ct}),(Ct=Xh(C(wt.icvBack)))&&(Je.s.bgColor={rgb:Ct})}},k=function(Xe,Je,nr){if(!(ye>1)&&!(nr.sheetRows&&Xe.r>=nr.sheetRows)){if(nr.cellStyles&&Je.XF&&Je.XF.data&&R(Xe,Je,nr),delete Je.ixfe,delete Je.XF,p=Xe,d=Ut(Xe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Xe.r<i.s.r&&(i.s.r=Xe.r),Xe.c<i.s.c&&(i.s.c=Xe.c),Xe.r+1>i.e.r&&(i.e.r=Xe.r+1),Xe.c+1>i.e.c&&(i.e.c=Xe.c+1),nr.cellFormula&&Je.f){for(var wt=0;wt<b.length;++wt)if(!(b[wt][0].s.c>Xe.c||b[wt][0].s.r>Xe.r)&&!(b[wt][0].e.c<Xe.c||b[wt][0].e.r<Xe.r)){Je.F=ir(b[wt][0]),(b[wt][0].s.c!=Xe.c||b[wt][0].s.r!=Xe.r)&&delete Je.f,Je.f&&(Je.f=""+ws(b[wt][1],i,Xe,G,P));break}}nr.dense?(s[Xe.r]||(s[Xe.r]=[]),s[Xe.r][Xe.c]=Je):s[d]=Je}},P={enc:!1,sbcch:0,snames:[],sharedf:v,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var q,D=[],V=[],se=[],ne=[],X=!1,G=[];G.SheetNames=P.snames,G.sharedf=P.sharedf,G.arrayf=P.arrayf,G.names=[],G.XTI=[];var ve=0,ye=0,E=0,M=[],I=[],z;P.codepage=1200,Ci(1200);for(var te=!1;e.l<e.length-1;){var fe=e.l,ge=e.read_shift(2);if(ge===0&&ve===10)break;var he=e.l===e.length?0:e.read_shift(2),pe=Lw[ge];if(pe&&pe.f){if(t.bookSheets&&ve===133&&ge!==133)break;if(ve=ge,pe.r===2||pe.r==12){var Le=e.read_shift(2);if(he-=2,!P.enc&&Le!==ge&&((Le&255)<<8|Le>>8)!==ge)throw new Error("rt mismatch: "+Le+"!="+ge);pe.r==12&&(e.l+=10,he-=10)}var ee={};if(ge===10?ee=pe.f(e,he,P):ee=gY(ge,pe,e,he,P),ye==0&&[9,521,1033,2057].indexOf(ve)===-1)continue;switch(ge){case 34:r.opts.Date1904=T.WBProps.date1904=ee;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=ee,!t.password)throw new Error("File is password-protected");if(ee.valid==null)throw new Error("Encryption scheme unsupported");if(!ee.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=ee;break;case 66:var We=Number(ee);switch(We){case 21010:We=1200;break;case 32768:We=1e4;break;case 32769:We=1252;break}Ci(P.codepage=We),te=!0;break;case 317:P.rrtabid=ee;break;case 25:P.winlocked=ee;break;case 439:r.opts.RefreshAll=ee;break;case 12:r.opts.CalcCount=ee;break;case 16:r.opts.CalcDelta=ee;break;case 17:r.opts.CalcIter=ee;break;case 13:r.opts.CalcMode=ee;break;case 14:r.opts.CalcPrecision=ee;break;case 95:r.opts.CalcSaveRecalc=ee;break;case 15:P.CalcRefMode=ee;break;case 2211:r.opts.FullCalc=ee;break;case 129:ee.fDialog&&(s["!type"]="dialog"),ee.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ee.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:A.push(ee);break;case 430:G.push([ee]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(ee);break;case 24:case 536:z={Name:ee.Name,Ref:ws(ee.rgce,i,null,G,P)},ee.itab>0&&(z.Sheet=ee.itab-1),G.names.push(z),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(ee),ee.Name=="_xlnm._FilterDatabase"&&ee.itab>0&&ee.rgce&&ee.rgce[0]&&ee.rgce[0][0]&&ee.rgce[0][0][0]=="PtgArea3d"&&(I[ee.itab-1]={ref:ir(ee.rgce[0][0][1][2])});break;case 22:P.ExternCount=ee;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(ee),G.XTI=G.XTI.concat(ee);break;case 2196:if(P.biff<8)break;z!=null&&(z.Comment=ee[1]);break;case 18:s["!protect"]=ee;break;case 19:ee!==0&&P.WTF&&console.error("Password verifier: "+ee);break;case 133:a[ee.pos]=ee,P.snames.push(ee.name);break;case 10:{if(--ye)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=ir(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ge=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=ir(i),i.e.r=Ge}i.e.r++,i.e.c++}D.length>0&&(s["!merges"]=D),V.length>0&&(s["!objects"]=V),se.length>0&&(s["!cols"]=se),ne.length>0&&(s["!rows"]=ne),T.Sheets.push(O)}f===""?u=s:n[f]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[ge]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ee.BIFFVer]||8),P.biffguess=ee.BIFFVer==0,ee.BIFFVer==0&&ee.dt==4096&&(P.biff=5,te=!0,Ci(P.codepage=28591)),P.biff==8&&ee.BIFFVer==0&&ee.dt==16&&(P.biff=2),ye++)break;if(s=t.dense?[]:{},P.biff<8&&!te&&(te=!0,Ci(P.codepage=t.codepage||1252)),P.biff<5||ee.BIFFVer==0&&ee.dt==4096){f===""&&(f="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-he,name:f};a[J.pos]=J,P.snames.push(f)}else f=(a[fe]||{name:""}).name;ee.dt==32&&(s["!type"]="chart"),ee.dt==64&&(s["!type"]="macro"),D=[],V=[],P.arrayf=b=[],se=[],ne=[],X=!1,O={Hidden:(a[fe]||{hs:0}).hs,name:f}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ee.r]||[])[ee.c]:s[Ut({c:ee.c,r:ee.r})])&&++ee.c,w={ixfe:ee.ixfe,XF:A[ee.ixfe]||{},v:ee.val,t:"n"},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t);break;case 5:case 517:w={ixfe:ee.ixfe,XF:A[ee.ixfe],v:ee.val,t:ee.t},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t);break;case 638:w={ixfe:ee.ixfe,XF:A[ee.ixfe],v:ee.rknum,t:"n"},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t);break;case 189:for(var Ue=ee.c;Ue<=ee.C;++Ue){var Me=ee.rkrec[Ue-ee.c][0];w={ixfe:Me,XF:A[Me],v:ee.rkrec[Ue-ee.c][1],t:"n"},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:Ue,r:ee.r},w,t)}break;case 6:case 518:case 1030:{if(ee.val=="String"){o=ee;break}if(w=Wm(ee.val,ee.cell.ixfe,ee.tt),w.XF=A[w.ixfe],t.cellFormula){var rt=ee.formula;if(rt&&rt[0]&&rt[0][0]&&rt[0][0][0]=="PtgExp"){var Be=rt[0][0][1][0],ft=rt[0][0][1][1],et=Ut({r:Be,c:ft});v[et]?w.f=""+ws(ee.formula,i,ee.cell,G,P):w.F=((t.dense?(s[Be]||[])[ft]:s[et])||{}).F}else w.f=""+ws(ee.formula,i,ee.cell,G,P)}E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k(ee.cell,w,t),o=ee}break;case 7:case 519:if(o)o.val=ee,w=Wm(ee,o.cell.ixfe,"s"),w.XF=A[w.ixfe],t.cellFormula&&(w.f=""+ws(o.formula,i,o.cell,G,P)),E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k(o.cell,w,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(ee);var gt=Ut(ee[0].s);if(h=t.dense?(s[ee[0].s.r]||[])[ee[0].s.c]:s[gt],t.cellFormula&&h){if(!o||!gt||!h)break;h.f=""+ws(ee[1],i,ee[0],G,P),h.F=ir(ee[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!o)break;v[Ut(o.cell)]=ee[0],h=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Ut(o.cell)],(h||{}).f=""+ws(ee[0],i,p,G,P)}}break;case 253:w=Wm(c[ee.isst].t,ee.ixfe,"s"),c[ee.isst].h&&(w.h=c[ee.isst].h),w.XF=A[w.ixfe],E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t);break;case 513:t.sheetStubs&&(w={ixfe:ee.ixfe,XF:A[ee.ixfe],t:"z"},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t));break;case 190:if(t.sheetStubs)for(var ct=ee.c;ct<=ee.C;++ct){var Mt=ee.ixfe[ct-ee.c];w={ixfe:Mt,XF:A[Mt],t:"z"},E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ct,r:ee.r},w,t)}break;case 214:case 516:case 4:w=Wm(ee.val,ee.ixfe,"s"),w.XF=A[w.ixfe],E>0&&(w.z=M[w.ixfe>>8&63]),Ji(w,t,r.opts.Date1904),k({c:ee.c,r:ee.r},w,t);break;case 0:case 512:ye===1&&(i=ee);break;case 252:c=ee;break;case 1054:if(P.biff==4){M[E++]=ee[1];for(var Ft=0;Ft<E+163&&Wt[Ft]!=ee[1];++Ft);Ft>=163&&Su(ee[1],E+163)}else Su(ee[1],ee[0]);break;case 30:{M[E++]=ee;for(var St=0;St<E+163&&Wt[St]!=ee;++St);St>=163&&Su(ee,E+163)}break;case 229:D=D.concat(ee);break;case 93:V[ee.cmo[0]]=P.lastobj=ee;break;case 438:P.lastobj.TxO=ee;break;case 127:P.lastobj.ImData=ee;break;case 440:for(y=ee[0].s.r;y<=ee[0].e.r;++y)for(g=ee[0].s.c;g<=ee[0].e.c;++g)h=t.dense?(s[y]||[])[g]:s[Ut({c:g,r:y})],h&&(h.l=ee[1]);break;case 2048:for(y=ee[0].s.r;y<=ee[0].e.r;++y)for(g=ee[0].s.c;g<=ee[0].e.c;++g)h=t.dense?(s[y]||[])[g]:s[Ut({c:g,r:y})],h&&h.l&&(h.l.Tooltip=ee[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;h=t.dense?(s[ee[0].r]||[])[ee[0].c]:s[Ut(ee[0])];var Kt=V[ee[2]];h||(t.dense?(s[ee[0].r]||(s[ee[0].r]=[]),h=s[ee[0].r][ee[0].c]={t:"z"}):h=s[Ut(ee[0])]={t:"z"},i.e.r=Math.max(i.e.r,ee[0].r),i.s.r=Math.min(i.s.r,ee[0].r),i.e.c=Math.max(i.e.c,ee[0].c),i.s.c=Math.min(i.s.c,ee[0].c)),h.c||(h.c=[]),m={a:ee[1],t:Kt.TxO.t},h.c.push(m)}break;case 2173:BW(A[ee.ixfe],ee.ext);break;case 125:{if(!P.cellStyles)break;for(;ee.e>=ee.s;)se[ee.e--]={width:ee.w/256,level:ee.level||0,hidden:!!(ee.flags&1)},X||(X=!0,$b(ee.w/256)),Sd(se[ee.e+1])}break;case 520:{var _t={};ee.level!=null&&(ne[ee.r]=_t,_t.level=ee.level),ee.hidden&&(ne[ee.r]=_t,_t.hidden=!0),ee.hpt&&(ne[ee.r]=_t,_t.hpt=ee.hpt,_t.hpx=Jh(ee.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||ih(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ge]]=ee;break;case 161:s["!margins"]||ih(s["!margins"]={}),s["!margins"].header=ee.header,s["!margins"].footer=ee.footer;break;case 574:ee.RTL&&(T.Views[0].RTL=!0);break;case 146:F=ee;break;case 2198:q=ee;break;case 140:S=ee;break;case 442:f?O.CodeName=ee||O.name:T.WBProps.CodeName=ee||"ThisWorkbook";break}}else pe||console.error("Missing Info for XLS Record 0x"+ge.toString(16)),e.l+=he}return r.SheetNames=wo(a).sort(function(nt,Xe){return Number(nt)-Number(Xe)}).map(function(nt){return a[nt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&I.forEach(function(nt,Xe){r.Sheets[r.SheetNames[Xe]]["!autofilter"]=nt}),r.Strings=c,r.SSF=is(Wt),P.enc&&(r.Encryption=P.enc),q&&(r.Themes=q),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),G.names.length>0&&(T.Names=G.names),r.Workbook=T,r}var c_={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function vY(e,t,r){var n=ar.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=VS(n,Oz,c_.DSI);for(var a in s)t[a]=s[a]}catch(f){if(r.WTF)throw f}var i=ar.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=VS(i,Rz,c_.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(f){if(r.WTF)throw f}t.HeadingPairs&&t.TitlesOfParts&&(uC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function KC(e,t){t||(t={}),Vb(t),NT(),t.codepage&&_b(t.codepage);var r,n;if(e.FullPaths){if(ar.find(e,"/encryption"))throw new Error("File is password-protected");r=ar.find(e,"!CompObj"),n=ar.find(e,"/Workbook")||ar.find(e,"/Book")}else{switch(t.type){case"base64":e=ji(La(e));break;case"binary":e=ji(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ss(e,0),n={content:e}}var s,a;if(r&&pY(r),t.bookProps&&!t.bookSheets)s={};else{var i=rr?"buffer":"array";if(n&&n.content)s=xY(n.content,t);else if((a=ar.find(e,"PerfectOffice_MAIN"))&&a.content)s=sh.to_workbook(a.content,(t.type=i,t));else if((a=ar.find(e,"NativeContent_MAIN"))&&a.content)s=sh.to_workbook(a.content,(t.type=i,t));else throw(a=ar.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&ar.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=nV(e))}var o={};return e.FullPaths&&vY(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var Dg={0:{f:ZK},1:{f:nG},2:{f:dG},3:{f:oG},4:{f:aG},5:{f:fG},6:{f:mG},7:{f:cG},8:{f:wG},9:{f:yG},10:{f:xG},11:{f:vG},12:{f:sG},13:{f:hG},14:{f:lG},15:{f:iG},16:{f:zC},17:{f:gG},18:{f:uG},19:{f:Ob},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:KG},40:{},42:{},43:{f:xW},44:{f:gW},45:{f:vW},46:{f:wW},47:{f:yW},48:{},49:{f:bz},50:{},51:{f:$W},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:NC},62:{f:pG},63:{f:VW},64:{f:TG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Cs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:AG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:rG},148:{f:eG,p:16},151:{f:SG},152:{},153:{f:WG},154:{},155:{},156:{f:HG},157:{},158:{},159:{T:1,f:RH},160:{T:-1},161:{T:1,f:Ku},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:bG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:UW},336:{T:-1},337:{f:zW,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Aw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:bC},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:_G},427:{f:kG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:jG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:tG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:NG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Aw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:eV},633:{T:1},634:{T:-1},635:{T:1,f:ZW},636:{T:-1},637:{f:Sz},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:OG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:CG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Lw={6:{f:sv},10:{f:Il},12:{f:kn},13:{f:kn},14:{f:cn},15:{f:cn},16:{f:_s},17:{f:cn},18:{f:cn},19:{f:kn},20:{f:XS},21:{f:XS},23:{f:bC},24:{f:QS},25:{f:cn},26:{},27:{},28:{f:Jq},29:{},34:{f:cn},35:{f:JS},38:{f:_s},39:{f:_s},40:{f:_s},41:{f:_s},42:{f:cn},43:{f:cn},47:{f:tW},49:{f:Fq},51:{f:kn},60:{},61:{f:Tq},64:{f:cn},65:{f:Pq},66:{f:kn},77:{},80:{},81:{},82:{},85:{f:kn},89:{},90:{},91:{},92:{f:bq},93:{f:Zq},94:{},95:{f:cn},96:{},97:{},99:{f:cn},125:{f:NC},128:{f:zq},129:{f:Nq},130:{f:kn},131:{f:cn},132:{f:cn},133:{f:Sq},134:{},140:{f:aH},141:{f:kn},144:{},146:{f:oH},151:{},152:{},153:{},154:{},155:{},156:{f:kn},157:{},158:{},160:{f:dH},161:{f:cH},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Mq},190:{f:Bq},193:{f:Il},197:{},198:{},199:{},200:{},201:{},202:{f:cn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:kn},220:{},221:{f:cn},222:{},224:{f:$q},225:{f:wq},226:{f:Il},227:{},229:{f:Qq},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_q},253:{f:Lq},255:{f:kq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:mC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:cn},353:{f:Il},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Hq},431:{f:cn},432:{},433:{},434:{},437:{},438:{f:rH},439:{f:cn},440:{f:nH},441:{},442:{f:bp},443:{},444:{f:kn},445:{},446:{},448:{f:Il},449:{f:Aq,r:2},450:{f:Il},512:{f:GS},513:{f:fH},515:{f:qq},516:{f:Dq},517:{f:YS},519:{f:hH},520:{f:Eq},523:{},545:{f:ZS},549:{f:KS},566:{},574:{f:Cq},638:{f:Iq},659:{},1048:{},1054:{f:Oq},1084:{},1212:{f:Gq},2048:{f:sH},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:zm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Il},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:lH,r:12},2173:{f:MW,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:cn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Kq,r:12},2197:{},2198:{f:FW,r:12},2199:{},2200:{},2201:{},2202:{f:Yq,r:12},2203:{f:Il},2204:{},2205:{},2206:{},2207:{},2211:{f:jq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:kn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:uH},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:iH},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:GS},1:{},2:{f:xH},3:{f:gH},4:{f:mH},5:{f:YS},7:{f:vH},8:{},9:{f:zm},11:{},22:{f:kn},30:{f:Rq},31:{},32:{},33:{f:ZS},36:{},37:{f:KS},50:{f:yH},62:{},52:{},67:{},68:{f:kn},69:{},86:{},126:{},127:{f:pH},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wH},223:{},234:{},354:{},421:{},518:{f:sv},521:{f:zm},536:{f:QS},547:{f:JS},561:{},579:{},1030:{f:sv},1033:{f:zm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function mi(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&rC(r)&&e.push(r)}}function u_(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=q$(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),f=-1,u=0,p=0,d=0,h={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<c.length;++i){var g=c[i].trim(),y=g.slice(0,3).toLowerCase();if(y=="<tr"){if(++f,r.sheetRows&&r.sheetRows<=f){--f;break}u=0;continue}if(!(y!="<td"&&y!="<th")){var v=g.split(/<\/t[dh]>/i);for(o=0;o<v.length;++o){var b=v[o].trim();if(b.match(/<t[dh]/i)){for(var w=b,S=0;w.charAt(0)=="<"&&(S=w.indexOf(">"))>-1;)w=w.slice(S+1);for(var A=0;A<m.length;++A){var F=m[A];F.s.c==u&&F.s.r<f&&f<=F.e.r&&(u=F.e.c+1,A=-1)}var T=Tt(b.slice(0,b.indexOf(">")));d=T.colspan?+T.colspan:1,((p=+T.rowspan)>1||d>1)&&m.push({s:{r:f,c:u},e:{r:f+(p||1)-1,c:u+d-1}});var O=T.t||T["data-t"]||"";if(!w.length){u+=d;continue}if(w=qT(w),h.s.r>f&&(h.s.r=f),h.e.r<f&&(h.e.r=f),h.s.c>u&&(h.s.c=u),h.e.c<u&&(h.e.c=u),!w.length){u+=d;continue}var C={t:"s",v:w};r.raw||!w.trim().length||O=="s"||(w==="TRUE"?C={t:"b",v:!0}:w==="FALSE"?C={t:"b",v:!1}:isNaN(Oi(w))?isNaN(Nd(w).getDate())||(C={t:"d",v:Kn(w)},r.cellDates||(C={t:"n",v:Gs(C.v)}),C.z=r.dateNF||Wt[14]):C={t:"n",v:Oi(w)}),r.dense?(n[f]||(n[f]=[]),n[f][u]=C):n[Ut({r:f,c:u})]=C,u+=d}}}}return n["!ref"]=ir(h),m.length&&(n["!merges"]=m),n}function yY(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,f=0;f<s.length;++f)if(!(s[f].s.r>r||s[f].s.c>i)&&!(s[f].e.r<r||s[f].e.c<i)){if(s[f].s.r<r||s[f].s.c<i){o=-1;break}o=s[f].e.r-s[f].s.r+1,c=s[f].e.c-s[f].s.c+1;break}if(!(o<0)){var u=Ut({r,c:i}),p=n.dense?(e[r]||[])[i]:e[u],d=p&&p.v!=null&&(p.h||Cb(p.w||(pl(p),p.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":p&&(h["data-t"]=p&&p.t||"z",p.v!=null&&(h["data-v"]=p.v),p.z!=null&&(h["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+p.l.Target+'">'+d+"</a>")),h.id=(n.id||"sjs")+"-"+u,a.push(az("td",d,h))}}var m="<tr>";return m+a.join("")+"</tr>"}var wY='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bY="</body></html>";function NY(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Lc(u_(r[0],t),t);var n=Gb();return r.forEach(function(s,a){Yb(n,u_(s,t),"Sheet"+(a+1))}),n}function SY(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function _Y(e,t){var r=t||{},n=r.header!=null?r.header:wY,s=r.footer!=null?r.footer:bY,a=[n],i=Rd(e["!ref"]);r.dense=Array.isArray(e),a.push(SY(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(yY(e,i,o,r));return a.push("</table>"+s),a.join("")}function GC(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?zs(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),f={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var u=Rd(e["!ref"]);f.s.r=Math.min(f.s.r,u.s.r),f.s.c=Math.min(f.s.c,u.s.c),f.e.r=Math.max(f.e.r,u.e.r),f.e.c=Math.max(f.e.c,u.e.c),s==-1&&(f.e.r=s=u.e.r+1)}var p=[],d=0,h=e["!rows"]||(e["!rows"]=[]),m=0,g=0,y=0,v=0,b=0,w=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<c;++m){var S=o[m];if(f_(S)){if(n.display)continue;h[g]={hidden:!0}}var A=S.children;for(y=v=0;y<A.length;++y){var F=A[y];if(!(n.display&&f_(F))){var T=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):qT(F.innerHTML),O=F.getAttribute("data-z")||F.getAttribute("z");for(d=0;d<p.length;++d){var C=p[d];C.s.c==v+a&&C.s.r<g+s&&g+s<=C.e.r&&(v=C.e.c+1-a,d=-1)}w=+F.getAttribute("colspan")||1,((b=+F.getAttribute("rowspan")||1)>1||w>1)&&p.push({s:{r:g+s,c:v+a},e:{r:g+s+(b||1)-1,c:v+a+(w||1)-1}});var R={t:"s",v:T},k=F.getAttribute("data-t")||F.getAttribute("t")||"";T!=null&&(T.length==0?R.t=k||"z":n.raw||T.trim().length==0||k=="s"||(T==="TRUE"?R={t:"b",v:!0}:T==="FALSE"?R={t:"b",v:!1}:isNaN(Oi(T))?isNaN(Nd(T).getDate())||(R={t:"d",v:Kn(T)},n.cellDates||(R={t:"n",v:Gs(R.v)}),R.z=n.dateNF||Wt[14]):R={t:"n",v:Oi(T)})),R.z===void 0&&O!=null&&(R.z=O);var P="",q=F.getElementsByTagName("A");if(q&&q.length)for(var D=0;D<q.length&&!(q[D].hasAttribute("href")&&(P=q[D].getAttribute("href"),P.charAt(0)!="#"));++D);P&&P.charAt(0)!="#"&&(R.l={Target:P}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][v+a]=R):e[Ut({c:v+a,r:g+s})]=R,f.e.c<v+a&&(f.e.c=v+a),v+=w}}++g}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),f.e.r=Math.max(f.e.r,g-1+s),e["!ref"]=ir(f),g>=c&&(e["!fullref"]=ir((f.e.r=o.length-m+g-1+s,f))),e}function YC(e,t){var r=t||{},n=r.dense?[]:{};return GC(n,e,t)}function kY(e,t){return Lc(YC(e,t),t)}function f_(e){var t="",r=EY(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function EY(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function jY(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ur(t.replace(/<[^>]*>/g,""));return[r]}var d_={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function XC(e,t){var r=t||{},n=Pb(e),s=[],a,i,o={name:""},c="",f=0,u,p,d={},h=[],m=r.dense?[]:{},g,y,v={value:""},b="",w=0,S=[],A=-1,F=-1,T={s:{r:1e6,c:1e7},e:{r:0,c:0}},O=0,C={},R=[],k={},P=0,q=0,D=[],V=1,se=1,ne=[],X={Names:[]},G={},ve=["",""],ye=[],E={},M="",I=0,z=!1,te=!1,fe=0;for(Gh.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=Gh.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(T.e.c>=T.s.c&&T.e.r>=T.s.r?m["!ref"]=ir(T):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=T.e.r&&(m["!fullref"]=m["!ref"],T.e.r=r.sheetRows-1,m["!ref"]=ir(T)),R.length&&(m["!merges"]=R),D.length&&(m["!rows"]=D),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),h.push(u.name),d[u.name]=m,te=!1):g[0].charAt(g[0].length-2)!=="/"&&(u=Tt(g[0],!1),A=F=-1,T.s.r=T.s.c=1e7,T.e.r=T.e.c=0,m=r.dense?[]:{},R=[],D=[],te=!0);break;case"table-row-group":g[1]==="/"?--O:++O;break;case"table-row":case"":if(g[1]==="/"){A+=V,V=1;break}if(p=Tt(g[0],!1),p.?A=p.-1:A==-1&&(A=0),V=+p["number-rows-repeated"]||1,V<10)for(fe=0;fe<V;++fe)O>0&&(D[A+fe]={level:O});F=-1;break;case"covered-table-cell":g[1]!=="/"&&++F,r.sheetStubs&&(r.dense?(m[A]||(m[A]=[]),m[A][F]={t:"z"}):m[Ut({r:A,c:F})]={t:"z"}),b="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++F,v=Tt(g[0],!1),se=parseInt(v["number-columns-repeated"]||"1",10),y={t:"z",v:null},v.formula&&r.cellFormula!=!1&&(y.f=i_(ur(v.formula))),(v.||v["value-type"])=="string"&&(y.t="s",y.v=ur(v["string-value"]||""),r.dense?(m[A]||(m[A]=[]),m[A][F]=y):m[Ut({r:A,c:F})]=y),F+=se-1;else if(g[1]!=="/"){++F,b="",w=0,S=[],se=1;var ge=V?A+V-1:A;if(F>T.e.c&&(T.e.c=F),F<T.s.c&&(T.s.c=F),A<T.s.r&&(T.s.r=A),ge>T.e.r&&(T.e.r=ge),v=Tt(g[0],!1),ye=[],E={},y={t:v.||v["value-type"],v:null},r.cellFormula)if(v.formula&&(v.formula=ur(v.formula)),v["number-matrix-columns-spanned"]&&v["number-matrix-rows-spanned"]&&(P=parseInt(v["number-matrix-rows-spanned"],10)||0,q=parseInt(v["number-matrix-columns-spanned"],10)||0,k={s:{r:A,c:F},e:{r:A+P-1,c:F+q-1}},y.F=ir(k),ne.push([k,y.F])),v.formula)y.f=i_(v.formula);else for(fe=0;fe<ne.length;++fe)A>=ne[fe][0].s.r&&A<=ne[fe][0].e.r&&F>=ne[fe][0].s.c&&F<=ne[fe][0].e.c&&(y.F=ne[fe][1]);switch((v["number-columns-spanned"]||v["number-rows-spanned"])&&(P=parseInt(v["number-rows-spanned"],10)||0,q=parseInt(v["number-columns-spanned"],10)||0,k={s:{r:A,c:F},e:{r:A+P-1,c:F+q-1}},R.push(k)),v["number-columns-repeated"]&&(se=parseInt(v["number-columns-repeated"],10)),y.t){case"boolean":y.t="b",y.v=$r(v["boolean-value"]);break;case"float":y.t="n",y.v=parseFloat(v.value);break;case"percentage":y.t="n",y.v=parseFloat(v.value);break;case"currency":y.t="n",y.v=parseFloat(v.value);break;case"date":y.t="d",y.v=Kn(v["date-value"]),r.cellDates||(y.t="n",y.v=Gs(y.v)),y.z="m/d/yy";break;case"time":y.t="n",y.v=U$(v["time-value"])/86400,r.cellDates&&(y.t="d",y.v=_x(y.v)),y.z="HH:MM:SS";break;case"number":y.t="n",y.v=parseFloat(v.);break;default:if(y.t==="string"||y.t==="text"||!y.t)y.t="s",v["string-value"]!=null&&(b=ur(v["string-value"]),S=[]);else throw new Error("Unsupported value type "+y.t)}}else{if(z=!1,y.t==="s"&&(y.v=b||"",S.length&&(y.R=S),z=w==0),G.Target&&(y.l=G),ye.length>0&&(y.c=ye,ye=[]),b&&r.cellText!==!1&&(y.w=b),z&&(y.t="z",delete y.v),(!z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var he=0;he<V;++he){if(se=parseInt(v["number-columns-repeated"]||"1",10),r.dense)for(m[A+he]||(m[A+he]=[]),m[A+he][F]=he==0?y:is(y);--se>0;)m[A+he][F+se]=is(y);else for(m[Ut({r:A+he,c:F})]=y;--se>0;)m[Ut({r:A+he,c:F+se})]=is(y);T.e.c<=F&&(T.e.c=F)}se=parseInt(v["number-columns-repeated"]||"1",10),F+=se-1,se=0,y={},b="",S=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;E.t=b,S.length&&(E.R=S),E.a=M,ye.push(E)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);M="",I=0,b="",w=0,S=[];break;case"creator":g[1]==="/"?M=n.slice(I,g.index):I=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);b="",w=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(C[o.name]=c,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(c="",o=Tt(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Tt(g[0],!1),c+=d_[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Tt(g[0],!1),c+=d_[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(f,g.index);break}else f=g.index+g[0].length;break;case"named-range":i=Tt(g[0],!1),ve=av(i["cell-range-address"]);var pe={Name:i.name,Ref:ve[0]+"!"+ve[1]};te&&(pe.Sheet=h.length),X.Names.push(pe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!v||!v["string-value"])){var Le=jY(n.slice(w,g.index));b=(b.length>0?b+`
`:"")+Le[0]}else Tt(g[0],!1),w=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ve=av(Tt(g[0])["target-range-address"]),d[ve[0]]["!autofilter"]={ref:ve[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=Tt(g[0],!1),!G.href)break;G.Target=ur(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ve=av(G.Target.slice(1)),G.Target="#"+ve[0]+"!"+ve[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var ee={Sheets:d,SheetNames:h,Workbook:X};return r.bookSheets&&delete ee.Sheets,ee}function h_(e,t){t=t||{},Wa(e,"META-INF/manifest.xml")&&qz(_n(e,"META-INF/manifest.xml"),t);var r=Ea(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=XC(Pr(r),t);return Wa(e,"meta.xml")&&(n.Props=cC(_n(e,"meta.xml"))),n}function p_(e,t){return XC(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Hb(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Dw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Pr(Wu(e))}function Ow(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function m_(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function AY(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Qh(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Un(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Es(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Qh(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Qh(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var f={data:o,type:a};t[s]==null?t[s]=[f]:t[s].push(f)}return t}function Wb(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function TY(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Qh(e,n),a=Es(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Un(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Es(o.data),f=Un(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+f)}),n[0]+=f}),(t=a[3])!=null&&t[0]&&(i.merge=Un(a[3][0].data)>>>0>0),r.push(i)}return r}function CY(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Qh(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,f=0;if(a==1?(f=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(f=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ow(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(s.push(s[0].slice(-c)),f-=c;f>=s[s.length-1].length;)s.push(s[s.length-1]),f-=s[s.length-1].length;s.push(s[0].slice(-c,-c+f))}}var u=Ow(s);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function PY(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(CY(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ow(t)}function FY(e,t,r,n){var s=Hb(e),a=s.getUint32(4,!0),i=(n>1?12:8)+m_(a&(n>1?3470:398))*4,o=-1,c=-1,f=NaN,u=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=m_(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(f=s.getFloat64(i,!0),i+=8),a&64&&(u.setTime(u.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(f))p={t:"n",v:f};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function LY(e,t,r){var n=Hb(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,f=NaN,u=new Date(2001,0,1);s&1&&(c=AY(e,a),a+=16),s&2&&(f=n.getFloat64(a,!0),a+=8),s&4&&(u.setTime(u.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:u};break;case 6:p={t:"b",v:f>0};break;case 7:p={t:"n",v:f/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function DY(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return FY(e,t,r,e[0]);case 5:return LY(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vc(e){var t=Es(e);return Qh(t[1][0].data)}function g_(e,t){var r=Es(t.data),n=Un(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Es(i.data),c=Un(o[1][0].data)>>>0;switch(n){case 1:a[c]=Dw(o[3][0].data);break;case 8:{var f=e[vc(o[9][0].data)][0],u=Es(f.data),p=e[vc(u[1][0].data)][0],d=Un(p.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var h=Es(p.data);a[c]=h[3].map(function(m){return Dw(m.data)}).join("")}break}}),a}function OY(e,t){var r,n,s,a,i,o,c,f,u,p,d,h,m,g,y=Es(e),v=Un(y[1][0].data)>>>0,b=Un(y[2][0].data)>>>0,w=((n=(r=y[8])==null?void 0:r[0])==null?void 0:n.data)&&Un(y[8][0].data)>0||!1,S,A;if((a=(s=y[7])==null?void 0:s[0])!=null&&a.data&&t!=0)S=(o=(i=y[7])==null?void 0:i[0])==null?void 0:o.data,A=(f=(c=y[6])==null?void 0:c[0])==null?void 0:f.data;else if((p=(u=y[4])==null?void 0:u[0])!=null&&p.data&&t!=1)S=(h=(d=y[4])==null?void 0:d[0])==null?void 0:h.data,A=(g=(m=y[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var F=w?4:1,T=Hb(S),O=[],C=0;C<S.length/2;++C){var R=T.getUint16(C*2,!0);R<65535&&O.push([C,R])}if(O.length!=b)throw"Expected ".concat(b," cells, found ").concat(O.length);var k=[];for(C=0;C<O.length-1;++C)k[O[C][0]]=A.subarray(O[C][1]*F,O[C+1][1]*F);return O.length>=1&&(k[O[O.length-1][0]]=A.subarray(O[O.length-1][1]*F)),{R:v,cells:k}}function RY(e,t){var r,n=Es(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Un(n[7][0].data)>>>0>0?1:0:-1,a=Wb(n[5],function(i){return OY(i,s)});return{nrows:Un(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,f){if(i[o.R][f])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(f));i[o.R][f]=c}),i},[])}}function IY(e,t,r){var n,s=Es(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Un(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Un(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=ir(a);var i=Es(s[4][0].data),o=g_(e,e[vc(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?g_(e,e[vc(i[17][0].data)][0]):[],f=Es(i[3][0].data),u=0;f[1].forEach(function(p){var d=Es(p.data),h=e[vc(d[2][0].data)][0],m=Un(h.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=RY(e,h);g.data.forEach(function(y,v){y.forEach(function(b,w){var S=Ut({r:u+v,c:w}),A=DY(b,o,c);A&&(r[S]=A)})}),u+=g.nrows})}function MY(e,t){var r=Es(t.data),n={"!ref":"A1"},s=e[vc(r[2][0].data)],a=Un(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return IY(e,s[0],n),n}function BY(e,t){var r,n=Es(t.data),s={name:(r=n[1])!=null&&r[0]?Dw(n[1][0].data):"",sheets:[]},a=Wb(n[2],vc);return a.forEach(function(i){e[i].forEach(function(o){var c=Un(o.meta[1][0].data);c==6e3&&s.sheets.push(MY(e,o))})}),s}function UY(e,t){var r=Gb(),n=Es(t.data),s=Wb(n[1],vc);if(s.forEach(function(a){e[a].forEach(function(i){var o=Un(i.meta[1][0].data);if(o==2){var c=BY(e,i);c.sheets.forEach(function(f,u){Yb(r,f,u==0?c.name:c.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function ov(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var f;try{f=PY(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var u;try{u=TY(f)}catch(p){return console.log("## "+(p.message||p))}u.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Un(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(f){var u=Un(f.meta[1][0].data)>>>0;if(u==1)if(!o)o=f;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return UY(a,o)}function $Y(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function Vb(e){$Y([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function zY(e){return If.WS.indexOf(e)>-1?"sheet":e==If.CS?"chart":e==If.DS?"dialog":e==If.MS?"macro":e&&e.length?e:"sheet"}function qY(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zY(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function HY(e,t,r,n,s,a,i,o,c,f,u,p){try{a[n]=rh(Ea(e,r,!0),t);var d=_n(e,t),h;switch(o){case"sheet":h=XG(d,t,s,c,a[n],f,u,p);break;case"chart":if(h=JG(d,t,s,c,a[n],f,u,p),!h||!h["!drawel"])break;var m=R0(h["!drawel"].Target,t),g=Tw(m),y=YW(Ea(e,m,!0),rh(Ea(e,g,!0),m)),v=R0(y,m),b=Tw(v);h=LG(Ea(e,v,!0),v,c,rh(Ea(e,b,!0),v),f,h);break;case"macro":h=QG(d,t,s,c,a[n],f,u,p);break;case"dialog":h=ZG(d,t,s,c,a[n],f,u,p);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var w=[];a&&a[n]&&wo(a[n]).forEach(function(S){var A="";if(a[n][S].Type==If.CMNT){A=R0(a[n][S].Target,t);var F=nY(_n(e,A,!0),A,c);if(!F||!F.length)return;t_(h,F,!1)}a[n][S].Type==If.TCMNT&&(A=R0(a[n][S].Target,t),w=w.concat(JW(_n(e,A,!0),c)))}),w&&w.length&&t_(h,w,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function qa(e){return e.charAt(0)=="/"?e.slice(1):e}function WY(e,t){if(DT(),t=t||{},Vb(t),Wa(e,"META-INF/manifest.xml")||Wa(e,"objectdata.xml"))return h_(e,t);if(Wa(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof ov<"u"){if(e.FileIndex)return ov(e);var r=ar.utils.cfb_new();return AS(e).forEach(function(D){V$(r,D,W$(e,D))}),ov(r)}throw new Error("Unsupported NUMBERS file")}if(!Wa(e,"[Content_Types].xml"))throw Wa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Wa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=AS(e),s=$z(Ea(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",_n(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!_n(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},f={};if(!t.bookSheets&&!t.bookProps){if(ah=[],s.sst)try{ah=rY(_n(e,qa(s.sst)),s.sst,t)}catch(D){if(t.WTF)throw D}t.cellStyles&&s.themes.length&&(c=tY(Ea(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(f=eY(_n(e,qa(s.style)),s.style,c,t))}s.links.map(function(D){try{var V=rh(Ea(e,Tw(qa(D))),D);return aY(_n(e,qa(D)),V,D,t)}catch{}});var u=YG(_n(e,qa(s.workbooks[0])),s.workbooks[0],t),p={},d="";s.coreprops.length&&(d=_n(e,qa(s.coreprops[0]),!0),d&&(p=cC(d)),s.extprops.length!==0&&(d=_n(e,qa(s.extprops[0]),!0),d&&Vz(d,p,t)));var h={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(d=Ea(e,qa(s.custprops[0]),!0),d&&(h=Gz(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?i=u.Sheets.map(function(V){return V.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(m.Props=p,m.Custprops=h),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var g={};t.bookDeps&&s.calcchain&&(g=sY(_n(e,qa(s.calcchain)),s.calcchain));var y=0,v={},b,w;{var S=u.Sheets;p.Worksheets=S.length,p.SheetNames=[];for(var A=0;A!=S.length;++A)p.SheetNames[A]=S[A].name}var F=a?"bin":"xml",T=s.workbooks[0].lastIndexOf("/"),O=(s.workbooks[0].slice(0,T+1)+"_rels/"+s.workbooks[0].slice(T+1)+".rels").replace(/^\//,"");Wa(e,O)||(O="xl/_rels/workbook."+F+".rels");var C=rh(Ea(e,O,!0),O.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=iY(_n(e,qa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=QW(_n(e,qa(s.people[0])),t)),C&&(C=qY(C,u.Sheets));var R=_n(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(y=0;y!=p.Worksheets;++y){var k="sheet";if(C&&C[y]?(b="xl/"+C[y][1].replace(/[\/]?xl\//,""),Wa(e,b)||(b=C[y][1]),Wa(e,b)||(b=O.replace(/_rels\/.*$/,"")+C[y][1]),k=C[y][2]):(b="xl/worksheets/sheet"+(y+1-R)+"."+F,b=b.replace(/sheet0\./,"sheet.")),w=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(y!=t.sheets)continue e;break;case"string":if(p.SheetNames[y].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==y&&(P=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==p.SheetNames[y].toLowerCase()&&(P=1);if(!P)continue e}}HY(e,b,w,p.SheetNames[y],y,v,i,k,t,u,c,f)}return m={Directory:s,Workbook:u,Props:p,Custprops:h,Deps:g,Sheets:i,SheetNames:p.SheetNames,Strings:ah,Styles:f,Themes:c,SSF:is(Wt)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(D,V){D=D.replace(/^Root Entry[\/]/,""),m.keys.push(D),m.files[D]=e.FileIndex[V]}))),t&&t.bookVBA&&(s.vba.length>0?m.vbaraw=_n(e,qa(s.vba[0]),!0):s.defaults&&s.defaults.bin===rV&&(m.vbaraw=_n(e,"xl/vbaProject.bin",!0))),m}function VY(e,t){var r=t||{},n="Workbook",s=ar.find(e,n);try{if(n="/!DataSpaces/Version",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(MH(s.content),n="/!DataSpaces/DataSpaceMap",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=UH(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=$H(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);qH(s.content)}catch{}if(n="/EncryptionInfo",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=HH(s.content);if(n="/EncryptedPackage",s=ar.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Kb(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=La(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function KY(e,t){return ar.find(e,"EncryptedPackage")?VY(e,t):KC(e,t)}function GY(e,t){var r,n=e,s=t||{};return s.type||(s.type=rr&&Buffer.isBuffer(e)?"buffer":"base64"),r=UT(n,s),WY(r,s)}function JC(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fw(e.slice(r),t);default:break e}return Yh.to_workbook(e,t)}function YY(e,t){var r="",n=Kb(e,t);switch(t.type){case"base64":r=La(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ru(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Pr(r)),t.type="binary",JC(r,t)}function XY(e,t){var r=e;return t.type=="base64"&&(r=La(r)),r=Wh.utils.decode(1200,r.slice(2),"str"),t.type="binary",JC(r,t)}function JY(e){return e.match(/[^\x00-\x7F]/)?I0(e):e}function lv(e,t,r,n){return n?(r.type="string",Yh.to_workbook(e,r)):Yh.to_workbook(t,r)}function Rw(e,t){NT();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Rw(new Uint8Array(e),(r=is(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Qf={},r.dateNF&&(Qf.dateNF=r.dateNF),r.type||(r.type=rr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=rr?"buffer":"binary",n=M$(e),typeof Uint8Array<"u"&&!rr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=JY(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=is(r),r.type="array",Rw(kb(n),r)}switch((s=Kb(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return KY(ar.read(n,r),r);break;case 9:if(s[1]<=8)return KC(n,r);break;case 60:return Fw(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return kH(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return SH.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?GY(n,r):lv(e,n,r,a);case 239:return s[3]===60?Fw(n,r):lv(e,n,r,a);case 255:if(s[1]===254)return XY(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return sh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return sh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return e_.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return rW.to_workbook(n,r);break;case 10:case 13:case 32:return YY(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return bH.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?e_.to_workbook(n,r):lv(e,n,r,a)}function QY(e,t,r,n,s,a,i,o){var c=os(r),f=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,d=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!i||e[r])for(var h=t.s.c;h<=t.e.c;++h){var m=i?e[r][h]:e[n[h]+c];if(m===void 0||m.t===void 0){if(f===void 0)continue;a[h]!=null&&(d[a[h]]=f);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[h]!=null){if(g==null)if(m.t=="e"&&g===null)d[a[h]]=null;else if(f!==void 0)d[a[h]]=f;else if(u&&g===null)d[a[h]]=null;else continue;else d[a[h]]=u&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:pl(m,g,o);g!=null&&(p=!1)}}return{row:d,isempty:p}}function Iw(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},u=f.range!=null?f.range:e["!ref"];switch(f.header===1?n=1:f.header==="A"?n=2:Array.isArray(f.header)?n=3:f.header==null&&(n=0),typeof u){case"string":c=nn(u);break;case"number":c=nn(e["!ref"]),c.s.r=u;break;default:c=u}n>0&&(s=0);var p=os(c.s.r),d=[],h=[],m=0,g=0,y=Array.isArray(e),v=c.s.r,b=0,w={};y&&!e[v]&&(e[v]=[]);var S=f.skipHidden&&e["!cols"]||[],A=f.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(S[b]||{}).hidden)switch(d[b]=Mn(b),r=y?e[v][b]:e[d[b]+p],n){case 1:a[b]=b-c.s.c;break;case 2:a[b]=d[b];break;case 3:a[b]=f.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=pl(r,null,f),g=w[i]||0,!g)w[i]=1;else{do o=i+"_"+g++;while(w[o]);w[i]=g,w[o]=1}a[b]=o}for(v=c.s.r+s;v<=c.e.r;++v)if(!(A[v]||{}).hidden){var F=QY(e,c,v,d,n,a,y,f);(F.isempty===!1||(n===1?f.blankrows!==!1:f.blankrows))&&(h[m++]=F.row)}return h.length=m,h}var x_=/"/g;function ZY(e,t,r,n,s,a,i,o){for(var c=!0,f=[],u="",p=os(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var h=o.dense?(e[r]||[])[d]:e[n[d]+p];if(h==null)u="";else if(h.v!=null){c=!1,u=""+(o.rawNumbers&&h.t=="n"?h.v:pl(h,null,o));for(var m=0,g=0;m!==u.length;++m)if((g=u.charCodeAt(m))===s||g===a||g===34||o.forceQuotes){u='"'+u.replace(x_,'""')+'"';break}u=="ID"&&(u='"ID"')}else h.f!=null&&!h.F?(c=!1,u="="+h.f,u.indexOf(",")>=0&&(u='"'+u.replace(x_,'""')+'"')):u="";f.push(u)}return o.blankrows===!1&&c?null:f.join(i)}function QC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=nn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),u="",p=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(d[m]||{}).hidden||(p[m]=Mn(m));for(var g=0,y=s.s.r;y<=s.e.r;++y)(h[y]||{}).hidden||(u=ZY(e,s,y,p,i,c,a,n),u!=null&&(n.strip&&(u=u.replace(f,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function eX(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=QC(e,t);return r}function tX(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=nn(e["!ref"]),a="",i=[],o,c=[],f=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Mn(o);for(var u=s.s.r;u<=s.e.r;++u)for(a=os(u),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=f?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function ZC(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?zs(n.origin):n.origin;i=c.r,o=c.c}var f,u={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var p=nn(a["!ref"]);u.e.c=Math.max(u.e.c,p.e.c),u.e.r=Math.max(u.e.r,p.e.r),i==-1&&(i=p.e.r+1,u.e.r=i+t.length-1+s)}else i==-1&&(i=0,u.e.r=t.length-1+s);var d=n.header||[],h=0;t.forEach(function(g,y){wo(g).forEach(function(v){(h=d.indexOf(v))==-1&&(d[h=d.length]=v);var b=g[v],w="z",S="",A=Ut({c:o+h,r:i+y+s});f=Zh(a,A),b&&typeof b=="object"&&!(b instanceof Date)?a[A]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",n.cellDates||(w="n",b=Gs(b)),S=n.dateNF||Wt[14]):b===null&&n.nullError&&(w="e",b=0),f?(f.t=w,f.v=b,delete f.w,delete f.R,S&&(f.z=S)):a[A]=f={t:w,v:b},S&&(f.z=S))})}),u.e.c=Math.max(u.e.c,o+d.length-1);var m=os(i);if(s)for(h=0;h<d.length;++h)a[Mn(h+o)+m]={t:"s",v:d[h]};return a["!ref"]=ir(u),a}function rX(e,t){return ZC(null,e,t)}function Zh(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=zs(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Zh(e,Ut(t)):Zh(e,Ut({r:t,c:r||0}))}function nX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Gb(){return{SheetNames:[],Sheets:{}}}function Yb(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if($G(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function sX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=nX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function aX(e,t){return e.z=t,e}function e8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function iX(e,t,r){return e8(e,"#"+t,r)}function oX(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function lX(e,t,r,n){for(var s=typeof t!="string"?t:nn(t),a=typeof t=="string"?t:ir(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=Zh(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var cX={encode_col:Mn,encode_row:os,encode_cell:Ut,encode_range:ir,decode_col:Db,decode_row:Lb,split_cell:wz,decode_cell:zs,decode_range:Rd,format_cell:pl,sheet_add_aoa:sC,sheet_add_json:ZC,sheet_add_dom:GC,aoa_to_sheet:Id,json_to_sheet:rX,table_to_sheet:YC,table_to_book:kY,sheet_to_csv:QC,sheet_to_txt:eX,sheet_to_json:Iw,sheet_to_html:_Y,sheet_to_formulae:tX,sheet_to_row_object_array:Iw,sheet_get_cell:Zh,book_new:Gb,book_append_sheet:Yb,book_set_sheet_visibility:sX,cell_set_number_format:aX,cell_set_hyperlink:e8,cell_set_internal_link:iX,cell_add_comment:oX,sheet_set_array_formula:lX,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const t8=({projectId:e,onClose:t,onImported:r})=>{const{user:n}=Yr(),[s,a]=me.useState(null),[i,o]=me.useState(""),[c,f]=me.useState(""),[u,p]=me.useState([]),[d,h]=me.useState(!1),[m,g]=me.useState(""),y=async S=>{var F;const A=(F=S.target.files)==null?void 0:F[0];if(A){a(A),g(""),h(!0);try{const T=await A.arrayBuffer(),O=Rw(T),C=O.Sheets[O.SheetNames[0]],R=cX.sheet_to_json(C,{header:1}),k=[];for(let P=1;P<R.length;P++){const q=R[P];if(!q||q.length===0||!q.some(E=>E))continue;const D=parseInt(q[0])||P,V=String(q[1]||"").trim(),se=String(q[2]||"M").trim(),ne=parseFloat(q[3])||0,X=parseFloat(q[4])||0,G=ne*X;let ve=!0,ye="";V||(ve=!1,ye="Dsignation manquante"),k.push({numero:D,designation:V,unite:se,quantite:ne,prixUnitaire:X,montant:G,isValid:ve,error:ye})}if(p(k),!i){const P=A.name.replace(/\.[^/.]+$/,"");o(P)}}catch(T){g("Erreur lors de la lecture du fichier. Vrifiez le format Excel."),console.error(T)}finally{h(!1)}}},v=async()=>{if(!n||!i.trim()||!c.trim()||u.length===0){alert("Veuillez remplir tous les champs et charger un fichier valide");return}const S=u.filter(R=>R.isValid);if(S.length===0){alert("Aucune ligne valide  importer");return}const A=`bordereau:${Ir()}`,F=new Date().toISOString(),T=S.map((R,k)=>({id:Ir(),numero:k+1,designation:R.designation,unite:R.unite,quantite:R.quantite,prixUnitaire:R.prixUnitaire,montant:R.montant})),O=T.reduce((R,k)=>R+k.montant,0),C={id:A,projectId:e,userId:n.id,reference:i.trim(),designation:c.trim(),lignes:T,montantTotal:O,createdAt:F,updatedAt:F};await Se.bordereaux.add(C),await mn("CREATE","bordereau",A.replace("bordereau:",""),C,n.id),r(A)},b=u.filter(S=>S.isValid).length,w=u.filter(S=>!S.isValid).length;return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Importer depuis Excel"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Format attendu: N, Dsignation, Unit, Quantit, Prix unitaire"})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(vo,{className:"w-5 h-5"})})]}),l.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),l.jsx("input",{type:"text",value:i,onChange:S=>o(S.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-01"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),l.jsx("input",{type:"text",value:c,onChange:S=>f(S.target.value),className:"input w-full",placeholder:"Ex: Bordereau import"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier Excel (.xlsx, .xls)"}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary-500 transition-colors",children:[l.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:y,className:"hidden",id:"excel-upload"}),l.jsxs("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[l.jsx(M9,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s?l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:s.name}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(s.size/1024).toFixed(2)," KB"]})]}):l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Cliquer pour slectionner un fichier"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ou glisser-dposer"})]})]})]})]}),m&&l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[l.jsx(Qa,{className:"w-5 h-5 text-red-600 mt-0.5"}),l.jsx("p",{className:"text-sm text-red-900",children:m})]}),u.length>0&&l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h4",{className:"font-medium text-gray-900",children:"Aperu des donnes"}),l.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[l.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[l.jsx(yg,{className:"w-4 h-4"}),b," valides"]}),w>0&&l.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[l.jsx(Qa,{className:"w-4 h-4"}),w," erreurs"]})]})]}),l.jsx("div",{className:"border rounded-lg overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:"w-full text-sm",children:[l.jsx("thead",{className:"bg-gray-50 border-b sticky top-0",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"N"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Dsignation"}),l.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"U"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Qt"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"P.U"}),l.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Montant"}),l.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700",children:"Statut"})]})}),l.jsx("tbody",{className:"divide-y",children:u.map((S,A)=>l.jsxs("tr",{className:S.isValid?"":"bg-red-50",children:[l.jsx("td",{className:"px-3 py-2",children:S.numero}),l.jsx("td",{className:"px-3 py-2",children:S.designation||l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"px-3 py-2",children:S.unite}),l.jsx("td",{className:"px-3 py-2 text-right",children:S.quantite}),l.jsx("td",{className:"px-3 py-2 text-right",children:S.prixUnitaire.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-right font-medium",children:S.montant.toFixed(2)}),l.jsx("td",{className:"px-3 py-2 text-center",children:S.isValid?l.jsx(yg,{className:"w-4 h-4 text-green-600 mx-auto"}):l.jsxs("div",{className:"flex items-center justify-center gap-1",children:[l.jsx(Qa,{className:"w-4 h-4 text-red-600"}),l.jsx("span",{className:"text-xs text-red-600",children:S.error})]})})]},A))})]})})})]}),d&&l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"}),l.jsx("p",{className:"ml-3 text-gray-600",children:"Traitement du fichier..."})]})]}),l.jsx("div",{className:"p-6 border-t bg-gray-50",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),l.jsxs("button",{onClick:v,disabled:u.length===0||b===0||!i.trim()||!c.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[l.jsx(Nb,{className:"w-4 h-4"}),"Importer ",b>0&&`(${b} lignes)`]})]})})]})})},r8="app_storage_config",kp=()=>{const e=localStorage.getItem(r8);return e?JSON.parse(e):{type:"local",basePath:"MesProjetsBTP"}},n8=e=>{localStorage.setItem(r8,JSON.stringify(e))},s8=(e,t)=>{const r=t.replace(/\//g,"-").replace(/\s+/g,"-");return`${e}/${r}`},uX=e=>{const n=`${kp().basePath}/${e}`;return{root:n,bordereau:`${n}/Bordereau`,metre:`${n}/Mtr`,decomptes:`${n}/Dcomptes`,attachements:`${n}/Attachements`,photos:`${n}/Photos`,pv:`${n}/PV`,documents:`${n}/Documents`}},fX=async(e,t)=>{const r=kp(),n=s8(e,t),s=uX(n);switch(r.type){case"local":await Og(s);break;case"onedrive":await dX(s);break;case"google-drive":await hX(s);break;default:await Og(s)}return s},Og=async e=>{if("showDirectoryPicker"in window)try{console.log(" File System Access API disponible")}catch(r){console.warn("Impossible de crer les dossiers locaux:",r)}else console.log(" File System Access API non disponible, utilisation du mode fallback");const t=JSON.parse(localStorage.getItem("project_folders")||"{}");t[e.root]={structure:e,createdAt:new Date().toISOString()},localStorage.setItem("project_folders",JSON.stringify(t)),console.log(" Structure de dossiers enregistre:",e)},dX=async e=>{console.log(" OneDrive folders ( implmenter):",e),await Og(e)},hX=async e=>{console.log(" Google Drive folders ( implmenter):",e),await Og(e)},pX=async e=>{var n;const r=`${kp().basePath}/${e}`;if((n=window.electronAPI)!=null&&n.openFolder){await window.electronAPI.openFolder(r);return}alert(`Chemin du dossier:
${r}

Copiez ce chemin pour accder au dossier.`)};let mf=null;const mX=async()=>{if(!("showDirectoryPicker"in window))return alert("Votre navigateur ne supporte pas la slection de dossiers. Utilisez Chrome, Edge ou Opera."),null;try{if(mf=await window.showDirectoryPicker({mode:"readwrite"}),mf){const e=kp();return e.basePath=mf.name,n8(e),localStorage.setItem("base_folder_name",mf.name),console.log(" Dossier de base slectionn:",mf.name),mf.name}return null}catch(e){return console.warn("Slection de dossier annule:",e),null}},gX=()=>{const{t:e}=Mi(),{id:t}=Pc(),r=Gn(),{user:n}=Yr(),[s,a]=me.useState("overview"),[i,o]=me.useState(!1),[c,f]=me.useState(null),u=t!=null&&t.startsWith("project:")?t:`project:${t}`,p=t!=null&&t.startsWith("project:")?t.replace("project:",""):t;console.log(" ProjectDetailPage - URL id:",t),console.log(" ProjectDetailPage - projectId (with prefix):",u),console.log(" ProjectDetailPage - rawId (without prefix):",p);const d=$t(async()=>{console.log(" Searching for project with prefix:",u);let D=await Se.projects.get(u);console.log(" Result with prefix:",D?"FOUND":"NOT FOUND"),D||(console.log(" Searching for project without prefix:",p),D=await Se.projects.get(p),console.log(" Result without prefix:",D?"FOUND":"NOT FOUND"));const V=await Se.projects.toArray();return console.log(" All projects in IndexedDB:",V.map(se=>({id:se.id,objet:se.objet}))),D},[t]),h=$t(async()=>{const D=await Se.bordereaux.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.bordereaux.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),m=$t(async()=>{const D=await Se.metres.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.metres.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),g=$t(async()=>{const D=await Se.decompts.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.decompts.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),y=$t(async()=>{const D=await Se.photos.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.photos.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),v=$t(async()=>{const D=await Se.pvs.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.pvs.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),b=$t(async()=>{const D=await Se.attachments.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.attachments.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),w=$t(async()=>{const D=await Se.periodes.where("projectId").equals(u).and(V=>!V.deletedAt).toArray();return D.length>0?D:Se.periodes.where("projectId").equals(p).and(V=>!V.deletedAt).toArray()},[t]),S=h&&h.length>0?h[0].lignes.reduce((D,V)=>{const ne=V.quantite*(V.prixUnitaire||0)*1.2;return D+ne},0):0,F=(()=>{if(!g||g.length===0||S===0)return 0;const D=g.reduce((ne,X)=>!ne||X.numero>ne.numero?X:ne,g[0]),se=((D==null?void 0:D.totalTTC)||(D==null?void 0:D.montantTotal)||0)/S*100;return Math.min(100,Math.max(0,se))})(),T=async()=>{!n||!d||confirm("tes-vous sr de vouloir supprimer ce projet ? Cette action est irrversible.")&&(await Se.projects.update(d.id,{deletedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),await mn("DELETE","project",t,d,n.id),r("/projects"))},O=async D=>{if(!n||!t)return;const V=`bordereau:${Ir()}`,se=new Date().toISOString(),ne={id:V,projectId:u,userId:n.id,reference:D.reference,designation:D.designation,lignes:[],montantTotal:0,createdAt:se,updatedAt:se};await Se.bordereaux.add(ne),await mn("CREATE","bordereau",V.replace("bordereau:",""),ne,n.id),f(null)},[C,R]=me.useState(!1);if(me.useEffect(()=>{const D=setTimeout(()=>{d||R(!0)},5e3);return()=>clearTimeout(D)},[d]),!d)return C?l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:l.jsx(Qa,{className:"w-8 h-8 text-yellow-600"})}),l.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),l.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Le projet n'existe pas localement. Essayez de synchroniser."}),l.jsx("button",{onClick:()=>window.location.reload(),className:"btn btn-primary",children:"Rafrachir la page"})]})}):l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})});const k=[{id:"overview",label:"Vue d'ensemble",icon:Du,count:null},{id:"bordereau",label:"Bordereau",icon:Sr,count:h&&h.length>0?1:0},{id:"periodes",label:"Priodes",icon:Ei,count:null},{id:"metre",label:"Mtr",icon:aa,count:(m==null?void 0:m.length)||0},{id:"decompt",label:"Dcompte",icon:ka,count:(g==null?void 0:g.length)||0},{id:"photos",label:"Photos",icon:b0,count:(y==null?void 0:y.length)||0},{id:"pv",label:"PV",icon:Sr,count:(v==null?void 0:v.length)||0},{id:"documents",label:"Documents",icon:Om,count:(b==null?void 0:b.length)||0}],P=D=>{switch(D){case"active":return"bg-green-100 text-green-700 border-green-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"archived":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-yellow-100 text-yellow-700 border-yellow-200"}},q=D=>{switch(D){case"active":return l.jsx(xo,{className:"w-4 h-4"});case"completed":return l.jsx(Fa,{className:"w-4 h-4"});default:return l.jsx(Sr,{className:"w-4 h-4"})}};return l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>r("/projects"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[l.jsx(Ts,{className:"w-5 h-5"}),l.jsx("span",{children:"Retour aux projets"})]}),l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["March N ",d.marcheNo]}),l.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-full border ${P(d.status)}`,children:[q(d.status),e(`project.status.${d.status}`)]})]}),l.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Ei,{className:"w-4 h-4"}),d.annee]}),l.jsx("span",{children:""}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(ka,{className:"w-4 h-4"}),S.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD (TTC)"]}),d.societe&&l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(bw,{className:"w-4 h-4"}),d.societe]})]})]}),l.jsx("p",{className:"text-gray-600 mt-2 line-clamp-2",title:d.objet,children:d.objet})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[l.jsx(qu,{className:"w-4 h-4"}),"Exporter"]}),l.jsxs(Ai,{to:`/projects/${t}/edit`,className:"btn btn-primary flex items-center gap-2",children:[l.jsx(_w,{className:"w-4 h-4"}),"Modifier"]}),l.jsxs("div",{className:"relative",children:[l.jsx("button",{onClick:()=>o(!i),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Y9,{className:"w-5 h-5 text-gray-600"})}),i&&l.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[l.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[l.jsx(Z9,{className:"w-4 h-4"}),"Partager"]}),l.jsxs("button",{onClick:T,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[l.jsx(fa,{className:"w-4 h-4"}),"Supprimer"]})]})]})]})]})]}),l.jsxs("div",{className:"card mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progression du projet"}),l.jsxs("span",{className:`text-2xl font-bold ${F>100?"text-red-600":"text-primary-600"}`,children:[F.toFixed(1),"%"]})]}),l.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-500 ${F>100?"bg-gradient-to-r from-red-500 to-red-600":F>80?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-primary-500 to-primary-600"}`,style:{width:`${Math.min(100,F)}%`}})}),l.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Mis  jour le ",Vr(new Date(d.updatedAt),"dd MMMM yyyy  HH:mm",{locale:Ti})]}),F>100&&l.jsx("span",{className:"text-xs text-red-500 font-medium",children:" Dpassement du budget!"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(Sr,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:h&&h.length>0?"1":"0"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Bordereau"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(m==null?void 0:m.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Mtrs"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(ka,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(g==null?void 0:g.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dcomptes"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-yellow-100 text-yellow-600 rounded-lg",children:l.jsx(b0,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(y==null?void 0:y.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Photos"})]})]})})]}),l.jsx("div",{className:"border-b border-gray-200 mb-6",children:l.jsx("div",{className:"flex gap-1 overflow-x-auto",children:k.map(D=>{const V=D.icon;return l.jsxs("button",{onClick:()=>a(D.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${s===D.id?"border-primary-600 text-primary-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:[l.jsx(V,{className:"w-4 h-4"}),D.label,D.count!==null&&l.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s===D.id?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:D.count})]},D.id)})})}),l.jsxs("div",{children:[s==="overview"&&l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Objet du march"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.objet})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Numro de march"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.marcheNo})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Anne"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.annee})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Date d'ouverture"}),l.jsx("p",{className:"font-medium text-gray-900",children:Vr(new Date(d.dateOuverture),"dd/MM/yyyy")})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Montant (TTC)"}),l.jsxs("p",{className:"font-medium text-primary-600 text-lg",children:[S.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Statut"}),l.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 text-sm font-medium rounded-full border ${P(d.status)}`,children:[q(d.status),e(`project.status.${d.status}`)]})]})]})]}),(d.snss||d.cbn||d.rcn||d.osc)&&l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations administratives"}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[d.snss&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"SNSS"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.snss})]}),d.cbn&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"CBN"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.cbn})]}),d.rcn&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"RCN"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.rcn})]}),d.osc&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"OSC"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.osc})]})]})]}),(d.societe||d.patente||d.delaisEntreeService)&&l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de la socit"}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[d.societe&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Nom de la socit"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.societe})]}),d.patente&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Patente"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.patente})]}),d.delaisEntreeService&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Dlais d'entre en service"}),l.jsx("p",{className:"font-medium text-gray-900",children:d.delaisEntreeService})]})]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Chronologie"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center",children:l.jsx(Fa,{className:"w-4 h-4"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Projet cr"}),l.jsx("p",{className:"text-xs text-gray-500",children:Vr(new Date(d.createdAt),"dd/MM/yyyy  HH:mm",{locale:Ti})})]})]}),d.updatedAt!==d.createdAt&&l.jsxs("div",{className:"flex gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center",children:l.jsx(_w,{className:"w-4 h-4"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Dernire modification"}),l.jsx("p",{className:"text-xs text-gray-500",children:Vr(new Date(d.updatedAt),"dd/MM/yyyy  HH:mm",{locale:Ti})})]})]})]})]}),l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Ajouter un bordereau"]}),l.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[l.jsx(b0,{className:"w-4 h-4"}),"Ajouter des photos"]}),l.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[l.jsx(Om,{className:"w-4 h-4"}),"Joindre un document"]})]})]}),l.jsx("div",{className:"card bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200",children:l.jsxs("div",{className:"flex items-start gap-3",children:[l.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-primary-600 text-white rounded-lg flex items-center justify-center",children:l.jsx(Du,{className:"w-5 h-5"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Dossier du projet"}),l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:d.folderPath||`${d.annee}/${d.marcheNo}`}),l.jsxs("button",{onClick:()=>pX(d.folderPath||`${d.annee}/${d.marcheNo}`),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 font-medium",children:[l.jsx(Sw,{className:"w-4 h-4"}),"Ouvrir le dossier",l.jsx(I9,{className:"w-3 h-3"})]})]})]})})]})]}),s==="bordereau"&&l.jsx(l.Fragment,{children:h&&h.length>0?l.jsx(xT,{bordereauId:h[0].id,onClose:()=>a("overview")}):l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"text-center py-8 mb-6",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),l.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsx("button",{onClick:()=>f("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(Vs,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),l.jsx("button",{onClick:()=>f("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(iT,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),l.jsx("button",{onClick:()=>f("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(wg,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),l.jsx("button",{onClick:()=>f("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(Nb,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]})}),s==="periodes"&&l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ei,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Gestion des priodes"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Organisez vos mtrs et dcomptes par priode"}),l.jsxs("button",{onClick:()=>r(`/projects/${t}/periodes`),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Ei,{className:"w-4 h-4"}),"Grer les priodes"]})]})}),s==="metre"&&l.jsx(l.Fragment,{children:h&&h.length>0?l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Mtrs du projet"}),l.jsxs("button",{onClick:()=>r(`/projects/${t}/metre`),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(aa,{className:"w-4 h-4"}),"Grer les mtrs"]})]}),m&&m.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Rfrence"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Dsignation"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Unit"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Qt Partielle"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700",children:"Qt Cumule"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"% Ralisation"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:m.map(D=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-gray-700",children:D.reference}),l.jsx("td",{className:"px-4 py-3 text-gray-900",children:D.designationBordereau}),l.jsx("td",{className:"px-4 py-3 text-center",children:l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:D.unite})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900",children:D.totalPartiel.toFixed(2)}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-primary-600",children:D.totalCumule.toFixed(2)}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-300 ${D.pourcentageRealisation>=100?"bg-green-500":D.pourcentageRealisation>=75?"bg-blue-500":D.pourcentageRealisation>=50?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${Math.min(D.pourcentageRealisation,100)}%`}})}),l.jsxs("span",{className:"text-xs font-medium text-gray-700 w-12 text-right",children:[D.pourcentageRealisation.toFixed(0),"%"]})]})})]},D.id))})]})}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(aa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{className:"text-gray-600",children:"Aucun mtr cr"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'Cliquez sur "Grer les mtrs" pour commencer'})]})]}):l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bordereau requis"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),l.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})}),s==="decompt"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Dcomptes (",(g==null?void 0:g.length)||0,")"]})}),g&&g.length>0?l.jsx("div",{className:"grid gap-4",children:g.sort((D,V)=>V.numero-D.numero).map(D=>{var ne;const V=w==null?void 0:w.find(X=>X.id===D.periodeId),se=V==null?void 0:V.isDecompteDernier;return l.jsx("div",{className:"card hover:shadow-md transition-shadow cursor-pointer",onClick:()=>r(`/projects/${t}/periodes/${D.periodeId.replace("periode:","")}/decompte`),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${se?"bg-green-100":"bg-primary-100"}`,children:l.jsx(ka,{className:`w-6 h-6 ${se?"text-green-600":"text-primary-600"}`})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"font-semibold text-gray-900",children:["Dcompte N ",D.numero,se&&l.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"et dernier"})]}),l.jsx("p",{className:"text-sm text-gray-500",children:V?`${V.libelle}`:"Priode non trouve"})]})]}),l.jsxs("div",{className:"flex items-center gap-6",children:[l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Montant HT"}),l.jsxs("p",{className:"font-semibold text-gray-900",children:[(ne=D.montantTotal)==null?void 0:ne.toLocaleString("fr-FR",{minimumFractionDigits:2})," MAD"]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Statut"}),l.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${D.statut==="validated"?"bg-green-100 text-green-800":D.statut==="submitted"?"bg-blue-100 text-blue-800":D.statut==="paid"?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800"}`,children:D.statut==="validated"?"Valid":D.statut==="submitted"?"Soumis":D.statut==="paid"?"Pay":"Brouillon"})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),l.jsx("p",{className:"text-sm text-gray-700",children:Vr(new Date(D.createdAt),"dd/MM/yyyy",{locale:Ti})})]}),l.jsx(Gf,{className:"w-5 h-5 text-gray-400"})]})]})},D.id)})}):l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ka,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun dcompte"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Crez des priodes puis des dcomptes pour facturer les travaux excuts"}),l.jsxs("button",{onClick:()=>a("periodes"),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Ei,{className:"w-4 h-4"}),"Voir les priodes"]})]})})]}),s==="photos"&&l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(b0,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune photo"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Ajoutez des photos pour documenter l'avancement du projet"}),l.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(b0,{className:"w-4 h-4"}),"Ajouter des photos"]})]})}),s==="pv"&&l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun PV"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Grez vos procs-verbaux (installation, rception, constat...)"}),l.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Crer un PV"]})]})}),s==="documents"&&l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Om,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun document"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Attachez vos factures, plans, et autres documents importants"}),l.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Om,{className:"w-4 h-4"}),"Joindre un document"]})]})})]}),c==="blank"&&l.jsx(vT,{onClose:()=>f(null),onCreate:O}),c==="template"&&l.jsx(yT,{projectId:t,onClose:()=>f(null),onCreated:()=>f(null)}),c==="copy"&&l.jsx(wT,{currentProjectId:t,onClose:()=>f(null),onCopied:()=>f(null)}),c==="import"&&l.jsx(t8,{projectId:t,onClose:()=>f(null),onImported:()=>f(null)})]})},xX=async(e,t)=>{if(!t||t.length<2)return await Se.companies.where("userId").equals(e).reverse().sortBy("usageCount").then(s=>s.slice(0,10));const r=t.toLowerCase();return(await Se.companies.where("userId").equals(e).filter(s=>{const a=s.nom.toLowerCase().includes(r),i=s.rc?s.rc.toLowerCase().includes(r):!1,o=s.cnss?s.cnss.toLowerCase().includes(r):!1;return a||i||o}).toArray()).sort((s,a)=>{const i=s.nom.toLowerCase().startsWith(r),o=a.nom.toLowerCase().startsWith(r);return i&&!o?-1:!i&&o?1:a.usageCount-s.usageCount}).slice(0,10)},vX=async(e,t)=>(await Se.companies.where("userId").equals(e).filter(n=>n.nom.toLowerCase()===t.toLowerCase()).toArray())[0],a8=async(e,t)=>{const r=new Date().toISOString(),n=await vX(e,t.nom);if(n){const s={...t,usageCount:n.usageCount+1,lastUsed:r,updatedAt:r};return await Se.companies.update(n.id,s),{...n,...s}}else{const s={id:`company:${Ir()}`,userId:e,nom:t.nom,rc:t.rc,cb:t.cb,cnss:t.cnss,patente:t.patente,adresse:t.adresse,telephone:t.telephone,email:t.email,usageCount:1,lastUsed:r,createdAt:r,updatedAt:r};return await Se.companies.add(s),s}},i8=e=>e.societe?{nom:e.societe,rc:e.rc,cb:e.cb,cnss:e.cnss,patente:e.patente}:null,o8=({userId:e,value:t,onChange:r,onSelect:n,placeholder:s="Nom de la socit",className:a=""})=>{const[i,o]=me.useState(!1),[c,f]=me.useState([]),[u,p]=me.useState(!1),[d,h]=me.useState(-1),m=me.useRef(null),g=me.useRef(null);me.useEffect(()=>{const S=A=>{m.current&&!m.current.contains(A.target)&&o(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),me.useEffect(()=>{const A=setTimeout(async()=>{if(e){p(!0);try{const F=await xX(e,t);f(F)}catch(F){console.error("Erreur recherche entreprises:",F),f([])}finally{p(!1)}}},200);return()=>clearTimeout(A)},[e,t]);const y=S=>{if(!i){(S.key==="ArrowDown"||S.key==="Enter")&&o(!0);return}switch(S.key){case"ArrowDown":S.preventDefault(),h(A=>A<c.length-1?A+1:A);break;case"ArrowUp":S.preventDefault(),h(A=>A>0?A-1:A);break;case"Enter":S.preventDefault(),d>=0&&c[d]&&v(c[d]);break;case"Escape":o(!1),h(-1);break}},v=S=>{r(S.nom),n(S),o(!1),h(-1)},b=S=>{r(S.target.value),o(!0),h(-1)},w=()=>{o(!0)};return l.jsxs("div",{ref:m,className:`relative ${a}`,children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{ref:g,type:"text",value:t,onChange:b,onFocus:w,onKeyDown:y,placeholder:s,className:"input w-full pl-10 pr-8",autoComplete:"off"}),l.jsx(bw,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t&&l.jsx("button",{type:"button",onClick:()=>{var S;r(""),(S=g.current)==null||S.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l.jsx(vo,{className:"w-4 h-4"})})]}),i&&(c.length>0||u)&&l.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto",children:u?l.jsx("div",{className:"p-3 text-center text-gray-500",children:l.jsx("div",{className:"w-5 h-5 border-2 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto"})}):l.jsx(l.Fragment,{children:c.length>0&&l.jsxs("div",{className:"py-1",children:[l.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-gray-500 bg-gray-50",children:"Entreprises enregistres"}),c.map((S,A)=>l.jsxs("button",{type:"button",onClick:()=>v(S),className:`w-full px-3 py-2 text-left flex items-start gap-3 transition-colors ${A===d?"bg-primary-50":"hover:bg-gray-50"}`,children:[l.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${A===d?"bg-primary-100":"bg-gray-100"}`,children:l.jsx(bw,{className:`w-4 h-4 ${A===d?"text-primary-600":"text-gray-500"}`})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:S.nom}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:[S.rc&&`RC: ${S.rc}`,S.cnss&&`CNSS: ${S.cnss}`].filter(Boolean).join("  ")||"Aucune info supplmentaire"})]}),S.usageCount>1&&l.jsxs("span",{className:"flex-shrink-0 text-xs text-gray-400",children:[S.usageCount,"x"]})]},S.id))]})})}),i&&!u&&c.length===0&&t.length>=2&&l.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-3",children:l.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[l.jsx(Nx,{className:"w-4 h-4"}),l.jsx("span",{children:"Nouvelle entreprise - les infos seront sauvegardes automatiquement"})]})})]})},yX=()=>{const{t:e}=Mi(),t=Gn(),{user:r}=Yr(),[n,s]=me.useState(!1),[a,i]=me.useState(null),[o,c]=me.useState({objet:"",marcheNo:"",annee:new Date().getFullYear().toString(),dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",achevementTravaux:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""}),f=async u=>{if(u.preventDefault(),!!r){s(!0),i(null);try{const p=`project:${Ir()}`,d=new Date().toISOString(),h=s8(o.annee,o.marcheNo);try{await fX(o.annee,o.marcheNo),console.log(" Dossiers du projet crs:",h)}catch(y){console.warn(" Impossible de crer les dossiers (mode fallback):",y)}const m={id:p,userId:r.id,objet:o.objet,marcheNo:o.marcheNo,annee:o.annee,dateOuverture:o.dateOuverture,montant:0,typeMarche:o.typeMarche,commune:o.commune||void 0,societe:o.societe,rc:o.rc,cb:o.cb,cnss:o.cnss,patente:o.patente,programme:o.programme,projet:o.projet,ligne:o.ligne,chapitre:o.chapitre,delaisExecution:o.delaisExecution?parseInt(o.delaisExecution):void 0,status:o.status,osc:o.osc||void 0,dateReceptionProvisoire:o.dateReceptionProvisoire||void 0,dateReceptionDefinitive:o.dateReceptionDefinitive||void 0,arrets:[],progress:0,folderPath:h,createdAt:d,updatedAt:d};await Se.projects.add(m);const g=i8(o);if(g)try{await a8(r.id,g),console.log(" Entreprise sauvegarde pour autocompltion:",g.nom)}catch(y){console.warn(" Impossible de sauvegarder l'entreprise:",y)}await Se.syncOperations.add({id:`sync:${Ir()}`,userId:r.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"CREATE",entity:"project",entityId:p,data:m,timestamp:Date.now(),synced:!1}),console.log(" Projet cr avec succs:",m),t("/projects")}catch(p){console.error(" Erreur cration projet:",p),i(p.message||"Erreur lors de la cration du projet")}finally{s(!1)}}};return l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),l.jsx("span",{children:e("common.back")})]}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.new")}),l.jsx("p",{className:"text-gray-600 mt-2",children:e("project.createDescription")})]}),l.jsxs("form",{onSubmit:f,className:"card space-y-6",children:[a&&l.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:a}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:o.typeMarche==="normal",onChange:u=>c({...o,typeMarche:u.target.value}),className:"w-4 h-4 text-primary-600"}),l.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:o.typeMarche==="negocie",onChange:u=>c({...o,typeMarche:u.target.value}),className:"w-4 h-4 text-primary-600"}),l.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:o.objet,onChange:u=>c({...o,objet:u.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:o.marcheNo,onChange:u=>c({...o,marcheNo:u.target.value}),placeholder:"Ex: 123/2025"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:o.annee,onChange:u=>c({...o,annee:u.target.value}),placeholder:"2025"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture *"}),l.jsx("input",{type:"date",required:!0,className:"input",value:o.dateOuverture,onChange:u=>c({...o,dateOuverture:u.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),l.jsxs("select",{className:"input",value:o.commune,onChange:u=>c({...o,commune:u.target.value}),children:[l.jsx("option",{value:"",children:"-- Slectionner une commune --"}),l.jsxs("optgroup",{label:"Municipalits",children:[l.jsx("option",{value:"Akka",children:"Akka"}),l.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),l.jsx("option",{value:"Tata",children:"Tata"}),l.jsx("option",{value:"Tissint",children:"Tissint"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[l.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),l.jsx("option",{value:"Allougoum",children:"Allougoum"}),l.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),l.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[l.jsx("option",{value:"Icht",children:"Icht"}),l.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[l.jsx("option",{value:"Addis",children:"Addis"}),l.jsx("option",{value:"Aguinane",children:"Aguinane"}),l.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),l.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),l.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),l.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),l.jsx("option",{value:"Tagmout",children:"Tagmout"}),l.jsx("option",{value:"Tlite",children:"Tlite"}),l.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),l.jsx(o8,{userId:(r==null?void 0:r.id)||"",value:o.societe,onChange:u=>c({...o,societe:u}),onSelect:u=>{c(p=>({...p,societe:u.nom,rc:u.rc||p.rc,cb:u.cb||p.cb,cnss:u.cnss||p.cnss,patente:u.patente||p.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),l.jsx("input",{type:"text",className:"input",value:o.rc,onChange:u=>c({...o,rc:u.target.value}),placeholder:"Ex: 217/2021"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),l.jsx("input",{type:"text",className:"input",value:o.cb,onChange:u=>c({...o,cb:u.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),l.jsx("input",{type:"text",className:"input",value:o.cnss,onChange:u=>c({...o,cnss:u.target.value}),placeholder:"Ex: 4444634"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),l.jsx("input",{type:"text",className:"input",value:o.patente,onChange:u=>c({...o,patente:u.target.value}),placeholder:"Ex: 47730296"})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),l.jsx("input",{type:"text",className:"input",value:o.programme,onChange:u=>c({...o,programme:u.target.value}),placeholder:"Ex: 31000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),l.jsx("input",{type:"text",className:"input",value:o.projet,onChange:u=>c({...o,projet:u.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),l.jsx("input",{type:"text",className:"input",value:o.ligne,onChange:u=>c({...o,ligne:u.target.value}),placeholder:"Ex: 24"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),l.jsx("input",{type:"text",className:"input",value:o.chapitre,onChange:u=>c({...o,chapitre:u.target.value}),placeholder:"Ex: 320010/03012"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),l.jsx("input",{type:"number",className:"input",value:o.delaisExecution,onChange:u=>c({...o,delaisExecution:u.target.value}),placeholder:"Ex: 10",min:"1"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),l.jsxs("select",{required:!0,className:"input",value:o.status,onChange:u=>c({...o,status:u.target.value}),children:[l.jsx("option",{value:"draft",children:"Brouillon"}),l.jsx("option",{value:"active",children:"Actif"}),l.jsx("option",{value:"completed",children:"Termin"}),l.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux)"}),l.jsx("input",{type:"date",className:"input",value:o.osc,onChange:u=>c({...o,osc:u.target.value})}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date achvement travaux"}),l.jsx("input",{type:"date",className:"input",value:o.achevementTravaux,onChange:u=>c({...o,achevementTravaux:u.target.value})}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date prvue de fin des travaux"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rception provisoire"}),l.jsx("input",{type:"date",className:"input",value:o.dateReceptionProvisoire,onChange:u=>c({...o,dateReceptionProvisoire:u.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rception dfinitive"}),l.jsx("input",{type:"date",className:"input",value:o.dateReceptionDefinitive,onChange:u=>c({...o,dateReceptionDefinitive:u.target.value})})]})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:n,children:"Annuler"}),l.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:n,children:n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Enregistrement..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"w-5 h-5"}),l.jsx("span",{children:"Enregistrer"})]})})]})]})]})},wX=()=>{const{t:e}=Mi(),t=Gn(),{id:r}=Pc(),{user:n}=Yr(),[s,a]=me.useState(!1),[i,o]=me.useState(null),c=$t(async()=>{if(!r)return console.log(" EditProjectPage: No ID provided"),null;console.log(" EditProjectPage: Looking for project with ID:",r);let d=await Se.projects.get(r);if(console.log("  Try 1 (no prefix):",d?" Found":" Not found"),d||(d=await Se.projects.get(`project:${r}`),console.log("  Try 2 (with prefix):",d?" Found":" Not found")),d)console.log(" EditProjectPage: Project loaded:",d.objet);else{console.error(" EditProjectPage: Project not found in database");const h=await Se.projects.toArray();console.log(" All projects in DB:",h.map(m=>({id:m.id,objet:m.objet})))}return d},[r]),[f,u]=me.useState({objet:"",marcheNo:"",annee:"",dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""});me.useEffect(()=>{var d;c&&u({objet:c.objet||"",marcheNo:c.marcheNo||"",annee:c.annee||"",dateOuverture:c.dateOuverture||"",typeMarche:c.typeMarche||"normal",commune:c.commune||"",societe:c.societe||"",rc:c.rc||"",cb:c.cb||"",cnss:c.cnss||"",patente:c.patente||"",programme:c.programme||"",projet:c.projet||"",ligne:c.ligne||"",chapitre:c.chapitre||"",delaisExecution:((d=c.delaisExecution)==null?void 0:d.toString())||"",status:c.status||"draft",osc:c.osc||"",dateReceptionProvisoire:c.dateReceptionProvisoire||"",dateReceptionDefinitive:c.dateReceptionDefinitive||""})},[c]);const p=async d=>{if(d.preventDefault(),!(!n||!c)){a(!0),o(null);try{const h=new Date().toISOString(),m={...c,objet:f.objet,marcheNo:f.marcheNo,annee:f.annee,dateOuverture:f.dateOuverture,typeMarche:f.typeMarche,commune:f.commune||void 0,societe:f.societe,rc:f.rc,cb:f.cb,cnss:f.cnss,patente:f.patente,programme:f.programme,projet:f.projet,ligne:f.ligne,chapitre:f.chapitre,delaisExecution:f.delaisExecution?parseInt(f.delaisExecution):void 0,status:f.status,osc:f.osc||void 0,dateReceptionProvisoire:f.dateReceptionProvisoire||void 0,dateReceptionDefinitive:f.dateReceptionDefinitive||void 0,folderPath:`${f.annee}/${f.marcheNo}`,updatedAt:h};await Se.projects.update(c.id,m);const g=i8(f);if(g)try{await a8(n.id,g),console.log(" Entreprise sauvegarde pour autocompltion:",g.nom)}catch(y){console.warn(" Impossible de sauvegarder l'entreprise:",y)}await Se.syncOperations.add({id:`sync:${Ir()}`,userId:n.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"UPDATE",entity:"project",entityId:c.id,data:m,timestamp:Date.now(),synced:!1}),console.log(" Projet modifi avec succs:",m),t(`/projects/${r}`)}catch(h){console.error(" Erreur modification projet:",h),o(h.message||"Erreur lors de la modification du projet")}finally{a(!1)}}};return c?l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),l.jsx("span",{children:e("common.back")})]}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Modifier le projet"}),l.jsxs("p",{className:"text-gray-600 mt-2",children:['Modifiez les informations du projet "',c.objet,'"']})]}),l.jsxs("form",{onSubmit:p,className:"card space-y-6",children:[i&&l.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:i}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),l.jsxs("div",{className:"flex gap-4",children:[l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:f.typeMarche==="normal",onChange:d=>u({...f,typeMarche:d.target.value}),className:"w-4 h-4 text-primary-600"}),l.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),l.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[l.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:f.typeMarche==="negocie",onChange:d=>u({...f,typeMarche:d.target.value}),className:"w-4 h-4 text-primary-600"}),l.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:f.objet,onChange:d=>u({...f,objet:d.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:f.marcheNo,onChange:d=>u({...f,marcheNo:d.target.value}),placeholder:"Ex: 123/2025"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),l.jsx("input",{type:"text",required:!0,className:"input",value:f.annee,onChange:d=>u({...f,annee:d.target.value}),placeholder:"2025"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture *"}),l.jsx("input",{type:"date",required:!0,className:"input",value:f.dateOuverture,onChange:d=>u({...f,dateOuverture:d.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),l.jsxs("select",{className:"input",value:f.commune,onChange:d=>u({...f,commune:d.target.value}),children:[l.jsx("option",{value:"",children:"-- Slectionner une commune --"}),l.jsxs("optgroup",{label:"Municipalits",children:[l.jsx("option",{value:"Akka",children:"Akka"}),l.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),l.jsx("option",{value:"Tata",children:"Tata"}),l.jsx("option",{value:"Tissint",children:"Tissint"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[l.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),l.jsx("option",{value:"Allougoum",children:"Allougoum"}),l.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),l.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[l.jsx("option",{value:"Icht",children:"Icht"}),l.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),l.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[l.jsx("option",{value:"Addis",children:"Addis"}),l.jsx("option",{value:"Aguinane",children:"Aguinane"}),l.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),l.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),l.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),l.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),l.jsx("option",{value:"Tagmout",children:"Tagmout"}),l.jsx("option",{value:"Tlite",children:"Tlite"}),l.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),l.jsx(o8,{userId:(n==null?void 0:n.id)||"",value:f.societe,onChange:d=>u({...f,societe:d}),onSelect:d=>{u(h=>({...h,societe:d.nom,rc:d.rc||h.rc,cb:d.cb||h.cb,cnss:d.cnss||h.cnss,patente:d.patente||h.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),l.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),l.jsx("input",{type:"text",className:"input",value:f.rc,onChange:d=>u({...f,rc:d.target.value}),placeholder:"Ex: 217/2021"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),l.jsx("input",{type:"text",className:"input",value:f.cb,onChange:d=>u({...f,cb:d.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),l.jsx("input",{type:"text",className:"input",value:f.cnss,onChange:d=>u({...f,cnss:d.target.value}),placeholder:"Ex: 4444634"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),l.jsx("input",{type:"text",className:"input",value:f.patente,onChange:d=>u({...f,patente:d.target.value}),placeholder:"Ex: 47730296"})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),l.jsx("input",{type:"text",className:"input",value:f.programme,onChange:d=>u({...f,programme:d.target.value}),placeholder:"Ex: 31000"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),l.jsx("input",{type:"text",className:"input",value:f.projet,onChange:d=>u({...f,projet:d.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),l.jsx("input",{type:"text",className:"input",value:f.ligne,onChange:d=>u({...f,ligne:d.target.value}),placeholder:"Ex: 24"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),l.jsx("input",{type:"text",className:"input",value:f.chapitre,onChange:d=>u({...f,chapitre:d.target.value}),placeholder:"Ex: 320010/03012"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),l.jsx("input",{type:"number",className:"input",value:f.delaisExecution,onChange:d=>u({...f,delaisExecution:d.target.value}),placeholder:"Ex: 10",min:"1"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),l.jsxs("select",{required:!0,className:"input",value:f.status,onChange:d=>u({...f,status:d.target.value}),children:[l.jsx("option",{value:"draft",children:"Brouillon"}),l.jsx("option",{value:"active",children:"Actif"}),l.jsx("option",{value:"completed",children:"Termin"}),l.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),l.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Entrez la date O.S.C et le dlai d'excution. Le systme calculera automatiquement les dates."}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux) *"}),l.jsx("input",{type:"date",className:"input",value:f.osc,onChange:d=>u({...f,osc:d.target.value})}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]}),l.jsx("div",{className:"md:col-span-2 border-t pt-4 mt-2",children:l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Rceptions (optionnel)"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rception provisoire"}),l.jsx("input",{type:"date",className:"input",value:f.dateReceptionProvisoire,onChange:d=>u({...f,dateReceptionProvisoire:d.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rception dfinitive"}),l.jsx("input",{type:"date",className:"input",value:f.dateReceptionDefinitive,onChange:d=>u({...f,dateReceptionDefinitive:d.target.value})})]})]})]}),l.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[l.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:s,children:"Annuler"}),l.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:s,children:s?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Enregistrement..."})]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"w-5 h-5"}),l.jsx("span",{children:"Enregistrer les modifications"})]})})]})]})]}):l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})})},bX=e=>!e||e.length===0?0:e.reduce((t,r)=>{if(r.dateArret&&r.dateReprise){const n=no(r.dateArret),s=no(r.dateReprise);if(Sg(n)&&Sg(s))return t+_i(s,n)}return t},0),C1=e=>{const t=new Date,r=e.osc?no(e.osc):null;if(!r||!Sg(r))return{status:"no-data",message:"Date OSC non dfinie"};const n=e.delaisExecution||0;if(n===0)return{status:"no-data",message:"Dlai non dfini"};const s=n*30,a=bX(e.arrets),i=L0(r,n),o=uB(i,a),c=_i(t,r),f=_i(o,t),u=s+a,p=Math.min(100,Math.max(0,c/u*100));let d;return e.dateReceptionDefinitive||e.dateReceptionProvisoire?d="completed":f<0?d="overdue":f<=15?d="critical":f<=30?d="warning":d="normal",{status:d,oscDate:r,delaiMois:n,delaiJours:s,joursArret:a,dateFinInitiale:i,dateFinEffective:o,joursEcoules:c,joursRestants:f,pourcentage:p,delaiTotal:u}},l8={normal:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",progress:"bg-green-500"},warning:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",progress:"bg-yellow-500"},critical:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",progress:"bg-red-500"},completed:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",progress:"bg-gray-500"},overdue:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-200",progress:"bg-purple-500"},"no-data":{bg:"bg-gray-50",text:"text-gray-400",border:"border-gray-100",progress:"bg-gray-300"}},NX={normal:"En cours",warning:"Alerte",critical:"Critique",completed:"Termin",overdue:"Dpass","no-data":"Non configur"},SX={normal:xo,warning:$h,critical:oT,completed:Fa,overdue:$h,"no-data":xo},_X=()=>{const{user:e}=Yr(),[t,r]=me.useState(null),[n,s]=me.useState("all"),a=$t(()=>Se.projects.filter(u=>!u.deletedAt).toArray(),[]),i=(a==null?void 0:a.reduce((u,p)=>{const d=C1(p);return u[d.status]=(u[d.status]||0)+1,u},{}))||{},o=(a==null?void 0:a.filter(u=>n==="all"?!0:C1(u).status===n))||[],c=async(u,p)=>{const d=a==null?void 0:a.find(g=>g.id===u);if(!d||!e)return;const h={id:Ir(),...p},m=[...d.arrets||[],h];await Se.projects.update(u,{arrets:m,updatedAt:new Date().toISOString()}),(t==null?void 0:t.id)===u&&r({...t,arrets:m})},f=async(u,p)=>{const d=a==null?void 0:a.find(m=>m.id===u);if(!d||!e)return;const h=(d.arrets||[]).filter(m=>m.id!==p);await Se.projects.update(u,{arrets:h,updatedAt:new Date().toISOString()}),(t==null?void 0:t.id)===u&&r({...t,arrets:h})};return l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des Dlais"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Suivi des dlais d'excution de tous les projets"})]})}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:l.jsx(xo,{className:"w-6 h-6 text-green-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.normal||0}),l.jsx("p",{className:"text-sm text-gray-500",children:"En cours"})]})]}),l.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-100 flex items-center justify-center",children:l.jsx($h,{className:"w-6 h-6 text-yellow-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.warning||0}),l.jsx("p",{className:"text-sm text-gray-500",children:"Alerte"})]})]}),l.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center",children:l.jsx(oT,{className:"w-6 h-6 text-red-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.critical||0}),l.jsx("p",{className:"text-sm text-gray-500",children:"Critique"})]})]}),l.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:l.jsx($h,{className:"w-6 h-6 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.overdue||0}),l.jsx("p",{className:"text-sm text-gray-500",children:"Dpass"})]})]}),l.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[l.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-100 flex items-center justify-center",children:l.jsx(Fa,{className:"w-6 h-6 text-gray-600"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.completed||0}),l.jsx("p",{className:"text-sm text-gray-500",children:"Termins"})]})]})]}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("select",{className:"input w-48",value:n,onChange:u=>s(u.target.value),children:[l.jsx("option",{value:"all",children:"Tous les projets"}),l.jsx("option",{value:"normal",children:"En cours"}),l.jsx("option",{value:"warning",children:"Alerte"}),l.jsx("option",{value:"critical",children:"Critique"}),l.jsx("option",{value:"overdue",children:"Dpass"}),l.jsx("option",{value:"completed",children:"Termins"}),l.jsx("option",{value:"no-data",children:"Non configur"})]}),l.jsxs("span",{className:"text-gray-500",children:[o.length," projet(s)"]})]}),l.jsxs("div",{className:"space-y-4",children:[o.map(u=>{const p=C1(u),d=l8[p.status],h=SX[p.status];return l.jsxs("div",{className:"card p-5",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u.objet}),l.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${d.bg} ${d.text}`,children:[l.jsx(h,{className:"w-3 h-3"}),NX[p.status]]})]}),l.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",u.marcheNo,"  ",u.societe||"Socit non dfinie"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("button",{onClick:()=>r(u),className:"btn btn-secondary btn-sm flex items-center gap-1",children:[l.jsx(Nw,{className:"w-4 h-4"}),"Dtails"]}),l.jsxs(Ai,{to:`/projects/${u.id.replace("project:","")}`,className:"btn btn-secondary btn-sm flex items-center gap-1",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Projet"]})]})]}),p.status!=="no-data"&&typeof p.pourcentage=="number"&&l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-3",children:[l.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[l.jsx("span",{className:"text-gray-600",children:"Progression"}),l.jsxs("span",{className:"font-medium",children:[Math.round(p.pourcentage),"%"]})]}),l.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full ${d.progress} transition-all duration-300`,style:{width:`${Math.min(100,p.pourcentage)}%`}})})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Dbut (OSC)"}),l.jsx("p",{className:"font-medium",children:p.oscDate?Vr(p.oscDate,"dd/MM/yyyy"):"-"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Dlai"}),l.jsxs("p",{className:"font-medium",children:[p.delaiMois," mois"]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Jours d'arrt"}),l.jsxs("p",{className:"font-medium text-orange-600",children:[p.joursArret," j"]})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Fin prvue"}),l.jsx("p",{className:"font-medium",children:p.dateFinEffective?Vr(p.dateFinEffective,"dd/MM/yyyy"):"-"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-500",children:"Reste"}),l.jsx("p",{className:`font-bold ${(p.joursRestants??0)<0?"text-purple-600":(p.joursRestants??0)<=15?"text-red-600":(p.joursRestants??0)<=30?"text-yellow-600":"text-green-600"}`,children:(p.joursRestants??0)<0?`${Math.abs(p.joursRestants??0)}j de retard`:`${p.joursRestants??0} jours`})]})]})]}),p.status==="no-data"&&l.jsx("p",{className:"text-gray-400 text-sm italic",children:p.message})]},u.id)}),o.length===0&&l.jsxs("div",{className:"card p-12 text-center",children:[l.jsx(xo,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Aucun projet trouv"})]})]}),t&&l.jsx(kX,{project:t,onClose:()=>r(null),onAddArret:c,onDeleteArret:f})]})},kX=({project:e,onClose:t,onAddArret:r,onDeleteArret:n})=>{const[s,a]=me.useState(!1),[i,o]=me.useState({dateArret:"",dateReprise:"",motif:""}),c=C1(e),f=l8[c.status],u=async()=>{!i.dateArret||!i.motif||(await r(e.id,{dateArret:i.dateArret,dateReprise:i.dateReprise||void 0,motif:i.motif}),o({dateArret:"",dateReprise:"",motif:""}),a(!1))};return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[l.jsx("div",{className:"p-6 border-b sticky top-0 bg-white z-10",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dtails du Dlai"}),l.jsx("p",{className:"text-gray-500",children:e.objet})]}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(vo,{className:"w-5 h-5"})})]})}),l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[l.jsx("p",{className:"text-sm text-gray-500",children:"Dlai contractuel"}),l.jsxs("p",{className:"text-xl font-bold",children:[c.delaiMois||0," mois"]})]}),l.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg",children:[l.jsx("p",{className:"text-sm text-orange-600",children:"Jours d'arrt"}),l.jsxs("p",{className:"text-xl font-bold text-orange-700",children:[c.joursArret||0," jours"]})]}),l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[l.jsx("p",{className:"text-sm text-blue-600",children:"Dlai effectif"}),l.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[c.delaiTotal||0," jours"]})]}),l.jsxs("div",{className:`p-4 rounded-lg ${f.bg}`,children:[l.jsx("p",{className:`text-sm ${f.text}`,children:"Jours restants"}),l.jsx("p",{className:`text-xl font-bold ${f.text}`,children:c.joursRestants!==void 0?c.joursRestants<0?`${Math.abs(c.joursRestants)} retard`:c.joursRestants:"-"})]})]}),c.status!=="no-data"&&c.oscDate&&c.dateFinEffective&&l.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Timeline"}),l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:l.jsx("div",{className:`h-full ${f.progress} rounded-full`,style:{width:`${Math.min(100,c.pourcentage||0)}%`}})}),l.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[l.jsxs("span",{children:["OSC: ",Vr(c.oscDate,"dd/MM/yyyy")]}),l.jsxs("span",{children:["Fin: ",Vr(c.dateFinEffective,"dd/MM/yyyy")]})]})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:"Historique des Arrts"}),l.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Ajouter un arrt"]})]}),s&&l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg mb-4 space-y-3",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date d'arrt (OSA) *"}),l.jsx("input",{type:"date",className:"input",value:i.dateArret,onChange:p=>o({...i,dateArret:p.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de reprise (OSR)"}),l.jsx("input",{type:"date",className:"input",value:i.dateReprise,onChange:p=>o({...i,dateReprise:p.target.value})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motif *"}),l.jsx("input",{type:"text",className:"input",placeholder:"Ex: Vague de froid",value:i.motif,onChange:p=>o({...i,motif:p.target.value})})]})]}),l.jsxs("div",{className:"flex justify-end gap-2",children:[l.jsx("button",{onClick:()=>a(!1),className:"btn btn-secondary btn-sm",children:"Annuler"}),l.jsxs("button",{onClick:u,className:"btn btn-primary btn-sm flex items-center gap-1",disabled:!i.dateArret||!i.motif,children:[l.jsx(Fc,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),e.arrets&&e.arrets.length>0?l.jsx("div",{className:"border rounded-lg overflow-hidden",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Arrt (OSA)"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Reprise (OSR)"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Dure"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Motif"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y",children:e.arrets.map((p,d)=>{const h=p.dateArret&&p.dateReprise?_i(no(p.dateReprise),no(p.dateArret)):null;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-sm",children:d+1}),l.jsx("td",{className:"px-4 py-3 text-sm",children:l.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[l.jsx(iS,{className:"w-3 h-3"}),p.dateArret?Vr(no(p.dateArret),"dd/MM/yyyy"):"-"]})}),l.jsx("td",{className:"px-4 py-3 text-sm",children:p.dateReprise?l.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[l.jsx(X9,{className:"w-3 h-3"}),Vr(no(p.dateReprise),"dd/MM/yyyy")]}):l.jsx("span",{className:"text-orange-500 italic",children:"En cours"})}),l.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:h!==null?`${h} jours`:"-"}),l.jsx("td",{className:"px-4 py-3 text-sm",children:p.motif}),l.jsx("td",{className:"px-4 py-3 text-center",children:l.jsx("button",{onClick:()=>n(e.id,p.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",title:"Supprimer",children:l.jsx(vo,{className:"w-4 h-4"})})})]},p.id)})})]})}):l.jsxs("div",{className:"text-center py-8 text-gray-400",children:[l.jsx(iS,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),l.jsx("p",{children:"Aucun arrt enregistr"})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Dates importantes"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"p-4 border rounded-lg",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Ordre de Service (OSC)"}),l.jsx("p",{className:"font-medium",children:e.osc?Vr(no(e.osc),"dd/MM/yyyy"):"Non dfini"})]}),l.jsxs("div",{className:"p-4 border rounded-lg",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Provisoire"}),l.jsx("p",{className:"font-medium",children:e.dateReceptionProvisoire?Vr(no(e.dateReceptionProvisoire),"dd/MM/yyyy"):"Non dfini"})]}),l.jsxs("div",{className:"p-4 border rounded-lg",children:[l.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Dfinitive"}),l.jsx("p",{className:"font-medium",children:e.dateReceptionDefinitive?Vr(no(e.dateReceptionDefinitive),"dd/MM/yyyy"):"Non dfini"})]})]})]})]}),l.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:l.jsx("button",{onClick:t,className:"btn btn-secondary",children:"Fermer"})})]})})},EX=()=>{const{projectId:e}=Pc(),t=Gn(),{user:r}=Yr(),[n,s]=me.useState(null),a=e!=null&&e.includes(":")?e:`project:${e}`,i=$t(()=>Se.projects.get(a),[a]),o=$t(()=>Se.bordereaux.where("projectId").equals(a).and(p=>!p.deletedAt).first(),[a]),c=async p=>{if(!r||!a)return;const d=`bordereau:${Ir()}`,h=new Date().toISOString(),m={id:d,projectId:a,userId:r.id,reference:p.reference,designation:p.designation,lignes:[],montantTotal:0,createdAt:h,updatedAt:h};await Se.bordereaux.add(m),await mn("CREATE","bordereau",d.replace("bordereau:",""),m,r.id),s(null)},[f,u]=me.useState(!1);return me.useEffect(()=>{const p=setTimeout(()=>{i||u(!0)},5e3);return()=>clearTimeout(p)},[i]),i?l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>t(`/projects/${a}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour au projet"]}),l.jsx("div",{className:"flex items-start justify-between",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bordereau des Prix"}),l.jsx("p",{className:"text-gray-600",children:i.objet}),l.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",i.marcheNo," - ",i.annee]})]})})]}),o?l.jsx(xT,{bordereauId:o.id,onClose:()=>t(`/projects/${a}`)}):l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"text-center py-8 mb-6",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),l.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[l.jsx("button",{onClick:()=>s("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(Vs,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),l.jsx("button",{onClick:()=>s("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(iT,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),l.jsx("button",{onClick:()=>s("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(wg,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),l.jsx("button",{onClick:()=>s("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:l.jsxs("div",{className:"text-center py-6",children:[l.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:l.jsx(Nb,{className:"w-6 h-6"})}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]}),n==="blank"&&l.jsx(vT,{onClose:()=>s(null),onCreate:c}),n==="template"&&l.jsx(yT,{projectId:a,onClose:()=>s(null),onCreated:()=>s(null)}),n==="copy"&&l.jsx(wT,{currentProjectId:a,onClose:()=>s(null),onCopied:()=>s(null)}),n==="import"&&l.jsx(t8,{projectId:a,onClose:()=>s(null),onImported:()=>s(null)})]}):f?l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Qa,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),l.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Synchronisez les donnes ou vrifiez l'URL"}),l.jsx("button",{onClick:()=>t("/projects"),className:"btn btn-primary",children:"Retour aux projets"})]})}):l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})})},c8={"M":{unite:"M",type:"volume",label:"Volume",formule:"Longueur  Largeur  Profondeur",champs:["longueur","largeur","profondeur"],description:"Calcul de volume (terrassement, bton, etc.)"},"M":{unite:"M",type:"surface",label:"Surface",formule:"Longueur  Largeur",champs:["longueur","largeur"],description:"Calcul de surface (carrelage, enduit, etc.)"},ML:{unite:"ML",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},M:{unite:"M",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},KG:{unite:"KG",type:"poids",label:"Poids (KG)",formule:"Nombre  Longueur  Poids unitaire",champs:["nombre","longueur","diametre"],description:"Poids en kilogrammes (ferraillage)"},T:{unite:"T",type:"poids",label:"Poids (T)",formule:"Nombre  Longueur  Poids unitaire  1000",champs:["nombre","longueur","diametre"],description:"Poids en tonnes (ferraillage)"},U:{unite:"U",type:"unite",label:"Unit",formule:"Nombre",champs:["nombre"],description:"Nombre d'units"},ENS:{unite:"ENS",type:"unite",label:"Ensemble",formule:"Nombre",champs:["nombre"],description:"Nombre d'ensembles"}};function Xb(e){return c8[e]}const jX={6:.222,8:.395,10:.617,12:.888,14:1.208,16:1.578,20:2.466,25:3.854,32:6.313,40:9.864},AX=[6,8,10,12,14,16,20,25,32,40];function TX(e){return jX[e]||0}function ep(e,t,r,n,s,a){switch(c8[e].type){case"volume":return(t||0)*(r||0)*(n||0);case"surface":return(t||0)*(r||0);case"lineaire":return t||0;case"poids":{const o=TX(a||0),c=(s||0)*(t||0)*o;return e==="T"?c/1e3:c}case"unite":return s||0;default:return 0}}function xi(e,t=2){return e.toFixed(t)}function cv(e,t){return t===0?0:e/t*100}const CX=({unite:e,initialData:t,onSave:r,onCancel:n})=>{const s=Xb(e),[a,i]=me.useState({designation:(t==null?void 0:t.designation)||"",longueur:(t==null?void 0:t.longueur)||0,largeur:(t==null?void 0:t.largeur)||0,profondeur:(t==null?void 0:t.profondeur)||0,nombre:(t==null?void 0:t.nombre)||1,diametre:(t==null?void 0:t.diametre)||void 0,observations:(t==null?void 0:t.observations)||""}),[o,c]=me.useState(0);me.useEffect(()=>{const d=ep(e,a.longueur,a.largeur,a.profondeur,a.nombre,a.diametre);c(d)},[a,e]);const f=d=>{if(d.preventDefault(),!a.designation.trim()){alert("La dsignation est obligatoire");return}const h=ep(e,a.longueur,a.largeur,a.profondeur,a.nombre,a.diametre);r({...a,partiel:h})};if(!s)return null;const{champs:u,label:p}=s;return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t?"Modifier la ligne":"Ajouter une ligne"}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Type de calcul: ",p," (",e,")"]})]}),l.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(vo,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Dsignation ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:a.designation,onChange:d=>i({...a,designation:d.target.value}),className:"input w-full",placeholder:"Ex: Fouille en pleine masse...",required:!0,autoFocus:!0})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.includes("nombre")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre"}),l.jsx("input",{type:"number",value:a.nombre,onChange:d=>i({...a,nombre:parseFloat(d.target.value)||0}),className:"input w-full",min:"0",step:"1"})]}),u.includes("longueur")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Longueur (m)"}),l.jsx("input",{type:"number",value:a.longueur,onChange:d=>i({...a,longueur:parseFloat(d.target.value)||0}),className:"input w-full",min:"0",step:"0.01"})]}),u.includes("largeur")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Largeur (m)"}),l.jsx("input",{type:"number",value:a.largeur,onChange:d=>i({...a,largeur:parseFloat(d.target.value)||0}),className:"input w-full",min:"0",step:"0.01"})]}),u.includes("profondeur")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Profondeur (m)"}),l.jsx("input",{type:"number",value:a.profondeur,onChange:d=>i({...a,profondeur:parseFloat(d.target.value)||0}),className:"input w-full",min:"0",step:"0.01"})]}),u.includes("diametre")&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Diamtre (mm)"}),l.jsxs("select",{value:a.diametre||"",onChange:d=>i({...a,diametre:d.target.value?parseInt(d.target.value):void 0}),className:"input w-full",children:[l.jsx("option",{value:"",children:"Slectionner..."}),AX.map(d=>l.jsxs("option",{value:d,children:["",d]},d))]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observations"}),l.jsx("textarea",{value:a.observations,onChange:d=>i({...a,observations:d.target.value}),className:"input w-full",rows:3,placeholder:"Observations ou remarques..."})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-blue-900 mb-1",children:"Prvisualisation du calcul"}),l.jsxs("p",{className:"text-xs text-blue-600",children:[u.includes("nombre")&&a.nombre>0&&`${a.nombre}  `,u.includes("longueur")&&a.longueur>0&&`${a.longueur} m`,u.includes("largeur")&&a.largeur>0&&`  ${a.largeur} m`,u.includes("profondeur")&&a.profondeur>0&&`  ${a.profondeur} m`,u.includes("diametre")&&a.diametre&&`  ${a.diametre}`]})]}),l.jsxs("div",{className:"text-right",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-700",children:xi(o)}),l.jsx("p",{className:"text-xs text-blue-600",children:e})]})]})}),l.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary",children:"Annuler"}),l.jsx("button",{type:"submit",className:"btn btn-primary",children:t?"Enregistrer":"Ajouter"})]})]})]})})},PX=({metreId:e,onClose:t})=>{const{user:r}=Yr(),[n,s]=me.useState(null),[a,i]=me.useState(!1),o=$t(()=>Se.metres.get(e),[e]),c=o?Xb(o.unite):null,f=async h=>{if(!o||!r)return;const m=`ligne:${Ir()}`,g=o.lignes.length+1,y=ep(o.unite,h.longueur,h.largeur,h.profondeur,h.nombre,h.diametre),v={...h,id:m,numero:g,partiel:y},b=[...o.lignes,v],w=b.reduce((T,O)=>T+O.partiel,0),A=(await Se.metres.where("bordereauLigneId").equals(o.bordereauLigneId).and(T=>!T.deletedAt).toArray()).filter(T=>T.id!==e).reduce((T,O)=>T+O.totalCumule,0)+w,F=cv(A,o.quantiteBordereau);await Se.metres.update(e,{lignes:b,totalPartiel:w,totalCumule:A,pourcentageRealisation:F,updatedAt:new Date().toISOString()}),await mn("UPDATE","metre",e.replace("metre:",""),{lignes:b},r.id),i(!1)},u=async(h,m)=>{if(!o||!r)return;const g=o.lignes.map(S=>{if(S.id!==h)return S;const A={...S,...m},F=ep(o.unite,A.longueur,A.largeur,A.profondeur,A.nombre,A.diametre);return{...A,partiel:F}}),y=g.reduce((S,A)=>S+A.partiel,0),b=(await Se.metres.where("bordereauLigneId").equals(o.bordereauLigneId).and(S=>!S.deletedAt).toArray()).filter(S=>S.id!==e).reduce((S,A)=>S+A.totalCumule,0)+y,w=cv(b,o.quantiteBordereau);await Se.metres.update(e,{lignes:g,totalPartiel:y,totalCumule:b,pourcentageRealisation:w,updatedAt:new Date().toISOString()}),await mn("UPDATE","metre",e.replace("metre:",""),{lignes:g},r.id),s(null)},p=async h=>{if(!o||!r||!confirm("Supprimer cette ligne ?"))return;const m=o.lignes.filter(w=>w.id!==h),g=m.reduce((w,S)=>w+S.partiel,0),v=(await Se.metres.where("bordereauLigneId").equals(o.bordereauLigneId).and(w=>!w.deletedAt).toArray()).filter(w=>w.id!==e).reduce((w,S)=>w+S.totalCumule,0)+g,b=cv(v,o.quantiteBordereau);await Se.metres.update(e,{lignes:m,totalPartiel:g,totalCumule:v,pourcentageRealisation:b,updatedAt:new Date().toISOString()}),await mn("UPDATE","metre",e.replace("metre:",""),{lignes:m},r.id)};if(!o||!c)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})});const{champs:d}=c;return l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[l.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour  la liste"]}),l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:o.reference}),l.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-700 rounded text-sm font-medium",children:o.unite})]}),l.jsx("p",{className:"text-gray-700 mb-1",children:o.designationBordereau}),l.jsxs("p",{className:"text-sm text-gray-500",children:["Quantit bordereau: ",xi(o.quantiteBordereau)," ",o.unite]})]}),l.jsx("div",{className:"flex gap-2",children:l.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[l.jsx(qu,{className:"w-4 h-4"}),"Exporter"]})})]}),l.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs text-blue-600 mb-1",children:"Total Partiel"}),l.jsx("p",{className:"text-xl font-bold text-blue-700",children:xi(o.totalPartiel)})]}),l.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs text-purple-600 mb-1",children:"Total Cumul"}),l.jsx("p",{className:"text-xl font-bold text-purple-700",children:xi(o.totalCumule)})]}),l.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs text-green-600 mb-1",children:"% Ralisation"}),l.jsxs("p",{className:"text-xl font-bold text-green-700",children:[xi(o.pourcentageRealisation),"%"]})]}),l.jsxs("div",{className:"bg-orange-50 p-3 rounded-lg",children:[l.jsx("p",{className:"text-xs text-orange-600 mb-1",children:"Reste  faire"}),l.jsx("p",{className:"text-xl font-bold text-orange-700",children:xi(Math.max(0,o.quantiteBordereau-o.totalCumule))})]})]})]}),l.jsx("div",{className:"overflow-x-auto mb-4",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-gray-700 w-12",children:"N"}),l.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-gray-700 min-w-[200px]",children:"Dsignation"}),d.includes("longueur")&&l.jsx("th",{className:"px-3 py-3 text-right text-sm font-semibold text-gray-700 w-24",children:"Longueur (m)"}),d.includes("largeur")&&l.jsx("th",{className:"px-3 py-3 text-right text-sm font-semibold text-gray-700 w-24",children:"Largeur (m)"}),d.includes("profondeur")&&l.jsx("th",{className:"px-3 py-3 text-right text-sm font-semibold text-gray-700 w-24",children:"Profondeur (m)"}),d.includes("nombre")&&l.jsx("th",{className:"px-3 py-3 text-right text-sm font-semibold text-gray-700 w-24",children:"Nombre"}),d.includes("diametre")&&l.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-gray-700 w-24",children:" (mm)"}),l.jsx("th",{className:"px-3 py-3 text-right text-sm font-semibold text-gray-700 w-32 bg-blue-50",children:"Partiel"}),l.jsx("th",{className:"px-3 py-3 text-left text-sm font-semibold text-gray-700 min-w-[150px]",children:"Observations"}),l.jsx("th",{className:"px-3 py-3 text-center text-sm font-semibold text-gray-700 w-24",children:"Actions"})]})}),l.jsxs("tbody",{className:"divide-y divide-gray-200",children:[o.lignes.map(h=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-gray-700",children:h.numero}),l.jsx("td",{className:"px-3 py-2 text-gray-900",children:h.designation}),d.includes("longueur")&&l.jsx("td",{className:"px-3 py-2 text-right font-mono",children:xi(h.longueur||0)}),d.includes("largeur")&&l.jsx("td",{className:"px-3 py-2 text-right font-mono",children:xi(h.largeur||0)}),d.includes("profondeur")&&l.jsx("td",{className:"px-3 py-2 text-right font-mono",children:xi(h.profondeur||0)}),d.includes("nombre")&&l.jsx("td",{className:"px-3 py-2 text-right font-mono",children:h.nombre||0}),d.includes("diametre")&&l.jsx("td",{className:"px-3 py-2 text-center",children:h.diametre?`${h.diametre}`:"-"}),l.jsx("td",{className:"px-3 py-2 text-right font-bold text-blue-600 bg-blue-50",children:xi(h.partiel)}),l.jsx("td",{className:"px-3 py-2 text-gray-600 text-sm",children:h.observations||"-"}),l.jsx("td",{className:"px-3 py-2",children:l.jsxs("div",{className:"flex items-center justify-center gap-1",children:[l.jsx("button",{onClick:()=>s(h.id),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Modifier",children:l.jsx(Fc,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>p(h.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})]})})]},h.id)),o.lignes.length===0&&l.jsx("tr",{children:l.jsxs("td",{colSpan:100,className:"px-3 py-12 text-center text-gray-500",children:[l.jsx(aa,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),l.jsx("p",{children:"Aucune ligne de mtr"}),l.jsx("p",{className:"text-sm",children:'Cliquez sur "Ajouter une ligne" pour commencer'})]})})]}),o.lignes.length>0&&l.jsx("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:l.jsxs("tr",{children:[l.jsx("td",{colSpan:d.filter(h=>h!=="observations").length+2,className:"px-3 py-3 text-right font-bold text-gray-900",children:"TOTAL PARTIEL:"}),l.jsx("td",{className:"px-3 py-3 text-right font-bold text-xl text-blue-700 bg-blue-100",children:xi(o.totalPartiel)}),l.jsx("td",{colSpan:2})]})})]})}),l.jsx("div",{className:"flex justify-center",children:l.jsxs("button",{onClick:()=>i(!0),className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Ajouter une ligne"]})}),(a||n)&&l.jsx(CX,{unite:o.unite,initialData:n?o.lignes.find(h=>h.id===n):void 0,onSave:h=>{n?u(n,h):f(h)},onCancel:()=>{i(!1),s(null)}})]})},FX=({bordereau:e,onClose:t,onCreate:r})=>{const[n,s]=me.useState(""),a=e.lignes.filter(i=>i.designation.toLowerCase().includes(n.toLowerCase())||i.numero.toString().includes(n));return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] flex flex-col",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-primary-100 text-primary-600 rounded-lg",children:l.jsx(Sr,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouveau mtr"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Slectionnez une ligne du bordereau"})]})]}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(vo,{className:"w-6 h-6"})})]}),l.jsx("div",{className:"p-4 border-b border-gray-200",children:l.jsxs("div",{className:"relative",children:[l.jsx(Nx,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),l.jsx("input",{type:"text",value:n,onChange:i=>s(i.target.value),placeholder:"Rechercher par N ou dsignation...",className:"input pl-10 w-full",autoFocus:!0})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l.jsxs("div",{className:"space-y-2",children:[a.map(i=>{const o=e.lignes.findIndex(c=>c.id===i.id);return l.jsx("button",{onClick:()=>r(o),className:"w-full text-left p-4 border border-gray-200 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-all group",children:l.jsxs("div",{className:"flex items-start justify-between gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[l.jsxs("span",{className:"flex-shrink-0 px-3 py-1 bg-gray-100 text-gray-700 rounded font-medium text-sm",children:["N ",i.numero]}),l.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium",children:i.unite})]}),l.jsx("p",{className:"text-gray-900 font-medium mb-1 group-hover:text-primary-700",children:i.designation}),i.prixUnitaire&&l.jsxs("p",{className:"text-sm text-gray-500",children:["Prix unitaire: ",i.prixUnitaire.toLocaleString()," MAD"]})]}),l.jsxs("div",{className:"flex-shrink-0 text-right",children:[l.jsx("p",{className:"text-lg font-bold text-gray-900",children:i.quantite.toLocaleString()}),l.jsx("p",{className:"text-xs text-gray-500",children:i.unite})]})]})},i.id)}),a.length===0&&l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Aucune ligne trouve"})]})]})}),l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[l.jsxs("span",{children:[a.length," ligne",a.length!==1?"s":""," sur ",e.lignes.length]}),l.jsx("button",{onClick:t,className:"btn btn-secondary",children:"Annuler"})]})})]})})},LX=()=>{const{projectId:e}=Pc(),t=Gn(),{user:r}=Yr(),[n,s]=me.useState(null),[a,i]=me.useState(null),o=e!=null&&e.includes(":")?e:`project:${e}`,c=$t(()=>Se.projects.get(o),[o]),f=$t(()=>Se.bordereaux.where("projectId").equals(o).and(h=>!h.deletedAt).first(),[o]),u=$t(()=>Se.metres.where("projectId").equals(o).and(h=>!h.deletedAt).toArray(),[o]),p=async h=>{if(!r||!o||!f)return;const m=f.lignes[h];if(!m)return;const g=`metre:${Ir()}`,y=new Date().toISOString(),v={id:g,projectId:o,periodeId:"",bordereauLigneId:`${f.id}-ligne-${m.numero}`,userId:r.id,reference:`METRE N ${String(((u==null?void 0:u.length)||0)+1).padStart(2,"0")}`,designationBordereau:m.designation,unite:m.unite,lignes:[],totalPartiel:0,totalCumule:0,quantiteBordereau:m.quantite,pourcentageRealisation:0,createdAt:y,updatedAt:y};await Se.metres.add(v),await mn("CREATE","metre",g.replace("metre:",""),v,r.id),i(g),s(null)};if(!c)return l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})});if(!f)return l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("div",{className:"mb-6",children:l.jsxs("button",{onClick:()=>t(`/projects/${o}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour au projet"]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun bordereau"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),l.jsxs("button",{onClick:()=>t(`/projects/${o}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})]});const d=new Map;return u==null||u.forEach(h=>{var g;const m=parseInt(h.bordereauLigneId.split("-ligne-")[1]);d.has(m)||d.set(m,[]),(g=d.get(m))==null||g.push(h)}),l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>t(`/projects/${o}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour au projet"]}),l.jsx("div",{className:"flex items-start justify-between",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mtr"}),l.jsx("p",{className:"text-gray-600",children:c.objet}),l.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",c.marcheNo," - ",c.annee]})]})})]}),a?l.jsx(PX,{metreId:a,onClose:()=>i(null)}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(Sr,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f.lignes.length}),l.jsx("p",{className:"text-sm text-gray-600",children:"Lignes bordereau"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(u==null?void 0:u.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Mtrs effectus"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(Fa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.size}),l.jsx("p",{className:"text-sm text-gray-600",children:"Lignes mtres"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:l.jsx(Qa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:f.lignes.length-d.size}),l.jsx("p",{className:"text-sm text-gray-600",children:"En attente"})]})]})})]}),l.jsxs("div",{className:"card",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Lignes du bordereau"}),l.jsxs("button",{onClick:()=>s("select"),className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Nouveau mtr"]})]}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50 border-b-2 border-gray-200",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-16",children:"N"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Dsignation"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-20",children:"U"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-32",children:"Qt Bordereau"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-32",children:"Qt Ralise"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-32",children:"Progression"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-40",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:f.lignes.map((h,m)=>{const g=d.get(h.numero)||[],y=g.reduce((w,S)=>w+S.totalCumule,0),v=h.quantite>0?y/h.quantite*100:0,b=g.length>0;return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-gray-700",children:h.numero}),l.jsx("td",{className:"px-4 py-3 text-gray-900",children:h.designation}),l.jsx("td",{className:"px-4 py-3 text-center",children:l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:h.unite})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-900",children:h.quantite.toLocaleString()}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-primary-600",children:y.toFixed(2)}),l.jsx("td",{className:"px-4 py-3",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-300 ${v>=100?"bg-green-500":v>=75?"bg-blue-500":v>=50?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${Math.min(v,100)}%`}})}),l.jsxs("span",{className:"text-xs font-medium text-gray-700 w-12 text-right",children:[v.toFixed(0),"%"]})]})}),l.jsx("td",{className:"px-4 py-3",children:l.jsx("div",{className:"flex items-center justify-center gap-2",children:b?l.jsxs("button",{onClick:()=>i(g[g.length-1].id),className:"btn btn-secondary text-xs flex items-center gap-1",children:[l.jsx(aa,{className:"w-3 h-3"}),"Voir (",g.length,")"]}):l.jsxs("button",{onClick:()=>p(m),className:"btn btn-primary text-xs flex items-center gap-1",children:[l.jsx(Vs,{className:"w-3 h-3"}),"Crer mtr"]})})})]},h.id)})})]})})]})]}),n==="select"&&f&&l.jsx(FX,{bordereau:f,onClose:()=>s(null),onCreate:p})]})},DX=()=>{const{projectId:e}=Pc(),t=Gn(),{user:r}=Yr(),[n,s]=me.useState(!1),a=e!=null&&e.includes(":")?e:`project:${e}`,i=$t(()=>Se.projects.get(a),[a]),o=$t(()=>Se.periodes.where("projectId").equals(a).and(w=>!w.deletedAt).reverse().sortBy("numero"),[a]),c=$t(()=>Se.metres.where("projectId").equals(a).and(w=>!w.deletedAt).toArray(),[a]),f=$t(()=>Se.decompts.where("projectId").equals(a).and(w=>!w.deletedAt).toArray(),[a]),u=$t(()=>Se.bordereaux.where("projectId").equals(a).and(w=>!w.deletedAt).toArray(),[a]),p=async w=>{if(!r||!a)return;const S=`periode:${Ir()}`,A=new Date().toISOString(),F=((o==null?void 0:o.length)||0)+1,T={id:S,projectId:a,userId:r.id,numero:F,libelle:w.libelle||`Dcompte N${F}`,dateDebut:w.dateFin,dateFin:w.dateFin,statut:"en_cours",isDecompteDernier:w.isDecompteDernier||!1,createdAt:A,updatedAt:A};if(await Se.periodes.add(T),await mn("CREATE","periode",S.replace("periode:",""),T,r.id),F>1&&o&&o.length>0){const O=o.find(C=>C.numero===F-1);if(O){const C=await Se.metres.where("periodeId").equals(O.id).and(R=>!R.deletedAt).toArray();for(const R of C){const k=`metre:${Ir()}`,P={...R,id:k,periodeId:S,createdAt:A,updatedAt:A,_rev:void 0,deletedAt:void 0};await Se.metres.add(P),await mn("CREATE","metre",k.replace("metre:",""),P,r.id)}}}s(!1)},d=async w=>{if(!r||!confirm("Supprimer cette priode ? Les mtrs et dcomptes associs seront galement supprims."))return;const S=new Date().toISOString();await Se.periodes.update(w,{deletedAt:S,updatedAt:S});const A=await Se.metres.where("periodeId").equals(w).toArray();for(const T of A)await Se.metres.update(T.id,{deletedAt:S,updatedAt:S});const F=await Se.decompts.where("periodeId").equals(w).toArray();for(const T of F)await Se.decompts.update(T.id,{deletedAt:S,updatedAt:S});await mn("DELETE","periode",w.replace("periode:",""),null,r.id)},m=((u==null?void 0:u.reduce((w,S)=>w+(S.montantTotal||0),0))||0)*1.2,g=f==null?void 0:f.reduce((w,S)=>!w||S.numero>w.numero?S:w,null),y=(g==null?void 0:g.totalTTC)||(g==null?void 0:g.montantTotal)||0,v=m-y,b=w=>{switch(w){case"en_cours":return l.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-700 rounded-full text-sm font-medium",children:[l.jsx(xo,{className:"w-4 h-4"}),"En cours"]});case"validee":return l.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-medium",children:[l.jsx(Fa,{className:"w-4 h-4"}),"Valide"]});case"facturee":return l.jsxs("span",{className:"flex items-center gap-1 px-3 py-1 bg-purple-100 text-purple-700 rounded-full text-sm font-medium",children:[l.jsx(ka,{className:"w-4 h-4"}),"Facture"]});default:return null}};return i?l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>t(`/projects/${a}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour au projet"]}),l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Priodes & Dcomptes"}),l.jsx("p",{className:"text-gray-600",children:i.objet}),l.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",i.marcheNo," - ",i.annee]})]}),l.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Nouvelle priode"]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(Ei,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(o==null?void 0:o.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Priodes"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(c==null?void 0:c.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Mtrs"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(ka,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(f==null?void 0:f.length)||0}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dcomptes"})]})]})}),l.jsx("div",{className:`card ${v<0?"border-2 border-red-400 bg-red-50":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`p-3 rounded-lg ${v<0?"bg-red-100 text-red-600":"bg-orange-100 text-orange-600"}`,children:l.jsx(Sr,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsxs("p",{className:`text-lg font-bold ${v<0?"text-red-600":"text-gray-900"}`,children:[v.toLocaleString("fr-FR",{minimumFractionDigits:2})," MAD"]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Reste  facturer"}),v<0&&l.jsx("p",{className:"text-xs text-red-500 font-medium",children:" Dpassement!"})]})]})})]}),o&&o.length>0?l.jsx("div",{className:"space-y-4",children:o.map(w=>{const S=(c==null?void 0:c.filter(F=>F.periodeId===w.id))||[],A=(f==null?void 0:f.filter(F=>F.periodeId===w.id))||[];return l.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex items-start gap-4",children:[l.jsx("div",{className:"w-16 h-16 bg-primary-100 text-primary-700 rounded-lg flex items-center justify-center font-bold text-2xl",children:w.numero}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-1",children:w.libelle}),l.jsx("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:l.jsxs("span",{className:"flex items-center gap-1",children:[l.jsx(Ei,{className:"w-4 h-4"}),Vr(new Date(w.dateDebut),"dd MMM yyyy",{locale:Ti}),"  ",Vr(new Date(w.dateFin),"dd MMM yyyy",{locale:Ti})]})})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[w.isDecompteDernier&&l.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-xs font-semibold text-orange-700 bg-orange-100 border border-orange-300 rounded-full",children:[l.jsx(Fa,{className:"w-3 h-3"}),"Dernier"]}),b(w.statut)]})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[l.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(aa,{className:"w-4 h-4 text-blue-600"}),l.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"Mtrs"})]}),l.jsx("p",{className:"text-2xl font-bold text-blue-700",children:S.length})]}),l.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(ka,{className:"w-4 h-4 text-green-600"}),l.jsx("p",{className:"text-xs text-green-600 font-medium",children:"Dcomptes"})]}),l.jsx("p",{className:"text-2xl font-bold text-green-700",children:A.length})]}),l.jsxs("div",{className:"bg-purple-50 p-3 rounded-lg",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx(Sr,{className:"w-4 h-4 text-purple-600"}),l.jsx("p",{className:"text-xs text-purple-600 font-medium",children:"Montant"})]}),l.jsxs("p",{className:"text-lg font-bold text-purple-700",children:[A.reduce((F,T)=>F+T.montantTotal,0).toLocaleString()," MAD"]})]})]}),l.jsxs("div",{className:"flex items-center justify-between gap-3 pt-4 border-t border-gray-200",children:[l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>t(`/projects/${a}/periodes/${w.id}/metre`),className:"btn btn-secondary text-sm flex items-center gap-2",children:[l.jsx(aa,{className:"w-4 h-4"}),"Saisir mtrs"]}),l.jsxs("button",{onClick:()=>t(`/projects/${a}/periodes/${w.id}/decompte`),className:"btn btn-secondary text-sm flex items-center gap-2",children:[l.jsx(ka,{className:"w-4 h-4"}),"Dcompte"]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{className:"p-2 text-gray-600 hover:text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Modifier",children:l.jsx(_w,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>d(w.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})]})]})]},w.id)})}):l.jsx("div",{className:"card",children:l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Ei,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune priode"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Crez une premire priode pour commencer  saisir vos mtrs et dcomptes"}),l.jsxs("button",{onClick:()=>s(!0),className:"btn btn-primary inline-flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Crer la premire priode"]})]})}),n&&l.jsx(OX,{onClose:()=>s(!1),onCreate:p,nextNumero:((o==null?void 0:o.length)||0)+1})]}):l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})})},OX=({onClose:e,onCreate:t,nextNumero:r})=>{const[n,s]=me.useState(`Dcompte N${r}`),[a,i]=me.useState(""),[o,c]=me.useState(!1),f=u=>{if(u.preventDefault(),!a){alert("Veuillez renseigner la date");return}t({libelle:n,dateFin:a,isDecompteDernier:o})};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-primary-100 text-primary-600 rounded-lg",children:l.jsx(Ei,{className:"w-6 h-6"})}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouvelle priode"})]}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:l.jsx(Ts,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:f,className:"p-6 space-y-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Libell ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:n,onChange:u=>s(u.target.value),className:"input w-full",placeholder:`Dcompte N${r}`,required:!0,autoFocus:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Date de fin ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"date",value:a,onChange:u=>i(u.target.value),className:"input w-full",required:!0})]}),l.jsxs("div",{className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>c(!o),children:[l.jsx("input",{type:"checkbox",checked:o,onChange:u=>c(u.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),l.jsx("label",{className:"text-sm font-medium text-gray-700 cursor-pointer",children:"Dcompte Dernier (Final)"})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsxs("p",{className:"text-sm text-blue-900 font-medium mb-1",children:["Priode N",r]}),l.jsx("p",{className:"text-xs text-blue-700",children:"Cette priode regroupera les mtrs et le dcompte correspondant"})]}),l.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t border-gray-200",children:[l.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary",children:"Annuler"}),l.jsx("button",{type:"submit",className:"btn btn-primary",children:"Crer la priode"})]})]})]})})},RX=()=>{const{projectId:e,periodeId:t}=Pc(),r=Gn(),{user:n}=Yr(),[s,a]=me.useState([]),[i,o]=me.useState(!1),c=e!=null&&e.includes(":")?e:`project:${e}`,f=t!=null&&t.includes(":")?t:`periode:${t}`,u=$t(()=>Se.projects.get(c),[c]),p=$t(()=>Se.periodes.get(f),[f]),d=$t(()=>Se.bordereaux.where("projectId").equals(c).and(R=>!R.deletedAt).first(),[c]),h=$t(()=>Se.metres.where("periodeId").equals(f).and(R=>!R.deletedAt).toArray(),[f]);me.useEffect(()=>{if(d&&h!==void 0){const R=d.lignes.map(k=>{const P=h.find(q=>q.bordereauLigneId===`${d.id}-ligne-${k.numero}`);return{bordereauLigneId:`${d.id}-ligne-${k.numero}`,numeroLigne:k.numero,designation:k.designation,unite:k.unite,quantiteBordereau:k.quantite,prixUnitaire:k.prixUnitaire||0,lignes:(P==null?void 0:P.lignes)||[],isExpanded:!1}});a(R)}},[d,h]);const m=R=>{a(k=>k.map(P=>P.bordereauLigneId===R?{...P,isExpanded:!P.isExpanded}:P))},g=R=>{const k=s.find(D=>D.bordereauLigneId===R);if(!k)return;const P=k.lignes.length+1,q={id:`${R}-mesure-${Date.now()}`,numero:P,designation:`Mesure ${P}`,partiel:0};a(D=>D.map(V=>V.bordereauLigneId===R?{...V,lignes:[...V.lignes,q]}:V))},y=(R,k)=>{a(P=>P.map(q=>q.bordereauLigneId===R?{...q,lignes:q.lignes.filter(D=>D.id!==k).map((D,V)=>({...D,numero:V+1,designation:`Mesure ${V+1}`}))}:q))},v=(R,k,P,q)=>{a(D=>D.map(V=>{if(V.bordereauLigneId!==R)return V;const se=V.lignes.map(ne=>{if(ne.id!==k)return ne;const X={...ne,[P]:q};return["longueur","largeur","profondeur","nombre","diametre"].includes(P)&&(X.partiel=ep(V.unite,X.longueur,X.largeur,X.profondeur,X.nombre,X.diametre)),X});return{...V,lignes:se}}))},b=(R,k)=>k>0?R/k*100:0,w=async()=>{if(!(!n||!c||!f||!p)){o(!0);try{const R=new Date().toISOString();for(const k of s){if(k.lignes.length===0)continue;const P=k.lignes.reduce((D,V)=>D+V.partiel,0),q=h==null?void 0:h.find(D=>D.bordereauLigneId===k.bordereauLigneId);if(q)await Se.metres.update(q.id,{lignes:k.lignes,totalPartiel:P,totalCumule:P,pourcentageRealisation:b(P,k.quantiteBordereau),updatedAt:R}),await mn("UPDATE","metre",q.id.replace("metre:",""),{lignes:k.lignes},n.id);else{const D=`metre:${Ir()}`,V={id:D,projectId:c,periodeId:f,bordereauLigneId:k.bordereauLigneId,userId:n.id,reference:`METRE P${p.numero}-L${k.numeroLigne}`,designationBordereau:k.designation,unite:k.unite,lignes:k.lignes,totalPartiel:P,totalCumule:P,quantiteBordereau:k.quantiteBordereau,pourcentageRealisation:b(P,k.quantiteBordereau),createdAt:R,updatedAt:R};await Se.metres.add(V),await mn("CREATE","metre",D.replace("metre:",""),V,n.id)}}alert("Mtrs enregistrs avec succs !"),r(`/projects/${c}/periodes`)}catch(R){console.error("Erreur lors de la sauvegarde:",R),alert("Erreur lors de la sauvegarde des mtrs")}finally{o(!1)}}},S=()=>s.reduce((R,k)=>{const P=k.lignes.reduce((q,D)=>q+D.partiel,0);return R+P},0),A=()=>s.reduce((R,k)=>R+k.quantiteBordereau,0),F=()=>{const R=A();return R>0?S()/R*100:0},T=()=>s.reduce((R,k)=>{const P=k.lignes.reduce((q,D)=>q+D.partiel,0);return R+P*k.prixUnitaire},0),O=()=>s.reduce((R,k)=>R+k.quantiteBordereau*k.prixUnitaire,0),C=()=>{const R=O();return R>0?T()/R*100:0};return!u||!p||!d?l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>r(`/projects/${c}/periodes`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour aux priodes"]}),l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Saisie rapide des mtrs"}),l.jsx("p",{className:"text-gray-700 font-medium",children:p.libelle}),l.jsxs("p",{className:"text-sm text-gray-500",children:[Vr(new Date(p.dateDebut),"dd MMM yyyy",{locale:Ti})," "," ",Vr(new Date(p.dateFin),"dd MMM yyyy",{locale:Ti})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs("button",{onClick:()=>r(`/projects/${c}/periodes/${f}/attachement`),className:"btn btn-secondary flex items-center gap-2",children:[l.jsx(Sr,{className:"w-4 h-4"}),"Attachement"]}),l.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[l.jsx(qu,{className:"w-4 h-4"}),"Exporter"]}),l.jsx("button",{onClick:w,disabled:i,className:"btn btn-primary flex items-center gap-2",children:i?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enregistrement..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"w-4 h-4"}),"Tout enregistrer"]})})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(aT,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.lignes.length}),l.jsx("p",{className:"text-sm text-gray-600",children:"Lignes bordereau"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S().toFixed(2)}),l.jsx("p",{className:"text-sm text-gray-600",children:"Total ralis"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(Fa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[F().toFixed(1),"%"]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Avancement quantit"})]})]})}),l.jsx("div",{className:`card ${C()>100?"border-2 border-red-400 bg-red-50":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`p-3 rounded-lg ${C()>100?"bg-red-100 text-red-600":"bg-orange-100 text-orange-600"}`,children:l.jsx(ka,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsxs("p",{className:`text-2xl font-bold ${C()>100?"text-red-600":"text-gray-900"}`,children:[C().toFixed(1),"%"]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Avancement financier"}),C()>100&&l.jsx("p",{className:"text-xs text-red-500 font-medium",children:" Dpassement!"})]})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("div",{className:"space-y-4",children:s.map(R=>{const k=R.lignes.reduce((ne,X)=>ne+X.partiel,0),P=R.quantiteBordereau>0?k/R.quantiteBordereau*100:0,q=P>=100,D=k>0,V=Xb(R.unite),se=(V==null?void 0:V.champs)||[];return l.jsxs("div",{className:`border rounded-lg overflow-hidden ${q?"border-green-500 bg-green-50":"border-gray-200"}`,children:[l.jsxs("div",{className:"flex items-center gap-4 p-4 cursor-pointer hover:bg-gray-50 transition",onClick:()=>m(R.bordereauLigneId),children:[R.isExpanded?l.jsx(R9,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):l.jsx(Gf,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}),l.jsx("div",{className:"w-12 text-gray-700 font-bold",children:R.numeroLigne}),l.jsx("div",{className:"flex-1 text-gray-900 font-medium",children:R.designation}),l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:R.unite}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:["Bordereau: ",R.quantiteBordereau.toLocaleString()]}),l.jsxs("div",{className:"text-sm font-bold text-primary-600",children:["Ralis: ",k.toFixed(2)]})]}),l.jsx("div",{className:"w-32",children:l.jsxs("div",{className:"flex items-center gap-2",children:[q?l.jsx(Fa,{className:"w-4 h-4 text-green-500 flex-shrink-0"}):D?l.jsx(Qa,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}):l.jsx("div",{className:"w-4 h-4 flex-shrink-0"}),l.jsx("div",{className:"flex-1",children:l.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:l.jsx("div",{className:`h-full transition-all duration-300 ${q?"bg-green-500":P>=75?"bg-blue-500":P>=50?"bg-yellow-500":"bg-orange-500"}`,style:{width:`${Math.min(P,100)}%`}})})}),l.jsxs("span",{className:"text-xs font-medium text-gray-700 w-10 text-right",children:[P.toFixed(0),"%"]})]})})]}),R.isExpanded&&l.jsxs("div",{className:"border-t border-gray-200 bg-white p-4",children:[l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border border-gray-300",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300 w-12",children:"N"}),l.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation"}),se.includes("longueur")&&l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Longueur (m)"}),se.includes("largeur")&&l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Largeur (m)"}),se.includes("profondeur")&&l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Profondeur (m)"}),se.includes("nombre")&&l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-20",children:"Nombre"}),se.includes("diametre")&&l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Diamtre (mm)"}),l.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-gray-700 border-r border-gray-300 w-28 bg-blue-50",children:"Partiel"}),l.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 w-16",children:"Actions"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:R.lignes.map(ne=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-3 py-2 text-gray-700 font-medium border-r border-gray-200",children:ne.numero}),l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"text",value:ne.designation,onChange:X=>v(R.bordereauLigneId,ne.id,"designation",X.target.value),className:"input text-sm w-full",placeholder:"Description..."})}),se.includes("longueur")&&l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"number",value:ne.longueur||"",onChange:X=>v(R.bordereauLigneId,ne.id,"longueur",parseFloat(X.target.value)||0),className:"input text-center text-sm w-full",placeholder:"0",step:"0.01",min:"0"})}),se.includes("largeur")&&l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"number",value:ne.largeur||"",onChange:X=>v(R.bordereauLigneId,ne.id,"largeur",parseFloat(X.target.value)||0),className:"input text-center text-sm w-full",placeholder:"0",step:"0.01",min:"0"})}),se.includes("profondeur")&&l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"number",value:ne.profondeur||"",onChange:X=>v(R.bordereauLigneId,ne.id,"profondeur",parseFloat(X.target.value)||0),className:"input text-center text-sm w-full",placeholder:"0",step:"0.01",min:"0"})}),se.includes("nombre")&&l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"number",value:ne.nombre||"",onChange:X=>v(R.bordereauLigneId,ne.id,"nombre",parseFloat(X.target.value)||0),className:"input text-center text-sm w-full",placeholder:"0",step:"1",min:"0"})}),se.includes("diametre")&&l.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:l.jsx("input",{type:"number",value:ne.diametre||"",onChange:X=>v(R.bordereauLigneId,ne.id,"diametre",parseFloat(X.target.value)||0),className:"input text-center text-sm w-full",placeholder:"0",step:"1",min:"0"})}),l.jsx("td",{className:"px-3 py-2 text-right font-bold text-gray-900 border-r border-gray-200 bg-blue-50",children:ne.partiel.toFixed(3)}),l.jsx("td",{className:"px-3 py-2 text-center",children:l.jsx("button",{onClick:()=>y(R.bordereauLigneId,ne.id),className:"p-1 text-red-600 hover:bg-red-50 rounded transition",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})})]},ne.id))}),l.jsx("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:l.jsxs("tr",{children:[l.jsx("td",{colSpan:se.length+2,className:"px-3 py-2 text-right font-bold text-gray-900",children:"TOTAL:"}),l.jsx("td",{className:"px-3 py-2 text-right font-bold text-xl text-primary-600 border-r border-gray-300 bg-blue-50",children:k.toFixed(3)}),l.jsx("td",{})]})})]})}),l.jsx("div",{className:"mt-3",children:l.jsxs("button",{onClick:()=>g(R.bordereauLigneId),className:"btn-secondary text-sm flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Ajouter une mesure"]})})]})]},R.bordereauLigneId)})}),l.jsx("div",{className:"mt-6 p-4 bg-gray-100 border border-gray-300 rounded-lg",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Bordereau"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:A().toFixed(2)})]}),l.jsxs("div",{className:"text-center border-l border-r border-gray-300",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Ralis"}),l.jsx("div",{className:"text-2xl font-bold text-primary-600",children:S().toFixed(2)})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Progression Globale"}),l.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:[F().toFixed(1),"%"]})]})]})}),l.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[l.jsx("p",{className:"text-sm text-blue-900 font-medium mb-1",children:" Conseil"}),l.jsx("p",{className:"text-xs text-blue-700",children:"Cliquez sur chaque ligne pour la dvelopper et saisir les mesures dtailles. Les calculs se font automatiquement en fonction de l'unit."})]})]})]})},IX="modulepreload",MX=function(e,t){return new URL(e,t).href},v_={},uv=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){const i=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(f=>{if(f=MX(f,n),f in v_)return;v_[f]=!0;const u=f.endsWith(".css"),p=u?'[rel="stylesheet"]':"";if(!!n)for(let m=i.length-1;m>=0;m--){const g=i[m];if(g.href===f&&(!u||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${f}"]${p}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":IX,u||(h.as="script"),h.crossOrigin="",h.href=f,c&&h.setAttribute("nonce",c),document.head.appendChild(h),u)return new Promise((m,g)=>{h.addEventListener("load",m),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function xr(e){"@babel/helpers - typeof";return xr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xr(e)}var Ii=Uint8Array,Aa=Uint16Array,Jb=Int32Array,Qb=new Ii([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zb=new Ii([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),y_=new Ii([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),u8=function(e,t){for(var r=new Aa(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new Jb(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},f8=u8(Qb,2),BX=f8.b,Mw=f8.r;BX[28]=258,Mw[258]=28;var UX=u8(Zb,0),w_=UX.r,Bw=new Aa(32768);for(var Or=0;Or<32768;++Or){var Ml=(Or&43690)>>1|(Or&21845)<<1;Ml=(Ml&52428)>>2|(Ml&13107)<<2,Ml=(Ml&61680)>>4|(Ml&3855)<<4,Bw[Or]=((Ml&65280)>>8|(Ml&255)<<8)>>1}var lh=function(e,t,r){for(var n=e.length,s=0,a=new Aa(t);s<n;++s)e[s]&&++a[e[s]-1];var i=new Aa(t);for(s=1;s<t;++s)i[s]=i[s-1]+a[s-1]<<1;var o;if(r){o=new Aa(1<<t);var c=15-t;for(s=0;s<n;++s)if(e[s])for(var f=s<<4|e[s],u=t-e[s],p=i[e[s]-1]++<<u,d=p|(1<<u)-1;p<=d;++p)o[Bw[p]>>c]=f}else for(o=new Aa(n),s=0;s<n;++s)e[s]&&(o[s]=Bw[i[e[s]-1]++]>>15-e[s]);return o},Mu=new Ii(288);for(var Or=0;Or<144;++Or)Mu[Or]=8;for(var Or=144;Or<256;++Or)Mu[Or]=9;for(var Or=256;Or<280;++Or)Mu[Or]=7;for(var Or=280;Or<288;++Or)Mu[Or]=8;var Rg=new Ii(32);for(var Or=0;Or<32;++Or)Rg[Or]=5;var $X=lh(Mu,9,0),zX=lh(Rg,5,0),d8=function(e){return(e+7)/8|0},qX=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Ii(e.subarray(t,r))},qo=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},S0=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},fv=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,a=r.slice();if(!s)return{t:p8,l:0};if(s==1){var i=new Ii(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(A,F){return A.f-F.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],f=0,u=1,p=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};u!=s-1;)o=r[r[f].f<r[p].f?f++:p++],c=r[f!=u&&r[f].f<r[p].f?f++:p++],r[u++]={s:-1,f:o.f+c.f,l:o,r:c};for(var d=a[0].s,n=1;n<s;++n)a[n].s>d&&(d=a[n].s);var h=new Aa(d+1),m=Uw(r[u-1],h,0);if(m>t){var n=0,g=0,y=m-t,v=1<<y;for(a.sort(function(F,T){return h[T.s]-h[F.s]||F.f-T.f});n<s;++n){var b=a[n].s;if(h[b]>t)g+=v-(1<<m-h[b]),h[b]=t;else break}for(g>>=y;g>0;){var w=a[n].s;h[w]<t?g-=1<<t-h[w]++-1:++n}for(;n>=0&&g;--n){var S=a[n].s;h[S]==t&&(--h[S],++g)}m=t}return{t:new Ii(h),l:m}},Uw=function(e,t,r){return e.s==-1?Math.max(Uw(e.l,t,r+1),Uw(e.r,t,r+1)):t[e.s]=r},b_=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Aa(++t),n=0,s=e[0],a=1,i=function(c){r[n++]=c},o=1;o<=t;++o)if(e[o]==s&&o!=t)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=e[o]}return{c:r.subarray(0,n),n:t}},_0=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},h8=function(e,t,r){var n=r.length,s=d8(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var a=0;a<n;++a)e[s+a+4]=r[a];return(s+4+n)*8},N_=function(e,t,r,n,s,a,i,o,c,f,u){qo(t,u++,r),++s[256];for(var p=fv(s,15),d=p.t,h=p.l,m=fv(a,15),g=m.t,y=m.l,v=b_(d),b=v.c,w=v.n,S=b_(g),A=S.c,F=S.n,T=new Aa(19),O=0;O<b.length;++O)++T[b[O]&31];for(var O=0;O<A.length;++O)++T[A[O]&31];for(var C=fv(T,7),R=C.t,k=C.l,P=19;P>4&&!R[y_[P-1]];--P);var q=f+5<<3,D=_0(s,Mu)+_0(a,Rg)+i,V=_0(s,d)+_0(a,g)+i+14+3*P+_0(T,R)+2*T[16]+3*T[17]+7*T[18];if(c>=0&&q<=D&&q<=V)return h8(t,u,e.subarray(c,c+f));var se,ne,X,G;if(qo(t,u,1+(V<D)),u+=2,V<D){se=lh(d,h,0),ne=d,X=lh(g,y,0),G=g;var ve=lh(R,k,0);qo(t,u,w-257),qo(t,u+5,F-1),qo(t,u+10,P-4),u+=14;for(var O=0;O<P;++O)qo(t,u+3*O,R[y_[O]]);u+=3*P;for(var ye=[b,A],E=0;E<2;++E)for(var M=ye[E],O=0;O<M.length;++O){var I=M[O]&31;qo(t,u,ve[I]),u+=R[I],I>15&&(qo(t,u,M[O]>>5&127),u+=M[O]>>12)}}else se=$X,ne=Mu,X=zX,G=Rg;for(var O=0;O<o;++O){var z=n[O];if(z>255){var I=z>>18&31;S0(t,u,se[I+257]),u+=ne[I+257],I>7&&(qo(t,u,z>>23&31),u+=Qb[I]);var te=z&31;S0(t,u,X[te]),u+=G[te],te>3&&(S0(t,u,z>>5&8191),u+=Zb[te])}else S0(t,u,se[z]),u+=ne[z]}return S0(t,u,se[256]),u+ne[256]},HX=new Jb([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),p8=new Ii(0),WX=function(e,t,r,n,s,a){var i=a.z||e.length,o=new Ii(n+i+5*(1+Math.ceil(i/7e3))+s),c=o.subarray(n,o.length-s),f=a.l,u=(a.r||0)&7;if(t){u&&(c[0]=a.r>>3);for(var p=HX[t-1],d=p>>13,h=p&8191,m=(1<<r)-1,g=a.p||new Aa(32768),y=a.h||new Aa(m+1),v=Math.ceil(r/3),b=2*v,w=function(Ge){return(e[Ge]^e[Ge+1]<<v^e[Ge+2]<<b)&m},S=new Jb(25e3),A=new Aa(288),F=new Aa(32),T=0,O=0,C=a.i||0,R=0,k=a.w||0,P=0;C+2<i;++C){var q=w(C),D=C&32767,V=y[q];if(g[D]=V,y[q]=D,k<=C){var se=i-C;if((T>7e3||R>24576)&&(se>423||!f)){u=N_(e,c,0,S,A,F,O,R,P,C-P,u),R=T=O=0,P=C;for(var ne=0;ne<286;++ne)A[ne]=0;for(var ne=0;ne<30;++ne)F[ne]=0}var X=2,G=0,ve=h,ye=D-V&32767;if(se>2&&q==w(C-ye))for(var E=Math.min(d,se)-1,M=Math.min(32767,C),I=Math.min(258,se);ye<=M&&--ve&&D!=V;){if(e[C+X]==e[C+X-ye]){for(var z=0;z<I&&e[C+z]==e[C+z-ye];++z);if(z>X){if(X=z,G=ye,z>E)break;for(var te=Math.min(ye,z-2),fe=0,ne=0;ne<te;++ne){var ge=C-ye+ne&32767,he=g[ge],pe=ge-he&32767;pe>fe&&(fe=pe,V=ge)}}}D=V,V=g[D],ye+=D-V&32767}if(G){S[R++]=268435456|Mw[X]<<18|w_[G];var Le=Mw[X]&31,ee=w_[G]&31;O+=Qb[Le]+Zb[ee],++A[257+Le],++F[ee],k=C+X,++T}else S[R++]=e[C],++A[e[C]]}}for(C=Math.max(C,k);C<i;++C)S[R++]=e[C],++A[e[C]];u=N_(e,c,f,S,A,F,O,R,P,C-P,u),f||(a.r=u&7|c[u/8|0]<<3,u-=7,a.h=y,a.p=g,a.i=C,a.w=k)}else{for(var C=a.w||0;C<i+f;C+=65535){var We=C+65535;We>=i&&(c[u/8|0]=f,We=i),u=h8(c,u+1,e.subarray(C,We))}a.i=i}return qX(o,0,n+d8(u)+s)},m8=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,a=r.length|0,i=0;i!=a;){for(var o=Math.min(i+2655,a);i<o;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},VX=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),i=new Ii(a.length+e.length);i.set(a),i.set(e,a.length),e=i,s.w=a.length}return WX(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},g8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},KX=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=m8();s.p(t.dictionary),g8(e,2,s.d())}};function $w(e,t){t||(t={});var r=m8();r.p(e);var n=VX(e,t,t.dictionary?6:2,4);return KX(n,t),g8(n,n.length-4,r.d()),n}var GX=typeof TextDecoder<"u"&&new TextDecoder,YX=0;try{GX.decode(p8,{stream:!0}),YX=1}catch{}function XX(e){if(Array.isArray(e))return e}function JX(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,a,i,o=[],c=!0,f=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(c=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(u){f=!0,s=u}finally{try{if(!c&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(f)throw s}}return o}}function S_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function QX(e,t){if(e){if(typeof e=="string")return S_(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?S_(e,t):void 0}}function ZX(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function __(e,t){return XX(e)||JX(e,t)||QX(e,t)||ZX()}function k_(e,t="utf8"){return new TextDecoder(t).decode(e)}const eJ=new TextEncoder;function tJ(e){return eJ.encode(e)}const rJ=1024*8,nJ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),dv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class e4{constructor(t=rJ,r={}){bt(this,"buffer");bt(this,"byteLength");bt(this,"byteOffset");bt(this,"length");bt(this,"offset");bt(this,"lastWrittenByte");bt(this,"littleEndian");bt(this,"_data");bt(this,"_mark");bt(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,a=t.byteLength-s;let i=s;(ArrayBuffer.isView(t)||t instanceof e4)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=dv[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===nJ&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+n));o.reverse();const c=new dv[r](o.buffer);return this.offset+=n,c.reverse(),c}const i=new dv[r](a);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return k_(this.readBytes(t))}decodeText(t=1,r="utf8"){return k_(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(tJ(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Md(e){let t=e.length;for(;--t>=0;)e[t]=0}const sJ=3,aJ=258,x8=29,iJ=256,oJ=iJ+1+x8,v8=30,lJ=512,cJ=new Array((oJ+2)*2);Md(cJ);const uJ=new Array(v8*2);Md(uJ);const fJ=new Array(lJ);Md(fJ);const dJ=new Array(aJ-sJ+1);Md(dJ);const hJ=new Array(x8);Md(hJ);const pJ=new Array(v8);Md(pJ);const mJ=(e,t,r,n)=>{let s=e&65535|0,a=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do s=s+t[n++]|0,a=a+s|0;while(--i);s%=65521,a%=65521}return s|a<<16|0};var zw=mJ;const gJ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},xJ=new Uint32Array(gJ()),vJ=(e,t,r,n)=>{const s=xJ,a=n+r;e^=-1;for(let i=n;i<a;i++)e=e>>>8^s[(e^t[i])&255];return e^-1};var Qi=vJ,qw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},y8={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const yJ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var wJ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)yJ(r,n)&&(e[n]=r[n])}}return e},bJ=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,a=e.length;n<a;n++){let i=e[n];r.set(i,s),s+=i.length}return r},w8={assign:wJ,flattenChunks:bJ};let b8=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{b8=!1}const tp=new Uint8Array(256);for(let e=0;e<256;e++)tp[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;tp[254]=tp[254]=1;var NJ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,a,i=e.length,o=0;for(s=0;s<i;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,s=0;a<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const SJ=(e,t)=>{if(t<65534&&e.subarray&&b8)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var _J=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let i=e[n++];if(i<128){a[s++]=i;continue}let o=tp[i];if(o>4){a[s++]=65533,n+=o-1;continue}for(i&=o===2?31:o===3?15:7;o>1&&n<r;)i=i<<6|e[n++]&63,o--;if(o>1){a[s++]=65533;continue}i<65536?a[s++]=i:(i-=65536,a[s++]=55296|i>>10&1023,a[s++]=56320|i&1023)}return SJ(a,s)},kJ=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+tp[e[r]]>t?r:t},Hw={string2buf:NJ,buf2string:_J,utf8border:kJ};function EJ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var jJ=EJ;const Vm=16209,AJ=16191;var TJ=function(t,r){let n,s,a,i,o,c,f,u,p,d,h,m,g,y,v,b,w,S,A,F,T,O,C,R;const k=t.state;n=t.next_in,C=t.input,s=n+(t.avail_in-5),a=t.next_out,R=t.output,i=a-(r-t.avail_out),o=a+(t.avail_out-257),c=k.dmax,f=k.wsize,u=k.whave,p=k.wnext,d=k.window,h=k.hold,m=k.bits,g=k.lencode,y=k.distcode,v=(1<<k.lenbits)-1,b=(1<<k.distbits)-1;e:do{m<15&&(h+=C[n++]<<m,m+=8,h+=C[n++]<<m,m+=8),w=g[h&v];t:for(;;){if(S=w>>>24,h>>>=S,m-=S,S=w>>>16&255,S===0)R[a++]=w&65535;else if(S&16){A=w&65535,S&=15,S&&(m<S&&(h+=C[n++]<<m,m+=8),A+=h&(1<<S)-1,h>>>=S,m-=S),m<15&&(h+=C[n++]<<m,m+=8,h+=C[n++]<<m,m+=8),w=y[h&b];r:for(;;){if(S=w>>>24,h>>>=S,m-=S,S=w>>>16&255,S&16){if(F=w&65535,S&=15,m<S&&(h+=C[n++]<<m,m+=8,m<S&&(h+=C[n++]<<m,m+=8)),F+=h&(1<<S)-1,F>c){t.msg="invalid distance too far back",k.mode=Vm;break e}if(h>>>=S,m-=S,S=a-i,F>S){if(S=F-S,S>u&&k.sane){t.msg="invalid distance too far back",k.mode=Vm;break e}if(T=0,O=d,p===0){if(T+=f-S,S<A){A-=S;do R[a++]=d[T++];while(--S);T=a-F,O=R}}else if(p<S){if(T+=f+p-S,S-=p,S<A){A-=S;do R[a++]=d[T++];while(--S);if(T=0,p<A){S=p,A-=S;do R[a++]=d[T++];while(--S);T=a-F,O=R}}}else if(T+=p-S,S<A){A-=S;do R[a++]=d[T++];while(--S);T=a-F,O=R}for(;A>2;)R[a++]=O[T++],R[a++]=O[T++],R[a++]=O[T++],A-=3;A&&(R[a++]=O[T++],A>1&&(R[a++]=O[T++]))}else{T=a-F;do R[a++]=R[T++],R[a++]=R[T++],R[a++]=R[T++],A-=3;while(A>2);A&&(R[a++]=R[T++],A>1&&(R[a++]=R[T++]))}}else if(S&64){t.msg="invalid distance code",k.mode=Vm;break e}else{w=y[(w&65535)+(h&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){k.mode=AJ;break e}else{t.msg="invalid literal/length code",k.mode=Vm;break e}else{w=g[(w&65535)+(h&(1<<S)-1)];continue t}break}}while(n<s&&a<o);A=m>>3,n-=A,m-=A<<3,h&=(1<<m)-1,t.next_in=n,t.next_out=a,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=a<o?257+(o-a):257-(a-o),k.hold=h,k.bits=m};const gf=15,E_=852,j_=592,A_=0,hv=1,T_=2,CJ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),PJ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),FJ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),LJ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),DJ=(e,t,r,n,s,a,i,o)=>{const c=o.bits;let f=0,u=0,p=0,d=0,h=0,m=0,g=0,y=0,v=0,b=0,w,S,A,F,T,O=null,C;const R=new Uint16Array(gf+1),k=new Uint16Array(gf+1);let P=null,q,D,V;for(f=0;f<=gf;f++)R[f]=0;for(u=0;u<n;u++)R[t[r+u]]++;for(h=c,d=gf;d>=1&&R[d]===0;d--);if(h>d&&(h=d),d===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,o.bits=1,0;for(p=1;p<d&&R[p]===0;p++);for(h<p&&(h=p),y=1,f=1;f<=gf;f++)if(y<<=1,y-=R[f],y<0)return-1;if(y>0&&(e===A_||d!==1))return-1;for(k[1]=0,f=1;f<gf;f++)k[f+1]=k[f]+R[f];for(u=0;u<n;u++)t[r+u]!==0&&(i[k[t[r+u]]++]=u);if(e===A_?(O=P=i,C=20):e===hv?(O=CJ,P=PJ,C=257):(O=FJ,P=LJ,C=0),b=0,u=0,f=p,T=a,m=h,g=0,A=-1,v=1<<h,F=v-1,e===hv&&v>E_||e===T_&&v>j_)return 1;for(;;){q=f-g,i[u]+1<C?(D=0,V=i[u]):i[u]>=C?(D=P[i[u]-C],V=O[i[u]-C]):(D=96,V=0),w=1<<f-g,S=1<<m,p=S;do S-=w,s[T+(b>>g)+S]=q<<24|D<<16|V|0;while(S!==0);for(w=1<<f-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--R[f]===0){if(f===d)break;f=t[r+i[u]]}if(f>h&&(b&F)!==A){for(g===0&&(g=h),T+=p,m=f-g,y=1<<m;m+g<d&&(y-=R[m+g],!(y<=0));)m++,y<<=1;if(v+=1<<m,e===hv&&v>E_||e===T_&&v>j_)return 1;A=b&F,s[A]=h<<24|m<<16|T-a|0}}return b!==0&&(s[T+b]=f-g<<24|64<<16|0),o.bits=h,0};var ch=DJ;const OJ=0,N8=1,S8=2,{Z_FINISH:C_,Z_BLOCK:RJ,Z_TREES:Km,Z_OK:Bu,Z_STREAM_END:IJ,Z_NEED_DICT:MJ,Z_STREAM_ERROR:ri,Z_DATA_ERROR:_8,Z_MEM_ERROR:k8,Z_BUF_ERROR:BJ,Z_DEFLATED:P_}=y8,Ax=16180,F_=16181,L_=16182,D_=16183,O_=16184,R_=16185,I_=16186,M_=16187,B_=16188,U_=16189,Ig=16190,Ho=16191,pv=16192,$_=16193,mv=16194,z_=16195,q_=16196,H_=16197,W_=16198,Gm=16199,Ym=16200,V_=16201,K_=16202,G_=16203,Y_=16204,X_=16205,gv=16206,J_=16207,Q_=16208,Br=16209,E8=16210,j8=16211,UJ=852,$J=592,zJ=15,qJ=zJ,Z_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function HJ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Xu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ax||t.mode>j8?1:0},A8=e=>{if(Xu(e))return ri;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Ax,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(UJ),t.distcode=t.distdyn=new Int32Array($J),t.sane=1,t.back=-1,Bu},T8=e=>{if(Xu(e))return ri;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,A8(e)},C8=(e,t)=>{let r;if(Xu(e))return ri;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ri:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,T8(e))},P8=(e,t)=>{if(!e)return ri;const r=new HJ;e.state=r,r.strm=e,r.window=null,r.mode=Ax;const n=C8(e,t);return n!==Bu&&(e.state=null),n},WJ=e=>P8(e,qJ);let ek=!0,xv,vv;const VJ=e=>{if(ek){xv=new Int32Array(512),vv=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ch(N8,e.lens,0,288,xv,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ch(S8,e.lens,0,32,vv,0,e.work,{bits:5}),ek=!1}e.lencode=xv,e.lenbits=9,e.distcode=vv,e.distbits=5},F8=(e,t,r,n)=>{let s;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(t.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},KJ=(e,t)=>{let r,n,s,a,i,o,c,f,u,p,d,h,m,g,y=0,v,b,w,S,A,F,T,O;const C=new Uint8Array(4);let R,k;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Xu(e)||!e.output||!e.input&&e.avail_in!==0)return ri;r=e.state,r.mode===Ho&&(r.mode=pv),i=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,f=r.hold,u=r.bits,p=o,d=c,O=Bu;e:for(;;)switch(r.mode){case Ax:if(r.wrap===0){r.mode=pv;break}for(;u<16;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(r.wrap&2&&f===35615){r.wbits===0&&(r.wbits=15),r.check=0,C[0]=f&255,C[1]=f>>>8&255,r.check=Qi(r.check,C,2,0),f=0,u=0,r.mode=F_;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((f&255)<<8)+(f>>8))%31){e.msg="incorrect header check",r.mode=Br;break}if((f&15)!==P_){e.msg="unknown compression method",r.mode=Br;break}if(f>>>=4,u-=4,T=(f&15)+8,r.wbits===0&&(r.wbits=T),T>15||T>r.wbits){e.msg="invalid window size",r.mode=Br;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=f&512?U_:Ho,f=0,u=0;break;case F_:for(;u<16;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(r.flags=f,(r.flags&255)!==P_){e.msg="unknown compression method",r.mode=Br;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Br;break}r.head&&(r.head.text=f>>8&1),r.flags&512&&r.wrap&4&&(C[0]=f&255,C[1]=f>>>8&255,r.check=Qi(r.check,C,2,0)),f=0,u=0,r.mode=L_;case L_:for(;u<32;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.head&&(r.head.time=f),r.flags&512&&r.wrap&4&&(C[0]=f&255,C[1]=f>>>8&255,C[2]=f>>>16&255,C[3]=f>>>24&255,r.check=Qi(r.check,C,4,0)),f=0,u=0,r.mode=D_;case D_:for(;u<16;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=f&255,r.head.os=f>>8),r.flags&512&&r.wrap&4&&(C[0]=f&255,C[1]=f>>>8&255,r.check=Qi(r.check,C,2,0)),f=0,u=0,r.mode=O_;case O_:if(r.flags&1024){for(;u<16;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.length=f,r.head&&(r.head.extra_len=f),r.flags&512&&r.wrap&4&&(C[0]=f&255,C[1]=f>>>8&255,r.check=Qi(r.check,C,2,0)),f=0,u=0}else r.head&&(r.head.extra=null);r.mode=R_;case R_:if(r.flags&1024&&(h=r.length,h>o&&(h=o),h&&(r.head&&(T=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+h),T)),r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,h,a)),o-=h,a+=h,r.length-=h),r.length))break e;r.length=0,r.mode=I_;case I_:if(r.flags&2048){if(o===0)break e;h=0;do T=n[a+h++],r.head&&T&&r.length<65536&&(r.head.name+=String.fromCharCode(T));while(T&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,h,a)),o-=h,a+=h,T)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=M_;case M_:if(r.flags&4096){if(o===0)break e;h=0;do T=n[a+h++],r.head&&T&&r.length<65536&&(r.head.comment+=String.fromCharCode(T));while(T&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,h,a)),o-=h,a+=h,T)break e}else r.head&&(r.head.comment=null);r.mode=B_;case B_:if(r.flags&512){for(;u<16;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(r.wrap&4&&f!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Br;break}f=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=Ho;break;case U_:for(;u<32;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}e.adler=r.check=Z_(f),f=0,u=0,r.mode=Ig;case Ig:if(r.havedict===0)return e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,r.hold=f,r.bits=u,MJ;e.adler=r.check=1,r.mode=Ho;case Ho:if(t===RJ||t===Km)break e;case pv:if(r.last){f>>>=u&7,u-=u&7,r.mode=gv;break}for(;u<3;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}switch(r.last=f&1,f>>>=1,u-=1,f&3){case 0:r.mode=$_;break;case 1:if(VJ(r),r.mode=Gm,t===Km){f>>>=2,u-=2;break e}break;case 2:r.mode=q_;break;case 3:e.msg="invalid block type",r.mode=Br}f>>>=2,u-=2;break;case $_:for(f>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if((f&65535)!==(f>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Br;break}if(r.length=f&65535,f=0,u=0,r.mode=mv,t===Km)break e;case mv:r.mode=z_;case z_:if(h=r.length,h){if(h>o&&(h=o),h>c&&(h=c),h===0)break e;s.set(n.subarray(a,a+h),i),o-=h,a+=h,c-=h,i+=h,r.length-=h;break}r.mode=Ho;break;case q_:for(;u<14;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(r.nlen=(f&31)+257,f>>>=5,u-=5,r.ndist=(f&31)+1,f>>>=5,u-=5,r.ncode=(f&15)+4,f>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Br;break}r.have=0,r.mode=H_;case H_:for(;r.have<r.ncode;){for(;u<3;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.lens[P[r.have++]]=f&7,f>>>=3,u-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},O=ch(OJ,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,O){e.msg="invalid code lengths set",r.mode=Br;break}r.have=0,r.mode=W_;case W_:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[f&(1<<r.lenbits)-1],v=y>>>24,b=y>>>16&255,w=y&65535,!(v<=u);){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(w<16)f>>>=v,u-=v,r.lens[r.have++]=w;else{if(w===16){for(k=v+2;u<k;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(f>>>=v,u-=v,r.have===0){e.msg="invalid bit length repeat",r.mode=Br;break}T=r.lens[r.have-1],h=3+(f&3),f>>>=2,u-=2}else if(w===17){for(k=v+3;u<k;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}f>>>=v,u-=v,T=0,h=3+(f&7),f>>>=3,u-=3}else{for(k=v+7;u<k;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}f>>>=v,u-=v,T=0,h=11+(f&127),f>>>=7,u-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Br;break}for(;h--;)r.lens[r.have++]=T}}if(r.mode===Br)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Br;break}if(r.lenbits=9,R={bits:r.lenbits},O=ch(N8,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,O){e.msg="invalid literal/lengths set",r.mode=Br;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},O=ch(S8,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,O){e.msg="invalid distances set",r.mode=Br;break}if(r.mode=Gm,t===Km)break e;case Gm:r.mode=Ym;case Ym:if(o>=6&&c>=258){e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,r.hold=f,r.bits=u,TJ(e,d),i=e.next_out,s=e.output,c=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,f=r.hold,u=r.bits,r.mode===Ho&&(r.back=-1);break}for(r.back=0;y=r.lencode[f&(1<<r.lenbits)-1],v=y>>>24,b=y>>>16&255,w=y&65535,!(v<=u);){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(b&&!(b&240)){for(S=v,A=b,F=w;y=r.lencode[F+((f&(1<<S+A)-1)>>S)],v=y>>>24,b=y>>>16&255,w=y&65535,!(S+v<=u);){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}f>>>=S,u-=S,r.back+=S}if(f>>>=v,u-=v,r.back+=v,r.length=w,b===0){r.mode=X_;break}if(b&32){r.back=-1,r.mode=Ho;break}if(b&64){e.msg="invalid literal/length code",r.mode=Br;break}r.extra=b&15,r.mode=V_;case V_:if(r.extra){for(k=r.extra;u<k;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.length+=f&(1<<r.extra)-1,f>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=K_;case K_:for(;y=r.distcode[f&(1<<r.distbits)-1],v=y>>>24,b=y>>>16&255,w=y&65535,!(v<=u);){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(!(b&240)){for(S=v,A=b,F=w;y=r.distcode[F+((f&(1<<S+A)-1)>>S)],v=y>>>24,b=y>>>16&255,w=y&65535,!(S+v<=u);){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}f>>>=S,u-=S,r.back+=S}if(f>>>=v,u-=v,r.back+=v,b&64){e.msg="invalid distance code",r.mode=Br;break}r.offset=w,r.extra=b&15,r.mode=G_;case G_:if(r.extra){for(k=r.extra;u<k;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}r.offset+=f&(1<<r.extra)-1,f>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Br;break}r.mode=Y_;case Y_:if(c===0)break e;if(h=d-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Br;break}h>r.wnext?(h-=r.wnext,m=r.wsize-h):m=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=s,m=i-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do s[i++]=g[m++];while(--h);r.length===0&&(r.mode=Ym);break;case X_:if(c===0)break e;s[i++]=r.length,c--,r.mode=Ym;break;case gv:if(r.wrap){for(;u<32;){if(o===0)break e;o--,f|=n[a++]<<u,u+=8}if(d-=c,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Qi(r.check,s,d,i-d):zw(r.check,s,d,i-d)),d=c,r.wrap&4&&(r.flags?f:Z_(f))!==r.check){e.msg="incorrect data check",r.mode=Br;break}f=0,u=0}r.mode=J_;case J_:if(r.wrap&&r.flags){for(;u<32;){if(o===0)break e;o--,f+=n[a++]<<u,u+=8}if(r.wrap&4&&f!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Br;break}f=0,u=0}r.mode=Q_;case Q_:O=IJ;break e;case Br:O=_8;break e;case E8:return k8;case j8:default:return ri}return e.next_out=i,e.avail_out=c,e.next_in=a,e.avail_in=o,r.hold=f,r.bits=u,(r.wsize||d!==e.avail_out&&r.mode<Br&&(r.mode<gv||t!==C_))&&F8(e,e.output,e.next_out,d-e.avail_out),p-=e.avail_in,d-=e.avail_out,e.total_in+=p,e.total_out+=d,r.total+=d,r.wrap&4&&d&&(e.adler=r.check=r.flags?Qi(r.check,s,d,e.next_out-d):zw(r.check,s,d,e.next_out-d)),e.data_type=r.bits+(r.last?64:0)+(r.mode===Ho?128:0)+(r.mode===Gm||r.mode===mv?256:0),(p===0&&d===0||t===C_)&&O===Bu&&(O=BJ),O},GJ=e=>{if(Xu(e))return ri;let t=e.state;return t.window&&(t.window=null),e.state=null,Bu},YJ=(e,t)=>{if(Xu(e))return ri;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Bu):ri},XJ=(e,t)=>{const r=t.length;let n,s,a;return Xu(e)||(n=e.state,n.wrap!==0&&n.mode!==Ig)?ri:n.mode===Ig&&(s=1,s=zw(s,t,r,0),s!==n.check)?_8:(a=F8(e,t,r,r),a?(n.mode=E8,k8):(n.havedict=1,Bu))};var JJ=T8,QJ=C8,ZJ=A8,eQ=WJ,tQ=P8,rQ=KJ,nQ=GJ,sQ=YJ,aQ=XJ,iQ="pako inflate (from Nodeca project)",Yo={inflateReset:JJ,inflateReset2:QJ,inflateResetKeep:ZJ,inflateInit:eQ,inflateInit2:tQ,inflate:rQ,inflateEnd:nQ,inflateGetHeader:sQ,inflateSetDictionary:aQ,inflateInfo:iQ};function oQ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var lQ=oQ;const L8=Object.prototype.toString,{Z_NO_FLUSH:cQ,Z_FINISH:uQ,Z_OK:rp,Z_STREAM_END:yv,Z_NEED_DICT:wv,Z_STREAM_ERROR:fQ,Z_DATA_ERROR:tk,Z_MEM_ERROR:dQ}=y8;function Ep(e){this.options=w8.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jJ,this.strm.avail_out=0;let r=Yo.inflateInit2(this.strm,t.windowBits);if(r!==rp)throw new Error(qw[r]);if(this.header=new lQ,Yo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Hw.string2buf(t.dictionary):L8.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Yo.inflateSetDictionary(this.strm,t.dictionary),r!==rp)))throw new Error(qw[r])}Ep.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,i,o;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?uQ:cQ,L8.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Yo.inflate(r,i),a===wv&&s&&(a=Yo.inflateSetDictionary(r,s),a===rp?a=Yo.inflate(r,i):a===tk&&(a=wv));r.avail_in>0&&a===yv&&r.state.wrap>0&&e[r.next_in]!==0;)Yo.inflateReset(r),a=Yo.inflate(r,i);switch(a){case fQ:case tk:case wv:case dQ:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===yv))if(this.options.to==="string"){let c=Hw.utf8border(r.output,r.next_out),f=r.next_out-c,u=Hw.buf2string(r.output,c);r.next_out=f,r.avail_out=n-f,f&&r.output.set(r.output.subarray(c,c+f),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===rp&&o===0)){if(a===yv)return a=Yo.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Ep.prototype.onData=function(e){this.chunks.push(e)};Ep.prototype.onEnd=function(e){e===rp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w8.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function hQ(e,t){const r=new Ep(t);if(r.push(e),r.err)throw r.msg||qw[r.err];return r.result}var pQ=Ep,mQ=hQ,gQ={Inflate:pQ,inflate:mQ};const{Inflate:xQ,inflate:vQ}=gQ;var rk=xQ,yQ=vQ;const D8=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;D8[e]=t}const nk=4294967295;function wQ(e,t,r){let n=e;for(let s=0;s<r;s++)n=D8[(n^t[s])&255]^n>>>8;return n}function bQ(e,t){return(wQ(nk,e,t)^nk)>>>0}function sk(e,t,r){const n=e.readUint32(),s=bQ(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function O8(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function R8(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function I8(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function M8(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-s]>>1)&255}else{for(;a<s;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-s]+r[a]>>1)&255}}function B8(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-s]&255}else{for(;a<s;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+NQ(t[a-s],r[a],r[a-s])&255}}function NQ(e,t,r){const n=e+t-r,s=Math.abs(n-e),a=Math.abs(n-t),i=Math.abs(n-r);return s<=a&&s<=i?e:a<=i?t:r}function SQ(e,t,r,n,s,a){switch(e){case 0:O8(t,r,s);break;case 1:R8(t,r,s,a);break;case 2:I8(t,r,n,s);break;case 3:M8(t,r,n,s,a);break;case 4:B8(t,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const _Q=new Uint16Array([255]),kQ=new Uint8Array(_Q.buffer),EQ=kQ[0]===255;function jQ(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*s,c=new Uint8Array(n*r*o);let f=0;for(let u=0;u<7;u++){const p=i[u],d=Math.ceil((r-p.x)/p.xStep),h=Math.ceil((n-p.y)/p.yStep);if(d<=0||h<=0)continue;const m=d*o,g=new Uint8Array(m);for(let y=0;y<h;y++){const v=t[f++],b=t.subarray(f,f+m);f+=m;const w=new Uint8Array(m);SQ(v,b,w,g,m,o),g.set(w);for(let S=0;S<d;S++){const A=p.x+S*p.xStep,F=p.y+y*p.yStep;if(!(A>=r||F>=n))for(let T=0;T<o;T++)c[(F*r+A)*o+T]=w[S*o+T]}}}if(a===16){const u=new Uint16Array(c.buffer);if(EQ)for(let p=0;p<u.length;p++)u[p]=AQ(u[p]);return u}else return c}function AQ(e){return(e&255)<<8|e>>8&255}const TQ=new Uint16Array([255]),CQ=new Uint8Array(TQ.buffer),PQ=CQ[0]===255,FQ=new Uint8Array(0);function ak(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=Math.ceil(a/8)*s,o=Math.ceil(a/8*s*r),c=new Uint8Array(n*o);let f=FQ,u=0,p,d;for(let h=0;h<n;h++){switch(p=t.subarray(u+1,u+1+o),d=c.subarray(h*o,(h+1)*o),t[u]){case 0:O8(p,d,o);break;case 1:R8(p,d,o,i);break;case 2:I8(p,d,f,o);break;case 3:M8(p,d,f,o,i);break;case 4:B8(p,d,f,o,i);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}f=d,u+=o+1}if(a===16){const h=new Uint16Array(c.buffer);if(PQ)for(let m=0;m<h.length;m++)h[m]=LQ(h[m]);return h}else return c}function LQ(e){return(e&255)<<8|e>>8&255}const P1=Uint8Array.of(137,80,78,71,13,10,26,10);function ik(e){if(!DQ(e.readBytes(P1.length)))throw new Error("wrong PNG signature")}function DQ(e){if(e.length<P1.length)return!1;for(let t=0;t<P1.length;t++)if(e[t]!==P1[t])return!1;return!0}const OQ="tEXt",RQ=0,U8=new TextDecoder("latin1");function IQ(e){if(BQ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const MQ=/^[\u0000-\u00FF]*$/;function BQ(e){if(!MQ.test(e))throw new Error("invalid latin1 text")}function UQ(e,t,r){const n=$8(t);e[n]=$Q(t,r-n.length-1)}function $8(e){for(e.mark();e.readByte()!==RQ;);const t=e.offset;e.reset();const r=U8.decode(e.readBytes(t-e.offset-1));return e.skip(1),IQ(r),r}function $Q(e,t){return U8.decode(e.readBytes(t))}const ba={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},bv={UNKNOWN:-1,DEFLATE:0},ok={UNKNOWN:-1,ADAPTIVE:0},Nv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Xm={NONE:0,BACKGROUND:1,PREVIOUS:2},Sv={SOURCE:0,OVER:1};class zQ extends e4{constructor(r,n={}){super(r);bt(this,"_checkCrc");bt(this,"_inflator");bt(this,"_png");bt(this,"_apng");bt(this,"_end");bt(this,"_hasPalette");bt(this,"_palette");bt(this,"_hasTransparency");bt(this,"_transparency");bt(this,"_compressionMethod");bt(this,"_filterMethod");bt(this,"_interlaceMethod");bt(this,"_colorType");bt(this,"_isAnimated");bt(this,"_numberOfFrames");bt(this,"_numberOfPlays");bt(this,"_frames");bt(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new rk,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=bv.UNKNOWN,this._filterMethod=ok.UNKNOWN,this._interlaceMethod=Nv.UNKNOWN,this._colorType=ba.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(ik(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(ik(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case OQ:UQ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?sk(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?sk(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=qQ(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case ba.GREYSCALE:s=1;break;case ba.TRUECOLOUR:s=3;break;case ba.INDEXED_COLOUR:s=1;break;case ba.GREYSCALE_ALPHA:s=2;break;case ba.TRUECOLOUR_ALPHA:s=4;break;case ba.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==bv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ba.GREYSCALE:case ba.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ba.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ba.UNKNOWN:case ba.GREYSCALE_ALPHA:case ba.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=$8(this),s=this.readUint8();if(s!==bv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:yQ(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=ak({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case Xm.NONE:break;case Xm.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let i=0;i<this._png.width;i++){const o=(a*r.width+i)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[o+c]=0}break;case Xm.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(i,o)=>{const c=((i+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,f=(i*n.width+o)*this._png.channels;return{index:c,frameIndex:f}};switch(n.blendOp){case Sv.SOURCE:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:c,frameIndex:f}=a(i,o);for(let u=0;u<this._png.channels;u++)r.data[c+u]=n.data[f+u]}break;case Sv.OVER:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:c,frameIndex:f}=a(i,o);for(let u=0;u<this._png.channels;u++){const p=n.data[f+this._png.channels-1]/s,d=u%(this._png.channels-1)===0?1:n.data[f+u],h=Math.floor(p*d+(1-p)*r.data[c+u]);r.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==ok.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Nv.NO_INTERLACE)this._png.data=ak({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Nv.ADAM7)this._png.data=jQ({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Xm.NONE,blendOp:Sv.SOURCE,data:r}),this._inflator=new rk,this._writingDataChunks=!1}}function qQ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var lk;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(lk||(lk={}));function HQ(e,t){return new zQ(e,t).decode()}var Pt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _v(){Pt.console&&typeof Pt.console.log=="function"&&Pt.console.log.apply(Pt.console,arguments)}var Nr={log:_v,warn:function(e){Pt.console&&(typeof Pt.console.warn=="function"?Pt.console.warn.apply(Pt.console,arguments):_v.call(null,arguments))},error:function(e){Pt.console&&(typeof Pt.console.error=="function"?Pt.console.error.apply(Pt.console,arguments):_v(e))}};function kv(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){tu(n.response,t,r)},n.onerror=function(){Nr.error("could not download file")},n.send()}function ck(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Jm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var tu=Pt.saveAs||((typeof window>"u"?"undefined":xr(window))!=="object"||window!==Pt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Pt.URL||Pt.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?ck(s.href)?kv(e,t,r):Jm(s,s.target="_blank"):Jm(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){Jm(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(ck(e))kv(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){Jm(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:xr(a)!=="object"&&(Nr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return kv(e,t,r);var s=e.type==="application/octet-stream",a=/constructor/i.test(Pt.HTMLElement)||Pt.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":xr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=i?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var c=Pt.URL||Pt.webkitURL,f=c.createObjectURL(e);n?n.location=f:location.href=f,n=null,setTimeout(function(){c.revokeObjectURL(f)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function z8(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,i=s.exec(e);i&&(t=a(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),f=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),f.length==1&&(f="0"+f),"#"+o+c+f}}var F1=Pt.atob.bind(Pt),uk=Pt.btoa.bind(Pt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Ev(e,t){var r=e[0],n=e[1],s=e[2],a=e[3];r=gs(r,n,s,a,t[0],7,-680876936),a=gs(a,r,n,s,t[1],12,-389564586),s=gs(s,a,r,n,t[2],17,606105819),n=gs(n,s,a,r,t[3],22,-1044525330),r=gs(r,n,s,a,t[4],7,-176418897),a=gs(a,r,n,s,t[5],12,1200080426),s=gs(s,a,r,n,t[6],17,-1473231341),n=gs(n,s,a,r,t[7],22,-45705983),r=gs(r,n,s,a,t[8],7,1770035416),a=gs(a,r,n,s,t[9],12,-1958414417),s=gs(s,a,r,n,t[10],17,-42063),n=gs(n,s,a,r,t[11],22,-1990404162),r=gs(r,n,s,a,t[12],7,1804603682),a=gs(a,r,n,s,t[13],12,-40341101),s=gs(s,a,r,n,t[14],17,-1502002290),r=xs(r,n=gs(n,s,a,r,t[15],22,1236535329),s,a,t[1],5,-165796510),a=xs(a,r,n,s,t[6],9,-1069501632),s=xs(s,a,r,n,t[11],14,643717713),n=xs(n,s,a,r,t[0],20,-373897302),r=xs(r,n,s,a,t[5],5,-701558691),a=xs(a,r,n,s,t[10],9,38016083),s=xs(s,a,r,n,t[15],14,-660478335),n=xs(n,s,a,r,t[4],20,-405537848),r=xs(r,n,s,a,t[9],5,568446438),a=xs(a,r,n,s,t[14],9,-1019803690),s=xs(s,a,r,n,t[3],14,-187363961),n=xs(n,s,a,r,t[8],20,1163531501),r=xs(r,n,s,a,t[13],5,-1444681467),a=xs(a,r,n,s,t[2],9,-51403784),s=xs(s,a,r,n,t[7],14,1735328473),r=vs(r,n=xs(n,s,a,r,t[12],20,-1926607734),s,a,t[5],4,-378558),a=vs(a,r,n,s,t[8],11,-2022574463),s=vs(s,a,r,n,t[11],16,1839030562),n=vs(n,s,a,r,t[14],23,-35309556),r=vs(r,n,s,a,t[1],4,-1530992060),a=vs(a,r,n,s,t[4],11,1272893353),s=vs(s,a,r,n,t[7],16,-155497632),n=vs(n,s,a,r,t[10],23,-1094730640),r=vs(r,n,s,a,t[13],4,681279174),a=vs(a,r,n,s,t[0],11,-358537222),s=vs(s,a,r,n,t[3],16,-722521979),n=vs(n,s,a,r,t[6],23,76029189),r=vs(r,n,s,a,t[9],4,-640364487),a=vs(a,r,n,s,t[12],11,-421815835),s=vs(s,a,r,n,t[15],16,530742520),r=ys(r,n=vs(n,s,a,r,t[2],23,-995338651),s,a,t[0],6,-198630844),a=ys(a,r,n,s,t[7],10,1126891415),s=ys(s,a,r,n,t[14],15,-1416354905),n=ys(n,s,a,r,t[5],21,-57434055),r=ys(r,n,s,a,t[12],6,1700485571),a=ys(a,r,n,s,t[3],10,-1894986606),s=ys(s,a,r,n,t[10],15,-1051523),n=ys(n,s,a,r,t[1],21,-2054922799),r=ys(r,n,s,a,t[8],6,1873313359),a=ys(a,r,n,s,t[15],10,-30611744),s=ys(s,a,r,n,t[6],15,-1560198380),n=ys(n,s,a,r,t[13],21,1309151649),r=ys(r,n,s,a,t[4],6,-145523070),a=ys(a,r,n,s,t[11],10,-1120210379),s=ys(s,a,r,n,t[2],15,718787259),n=ys(n,s,a,r,t[9],21,-343485551),e[0]=oc(r,e[0]),e[1]=oc(n,e[1]),e[2]=oc(s,e[2]),e[3]=oc(a,e[3])}function Tx(e,t,r,n,s,a){return t=oc(oc(t,e),oc(n,a)),oc(t<<s|t>>>32-s,r)}function gs(e,t,r,n,s,a,i){return Tx(t&r|~t&n,e,t,s,a,i)}function xs(e,t,r,n,s,a,i){return Tx(t&n|r&~n,e,t,s,a,i)}function vs(e,t,r,n,s,a,i){return Tx(t^r^n,e,t,s,a,i)}function ys(e,t,r,n,s,a,i){return Tx(r^(t|~n),e,t,s,a,i)}function q8(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Ev(n,WQ(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Ev(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Ev(n,s),n}function WQ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var fk="0123456789abcdef".split("");function VQ(e){for(var t="",r=0;r<4;r++)t+=fk[e>>8*r+4&15]+fk[e>>8*r&15];return t}function KQ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Ww(e){return q8(e).map(KQ).join("")}var GQ=function(e){for(var t=0;t<e.length;t++)e[t]=VQ(e[t]);return e.join("")}(q8("hello"))!="5d41402abc4b2a76b9719d911017c592";function oc(e,t){if(GQ){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Vw(e,t){var r,n,s,a;if(e!==r){for(var i=(s=e,a=1+(256/e.length|0),new Array(a+1).join(s)),o=[],c=0;c<256;c++)o[c]=c;var f=0;for(c=0;c<256;c++){var u=o[c];f=(f+u+i.charCodeAt(c))%256,o[c]=o[f],o[f]=u}r=e,n=o}else o=n;var p=t.length,d=0,h=0,m="";for(c=0;c<p;c++)h=(h+(u=o[d=(d+1)%256]))%256,o[d]=o[h],o[h]=u,i=o[(o[d]+o[h])%256],m+=String.fromCharCode(t.charCodeAt(c)^i);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var dk={print:4,modify:8,copy:16,"annot-forms":32};function Sf(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(o){if(dk.perm!==void 0)throw new Error("Invalid permission: "+o);s+=dk[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=Ww(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Vw(this.encryptionKey,this.padding)}function _f(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function hk(e){if(xr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in t[r]){var i=t[r][a];try{i[0].apply(e,n)}catch(o){Pt.console&&Nr.error("jsPDF PubSub Error",o.message,o)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Mg(e){if(!(this instanceof Mg))return new Mg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function H8(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function nu(e,t,r,n,s){if(!(this instanceof nu))return new nu(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,H8.call(this,n,s)}function Mf(e,t,r,n,s){if(!(this instanceof Mf))return new Mf(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,H8.call(this,n,s)}function mt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],o=1,c=16,f="S",u=null;xr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,a=e.compress||e.compressPdf||a,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),f=e.defaultPathOperation||"S"),i=e.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var p=e.putOnlyUsedFonts||!1,d={},h={internal:{},__private__:{}};h.__private__.PubSub=hk;var m="1.3",g=h.__private__.getPdfVersion=function(){return m};h.__private__.setPdfVersion=function(_){m=_};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var v=h.__private__.getPageFormat=function(_){return y[_]};s=s||"a4";var b="compat",w="advanced",S=b;function A(){this.saveGraphicsState(),J(new Et(Xe,0,0,-Xe,0,Mc()*Xe).toString()+" cm"),this.setFontSize(this.getFontSize()/Xe),f="n",S=w}function F(){this.restoreGraphicsState(),f="S",S=b}var T=h.__private__.combineFontStyleAndFontWeight=function(_,B){if(_=="bold"&&B=="normal"||_=="bold"&&B==400||_=="normal"&&B=="italic"||_=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(_=B==400||B==="normal"?_==="italic"?"italic":"normal":B!=700&&B!=="bold"||_!=="normal"?(B==700?"bold":B)+""+_:"bold"),_};h.advancedAPI=function(_){var B=S===b;return B&&A.call(this),typeof _!="function"||(_(this),B&&F.call(this)),this},h.compatAPI=function(_){var B=S===w;return B&&F.call(this),typeof _!="function"||(_(this),B&&A.call(this)),this},h.isAdvancedAPI=function(){return S===w};var O,C=function(_){if(S!==w)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},R=h.roundToPrecision=h.__private__.roundToPrecision=function(_,B){var ce=t||B;if(isNaN(_)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(ce).replace(/0+$/,"")};O=h.hpf=h.__private__.hpf=typeof c=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,c)}:c==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return R(_,16)};var k=h.f2=h.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return R(_,2)},P=h.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return R(_,3)},q=h.scale=h.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return S===b?_*Xe:S===w?_:void 0},D=function(_){return q(function(B){return S===b?Mc()-B:S===w?B:void 0}(_))};h.__private__.setPrecision=h.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(t=parseInt(_,10))};var V,se="00000000000000000000000000000000",ne=h.__private__.getFileId=function(){return se},X=h.__private__.setFileId=function(_){return se=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():se.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Tn=new Sf(u.userPermissions,u.userPassword,u.ownerPassword,se)),se};h.setFileId=function(_){return X(_),this},h.getFileId=function(){return ne()};var G=h.__private__.convertDateToPDFDate=function(_){var B=_.getTimezoneOffset(),ce=B<0?"+":"-",de=Math.floor(Math.abs(B/60)),be=Math.abs(B%60),Re=[ce,I(de),"'",I(be),"'"].join("");return["D:",_.getFullYear(),I(_.getMonth()+1),I(_.getDate()),I(_.getHours()),I(_.getMinutes()),I(_.getSeconds()),Re].join("")},ve=h.__private__.convertPDFDateToDate=function(_){var B=parseInt(_.substr(2,4),10),ce=parseInt(_.substr(6,2),10)-1,de=parseInt(_.substr(8,2),10),be=parseInt(_.substr(10,2),10),Re=parseInt(_.substr(12,2),10),$e=parseInt(_.substr(14,2),10);return new Date(B,ce,de,be,Re,$e,0)},ye=h.__private__.setCreationDate=function(_){var B;if(_===void 0&&(_=new Date),_ instanceof Date)B=G(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=_}return V=B},E=h.__private__.getCreationDate=function(_){var B=V;return _==="jsDate"&&(B=ve(V)),B};h.setCreationDate=function(_){return ye(_),this},h.getCreationDate=function(_){return E(_)};var M,I=h.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},z=h.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},te=0,fe=[],ge=[],he=0,pe=[],Le=[],ee=!1,We=ge;h.__private__.setCustomOutputDestination=function(_){ee=!0,We=_};var Ge=function(_){ee||(We=_)};h.__private__.resetCustomOutputDestination=function(){ee=!1,We=ge};var J=h.__private__.out=function(_){return _=_.toString(),he+=_.length+1,We.push(_),We},Ue=h.__private__.write=function(_){return J(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},Me=h.__private__.getArrayBuffer=function(_){for(var B=_.length,ce=new ArrayBuffer(B),de=new Uint8Array(ce);B--;)de[B]=_.charCodeAt(B);return ce},rt=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return rt};var Be=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(_){return Be=S===w?_/Xe:_,this};var ft,et=h.__private__.getFontSize=h.getFontSize=function(){return S===b?Be:Be*Xe},gt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(_){return gt=_,this},h.__private__.getR2L=h.getR2L=function(){return gt};var ct,Mt=h.__private__.setZoomMode=function(_){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))ft=_;else if(isNaN(_)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');ft=_}else ft=parseInt(_,10)};h.__private__.getZoomMode=function(){return ft};var Ft,St=h.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');ct=_};h.__private__.getPageMode=function(){return ct};var Kt=h.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');Ft=_};h.__private__.getLayoutMode=function(){return Ft},h.__private__.setDisplayMode=h.setDisplayMode=function(_,B,ce){return Mt(_),Kt(B),St(ce),this};var _t={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(_){if(Object.keys(_t).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return _t[_]},h.__private__.getDocumentProperties=function(){return _t},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(_){for(var B in _t)_t.hasOwnProperty(B)&&_[B]&&(_t[B]=_[B]);return this},h.__private__.setDocumentProperty=function(_,B){if(Object.keys(_t).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return _t[_]=B};var nt,Xe,Je,nr,wt,Ct={},qt={},kr=[],vt={},hr={},kt={},Lt={},Er=null,Xt=0,yt=[],fr=new hk(h),ko=e.hotfixes||[],$n={},si={},Ra=[],Et=function _(B,ce,de,be,Re,$e){if(!(this instanceof _))return new _(B,ce,de,be,Re,$e);isNaN(B)&&(B=1),isNaN(ce)&&(ce=0),isNaN(de)&&(de=0),isNaN(be)&&(be=1),isNaN(Re)&&(Re=0),isNaN($e)&&($e=0),this._matrix=[B,ce,de,be,Re,$e]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(O).join(_)},Et.prototype.multiply=function(_){var B=_.sx*this.sx+_.shy*this.shx,ce=_.sx*this.shy+_.shy*this.sy,de=_.shx*this.sx+_.sy*this.shx,be=_.shx*this.shy+_.sy*this.sy,Re=_.tx*this.sx+_.ty*this.shx+this.tx,$e=_.tx*this.shy+_.ty*this.sy+this.ty;return new Et(B,ce,de,be,Re,$e)},Et.prototype.decompose=function(){var _=this.sx,B=this.shy,ce=this.shx,de=this.sy,be=this.tx,Re=this.ty,$e=Math.sqrt(_*_+B*B),ut=(_/=$e)*ce+(B/=$e)*de;ce-=_*ut,de-=B*ut;var pt=Math.sqrt(ce*ce+de*de);return ut/=pt,_*(de/=pt)<B*(ce/=pt)&&(_=-_,B=-B,ut=-ut,$e=-$e),{scale:new Et($e,0,0,pt,0,0),translate:new Et(1,0,0,1,be,Re),rotate:new Et(_,B,-B,_,0,0),skew:new Et(1,0,ut,1,0,0)}},Et.prototype.toString=function(_){return this.join(" ")},Et.prototype.inversed=function(){var _=this.sx,B=this.shy,ce=this.shx,de=this.sy,be=this.tx,Re=this.ty,$e=1/(_*de-B*ce),ut=de*$e,pt=-B*$e,Dt=-ce*$e,Ht=_*$e;return new Et(ut,pt,Dt,Ht,-ut*be-Dt*Re,-pt*be-Ht*Re)},Et.prototype.applyToPoint=function(_){var B=_.x*this.sx+_.y*this.shx+this.tx,ce=_.x*this.shy+_.y*this.sy+this.ty;return new Co(B,ce)},Et.prototype.applyToRectangle=function(_){var B=this.applyToPoint(_),ce=this.applyToPoint(new Co(_.x+_.w,_.y+_.h));return new Hd(B.x,B.y,ce.x-B.x,ce.y-B.y)},Et.prototype.clone=function(){var _=this.sx,B=this.shy,ce=this.shx,de=this.sy,be=this.tx,Re=this.ty;return new Et(_,B,ce,de,be,Re)},h.Matrix=Et;var ai=h.matrixMult=function(_,B){return B.multiply(_)},ii=new Et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=ii;var us=function(_,B){if(!hr[_]){var ce=(B instanceof nu?"Sh":"P")+(Object.keys(vt).length+1).toString(10);B.id=ce,hr[_]=ce,vt[ce]=B,fr.publish("addPattern",B)}};h.ShadingPattern=nu,h.TilingPattern=Mf,h.addShadingPattern=function(_,B){return C("addShadingPattern()"),us(_,B),this},h.beginTilingPattern=function(_){C("beginTilingPattern()"),Wd(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},h.endTilingPattern=function(_,B){C("endTilingPattern()"),B.stream=Le[M].join(`
`),us(_,B),fr.publish("endTilingPattern",B),Ra.pop().restore()};var Js,Mr=h.__private__.newObject=function(){var _=xn();return H(_,!0),_},xn=h.__private__.newObjectDeferred=function(){return te++,fe[te]=function(){return he},te},H=function(_,B){return B=typeof B=="boolean"&&B,fe[_]=he,B&&J(_+" 0 obj"),_},oe=h.__private__.newAdditionalObject=function(){var _={objId:xn(),content:""};return pe.push(_),_},Q=xn(),re=xn(),le=h.__private__.decodeColorString=function(_){var B=_.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length!==5||B[4]!=="k"&&B[4]!=="K"||(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var ce=parseFloat(B[0]);B=[ce,ce,ce,"r"]}for(var de="#",be=0;be<3;be++)de+=("0"+Math.floor(255*parseFloat(B[be])).toString(16)).slice(-2);return de},ue=h.__private__.encodeColorString=function(_){var B;typeof _=="string"&&(_={ch1:_});var ce=_.ch1,de=_.ch2,be=_.ch3,Re=_.ch4,$e=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var ut=new z8(ce);if(ut.ok)ce=ut.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var pt=parseInt(ce.substr(1),16);ce=pt>>16&255,de=pt>>8&255,be=255&pt}if(de===void 0||Re===void 0&&ce===de&&de===be)B=typeof ce=="string"?ce+" "+$e[0]:_.precision===2?k(ce/255)+" "+$e[0]:P(ce/255)+" "+$e[0];else if(Re===void 0||xr(Re)==="object"){if(Re&&!isNaN(Re.a)&&Re.a===0)return["1.","1.","1.",$e[1]].join(" ");B=typeof ce=="string"?[ce,de,be,$e[1]].join(" "):_.precision===2?[k(ce/255),k(de/255),k(be/255),$e[1]].join(" "):[P(ce/255),P(de/255),P(be/255),$e[1]].join(" ")}else B=typeof ce=="string"?[ce,de,be,Re,$e[2]].join(" "):_.precision===2?[k(ce),k(de),k(be),k(Re),$e[2]].join(" "):[P(ce),P(de),P(be),P(Re),$e[2]].join(" ");return B},_e=h.__private__.getFilters=function(){return i},Pe=h.__private__.putStream=function(_){var B=(_=_||{}).data||"",ce=_.filters||_e(),de=_.alreadyAppliedFilters||[],be=_.addLength1||!1,Re=B.length,$e=_.objectId,ut=function(Cn){return Cn};if(u!==null&&$e===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(ut=Tn.encryptor($e,0));var pt={};ce===!0&&(ce=["FlateEncode"]);var Dt=_.additionalKeyValues||[],Ht=(pt=mt.API.processDataByFilters!==void 0?mt.API.processDataByFilters(B,ce):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(pt.data.length!==0&&(Dt.push({key:"Length",value:pt.data.length}),be===!0&&Dt.push({key:"Length1",value:Re})),Ht.length!=0)if(Ht.split("/").length-1==1)Dt.push({key:"Filter",value:Ht});else{Dt.push({key:"Filter",value:"["+Ht+"]"});for(var or=0;or<Dt.length;or+=1)if(Dt[or].key==="DecodeParms"){for(var qr=[],wn=0;wn<pt.reverseChain.split("/").length-1;wn+=1)qr.push("null");qr.push(Dt[or].value),Dt[or].value="["+qr.join(" ")+"]"}}J("<<");for(var jr=0;jr<Dt.length;jr++)J("/"+Dt[jr].key+" "+Dt[jr].value);J(">>"),pt.data.length!==0&&(J("stream"),J(ut(pt.data)),J("endstream"))},ke=h.__private__.putPage=function(_){var B=_.number,ce=_.data,de=_.objId,be=_.contentsObjId;H(de,!0),J("<</Type /Page"),J("/Parent "+_.rootDictionaryObjId+" 0 R"),J("/Resources "+_.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(O(_.mediaBox.bottomLeftX))+" "+parseFloat(O(_.mediaBox.bottomLeftY))+" "+O(_.mediaBox.topRightX)+" "+O(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&J("/CropBox ["+O(_.cropBox.bottomLeftX)+" "+O(_.cropBox.bottomLeftY)+" "+O(_.cropBox.topRightX)+" "+O(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&J("/BleedBox ["+O(_.bleedBox.bottomLeftX)+" "+O(_.bleedBox.bottomLeftY)+" "+O(_.bleedBox.topRightX)+" "+O(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&J("/TrimBox ["+O(_.trimBox.bottomLeftX)+" "+O(_.trimBox.bottomLeftY)+" "+O(_.trimBox.topRightX)+" "+O(_.trimBox.topRightY)+"]"),_.artBox!==null&&J("/ArtBox ["+O(_.artBox.bottomLeftX)+" "+O(_.artBox.bottomLeftY)+" "+O(_.artBox.topRightX)+" "+O(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&J("/UserUnit "+_.userUnit),fr.publish("putPage",{objId:de,pageContext:yt[B],pageNumber:B,page:ce}),J("/Contents "+be+" 0 R"),J(">>"),J("endobj");var Re=ce.join(`
`);return S===w&&(Re+=`
Q`),H(be,!0),Pe({data:Re,filters:_e(),objectId:be}),J("endobj"),de},Ee=h.__private__.putPages=function(){var _,B,ce=[];for(_=1;_<=Xt;_++)yt[_].objId=xn(),yt[_].contentsObjId=xn();for(_=1;_<=Xt;_++)ce.push(ke({number:_,data:Le[_],objId:yt[_].objId,contentsObjId:yt[_].contentsObjId,mediaBox:yt[_].mediaBox,cropBox:yt[_].cropBox,bleedBox:yt[_].bleedBox,trimBox:yt[_].trimBox,artBox:yt[_].artBox,userUnit:yt[_].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:re}));H(Q,!0),J("<</Type /Pages");var de="/Kids [";for(B=0;B<Xt;B++)de+=ce[B]+" 0 R ";J(de+"]"),J("/Count "+Xt),J(">>"),J("endobj"),fr.publish("postPutPages")},Te=function(_){fr.publish("putFont",{font:_,out:J,newObject:Mr,putStream:Pe}),_.isAlreadyPutted!==!0&&(_.objectNumber=Mr(),J("<<"),J("/Type /Font"),J("/BaseFont /"+_f(_.postScriptName)),J("/Subtype /Type1"),typeof _.encoding=="string"&&J("/Encoding /"+_.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},qe=function(_){_.objectNumber=Mr();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[O(_.x),O(_.y),O(_.x+_.width),O(_.y+_.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var ce=_.pages[1].join(`
`);Pe({data:ce,additionalKeyValues:B,objectId:_.objectNumber}),J("endobj")},Ye=function(_,B){B||(B=21);var ce=Mr(),de=function($e,ut){var pt,Dt=[],Ht=1/(ut-1);for(pt=0;pt<1;pt+=Ht)Dt.push(pt);if(Dt.push(1),$e[0].offset!=0){var or={offset:0,color:$e[0].color};$e.unshift(or)}if($e[$e.length-1].offset!=1){var qr={offset:1,color:$e[$e.length-1].color};$e.push(qr)}for(var wn="",jr=0,Cn=0;Cn<Dt.length;Cn++){for(pt=Dt[Cn];pt>$e[jr+1].offset;)jr++;var bn=$e[jr].offset,Yn=(pt-bn)/($e[jr+1].offset-bn),Lo=$e[jr].color,ci=$e[jr+1].color;wn+=z(Math.round((1-Yn)*Lo[0]+Yn*ci[0]).toString(16))+z(Math.round((1-Yn)*Lo[1]+Yn*ci[1]).toString(16))+z(Math.round((1-Yn)*Lo[2]+Yn*ci[2]).toString(16))}return wn.trim()}(_.colors,B),be=[];be.push({key:"FunctionType",value:"0"}),be.push({key:"Domain",value:"[0.0 1.0]"}),be.push({key:"Size",value:"["+B+"]"}),be.push({key:"BitsPerSample",value:"8"}),be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Pe({data:de,additionalKeyValues:be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),J("endobj"),_.objectNumber=Mr(),J("<< /ShadingType "+_.type),J("/ColorSpace /DeviceRGB");var Re="/Coords ["+O(parseFloat(_.coords[0]))+" "+O(parseFloat(_.coords[1]))+" ";_.type===2?Re+=O(parseFloat(_.coords[2]))+" "+O(parseFloat(_.coords[3])):Re+=O(parseFloat(_.coords[2]))+" "+O(parseFloat(_.coords[3]))+" "+O(parseFloat(_.coords[4]))+" "+O(parseFloat(_.coords[5])),J(Re+="]"),_.matrix&&J("/Matrix ["+_.matrix.toString()+"]"),J("/Function "+ce+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},tt=function(_,B){var ce=xn(),de=Mr();B.push({resourcesOid:ce,objectOid:de}),_.objectNumber=de;var be=[];be.push({key:"Type",value:"/Pattern"}),be.push({key:"PatternType",value:"1"}),be.push({key:"PaintType",value:"1"}),be.push({key:"TilingType",value:"1"}),be.push({key:"BBox",value:"["+_.boundingBox.map(O).join(" ")+"]"}),be.push({key:"XStep",value:O(_.xStep)}),be.push({key:"YStep",value:O(_.yStep)}),be.push({key:"Resources",value:ce+" 0 R"}),_.matrix&&be.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),Pe({data:_.stream,additionalKeyValues:be,objectId:_.objectNumber}),J("endobj")},Ke=function(_){for(var B in _.objectNumber=Mr(),J("<<"),_)switch(B){case"opacity":J("/ca "+k(_[B]));break;case"stroke-opacity":J("/CA "+k(_[B]))}J(">>"),J("endobj")},Ze=function(_){H(_.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var B in J("/Font <<"),Ct)Ct.hasOwnProperty(B)&&(p===!1||p===!0&&d.hasOwnProperty(B))&&J("/"+B+" "+Ct[B].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(vt).length>0){for(var B in J("/Shading <<"),vt)vt.hasOwnProperty(B)&&vt[B]instanceof nu&&vt[B].objectNumber>=0&&J("/"+B+" "+vt[B].objectNumber+" 0 R");fr.publish("putShadingPatternDict"),J(">>")}}(),function(B){if(Object.keys(vt).length>0){for(var ce in J("/Pattern <<"),vt)vt.hasOwnProperty(ce)&&vt[ce]instanceof h.TilingPattern&&vt[ce].objectNumber>=0&&vt[ce].objectNumber<B&&J("/"+ce+" "+vt[ce].objectNumber+" 0 R");fr.publish("putTilingPatternDict"),J(">>")}}(_.objectOid),function(){if(Object.keys(kt).length>0){var B;for(B in J("/ExtGState <<"),kt)kt.hasOwnProperty(B)&&kt[B].objectNumber>=0&&J("/"+B+" "+kt[B].objectNumber+" 0 R");fr.publish("putGStateDict"),J(">>")}}(),function(){for(var B in J("/XObject <<"),$n)$n.hasOwnProperty(B)&&$n[B].objectNumber>=0&&J("/"+B+" "+$n[B].objectNumber+" 0 R");fr.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},jt=function(_){qt[_.fontName]=qt[_.fontName]||{},qt[_.fontName][_.fontStyle]=_.id},yr=function(_,B,ce,de,be){var Re={id:"F"+(Object.keys(Ct).length+1).toString(10),postScriptName:_,fontName:B,fontStyle:ce,encoding:de,isStandardFont:be||!1,metadata:{}};return fr.publish("addFont",{font:Re,instance:this}),Ct[Re.id]=Re,jt(Re),Re.id},Qt=h.__private__.pdfEscape=h.pdfEscape=function(_,B){return function(ce,de){var be,Re,$e,ut,pt,Dt,Ht,or,qr;if($e=(de=de||{}).sourceEncoding||"Unicode",pt=de.outputEncoding,(de.autoencode||pt)&&Ct[nt].metadata&&Ct[nt].metadata[$e]&&Ct[nt].metadata[$e].encoding&&(ut=Ct[nt].metadata[$e].encoding,!pt&&Ct[nt].encoding&&(pt=Ct[nt].encoding),!pt&&ut.codePages&&(pt=ut.codePages[0]),typeof pt=="string"&&(pt=ut[pt]),pt)){for(Ht=!1,Dt=[],be=0,Re=ce.length;be<Re;be++)(or=pt[ce.charCodeAt(be)])?Dt.push(String.fromCharCode(or)):Dt.push(ce[be]),Dt[be].charCodeAt(0)>>8&&(Ht=!0);ce=Dt.join("")}for(be=ce.length;Ht===void 0&&be!==0;)ce.charCodeAt(be-1)>>8&&(Ht=!0),be--;if(!Ht)return ce;for(Dt=de.noBOM?[]:[254,255],be=0,Re=ce.length;be<Re;be++){if((qr=(or=ce.charCodeAt(be))>>8)>>8)throw new Error("Character at position "+be+" of string '"+ce+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Dt.push(qr),Dt.push(or-(qr<<8))}return String.fromCharCode.apply(void 0,Dt)}(_,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xr=h.__private__.beginPage=function(_){Le[++Xt]=[],yt[Xt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},qi(Xt),Ge(Le[M])},zi=function(_,B){var ce,de,be;switch(r=B||r,typeof _=="string"&&(ce=v(_.toLowerCase()),Array.isArray(ce)&&(de=ce[0],be=ce[1])),Array.isArray(_)&&(de=_[0]*Xe,be=_[1]*Xe),isNaN(de)&&(de=s[0],be=s[1]),(de>14400||be>14400)&&(Nr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),be=Math.min(14400,be)),s=[de,be],r.substr(0,1)){case"l":be>de&&(s=[be,de]);break;case"p":de>be&&(s=[be,de])}Xr(s),Rt(Ud),J(tf),zd!==0&&J(zd+" J"),qd!==0&&J(qd+" j"),fr.publish("addPage",{pageNumber:Xt})},oi=function(_){_>0&&_<=Xt&&(Le.splice(_,1),yt.splice(_,1),Xt--,M>Xt&&(M=Xt),this.setPage(M))},qi=function(_){_>0&&_<=Xt&&(M=_)},Ia=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Le.length-1},yl=function(_,B,ce){var de,be=void 0;return ce=ce||{},_=_!==void 0?_:Ct[nt].fontName,B=B!==void 0?B:Ct[nt].fontStyle,de=_.toLowerCase(),qt[de]!==void 0&&qt[de][B]!==void 0?be=qt[de][B]:qt[_]!==void 0&&qt[_][B]!==void 0?be=qt[_][B]:ce.disableWarning===!1&&Nr.warn("Unable to look up font label for font '"+_+"', '"+B+"'. Refer to getFontList() for available fonts."),be||ce.noFallback||(be=qt.times[B])==null&&(be=qt.times.normal),be},vn=h.__private__.putInfo=function(){var _=Mr(),B=function(de){return de};for(var ce in u!==null&&(B=Tn.encryptor(_,0)),J("<<"),J("/Producer ("+Qt(B("jsPDF "+mt.version))+")"),_t)_t.hasOwnProperty(ce)&&_t[ce]&&J("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+Qt(B(_t[ce]))+")");J("/CreationDate ("+Qt(B(V))+")"),J(">>"),J("endobj")},Qu=h.__private__.putCatalog=function(_){var B=(_=_||{}).rootDictionaryObjId||Q;switch(Mr(),J("<<"),J("/Type /Catalog"),J("/Pages "+B+" 0 R"),ft||(ft="fullwidth"),ft){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+ft;ce.substr(ce.length-1)==="%"&&(ft=parseInt(ft)/100),typeof ft=="number"&&J("/OpenAction [3 0 R /XYZ null null "+k(ft)+"]")}switch(Ft||(Ft="continuous"),Ft){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}ct&&J("/PageMode /"+ct),fr.publish("putCatalog"),J(">>"),J("endobj")},Fx=h.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(te+1)),J("/Root "+te+" 0 R"),J("/Info "+(te-1)+" 0 R"),u!==null&&J("/Encrypt "+Tn.oid+" 0 R"),J("/ID [ <"+se+"> <"+se+"> ]"),J(">>")},yn=h.__private__.putHeader=function(){J("%PDF-"+m),J("%")},jp=h.__private__.putXRef=function(){var _="0000000000";J("xref"),J("0 "+(te+1)),J("0000000000 65535 f ");for(var B=1;B<=te;B++)typeof fe[B]=="function"?J((_+fe[B]()).slice(-10)+" 00000 n "):fe[B]!==void 0?J((_+fe[B]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Hi=h.__private__.buildDocument=function(){var _;te=0,he=0,ge=[],fe=[],pe=[],Q=xn(),re=xn(),Ge(ge),fr.publish("buildDocument"),yn(),Ee(),function(){fr.publish("putAdditionalObjects");for(var ce=0;ce<pe.length;ce++){var de=pe[ce];H(de.objId,!0),J(de.content),J("endobj")}fr.publish("postPutAdditionalObjects")}(),_=[],function(){for(var ce in Ct)Ct.hasOwnProperty(ce)&&(p===!1||p===!0&&d.hasOwnProperty(ce))&&Te(Ct[ce])}(),function(){var ce;for(ce in kt)kt.hasOwnProperty(ce)&&Ke(kt[ce])}(),function(){for(var ce in $n)$n.hasOwnProperty(ce)&&qe($n[ce])}(),function(ce){var de;for(de in vt)vt.hasOwnProperty(de)&&(vt[de]instanceof nu?Ye(vt[de]):vt[de]instanceof Mf&&tt(vt[de],ce))}(_),fr.publish("putResources"),_.forEach(Ze),Ze({resourcesOid:re,objectOid:Number.MAX_SAFE_INTEGER}),fr.publish("postPutResources"),u!==null&&(Tn.oid=Mr(),J("<<"),J("/Filter /Standard"),J("/V "+Tn.v),J("/R "+Tn.r),J("/U <"+Tn.toHexString(Tn.U)+">"),J("/O <"+Tn.toHexString(Tn.O)+">"),J("/P "+Tn.P),J(">>"),J("endobj")),vn(),Qu();var B=he;return jp(),Fx(),J("startxref"),J(""+B),J("%%EOF"),Ge(Le[M]),ge.join(`
`)},Zu=h.__private__.getBlob=function(_){return new Blob([Me(_)],{type:"application/pdf"})},Ap=h.output=h.__private__.output=(Js=function(_,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",_){case void 0:return Hi();case"save":h.save(B.filename);break;case"arraybuffer":return Me(Hi());case"blob":return Zu(Hi());case"bloburi":case"bloburl":if(Pt.URL!==void 0&&typeof Pt.URL.createObjectURL=="function")return Pt.URL&&Pt.URL.createObjectURL(Zu(Hi()))||void 0;Nr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",de=Hi();try{ce=uk(de)}catch{ce=uk(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+B.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Pt)==="[object Window]"){var be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Re=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(be=B.pdfObjectUrl,Re="");var $e='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+be+'"'+Re+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",ut=Pt.open();return ut!==null&&ut.document.write($e),ut}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Pt)==="[object Window]"){var pt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',Dt=Pt.open();if(Dt!==null){Dt.document.write(pt);var Ht=this;Dt.document.documentElement.querySelector("#pdfViewer").onload=function(){Dt.document.title=B.filename,Dt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Ht.output("bloburl"))}}return Dt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Pt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var or='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',qr=Pt.open();if(qr!==null&&(qr.document.write(or),qr.document.title=B.filename),qr||typeof safari>"u")return qr;break;case"datauri":case"dataurl":return Pt.document.location.href=this.output("datauristring",B);default:return null}},Js.foo=function(){try{return Js.apply(this,arguments)}catch(ce){var _=ce.stack||"";~_.indexOf(" at ")&&(_=_.split(" at ")[1]);var B="Error in function "+_.split(`
`)[0].split("<")[0]+": "+ce.message;if(!Pt.console)throw new Error(B);Pt.console.error(B,ce),Pt.alert&&alert(B)}},Js.foo.bar=Js,Js.foo),Ma=function(_){return Array.isArray(ko)===!0&&ko.indexOf(_)>-1};switch(n){case"pt":Xe=1;break;case"mm":Xe=72/25.4;break;case"cm":Xe=72/2.54;break;case"in":Xe=72;break;case"px":Xe=Ma("px_scaling")==1?.75:96/72;break;case"pc":case"em":Xe=12;break;case"ex":Xe=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Xe=n}var Tn=null;ye(),X();var Eo=h.__private__.getPageInfo=h.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:yt[_].objId,pageNumber:_,pageContext:yt[_]}},Tp=h.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in yt)if(yt[B].objId===_)break;return Eo(B)},Lx=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:yt[M].objId,pageNumber:M,pageContext:yt[M]}};h.addPage=function(){return zi.apply(this,arguments),this},h.setPage=function(){return qi.apply(this,arguments),Ge.call(this,Le[M]),this},h.insertPage=function(_){return this.addPage(),this.movePage(M,_),this},h.movePage=function(_,B){var ce,de;if(_>B){ce=Le[_],de=yt[_];for(var be=_;be>B;be--)Le[be]=Le[be-1],yt[be]=yt[be-1];Le[B]=ce,yt[B]=de,this.setPage(B)}else if(_<B){ce=Le[_],de=yt[_];for(var Re=_;Re<B;Re++)Le[Re]=Le[Re+1],yt[Re]=yt[Re+1];Le[B]=ce,yt[B]=de,this.setPage(B)}return this},h.deletePage=function(){return oi.apply(this,arguments),this},h.__private__.text=h.text=function(_,B,ce,de,be){var Re,$e,ut,pt,Dt,Ht,or,qr,wn,jr=(de=de||{}).scope||this;if(typeof _=="number"&&typeof B=="number"&&(typeof ce=="string"||Array.isArray(ce))){var Cn=ce;ce=B,B=_,_=Cn}if(arguments[3]instanceof Et==0?(ut=arguments[4],pt=arguments[5],xr(or=arguments[3])==="object"&&or!==null||(typeof ut=="string"&&(pt=ut,ut=null),typeof or=="string"&&(pt=or,or=null),typeof or=="number"&&(ut=or,or=null),de={flags:or,angle:ut,align:pt})):(C("The transform parameter of text() with a Matrix value"),wn=be),isNaN(B)||isNaN(ce)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return jr;var bn,Yn="",Lo=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:Oc,ci=jr.internal.scaleFactor;function Do(dr){return dr=dr.split("	").join(Array(de.TabLen||9).join(" ")),Qt(dr,or)}function Kd(dr){for(var wr,an=dr.concat(),Pn=[],Io=an.length;Io--;)typeof(wr=an.shift())=="string"?Pn.push(wr):Array.isArray(dr)&&(wr.length===1||wr[1]===void 0&&wr[2]===void 0)?Pn.push(wr[0]):Pn.push([wr[0],wr[1],wr[2]]);return Pn}function nf(dr,wr){var an;if(typeof dr=="string")an=wr(dr)[0];else if(Array.isArray(dr)){for(var Pn,Io,n0=dr.concat(),of=[],Up=n0.length;Up--;)typeof(Pn=n0.shift())=="string"?of.push(wr(Pn)[0]):Array.isArray(Pn)&&typeof Pn[0]=="string"&&(Io=wr(Pn[0],Pn[1],Pn[2]),of.push([Io[0],Io[1],Io[2]]));an=of}return an}var wl=!1,Bc=!0;if(typeof _=="string")wl=!0;else if(Array.isArray(_)){var Uc=_.concat();$e=[];for(var bl,Xn=Uc.length;Xn--;)(typeof(bl=Uc.shift())!="string"||Array.isArray(bl)&&typeof bl[0]!="string")&&(Bc=!1);wl=Bc}if(wl===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var $c=Be/jr.internal.scaleFactor,zc=$c*(Lo-1);switch(de.baseline){case"bottom":ce-=zc;break;case"top":ce+=$c-zc;break;case"hanging":ce+=$c-2*zc;break;case"middle":ce+=$c/2-zc}if((Ht=de.maxWidth||0)>0&&(typeof _=="string"?_=jr.splitTextToSize(_,Ht):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(dr,wr){return dr.concat(jr.splitTextToSize(wr,Ht))},[]))),Re={text:_,x:B,y:ce,options:de,mutex:{pdfEscape:Qt,activeFontKey:nt,fonts:Ct,activeFontSize:Be}},fr.publish("preProcessText",Re),_=Re.text,ut=(de=Re.options).angle,wn instanceof Et==0&&ut&&typeof ut=="number"){ut*=Math.PI/180,de.rotationDirection===0&&(ut=-ut),S===w&&(ut=-ut);var Gd=Math.cos(ut),Yd=Math.sin(ut);wn=new Et(Gd,Yd,-Yd,Gd,0,0)}else ut&&ut instanceof Et&&(wn=ut);S!==w||wn||(wn=ii),(Dt=de.charSpace||To)!==void 0&&(Yn+=O(q(Dt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(qr=de.horizontalScale)!==void 0&&(Yn+=O(100*qr)+` Tz
`),de.lang;var Fs=-1,Oo=de.renderingMode!==void 0?de.renderingMode:de.stroke,sf=jr.internal.getCurrentPageInfo().pageContext;switch(Oo){case 0:case!1:case"fill":Fs=0;break;case 1:case!0:case"stroke":Fs=1;break;case 2:case"fillThenStroke":Fs=2;break;case 3:case"invisible":Fs=3;break;case 4:case"fillAndAddForClipping":Fs=4;break;case 5:case"strokeAndAddPathForClipping":Fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Fs=6;break;case 7:case"addToPathForClipping":Fs=7}var Mp=sf.usedRenderingMode!==void 0?sf.usedRenderingMode:-1;Fs!==-1?Yn+=Fs+` Tr
`:Mp!==-1&&(Yn+=`0 Tr
`),Fs!==-1&&(sf.usedRenderingMode=Fs),pt=de.align||"left";var Ba,qc=Be*Lo,Xd=jr.internal.pageSize.getWidth(),Jd=Ct[nt];Dt=de.charSpace||To,Ht=de.maxWidth||0,or=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Nl=[],Hc=function(dr){return jr.getStringUnitWidth(dr,{font:Jd,charSpace:Dt,fontSize:Be,doKerning:!1})*Be/ci};if(Object.prototype.toString.call(_)==="[object Array]"){var ha;$e=Kd(_),pt!=="left"&&(Ba=$e.map(Hc));var pa,Sl=0;if(pt==="right"){B-=Ba[0],_=[],Xn=$e.length;for(var Ro=0;Ro<Xn;Ro++)Ro===0?(pa=jo(B),ha=Ao(ce)):(pa=q(Sl-Ba[Ro]),ha=-qc),_.push([$e[Ro],pa,ha]),Sl=Ba[Ro]}else if(pt==="center"){B-=Ba[0]/2,_=[],Xn=$e.length;for(var _l=0;_l<Xn;_l++)_l===0?(pa=jo(B),ha=Ao(ce)):(pa=q((Sl-Ba[_l])/2),ha=-qc),_.push([$e[_l],pa,ha]),Sl=Ba[_l]}else if(pt==="left"){_=[],Xn=$e.length;for(var Qd=0;Qd<Xn;Qd++)_.push($e[Qd])}else if(pt==="justify"&&Jd.encoding==="Identity-H"){_=[],Xn=$e.length,Ht=Ht!==0?Ht:Xd;for(var af=0,sn=0;sn<Xn;sn++)if(ha=sn===0?Ao(ce):-qc,pa=sn===0?jo(B):af,sn<Xn-1){var Bp=q((Ht-Ba[sn])/($e[sn].split(" ").length-1)),Vi=$e[sn].split(" ");_.push([Vi[0]+" ",pa,ha]),af=0;for(var Ki=1;Ki<Vi.length;Ki++){var Zd=(Hc(Vi[Ki-1]+" "+Vi[Ki])-Hc(Vi[Ki]))*ci+Bp;Ki==Vi.length-1?_.push([Vi[Ki],Zd,0]):_.push([Vi[Ki]+" ",Zd,0]),af-=Zd}}else _.push([$e[sn],pa,ha]);_.push(["",af,0])}else{if(pt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],Xn=$e.length,Ht=Ht!==0?Ht:Xd,sn=0;sn<Xn;sn++){ha=sn===0?Ao(ce):-qc,pa=sn===0?jo(B):0;var e0=$e[sn].split(" ").length-1,t0=e0>0?(Ht-Ba[sn])/e0:0;sn<Xn-1?Nl.push(O(q(t0))):Nl.push(0),_.push([$e[sn],pa,ha])}}}(typeof de.R2L=="boolean"?de.R2L:gt)===!0&&(_=nf(_,function(dr,wr,an){return[dr.split("").reverse().join(""),wr,an]})),Re={text:_,x:B,y:ce,options:de,mutex:{pdfEscape:Qt,activeFontKey:nt,fonts:Ct,activeFontSize:Be}},fr.publish("postProcessText",Re),_=Re.text,bn=Re.mutex.isHex||!1;var r0=Ct[nt].encoding;r0!=="WinAnsiEncoding"&&r0!=="StandardEncoding"||(_=nf(_,function(dr,wr,an){return[Do(dr),wr,an]})),$e=Kd(_),_=[];for(var kl,El,jl,Wc=Array.isArray($e[0])?1:0,Al="",Vc=function(dr,wr,an){var Pn="";return an instanceof Et?(an=typeof de.angle=="number"?ai(an,new Et(1,0,0,1,dr,wr)):ai(new Et(1,0,0,1,dr,wr),an),S===w&&(an=ai(new Et(1,0,0,-1,0,0),an)),Pn=an.join(" ")+` Tm
`):Pn=O(dr)+" "+O(wr)+` Td
`,Pn},Ua=0;Ua<$e.length;Ua++){switch(Al="",Wc){case 1:jl=(bn?"<":"(")+$e[Ua][0]+(bn?">":")"),kl=parseFloat($e[Ua][1]),El=parseFloat($e[Ua][2]);break;case 0:jl=(bn?"<":"(")+$e[Ua]+(bn?">":")"),kl=jo(B),El=Ao(ce)}Nl!==void 0&&Nl[Ua]!==void 0&&(Al=Nl[Ua]+` Tw
`),Ua===0?_.push(Al+Vc(kl,El,wn)+jl):Wc===0?_.push(Al+jl):Wc===1&&_.push(Al+Vc(kl,El,wn)+jl)}_=Wc===0?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var Gi=`BT
/`;return Gi+=nt+" "+Be+` Tf
`,Gi+=O(Be*Lo)+` TL
`,Gi+=Rc+`
`,Gi+=Yn,Gi+=_,J(Gi+="ET"),d[nt]=!0,jr};var Dx=h.__private__.clip=h.clip=function(_){return J(_==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Dx("evenodd")},h.__private__.discardPath=h.discardPath=function(){return J("n"),this};var Wi=h.__private__.isValidStyle=function(_){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(B=!0),B};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(_){return Wi(_)&&(f=_),this};var Cp=h.__private__.getStyle=h.getStyle=function(_){var B=f;switch(_){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=_}return B},Pp=h.close=function(){return J("h"),this};h.stroke=function(){return J("S"),this},h.fill=function(_){return ef("f",_),this},h.fillEvenOdd=function(_){return ef("f*",_),this},h.fillStroke=function(_){return ef("B",_),this},h.fillStrokeEvenOdd=function(_){return ef("B*",_),this};var ef=function(_,B){xr(B)==="object"?Rx(B,_):J(_)},Dc=function(_){_===null||S===w&&_===void 0||(_=Cp(_),J(_))};function Ox(_,B,ce,de,be){var Re=new Mf(B||this.boundingBox,ce||this.xStep,de||this.yStep,this.gState,be||this.matrix);Re.stream=this.stream;var $e=_+"$$"+this.cloneIndex+++"$$";return us($e,Re),Re}var Rx=function(_,B){var ce=hr[_.key],de=vt[ce];if(de instanceof nu)J("q"),J(Ix(B)),de.gState&&h.setGState(de.gState),J(_.matrix.toString()+" cm"),J("/"+ce+" sh"),J("Q");else if(de instanceof Mf){var be=new Et(1,0,0,-1,0,Mc());_.matrix&&(be=be.multiply(_.matrix||ii),ce=Ox.call(de,_.key,_.boundingBox,_.xStep,_.yStep,be).id),J("q"),J("/Pattern cs"),J("/"+ce+" scn"),de.gState&&h.setGState(de.gState),J(B),J("Q")}},Ix=function(_){switch(_){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Bd=h.moveTo=function(_,B){return J(O(q(_))+" "+O(D(B))+" m"),this},Fp=h.lineTo=function(_,B){return J(O(q(_))+" "+O(D(B))+" l"),this},li=h.curveTo=function(_,B,ce,de,be,Re){return J([O(q(_)),O(D(B)),O(q(ce)),O(D(de)),O(q(be)),O(D(Re)),"c"].join(" ")),this};h.__private__.line=h.line=function(_,B,ce,de,be){if(isNaN(_)||isNaN(B)||isNaN(ce)||isNaN(de)||!Wi(be))throw new Error("Invalid arguments passed to jsPDF.line");return S===b?this.lines([[ce-_,de-B]],_,B,[1,1],be||"S"):this.lines([[ce-_,de-B]],_,B,[1,1]).stroke()},h.__private__.lines=h.lines=function(_,B,ce,de,be,Re){var $e,ut,pt,Dt,Ht,or,qr,wn,jr,Cn,bn,Yn;if(typeof _=="number"&&(Yn=ce,ce=B,B=_,_=Yn),de=de||[1,1],Re=Re||!1,isNaN(B)||isNaN(ce)||!Array.isArray(_)||!Array.isArray(de)||!Wi(be)||typeof Re!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Bd(B,ce),$e=de[0],ut=de[1],Dt=_.length,Cn=B,bn=ce,pt=0;pt<Dt;pt++)(Ht=_[pt]).length===2?(Cn=Ht[0]*$e+Cn,bn=Ht[1]*ut+bn,Fp(Cn,bn)):(or=Ht[0]*$e+Cn,qr=Ht[1]*ut+bn,wn=Ht[2]*$e+Cn,jr=Ht[3]*ut+bn,Cn=Ht[4]*$e+Cn,bn=Ht[5]*ut+bn,li(or,qr,wn,jr,Cn,bn));return Re&&Pp(),Dc(be),this},h.path=function(_){for(var B=0;B<_.length;B++){var ce=_[B],de=ce.c;switch(ce.op){case"m":Bd(de[0],de[1]);break;case"l":Fp(de[0],de[1]);break;case"c":li.apply(this,de);break;case"h":Pp()}}return this},h.__private__.rect=h.rect=function(_,B,ce,de,be){if(isNaN(_)||isNaN(B)||isNaN(ce)||isNaN(de)||!Wi(be))throw new Error("Invalid arguments passed to jsPDF.rect");return S===b&&(de=-de),J([O(q(_)),O(D(B)),O(q(ce)),O(q(de)),"re"].join(" ")),Dc(be),this},h.__private__.triangle=h.triangle=function(_,B,ce,de,be,Re,$e){if(isNaN(_)||isNaN(B)||isNaN(ce)||isNaN(de)||isNaN(be)||isNaN(Re)||!Wi($e))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-_,de-B],[be-ce,Re-de],[_-be,B-Re]],_,B,[1,1],$e,!0),this},h.__private__.roundedRect=h.roundedRect=function(_,B,ce,de,be,Re,$e){if(isNaN(_)||isNaN(B)||isNaN(ce)||isNaN(de)||isNaN(be)||isNaN(Re)||!Wi($e))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var ut=4/3*(Math.SQRT2-1);return be=Math.min(be,.5*ce),Re=Math.min(Re,.5*de),this.lines([[ce-2*be,0],[be*ut,0,be,Re-Re*ut,be,Re],[0,de-2*Re],[0,Re*ut,-be*ut,Re,-be,Re],[2*be-ce,0],[-be*ut,0,-be,-Re*ut,-be,-Re],[0,2*Re-de],[0,-Re*ut,be*ut,-Re,be,-Re]],_+be,B,[1,1],$e,!0),this},h.__private__.ellipse=h.ellipse=function(_,B,ce,de,be){if(isNaN(_)||isNaN(B)||isNaN(ce)||isNaN(de)||!Wi(be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Re=4/3*(Math.SQRT2-1)*ce,$e=4/3*(Math.SQRT2-1)*de;return Bd(_+ce,B),li(_+ce,B-$e,_+Re,B-de,_,B-de),li(_-Re,B-de,_-ce,B-$e,_-ce,B),li(_-ce,B+$e,_-Re,B+de,_,B+de),li(_+Re,B+de,_+ce,B+$e,_+ce,B),Dc(be),this},h.__private__.circle=h.circle=function(_,B,ce,de){if(isNaN(_)||isNaN(B)||isNaN(ce)||!Wi(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,B,ce,ce,de)},h.setFont=function(_,B,ce){return ce&&(B=T(B,ce)),nt=yl(_,B,{disableWarning:!1}),this};var Mx=h.__private__.getFont=h.getFont=function(){return Ct[yl.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var _,B,ce={};for(_ in qt)if(qt.hasOwnProperty(_))for(B in ce[_]=[],qt[_])qt[_].hasOwnProperty(B)&&ce[_].push(B);return ce},h.addFont=function(_,B,ce,de,be){var Re=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Re.indexOf(arguments[3])!==-1?be=arguments[3]:arguments[3]&&Re.indexOf(arguments[3])==-1&&(ce=T(ce,de)),yr.call(this,_,B,ce,be=be||"Identity-H")};var Oc,Ud=e.lineWidth||.200025,Bx=h.__private__.getLineWidth=h.getLineWidth=function(){return Ud},Rt=h.__private__.setLineWidth=h.setLineWidth=function(_){return Ud=_,J(O(q(_))+" w"),this};h.__private__.setLineDash=mt.API.setLineDash=mt.API.setLineDashPattern=function(_,B){if(_=_||[],B=B||0,isNaN(B)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(ce){return O(q(ce))}).join(" "),B=O(q(B)),J("["+_+"] "+B+" d"),this};var Ux=h.__private__.getLineHeight=h.getLineHeight=function(){return Be*Oc};h.__private__.getLineHeight=h.getLineHeight=function(){return Be*Oc};var $x=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(Oc=_),this},zx=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Oc};$x(e.lineHeight);var jo=h.__private__.getHorizontalCoordinate=function(_){return q(_)},Ao=h.__private__.getVerticalCoordinate=function(_){return S===w?_:yt[M].mediaBox.topRightY-yt[M].mediaBox.bottomLeftY-q(_)},qx=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(_){return O(jo(_))},Hx=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(_){return O(Ao(_))},tf=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return le(tf)},h.__private__.setStrokeColor=h.setDrawColor=function(_,B,ce,de){return tf=ue({ch1:_,ch2:B,ch3:ce,ch4:de,pdfColorType:"draw",precision:2}),J(tf),this};var $d=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return le($d)},h.__private__.setFillColor=h.setFillColor=function(_,B,ce,de){return $d=ue({ch1:_,ch2:B,ch3:ce,ch4:de,pdfColorType:"fill",precision:2}),J($d),this};var Rc=e.textColor||"0 g",Wx=h.__private__.getTextColor=h.getTextColor=function(){return le(Rc)};h.__private__.setTextColor=h.setTextColor=function(_,B,ce,de){return Rc=ue({ch1:_,ch2:B,ch3:ce,ch4:de,pdfColorType:"text",precision:3}),this};var To=e.charSpace,Vx=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(To||0)};h.__private__.setCharSpace=h.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return To=_,this};var zd=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(_){var B=h.CapJoinStyles[_];if(B===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return zd=B,J(B+" J"),this};var qd=0;h.__private__.setLineJoin=h.setLineJoin=function(_){var B=h.CapJoinStyles[_];if(B===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qd=B,J(B+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(O(q(_))+" M"),this},h.GState=Mg,h.setGState=function(_){(_=typeof _=="string"?kt[Lt[_]]:Lp(null,_)).equals(Er)||(J("/"+_.id+" gs"),Er=_)};var Lp=function(_,B){if(!_||!Lt[_]){var ce=!1;for(var de in kt)if(kt.hasOwnProperty(de)&&kt[de].equals(B)){ce=!0;break}if(ce)B=kt[de];else{var be="GS"+(Object.keys(kt).length+1).toString(10);kt[be]=B,B.id=be}return _&&(Lt[_]=B.id),fr.publish("addGState",B),B}};h.addGState=function(_,B){return Lp(_,B),this},h.saveGraphicsState=function(){return J("q"),kr.push({key:nt,size:Be,color:Rc}),this},h.restoreGraphicsState=function(){J("Q");var _=kr.pop();return nt=_.key,Be=_.size,Rc=_.color,Er=null,this},h.setCurrentTransformationMatrix=function(_){return J(_.toString()+" cm"),this},h.comment=function(_){return J("#"+_),this};var Co=function(_,B){var ce=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Re){isNaN(Re)||(ce=parseFloat(Re))}});var de=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Re){isNaN(Re)||(de=parseFloat(Re))}});var be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return be},set:function(Re){be=Re.toString()}}),this},Hd=function(_,B,ce,de){Co.call(this,_,B),this.type="rect";var be=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return be},set:function($e){isNaN($e)||(be=parseFloat($e))}});var Re=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Re},set:function($e){isNaN($e)||(Re=parseFloat($e))}}),this},rf=function(){this.page=Xt,this.currentPage=M,this.pages=Le.slice(0),this.pagesContext=yt.slice(0),this.x=Je,this.y=nr,this.matrix=wt,this.width=Vd(M),this.height=Op(M),this.outputDestination=We,this.id="",this.objectNumber=-1};rf.prototype.restore=function(){Xt=this.page,M=this.currentPage,yt=this.pagesContext,Le=this.pages,Je=this.x,nr=this.y,wt=this.matrix,Dp(M,this.width),Po(M,this.height),We=this.outputDestination};var Wd=function(_,B,ce,de,be){Ra.push(new rf),Xt=M=0,Le=[],Je=_,nr=B,wt=be,Xr([ce,de])};for(var Ic in h.beginFormObject=function(_,B,ce,de,be){return Wd(_,B,ce,de,be),this},h.endFormObject=function(_){return function(B){if(si[B])Ra.pop().restore();else{var ce=new rf,de="Xo"+(Object.keys($n).length+1).toString(10);ce.id=de,si[B]=de,$n[de]=ce,fr.publish("addFormObject",ce),Ra.pop().restore()}}(_),this},h.doFormObject=function(_,B){var ce=$n[si[_]];return J("q"),J(B.toString()+" cm"),J("/"+ce.id+" Do"),J("Q"),this},h.getFormObject=function(_){var B=$n[si[_]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},h.save=function(_,B){return _=_||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(tu(Zu(Hi()),_),typeof tu.unload=="function"&&Pt.setTimeout&&setTimeout(tu.unload,911),this):new Promise(function(ce,de){try{var be=tu(Zu(Hi()),_);typeof tu.unload=="function"&&Pt.setTimeout&&setTimeout(tu.unload,911),ce(be)}catch(Re){de(Re.message)}})},mt.API)mt.API.hasOwnProperty(Ic)&&(Ic==="events"&&mt.API.events.length?function(_,B){var ce,de,be;for(be=B.length-1;be!==-1;be--)ce=B[be][0],de=B[be][1],_.subscribe.apply(_,[ce].concat(typeof de=="function"?[de]:de))}(fr,mt.API.events):h[Ic]=mt.API[Ic]);function Vd(_){return yt[_].mediaBox.topRightX-yt[_].mediaBox.bottomLeftX}function Dp(_,B){yt[_].mediaBox.topRightX=B+yt[_].mediaBox.bottomLeftX}function Op(_){return yt[_].mediaBox.topRightY-yt[_].mediaBox.bottomLeftY}function Po(_,B){yt[_].mediaBox.topRightY=B+yt[_].mediaBox.bottomLeftY}var Fo=h.getPageWidth=function(_){return Vd(_=_||M)/Xe},Rp=h.setPageWidth=function(_,B){Dp(_,B*Xe)},Mc=h.getPageHeight=function(_){return Op(_=_||M)/Xe},Ip=h.setPageHeight=function(_,B){Po(_,B*Xe)};return h.internal={pdfEscape:Qt,getStyle:Cp,getFont:Mx,getFontSize:et,getCharSpace:Vx,getTextColor:Wx,getLineHeight:Ux,getLineHeightFactor:zx,getLineWidth:Bx,write:Ue,getHorizontalCoordinate:jo,getVerticalCoordinate:Ao,getCoordinateString:qx,getVerticalCoordinateString:Hx,collections:{},newObject:Mr,newAdditionalObject:oe,newObjectDeferred:xn,newObjectDeferredBegin:H,getFilters:_e,putStream:Pe,events:fr,scaleFactor:Xe,pageSize:{getWidth:function(){return Fo(M)},setWidth:function(_){Rp(M,_)},getHeight:function(){return Mc(M)},setHeight:function(_){Ip(M,_)}},encryptionOptions:u,encryption:Tn,getEncryptor:function(_){return u!==null?Tn.encryptor(_,0):function(B){return B}},output:Ap,getNumberOfPages:Ia,get pages(){return Le},out:J,f2:k,f3:P,getPageInfo:Eo,getPageInfoByObjId:Tp,getCurrentPageInfo:Lx,getPDFVersion:g,Point:Co,Rectangle:Hd,Matrix:Et,hasHotfix:Ma},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Fo(M)},set:function(_){Rp(M,_)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Mc(M)},set:function(_){Ip(M,_)},enumerable:!0,configurable:!0}),(function(_){for(var B=0,ce=rt.length;B<ce;B++){var de=yr.call(this,_[B][0],_[B][1],_[B][2],rt[B][3],!0);p===!1&&(d[de]=!0);var be=_[B][0].split("-");jt({id:de,fontName:be[0],fontStyle:be[1]||""})}fr.publish("addFonts",{fonts:Ct,dictionary:qt})}).call(h,rt),nt="F1",zi(s,r),fr.publish("initialized"),h}Sf.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Sf.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Sf.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Sf.prototype.processOwnerPassword=function(e,t){return Vw(Ww(t).substr(0,5),e)},Sf.prototype.encryptor=function(e,t){var r=Ww(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Vw(r,n)}},Mg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||xr(e)!==xr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},mt.API={events:[]},mt.version="3.0.4";var en=mt.API,t4=1,Ju=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},xf=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Bt=function(e){return e.toFixed(2)},Bl=function(e){return e.toFixed(5)};en.__acroform__={};var da=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},pk=function(e){return e*t4},eo=function(e){var t=new V8,r=lt.internal.getHeight(e)||0,n=lt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Bt(n)),Number(Bt(r))],t},YQ=en.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},XQ=en.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},JQ=en.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},fn=en.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return JQ(e,t-1)},dn=en.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return YQ(e,t-1)},hn=en.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return XQ(e,t-1)},QQ=en.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],a=e[1],i=e[2],o=e[3],c={};return c.lowerLeft_X=r(s)||0,c.lowerLeft_Y=n(a+o)||0,c.upperRight_X=r(s+i)||0,c.upperRight_Y=n(a)||0,[Number(Bt(c.lowerLeft_X)),Number(Bt(c.lowerLeft_Y)),Number(Bt(c.upperRight_X)),Number(Bt(c.upperRight_Y))]},ZQ=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Kw(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+Bt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=eo(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Kw=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(k){return k.split(`
`)}):s.map(function(k){return[k]});var a=r,i=lt.internal.getHeight(e)||0;i=i<0?-i:i;var o=lt.internal.getWidth(e)||0;o=o<0?-o:o;var c=function(k,P,q){if(k+1<s.length){var D=P+" "+s[k+1][0];return Qm(D,e,q).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var f,u,p=Qm("3",e,a).height,d=e.multiline?i-a:(i-p)/2,h=d+=2,m=0,g=0,y=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+Qm(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var v="",b=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var S=!1;if(s[w].length!==1&&y!==s[w].length-1){if((p+2)*(b+2)+2>i)continue e;v+=s[w][y],S=!0,g=w,w--}else{v=(v+=s[w][y]+" ").substr(v.length-1)==" "?v.substr(0,v.length-1):v;var A=parseInt(w),F=c(A,v,a),T=w>=s.length-1;if(F&&!T){v+=" ",y=0;continue}if(F||T){if(T)g=A;else if(e.multiline&&(p+2)*(b+2)+2>i)continue e}else{if(!e.multiline||(p+2)*(b+2)+2>i)continue e;g=A}}for(var O="",C=m;C<=g;C++){var R=s[C];if(e.multiline){if(C===g){O+=R[y]+" ",y=(y+1)%R.length;continue}if(C===m){O+=R[R.length-1]+" ";continue}}O+=R[0]+" "}switch(O=O.substr(O.length-1)==" "?O.substr(0,O.length-1):O,u=Qm(O,e,a).width,e.textAlign){case"right":f=o-u-2;break;case"center":f=(o-u)/2;break;default:f=2}t+=Bt(f)+" "+Bt(h)+` Td
`,t+="("+Ju(O)+`) Tj
`,t+=-Bt(f)+` 0 Td
`,h=-(a+2),u=0,m=S?g:g+1,b++,v=""}break}return n.text=t,n.fontSize=a,n},Qm=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},eZ={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},tZ=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},rZ=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ui.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(eZ)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");t4=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new K8,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&tZ(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],c=[],f=o.Rect;if(o.Rect&&(o.Rect=QQ(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=lt.createDefaultAppearanceStream(o),xr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=f,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=ZQ(o);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var p="";for(var d in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(d)){var h=o.appearanceStreamContent[d];if(p+="/"+d+" ",p+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var i in h)if(h.hasOwnProperty(i)){var m=h[i];typeof m=="function"&&(m=m.call(s,o)),p+="/"+i+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=h)=="function"&&(m=m.call(s,o)),p+="/"+i+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);p+=">>"}c.push({key:"AP",value:`<<
`+p+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:o.objId}),s.internal.out("endobj")}a&&function(g,y){for(var v in g)if(g.hasOwnProperty(v)){var b=v,w=g[v];y.internal.newObjectDeferredBegin(w.objId,!0),xr(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete g[b]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},W8=en.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var s="[",a=0;a<e.length;a++)switch(a!==0&&(s+=" "),xr(e[a])){case"boolean":case"number":case"object":s+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Ju(n(e[a].toString()))+")"):s+=e[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},jv=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Ju(n(e))+")"},uo=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};uo.prototype.toString=function(){return this.objId+" 0 R"},uo.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},uo.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:W8(s,this.objId,this.scope)}):s instanceof uo?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var V8=function(){uo.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};da(V8,uo);var K8=function(){uo.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ju(r(e))+")"}},set:function(r){e=r}})};da(K8,uo);var Ui=function e(){uo.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute F supplied.');t=v}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!fn(t,3)},set:function(v){v?this.F=dn(t,3):this.F=hn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(v){if(isNaN(v))throw new Error('Invalid value "'+v+'" for attribute Ff supplied.');r=v}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(v){n=v!==void 0?v:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(v){n[0]=v}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(v){n[1]=v}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(v){n[2]=v}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(v){n[3]=v}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(v){switch(v){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=v;break;default:throw new Error('Invalid value "'+v+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Bg)return;a="FieldObject"+e.FieldNum++}var v=function(b){return b};return this.scope&&(v=this.scope.internal.getEncryptor(this.objId)),"("+Ju(v(a))+")"},set:function(v){a=v.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(v){a=v}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(v){i=v}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(v){o=v}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(v){c=v}});var f=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return f===void 0?50/t4:f},set:function(v){f=v}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(v){u=v}});var p="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!p||this instanceof Bg||this instanceof ku))return jv(p,this.objId,this.scope)},set:function(v){v=v.toString(),p=v}});var d=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Wn==0?jv(d,this.objId,this.scope):d},set:function(v){v=v.toString(),d=this instanceof Wn==0?v.substr(0,1)==="("?xf(v.substr(1,v.length-2)):xf(v):v}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wn==1?xf(d.substr(1,d.length-1)):d},set:function(v){v=v.toString(),d=this instanceof Wn==1?"/"+v:v}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(v){this.V=v}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Wn==0?jv(h,this.objId,this.scope):h},set:function(v){v=v.toString(),h=this instanceof Wn==0?v.substr(0,1)==="("?xf(v.substr(1,v.length-2)):xf(v):v}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Wn==1?xf(h.substr(1,h.length-1)):h},set:function(v){v=v.toString(),h=this instanceof Wn==1?"/"+v:v}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(v){v=!!v,g=v}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(v){m=v}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,1)},set:function(v){v?this.Ff=dn(this.Ff,1):this.Ff=hn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,2)},set:function(v){v?this.Ff=dn(this.Ff,2):this.Ff=hn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,3)},set:function(v){v?this.Ff=dn(this.Ff,3):this.Ff=hn(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(v){if([0,1,2].indexOf(v)===-1)throw new Error('Invalid value "'+v+'" for attribute Q supplied.');y=v}}),Object.defineProperty(this,"textAlign",{get:function(){var v;switch(y){case 0:default:v="left";break;case 1:v="center";break;case 2:v="right"}return v},configurable:!0,enumerable:!0,set:function(v){switch(v){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};da(Ui,uo);var Zf=function(){Ui.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return W8(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,i,o){o||(o=1);for(var c,f=[];c=i.exec(a);)f.push(c[o]);return f}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,18)},set:function(r){r?this.Ff=dn(this.Ff,18):this.Ff=hn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=dn(this.Ff,19):this.Ff=hn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,20)},set:function(r){r?(this.Ff=dn(this.Ff,20),t.sort()):this.Ff=hn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,22)},set:function(r){r?this.Ff=dn(this.Ff,22):this.Ff=hn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(r){r?this.Ff=dn(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,27)},set:function(r){r?this.Ff=dn(this.Ff,27):this.Ff=hn(this.Ff,27)}}),this.hasAppearanceStream=!1};da(Zf,Ui);var ed=function(){Zf.call(this),this.fontName="helvetica",this.combo=!1};da(ed,Zf);var td=function(){ed.call(this),this.combo=!0};da(td,ed);var L1=function(){td.call(this),this.edit=!0};da(L1,td);var Wn=function(){Ui.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,15)},set:function(r){r?this.Ff=dn(this.Ff,15):this.Ff=hn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,16)},set:function(r){r?this.Ff=dn(this.Ff,16):this.Ff=hn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,17)},set:function(r){r?this.Ff=dn(this.Ff,17):this.Ff=hn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(r){r?this.Ff=dn(this.Ff,26):this.Ff=hn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Ju(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){xr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};da(Wn,Ui);var D1=function(){Wn.call(this),this.pushButton=!0};da(D1,Wn);var rd=function(){Wn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};da(rd,Wn);var Bg=function(){var e,t;Ui.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+Ju(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){xr(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=lt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};da(Bg,Ui),rd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},rd.prototype.createOption=function(e){var t=new Bg;return t.Parent=this,t.optionName=e,this.Kids.push(t),nZ.call(this.scope,t),t};var O1=function(){Wn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=lt.CheckBox.createAppearanceStream()};da(O1,Wn);var ku=function(){Ui.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,13)},set:function(t){t?this.Ff=dn(this.Ff,13):this.Ff=hn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,21)},set:function(t){t?this.Ff=dn(this.Ff,21):this.Ff=hn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,23)},set:function(t){t?this.Ff=dn(this.Ff,23):this.Ff=hn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,24)},set:function(t){t?this.Ff=dn(this.Ff,24):this.Ff=hn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,25)},set:function(t){t?this.Ff=dn(this.Ff,25):this.Ff=hn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,26)},set:function(t){t?this.Ff=dn(this.Ff,26):this.Ff=hn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};da(ku,Ui);var R1=function(){ku.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!fn(this.Ff,14)},set:function(e){e?this.Ff=dn(this.Ff,14):this.Ff=hn(this.Ff,14)}}),this.password=!0};da(R1,ku);var lt={CheckBox:{createAppearanceStream:function(){return{N:{On:lt.CheckBox.YesNormal},D:{On:lt.CheckBox.YesPushDown,Off:lt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),a=Kw(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Bt(lt.internal.getWidth(e))+" "+Bt(lt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Bt(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],a=lt.internal.getHeight(e),i=lt.internal.getWidth(e),o=Kw(e,e.caption);return s.push("1 g"),s.push("0 0 "+Bt(i)+" "+Bt(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Bt(i-1)+" "+Bt(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Bt(o.fontSize)+" Tf "+n),s.push(o.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Bt(lt.internal.getWidth(e))+" "+Bt(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Circle.YesNormal,t.D[e]=lt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=lt.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Bl(lt.internal.getWidth(e)/2)+" "+Bl(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*lt.internal.Bezier_C).toFixed(5)),i=Number((n*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Bl(lt.internal.getWidth(e)/2)+" "+Bl(lt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Bl(lt.internal.getWidth(e)/2)+" "+Bl(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Bl(lt.internal.getWidth(e)/2)+" "+Bl(lt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Cross.YesNormal,t.D[e]=lt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=lt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Bt(lt.internal.getWidth(e)-2)+" "+Bt(lt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Bt(n.x1.x)+" "+Bt(n.x1.y)+" m"),r.push(Bt(n.x2.x)+" "+Bt(n.x2.y)+" l"),r.push(Bt(n.x4.x)+" "+Bt(n.x4.y)+" m"),r.push(Bt(n.x3.x)+" "+Bt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=lt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Bt(lt.internal.getWidth(e))+" "+Bt(lt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Bt(lt.internal.getWidth(e)-2)+" "+Bt(lt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Bt(r.x1.x)+" "+Bt(r.x1.y)+" m"),n.push(Bt(r.x2.x)+" "+Bt(r.x2.y)+" l"),n.push(Bt(r.x4.x)+" "+Bt(r.x4.y)+" m"),n.push(Bt(r.x3.x)+" "+Bt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Bt(lt.internal.getWidth(e))+" "+Bt(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};lt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=lt.internal.getWidth(e),r=lt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},lt.internal.getWidth=function(e){var t=0;return xr(e)==="object"&&(t=pk(e.Rect[2])),t},lt.internal.getHeight=function(e){var t=0;return xr(e)==="object"&&(t=pk(e.Rect[3])),t};var nZ=en.addField=function(e){if(rZ(this,e),!(e instanceof Ui))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};en.AcroFormChoiceField=Zf,en.AcroFormListBox=ed,en.AcroFormComboBox=td,en.AcroFormEditBox=L1,en.AcroFormButton=Wn,en.AcroFormPushButton=D1,en.AcroFormRadioButton=rd,en.AcroFormCheckBox=O1,en.AcroFormTextField=ku,en.AcroFormPasswordField=R1,en.AcroFormAppearance=lt,en.AcroForm={ChoiceField:Zf,ListBox:ed,ComboBox:td,EditBox:L1,Button:Wn,PushButton:D1,RadioButton:rd,CheckBox:O1,TextField:ku,PasswordField:R1,Appearance:lt},mt.AcroForm={ChoiceField:Zf,ListBox:ed,ComboBox:td,EditBox:L1,Button:Wn,PushButton:D1,RadioButton:rd,CheckBox:O1,TextField:ku,PasswordField:R1,Appearance:lt};mt.AcroForm;function G8(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(k,P){var q,D,V,se,ne,X=r;if((P=P||r)==="RGBA"||k.data!==void 0&&k.data instanceof Uint8ClampedArray&&"height"in k&&"width"in k)return"RGBA";if(F(k))for(ne in n)for(V=n[ne],q=0;q<V.length;q+=1){for(se=!0,D=0;D<V[q].length;D+=1)if(V[q][D]!==void 0&&V[q][D]!==k[D]){se=!1;break}if(se===!0){X=ne;break}}else for(ne in n)for(V=n[ne],q=0;q<V.length;q+=1){for(se=!0,D=0;D<V[q].length;D+=1)if(V[q][D]!==void 0&&V[q][D]!==k.charCodeAt(D)){se=!1;break}if(se===!0){X=ne;break}}return X===r&&P!==r&&(X=P),X},a=function k(P){for(var q=this.internal.write,D=this.internal.putStream,V=(0,this.internal.getFilters)();V.indexOf("FlateEncode")!==-1;)V.splice(V.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var se=[];if(se.push({key:"Type",value:"/XObject"}),se.push({key:"Subtype",value:"/Image"}),se.push({key:"Width",value:P.width}),se.push({key:"Height",value:P.height}),P.colorSpace===v.INDEXED?se.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(se.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===v.DEVICE_CMYK&&se.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),se.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&se.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var ne="",X=0,G=P.transparency.length;X<G;X++)ne+=P.transparency[X]+" "+P.transparency[X]+" ";se.push({key:"Mask",value:"["+ne+"]"})}P.sMask!==void 0&&se.push({key:"SMask",value:P.objectId+1+" 0 R"});var ve=P.filter!==void 0?["/"+P.filter]:void 0;if(D({data:P.data,additionalKeyValues:se,alreadyAppliedFilters:ve,objectId:P.objectId}),q("endobj"),"sMask"in P&&P.sMask!==void 0){var ye,E=(ye=P.sMaskBitsPerComponent)!==null&&ye!==void 0?ye:P.bitsPerComponent,M={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:E,data:P.sMask};"filter"in P&&(M.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(E," /Columns ").concat(P.width),M.filter=P.filter),k.call(this,M)}if(P.colorSpace===v.INDEXED){var I=this.internal.newObject();D({data:O(new Uint8Array(P.palette)),objectId:I}),q("endobj")}},i=function(){var k=this.internal.collections[t+"images"];for(var P in k)a.call(this,k[P])},o=function(){var k,P=this.internal.collections[t+"images"],q=this.internal.write;for(var D in P)q("/I"+(k=P[D]).index,k.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},f=function(){var k=this.internal.collections[t+"images"];return c.call(this),k},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},p=function(k){return typeof e["process"+k.toUpperCase()]=="function"},d=function(k){return xr(k)==="object"&&k.nodeType===1},h=function(k,P){if(k.nodeName==="IMG"&&k.hasAttribute("src")){var q=""+k.getAttribute("src");if(q.indexOf("data:image/")===0)return F1(unescape(q).split("base64,").pop());var D=e.loadFile(q,!0);if(D!==void 0)return D}if(k.nodeName==="CANVAS"){if(k.width===0||k.height===0)throw new Error("Given canvas must have data. Canvas width: "+k.width+", height: "+k.height);var V;switch(P){case"PNG":V="image/png";break;case"WEBP":V="image/webp";break;default:V="image/jpeg"}return F1(k.toDataURL(V,1).split("base64,").pop())}},m=function(k){var P=this.internal.collections[t+"images"];if(P){for(var q in P)if(k===P[q].alias)return P[q]}},g=function(k,P,q){return k||P||(k=-96,P=-96),k<0&&(k=-1*q.width*72/k/this.internal.scaleFactor),P<0&&(P=-1*q.height*72/P/this.internal.scaleFactor),k===0&&(k=P*q.width/q.height),P===0&&(P=k*q.height/q.width),[k,P]},y=function(k,P,q,D,V,se){var ne=g.call(this,q,D,V),X=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,ve=f.call(this);if(q=ne[0],D=ne[1],ve[V.index]=V,se){se*=Math.PI/180;var ye=Math.cos(se),E=Math.sin(se),M=function(z){return z.toFixed(4)},I=[M(ye),M(E),M(-1*E),M(ye),0,0,"cm"]}this.internal.write("q"),se?(this.internal.write([1,"0","0",1,X(k),G(P+D),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([X(q),"0","0",X(D),"0","0","cm"].join(" "))):this.internal.write([X(q),"0","0",X(D),X(k),G(P+D),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+V.index+" Do"),this.internal.write("Q")},v=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(k){var P,q,D=0;if(typeof k=="string")for(q=k.length,P=0;P<q;P++)D=(D<<5)-D+k.charCodeAt(P),D|=0;else if(F(k))for(q=k.byteLength/2,P=0;P<q;P++)D=(D<<5)-D+k[P],D|=0;return D},S=e.__addimage__.validateStringAsBase64=function(k){(k=k||"").toString().trim();var P=!0;return k.length===0&&(P=!1),k.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(k.substr(0,k.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(k.substr(-2))===!1&&(P=!1),P},A=e.__addimage__.extractImageFromDataUrl=function(k){if(k==null||!(k=k.trim()).startsWith("data:"))return null;var P=k.indexOf(",");return P<0?null:k.substring(0,P).trim().endsWith("base64")?k.substring(P+1):null};e.__addimage__.isArrayBuffer=function(k){return k instanceof ArrayBuffer};var F=e.__addimage__.isArrayBufferView=function(k){return k instanceof Int8Array||k instanceof Uint8Array||k instanceof Uint8ClampedArray||k instanceof Int16Array||k instanceof Uint16Array||k instanceof Int32Array||k instanceof Uint32Array||k instanceof Float32Array||k instanceof Float64Array},T=e.__addimage__.binaryStringToUint8Array=function(k){for(var P=k.length,q=new Uint8Array(P),D=0;D<P;D++)q[D]=k.charCodeAt(D);return q},O=e.__addimage__.arrayBufferToBinaryString=function(k){for(var P="",q=F(k)?k:new Uint8Array(k),D=0;D<q.length;D+=8192)P+=String.fromCharCode.apply(null,q.subarray(D,D+8192));return P};e.addImage=function(){var k,P,q,D,V,se,ne,X,G;if(typeof arguments[1]=="number"?(P=r,q=arguments[1],D=arguments[2],V=arguments[3],se=arguments[4],ne=arguments[5],X=arguments[6],G=arguments[7]):(P=arguments[1],q=arguments[2],D=arguments[3],V=arguments[4],se=arguments[5],ne=arguments[6],X=arguments[7],G=arguments[8]),xr(k=arguments[0])==="object"&&!d(k)&&"imageData"in k){var ve=k;k=ve.imageData,P=ve.format||P||r,q=ve.x||q||0,D=ve.y||D||0,V=ve.w||ve.width||V,se=ve.h||ve.height||se,ne=ve.alias||ne,X=ve.compression||X,G=ve.rotation||ve.angle||G}var ye=this.internal.getFilters();if(X===void 0&&ye.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(q)||isNaN(D))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var E=C.call(this,k,P,ne,X);return y.call(this,q,D,V,se,E,G),this};var C=function(k,P,q,D){var V,se,ne;if(typeof k=="string"&&s(k)===r){k=unescape(k);var X=R(k,!1);(X!==""||(X=e.loadFile(k,!0))!==void 0)&&(k=X)}if(d(k)&&(k=h(k,P)),P=s(k,P),!p(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((ne=q)==null||ne.length===0)&&(q=function(G){return typeof G=="string"||F(G)?w(G):F(G.data)?w(G.data):null}(k)),(V=m.call(this,q))||(k instanceof Uint8Array||P==="RGBA"||(se=k,k=T(k)),V=this["process"+P.toUpperCase()](k,u.call(this),q,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:b.NONE}(D),se)),!V)throw new Error("An unknown error occurred whilst processing the image.");return V},R=e.__addimage__.convertBase64ToBinaryString=function(k,P){P=typeof P!="boolean"||P;var q,D="";if(typeof k=="string"){var V;q=(V=A(k))!==null&&V!==void 0?V:k;try{D=F1(q)}catch(se){if(P)throw S(q)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+se.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return D};e.getImageProperties=function(k){var P,q,D="";if(d(k)&&(k=h(k)),typeof k=="string"&&s(k)===r&&((D=R(k,!1))===""&&(D=e.loadFile(k)||""),k=D),q=s(k),!p(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(k instanceof Uint8Array||(k=T(k)),!(P=this["process"+q.toUpperCase()](k)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=q,P}})(mt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};mt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),f=r.pageContext.annotations,u=!1,p=0;p<f.length&&!u;p++)switch((n=f[p]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var d=0;d<f.length;d++){n=f[d];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),v=this.internal.getEncryptor(g.objId),b=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(v(n.contents))+")",a+=" /Popup "+y.objId+" 0 R",a+=" /P "+c.objId+" 0 R",a+=" /T ("+h(v(b))+") >>",g.content=a;var w=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+w,n.open&&(a+=" /Open true"),a+=" >>",y.content=a,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var A=this.annotations._nameMap[n.options.name];n.options.pageNumber=A.page,n.options.top=A.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var F=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,a,i){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,f=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:f(n),w:c(r+s),h:f(n+a)},options:i,type:"link"})},e.textWithLink=function(r,n,s,a){var i,o,c=this.getTextWidth(r),f=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var u=this.splitTextToSize(r,o).length;i=Math.ceil(f*u)}else o=c,i=f;return this.text(r,n,s,a),s+=.2*f,a.align==="center"&&(n-=c/2),a.align==="right"&&(n-=c),this.link(n,s-f,o,i,a),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(mt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var f=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length==4},p=e.__arabicParser__.resolveLigatures=function(g){var y=0,v=r,b="",w=0;for(y=0;y<g.length;y+=1)v[g.charCodeAt(y)]!==void 0?(w++,typeof(v=v[g.charCodeAt(y)])=="number"&&(b+=String.fromCharCode(v),v=r,w=0),y===g.length-1&&(v=r,b+=g.charAt(y-(w-1)),y-=w-1,w=0)):(v=r,b+=g.charAt(y-w),y-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var d=e.__arabicParser__.getCorrectForm=function(g,y,v){return i(g)?a(g)===!1?-1:!f(g)||!i(y)&&!i(v)||!i(v)&&o(y)||o(g)&&!i(y)||o(g)&&c(y)||o(g)&&o(y)?0:u(g)&&i(y)&&!o(y)&&i(v)&&f(v)?3:o(g)||!i(v)?1:2:-1},h=function(g){var y=0,v=0,b=0,w="",S="",A="",F=(g=g||"").split("\\s+"),T=[];for(y=0;y<F.length;y+=1){for(T.push(""),v=0;v<F[y].length;v+=1)w=F[y][v],S=F[y][v-1],A=F[y][v+1],i(w)?(b=d(w,S,A),T[y]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):T[y]+=w;T[y]=p(T[y])}return T.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,v=[];if(Array.isArray(y)){var b=0;for(v=[],b=0;b<y.length;b+=1)Array.isArray(y[b])?v.push([h(y[b][0]),y[b][1],y[b][2]]):v.push([h(y[b])]);g=v}else g=h(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(mt.API),mt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(mt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var f=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var p=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var d=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,f){n.call(this);var u=(f=f||{}).fontSize||this.getFontSize(),p=f.font||this.getFont(),d=f.scaleFactor||this.internal.scaleFactor,h=0,m=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var v=f.maxWidth;v>0?typeof c=="string"?c=this.splitTextToSize(c,v):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,S){return w.concat(y.splitTextToSize(S,v))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(g=this.getStringUnitWidth(c[b],{font:p})*u)&&(h=g);return h!==0&&(m=c.length),{w:h/=d,h:Math.max((m*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/d,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var c;c=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var f=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,p=this.internal.__cell__.margins||t,d=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return f.lineNumber!==void 0&&(f.lineNumber===c.lineNumber?(c.x=(f.x||0)+(f.width||0),c.y=f.y||0):f.y+f.height+c.height+p.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=p.top,h&&d&&(this.printHeaderRow(c.lineNumber,!0),c.y+=d[0].height)):c.y=f.y+f.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,f,u,p,d){if(n.call(this),!u)throw new Error("No data for PDF table.");var h,m,g,y,v=[],b=[],w=[],S={},A={},F=[],T=[],O=(d=d||{}).autoSize||!1,C=d.printHeaders!==!1,R=d.css&&d.css["font-size"]!==void 0?16*d.css["font-size"]:d.fontSize||12,k=d.margins||Object.assign({width:this.getPageWidth()},t),P=typeof d.padding=="number"?d.padding:3,q=d.headerBackgroundColor||"#c8c8c8",D=d.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=C,this.internal.__cell__.margins=k,this.internal.__cell__.table_font_size=R,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=D,this.setFontSize(R),p==null)b=v=Object.keys(u[0]),w=v.map(function(){return"left"});else if(Array.isArray(p)&&xr(p[0])==="object")for(v=p.map(function(ve){return ve.name}),b=p.map(function(ve){return ve.prompt||ve.name||""}),w=p.map(function(ve){return ve.align||"left"}),h=0;h<p.length;h+=1)A[p[h].name]=.7499990551181103*p[h].width;else Array.isArray(p)&&typeof p[0]=="string"&&(b=v=p,w=v.map(function(){return"left"}));if(O||Array.isArray(p)&&typeof p[0]=="string")for(h=0;h<v.length;h+=1){for(S[y=v[h]]=u.map(function(ve){return ve[y]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[y],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)F.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);A[y]=Math.max.apply(null,F)+P+P,F=[]}if(C){var V={};for(h=0;h<v.length;h+=1)V[v[h]]={},V[v[h]].text=b[h],V[v[h]].align=w[h];var se=o.call(this,V,A);T=v.map(function(ve){return new a(c,f,A[ve],se,V[ve].text,void 0,V[ve].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var ne=p.reduce(function(ve,ye){return ve[ye.name]=ye.align,ve},{});for(h=0;h<u.length;h+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:h,data:u[h]},this);var X=o.call(this,u[h],A);for(g=0;g<v.length;g+=1){var G=u[h][v[g]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:h,col:g,data:G},this),i.call(this,new a(c,f,A[v[g]],X,G,h+2,ne[v[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=f,this};var o=function(c,f){var u=this.internal.__cell__.padding,p=this.internal.__cell__.table_font_size,d=this.internal.scaleFactor;return Object.keys(c).map(function(h){var m=c[h];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,f[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*p/d+u+u},this).reduce(function(h,m){return Math.max(h,m)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,f){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var p=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(p[0],p[1],p[2],p[3],void 0,-1)}this.setFont(void 0,"bold");for(var d=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),f&&(u.y=this.internal.__cell__.margins.top||0,d.push(u)),u.lineNumber=c;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,u),this.setTextColor(m)}d.length>0&&this.setTableHeaderRow(d),this.setFont(void 0,"normal"),r=!1}}(mt.API);var Y8={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},X8=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Gw=G8(X8),J8=[100,200,300,400,500,600,700,800,900],sZ=G8(J8);function Av(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return Y8[a=a||"normal"]?a:"normal"}(e.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(e.weight),s=function(a){return typeof Gw[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function mk(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var aZ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},gk={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function xk(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function vk(e){return e.trimLeft()}function iZ(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function oZ(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Zm,yk,wk,vf,e1,bk,Nk,Sk,Tv=["times"];function _k(e,t,r,n,s){var a=4,i=Ek;switch(s){case mt.API.image_compression.FAST:a=1,i=kk;break;case mt.API.image_compression.MEDIUM:a=6,i=jk;break;case mt.API.image_compression.SLOW:a=9,i=Ak}e=function(c,f,u,p){for(var d,h=c.length/f,m=new Uint8Array(c.length+h),g=[lZ,kk,Ek,jk,Ak],y=0;y<h;y+=1){var v=y*f,b=c.subarray(v,v+f);if(p)m.set(p(b,u,d),v+y);else{for(var w=g.length,S=[],A=0;A<w;A+=1)S[A]=g[A](b,u,d);var F=uZ(S.concat());m.set(S[F],v+y)}d=b}return m}(e,t,Math.ceil(r*n/8),i);var o=$w(e,{level:a});return mt.API.__addimage__.arrayBufferToBinaryString(o)}function lZ(e){var t=Array.apply([],e);return t.unshift(0),t}function kk(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=e[s-t]||0;n[s+1]=e[s]-a+256&255}return n}function Ek(e,t,r){var n=e.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var i=r&&r[a]||0;s[a+1]=e[a]-i+256&255}return s}function jk(e,t,r){var n=e.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var i=e[a-t]||0,o=r&&r[a]||0;s[a+1]=e[a]+256-(i+o>>>1)&255}return s}function Ak(e,t,r){var n=e.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var i=cZ(e[a-t]||0,r&&r[a]||0,r&&r[a-t]||0);s[a+1]=e[a]-i+256&255}return s}function cZ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),a=Math.abs(e+t-r-r);return n<=s&&n<=a?e:s<=a?t:r}function uZ(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function Cv(e,t,r){var n=t*r,s=Math.floor(n/8),a=16-(n-8*s+r),i=(1<<r)-1;return Q8(e,s)>>a&i}function Tk(e,t,r,n){var s=r*n,a=Math.floor(s/8),i=16-(s-8*a+n),o=(1<<n)-1,c=(t&o)<<i;(function(f,u,p){if(u+1<f.byteLength)f.setUint16(u,p,!1);else{var d=p>>8&255;f.setUint8(u,d)}})(e,a,Q8(e,a)&~(o<<i)&65535|c)}function Q8(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function fZ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],a=s>>7,i=1<<1+(7&s);e[t++],e[t++];var o=null,c=null;a&&(o=t,c=i,t+=3*i);var f=!0,u=[],p=0,d=null,h=0,m=null;for(this.width=r,this.height=n;f&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];p=e[t++]|e[t++]<<8,d=e[t++],1&g||(d=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,S=e[t++],A=S>>6&1,F=1<<1+(7&S),T=o,O=c,C=!1;S>>7&&(C=!0,T=t,O=F,t+=3*F);var R=t;for(t++;;){var k;if(!((k=e[t++])>=0))throw Error("Invalid block size");if(k===0)break;t+=k}u.push({x:y,y:v,width:b,height:w,has_local_palette:C,palette_offset:T,palette_size:O,data_offset:R,data_length:t-R,transparent_index:d,interlaced:!!A,delay:p,disposal:h});break;case 59:f=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=u.length)throw new Error("Frame index out of range.");return u[P]},this.decodeAndBlitFrameBGRA=function(P,q){var D=this.frameInfo(P),V=D.width*D.height,se=new Uint8Array(V);Ck(e,D.data_offset,se,V);var ne=D.palette_offset,X=D.transparent_index;X===null&&(X=256);var G=D.width,ve=r-G,ye=G,E=4*(D.y*r+D.x),M=4*((D.y+D.height)*r+D.x),I=E,z=4*ve;D.interlaced===!0&&(z+=4*r*7);for(var te=8,fe=0,ge=se.length;fe<ge;++fe){var he=se[fe];if(ye===0&&(ye=G,(I+=z)>=M&&(z=4*ve+4*r*(te-1),I=E+(G+ve)*(te<<1),te>>=1)),he===X)I+=4;else{var pe=e[ne+3*he],Le=e[ne+3*he+1],ee=e[ne+3*he+2];q[I++]=ee,q[I++]=Le,q[I++]=pe,q[I++]=255}--ye}},this.decodeAndBlitFrameRGBA=function(P,q){var D=this.frameInfo(P),V=D.width*D.height,se=new Uint8Array(V);Ck(e,D.data_offset,se,V);var ne=D.palette_offset,X=D.transparent_index;X===null&&(X=256);var G=D.width,ve=r-G,ye=G,E=4*(D.y*r+D.x),M=4*((D.y+D.height)*r+D.x),I=E,z=4*ve;D.interlaced===!0&&(z+=4*r*7);for(var te=8,fe=0,ge=se.length;fe<ge;++fe){var he=se[fe];if(ye===0&&(ye=G,(I+=z)>=M&&(z=4*ve+4*r*(te-1),I=E+(G+ve)*(te<<1),te>>=1)),he===X)I+=4;else{var pe=e[ne+3*he],Le=e[ne+3*he+1],ee=e[ne+3*he+2];q[I++]=pe,q[I++]=Le,q[I++]=ee,q[I++]=255}--ye}}}function Ck(e,t,r,n){for(var s=e[t++],a=1<<s,i=a+1,o=i+1,c=s+1,f=(1<<c)-1,u=0,p=0,d=0,h=e[t++],m=new Int32Array(4096),g=null;;){for(;u<16&&h!==0;)p|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<c)break;var y=p&f;if(p>>=c,u-=c,y!==a){if(y===i)break;for(var v=y<o?y:g,b=0,w=v;w>a;)w=m[w]>>8,++b;var S=w;if(d+b+(v!==y?1:0)>n)return void Nr.log("Warning, gif stream longer than expected.");r[d++]=S;var A=d+=b;for(v!==y&&(r[d++]=S),w=v;b--;)w=m[w],r[--A]=255&w,w>>=8;g!==null&&o<4096&&(m[o++]=g<<8|S,o>=f+1&&c<12&&(++c,f=f<<1|1)),g=y}else o=i+1,f=(1<<(c=s+1))-1,g=null}return d!==n&&Nr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Pv(e){var t,r,n,s,a,i=Math.floor,o=new Array(64),c=new Array(64),f=new Array(64),u=new Array(64),p=new Array(65535),d=new Array(65535),h=new Array(64),m=new Array(64),g=[],y=0,v=7,b=new Array(64),w=new Array(64),S=new Array(64),A=new Array(256),F=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],O=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],R=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],D=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],V=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function se(E,M){for(var I=0,z=0,te=new Array,fe=1;fe<=16;fe++){for(var ge=1;ge<=E[fe];ge++)te[M[z]]=[],te[M[z]][0]=I,te[M[z]][1]=fe,z++,I++;I*=2}return te}function ne(E){for(var M=E[0],I=E[1]-1;I>=0;)M&1<<I&&(y|=1<<v),I--,--v<0&&(y==255?(X(255),X(0)):X(y),v=7,y=0)}function X(E){g.push(E)}function G(E){X(E>>8&255),X(255&E)}function ve(E,M,I,z,te){for(var fe,ge=te[0],he=te[240],pe=function(Be,ft){var et,gt,ct,Mt,Ft,St,Kt,_t,nt,Xe,Je=0;for(nt=0;nt<8;++nt){et=Be[Je],gt=Be[Je+1],ct=Be[Je+2],Mt=Be[Je+3],Ft=Be[Je+4],St=Be[Je+5],Kt=Be[Je+6];var nr=et+(_t=Be[Je+7]),wt=et-_t,Ct=gt+Kt,qt=gt-Kt,kr=ct+St,vt=ct-St,hr=Mt+Ft,kt=Mt-Ft,Lt=nr+hr,Er=nr-hr,Xt=Ct+kr,yt=Ct-kr;Be[Je]=Lt+Xt,Be[Je+4]=Lt-Xt;var fr=.707106781*(yt+Er);Be[Je+2]=Er+fr,Be[Je+6]=Er-fr;var ko=.382683433*((Lt=kt+vt)-(yt=qt+wt)),$n=.5411961*Lt+ko,si=1.306562965*yt+ko,Ra=.707106781*(Xt=vt+qt),Et=wt+Ra,ai=wt-Ra;Be[Je+5]=ai+$n,Be[Je+3]=ai-$n,Be[Je+1]=Et+si,Be[Je+7]=Et-si,Je+=8}for(Je=0,nt=0;nt<8;++nt){et=Be[Je],gt=Be[Je+8],ct=Be[Je+16],Mt=Be[Je+24],Ft=Be[Je+32],St=Be[Je+40],Kt=Be[Je+48];var ii=et+(_t=Be[Je+56]),us=et-_t,Js=gt+Kt,Mr=gt-Kt,xn=ct+St,H=ct-St,oe=Mt+Ft,Q=Mt-Ft,re=ii+oe,le=ii-oe,ue=Js+xn,_e=Js-xn;Be[Je]=re+ue,Be[Je+32]=re-ue;var Pe=.707106781*(_e+le);Be[Je+16]=le+Pe,Be[Je+48]=le-Pe;var ke=.382683433*((re=Q+H)-(_e=Mr+us)),Ee=.5411961*re+ke,Te=1.306562965*_e+ke,qe=.707106781*(ue=H+Mr),Ye=us+qe,tt=us-qe;Be[Je+40]=tt+Ee,Be[Je+24]=tt-Ee,Be[Je+8]=Ye+Te,Be[Je+56]=Ye-Te,Je++}for(nt=0;nt<64;++nt)Xe=Be[nt]*ft[nt],h[nt]=Xe>0?Xe+.5|0:Xe-.5|0;return h}(E,M),Le=0;Le<64;++Le)m[T[Le]]=pe[Le];var ee=m[0]-I;I=m[0],ee==0?ne(z[0]):(ne(z[d[fe=32767+ee]]),ne(p[fe]));for(var We=63;We>0&&m[We]==0;)We--;if(We==0)return ne(ge),I;for(var Ge,J=1;J<=We;){for(var Ue=J;m[J]==0&&J<=We;)++J;var Me=J-Ue;if(Me>=16){Ge=Me>>4;for(var rt=1;rt<=Ge;++rt)ne(he);Me&=15}fe=32767+m[J],ne(te[(Me<<4)+d[fe]]),ne(p[fe]),J++}return We!=63&&ne(ge),I}function ye(E){E=Math.min(Math.max(E,1),100),a!=E&&(function(M){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],z=0;z<64;z++){var te=i((I[z]*M+50)/100);te=Math.min(Math.max(te,1),255),o[T[z]]=te}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ge=0;ge<64;ge++){var he=i((fe[ge]*M+50)/100);he=Math.min(Math.max(he,1),255),c[T[ge]]=he}for(var pe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Le=0,ee=0;ee<8;ee++)for(var We=0;We<8;We++)f[Le]=1/(o[T[Le]]*pe[ee]*pe[We]*8),u[Le]=1/(c[T[Le]]*pe[ee]*pe[We]*8),Le++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),a=E)}this.encode=function(E,M){M&&ye(M),g=new Array,y=0,v=7,G(65496),G(65504),G(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),G(1),G(1),X(0),X(0),function(){G(65499),G(132),X(0);for(var gt=0;gt<64;gt++)X(o[gt]);X(1);for(var ct=0;ct<64;ct++)X(c[ct])}(),function(gt,ct){G(65472),G(17),X(8),G(ct),G(gt),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}(E.width,E.height),function(){G(65476),G(418),X(0);for(var gt=0;gt<16;gt++)X(O[gt+1]);for(var ct=0;ct<=11;ct++)X(C[ct]);X(16);for(var Mt=0;Mt<16;Mt++)X(R[Mt+1]);for(var Ft=0;Ft<=161;Ft++)X(k[Ft]);X(1);for(var St=0;St<16;St++)X(P[St+1]);for(var Kt=0;Kt<=11;Kt++)X(q[Kt]);X(17);for(var _t=0;_t<16;_t++)X(D[_t+1]);for(var nt=0;nt<=161;nt++)X(V[nt])}(),G(65498),G(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var I=0,z=0,te=0;y=0,v=7,this.encode.displayName="_encode_";for(var fe,ge,he,pe,Le,ee,We,Ge,J,Ue=E.data,Me=E.width,rt=E.height,Be=4*Me,ft=0;ft<rt;){for(fe=0;fe<Be;){for(Le=Be*ft+fe,We=-1,Ge=0,J=0;J<64;J++)ee=Le+(Ge=J>>3)*Be+(We=4*(7&J)),ft+Ge>=rt&&(ee-=Be*(ft+1+Ge-rt)),fe+We>=Be&&(ee-=fe+We-Be+4),ge=Ue[ee++],he=Ue[ee++],pe=Ue[ee++],b[J]=(F[ge]+F[he+256|0]+F[pe+512|0]>>16)-128,w[J]=(F[ge+768|0]+F[he+1024|0]+F[pe+1280|0]>>16)-128,S[J]=(F[ge+1280|0]+F[he+1536|0]+F[pe+1792|0]>>16)-128;I=ve(b,f,I,t,n),z=ve(w,u,z,r,s),te=ve(S,u,te,r,s),fe+=32}ft+=8}if(v>=0){var et=[];et[1]=v+1,et[0]=(1<<v+1)-1,ne(et)}return G(65497),new Uint8Array(g)},e=e||50,function(){for(var E=String.fromCharCode,M=0;M<256;M++)A[M]=E(M)}(),t=se(O,C),r=se(P,q),n=se(R,k),s=se(D,V),function(){for(var E=1,M=2,I=1;I<=15;I++){for(var z=E;z<M;z++)d[32767+z]=I,p[32767+z]=[],p[32767+z][1]=I,p[32767+z][0]=z;for(var te=-(M-1);te<=-E;te++)d[32767+te]=I,p[32767+te]=[],p[32767+te][1]=I,p[32767+te][0]=M-1+te;E<<=1,M<<=1}}(),function(){for(var E=0;E<256;E++)F[E]=19595*E,F[E+256|0]=38470*E,F[E+512|0]=7471*E+32768,F[E+768|0]=-11059*E,F[E+1024|0]=-21709*E,F[E+1280|0]=32768*E+8421375,F[E+1536|0]=-27439*E,F[E+1792|0]=-5329*E}(),ye(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function gi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Pk(e){function t(C){if(!C)throw Error("assert :P")}function r(C,R,k){for(var P=0;4>P;P++)if(C[R+P]!=k.charCodeAt(P))return!0;return!1}function n(C,R,k,P,q){for(var D=0;D<q;D++)C[R+D]=k[P+D]}function s(C,R,k,P){for(var q=0;q<P;q++)C[R+q]=k}function a(C){return new Int32Array(C)}function i(C,R){for(var k=[],P=0;P<C;P++)k.push(new R);return k}function o(C,R){var k=[];return function P(q,D,V){for(var se=V[D],ne=0;ne<se&&(q.push(V.length>D+1?[]:new R),!(V.length<D+1));ne++)P(q[ne],D+1,V)}(k,0,C),k}var c=function(){var C=this;function R(x,N){for(var j=1<<N-1>>>0;x&j;)j>>>=1;return j?(x&j-1)+j:x}function k(x,N,j,L,U){t(!(L%j));do x[N+(L-=j)]=U;while(0<L)}function P(x,N,j,L,U){if(t(2328>=U),512>=U)var W=a(512);else if((W=a(U))==null)return 0;return function(K,Y,Z,ae,xe,Ae){var ie,we,Ne=Y,Fe=1<<Z,je=a(16),De=a(16);for(t(xe!=0),t(ae!=null),t(K!=null),t(0<Z),we=0;we<xe;++we){if(15<ae[we])return 0;++je[ae[we]]}if(je[0]==xe)return 0;for(De[1]=0,ie=1;15>ie;++ie){if(je[ie]>1<<ie)return 0;De[ie+1]=De[ie]+je[ie]}for(we=0;we<xe;++we)ie=ae[we],0<ae[we]&&(Ae[De[ie]++]=we);if(De[15]==1)return(ae=new q).g=0,ae.value=Ae[0],k(K,Ne,1,Fe,ae),Fe;var Ie,He=-1,ze=Fe-1,xt=0,ot=1,Gt=1,dt=1<<Z;for(we=0,ie=1,xe=2;ie<=Z;++ie,xe<<=1){if(ot+=Gt<<=1,0>(Gt-=je[ie]))return 0;for(;0<je[ie];--je[ie])(ae=new q).g=ie,ae.value=Ae[we++],k(K,Ne+xt,xe,dt,ae),xt=R(xt,ie)}for(ie=Z+1,xe=2;15>=ie;++ie,xe<<=1){if(ot+=Gt<<=1,0>(Gt-=je[ie]))return 0;for(;0<je[ie];--je[ie]){if(ae=new q,(xt&ze)!=He){for(Ne+=dt,Ie=1<<(He=ie)-Z;15>He&&!(0>=(Ie-=je[He]));)++He,Ie<<=1;Fe+=dt=1<<(Ie=He-Z),K[Y+(He=xt&ze)].g=Ie+Z,K[Y+He].value=Ne-Y-He}ae.g=ie-Z,ae.value=Ae[we++],k(K,Ne+(xt>>Z),xe,dt,ae),xt=R(xt,ie)}}return ot!=2*De[15]-1?0:Fe}(x,N,j,L,U,W)}function q(){this.value=this.g=0}function D(){this.value=this.g=0}function V(){this.G=i(5,q),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Hc,D)}function se(x,N,j,L){t(x!=null),t(N!=null),t(2147483648>L),x.Ca=254,x.I=0,x.b=-8,x.Ka=0,x.oa=N,x.pa=j,x.Jd=N,x.Yc=j+L,x.Zc=4<=L?j+L-4+1:j,ge(x)}function ne(x,N){for(var j=0;0<N--;)j|=pe(x,128)<<N;return j}function X(x,N){var j=ne(x,N);return he(x)?-j:j}function G(x,N,j,L){var U,W=0;for(t(x!=null),t(N!=null),t(4294967288>L),x.Sb=L,x.Ra=0,x.u=0,x.h=0,4<L&&(L=4),U=0;U<L;++U)W+=N[j+U]<<8*U;x.Ra=W,x.bb=L,x.oa=N,x.pa=j}function ve(x){for(;8<=x.u&&x.bb<x.Sb;)x.Ra>>>=8,x.Ra+=x.oa[x.pa+x.bb]<<Sl-8>>>0,++x.bb,x.u-=8;z(x)&&(x.h=1,x.u=0)}function ye(x,N){if(t(0<=N),!x.h&&N<=pa){var j=I(x)&ha[N];return x.u+=N,ve(x),j}return x.h=1,x.u=0}function E(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function M(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(x){return x.Ra>>>(x.u&Sl-1)>>>0}function z(x){return t(x.bb<=x.Sb),x.h||x.bb==x.Sb&&x.u>Sl}function te(x,N){x.u=N,x.h=z(x)}function fe(x){x.u>=Ro&&(t(x.u>=Ro),ve(x))}function ge(x){t(x!=null&&x.oa!=null),x.pa<x.Zc?(x.I=(x.oa[x.pa++]|x.I<<8)>>>0,x.b+=8):(t(x!=null&&x.oa!=null),x.pa<x.Yc?(x.b+=8,x.I=x.oa[x.pa++]|x.I<<8):x.Ka?x.b=0:(x.I<<=8,x.b+=8,x.Ka=1))}function he(x){return ne(x,1)}function pe(x,N){var j=x.Ca;0>x.b&&ge(x);var L=x.b,U=j*N>>>8,W=(x.I>>>L>U)+0;for(W?(j-=U,x.I-=U+1<<L>>>0):j=U+1,L=j,U=0;256<=L;)U+=8,L>>=8;return L=7^U+_l[L],x.b-=L,x.Ca=(j<<L)-1,W}function Le(x,N,j){x[N+0]=j>>24&255,x[N+1]=j>>16&255,x[N+2]=j>>8&255,x[N+3]=255&j}function ee(x,N){return x[N+0]|x[N+1]<<8}function We(x,N){return ee(x,N)|x[N+2]<<16}function Ge(x,N){return ee(x,N)|ee(x,N+2)<<16}function J(x,N){var j=1<<N;return t(x!=null),t(0<N),x.X=a(j),x.X==null?0:(x.Mb=32-N,x.Xa=N,1)}function Ue(x,N){t(x!=null),t(N!=null),t(x.Xa==N.Xa),n(N.X,0,x.X,0,1<<N.Xa)}function Me(){this.X=[],this.Xa=this.Mb=0}function rt(x,N,j,L){t(j!=null),t(L!=null);var U=j[0],W=L[0];return U==0&&(U=(x*W+N/2)/N),W==0&&(W=(N*U+x/2)/x),0>=U||0>=W?0:(j[0]=U,L[0]=W,1)}function Be(x,N){return x+(1<<N)-1>>>N}function ft(x,N){return((4278255360&x)+(4278255360&N)>>>0&4278255360)+((16711935&x)+(16711935&N)>>>0&16711935)>>>0}function et(x,N){C[N]=function(j,L,U,W,K,Y,Z){var ae;for(ae=0;ae<K;++ae){var xe=C[x](Y[Z+ae-1],U,W+ae);Y[Z+ae]=ft(j[L+ae],xe)}}}function gt(){this.ud=this.hd=this.jd=0}function ct(x,N){return((4278124286&(x^N))>>>1)+(x&N)>>>0}function Mt(x){return 0<=x&&256>x?x:0>x?0:255<x?255:void 0}function Ft(x,N){return Mt(x+(x-N+.5>>1))}function St(x,N,j){return Math.abs(N-j)-Math.abs(x-j)}function Kt(x,N,j,L,U,W,K){for(L=W[K-1],j=0;j<U;++j)W[K+j]=L=ft(x[N+j],L)}function _t(x,N,j,L,U){var W;for(W=0;W<j;++W){var K=x[N+W],Y=K>>8&255,Z=16711935&(Z=(Z=16711935&K)+((Y<<16)+Y));L[U+W]=(4278255360&K)+Z>>>0}}function nt(x,N){N.jd=255&x,N.hd=x>>8&255,N.ud=x>>16&255}function Xe(x,N,j,L,U,W){var K;for(K=0;K<L;++K){var Y=N[j+K],Z=Y>>>8,ae=Y,xe=255&(xe=(xe=Y>>>16)+((x.jd<<24>>24)*(Z<<24>>24)>>>5));ae=255&(ae=(ae+=(x.hd<<24>>24)*(Z<<24>>24)>>>5)+((x.ud<<24>>24)*(xe<<24>>24)>>>5)),U[W+K]=(4278255360&Y)+(xe<<16)+ae}}function Je(x,N,j,L,U){C[N]=function(W,K,Y,Z,ae,xe,Ae,ie,we){for(Z=Ae;Z<ie;++Z)for(Ae=0;Ae<we;++Ae)ae[xe++]=U(Y[L(W[K++])])},C[x]=function(W,K,Y,Z,ae,xe,Ae){var ie=8>>W.b,we=W.Ea,Ne=W.K[0],Fe=W.w;if(8>ie)for(W=(1<<W.b)-1,Fe=(1<<ie)-1;K<Y;++K){var je,De=0;for(je=0;je<we;++je)je&W||(De=L(Z[ae++])),xe[Ae++]=U(Ne[De&Fe]),De>>=ie}else C["VP8LMapColor"+j](Z,ae,Ne,Fe,xe,Ae,K,Y,we)}}function nr(x,N,j,L,U){for(j=N+j;N<j;){var W=x[N++];L[U++]=W>>16&255,L[U++]=W>>8&255,L[U++]=255&W}}function wt(x,N,j,L,U){for(j=N+j;N<j;){var W=x[N++];L[U++]=W>>16&255,L[U++]=W>>8&255,L[U++]=255&W,L[U++]=W>>24&255}}function Ct(x,N,j,L,U){for(j=N+j;N<j;){var W=(K=x[N++])>>16&240|K>>12&15,K=240&K|K>>28&15;L[U++]=W,L[U++]=K}}function qt(x,N,j,L,U){for(j=N+j;N<j;){var W=(K=x[N++])>>16&248|K>>13&7,K=K>>5&224|K>>3&31;L[U++]=W,L[U++]=K}}function kr(x,N,j,L,U){for(j=N+j;N<j;){var W=x[N++];L[U++]=255&W,L[U++]=W>>8&255,L[U++]=W>>16&255}}function vt(x,N,j,L,U,W){if(W==0)for(j=N+j;N<j;)Le(L,((W=x[N++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),U+=32;else n(L,U,x,N,j)}function hr(x,N){C[N][0]=C[x+"0"],C[N][1]=C[x+"1"],C[N][2]=C[x+"2"],C[N][3]=C[x+"3"],C[N][4]=C[x+"4"],C[N][5]=C[x+"5"],C[N][6]=C[x+"6"],C[N][7]=C[x+"7"],C[N][8]=C[x+"8"],C[N][9]=C[x+"9"],C[N][10]=C[x+"10"],C[N][11]=C[x+"11"],C[N][12]=C[x+"12"],C[N][13]=C[x+"13"],C[N][14]=C[x+"0"],C[N][15]=C[x+"0"]}function kt(x){return x==Yx||x==Xx||x==Vp||x==Jx}function Lt(){this.eb=[],this.size=this.A=this.fb=0}function Er(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Xt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Lt,this.f.kb=new Er,this.sd=null}function yt(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function fr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ko(x){return alert("todo:WebPSamplerProcessPlane"),x.T}function $n(x,N){var j=x.T,L=N.ba.f.RGBA,U=L.eb,W=L.fb+x.ka*L.A,K=za[N.ba.S],Y=x.y,Z=x.O,ae=x.f,xe=x.N,Ae=x.ea,ie=x.W,we=N.cc,Ne=N.dc,Fe=N.Mc,je=N.Nc,De=x.ka,Ie=x.ka+x.T,He=x.U,ze=He+1>>1;for(De==0?K(Y,Z,null,null,ae,xe,Ae,ie,ae,xe,Ae,ie,U,W,null,null,He):(K(N.ec,N.fc,Y,Z,we,Ne,Fe,je,ae,xe,Ae,ie,U,W-L.A,U,W,He),++j);De+2<Ie;De+=2)we=ae,Ne=xe,Fe=Ae,je=ie,xe+=x.Rc,ie+=x.Rc,W+=2*L.A,K(Y,(Z+=2*x.fa)-x.fa,Y,Z,we,Ne,Fe,je,ae,xe,Ae,ie,U,W-L.A,U,W,He);return Z+=x.fa,x.j+Ie<x.o?(n(N.ec,N.fc,Y,Z,He),n(N.cc,N.dc,ae,xe,ze),n(N.Mc,N.Nc,Ae,ie,ze),j--):1&Ie||K(Y,Z,null,null,ae,xe,Ae,ie,ae,xe,Ae,ie,U,W+L.A,null,null,He),j}function si(x,N,j){var L=x.F,U=[x.J];if(L!=null){var W=x.U,K=N.ba.S,Y=K==Wp||K==Vp;N=N.ba.f.RGBA;var Z=[0],ae=x.ka;Z[0]=x.T,x.Kb&&(ae==0?--Z[0]:(--ae,U[0]-=x.width),x.j+x.ka+x.T==x.o&&(Z[0]=x.o-x.j-ae));var xe=N.eb;ae=N.fb+ae*N.A,x=c4(L,U[0],x.width,W,Z,xe,ae+(Y?0:3),N.A),t(j==Z),x&&kt(K)&&s0(xe,ae,Y,W,Z,N.A)}return 0}function Ra(x){var N=x.ma,j=N.ba.S,L=11>j,U=j==qp||j==Hp||j==Wp||j==Gx||j==12||kt(j);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!Xd(N.Oa,x,U?11:12))return 0;if(U&&kt(j)&&Kd(),x.da)alert("todo:use_scaling");else{if(L){if(N.Ib=ko,x.Kb){if(j=x.U+1>>1,N.memory=a(x.U+2*j),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+x.U,N.Mc=N.cc,N.Nc=N.dc+j,N.Ib=$n,Kd()}}else alert("todo:EmitYUV");U&&(N.Jb=si,L&&ci())}if(L&&!k4){for(x=0;256>x;++x)RP[x]=89858*(x-128)+Gp>>Kp,BP[x]=-22014*(x-128)+Gp,MP[x]=-45773*(x-128),IP[x]=113618*(x-128)+Gp>>Kp;for(x=i0;x<e2;++x)N=76283*(x-16)+Gp>>Kp,UP[x-i0]=vn(N,255),$P[x-i0]=vn(N+8>>4,15);k4=1}return 1}function Et(x){var N=x.ma,j=x.U,L=x.T;return t(!(1&x.ka)),0>=j||0>=L?0:(j=N.Ib(x,N),N.Jb!=null&&N.Jb(x,N,j),N.Dc+=j,1)}function ai(x){x.ma.memory=null}function ii(x,N,j,L){return ye(x,8)!=47?0:(N[0]=ye(x,14)+1,j[0]=ye(x,14)+1,L[0]=ye(x,1),ye(x,3)!=0?0:!x.h)}function us(x,N){if(4>x)return x+1;var j=x-2>>1;return(2+(1&x)<<j)+ye(N,j)+1}function Js(x,N){return 120<N?N-120:1<=(j=((j=NP[N-1])>>4)*x+(8-(15&j)))?j:1;var j}function Mr(x,N,j){var L=I(j),U=x[N+=255&L].g-8;return 0<U&&(te(j,j.u+8),L=I(j),N+=x[N].value,N+=L&(1<<U)-1),te(j,j.u+x[N].g),x[N].value}function xn(x,N,j){return j.g+=x.g,j.value+=x.value<<N>>>0,t(8>=j.g),x.g}function H(x,N,j){var L=x.xc;return t((N=L==0?0:x.vc[x.md*(j>>L)+(N>>L)])<x.Wb),x.Ya[N]}function oe(x,N,j,L){var U=x.ab,W=x.c*N,K=x.C;N=K+N;var Y=j,Z=L;for(L=x.Ta,j=x.Ua;0<U--;){var ae=x.gc[U],xe=K,Ae=N,ie=Y,we=Z,Ne=(Z=L,Y=j,ae.Ea);switch(t(xe<Ae),t(Ae<=ae.nc),ae.hc){case 2:sn(ie,we,(Ae-xe)*Ne,Z,Y);break;case 0:var Fe=xe,je=Ae,De=Z,Ie=Y,He=(dt=ae).Ea;Fe==0&&(Qd(ie,we,null,null,1,De,Ie),Kt(ie,we+1,0,0,He-1,De,Ie+1),we+=He,Ie+=He,++Fe);for(var ze=1<<dt.b,xt=ze-1,ot=Be(He,dt.b),Gt=dt.K,dt=dt.w+(Fe>>dt.b)*ot;Fe<je;){var Zt=Gt,Fn=dt,Yt=1;for(af(ie,we,De,Ie-He,1,De,Ie);Yt<He;){var ht=(Yt&~xt)+ze;ht>He&&(ht=He),(0,e0[Zt[Fn++]>>8&15])(ie,we+ +Yt,De,Ie+Yt-He,ht-Yt,De,Ie+Yt),Yt=ht}we+=He,Ie+=He,++Fe&xt||(dt+=ot)}Ae!=ae.nc&&n(Z,Y-Ne,Z,Y+(Ae-xe-1)*Ne,Ne);break;case 1:for(Ne=ie,je=we,He=(ie=ae.Ea)-(Ie=ie&~(De=(we=1<<ae.b)-1)),Fe=Be(ie,ae.b),ze=ae.K,ae=ae.w+(xe>>ae.b)*Fe;xe<Ae;){for(xt=ze,ot=ae,Gt=new gt,dt=je+Ie,Zt=je+ie;je<dt;)nt(xt[ot++],Gt),t0(Gt,Ne,je,we,Z,Y),je+=we,Y+=we;je<Zt&&(nt(xt[ot++],Gt),t0(Gt,Ne,je,He,Z,Y),je+=He,Y+=He),++xe&De||(ae+=Fe)}break;case 3:if(ie==Z&&we==Y&&0<ae.b){for(je=Z,ie=Ne=Y+(Ae-xe)*Ne-(Ie=(Ae-xe)*Be(ae.Ea,ae.b)),we=Z,De=Y,Fe=[],Ie=(He=Ie)-1;0<=Ie;--Ie)Fe[Ie]=we[De+Ie];for(Ie=He-1;0<=Ie;--Ie)je[ie+Ie]=Fe[Ie];Bp(ae,xe,Ae,Z,Ne,Z,Y)}else Bp(ae,xe,Ae,ie,we,Z,Y)}Y=L,Z=j}Z!=j&&n(L,j,Y,Z,W)}function Q(x,N){var j=x.V,L=x.Ba+x.c*x.C,U=N-x.C;if(t(N<=x.l.o),t(16>=U),0<U){var W=x.l,K=x.Ta,Y=x.Ua,Z=W.width;if(oe(x,U,j,L),U=Y=[Y],t((j=x.C)<(L=N)),t(W.v<W.va),L>W.o&&(L=W.o),j<W.j){var ae=W.j-j;j=W.j,U[0]+=ae*Z}if(j>=L?j=0:(U[0]+=4*W.v,W.ka=j-W.j,W.U=W.va-W.v,W.T=L-j,j=1),j){if(Y=Y[0],11>(j=x.ca).S){var xe=j.f.RGBA,Ae=(L=j.S,U=W.U,W=W.T,ae=xe.eb,xe.A),ie=W;for(xe=xe.fb+x.Ma*xe.A;0<ie--;){var we=K,Ne=Y,Fe=U,je=ae,De=xe;switch(L){case zp:r0(we,Ne,Fe,je,De);break;case qp:kl(we,Ne,Fe,je,De);break;case Yx:kl(we,Ne,Fe,je,De),s0(je,De,0,Fe,1,0);break;case g4:Wc(we,Ne,Fe,je,De);break;case Hp:vt(we,Ne,Fe,je,De,1);break;case Xx:vt(we,Ne,Fe,je,De,1),s0(je,De,0,Fe,1,0);break;case Wp:vt(we,Ne,Fe,je,De,0);break;case Vp:vt(we,Ne,Fe,je,De,0),s0(je,De,1,Fe,1,0);break;case Gx:El(we,Ne,Fe,je,De);break;case Jx:El(we,Ne,Fe,je,De),l4(je,De,Fe,1,0);break;case x4:jl(we,Ne,Fe,je,De);break;default:t(0)}Y+=Z,xe+=Ae}x.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");t(x.Ma<=j.height)}}x.C=N,t(x.C<=x.i)}function re(x){var N;if(0<x.ua)return 0;for(N=0;N<x.Wb;++N){var j=x.Ya[N].G,L=x.Ya[N].H;if(0<j[1][L[1]+0].g||0<j[2][L[2]+0].g||0<j[3][L[3]+0].g)return 0}return 1}function le(x,N,j,L,U,W){if(x.Z!=0){var K=x.qd,Y=x.rd;for(t(Cl[x.Z]!=null);N<j;++N)Cl[x.Z](K,Y,L,U,L,U,W),K=L,Y=U,U+=W;x.qd=K,x.rd=Y}}function ue(x,N){var j=x.l.ma,L=j.Z==0||j.Z==1?x.l.j:x.C;if(L=x.C<L?L:x.C,t(N<=x.l.o),N>L){var U=x.l.width,W=j.ca,K=j.tb+U*L,Y=x.V,Z=x.Ba+x.c*L,ae=x.gc;t(x.ab==1),t(ae[0].hc==3),Ki(ae[0],L,N,Y,Z,W,K),le(j,L,N,W,K,U)}x.C=x.Ma=N}function _e(x,N,j,L,U,W,K){var Y=x.$/L,Z=x.$%L,ae=x.m,xe=x.s,Ae=j+x.$,ie=Ae;U=j+L*U;var we=j+L*W,Ne=280+xe.ua,Fe=x.Pb?Y:16777216,je=0<xe.ua?xe.Wa:null,De=xe.wc,Ie=Ae<we?H(xe,Z,Y):null;t(x.C<W),t(we<=U);var He=!1;e:for(;;){for(;He||Ae<we;){var ze=0;if(Y>=Fe){var xt=Ae-j;t((Fe=x).Pb),Fe.wd=Fe.m,Fe.xd=xt,0<Fe.s.ua&&Ue(Fe.s.Wa,Fe.s.vb),Fe=Y+_P}if(Z&De||(Ie=H(xe,Z,Y)),t(Ie!=null),Ie.Qb&&(N[Ae]=Ie.qb,He=!0),!He)if(fe(ae),Ie.jc){ze=ae,xt=N;var ot=Ae,Gt=Ie.pd[I(ze)&Hc-1];t(Ie.jc),256>Gt.g?(te(ze,ze.u+Gt.g),xt[ot]=Gt.value,ze=0):(te(ze,ze.u+Gt.g-256),t(256<=Gt.value),ze=Gt.value),ze==0&&(He=!0)}else ze=Mr(Ie.G[0],Ie.H[0],ae);if(ae.h)break;if(He||256>ze){if(!He)if(Ie.nd)N[Ae]=(Ie.qb|ze<<8)>>>0;else{if(fe(ae),He=Mr(Ie.G[1],Ie.H[1],ae),fe(ae),xt=Mr(Ie.G[2],Ie.H[2],ae),ot=Mr(Ie.G[3],Ie.H[3],ae),ae.h)break;N[Ae]=(ot<<24|He<<16|ze<<8|xt)>>>0}if(He=!1,++Ae,++Z>=L&&(Z=0,++Y,K!=null&&Y<=W&&!(Y%16)&&K(x,Y),je!=null))for(;ie<Ae;)ze=N[ie++],je.X[(506832829*ze&4294967295)>>>je.Mb]=ze}else if(280>ze){if(ze=us(ze-256,ae),xt=Mr(Ie.G[4],Ie.H[4],ae),fe(ae),xt=Js(L,xt=us(xt,ae)),ae.h)break;if(Ae-j<xt||U-Ae<ze)break e;for(ot=0;ot<ze;++ot)N[Ae+ot]=N[Ae+ot-xt];for(Ae+=ze,Z+=ze;Z>=L;)Z-=L,++Y,K!=null&&Y<=W&&!(Y%16)&&K(x,Y);if(t(Ae<=U),Z&De&&(Ie=H(xe,Z,Y)),je!=null)for(;ie<Ae;)ze=N[ie++],je.X[(506832829*ze&4294967295)>>>je.Mb]=ze}else{if(!(ze<Ne))break e;for(He=ze-280,t(je!=null);ie<Ae;)ze=N[ie++],je.X[(506832829*ze&4294967295)>>>je.Mb]=ze;ze=Ae,t(!(He>>>(xt=je).Xa)),N[ze]=xt.X[He],He=!0}He||t(ae.h==z(ae))}if(x.Pb&&ae.h&&Ae<U)t(x.m.h),x.a=5,x.m=x.wd,x.$=x.xd,0<x.s.ua&&Ue(x.s.vb,x.s.Wa);else{if(ae.h)break e;K!=null&&K(x,Y>W?W:Y),x.a=0,x.$=Ae-j}return 1}return x.a=3,0}function Pe(x){t(x!=null),x.vc=null,x.yc=null,x.Ya=null;var N=x.Wa;N!=null&&(N.X=null),x.vb=null,t(x!=null)}function ke(){var x=new Dt;return x==null?null:(x.a=0,x.xb=w4,hr("Predictor","VP8LPredictors"),hr("Predictor","VP8LPredictors_C"),hr("PredictorAdd","VP8LPredictorsAdd"),hr("PredictorAdd","VP8LPredictorsAdd_C"),sn=_t,t0=Xe,r0=nr,kl=wt,El=Ct,jl=qt,Wc=kr,C.VP8LMapColor32b=Vi,C.VP8LMapColor8b=Zd,x)}function Ee(x,N,j,L,U){var W=1,K=[x],Y=[N],Z=L.m,ae=L.s,xe=null,Ae=0;e:for(;;){if(j)for(;W&&ye(Z,1);){var ie=K,we=Y,Ne=L,Fe=1,je=Ne.m,De=Ne.gc[Ne.ab],Ie=ye(je,2);if(Ne.Oc&1<<Ie)W=0;else{switch(Ne.Oc|=1<<Ie,De.hc=Ie,De.Ea=ie[0],De.nc=we[0],De.K=[null],++Ne.ab,t(4>=Ne.ab),Ie){case 0:case 1:De.b=ye(je,3)+2,Fe=Ee(Be(De.Ea,De.b),Be(De.nc,De.b),0,Ne,De.K),De.K=De.K[0];break;case 3:var He,ze=ye(je,8)+1,xt=16<ze?0:4<ze?1:2<ze?2:3;if(ie[0]=Be(De.Ea,xt),De.b=xt,He=Fe=Ee(ze,1,0,Ne,De.K)){var ot,Gt=ze,dt=De,Zt=1<<(8>>dt.b),Fn=a(Zt);if(Fn==null)He=0;else{var Yt=dt.K[0],ht=dt.w;for(Fn[0]=dt.K[0][0],ot=1;ot<1*Gt;++ot)Fn[ot]=ft(Yt[ht+ot],Fn[ot-1]);for(;ot<4*Zt;++ot)Fn[ot]=0;dt.K[0]=null,dt.K[0]=Fn,He=1}}Fe=He;break;case 2:break;default:t(0)}W=Fe}}if(K=K[0],Y=Y[0],W&&ye(Z,1)&&!(W=1<=(Ae=ye(Z,4))&&11>=Ae)){L.a=3;break e}var Qe;if(Qe=W)t:{var on,zt,sr,Fr=L,Jn=K,Ls=Y,Jr=Ae,fs=j,Ds=Fr.m,Ln=Fr.s,lr=[null],pr=1,Qr=0,mr=SP[Jr];r:for(;;){if(fs&&ye(Ds,1)){var Qn=ye(Ds,3)+2,fi=Be(Jn,Qn),ln=Be(Ls,Qn),Qs=fi*ln;if(!Ee(fi,ln,0,Fr,lr))break r;for(lr=lr[0],Ln.xc=Qn,on=0;on<Qs;++on){var br=lr[on]>>8&65535;lr[on]=br,br>=pr&&(pr=br+1)}}if(Ds.h)break r;for(zt=0;5>zt;++zt){var Dn=v4[zt];!zt&&0<Jr&&(Dn+=1<<Jr),Qr<Dn&&(Qr=Dn)}var ga=i(pr*mr,q),Os=pr,xa=i(Os,V);if(xa==null)var va=null;else t(65536>=Os),va=xa;var Zs=a(Qr);if(va==null||Zs==null||ga==null){Fr.a=1;break r}var ya=ga;for(on=sr=0;on<pr;++on){var Ar=va[on],wa=Ar.G,di=Ar.H,Kc=0,Bo=1,Zn=0;for(zt=0;5>zt;++zt){Dn=v4[zt],wa[zt]=ya,di[zt]=sr,!zt&&0<Jr&&(Dn+=1<<Jr);s:{var Xp,t2=Dn,Jp=Fr,o0=Zs,HP=ya,WP=sr,r2=0,Pl=Jp.m,VP=ye(Pl,1);if(s(o0,0,0,t2),VP){var KP=ye(Pl,1)+1,GP=ye(Pl,1),A4=ye(Pl,GP==0?1:8);o0[A4]=1,KP==2&&(o0[A4=ye(Pl,8)]=1);var Qp=1}else{var T4=a(19),C4=ye(Pl,4)+4;if(19<C4){Jp.a=3;var Zp=0;break s}for(Xp=0;Xp<C4;++Xp)T4[bP[Xp]]=ye(Pl,3);var n2=void 0,l0=void 0,P4=Jp,YP=T4,em=t2,F4=o0,s2=0,Fl=P4.m,L4=8,D4=i(128,q);n:for(;P(D4,0,7,YP,19);){if(ye(Fl,1)){var XP=2+2*ye(Fl,3);if((n2=2+ye(Fl,XP))>em)break n}else n2=em;for(l0=0;l0<em&&n2--;){fe(Fl);var O4=D4[0+(127&I(Fl))];te(Fl,Fl.u+O4.g);var lf=O4.value;if(16>lf)F4[l0++]=lf,lf!=0&&(L4=lf);else{var JP=lf==16,R4=lf-16,QP=yP[R4],I4=ye(Fl,vP[R4])+QP;if(l0+I4>em)break n;for(var ZP=JP?L4:0;0<I4--;)F4[l0++]=ZP}}s2=1;break n}s2||(P4.a=3),Qp=s2}(Qp=Qp&&!Pl.h)&&(r2=P(HP,WP,8,o0,t2)),Qp&&r2!=0?Zp=r2:(Jp.a=3,Zp=0)}if(Zp==0)break r;if(Bo&&wP[zt]==1&&(Bo=ya[sr].g==0),Kc+=ya[sr].g,sr+=Zp,3>=zt){var c0,a2=Zs[0];for(c0=1;c0<Dn;++c0)Zs[c0]>a2&&(a2=Zs[c0]);Zn+=a2}}if(Ar.nd=Bo,Ar.Qb=0,Bo&&(Ar.qb=(wa[3][di[3]+0].value<<24|wa[1][di[1]+0].value<<16|wa[2][di[2]+0].value)>>>0,Kc==0&&256>wa[0][di[0]+0].value&&(Ar.Qb=1,Ar.qb+=wa[0][di[0]+0].value<<8)),Ar.jc=!Ar.Qb&&6>Zn,Ar.jc){var tm,Uo=Ar;for(tm=0;tm<Hc;++tm){var Ll=tm,Dl=Uo.pd[Ll],rm=Uo.G[0][Uo.H[0]+Ll];256<=rm.value?(Dl.g=rm.g+256,Dl.value=rm.value):(Dl.g=0,Dl.value=0,Ll>>=xn(rm,8,Dl),Ll>>=xn(Uo.G[1][Uo.H[1]+Ll],16,Dl),Ll>>=xn(Uo.G[2][Uo.H[2]+Ll],0,Dl),xn(Uo.G[3][Uo.H[3]+Ll],24,Dl))}}}Ln.vc=lr,Ln.Wb=pr,Ln.Ya=va,Ln.yc=ga,Qe=1;break t}Qe=0}if(!(W=Qe)){L.a=3;break e}if(0<Ae){if(ae.ua=1<<Ae,!J(ae.Wa,Ae)){L.a=1,W=0;break e}}else ae.ua=0;var i2=L,M4=K,eF=Y,o2=i2.s,l2=o2.xc;if(i2.c=M4,i2.i=eF,o2.md=Be(M4,l2),o2.wc=l2==0?-1:(1<<l2)-1,j){L.xb=PP;break e}if((xe=a(K*Y))==null){L.a=1,W=0;break e}W=(W=_e(L,xe,0,K,Y,Y,null))&&!Z.h;break e}return W?(U!=null?U[0]=xe:(t(xe==null),t(j)),L.$=0,j||Pe(ae)):Pe(ae),W}function Te(x,N){var j=x.c*x.i,L=j+N+16*N;return t(x.c<=N),x.V=a(L),x.V==null?(x.Ta=null,x.Ua=0,x.a=1,0):(x.Ta=x.V,x.Ua=x.Ba+j+N,1)}function qe(x,N){var j=x.C,L=N-j,U=x.V,W=x.Ba+x.c*j;for(t(N<=x.l.o);0<L;){var K=16<L?16:L,Y=x.l.ma,Z=x.l.width,ae=Z*K,xe=Y.ca,Ae=Y.tb+Z*j,ie=x.Ta,we=x.Ua;oe(x,K,U,W),u4(ie,we,xe,Ae,ae),le(Y,j,j+K,xe,Ae,Z),L-=K,U+=K*x.c,j+=K}t(j==N),x.C=x.Ma=N}function Ye(){this.ub=this.yd=this.td=this.Rb=0}function tt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ke(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Ze(){this.Yb=function(){var x=[];return function N(j,L,U){for(var W=U[L],K=0;K<W&&(j.push(U.length>L+1?[]:0),!(U.length<L+1));K++)N(j[K],L+1,U)}(x,0,[3,11]),x}()}function jt(){this.jb=a(3),this.Wc=o([4,8],Ze),this.Xc=o([4,17],Ze)}function yr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Qt(){this.ld=this.La=this.dd=this.tc=0}function Xr(){this.Na=this.la=0}function zi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function oi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qi(){this.uc=this.M=this.Nb=0,this.wa=Array(new Qt),this.Y=0,this.ya=Array(new oi),this.aa=0,this.l=new Qu}function Ia(){this.y=a(16),this.f=a(8),this.ea=a(8)}function yl(){this.cb=this.a=0,this.sc="",this.m=new E,this.Od=new Ye,this.Kc=new tt,this.ed=new yr,this.Qa=new Ke,this.Ic=this.$c=this.Aa=0,this.D=new qi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,E),this.ia=0,this.pb=i(4,zi),this.Pa=new jt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ia),this.Hd=0,this.rb=Array(new Xr),this.sb=0,this.wa=Array(new Qt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new oi),this.L=this.aa=0,this.gd=o([4,2],Qt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function vn(x,N){return 0>x?0:x>N?N:x}function Qu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Fx(){var x=new yl;return x!=null&&(x.a=0,x.sc="OK",x.cb=0,x.Xb=0,a0||(a0=Zu)),x}function yn(x,N,j){return x.a==0&&(x.a=N,x.sc=j,x.cb=0),0}function jp(x,N,j){return 3<=j&&x[N+0]==157&&x[N+1]==1&&x[N+2]==42}function Hi(x,N){if(x==null)return 0;if(x.a=0,x.sc="OK",N==null)return yn(x,2,"null VP8Io passed to VP8GetHeaders()");var j=N.data,L=N.w,U=N.ha;if(4>U)return yn(x,7,"Truncated header.");var W=j[L+0]|j[L+1]<<8|j[L+2]<<16,K=x.Od;if(K.Rb=!(1&W),K.td=W>>1&7,K.yd=W>>4&1,K.ub=W>>5,3<K.td)return yn(x,3,"Incorrect keyframe parameters.");if(!K.yd)return yn(x,4,"Frame not displayable.");L+=3,U-=3;var Y=x.Kc;if(K.Rb){if(7>U)return yn(x,7,"cannot parse picture header");if(!jp(j,L,U))return yn(x,3,"Bad code word");Y.c=16383&(j[L+4]<<8|j[L+3]),Y.Td=j[L+4]>>6,Y.i=16383&(j[L+6]<<8|j[L+5]),Y.Ud=j[L+6]>>6,L+=7,U-=7,x.za=Y.c+15>>4,x.Ub=Y.i+15>>4,N.width=Y.c,N.height=Y.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,s((W=x.Pa).jb,0,255,W.jb.length),t((W=x.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,s(W.Zb,0,0,W.Zb.length),s(W.Lb,0,0,W.Lb)}if(K.ub>U)return yn(x,7,"bad partition length");se(W=x.m,j,L,K.ub),L+=K.ub,U-=K.ub,K.Rb&&(Y.Ld=he(W),Y.Kd=he(W)),Y=x.Qa;var Z,ae=x.Pa;if(t(W!=null),t(Y!=null),Y.Cb=he(W),Y.Cb){if(Y.Bb=he(W),he(W)){for(Y.Fb=he(W),Z=0;4>Z;++Z)Y.Zb[Z]=he(W)?X(W,7):0;for(Z=0;4>Z;++Z)Y.Lb[Z]=he(W)?X(W,6):0}if(Y.Bb)for(Z=0;3>Z;++Z)ae.jb[Z]=he(W)?ne(W,8):255}else Y.Bb=0;if(W.Ka)return yn(x,3,"cannot parse segment header");if((Y=x.ed).zd=he(W),Y.Tb=ne(W,6),Y.wb=ne(W,3),Y.Pc=he(W),Y.Pc&&he(W)){for(ae=0;4>ae;++ae)he(W)&&(Y.vd[ae]=X(W,6));for(ae=0;4>ae;++ae)he(W)&&(Y.od[ae]=X(W,6))}if(x.L=Y.Tb==0?0:Y.zd?1:2,W.Ka)return yn(x,3,"cannot parse filter header");var xe=U;if(U=Z=L,L=Z+xe,Y=xe,x.Xb=(1<<ne(x.m,2))-1,xe<3*(ae=x.Xb))j=7;else{for(Z+=3*ae,Y-=3*ae,xe=0;xe<ae;++xe){var Ae=j[U+0]|j[U+1]<<8|j[U+2]<<16;Ae>Y&&(Ae=Y),se(x.Jc[+xe],j,Z,Ae),Z+=Ae,Y-=Ae,U+=3}se(x.Jc[+ae],j,Z,Y),j=Z<L?0:5}if(j!=0)return yn(x,j,"cannot parse partitions");for(j=ne(Z=x.m,7),U=he(Z)?X(Z,4):0,L=he(Z)?X(Z,4):0,Y=he(Z)?X(Z,4):0,ae=he(Z)?X(Z,4):0,Z=he(Z)?X(Z,4):0,xe=x.Qa,Ae=0;4>Ae;++Ae){if(xe.Cb){var ie=xe.Zb[Ae];xe.Fb||(ie+=j)}else{if(0<Ae){x.pb[Ae]=x.pb[0];continue}ie=j}var we=x.pb[Ae];we.Sc[0]=Qx[vn(ie+U,127)],we.Sc[1]=Zx[vn(ie+0,127)],we.Eb[0]=2*Qx[vn(ie+L,127)],we.Eb[1]=101581*Zx[vn(ie+Y,127)]>>16,8>we.Eb[1]&&(we.Eb[1]=8),we.Qc[0]=Qx[vn(ie+ae,117)],we.Qc[1]=Zx[vn(ie+Z,127)],we.lc=ie+Z}if(!K.Rb)return yn(x,4,"Not a key frame.");for(he(W),K=x.Pa,j=0;4>j;++j){for(U=0;8>U;++U)for(L=0;3>L;++L)for(Y=0;11>Y;++Y)ae=pe(W,TP[j][U][L][Y])?ne(W,8):jP[j][U][L][Y],K.Wc[j][U].Yb[L][Y]=ae;for(U=0;17>U;++U)K.Xc[j][U]=K.Wc[j][CP[U]]}return x.kc=he(W),x.kc&&(x.Bd=ne(W,8)),x.cb=1}function Zu(x,N,j,L,U,W,K){var Y=N[U].Yb[j];for(j=0;16>U;++U){if(!pe(x,Y[j+0]))return U;for(;!pe(x,Y[j+1]);)if(Y=N[++U].Yb[0],j=0,U==16)return 16;var Z=N[U+1].Yb;if(pe(x,Y[j+2])){var ae=x,xe=0;if(pe(ae,(ie=Y)[(Ae=j)+3]))if(pe(ae,ie[Ae+6])){for(Y=0,Ae=2*(xe=pe(ae,ie[Ae+8]))+(ie=pe(ae,ie[Ae+9+xe])),xe=0,ie=kP[Ae];ie[Y];++Y)xe+=xe+pe(ae,ie[Y]);xe+=3+(8<<Ae)}else pe(ae,ie[Ae+7])?(xe=7+2*pe(ae,165),xe+=pe(ae,145)):xe=5+pe(ae,159);else xe=pe(ae,ie[Ae+4])?3+pe(ae,ie[Ae+5]):2;Y=Z[2]}else xe=1,Y=Z[1];Z=K+EP[U],0>(ae=x).b&&ge(ae);var Ae,ie=ae.b,we=(Ae=ae.Ca>>1)-(ae.I>>ie)>>31;--ae.b,ae.Ca+=we,ae.Ca|=1,ae.I-=(Ae+1&we)<<ie,W[Z]=((xe^we)-we)*L[(0<U)+0]}return 16}function Ap(x){var N=x.rb[x.sb-1];N.la=0,N.Na=0,s(x.zc,0,0,x.zc.length),x.ja=0}function Ma(x,N,j,L,U){U=x[N+j+32*L]+(U>>3),x[N+j+32*L]=-256&U?0>U?0:255:U}function Tn(x,N,j,L,U,W){Ma(x,N,0,j,L+U),Ma(x,N,1,j,L+W),Ma(x,N,2,j,L-W),Ma(x,N,3,j,L-U)}function Eo(x){return(20091*x>>16)+x}function Tp(x,N,j,L){var U,W=0,K=a(16);for(U=0;4>U;++U){var Y=x[N+0]+x[N+8],Z=x[N+0]-x[N+8],ae=(35468*x[N+4]>>16)-Eo(x[N+12]),xe=Eo(x[N+4])+(35468*x[N+12]>>16);K[W+0]=Y+xe,K[W+1]=Z+ae,K[W+2]=Z-ae,K[W+3]=Y-xe,W+=4,N++}for(U=W=0;4>U;++U)Y=(x=K[W+0]+4)+K[W+8],Z=x-K[W+8],ae=(35468*K[W+4]>>16)-Eo(K[W+12]),Ma(j,L,0,0,Y+(xe=Eo(K[W+4])+(35468*K[W+12]>>16))),Ma(j,L,1,0,Z+ae),Ma(j,L,2,0,Z-ae),Ma(j,L,3,0,Y-xe),W++,L+=32}function Lx(x,N,j,L){var U=x[N+0]+4,W=35468*x[N+4]>>16,K=Eo(x[N+4]),Y=35468*x[N+1]>>16;Tn(j,L,0,U+K,x=Eo(x[N+1]),Y),Tn(j,L,1,U+W,x,Y),Tn(j,L,2,U-W,x,Y),Tn(j,L,3,U-K,x,Y)}function Dx(x,N,j,L,U){Tp(x,N,j,L),U&&Tp(x,N+16,j,L+4)}function Wi(x,N,j,L){Vc(x,N+0,j,L,1),Vc(x,N+32,j,L+128,1)}function Cp(x,N,j,L){var U;for(x=x[N+0]+4,U=0;4>U;++U)for(N=0;4>N;++N)Ma(j,L,N,U,x)}function Pp(x,N,j,L){x[N+0]&&dr(x,N+0,j,L),x[N+16]&&dr(x,N+16,j,L+4),x[N+32]&&dr(x,N+32,j,L+128),x[N+48]&&dr(x,N+48,j,L+128+4)}function ef(x,N,j,L){var U,W=a(16);for(U=0;4>U;++U){var K=x[N+0+U]+x[N+12+U],Y=x[N+4+U]+x[N+8+U],Z=x[N+4+U]-x[N+8+U],ae=x[N+0+U]-x[N+12+U];W[0+U]=K+Y,W[8+U]=K-Y,W[4+U]=ae+Z,W[12+U]=ae-Z}for(U=0;4>U;++U)K=(x=W[0+4*U]+3)+W[3+4*U],Y=W[1+4*U]+W[2+4*U],Z=W[1+4*U]-W[2+4*U],ae=x-W[3+4*U],j[L+0]=K+Y>>3,j[L+16]=ae+Z>>3,j[L+32]=K-Y>>3,j[L+48]=ae-Z>>3,L+=64}function Dc(x,N,j){var L,U=N-32,W=ma,K=255-x[U-1];for(L=0;L<j;++L){var Y,Z=W,ae=K+x[N-1];for(Y=0;Y<j;++Y)x[N+Y]=Z[ae+x[U+Y]];N+=32}}function Ox(x,N){Dc(x,N,4)}function Rx(x,N){Dc(x,N,8)}function Ix(x,N){Dc(x,N,16)}function Bd(x,N){var j;for(j=0;16>j;++j)n(x,N+32*j,x,N-32,16)}function Fp(x,N){var j;for(j=16;0<j;--j)s(x,N,x[N-1],16),N+=32}function li(x,N,j){var L;for(L=0;16>L;++L)s(N,j+32*L,x,16)}function Mx(x,N){var j,L=16;for(j=0;16>j;++j)L+=x[N-1+32*j]+x[N+j-32];li(L>>5,x,N)}function Oc(x,N){var j,L=8;for(j=0;16>j;++j)L+=x[N-1+32*j];li(L>>4,x,N)}function Ud(x,N){var j,L=8;for(j=0;16>j;++j)L+=x[N+j-32];li(L>>4,x,N)}function Bx(x,N){li(128,x,N)}function Rt(x,N,j){return x+2*N+j+2>>2}function Ux(x,N){var j,L=N-32;for(L=new Uint8Array([Rt(x[L-1],x[L+0],x[L+1]),Rt(x[L+0],x[L+1],x[L+2]),Rt(x[L+1],x[L+2],x[L+3]),Rt(x[L+2],x[L+3],x[L+4])]),j=0;4>j;++j)n(x,N+32*j,L,0,L.length)}function $x(x,N){var j=x[N-1],L=x[N-1+32],U=x[N-1+64],W=x[N-1+96];Le(x,N+0,16843009*Rt(x[N-1-32],j,L)),Le(x,N+32,16843009*Rt(j,L,U)),Le(x,N+64,16843009*Rt(L,U,W)),Le(x,N+96,16843009*Rt(U,W,W))}function zx(x,N){var j,L=4;for(j=0;4>j;++j)L+=x[N+j-32]+x[N-1+32*j];for(L>>=3,j=0;4>j;++j)s(x,N+32*j,L,4)}function jo(x,N){var j=x[N-1+0],L=x[N-1+32],U=x[N-1+64],W=x[N-1-32],K=x[N+0-32],Y=x[N+1-32],Z=x[N+2-32],ae=x[N+3-32];x[N+0+96]=Rt(L,U,x[N-1+96]),x[N+1+96]=x[N+0+64]=Rt(j,L,U),x[N+2+96]=x[N+1+64]=x[N+0+32]=Rt(W,j,L),x[N+3+96]=x[N+2+64]=x[N+1+32]=x[N+0+0]=Rt(K,W,j),x[N+3+64]=x[N+2+32]=x[N+1+0]=Rt(Y,K,W),x[N+3+32]=x[N+2+0]=Rt(Z,Y,K),x[N+3+0]=Rt(ae,Z,Y)}function Ao(x,N){var j=x[N+1-32],L=x[N+2-32],U=x[N+3-32],W=x[N+4-32],K=x[N+5-32],Y=x[N+6-32],Z=x[N+7-32];x[N+0+0]=Rt(x[N+0-32],j,L),x[N+1+0]=x[N+0+32]=Rt(j,L,U),x[N+2+0]=x[N+1+32]=x[N+0+64]=Rt(L,U,W),x[N+3+0]=x[N+2+32]=x[N+1+64]=x[N+0+96]=Rt(U,W,K),x[N+3+32]=x[N+2+64]=x[N+1+96]=Rt(W,K,Y),x[N+3+64]=x[N+2+96]=Rt(K,Y,Z),x[N+3+96]=Rt(Y,Z,Z)}function qx(x,N){var j=x[N-1+0],L=x[N-1+32],U=x[N-1+64],W=x[N-1-32],K=x[N+0-32],Y=x[N+1-32],Z=x[N+2-32],ae=x[N+3-32];x[N+0+0]=x[N+1+64]=W+K+1>>1,x[N+1+0]=x[N+2+64]=K+Y+1>>1,x[N+2+0]=x[N+3+64]=Y+Z+1>>1,x[N+3+0]=Z+ae+1>>1,x[N+0+96]=Rt(U,L,j),x[N+0+64]=Rt(L,j,W),x[N+0+32]=x[N+1+96]=Rt(j,W,K),x[N+1+32]=x[N+2+96]=Rt(W,K,Y),x[N+2+32]=x[N+3+96]=Rt(K,Y,Z),x[N+3+32]=Rt(Y,Z,ae)}function Hx(x,N){var j=x[N+0-32],L=x[N+1-32],U=x[N+2-32],W=x[N+3-32],K=x[N+4-32],Y=x[N+5-32],Z=x[N+6-32],ae=x[N+7-32];x[N+0+0]=j+L+1>>1,x[N+1+0]=x[N+0+64]=L+U+1>>1,x[N+2+0]=x[N+1+64]=U+W+1>>1,x[N+3+0]=x[N+2+64]=W+K+1>>1,x[N+0+32]=Rt(j,L,U),x[N+1+32]=x[N+0+96]=Rt(L,U,W),x[N+2+32]=x[N+1+96]=Rt(U,W,K),x[N+3+32]=x[N+2+96]=Rt(W,K,Y),x[N+3+64]=Rt(K,Y,Z),x[N+3+96]=Rt(Y,Z,ae)}function tf(x,N){var j=x[N-1+0],L=x[N-1+32],U=x[N-1+64],W=x[N-1+96];x[N+0+0]=j+L+1>>1,x[N+2+0]=x[N+0+32]=L+U+1>>1,x[N+2+32]=x[N+0+64]=U+W+1>>1,x[N+1+0]=Rt(j,L,U),x[N+3+0]=x[N+1+32]=Rt(L,U,W),x[N+3+32]=x[N+1+64]=Rt(U,W,W),x[N+3+64]=x[N+2+64]=x[N+0+96]=x[N+1+96]=x[N+2+96]=x[N+3+96]=W}function $d(x,N){var j=x[N-1+0],L=x[N-1+32],U=x[N-1+64],W=x[N-1+96],K=x[N-1-32],Y=x[N+0-32],Z=x[N+1-32],ae=x[N+2-32];x[N+0+0]=x[N+2+32]=j+K+1>>1,x[N+0+32]=x[N+2+64]=L+j+1>>1,x[N+0+64]=x[N+2+96]=U+L+1>>1,x[N+0+96]=W+U+1>>1,x[N+3+0]=Rt(Y,Z,ae),x[N+2+0]=Rt(K,Y,Z),x[N+1+0]=x[N+3+32]=Rt(j,K,Y),x[N+1+32]=x[N+3+64]=Rt(L,j,K),x[N+1+64]=x[N+3+96]=Rt(U,L,j),x[N+1+96]=Rt(W,U,L)}function Rc(x,N){var j;for(j=0;8>j;++j)n(x,N+32*j,x,N-32,8)}function Wx(x,N){var j;for(j=0;8>j;++j)s(x,N,x[N-1],8),N+=32}function To(x,N,j){var L;for(L=0;8>L;++L)s(N,j+32*L,x,8)}function Vx(x,N){var j,L=8;for(j=0;8>j;++j)L+=x[N+j-32]+x[N-1+32*j];To(L>>4,x,N)}function zd(x,N){var j,L=4;for(j=0;8>j;++j)L+=x[N+j-32];To(L>>3,x,N)}function qd(x,N){var j,L=4;for(j=0;8>j;++j)L+=x[N-1+32*j];To(L>>3,x,N)}function Lp(x,N){To(128,x,N)}function Co(x,N,j){var L=x[N-j],U=x[N+0],W=3*(U-L)+Kx[1020+x[N-2*j]-x[N+j]],K=$p[112+(W+4>>3)];x[N-j]=ma[255+L+$p[112+(W+3>>3)]],x[N+0]=ma[255+U-K]}function Hd(x,N,j,L){var U=x[N+0],W=x[N+j];return $a[255+x[N-2*j]-x[N-j]]>L||$a[255+W-U]>L}function rf(x,N,j,L){return 4*$a[255+x[N-j]-x[N+0]]+$a[255+x[N-2*j]-x[N+j]]<=L}function Wd(x,N,j,L,U){var W=x[N-3*j],K=x[N-2*j],Y=x[N-j],Z=x[N+0],ae=x[N+j],xe=x[N+2*j],Ae=x[N+3*j];return 4*$a[255+Y-Z]+$a[255+K-ae]>L?0:$a[255+x[N-4*j]-W]<=U&&$a[255+W-K]<=U&&$a[255+K-Y]<=U&&$a[255+Ae-xe]<=U&&$a[255+xe-ae]<=U&&$a[255+ae-Z]<=U}function Ic(x,N,j,L){var U=2*L+1;for(L=0;16>L;++L)rf(x,N+L,j,U)&&Co(x,N+L,j)}function Vd(x,N,j,L){var U=2*L+1;for(L=0;16>L;++L)rf(x,N+L*j,1,U)&&Co(x,N+L*j,1)}function Dp(x,N,j,L){var U;for(U=3;0<U;--U)Ic(x,N+=4*j,j,L)}function Op(x,N,j,L){var U;for(U=3;0<U;--U)Vd(x,N+=4,j,L)}function Po(x,N,j,L,U,W,K,Y){for(W=2*W+1;0<U--;){if(Wd(x,N,j,W,K))if(Hd(x,N,j,Y))Co(x,N,j);else{var Z=x,ae=N,xe=j,Ae=Z[ae-2*xe],ie=Z[ae-xe],we=Z[ae+0],Ne=Z[ae+xe],Fe=Z[ae+2*xe],je=27*(Ie=Kx[1020+3*(we-ie)+Kx[1020+Ae-Ne]])+63>>7,De=18*Ie+63>>7,Ie=9*Ie+63>>7;Z[ae-3*xe]=ma[255+Z[ae-3*xe]+Ie],Z[ae-2*xe]=ma[255+Ae+De],Z[ae-xe]=ma[255+ie+je],Z[ae+0]=ma[255+we-je],Z[ae+xe]=ma[255+Ne-De],Z[ae+2*xe]=ma[255+Fe-Ie]}N+=L}}function Fo(x,N,j,L,U,W,K,Y){for(W=2*W+1;0<U--;){if(Wd(x,N,j,W,K))if(Hd(x,N,j,Y))Co(x,N,j);else{var Z=x,ae=N,xe=j,Ae=Z[ae-xe],ie=Z[ae+0],we=Z[ae+xe],Ne=$p[112+(4+(Fe=3*(ie-Ae))>>3)],Fe=$p[112+(Fe+3>>3)],je=Ne+1>>1;Z[ae-2*xe]=ma[255+Z[ae-2*xe]+je],Z[ae-xe]=ma[255+Ae+Fe],Z[ae+0]=ma[255+ie-Ne],Z[ae+xe]=ma[255+we-je]}N+=L}}function Rp(x,N,j,L,U,W){Po(x,N,j,1,16,L,U,W)}function Mc(x,N,j,L,U,W){Po(x,N,1,j,16,L,U,W)}function Ip(x,N,j,L,U,W){var K;for(K=3;0<K;--K)Fo(x,N+=4*j,j,1,16,L,U,W)}function _(x,N,j,L,U,W){var K;for(K=3;0<K;--K)Fo(x,N+=4,1,j,16,L,U,W)}function B(x,N,j,L,U,W,K,Y){Po(x,N,U,1,8,W,K,Y),Po(j,L,U,1,8,W,K,Y)}function ce(x,N,j,L,U,W,K,Y){Po(x,N,1,U,8,W,K,Y),Po(j,L,1,U,8,W,K,Y)}function de(x,N,j,L,U,W,K,Y){Fo(x,N+4*U,U,1,8,W,K,Y),Fo(j,L+4*U,U,1,8,W,K,Y)}function be(x,N,j,L,U,W,K,Y){Fo(x,N+4,1,U,8,W,K,Y),Fo(j,L+4,1,U,8,W,K,Y)}function Re(){this.ba=new Xt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new fr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function $e(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ut(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function pt(){this.ua=0,this.Wa=new Me,this.vb=new Me,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new V,this.yc=new q}function Dt(){this.xb=this.a=0,this.l=new Qu,this.ca=new Xt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new M,this.Pb=0,this.wd=new M,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new pt,this.ab=0,this.gc=i(4,ut),this.Oc=0}function Ht(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function or(x,N,j,L,U,W,K){for(x=x==null?0:x[N+0],N=0;N<K;++N)U[W+N]=x+j[L+N]&255,x=U[W+N]}function qr(x,N,j,L,U,W,K){var Y;if(x==null)or(null,null,j,L,U,W,K);else for(Y=0;Y<K;++Y)U[W+Y]=x[N+Y]+j[L+Y]&255}function wn(x,N,j,L,U,W,K){if(x==null)or(null,null,j,L,U,W,K);else{var Y,Z=x[N+0],ae=Z,xe=Z;for(Y=0;Y<K;++Y)ae=xe+(Z=x[N+Y])-ae,xe=j[L+Y]+(-256&ae?0>ae?0:255:ae)&255,ae=Z,U[W+Y]=xe}}function jr(x,N,j,L){var U=N.width,W=N.o;if(t(x!=null&&N!=null),0>j||0>=L||j+L>W)return null;if(!x.Cc){if(x.ga==null){var K;if(x.ga=new Ht,(K=x.ga==null)||(K=N.width*N.o,t(x.Gb.length==0),x.Gb=a(K),x.Uc=0,x.Gb==null?K=0:(x.mb=x.Gb,x.nb=x.Uc,x.rc=null,K=1),K=!K),!K){K=x.ga;var Y=x.Fa,Z=x.P,ae=x.qc,xe=x.mb,Ae=x.nb,ie=Z+1,we=ae-1,Ne=K.l;if(t(Y!=null&&xe!=null&&N!=null),Cl[0]=null,Cl[1]=or,Cl[2]=qr,Cl[3]=wn,K.ca=xe,K.tb=Ae,K.c=N.width,K.i=N.height,t(0<K.c&&0<K.i),1>=ae)N=0;else if(K.$a=3&Y[Z+0],K.Z=Y[Z+0]>>2&3,K.Lc=Y[Z+0]>>4&3,Z=Y[Z+0]>>6&3,0>K.$a||1<K.$a||4<=K.Z||1<K.Lc||Z)N=0;else if(Ne.put=Et,Ne.ac=Ra,Ne.bc=ai,Ne.ma=K,Ne.width=N.width,Ne.height=N.height,Ne.Da=N.Da,Ne.v=N.v,Ne.va=N.va,Ne.j=N.j,Ne.o=N.o,K.$a)e:{t(K.$a==1),N=ke();t:for(;;){if(N==null){N=0;break e}if(t(K!=null),K.mc=N,N.c=K.c,N.i=K.i,N.l=K.l,N.l.ma=K,N.l.width=K.c,N.l.height=K.i,N.a=0,G(N.m,Y,ie,we),!Ee(K.c,K.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&re(N.s)?(K.ic=1,Y=N.c*N.i,N.Ta=null,N.Ua=0,N.V=a(Y),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(K.ic=0,N=Te(N,K.c)),!N))break t;N=1;break e}K.mc=null,N=0}else N=we>=K.c*K.i;K=!N}if(K)return null;x.ga.Lc!=1?x.Ga=0:L=W-j}t(x.ga!=null),t(j+L<=W);e:{if(N=(Y=x.ga).c,W=Y.l.o,Y.$a==0){if(ie=x.rc,we=x.Vc,Ne=x.Fa,Z=x.P+1+j*N,ae=x.mb,xe=x.nb+j*N,t(Z<=x.P+x.qc),Y.Z!=0)for(t(Cl[Y.Z]!=null),K=0;K<L;++K)Cl[Y.Z](ie,we,Ne,Z,ae,xe,N),ie=ae,we=xe,xe+=N,Z+=N;else for(K=0;K<L;++K)n(ae,xe,Ne,Z,N),ie=ae,we=xe,xe+=N,Z+=N;x.rc=ie,x.Vc=we}else{if(t(Y.mc!=null),N=j+L,t((K=Y.mc)!=null),t(N<=K.i),K.C>=N)N=1;else if(Y.ic||ci(),Y.ic){Y=K.V,ie=K.Ba,we=K.c;var Fe=K.i,je=(Ne=1,Z=K.$/we,ae=K.$%we,xe=K.m,Ae=K.s,K.$),De=we*Fe,Ie=we*N,He=Ae.wc,ze=je<Ie?H(Ae,ae,Z):null;t(je<=De),t(N<=Fe),t(re(Ae));t:for(;;){for(;!xe.h&&je<Ie;){if(ae&He||(ze=H(Ae,ae,Z)),t(ze!=null),fe(xe),256>(Fe=Mr(ze.G[0],ze.H[0],xe)))Y[ie+je]=Fe,++je,++ae>=we&&(ae=0,++Z<=N&&!(Z%16)&&ue(K,Z));else{if(!(280>Fe)){Ne=0;break t}Fe=us(Fe-256,xe);var xt,ot=Mr(ze.G[4],ze.H[4],xe);if(fe(xe),!(je>=(ot=Js(we,ot=us(ot,xe)))&&De-je>=Fe)){Ne=0;break t}for(xt=0;xt<Fe;++xt)Y[ie+je+xt]=Y[ie+je+xt-ot];for(je+=Fe,ae+=Fe;ae>=we;)ae-=we,++Z<=N&&!(Z%16)&&ue(K,Z);je<Ie&&ae&He&&(ze=H(Ae,ae,Z))}t(xe.h==z(xe))}ue(K,Z>N?N:Z);break t}!Ne||xe.h&&je<De?(Ne=0,K.a=xe.h?5:3):K.$=je,N=Ne}else N=_e(K,K.V,K.Ba,K.c,K.i,N,qe);if(!N){L=0;break e}}j+L>=W&&(x.Cc=1),L=1}if(!L)return null;if(x.Cc&&((L=x.ga)!=null&&(L.mc=null),x.ga=null,0<x.Ga))return alert("todo:WebPDequantizeLevels"),null}return x.nb+j*U}function Cn(x,N,j,L,U,W){for(;0<U--;){var K,Y=x,Z=N+(j?1:0),ae=x,xe=N+(j?0:3);for(K=0;K<L;++K){var Ae=ae[xe+4*K];Ae!=255&&(Ae*=32897,Y[Z+4*K+0]=Y[Z+4*K+0]*Ae>>23,Y[Z+4*K+1]=Y[Z+4*K+1]*Ae>>23,Y[Z+4*K+2]=Y[Z+4*K+2]*Ae>>23)}N+=W}}function bn(x,N,j,L,U){for(;0<L--;){var W;for(W=0;W<j;++W){var K=x[N+2*W+0],Y=15&(ae=x[N+2*W+1]),Z=4369*Y,ae=(240&ae|ae>>4)*Z>>16;x[N+2*W+0]=(240&K|K>>4)*Z>>16&240|(15&K|K<<4)*Z>>16>>4&15,x[N+2*W+1]=240&ae|Y}N+=U}}function Yn(x,N,j,L,U,W,K,Y){var Z,ae,xe=255;for(ae=0;ae<U;++ae){for(Z=0;Z<L;++Z){var Ae=x[N+Z];W[K+4*Z]=Ae,xe&=Ae}N+=j,K+=Y}return xe!=255}function Lo(x,N,j,L,U){var W;for(W=0;W<U;++W)j[L+W]=x[N+W]>>8}function ci(){s0=Cn,l4=bn,c4=Yn,u4=Lo}function Do(x,N,j){C[x]=function(L,U,W,K,Y,Z,ae,xe,Ae,ie,we,Ne,Fe,je,De,Ie,He){var ze,xt=He-1>>1,ot=Y[Z+0]|ae[xe+0]<<16,Gt=Ae[ie+0]|we[Ne+0]<<16;t(L!=null);var dt=3*ot+Gt+131074>>2;for(N(L[U+0],255&dt,dt>>16,Fe,je),W!=null&&(dt=3*Gt+ot+131074>>2,N(W[K+0],255&dt,dt>>16,De,Ie)),ze=1;ze<=xt;++ze){var Zt=Y[Z+ze]|ae[xe+ze]<<16,Fn=Ae[ie+ze]|we[Ne+ze]<<16,Yt=ot+Zt+Gt+Fn+524296,ht=Yt+2*(Zt+Gt)>>3;dt=ht+ot>>1,ot=(Yt=Yt+2*(ot+Fn)>>3)+Zt>>1,N(L[U+2*ze-1],255&dt,dt>>16,Fe,je+(2*ze-1)*j),N(L[U+2*ze-0],255&ot,ot>>16,Fe,je+(2*ze-0)*j),W!=null&&(dt=Yt+Gt>>1,ot=ht+Fn>>1,N(W[K+2*ze-1],255&dt,dt>>16,De,Ie+(2*ze-1)*j),N(W[K+2*ze+0],255&ot,ot>>16,De,Ie+(2*ze+0)*j)),ot=Zt,Gt=Fn}1&He||(dt=3*ot+Gt+131074>>2,N(L[U+He-1],255&dt,dt>>16,Fe,je+(He-1)*j),W!=null&&(dt=3*Gt+ot+131074>>2,N(W[K+He-1],255&dt,dt>>16,De,Ie+(He-1)*j)))}}function Kd(){za[zp]=FP,za[qp]=b4,za[g4]=LP,za[Hp]=N4,za[Wp]=S4,za[Gx]=_4,za[x4]=DP,za[Yx]=b4,za[Xx]=N4,za[Vp]=S4,za[Jx]=_4}function nf(x){return x&-16384?0>x?0:255:x>>OP}function wl(x,N){return nf((19077*x>>8)+(26149*N>>8)-14234)}function Bc(x,N,j){return nf((19077*x>>8)-(6419*N>>8)-(13320*j>>8)+8708)}function Uc(x,N){return nf((19077*x>>8)+(33050*N>>8)-17685)}function bl(x,N,j,L,U){L[U+0]=wl(x,j),L[U+1]=Bc(x,N,j),L[U+2]=Uc(x,N)}function Xn(x,N,j,L,U){L[U+0]=Uc(x,N),L[U+1]=Bc(x,N,j),L[U+2]=wl(x,j)}function $c(x,N,j,L,U){var W=Bc(x,N,j);N=W<<3&224|Uc(x,N)>>3,L[U+0]=248&wl(x,j)|W>>5,L[U+1]=N}function zc(x,N,j,L,U){var W=240&Uc(x,N)|15;L[U+0]=240&wl(x,j)|Bc(x,N,j)>>4,L[U+1]=W}function Gd(x,N,j,L,U){L[U+0]=255,bl(x,N,j,L,U+1)}function Yd(x,N,j,L,U){Xn(x,N,j,L,U),L[U+3]=255}function Fs(x,N,j,L,U){bl(x,N,j,L,U),L[U+3]=255}function Oo(x,N,j){C[x]=function(L,U,W,K,Y,Z,ae,xe,Ae){for(var ie=xe+(-2&Ae)*j;xe!=ie;)N(L[U+0],W[K+0],Y[Z+0],ae,xe),N(L[U+1],W[K+0],Y[Z+0],ae,xe+j),U+=2,++K,++Z,xe+=2*j;1&Ae&&N(L[U+0],W[K+0],Y[Z+0],ae,xe)}}function sf(x,N,j){return j==0?x==0?N==0?6:5:N==0?4:0:j}function Mp(x,N,j,L,U){switch(x>>>30){case 3:Vc(N,j,L,U,0);break;case 2:Ua(N,j,L,U);break;case 1:dr(N,j,L,U)}}function Ba(x,N){var j,L,U=N.M,W=N.Nb,K=x.oc,Y=x.pc+40,Z=x.oc,ae=x.pc+584,xe=x.oc,Ae=x.pc+600;for(j=0;16>j;++j)K[Y+32*j-1]=129;for(j=0;8>j;++j)Z[ae+32*j-1]=129,xe[Ae+32*j-1]=129;for(0<U?K[Y-1-32]=Z[ae-1-32]=xe[Ae-1-32]=129:(s(K,Y-32-1,127,21),s(Z,ae-32-1,127,9),s(xe,Ae-32-1,127,9)),L=0;L<x.za;++L){var ie=N.ya[N.aa+L];if(0<L){for(j=-1;16>j;++j)n(K,Y+32*j-4,K,Y+32*j+12,4);for(j=-1;8>j;++j)n(Z,ae+32*j-4,Z,ae+32*j+4,4),n(xe,Ae+32*j-4,xe,Ae+32*j+4,4)}var we=x.Gd,Ne=x.Hd+L,Fe=ie.ad,je=ie.Hc;if(0<U&&(n(K,Y-32,we[Ne].y,0,16),n(Z,ae-32,we[Ne].f,0,8),n(xe,Ae-32,we[Ne].ea,0,8)),ie.Za){var De=K,Ie=Y-32+16;for(0<U&&(L>=x.za-1?s(De,Ie,we[Ne].y[15],4):n(De,Ie,we[Ne+1].y,0,4)),j=0;4>j;j++)De[Ie+128+j]=De[Ie+256+j]=De[Ie+384+j]=De[Ie+0+j];for(j=0;16>j;++j,je<<=2)De=K,Ie=Y+E4[j],ui[ie.Ob[j]](De,Ie),Mp(je,Fe,16*+j,De,Ie)}else if(De=sf(L,U,ie.Ob[0]),Tl[De](K,Y),je!=0)for(j=0;16>j;++j,je<<=2)Mp(je,Fe,16*+j,K,Y+E4[j]);for(j=ie.Gc,De=sf(L,U,ie.Dd),Mo[De](Z,ae),Mo[De](xe,Ae),je=Fe,De=Z,Ie=ae,255&(ie=0|j)&&(170&ie?Gi(je,256,De,Ie):wr(je,256,De,Ie)),ie=xe,je=Ae,255&(j>>=8)&&(170&j?Gi(Fe,320,ie,je):wr(Fe,320,ie,je)),U<x.Ub-1&&(n(we[Ne].y,0,K,Y+480,16),n(we[Ne].f,0,Z,ae+224,8),n(we[Ne].ea,0,xe,Ae+224,8)),j=8*W*x.B,we=x.sa,Ne=x.ta+16*L+16*W*x.R,Fe=x.qa,ie=x.ra+8*L+j,je=x.Ha,De=x.Ia+8*L+j,j=0;16>j;++j)n(we,Ne+j*x.R,K,Y+32*j,16);for(j=0;8>j;++j)n(Fe,ie+j*x.B,Z,ae+32*j,8),n(je,De+j*x.B,xe,Ae+32*j,8)}}function qc(x,N,j,L,U,W,K,Y,Z){var ae=[0],xe=[0],Ae=0,ie=Z!=null?Z.kd:0,we=Z??new $e;if(x==null||12>j)return 7;we.data=x,we.w=N,we.ha=j,N=[N],j=[j],we.gb=[we.gb];e:{var Ne=N,Fe=j,je=we.gb;if(t(x!=null),t(Fe!=null),t(je!=null),je[0]=0,12<=Fe[0]&&!r(x,Ne[0],"RIFF")){if(r(x,Ne[0]+8,"WEBP")){je=3;break e}var De=Ge(x,Ne[0]+4);if(12>De||4294967286<De){je=3;break e}if(ie&&De>Fe[0]-8){je=7;break e}je[0]=De,Ne[0]+=12,Fe[0]-=12}je=0}if(je!=0)return je;for(De=0<we.gb[0],j=j[0];;){e:{var Ie=x;Fe=N,je=j;var He=ae,ze=xe,xt=Ne=[0];if((dt=Ae=[Ae])[0]=0,8>je[0])je=7;else{if(!r(Ie,Fe[0],"VP8X")){if(Ge(Ie,Fe[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var ot=Ge(Ie,Fe[0]+8),Gt=1+We(Ie,Fe[0]+12);if(2147483648<=Gt*(Ie=1+We(Ie,Fe[0]+15))){je=3;break e}xt!=null&&(xt[0]=ot),He!=null&&(He[0]=Gt),ze!=null&&(ze[0]=Ie),Fe[0]+=18,je[0]-=18,dt[0]=1}je=0}}if(Ae=Ae[0],Ne=Ne[0],je!=0)return je;if(Fe=!!(2&Ne),!De&&Ae)return 3;if(W!=null&&(W[0]=!!(16&Ne)),K!=null&&(K[0]=Fe),Y!=null&&(Y[0]=0),K=ae[0],Ne=xe[0],Ae&&Fe&&Z==null){je=0;break}if(4>j){je=7;break}if(De&&Ae||!De&&!Ae&&!r(x,N[0],"ALPH")){j=[j],we.na=[we.na],we.P=[we.P],we.Sa=[we.Sa];e:{ot=x,je=N,De=j;var dt=we.gb;He=we.na,ze=we.P,xt=we.Sa,Gt=22,t(ot!=null),t(De!=null),Ie=je[0];var Zt=De[0];for(t(He!=null),t(xt!=null),He[0]=null,ze[0]=null,xt[0]=0;;){if(je[0]=Ie,De[0]=Zt,8>Zt){je=7;break e}var Fn=Ge(ot,Ie+4);if(4294967286<Fn){je=3;break e}var Yt=8+Fn+1&-2;if(Gt+=Yt,0<dt&&Gt>dt){je=3;break e}if(!r(ot,Ie,"VP8 ")||!r(ot,Ie,"VP8L")){je=0;break e}if(Zt[0]<Yt){je=7;break e}r(ot,Ie,"ALPH")||(He[0]=ot,ze[0]=Ie+8,xt[0]=Fn),Ie+=Yt,Zt-=Yt}}if(j=j[0],we.na=we.na[0],we.P=we.P[0],we.Sa=we.Sa[0],je!=0)break}j=[j],we.Ja=[we.Ja],we.xa=[we.xa];e:if(dt=x,je=N,De=j,He=we.gb[0],ze=we.Ja,xt=we.xa,ot=je[0],Ie=!r(dt,ot,"VP8 "),Gt=!r(dt,ot,"VP8L"),t(dt!=null),t(De!=null),t(ze!=null),t(xt!=null),8>De[0])je=7;else{if(Ie||Gt){if(dt=Ge(dt,ot+4),12<=He&&dt>He-12){je=3;break e}if(ie&&dt>De[0]-8){je=7;break e}ze[0]=dt,je[0]+=8,De[0]-=8,xt[0]=Gt}else xt[0]=5<=De[0]&&dt[ot+0]==47&&!(dt[ot+4]>>5),ze[0]=De[0];je=0}if(j=j[0],we.Ja=we.Ja[0],we.xa=we.xa[0],N=N[0],je!=0)break;if(4294967286<we.Ja)return 3;if(Y==null||Fe||(Y[0]=we.xa?2:1),K=[K],Ne=[Ne],we.xa){if(5>j){je=7;break}Y=K,ie=Ne,Fe=W,x==null||5>j?x=0:5<=j&&x[N+0]==47&&!(x[N+4]>>5)?(De=[0],dt=[0],He=[0],G(ze=new M,x,N,j),ii(ze,De,dt,He)?(Y!=null&&(Y[0]=De[0]),ie!=null&&(ie[0]=dt[0]),Fe!=null&&(Fe[0]=He[0]),x=1):x=0):x=0}else{if(10>j){je=7;break}Y=Ne,x==null||10>j||!jp(x,N+3,j-3)?x=0:(ie=x[N+0]|x[N+1]<<8|x[N+2]<<16,Fe=16383&(x[N+7]<<8|x[N+6]),x=16383&(x[N+9]<<8|x[N+8]),1&ie||3<(ie>>1&7)||!(ie>>4&1)||ie>>5>=we.Ja||!Fe||!x?x=0:(K&&(K[0]=Fe),Y&&(Y[0]=x),x=1))}if(!x||(K=K[0],Ne=Ne[0],Ae&&(ae[0]!=K||xe[0]!=Ne)))return 3;Z!=null&&(Z[0]=we,Z.offset=N-Z.w,t(4294967286>N-Z.w),t(Z.offset==Z.ha-j));break}return je==0||je==7&&Ae&&Z==null?(W!=null&&(W[0]|=we.na!=null&&0<we.na.length),L!=null&&(L[0]=K),U!=null&&(U[0]=Ne),0):je}function Xd(x,N,j){var L=N.width,U=N.height,W=0,K=0,Y=L,Z=U;if(N.Da=x!=null&&0<x.Da,N.Da&&(Y=x.cd,Z=x.bd,W=x.v,K=x.j,11>j||(W&=-2,K&=-2),0>W||0>K||0>=Y||0>=Z||W+Y>L||K+Z>U))return 0;if(N.v=W,N.j=K,N.va=W+Y,N.o=K+Z,N.U=Y,N.T=Z,N.da=x!=null&&0<x.da,N.da){if(!rt(Y,Z,j=[x.ib],W=[x.hb]))return 0;N.ib=j[0],N.hb=W[0]}return N.ob=x!=null&&x.ob,N.Kb=x==null||!x.Sd,N.da&&(N.ob=N.ib<3*L/4&&N.hb<3*U/4,N.Kb=0),1}function Jd(x){if(x==null)return 2;if(11>x.S){var N=x.f.RGBA;N.fb+=(x.height-1)*N.A,N.A=-N.A}else N=x.f.kb,x=x.height,N.O+=(x-1)*N.fa,N.fa=-N.fa,N.N+=(x-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(x-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(x-1)*N.lb,N.lb=-N.lb);return 0}function Nl(x,N,j,L){if(L==null||0>=x||0>=N)return 2;if(j!=null){if(j.Da){var U=j.cd,W=j.bd,K=-2&j.v,Y=-2&j.j;if(0>K||0>Y||0>=U||0>=W||K+U>x||Y+W>N)return 2;x=U,N=W}if(j.da){if(!rt(x,N,U=[j.ib],W=[j.hb]))return 2;x=U[0],N=W[0]}}L.width=x,L.height=N;e:{var Z=L.width,ae=L.height;if(x=L.S,0>=Z||0>=ae||!(x>=zp&&13>x))x=2;else{if(0>=L.Rd&&L.sd==null){K=W=U=N=0;var xe=(Y=Z*j4[x])*ae;if(11>x||(W=(ae+1)/2*(N=(Z+1)/2),x==12&&(K=(U=Z)*ae)),(ae=a(xe+2*W+K))==null){x=1;break e}L.sd=ae,11>x?((Z=L.f.RGBA).eb=ae,Z.fb=0,Z.A=Y,Z.size=xe):((Z=L.f.kb).y=ae,Z.O=0,Z.fa=Y,Z.Fd=xe,Z.f=ae,Z.N=0+xe,Z.Ab=N,Z.Cd=W,Z.ea=ae,Z.W=0+xe+W,Z.Db=N,Z.Ed=W,x==12&&(Z.F=ae,Z.J=0+xe+2*W),Z.Tc=K,Z.lb=U)}if(N=1,U=L.S,W=L.width,K=L.height,U>=zp&&13>U)if(11>U)x=L.f.RGBA,N&=(Y=Math.abs(x.A))*(K-1)+W<=x.size,N&=Y>=W*j4[U],N&=x.eb!=null;else{x=L.f.kb,Y=(W+1)/2,xe=(K+1)/2,Z=Math.abs(x.fa),ae=Math.abs(x.Ab);var Ae=Math.abs(x.Db),ie=Math.abs(x.lb),we=ie*(K-1)+W;N&=Z*(K-1)+W<=x.Fd,N&=ae*(xe-1)+Y<=x.Cd,N=(N&=Ae*(xe-1)+Y<=x.Ed)&Z>=W&ae>=Y&Ae>=Y,N&=x.y!=null,N&=x.f!=null,N&=x.ea!=null,U==12&&(N&=ie>=W,N&=we<=x.Tc,N&=x.F!=null)}else N=0;x=N?0:2}}return x!=0||j!=null&&j.fd&&(x=Jd(L)),x}var Hc=64,ha=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],pa=24,Sl=32,Ro=8,_l=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];et("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(x){return x},C.Predictor2=function(x,N,j){return N[j+0]},C.Predictor3=function(x,N,j){return N[j+1]},C.Predictor4=function(x,N,j){return N[j-1]},C.Predictor5=function(x,N,j){return ct(ct(x,N[j+1]),N[j+0])},C.Predictor6=function(x,N,j){return ct(x,N[j-1])},C.Predictor7=function(x,N,j){return ct(x,N[j+0])},C.Predictor8=function(x,N,j){return ct(N[j-1],N[j+0])},C.Predictor9=function(x,N,j){return ct(N[j+0],N[j+1])},C.Predictor10=function(x,N,j){return ct(ct(x,N[j-1]),ct(N[j+0],N[j+1]))},C.Predictor11=function(x,N,j){var L=N[j+0];return 0>=St(L>>24&255,x>>24&255,(N=N[j-1])>>24&255)+St(L>>16&255,x>>16&255,N>>16&255)+St(L>>8&255,x>>8&255,N>>8&255)+St(255&L,255&x,255&N)?L:x},C.Predictor12=function(x,N,j){var L=N[j+0];return(Mt((x>>24&255)+(L>>24&255)-((N=N[j-1])>>24&255))<<24|Mt((x>>16&255)+(L>>16&255)-(N>>16&255))<<16|Mt((x>>8&255)+(L>>8&255)-(N>>8&255))<<8|Mt((255&x)+(255&L)-(255&N)))>>>0},C.Predictor13=function(x,N,j){var L=N[j-1];return(Ft((x=ct(x,N[j+0]))>>24&255,L>>24&255)<<24|Ft(x>>16&255,L>>16&255)<<16|Ft(x>>8&255,L>>8&255)<<8|Ft(255&x,255&L))>>>0};var Qd=C.PredictorAdd0;C.PredictorAdd1=Kt,et("Predictor2","PredictorAdd2"),et("Predictor3","PredictorAdd3"),et("Predictor4","PredictorAdd4"),et("Predictor5","PredictorAdd5"),et("Predictor6","PredictorAdd6"),et("Predictor7","PredictorAdd7"),et("Predictor8","PredictorAdd8"),et("Predictor9","PredictorAdd9"),et("Predictor10","PredictorAdd10"),et("Predictor11","PredictorAdd11"),et("Predictor12","PredictorAdd12"),et("Predictor13","PredictorAdd13");var af=C.PredictorAdd2;Je("ColorIndexInverseTransform","MapARGB","32b",function(x){return x>>8&255},function(x){return x}),Je("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(x){return x},function(x){return x>>8&255});var sn,Bp=C.ColorIndexInverseTransform,Vi=C.MapARGB,Ki=C.VP8LColorIndexInverseTransformAlpha,Zd=C.MapAlpha,e0=C.VP8LPredictorsAdd=[];e0.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var t0,r0,kl,El,jl,Wc,Al,Vc,Ua,Gi,dr,wr,an,Pn,Io,n0,of,Up,r4,n4,s4,a4,i4,o4,s0,l4,c4,u4,f4=a(511),d4=a(2041),h4=a(225),p4=a(767),m4=0,Kx=d4,$p=h4,ma=p4,$a=f4,zp=0,qp=1,g4=2,Hp=3,Wp=4,Gx=5,x4=6,Yx=7,Xx=8,Vp=9,Jx=10,vP=[2,3,7],yP=[3,3,11],v4=[280,256,256,256,40],wP=[0,1,1,1,0],bP=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],NP=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],SP=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],_P=8,Qx=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Zx=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],a0=null,kP=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],EP=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],y4=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],jP=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],AP=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],TP=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],CP=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Tl=[],ui=[],Mo=[],PP=1,w4=2,Cl=[],za=[];Do("UpsampleRgbLinePair",bl,3),Do("UpsampleBgrLinePair",Xn,3),Do("UpsampleRgbaLinePair",Fs,4),Do("UpsampleBgraLinePair",Yd,4),Do("UpsampleArgbLinePair",Gd,4),Do("UpsampleRgba4444LinePair",zc,2),Do("UpsampleRgb565LinePair",$c,2);var FP=C.UpsampleRgbLinePair,LP=C.UpsampleBgrLinePair,b4=C.UpsampleRgbaLinePair,N4=C.UpsampleBgraLinePair,S4=C.UpsampleArgbLinePair,_4=C.UpsampleRgba4444LinePair,DP=C.UpsampleRgb565LinePair,Kp=16,Gp=1<<Kp-1,i0=-227,e2=482,OP=6,k4=0,RP=a(256),IP=a(256),MP=a(256),BP=a(256),UP=a(e2-i0),$P=a(e2-i0);Oo("YuvToRgbRow",bl,3),Oo("YuvToBgrRow",Xn,3),Oo("YuvToRgbaRow",Fs,4),Oo("YuvToBgraRow",Yd,4),Oo("YuvToArgbRow",Gd,4),Oo("YuvToRgba4444Row",zc,2),Oo("YuvToRgb565Row",$c,2);var E4=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Yp=[0,2,8],zP=[8,7,6,4,4,2,2,2,1,1,1,1],qP=1;this.WebPDecodeRGBA=function(x,N,j,L,U){var W=qp,K=new Re,Y=new Xt;K.ba=Y,Y.S=W,Y.width=[Y.width],Y.height=[Y.height];var Z=Y.width,ae=Y.height,xe=new yt;if(xe==null||x==null)var Ae=2;else t(xe!=null),Ae=qc(x,N,j,xe.width,xe.height,xe.Pd,xe.Qd,xe.format,null);if(Ae!=0?Z=0:(Z!=null&&(Z[0]=xe.width[0]),ae!=null&&(ae[0]=xe.height[0]),Z=1),Z){Y.width=Y.width[0],Y.height=Y.height[0],L!=null&&(L[0]=Y.width),U!=null&&(U[0]=Y.height);e:{if(L=new Qu,(U=new $e).data=x,U.w=N,U.ha=j,U.kd=1,N=[0],t(U!=null),((x=qc(U.data,U.w,U.ha,null,null,null,N,null,U))==0||x==7)&&N[0]&&(x=4),(N=x)==0){if(t(K!=null),L.data=U.data,L.w=U.w+U.offset,L.ha=U.ha-U.offset,L.put=Et,L.ac=Ra,L.bc=ai,L.ma=K,U.xa){if((x=ke())==null){K=1;break e}if(function(ie,we){var Ne=[0],Fe=[0],je=[0];t:for(;;){if(ie==null)return 0;if(we==null)return ie.a=2,0;if(ie.l=we,ie.a=0,G(ie.m,we.data,we.w,we.ha),!ii(ie.m,Ne,Fe,je)){ie.a=3;break t}if(ie.xb=w4,we.width=Ne[0],we.height=Fe[0],!Ee(Ne[0],Fe[0],1,ie,null))break t;return 1}return t(ie.a!=0),0}(x,L)){if(L=(N=Nl(L.width,L.height,K.Oa,K.ba))==0){t:{L=x;r:for(;;){if(L==null){L=0;break t}if(t(L.s.yc!=null),t(L.s.Ya!=null),t(0<L.s.Wb),t((j=L.l)!=null),t((U=j.ma)!=null),L.xb!=0){if(L.ca=U.ba,L.tb=U.tb,t(L.ca!=null),!Xd(U.Oa,j,Hp)){L.a=2;break r}if(!Te(L,j.width)||j.da)break r;if((j.da||kt(L.ca.S))&&ci(),11>L.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),L.ca.f.kb.F!=null&&ci()),L.Pb&&0<L.s.ua&&L.s.vb.X==null&&!J(L.s.vb,L.s.Wa.Xa)){L.a=1;break r}L.xb=0}if(!_e(L,L.V,L.Ba,L.c,L.i,j.o,Q))break r;U.Dc=L.Ma,L=1;break t}t(L.a!=0),L=0}L=!L}L&&(N=x.a)}else N=x.a}else{if((x=new Fx)==null){K=1;break e}if(x.Fa=U.na,x.P=U.P,x.qc=U.Sa,Hi(x,L)){if((N=Nl(L.width,L.height,K.Oa,K.ba))==0){if(x.Aa=0,j=K.Oa,t((U=x)!=null),j!=null){if(0<(Z=0>(Z=j.Md)?0:100<Z?255:255*Z/100)){for(ae=xe=0;4>ae;++ae)12>(Ae=U.pb[ae]).lc&&(Ae.ia=Z*zP[0>Ae.lc?0:Ae.lc]>>3),xe|=Ae.ia;xe&&(alert("todo:VP8InitRandom"),U.ia=1)}U.Ga=j.Id,100<U.Ga?U.Ga=100:0>U.Ga&&(U.Ga=0)}(function(ie,we){if(ie==null)return 0;if(we==null)return yn(ie,2,"NULL VP8Io parameter in VP8Decode().");if(!ie.cb&&!Hi(ie,we))return 0;if(t(ie.cb),we.ac==null||we.ac(we)){we.ob&&(ie.L=0);var Ne=Yp[ie.L];if(ie.L==2?(ie.yb=0,ie.zb=0):(ie.yb=we.v-Ne>>4,ie.zb=we.j-Ne>>4,0>ie.yb&&(ie.yb=0),0>ie.zb&&(ie.zb=0)),ie.Va=we.o+15+Ne>>4,ie.Hb=we.va+15+Ne>>4,ie.Hb>ie.za&&(ie.Hb=ie.za),ie.Va>ie.Ub&&(ie.Va=ie.Ub),0<ie.L){var Fe=ie.ed;for(Ne=0;4>Ne;++Ne){var je;if(ie.Qa.Cb){var De=ie.Qa.Lb[Ne];ie.Qa.Fb||(De+=Fe.Tb)}else De=Fe.Tb;for(je=0;1>=je;++je){var Ie=ie.gd[Ne][je],He=De;if(Fe.Pc&&(He+=Fe.vd[0],je&&(He+=Fe.od[0])),0<(He=0>He?0:63<He?63:He)){var ze=He;0<Fe.wb&&(ze=4<Fe.wb?ze>>2:ze>>1)>9-Fe.wb&&(ze=9-Fe.wb),1>ze&&(ze=1),Ie.dd=ze,Ie.tc=2*He+ze,Ie.ld=40<=He?2:15<=He?1:0}else Ie.tc=0;Ie.La=je}}}Ne=0}else yn(ie,6,"Frame setup failed"),Ne=ie.a;if(Ne=Ne==0){if(Ne){ie.$c=0,0<ie.Aa||(ie.Ic=qP);t:{Ne=ie.Ic,Fe=4*(ze=ie.za);var xt=32*ze,ot=ze+1,Gt=0<ie.L?ze*(0<ie.Aa?2:1):0,dt=(ie.Aa==2?2:1)*ze;if((Ie=Fe+832+(je=3*(16*Ne+Yp[ie.L])/2*xt)+(De=ie.Fa!=null&&0<ie.Fa.length?ie.Kc.c*ie.Kc.i:0))!=Ie)Ne=0;else{if(Ie>ie.Vb){if(ie.Vb=0,ie.Ec=a(Ie),ie.Fc=0,ie.Ec==null){Ne=yn(ie,1,"no memory during frame initialization.");break t}ie.Vb=Ie}Ie=ie.Ec,He=ie.Fc,ie.Ac=Ie,ie.Bc=He,He+=Fe,ie.Gd=i(xt,Ia),ie.Hd=0,ie.rb=i(ot+1,Xr),ie.sb=1,ie.wa=Gt?i(Gt,Qt):null,ie.Y=0,ie.D.Nb=0,ie.D.wa=ie.wa,ie.D.Y=ie.Y,0<ie.Aa&&(ie.D.Y+=ze),t(!0),ie.oc=Ie,ie.pc=He,He+=832,ie.ya=i(dt,oi),ie.aa=0,ie.D.ya=ie.ya,ie.D.aa=ie.aa,ie.Aa==2&&(ie.D.aa+=ze),ie.R=16*ze,ie.B=8*ze,ze=(xt=Yp[ie.L])*ie.R,xt=xt/2*ie.B,ie.sa=Ie,ie.ta=He+ze,ie.qa=ie.sa,ie.ra=ie.ta+16*Ne*ie.R+xt,ie.Ha=ie.qa,ie.Ia=ie.ra+8*Ne*ie.B+xt,ie.$c=0,He+=je,ie.mb=De?Ie:null,ie.nb=De?He:null,t(He+De<=ie.Fc+ie.Vb),Ap(ie),s(ie.Ac,ie.Bc,0,Fe),Ne=1}}if(Ne){if(we.ka=0,we.y=ie.sa,we.O=ie.ta,we.f=ie.qa,we.N=ie.ra,we.ea=ie.Ha,we.Vd=ie.Ia,we.fa=ie.R,we.Rc=ie.B,we.F=null,we.J=0,!m4){for(Ne=-255;255>=Ne;++Ne)f4[255+Ne]=0>Ne?-Ne:Ne;for(Ne=-1020;1020>=Ne;++Ne)d4[1020+Ne]=-128>Ne?-128:127<Ne?127:Ne;for(Ne=-112;112>=Ne;++Ne)h4[112+Ne]=-16>Ne?-16:15<Ne?15:Ne;for(Ne=-255;510>=Ne;++Ne)p4[255+Ne]=0>Ne?0:255<Ne?255:Ne;m4=1}Al=ef,Vc=Dx,Gi=Wi,dr=Cp,wr=Pp,Ua=Lx,an=Rp,Pn=Mc,Io=B,n0=ce,of=Ip,Up=_,r4=de,n4=be,s4=Ic,a4=Vd,i4=Dp,o4=Op,ui[0]=zx,ui[1]=Ox,ui[2]=Ux,ui[3]=$x,ui[4]=jo,ui[5]=qx,ui[6]=Ao,ui[7]=Hx,ui[8]=$d,ui[9]=tf,Tl[0]=Mx,Tl[1]=Ix,Tl[2]=Bd,Tl[3]=Fp,Tl[4]=Oc,Tl[5]=Ud,Tl[6]=Bx,Mo[0]=Vx,Mo[1]=Rx,Mo[2]=Rc,Mo[3]=Wx,Mo[4]=qd,Mo[5]=zd,Mo[6]=Lp,Ne=1}else Ne=0}Ne&&(Ne=function(Zt,Fn){for(Zt.M=0;Zt.M<Zt.Va;++Zt.M){var Yt,ht=Zt.Jc[Zt.M&Zt.Xb],Qe=Zt.m,on=Zt;for(Yt=0;Yt<on.za;++Yt){var zt=Qe,sr=on,Fr=sr.Ac,Jn=sr.Bc+4*Yt,Ls=sr.zc,Jr=sr.ya[sr.aa+Yt];if(sr.Qa.Bb?Jr.$b=pe(zt,sr.Pa.jb[0])?2+pe(zt,sr.Pa.jb[2]):pe(zt,sr.Pa.jb[1]):Jr.$b=0,sr.kc&&(Jr.Ad=pe(zt,sr.Bd)),Jr.Za=!pe(zt,145)+0,Jr.Za){var fs=Jr.Ob,Ds=0;for(sr=0;4>sr;++sr){var Ln,lr=Ls[0+sr];for(Ln=0;4>Ln;++Ln){lr=AP[Fr[Jn+Ln]][lr];for(var pr=y4[pe(zt,lr[0])];0<pr;)pr=y4[2*pr+pe(zt,lr[pr])];lr=-pr,Fr[Jn+Ln]=lr}n(fs,Ds,Fr,Jn,4),Ds+=4,Ls[0+sr]=lr}}else lr=pe(zt,156)?pe(zt,128)?1:3:pe(zt,163)?2:0,Jr.Ob[0]=lr,s(Fr,Jn,lr,4),s(Ls,0,lr,4);Jr.Dd=pe(zt,142)?pe(zt,114)?pe(zt,183)?1:3:2:0}if(on.m.Ka)return yn(Zt,7,"Premature end-of-partition0 encountered.");for(;Zt.ja<Zt.za;++Zt.ja){if(on=ht,zt=(Qe=Zt).rb[Qe.sb-1],Fr=Qe.rb[Qe.sb+Qe.ja],Yt=Qe.ya[Qe.aa+Qe.ja],Jn=Qe.kc?Yt.Ad:0)zt.la=Fr.la=0,Yt.Za||(zt.Na=Fr.Na=0),Yt.Hc=0,Yt.Gc=0,Yt.ia=0;else{var Qr,mr;if(zt=Fr,Fr=on,Jn=Qe.Pa.Xc,Ls=Qe.ya[Qe.aa+Qe.ja],Jr=Qe.pb[Ls.$b],sr=Ls.ad,fs=0,Ds=Qe.rb[Qe.sb-1],lr=Ln=0,s(sr,fs,0,384),Ls.Za)var Qn=0,fi=Jn[3];else{pr=a(16);var ln=zt.Na+Ds.Na;if(ln=a0(Fr,Jn[1],ln,Jr.Eb,0,pr,0),zt.Na=Ds.Na=(0<ln)+0,1<ln)Al(pr,0,sr,fs);else{var Qs=pr[0]+3>>3;for(pr=0;256>pr;pr+=16)sr[fs+pr]=Qs}Qn=1,fi=Jn[0]}var br=15&zt.la,Dn=15&Ds.la;for(pr=0;4>pr;++pr){var ga=1&Dn;for(Qs=mr=0;4>Qs;++Qs)br=br>>1|(ga=(ln=a0(Fr,fi,ln=ga+(1&br),Jr.Sc,Qn,sr,fs))>Qn)<<7,mr=mr<<2|(3<ln?3:1<ln?2:sr[fs+0]!=0),fs+=16;br>>=4,Dn=Dn>>1|ga<<7,Ln=(Ln<<8|mr)>>>0}for(fi=br,Qn=Dn>>4,Qr=0;4>Qr;Qr+=2){for(mr=0,br=zt.la>>4+Qr,Dn=Ds.la>>4+Qr,pr=0;2>pr;++pr){for(ga=1&Dn,Qs=0;2>Qs;++Qs)ln=ga+(1&br),br=br>>1|(ga=0<(ln=a0(Fr,Jn[2],ln,Jr.Qc,0,sr,fs)))<<3,mr=mr<<2|(3<ln?3:1<ln?2:sr[fs+0]!=0),fs+=16;br>>=2,Dn=Dn>>1|ga<<5}lr|=mr<<4*Qr,fi|=br<<4<<Qr,Qn|=(240&Dn)<<Qr}zt.la=fi,Ds.la=Qn,Ls.Hc=Ln,Ls.Gc=lr,Ls.ia=43690&lr?0:Jr.ia,Jn=!(Ln|lr)}if(0<Qe.L&&(Qe.wa[Qe.Y+Qe.ja]=Qe.gd[Yt.$b][Yt.Za],Qe.wa[Qe.Y+Qe.ja].La|=!Jn),on.Ka)return yn(Zt,7,"Premature end-of-file encountered.")}if(Ap(Zt),Qe=Fn,on=1,Yt=(ht=Zt).D,zt=0<ht.L&&ht.M>=ht.zb&&ht.M<=ht.Va,ht.Aa==0)t:{if(Yt.M=ht.M,Yt.uc=zt,Ba(ht,Yt),on=1,Yt=(mr=ht.D).Nb,zt=(lr=Yp[ht.L])*ht.R,Fr=lr/2*ht.B,pr=16*Yt*ht.R,Qs=8*Yt*ht.B,Jn=ht.sa,Ls=ht.ta-zt+pr,Jr=ht.qa,sr=ht.ra-Fr+Qs,fs=ht.Ha,Ds=ht.Ia-Fr+Qs,Dn=(br=mr.M)==0,Ln=br>=ht.Va-1,ht.Aa==2&&Ba(ht,mr),mr.uc)for(ga=(ln=ht).D.M,t(ln.D.uc),mr=ln.yb;mr<ln.Hb;++mr){Qn=mr,fi=ga;var Os=(xa=(Zn=ln).D).Nb;Qr=Zn.R;var xa=xa.wa[xa.Y+Qn],va=Zn.sa,Zs=Zn.ta+16*Os*Qr+16*Qn,ya=xa.dd,Ar=xa.tc;if(Ar!=0)if(t(3<=Ar),Zn.L==1)0<Qn&&a4(va,Zs,Qr,Ar+4),xa.La&&o4(va,Zs,Qr,Ar),0<fi&&s4(va,Zs,Qr,Ar+4),xa.La&&i4(va,Zs,Qr,Ar);else{var wa=Zn.B,di=Zn.qa,Kc=Zn.ra+8*Os*wa+8*Qn,Bo=Zn.Ha,Zn=Zn.Ia+8*Os*wa+8*Qn;Os=xa.ld,0<Qn&&(Pn(va,Zs,Qr,Ar+4,ya,Os),n0(di,Kc,Bo,Zn,wa,Ar+4,ya,Os)),xa.La&&(Up(va,Zs,Qr,Ar,ya,Os),n4(di,Kc,Bo,Zn,wa,Ar,ya,Os)),0<fi&&(an(va,Zs,Qr,Ar+4,ya,Os),Io(di,Kc,Bo,Zn,wa,Ar+4,ya,Os)),xa.La&&(of(va,Zs,Qr,Ar,ya,Os),r4(di,Kc,Bo,Zn,wa,Ar,ya,Os))}}if(ht.ia&&alert("todo:DitherRow"),Qe.put!=null){if(mr=16*br,br=16*(br+1),Dn?(Qe.y=ht.sa,Qe.O=ht.ta+pr,Qe.f=ht.qa,Qe.N=ht.ra+Qs,Qe.ea=ht.Ha,Qe.W=ht.Ia+Qs):(mr-=lr,Qe.y=Jn,Qe.O=Ls,Qe.f=Jr,Qe.N=sr,Qe.ea=fs,Qe.W=Ds),Ln||(br-=lr),br>Qe.o&&(br=Qe.o),Qe.F=null,Qe.J=null,ht.Fa!=null&&0<ht.Fa.length&&mr<br&&(Qe.J=jr(ht,Qe,mr,br-mr),Qe.F=ht.mb,Qe.F==null&&Qe.F.length==0)){on=yn(ht,3,"Could not decode alpha data.");break t}mr<Qe.j&&(lr=Qe.j-mr,mr=Qe.j,t(!(1&lr)),Qe.O+=ht.R*lr,Qe.N+=ht.B*(lr>>1),Qe.W+=ht.B*(lr>>1),Qe.F!=null&&(Qe.J+=Qe.width*lr)),mr<br&&(Qe.O+=Qe.v,Qe.N+=Qe.v>>1,Qe.W+=Qe.v>>1,Qe.F!=null&&(Qe.J+=Qe.v),Qe.ka=mr-Qe.j,Qe.U=Qe.va-Qe.v,Qe.T=br-mr,on=Qe.put(Qe))}Yt+1!=ht.Ic||Ln||(n(ht.sa,ht.ta-zt,Jn,Ls+16*ht.R,zt),n(ht.qa,ht.ra-Fr,Jr,sr+8*ht.B,Fr),n(ht.Ha,ht.Ia-Fr,fs,Ds+8*ht.B,Fr))}if(!on)return yn(Zt,6,"Output aborted.")}return 1}(ie,we)),we.bc!=null&&we.bc(we),Ne&=1}return Ne?(ie.cb=0,Ne):0})(x,L)||(N=x.a)}}else N=x.a}N==0&&K.Oa!=null&&K.Oa.fd&&(N=Jd(K.ba))}K=N}W=K!=0?null:11>W?Y.f.RGBA.eb:Y.f.kb.y}else W=null;return W};var j4=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function f(C,R){for(var k="",P=0;P<4;P++)k+=String.fromCharCode(C[R++]);return k}function u(C,R){return C[R+0]|C[R+1]<<8}function p(C,R){return(C[R+0]|C[R+1]<<8|C[R+2]<<16)>>>0}function d(C,R){return(C[R+0]|C[R+1]<<8|C[R+2]<<16|C[R+3]<<24)>>>0}new c;var h=[0],m=[0],g=[],y=new c,v=e,b=function(C,R){var k={},P=0,q=!1,D=0,V=0;if(k.frames=[],!function(E,M){for(var I=0;I<4;I++)if(E[M+I]!="RIFF".charCodeAt(I))return!0;return!1}(C,R)){for(d(C,R+=4),R+=8;R<C.length;){var se=f(C,R),ne=d(C,R+=4);R+=4;var X=ne+(1&ne);switch(se){case"VP8 ":case"VP8L":k.frames[P]===void 0&&(k.frames[P]={}),(ye=k.frames[P]).src_off=q?V:R-8,ye.src_size=D+ne+8,P++,q&&(q=!1,D=0,V=0);break;case"VP8X":(ye=k.header={}).feature_flags=C[R];var G=R+4;ye.canvas_width=1+p(C,G),G+=3,ye.canvas_height=1+p(C,G),G+=3;break;case"ALPH":q=!0,D=X+8,V=R-8;break;case"ANIM":(ye=k.header).bgcolor=d(C,R),G=R+4,ye.loop_count=u(C,G),G+=2;break;case"ANMF":var ve,ye;(ye=k.frames[P]={}).offset_x=2*p(C,R),R+=3,ye.offset_y=2*p(C,R),R+=3,ye.width=1+p(C,R),R+=3,ye.height=1+p(C,R),R+=3,ye.duration=p(C,R),R+=3,ve=C[R++],ye.dispose=1&ve,ye.blend=ve>>1&1}se!="ANMF"&&(R+=X)}return k}}(v,0);b.response=v,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,S=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],m=[w.canvas_width];for(var A=0;A<S.length&&S[A].blend!=0;A++);}var F=S[0],T=y.WebPDecodeRGBA(v,F.src_off,F.src_size,m,h);F.rgba=T,F.imgwidth=m[0],F.imgheight=h[0];for(var O=0;O<m[0]*h[0]*4;O++)g[O]=T[O];return this.width=m,this.height=h,this.data=g,this}(function(e){var t,r,n,s,a,i,o,c,f,u=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new c,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new i,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new i,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new p(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,f=new u}]);var p=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var M=E;Object.defineProperty(this,"pdf",{get:function(){return M}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(J){I=!!J}});var z=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return z},set:function(J){z=!!J}});var te=0;Object.defineProperty(this,"posX",{get:function(){return te},set:function(J){isNaN(J)||(te=J)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(J){isNaN(J)||(fe=J)}}),Object.defineProperty(this,"margin",{get:function(){return f.margin},set:function(J){var Ue;typeof J=="number"?Ue=[J,J,J,J]:((Ue=new Array(4))[0]=J[0],Ue[1]=J.length>=2?J[1]:Ue[0],Ue[2]=J.length>=3?J[2]:Ue[0],Ue[3]=J.length>=4?J[3]:Ue[1]),f.margin=Ue}});var ge=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ge},set:function(J){ge=J}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(J){he=J}});var pe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return pe},set:function(J){pe=J}}),Object.defineProperty(this,"ctx",{get:function(){return f},set:function(J){J instanceof u&&(f=J)}}),Object.defineProperty(this,"path",{get:function(){return f.path},set:function(J){f.path=J}});var Le=[];Object.defineProperty(this,"ctxStack",{get:function(){return Le},set:function(J){Le=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var Ue;Ue=d(J),this.ctx.fillStyle=Ue.style,this.ctx.isFillTransparent=Ue.a===0,this.ctx.fillOpacity=Ue.a,this.pdf.setFillColor(Ue.r,Ue.g,Ue.b,{a:Ue.a}),this.pdf.setTextColor(Ue.r,Ue.g,Ue.b,{a:Ue.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var Ue=d(J);this.ctx.strokeStyle=Ue.style,this.ctx.isStrokeTransparent=Ue.a===0,this.ctx.strokeOpacity=Ue.a,Ue.a===0?this.pdf.setDrawColor(255,255,255):(Ue.a,this.pdf.setDrawColor(Ue.r,Ue.g,Ue.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var ee=null,We=null,Ge=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ge},set:function(J){ee=null,We=null,Ge=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var Ue;if(this.ctx.font=J,(Ue=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var Me=Ue[1];Ue[2];var rt=Ue[3],Be=Ue[4];Ue[5];var ft=Ue[6],et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Be)[2];Be=Math.floor(et==="px"?parseFloat(Be)*this.pdf.internal.scaleFactor:et==="em"?parseFloat(Be)*this.pdf.getFontSize():parseFloat(Be)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Be);var gt=function(Je){var nr,wt,Ct=[],qt=Je.trim();if(qt==="")return Tv;if(qt in gk)return[gk[qt]];for(;qt!=="";){switch(wt=null,nr=(qt=vk(qt)).charAt(0)){case'"':case"'":wt=iZ(qt.substring(1),nr);break;default:wt=oZ(qt)}if(wt===null||(Ct.push(wt[0]),(qt=vk(wt[1]))!==""&&qt.charAt(0)!==","))return Tv;qt=qt.replace(/^,/,"")}return Ct}(ft);if(this.fontFaces){var ct=function(Je,nr){var wt=Je.getFontList(),Ct=JSON.stringify(wt);if(ee===null||We!==Ct){var qt=function(kr){var vt=[];return Object.keys(kr).forEach(function(hr){kr[hr].forEach(function(kt){var Lt=null;switch(kt){case"bold":Lt={family:hr,weight:"bold"};break;case"italic":Lt={family:hr,style:"italic"};break;case"bolditalic":Lt={family:hr,weight:"bold",style:"italic"};break;case"":case"normal":Lt={family:hr}}Lt!==null&&(Lt.ref={name:hr,style:kt},vt.push(Lt))})}),vt}(wt);ee=function(kr){for(var vt={},hr=0;hr<kr.length;++hr){var kt=Av(kr[hr]),Lt=kt.family,Er=kt.stretch,Xt=kt.style,yt=kt.weight;vt[Lt]=vt[Lt]||{},vt[Lt][Er]=vt[Lt][Er]||{},vt[Lt][Er][Xt]=vt[Lt][Er][Xt]||{},vt[Lt][Er][Xt][yt]=kt}return vt}(qt.concat(nr)),We=Ct}return ee}(this.pdf,this.fontFaces),Mt=gt.map(function(Je){return{family:Je,stretch:"normal",weight:rt,style:Me}}),Ft=function(Je,nr,wt){for(var Ct=(wt=wt||{}).defaultFontFamily||"times",qt=Object.assign({},aZ,wt.genericFontFamilies||{}),kr=null,vt=null,hr=0;hr<nr.length;++hr)if(qt[(kr=Av(nr[hr])).family]&&(kr.family=qt[kr.family]),Je.hasOwnProperty(kr.family)){vt=Je[kr.family];break}if(!(vt=vt||Je[Ct]))throw new Error("Could not find a font-family for the rule '"+xk(kr)+"' and default family '"+Ct+"'.");if(vt=function(kt,Lt){if(Lt[kt])return Lt[kt];var Er=Gw[kt],Xt=Er<=Gw.normal?-1:1,yt=mk(Lt,X8,Er,Xt);if(!yt)throw new Error("Could not find a matching font-stretch value for "+kt);return yt}(kr.stretch,vt),vt=function(kt,Lt){if(Lt[kt])return Lt[kt];for(var Er=Y8[kt],Xt=0;Xt<Er.length;++Xt)if(Lt[Er[Xt]])return Lt[Er[Xt]];throw new Error("Could not find a matching font-style for "+kt)}(kr.style,vt),!(vt=function(kt,Lt){if(Lt[kt])return Lt[kt];if(kt===400&&Lt[500])return Lt[500];if(kt===500&&Lt[400])return Lt[400];var Er=sZ[kt],Xt=mk(Lt,J8,Er,kt<400?-1:1);if(!Xt)throw new Error("Could not find a matching font-weight for value "+kt);return Xt}(kr.weight,vt)))throw new Error("Failed to resolve a font for the rule '"+xk(kr)+"'.");return vt}(ct,Mt);this.pdf.setFont(Ft.ref.name,Ft.ref.style)}else{var St="";(rt==="bold"||parseInt(rt,10)>=700||Me==="bold")&&(St="bold"),Me==="italic"&&(St+="italic"),St.length===0&&(St="normal");for(var Kt="",_t={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},nt=0;nt<gt.length;nt++){if(this.pdf.internal.getFont(gt[nt],St,{noFallback:!0,disableWarning:!0})!==void 0){Kt=gt[nt];break}if(St==="bolditalic"&&this.pdf.internal.getFont(gt[nt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Kt=gt[nt],St="bold";else if(this.pdf.internal.getFont(gt[nt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Kt=gt[nt],St="normal";break}}if(Kt===""){for(var Xe=0;Xe<gt.length;Xe++)if(_t[gt[Xe]]){Kt=_t[gt[Xe]];break}}Kt=Kt===""?"Times":Kt,this.pdf.setFont(Kt,St)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,ye.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,ye.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};p.prototype.setLineDash=function(E){this.lineDash=E},p.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},p.prototype.fill=function(){S.call(this,"fill",!1)},p.prototype.stroke=function(){S.call(this,"stroke",!1)},p.prototype.beginPath=function(){this.path=[{type:"begin"}]},p.prototype.moveTo=function(E,M){if(isNaN(E)||isNaN(M))throw Nr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new i(E,M));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(E,M)},p.prototype.closePath=function(){var E=new i(0,0),M=0;for(M=this.path.length-1;M!==-1;M--)if(this.path[M].type==="begin"&&xr(this.path[M+1])==="object"&&typeof this.path[M+1].x=="number"){E=new i(this.path[M+1].x,this.path[M+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(E.x,E.y)},p.prototype.lineTo=function(E,M){if(isNaN(E)||isNaN(M))throw Nr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new i(E,M));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(I.x,I.y)},p.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},p.prototype.quadraticCurveTo=function(E,M,I,z){if(isNaN(I)||isNaN(z)||isNaN(E)||isNaN(M))throw Nr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var te=this.ctx.transform.applyToPoint(new i(I,z)),fe=this.ctx.transform.applyToPoint(new i(E,M));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:te.x,y:te.y}),this.ctx.lastPoint=new i(te.x,te.y)},p.prototype.bezierCurveTo=function(E,M,I,z,te,fe){if(isNaN(te)||isNaN(fe)||isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z))throw Nr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ge=this.ctx.transform.applyToPoint(new i(te,fe)),he=this.ctx.transform.applyToPoint(new i(E,M)),pe=this.ctx.transform.applyToPoint(new i(I,z));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:pe.x,y2:pe.y,x:ge.x,y:ge.y}),this.ctx.lastPoint=new i(ge.x,ge.y)},p.prototype.arc=function(E,M,I,z,te,fe){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z)||isNaN(te))throw Nr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var ge=this.ctx.transform.applyToPoint(new i(E,M));E=ge.x,M=ge.y;var he=this.ctx.transform.applyToPoint(new i(0,I)),pe=this.ctx.transform.applyToPoint(new i(0,0));I=Math.sqrt(Math.pow(he.x-pe.x,2)+Math.pow(he.y-pe.y,2))}Math.abs(te-z)>=2*Math.PI&&(z=0,te=2*Math.PI),this.path.push({type:"arc",x:E,y:M,radius:I,startAngle:z,endAngle:te,counterclockwise:fe})},p.prototype.arcTo=function(E,M,I,z,te){throw new Error("arcTo not implemented.")},p.prototype.rect=function(E,M,I,z){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z))throw Nr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,M),this.lineTo(E+I,M),this.lineTo(E+I,M+z),this.lineTo(E,M+z),this.lineTo(E,M),this.lineTo(E+I,M),this.lineTo(E,M)},p.prototype.fillRect=function(E,M,I,z){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z))throw Nr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var te={};this.lineCap!=="butt"&&(te.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(te.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,M,I,z),this.fill(),te.hasOwnProperty("lineCap")&&(this.lineCap=te.lineCap),te.hasOwnProperty("lineJoin")&&(this.lineJoin=te.lineJoin)}},p.prototype.strokeRect=function(E,M,I,z){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z))throw Nr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(E,M,I,z),this.stroke())},p.prototype.clearRect=function(E,M,I,z){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z))throw Nr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,M,I,z))},p.prototype.save=function(E){E=typeof E!="boolean"||E;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(M),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var z=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=z}},p.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var M=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(M),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},p.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var d=function(E){var M,I,z,te;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))M=0,I=0,z=0,te=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(fe!==null)M=parseInt(fe[1]),I=parseInt(fe[2]),z=parseInt(fe[3]),te=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)M=parseInt(fe[1]),I=parseInt(fe[2]),z=parseInt(fe[3]),te=parseFloat(fe[4]);else{if(te=1,typeof E=="string"&&E.charAt(0)!=="#"){var ge=new z8(E);E=ge.ok?ge.toHex():"#000000"}E.length===4?(M=E.substring(1,2),M+=M,I=E.substring(2,3),I+=I,z=E.substring(3,4),z+=z):(M=E.substring(1,3),I=E.substring(3,5),z=E.substring(5,7)),M=parseInt(M,16),I=parseInt(I,16),z=parseInt(z,16)}}return{r:M,g:I,b:z,a:te,style:E}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};p.prototype.fillText=function(E,M,I,z){if(isNaN(M)||isNaN(I)||typeof E!="string")throw Nr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(z=isNaN(z)?void 0:z,!h.call(this)){var te=X(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;P.call(this,{text:E,x:M,y:I,scale:fe,angle:te,align:this.textAlign,maxWidth:z})}},p.prototype.strokeText=function(E,M,I,z){if(isNaN(M)||isNaN(I)||typeof E!="string")throw Nr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){z=isNaN(z)?void 0:z;var te=X(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;P.call(this,{text:E,x:M,y:I,scale:fe,renderingMode:"stroke",angle:te,align:this.textAlign,maxWidth:z})}},p.prototype.measureText=function(E){if(typeof E!="string")throw Nr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var M=this.pdf,I=this.pdf.internal.scaleFactor,z=M.internal.getFontSize(),te=M.getStringUnitWidth(E)*z/M.internal.scaleFactor;return new function(fe){var ge=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ge}}),this}({width:te*=Math.round(96*I/72*1e4)/1e4})},p.prototype.scale=function(E,M){if(isNaN(E)||isNaN(M))throw Nr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new c(E,0,0,M,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},p.prototype.rotate=function(E){if(isNaN(E))throw Nr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var M=new c(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(M)},p.prototype.translate=function(E,M){if(isNaN(E)||isNaN(M))throw Nr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new c(1,0,0,1,E,M);this.ctx.transform=this.ctx.transform.multiply(I)},p.prototype.transform=function(E,M,I,z,te,fe){if(isNaN(E)||isNaN(M)||isNaN(I)||isNaN(z)||isNaN(te)||isNaN(fe))throw Nr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ge=new c(E,M,I,z,te,fe);this.ctx.transform=this.ctx.transform.multiply(ge)},p.prototype.setTransform=function(E,M,I,z,te,fe){E=isNaN(E)?1:E,M=isNaN(M)?0:M,I=isNaN(I)?0:I,z=isNaN(z)?1:z,te=isNaN(te)?0:te,fe=isNaN(fe)?0:fe,this.ctx.transform=new c(E,M,I,z,te,fe)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};p.prototype.drawImage=function(E,M,I,z,te,fe,ge,he,pe){var Le=this.pdf.getImageProperties(E),ee=1,We=1,Ge=1,J=1;z!==void 0&&he!==void 0&&(Ge=he/z,J=pe/te,ee=Le.width/z*he/z,We=Le.height/te*pe/te),fe===void 0&&(fe=M,ge=I,M=0,I=0),z!==void 0&&he===void 0&&(he=z,pe=te),z===void 0&&he===void 0&&(he=Le.width,pe=Le.height);var Ue=this.ctx.transform.decompose(),Me=X(Ue.rotate.shx),rt=new c,Be=(rt=(rt=(rt=rt.multiply(Ue.translate)).multiply(Ue.skew)).multiply(Ue.scale)).applyToRectangle(new o(fe-M*Ge,ge-I*J,z*ee,te*We));if(this.autoPaging){for(var ft,et=y.call(this,Be),gt=[],ct=0;ct<et.length;ct+=1)gt.indexOf(et[ct])===-1&&gt.push(et[ct]);w(gt);for(var Mt=gt[0],Ft=gt[gt.length-1],St=Mt;St<Ft+1;St++){this.pdf.setPage(St);var Kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],_t=St===1?this.posY+this.margin[0]:this.margin[0],nt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Je=St===1?0:nt+(St-2)*Xe;if(this.ctx.clip_path.length!==0){var nr=this.path;ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ft,this.posX+this.margin[3],-Je+_t+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=nr}var wt=JSON.parse(JSON.stringify(Be));wt=b([wt],this.posX+this.margin[3],-Je+_t+this.ctx.prevPageLastElemOffset)[0];var Ct=(St>Mt||St<Ft)&&g.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Kt,Xe,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",wt.x,wt.y,wt.w,wt.h,null,null,Me),Ct&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(E,"JPEG",Be.x,Be.y,Be.w,Be.h,null,null,Me)};var y=function(E,M,I){var z=[];M=M||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var te=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":z.push(Math.floor((E.y+te)/I)+1);break;case"arc":z.push(Math.floor((E.y+te-E.radius)/I)+1),z.push(Math.floor((E.y+te+E.radius)/I)+1);break;case"qct":var fe=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);z.push(Math.floor((fe.y+te)/I)+1),z.push(Math.floor((fe.y+fe.h+te)/I)+1);break;case"bct":var ge=ve(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);z.push(Math.floor((ge.y+te)/I)+1),z.push(Math.floor((ge.y+ge.h+te)/I)+1);break;case"rect":z.push(Math.floor((E.y+te)/I)+1),z.push(Math.floor((E.y+E.h+te)/I)+1)}for(var he=0;he<z.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<z[he];)v.call(this);return z},v=function(){var E=this.fillStyle,M=this.strokeStyle,I=this.font,z=this.lineCap,te=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=M,this.font=I,this.lineCap=z,this.lineWidth=te,this.lineJoin=fe},b=function(E,M,I){for(var z=0;z<E.length;z++)switch(E[z].type){case"bct":E[z].x2+=M,E[z].y2+=I;case"qct":E[z].x1+=M,E[z].y1+=I;default:E[z].x+=M,E[z].y+=I}return E},w=function(E){return E.sort(function(M,I){return M-I})},S=function(E,M){var I=this.fillStyle,z=this.strokeStyle,te=this.lineCap,fe=this.lineWidth,ge=Math.abs(fe*this.ctx.transform.scaleX),he=this.lineJoin;if(this.autoPaging){for(var pe,Le,ee=JSON.parse(JSON.stringify(this.path)),We=JSON.parse(JSON.stringify(this.path)),Ge=[],J=0;J<We.length;J++)if(We[J].x!==void 0)for(var Ue=y.call(this,We[J]),Me=0;Me<Ue.length;Me+=1)Ge.indexOf(Ue[Me])===-1&&Ge.push(Ue[Me]);for(var rt=0;rt<Ge.length;rt++)for(;this.pdf.internal.getNumberOfPages()<Ge[rt];)v.call(this);w(Ge);for(var Be=Ge[0],ft=Ge[Ge.length-1],et=Be;et<ft+1;et++){this.pdf.setPage(et),this.fillStyle=I,this.strokeStyle=z,this.lineCap=te,this.lineWidth=ge,this.lineJoin=he;var gt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=et===1?this.posY+this.margin[0]:this.margin[0],Mt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ft=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],St=et===1?0:Mt+(et-2)*Ft;if(this.ctx.clip_path.length!==0){var Kt=this.path;pe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(pe,this.posX+this.margin[3],-St+ct+this.ctx.prevPageLastElemOffset),A.call(this,E,!0),this.path=Kt}if(Le=JSON.parse(JSON.stringify(ee)),this.path=b(Le,this.posX+this.margin[3],-St+ct+this.ctx.prevPageLastElemOffset),M===!1||et===0){var _t=(et>Be||et<ft)&&g.call(this);_t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],gt,Ft,null).clip().discardPath()),A.call(this,E,M),_t&&this.pdf.restoreGraphicsState()}this.lineWidth=fe}this.path=ee}else this.lineWidth=ge,A.call(this,E,M),this.lineWidth=fe},A=function(E,M){if((E!=="stroke"||M||!m.call(this))&&(E==="stroke"||M||!h.call(this))){for(var I,z,te=[],fe=this.path,ge=0;ge<fe.length;ge++){var he=fe[ge];switch(he.type){case"begin":te.push({begin:!0});break;case"close":te.push({close:!0});break;case"mt":te.push({start:he,deltas:[],abs:[]});break;case"lt":var pe=te.length;if(fe[ge-1]&&!isNaN(fe[ge-1].x)&&(I=[he.x-fe[ge-1].x,he.y-fe[ge-1].y],pe>0)){for(;pe>=0;pe--)if(te[pe-1].close!==!0&&te[pe-1].begin!==!0){te[pe-1].deltas.push(I),te[pe-1].abs.push(he);break}}break;case"bct":I=[he.x1-fe[ge-1].x,he.y1-fe[ge-1].y,he.x2-fe[ge-1].x,he.y2-fe[ge-1].y,he.x-fe[ge-1].x,he.y-fe[ge-1].y],te[te.length-1].deltas.push(I);break;case"qct":var Le=fe[ge-1].x+2/3*(he.x1-fe[ge-1].x),ee=fe[ge-1].y+2/3*(he.y1-fe[ge-1].y),We=he.x+2/3*(he.x1-he.x),Ge=he.y+2/3*(he.y1-he.y),J=he.x,Ue=he.y;I=[Le-fe[ge-1].x,ee-fe[ge-1].y,We-fe[ge-1].x,Ge-fe[ge-1].y,J-fe[ge-1].x,Ue-fe[ge-1].y],te[te.length-1].deltas.push(I);break;case"arc":te.push({deltas:[],abs:[],arc:!0}),Array.isArray(te[te.length-1].abs)&&te[te.length-1].abs.push(he)}}z=M?null:E==="stroke"?"stroke":"fill";for(var Me=!1,rt=0;rt<te.length;rt++)if(te[rt].arc)for(var Be=te[rt].abs,ft=0;ft<Be.length;ft++){var et=Be[ft];et.type==="arc"?O.call(this,et.x,et.y,et.radius,et.startAngle,et.endAngle,et.counterclockwise,void 0,M,!Me):q.call(this,et.x,et.y),Me=!0}else if(te[rt].close===!0)this.pdf.internal.out("h"),Me=!1;else if(te[rt].begin!==!0){var gt=te[rt].start.x,ct=te[rt].start.y;D.call(this,te[rt].deltas,gt,ct),Me=!0}z&&C.call(this,z),M&&R.call(this)}},F=function(E){var M=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=M*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-I;case"top":return E+M-I;case"hanging":return E+M-2*I;case"middle":return E+M/2-I;default:return E}},T=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};p.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(M,I){this.colorStops.push([M,I])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},p.prototype.createPattern=function(){return this.createLinearGradient()},p.prototype.createRadialGradient=function(){return this.createLinearGradient()};var O=function(E,M,I,z,te,fe,ge,he,pe){for(var Le=se.call(this,I,z,te,fe),ee=0;ee<Le.length;ee++){var We=Le[ee];ee===0&&(pe?k.call(this,We.x1+E,We.y1+M):q.call(this,We.x1+E,We.y1+M)),V.call(this,E,M,We.x2,We.y2,We.x3,We.y3,We.x4,We.y4)}he?R.call(this):C.call(this,ge)},C=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},R=function(){this.pdf.clip(),this.pdf.discardPath()},k=function(E,M){this.pdf.internal.out(r(E)+" "+n(M)+" m")},P=function(E){var M;switch(E.align){case"right":case"end":M="right";break;case"center":M="center";break;default:M="left"}var I,z,te,fe=this.pdf.getTextDimensions(E.text),ge=F.call(this,E.y),he=T.call(this,ge)-fe.h,pe=this.ctx.transform.applyToPoint(new i(E.x,ge));if(this.autoPaging){var Le=this.ctx.transform.decompose(),ee=new c;ee=(ee=(ee=ee.multiply(Le.translate)).multiply(Le.skew)).multiply(Le.scale);for(var We=this.ctx.transform.applyToRectangle(new o(E.x,ge,fe.w,fe.h)),Ge=ee.applyToRectangle(new o(E.x,he,fe.w,fe.h)),J=y.call(this,Ge),Ue=[],Me=0;Me<J.length;Me+=1)Ue.indexOf(J[Me])===-1&&Ue.push(J[Me]);w(Ue);for(var rt=Ue[0],Be=Ue[Ue.length-1],ft=rt;ft<Be+1;ft++){this.pdf.setPage(ft);var et=ft===1?this.posY+this.margin[0]:this.margin[0],gt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[2],Mt=ct-this.margin[0],Ft=this.pdf.internal.pageSize.width-this.margin[1],St=Ft-this.margin[3],Kt=ft===1?0:gt+(ft-2)*Mt;if(this.ctx.clip_path.length!==0){var _t=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(I,this.posX+this.margin[3],-1*Kt+et),A.call(this,"fill",!0),this.path=_t}var nt=b([JSON.parse(JSON.stringify(Ge))],this.posX+this.margin[3],-Kt+et+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*E.scale),te=this.lineWidth,this.lineWidth=te*E.scale);var Xe=this.autoPaging!=="text";if(Xe||nt.y+nt.h<=ct){if(Xe||nt.y>=et&&nt.x<=Ft){var Je=Xe?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||Ft-nt.x)[0],nr=b([JSON.parse(JSON.stringify(We))],this.posX+this.margin[3],-Kt+et+this.ctx.prevPageLastElemOffset)[0],wt=Xe&&(ft>rt||ft<Be)&&g.call(this);wt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],St,Mt,null).clip().discardPath()),this.pdf.text(Je,nr.x,nr.y,{angle:E.angle,align:M,renderingMode:E.renderingMode}),wt&&this.pdf.restoreGraphicsState()}}else nt.y<ct&&(this.ctx.prevPageLastElemOffset+=ct-nt.y);E.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=te)}}else E.scale>=.01&&(z=this.pdf.internal.getFontSize(),this.pdf.setFontSize(z*E.scale),te=this.lineWidth,this.lineWidth=te*E.scale),this.pdf.text(E.text,pe.x+this.posX,pe.y+this.posY,{angle:E.angle,align:M,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(z),this.lineWidth=te)},q=function(E,M,I,z){I=I||0,z=z||0,this.pdf.internal.out(r(E+I)+" "+n(M+z)+" l")},D=function(E,M,I){return this.pdf.lines(E,M,I,null,null)},V=function(E,M,I,z,te,fe,ge,he){this.pdf.internal.out([t(s(I+E)),t(a(z+M)),t(s(te+E)),t(a(fe+M)),t(s(ge+E)),t(a(he+M)),"c"].join(" "))},se=function(E,M,I,z){for(var te=2*Math.PI,fe=Math.PI/2;M>I;)M-=te;var ge=Math.abs(I-M);ge<te&&z&&(ge=te-ge);for(var he=[],pe=z?-1:1,Le=M;ge>1e-5;){var ee=Le+pe*Math.min(ge,fe);he.push(ne.call(this,E,Le,ee)),ge-=Math.abs(ee-Le),Le=ee}return he},ne=function(E,M,I){var z=(I-M)/2,te=E*Math.cos(z),fe=E*Math.sin(z),ge=te,he=-fe,pe=ge*ge+he*he,Le=pe+ge*te+he*fe,ee=4/3*(Math.sqrt(2*pe*Le)-Le)/(ge*fe-he*te),We=ge-ee*he,Ge=he+ee*ge,J=We,Ue=-Ge,Me=z+M,rt=Math.cos(Me),Be=Math.sin(Me);return{x1:E*Math.cos(M),y1:E*Math.sin(M),x2:We*rt-Ge*Be,y2:We*Be+Ge*rt,x3:J*rt-Ue*Be,y3:J*Be+Ue*rt,x4:E*Math.cos(I),y4:E*Math.sin(I)}},X=function(E){return 180*E/Math.PI},G=function(E,M,I,z,te,fe){var ge=E+.5*(I-E),he=M+.5*(z-M),pe=te+.5*(I-te),Le=fe+.5*(z-fe),ee=Math.min(E,te,ge,pe),We=Math.max(E,te,ge,pe),Ge=Math.min(M,fe,he,Le),J=Math.max(M,fe,he,Le);return new o(ee,Ge,We-ee,J-Ge)},ve=function(E,M,I,z,te,fe,ge,he){var pe,Le,ee,We,Ge,J,Ue,Me,rt,Be,ft,et,gt,ct,Mt=I-E,Ft=z-M,St=te-I,Kt=fe-z,_t=ge-te,nt=he-fe;for(Le=0;Le<41;Le++)rt=(Ue=(ee=E+(pe=Le/40)*Mt)+pe*((Ge=I+pe*St)-ee))+pe*(Ge+pe*(te+pe*_t-Ge)-Ue),Be=(Me=(We=M+pe*Ft)+pe*((J=z+pe*Kt)-We))+pe*(J+pe*(fe+pe*nt-J)-Me),Le==0?(ft=rt,et=Be,gt=rt,ct=Be):(ft=Math.min(ft,rt),et=Math.min(et,Be),gt=Math.max(gt,rt),ct=Math.max(ct,Be));return new o(Math.round(ft),Math.round(et),Math.round(gt-ft),Math.round(ct-et))},ye=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,M,I=(E=this.ctx.lineDash,M=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:M}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(mt.API),function(e){var t=function(i){var o,c,f,u,p,d,h,m,g,y;for(c=[],f=0,u=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;u>f;f+=4)(p=(i.charCodeAt(f)<<24)+(i.charCodeAt(f+1)<<16)+(i.charCodeAt(f+2)<<8)+i.charCodeAt(f+3))!==0?(d=(p=((p=((p=((p=(p-(y=p%85))/85)-(g=p%85))/85)-(m=p%85))/85)-(h=p%85))/85)%85,c.push(d+33,h+33,m+33,g+33,y+33)):c.push(122);return function(v,b){for(var w=b;w>0;w--)v.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(i){var o,c,f,u,p,d=String,h="length",m=255,g="charCodeAt",y="slice",v="replace";for(i[y](-2),i=i[y](0,-2)[v](/\s/g,"")[v]("z","!!!!!"),f=[],u=0,p=(i+=o="uuuuu"[y](i[h]%5||5))[h];p>u;u+=5)c=52200625*(i[g](u)-33)+614125*(i[g](u+1)-33)+7225*(i[g](u+2)-33)+85*(i[g](u+3)-33)+(i[g](u+4)-33),f.push(m&c>>24,m&c>>16,m&c>>8,m&c);return function(b,w){for(var S=w;S>0;S--)b.pop()}(f,o[h]),d.fromCharCode.apply(d,f)},n=function(i){return i.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var c="",f=0;f<i.length;f+=2)c+=String.fromCharCode("0x"+(i[f]+i[f+1]));return c},a=function(i){for(var o=new Uint8Array(i.length),c=i.length;c--;)o[c]=i.charCodeAt(c);return(o=$w(o)).reduce(function(f,u){return f+String.fromCharCode(u)},"")};e.processDataByFilters=function(i,o){var c=0,f=i||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":f=r(f),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":f=t(f),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":f=s(f),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":f=n(f),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":f=a(f),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:f,reverseChain:u.reverse().join(" ")}}}(mt.API),function(e){e.loadFile=function(t,r,n){return function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=function(c,f,u){var p=new XMLHttpRequest,d=0,h=function(m){var g=m.length,y=[],v=String.fromCharCode;for(d=0;d<g;d+=1)y.push(v(255&m.charCodeAt(d)));return y.join("")};if(p.open("GET",c,!f),p.overrideMimeType("text/plain; charset=x-user-defined"),f===!1&&(p.onload=function(){p.status===200?u(h(this.responseText)):u(void 0)}),p.send(null),f&&p.status===200)return h(p.responseText)}(s,a,i)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(mt.API),function(e){function t(){return(Pt.html2canvas?Promise.resolve(Pt.html2canvas):uv(()=>import("./html2canvas.esm-CBrSDip1.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Pt.DOMPurify?Promise.resolve(Pt.DOMPurify):uv(()=>import("./purify.es-B6FQ9oRL.js"),[],import.meta.url)).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=xr(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(o,c){var f=document.createElement(o);for(var u in c.className&&(f.className=c.className),c.innerHTML&&c.dompurify&&(f.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)f.style[u]=c.style[u];return f},a=function o(c,f){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),p=c.firstChild;p;p=p.nextSibling)f!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||u.appendChild(o(p,f));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},i=function o(c){var f=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),f);return(u=u.setProgress(1,o,1,[o])).set(c)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,c){return o.__proto__=c||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(f){switch(n(f)){case"string":return"string";case"element":return f.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),c){case"string":return this.then(r).then(function(f){return this.set({src:s("div",{innerHTML:o,dompurify:f})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var f=Object.assign({},this.opt.html2canvas);return delete f.onrendered,c(this.prop.container,f)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var f=this.opt.jsPDF,u=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,f.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,f.context2d.posX=this.opt.x,f.context2d.posY=this.opt.y,f.context2d.margin=this.opt.margin,f.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var m=u[h],g=m.src.find(function(y){return y.format==="truetype"});g&&f.addFont(g.url,m.ref.name,m.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,f.context2d.save(!0),c(this.prop.container,d)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,c,f){return(f=f||"pdf").toLowerCase()==="img"||f.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},i.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(f){if(f in i.template.prop)return function(){this.prop[f]=o[f]};switch(f){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[f]=o[f]}}},this);return this.then(function(){return this.thenList(c)})},i.prototype.get=function(o,c){return this.then(function(){var f=o in i.template.prop?this.prop[o]:this.opt[o];return c?c(f):f})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function c(f,u){return Math.floor(f*u/72*96)}return this.then(function(){(o=o||mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,c,f,u){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),f!=null&&(this.progress.n=f),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,c,f,u){return this.setProgress(o?this.progress.val+o:null,c||null,f?this.progress.n+f:null,u?this.progress.stack.concat(u):null)},i.prototype.then=function(o,c){var f=this;return this.thenCore(o,c,function(u,p){return f.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(d){return f.updateProgress(null,u),d}).then(u,p).then(function(d){return f.updateProgress(1),d})})},i.prototype.thenCore=function(o,c,f){f=f||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),c&&(c=c.bind(u));var p=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:i.convert(Object.assign({},u),Promise.prototype),d=f.call(p,o,c);return i.convert(d,u.__proto__)},i.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},i.prototype.thenList=function(o){var c=this;return o.forEach(function(f){c=c.thenCore(f)}),c},i.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return i.convert(c,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,mt.getPageSize=function(o,c,f){if(xr(o)==="object"){var u=o;o=u.orientation,c=u.unit||c,f=u.format||f}c=c||"mm",f=f||"a4",o=(""+(o||"P")).toLowerCase();var p,d=(""+f).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var m,g=0,y=0;if(h.hasOwnProperty(d))g=h[d][1]/p,y=h[d][0]/p;else try{g=f[1],y=f[0]}catch{throw new Error("Invalid format: "+f)}if(o==="p"||o==="portrait")o="p",y>g&&(m=y,y=g,g=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>y&&(m=y,y=g,g=m)}return{width:y,height:g,unit:c,k:p,orientation:o}},e.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(Av):null;var f=new i(c);return c.worker?f:f.from(o).doCallback()}}(mt.API),mt.API.addJS=function(e){return wk=e,this.internal.events.subscribe("postPutResources",function(){Zm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Zm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),yk=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+wk+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Zm!==void 0&&yk!==void 0&&this.internal.out("/Names <</JavaScript "+Zm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],o=n.exec(i);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var f=this.internal.pages.length,u=[];for(a=0;a<f;a++){var p=r.internal.newObject();u.push(p);var d=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+d.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var c=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var f=0;f<n.children.length;f++)this.renderItems(n.children[f])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(mt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,a,i,o){var c,f=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(p){for(var d,h=256*p.charCodeAt(4)+p.charCodeAt(5),m=p.length,g={width:0,height:0,numcomponents:1},y=4;y<m;y+=2){if(y+=h,t.indexOf(p.charCodeAt(y+1))!==-1){d=256*p.charCodeAt(y+5)+p.charCodeAt(y+6),g={width:256*p.charCodeAt(y+7)+p.charCodeAt(y+8),height:d,numcomponents:p.charCodeAt(y+9)};break}h=256*p.charCodeAt(y+2)+p.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:f,index:n,alias:s}}return u}}(mt.API),mt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,a=HQ(e,{checkCrc:!0}),i=a.width,o=a.height,c=a.channels,f=a.palette,u=a.depth;s=f&&c===1?function(O){for(var C=O.width,R=O.height,k=O.data,P=O.palette,q=O.depth,D=!1,V=[],se=[],ne=void 0,X=!1,G=0,ve=0;ve<P.length;ve++){var ye=__(P[ve],4),E=ye[0],M=ye[1],I=ye[2],z=ye[3];V.push(E,M,I),z!=null&&(z===0?(G++,se.length<1&&se.push(ve)):z<255&&(X=!0))}if(X||G>1){D=!0,se=void 0;var te=C*R;ne=new Uint8Array(te);for(var fe=new DataView(k.buffer),ge=0;ge<te;ge++){var he=Cv(fe,ge,q),pe=__(P[he],4)[3];ne[ge]=pe}}else G===0&&(se=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:D?8:void 0,colorBytes:k,alphaBytes:ne,needSMask:D,palette:V,mask:se}}(a):c===2||c===4?function(O){for(var C=O.data,R=O.width,k=O.height,P=O.channels,q=O.depth,D=P===2?"DeviceGray":"DeviceRGB",V=P-1,se=R*k,ne=V,X=se*ne,G=1*se,ve=Math.ceil(X*q/8),ye=Math.ceil(G*q/8),E=new Uint8Array(ve),M=new Uint8Array(ye),I=new DataView(C.buffer),z=new DataView(E.buffer),te=new DataView(M.buffer),fe=!1,ge=0;ge<se;ge++){for(var he=ge*P,pe=0;pe<ne;pe++)Tk(z,Cv(I,he+pe,q),ge*ne+pe,q);var Le=Cv(I,he+ne,q);Le<(1<<q)-1&&(fe=!0),Tk(te,Le,1*ge,q)}return{colorSpace:D,colorsPerPixel:V,sMaskBitsPerComponent:fe?q:void 0,colorBytes:E,alphaBytes:M,needSMask:fe}}(a):function(O){var C=O.data,R=O.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:R,colorsPerPixel:R==="DeviceGray"?1:3,colorBytes:C instanceof Uint16Array?function(k){for(var P=k.length,q=new Uint8Array(2*P),D=new DataView(q.buffer,q.byteOffset,q.byteLength),V=0;V<P;V++)D.setUint16(2*V,k[V],!1);return q}(C):C,needSMask:!1}}(a);var p,d,h,m=s,g=m.colorSpace,y=m.colorsPerPixel,v=m.sMaskBitsPerComponent,b=m.colorBytes,w=m.alphaBytes,S=m.needSMask,A=m.palette,F=m.mask,T=null;return n!==mt.API.image_compression.NONE&&typeof $w=="function"?(T=function(O){var C;switch(O){case mt.API.image_compression.FAST:C=11;break;case mt.API.image_compression.MEDIUM:C=13;break;case mt.API.image_compression.SLOW:C=14;break;default:C=12}return C}(n),p=this.decode.FLATE_DECODE,d="/Predictor ".concat(T," /Colors ").concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(i),e=_k(b,Math.ceil(i*y*u/8),y,u,n),S&&(h=_k(w,Math.ceil(i*v/8),1,v,n))):(p=void 0,d=void 0,e=b,S&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:p,decodeParameters:d,transparency:F,palette:A,sMask:h,predictor:T,width:i,height:o,bitsPerComponent:u,sMaskBitsPerComponent:v,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var a=new fZ(t),i=a.width,o=a.height,c=[];a.decodeAndBlitFrameRGBA(0,c);var f={data:c,width:i,height:o},u=new Pv(100).encode(f,100);return e.processJPEG.call(this,u,r,n,s)},e.processGIF87A=e.processGIF89A}(mt.API),gi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},gi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Nr.log("bit decode error:"+r)}},gi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var c=this.palette[a>>7-o&1];this.data[i+4*o]=c.blue,this.data[i+4*o+1]=c.green,this.data[i+4*o+2]=c.red,this.data[i+4*o+3]=255}r!==0&&(this.pos+=4-r)}},gi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,o=a>>4,c=15&a,f=this.palette[o];if(this.data[i]=f.blue,this.data[i+1]=f.green,this.data[i+2]=f.red,this.data[i+3]=255,2*s+1>=this.width)break;f=this.palette[c],this.data[i+4]=f.blue,this.data[i+4+1]=f.green,this.data[i+4+2]=f.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},gi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},gi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,c=(a>>10&t)/t*255|0,f=a>>15?255:0,u=n*this.width*4+4*s;this.data[u]=c,this.data[u+1]=o,this.data[u+2]=i,this.data[u+3]=f}this.pos+=e}},gi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,c=(i>>5&r)/r*255|0,f=(i>>11)/t*255|0,u=s*this.width*4+4*a;this.data[u]=f,this.data[u+1]=c,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},gi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},gi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=i}},gi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var a=new gi(t,!1),i=a.width,o=a.height,c={data:a.getData(),width:i,height:o},f=new Pv(100).encode(c,100);return e.processJPEG.call(this,f,r,n,s)}}(mt.API),Pk.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var a=new Pk(t),i=a.width,o=a.height,c={data:a.getData(),width:i,height:o},f=new Pv(100).encode(c,100);return e.processJPEG.call(this,f,r,n,s)}}(mt.API),mt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),o=0,c=0,f=0;f<s;f+=4){var u=n[f],p=n[f+1],d=n[f+2],h=n[f+3];a[o++]=u,a[o++]=p,a[o++]=d,i[c++]=h}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},vf=mt.API,e1=vf.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:s.metadata.Unicode.widths,c=o.fof?o.fof:1,f=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=f.fof?f.fof:1,p=t.doKerning!==!1,d=0,h=e.length,m=0,g=o[0]||c,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?y.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(d=p&&xr(f[n])==="object"&&!isNaN(parseInt(f[n][m],10))?f[n][m]/u:0,y.push((o[n]||g)/c+d)),m=n;return y},bk=vf.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return vf.processArabic&&(e=vf.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:e1.apply(this,arguments).reduce(function(a,i){return a+i},0)},Nk=function(e,t,r,n){for(var s=[],a=0,i=e.length,o=0;a!==i&&o+t[a]<r;)o+=t[a],a++;s.push(e.slice(0,a));var c=a;for(o=0;a!==i;)o+t[a]>n&&(s.push(e.slice(c,a)),o=0,c=a),o+=t[a],a++;return c!==a&&s.push(e.slice(c,a)),s},Sk=function(e,t,r){r||(r={});var n,s,a,i,o,c,f,u=[],p=[u],d=r.textIndent||0,h=0,m=0,g=e.split(" "),y=e1.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var v=Array(c).join(" "),b=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?b=b.concat(S.map(function(A,F){return(F&&A.length?`
`:"")+A})):b.push(S[0])}),g=b,c=bk.apply(this,[v,r])}for(a=0,i=g.length;a<i;a++){var w=0;if(n=g[a],c&&n[0]==`
`&&(n=n.substr(1),w=1),d+h+(m=(s=e1.apply(this,[n,r])).reduce(function(S,A){return S+A},0))>t||w){if(m>t){for(o=Nk.apply(this,[n,s,t-(d+h),t]),u.push(o.shift()),u=[o.pop()];o.length;)p.push([o.shift()]);m=s.slice(n.length-(u[0]?u[0].length:0)).reduce(function(S,A){return S+A},0)}else u=[n];p.push(u),d=m+c,h=y}else u.push(n),d+=h+m,h=y}return f=c?function(S,A){return(A?v:"")+S.join(" ")}:function(S){return S.join(" ")},p.map(f)},vf.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var p=this.internal.getFont(u.fontName,u.fontStyle),d="Unicode";return p.metadata[d]?{widths:p.metadata[d].widths||{0:1},kerning:p.metadata[d].kerning||{}}:{font:p.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var o,c,f=[];for(o=0,c=n.length;o<c;o++)f=f.concat(Sk.apply(this,[n[o],i,a]));return f},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=t[a],s[t[a]]=r[a];var i=function(d){return"0x"+parseInt(d,10).toString(16)},o=e.__fontmetrics__.compress=function(d){var h,m,g,y,v=["{"];for(var b in d){if(h=d[b],isNaN(parseInt(b,10))?m="'"+b+"'":(b=parseInt(b,10),m=(m=i(b).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof h=="number")h<0?(g=i(h).slice(3),y="-"):(g=i(h).slice(2),y=""),g=y+g.slice(0,-1)+s[g.slice(-1)];else{if(xr(h)!=="object")throw new Error("Don't know what to do with value type "+xr(h)+".");g=o(h)}v.push(m+g)}return v.push("}"),v.join("")},c=e.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,m,g,y,v={},b=1,w=v,S=[],A="",F="",T=d.length-1,O=1;O<T;O+=1)(y=d[O])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(S.push([w,g]),w={},g=void 0):y=="}"?((m=S.pop())[0][m[1]]=w,g=void 0,w=m[0]):y=="-"?b=-1:g===void 0?n.hasOwnProperty(y)?(A+=n[y],g=parseInt(A,16)*b,b=1,A=""):A+=y:n.hasOwnProperty(y)?(F+=n[y],w[g]=parseInt(F,16)*b,b=1,g=void 0,F=""):F+=y;return v},f={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:f,"Courier-Bold":f,"Courier-BoldOblique":f,"Courier-Oblique":f,Helvetica:f,"Helvetica-Bold":f,"Helvetica-BoldOblique":f,"Helvetica-Oblique":f,"Times-Roman":f,"Times-Bold":f,"Times-BoldItalic":f,"Times-Italic":f}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(d){var h=d.font,m=p.Unicode[h.postScriptName];m&&(h.metadata.Unicode={},h.metadata.Unicode.widths=m.widths,h.metadata.Unicode.kerning=m.kerning);var g=u.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(mt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(F1(o)),i.metadata=e.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(mt),mt.API.addSvgAsImage=function(e,t,r,n,s,a,i,o){if(isNaN(t)||isNaN(r))throw Nr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Nr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var f=c.getContext("2d");f.fillStyle="#fff",f.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return(Pt.canvg?Promise.resolve(Pt.canvg):uv(()=>import("./index.es-DEt2vVPB.js"),[],import.meta.url)).catch(function(d){return Promise.reject(new Error("Could not load canvg: "+d))}).then(function(d){return d.default?d.default:d}).then(function(d){return d.fromString(f,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(d){return d.render(u)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),t,r,n,s,i,o)})},mt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},mt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),c=[],f=0,u=0,p=0;function d(m,g){var y,v=!1;for(y=0;y<m.length;y+=1)m[y]===g&&(v=!0);return v}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(p=0;p<h;p+=1)r[o[p]].value=r[o[p]].defaultValue,r[o[p]].explicitSet=!1}if(xr(e)==="object"){for(s in e)if(a=e[s],d(o,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&d(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(f=0;f<a.length;f+=1)if(n=!0,a[f].length===1&&typeof a[f][0]=="number")c.push(String(a[f]-1));else if(a[f].length>1){for(u=0;u<a[f].length;u+=1)typeof a[f][u]!="number"&&(n=!1);n===!0&&c.push([a[f][0]-1,a[f][1]-1].join(" "))}r[s].value="["+c.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),f=a.length+i.length+o.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+f+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(mt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,i){for(var o,c=i.metadata.Unicode.widths,f=["","0","00","000","0000"],u=[""],p=0,d=a.length;p<d;++p){if(o=i.metadata.characterToGlyph(a.charCodeAt(p)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=a.charCodeAt(p),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(f[4-o.length],o)}return u.join("")},n=function(a){var i,o,c,f,u,p,d;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],p=0,d=(o=Object.keys(a).sort(function(h,m){return h-m})).length;p<d;p++)i=o[p],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(f=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),c.push("<"+i+"><"+f+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(i){var o=i.font,c=i.out,f=i.newObject,u=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var p=o.metadata.Unicode.widths,d=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",m=0;m<d.length;m++)h+=String.fromCharCode(d[m]);var g=f();u({data:h,addLength1:!0,objectId:g}),c("endobj");var y=f();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var v=f();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+_f(o.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var b=f();c("<<"),c("/Type /Font"),c("/BaseFont /"+_f(o.fontName)),c("/FontDescriptor "+v+" 0 R"),c("/W "+e.API.PDFObject.convert(p)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=f(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+_f(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(i){var o=i.font,c=i.out,f=i.newObject,u=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var p=o.metadata.rawData,d="",h=0;h<p.length;h++)d+=String.fromCharCode(p[h]);var m=f();u({data:d,addLength1:!0,objectId:m}),c("endobj");var g=f();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=f();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+m+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+_f(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=f();for(var v=0;v<o.metadata.hmtx.widths.length;v++)o.metadata.hmtx.widths[v]=parseInt(o.metadata.hmtx.widths[v]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+_f(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,o=a.text||"",c=a.x,f=a.y,u=a.options||{},p=a.mutex||{},d=p.pdfEscape,h=p.activeFontKey,m=p.fonts,g=h,y="",v=0,b="",w=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:o,x:c,y:f,options:u,mutex:p};for(b=o,g=h,Array.isArray(o)&&(b=o[0]),v=0;v<b.length;v+=1)m[g].metadata.hasOwnProperty("cmap")&&(i=m[g].metadata.cmap.unicode.codeMap[b[v].charCodeAt(0)]),i||b[v].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?y+=b[v]:y+="";var S="";return parseInt(g.slice(1))<14||w==="WinAnsiEncoding"?S=d(y,g).split("").map(function(A){return A.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(S=r(y,m[g])),p.isHex=!0,{text:S,x:c,y:f,options:u,mutex:p}};t.events.push(["postProcessText",function(a){var i=a.text||"",o=[],c={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var f=0;for(f=0;f<i.length;f+=1)Array.isArray(i[f])&&i[f].length===3?o.push([s(Object.assign({},c,{text:i[f][0]})).text,i[f][1],i[f][2]]):o.push(s(Object.assign({},c,{text:i[f]})).text);a.text=o}else a.text=s(Object.assign({},c,{text:i})).text}])}(mt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,a,i,o,c,f,u,p=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],v=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var S=function(k){var P=k.charCodeAt(),q=P>>8,D=g[q];return D!==void 0?p[256*D+(255&P)]:q===252||q===253?"AL":v.test(q)?"L":q===8?"R":"N"},A=function(k){for(var P,q=0;q<k.length;q++){if((P=S(k.charAt(q)))==="L")return!1;if(P==="R")return!0}return!1},F=function(k,P,q,D){var V,se,ne,X,G=P[D];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(G="AN");break;case"AL":b=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":D<1||D+1>=P.length||(V=q[D-1])!=="EN"&&V!=="AN"||(se=P[D+1])!=="EN"&&se!=="AN"?G="N":b&&(se="AN"),G=se===V?se:"N";break;case"ES":G=(V=D>0?q[D-1]:"B")==="EN"&&D+1<P.length&&P[D+1]==="EN"?"EN":"N";break;case"ET":if(D>0&&q[D-1]==="EN"){G="EN";break}if(b){G="N";break}for(ne=D+1,X=P.length;ne<X&&P[ne]==="ET";)ne++;G=ne<X&&P[ne]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(X=P.length,ne=D+1;ne<X&&P[ne]==="NSM";)ne++;if(ne<X){var ve=k[D],ye=ve>=1425&&ve<=2303||ve===64286;if(V=P[ne],ye&&(V==="R"||V==="AL")){G="R";break}}}G=D<1||(V=P[D-1])==="B"?"N":q[D-1];break;case"B":b=!1,s=!0,G=w;break;case"S":a=!0,G="N"}return G},T=function(k,P,q){var D=k.split("");return q&&O(D,q,{hiLevel:w}),D.reverse(),P&&P.reverse(),D.join("")},O=function(k,P,q){var D,V,se,ne,X,G=-1,ve=k.length,ye=0,E=[],M=w?h:d,I=[];for(b=!1,s=!1,a=!1,V=0;V<ve;V++)I[V]=S(k[V]);for(se=0;se<ve;se++){if(X=ye,E[se]=F(k,I,E,se),D=240&(ye=M[X][m[E[se]]]),ye&=15,P[se]=ne=M[ye][5],D>0)if(D===16){for(V=G;V<se;V++)P[V]=1;G=-1}else G=-1;if(M[ye][6])G===-1&&(G=se);else if(G>-1){for(V=G;V<se;V++)P[V]=ne;G=-1}I[se]==="B"&&(P[se]=0),q.hiLevel|=ne}a&&function(z,te,fe){for(var ge=0;ge<fe;ge++)if(z[ge]==="S"){te[ge]=w;for(var he=ge-1;he>=0&&z[he]==="WS";he--)te[he]=w}}(I,P,ve)},C=function(k,P,q,D,V){if(!(V.hiLevel<k)){if(k===1&&w===1&&!s)return P.reverse(),void(q&&q.reverse());for(var se,ne,X,G,ve=P.length,ye=0;ye<ve;){if(D[ye]>=k){for(X=ye+1;X<ve&&D[X]>=k;)X++;for(G=ye,ne=X-1;G<ne;G++,ne--)se=P[G],P[G]=P[ne],P[ne]=se,q&&(se=q[G],q[G]=q[ne],q[ne]=se);ye=X}ye++}}},R=function(k,P,q){var D=k.split(""),V={hiLevel:w};return q||(q=[]),O(D,q,V),function(se,ne,X){if(X.hiLevel!==0&&u)for(var G,ve=0;ve<se.length;ve++)ne[ve]===1&&(G=y.indexOf(se[ve]))>=0&&(se[ve]=y[G+1])}(D,q,V),C(2,D,P,q,V),C(1,D,P,q,V),D.join("")};return this.__bidiEngine__.doBidiReorder=function(k,P,q){if(function(V,se){if(se)for(var ne=0;ne<V.length;ne++)se[ne]=ne;o===void 0&&(o=A(V)),f===void 0&&(f=A(V))}(k,P),i||!c||f)if(i&&c&&o^f)w=o?1:0,k=T(k,P,q);else if(!i&&c&&f)w=o?1:0,k=R(k,P,q),k=T(k,P);else if(!i||o||c||f){if(i&&!c&&o^f)k=T(k,P),o?(w=0,k=R(k,P,q)):(w=1,k=R(k,P,q),k=T(k,P));else if(i&&o&&!c&&f)w=1,k=R(k,P,q),k=T(k,P);else if(!i&&!c&&o^f){var D=u;o?(w=1,k=R(k,P,q),w=0,u=!1,k=R(k,P,q),u=D):(w=0,k=R(k,P,q),k=T(k,P),w=1,u=!1,k=R(k,P,q),u=D,k=T(k,P))}}else w=0,k=R(k,P,q);else w=o?1:0,k=R(k,P,q);return k},this.__bidiEngine__.setOptions=function(k){k&&(i=k.isInputVisual,c=k.isOutputVisual,o=k.isInputRtl,f=k.isOutputRtl,u=k.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(i=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?i.push([r.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):i.push([r.doBidiReorder(s[o])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(mt),mt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Ec(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new EZ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new dZ(this.contents),this.head=new pZ(this),this.name=new yZ(this),this.cmap=new Z8(this),this.toUnicode={},this.hhea=new mZ(this),this.maxp=new wZ(this),this.hmtx=new bZ(this),this.post=new xZ(this),this.os2=new gZ(this),this.loca=new kZ(this),this.glyf=new NZ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,c,f;for(f=[],i=0,o=(c=this.bbox).length;i<o;i++)t=c[i],f.push(Math.round(t*this.scaleFactor));return f}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,a,i,o;for(i=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)s=t.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var $i,Ec=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,a,i,o,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*i+256*o+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,a;for(a=[],n=0,s=t.length;n<s;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),dZ=function(){var e;function t(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,a,i,o,c,f,u,p,d,h,m,g;for(g in h=Object.keys(r).length,c=Math.log(2),p=16*Math.floor(Math.log(h)/c),i=Math.floor(p/c),u=16*h-p,(s=new Ec).writeInt(this.scalarType),s.writeShort(h),s.writeShort(p),s.writeShort(i),s.writeShort(u),a=16*h,f=s.pos+a,o=null,m=[],r)for(d=r[g],s.writeString(g),s.writeInt(e(d)),s.writeInt(f),s.writeInt(d.length),m=m.concat(d),g==="head"&&(o=f),f+=d.length;f%4;)m.push(0),f++;return s.write(m),n=2981146554-e(s.data),s.pos=o+8,s.writeUInt32(n),s.data},e=function(r){var n,s,a,i;for(r=eP.call(r);r.length%4;)r.push(0);for(a=new Ec(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},t}(),hZ={}.hasOwnProperty,_o=function(e,t){for(var r in t)hZ.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};$i=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var pZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Ec).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Fk=function(){function e(t,r){var n,s,a,i,o,c,f,u,p,d,h,m,g,y,v,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),p=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),d=h/2,t.pos+=6,a=function(){var S,A;for(A=[],c=S=0;0<=d?S<d:S>d;c=0<=d?++S:--S)A.push(t.readUInt16());return A}(),t.pos+=2,g=function(){var S,A;for(A=[],c=S=0;0<=d?S<d:S>d;c=0<=d?++S:--S)A.push(t.readUInt16());return A}(),f=function(){var S,A;for(A=[],c=S=0;0<=d?S<d:S>d;c=0<=d?++S:--S)A.push(t.readUInt16());return A}(),u=function(){var S,A;for(A=[],c=S=0;0<=d?S<d:S>d;c=0<=d?++S:--S)A.push(t.readUInt16());return A}(),s=(this.length-t.pos+this.offset)/2,o=function(){var S,A;for(A=[],c=S=0;0<=s?S<s:S>s;c=0<=s?++S:--S)A.push(t.readUInt16());return A}(),c=v=0,w=a.length;v<w;c=++v)for(y=a[c],n=b=m=g[c];m<=y?b<=y:b>=y;n=m<=y?++b:--b)u[c]===0?i=n+f[c]:(i=o[u[c]/2+(n-m)-(d-c)]||0)!==0&&(i+=f[c]),this.codeMap[n]=65535&i}t.pos=p}return e.encode=function(t,r){var n,s,a,i,o,c,f,u,p,d,h,m,g,y,v,b,w,S,A,F,T,O,C,R,k,P,q,D,V,se,ne,X,G,ve,ye,E,M,I,z,te,fe,ge,he,pe,Le,ee;switch(D=new Ec,i=Object.keys(t).sort(function(We,Ge){return We-Ge}),r){case"macroman":for(g=0,y=function(){var We=[];for(m=0;m<256;++m)We.push(0);return We}(),b={0:0},a={},V=0,G=i.length;V<G;V++)b[he=t[s=i[V]]]==null&&(b[he]=++g),a[s]={old:t[s],new:b[t[s]]},y[s]=b[t[s]];return D.writeUInt16(1),D.writeUInt16(0),D.writeUInt32(12),D.writeUInt16(0),D.writeUInt16(262),D.writeUInt16(0),D.write(y),{charMap:a,subtable:D.data,maxGlyphID:g+1};case"unicode":for(P=[],p=[],w=0,b={},n={},v=f=null,se=0,ve=i.length;se<ve;se++)b[A=t[s=i[se]]]==null&&(b[A]=++w),n[s]={old:A,new:b[A]},o=b[A]-s,v!=null&&o===f||(v&&p.push(v),P.push(s),f=o),v=s;for(v&&p.push(v),p.push(65535),P.push(65535),R=2*(C=P.length),O=2*Math.pow(Math.log(C)/Math.LN2,2),d=Math.log(O/2)/Math.LN2,T=2*C-O,c=[],F=[],h=[],m=ne=0,ye=P.length;ne<ye;m=++ne){if(k=P[m],u=p[m],k===65535){c.push(0),F.push(0);break}if(k-(q=n[k].new)>=32768)for(c.push(0),F.push(2*(h.length+C-m)),s=X=k;k<=u?X<=u:X>=u;s=k<=u?++X:--X)h.push(n[s].new);else c.push(q-k),F.push(0)}for(D.writeUInt16(3),D.writeUInt16(1),D.writeUInt32(12),D.writeUInt16(4),D.writeUInt16(16+8*C+2*h.length),D.writeUInt16(0),D.writeUInt16(R),D.writeUInt16(O),D.writeUInt16(d),D.writeUInt16(T),fe=0,E=p.length;fe<E;fe++)s=p[fe],D.writeUInt16(s);for(D.writeUInt16(0),ge=0,M=P.length;ge<M;ge++)s=P[ge],D.writeUInt16(s);for(pe=0,I=c.length;pe<I;pe++)o=c[pe],D.writeUInt16(o);for(Le=0,z=F.length;Le<z;Le++)S=F[Le],D.writeUInt16(S);for(ee=0,te=h.length;ee<te;ee++)g=h[ee],D.writeUInt16(g);return{charMap:n,subtable:D.data,maxGlyphID:w+1}}},e}(),Z8=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Fk(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=Fk.encode(t,r),(s=new Ec).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),mZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),gZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),xZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var i,o,c;for(c=[],a=i=0,o=this.file.maxp.numGlyphs;0<=o?i<o:i>o;a=0<=o?++i:--i)c.push(t.readUInt32());return c}).call(this)}},e}(),vZ=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},yZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,a,i,o,c,f,u,p,d;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(c={},a=u=0,p=n.length;u<p;a=++u)s=n[a],t.pos=s.offset,f=t.readString(s.length),i=new vZ(f,s),c[d=s.nameID]==null&&(c[d]=[]),c[s.nameID].push(i);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),wZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),bZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,a,i,o,c;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,u;for(u=[],r=f=0;0<=s?f<s:f>s;r=0<=s?++f:--f)u.push(t.readInt16());return u}(),this.widths=(function(){var f,u,p,d;for(d=[],f=0,u=(p=this.metrics).length;f<u;f++)a=p[f],d.push(a.advance);return d}).call(this),n=this.widths[this.widths.length-1],c=[],r=i=0;0<=s?i<s:i>s;r=0<=s?++i:--i)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),eP=[].slice,NZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,a,i,o,c,f,u,p;return t in this.cache?this.cache[t]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(o=new Ec(r.read(s))).readShort(),f=o.readShort(),p=o.readShort(),c=o.readShort(),u=o.readShort(),this.cache[t]=i===-1?new _Z(o,f,p,c,u):new SZ(o,i,f,p,c,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,a,i,o,c;for(i=[],a=[],o=0,c=r.length;o<c;o++)s=t[r[o]],a.push(i.length),s&&(i=i.concat(s.encode(n)));return a.push(i.length),{table:i,offsets:a}},e}(),SZ=function(){function e(t,r,n,s,a,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),_Z=function(){function e(t,r,n,s,a){var i,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Ec(eP.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),kZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return _o(e,$i),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,i=0;i<n.length;++i)if(n[i]=s,a<r.length&&r[a]==i){++a,n[i]=s;var o=this.offsets[i],c=this.offsets[i+1]-o;c>0&&(s+=c)}for(var f=new Array(4*n.length),u=0;u<n.length;++u)f[4*u+3]=255&n[u],f[4*u+2]=(65280&n[u])>>8,f[4*u+1]=(16711680&n[u])>>16,f[4*u]=(4278190080&n[u])>>24;return f},e}(),EZ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,a,i,o,c;for(s={},i=0,o=t.length;i<o;i++)s[a=t[i]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in c=this.glyphsFor(r))n=c[a],s[a]=n;return s},e.prototype.encode=function(t,r){var n,s,a,i,o,c,f,u,p,d,h,m,g,y,v;for(s in n=Z8.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),h={0:0},v=n.charMap)h[(c=v[s]).old]=c.new;for(m in d=n.maxGlyphID,i)m in h||(h[m]=d++);return u=function(b){var w,S;for(w in S={},b)S[b[w]]=w;return S}(h),p=Object.keys(u).sort(function(b,w){return b-w}),g=function(){var b,w,S;for(S=[],b=0,w=p.length;b<w;b++)o=p[b],S.push(u[o]);return S}(),a=this.font.glyf.encode(i,g,h),f=this.font.loca.encode(a.offsets,g),y={cmap:this.font.cmap.raw(),glyf:a.table,loca:f,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();mt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,a,i;if(Array.isArray(r))return"["+function(){var o,c,f;for(f=[],o=0,c=r.length;o<c;o++)n=r[o],f.push(t.convert(n));return f}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)i=r[s],a.push("/"+s+" "+t.convert(i));return a.push(">>"),a.join(`
`)}return""+r},t}();function tP(e,t,r,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,o=s.internal.getFontSize()/i,c=s.getLineHeightFactor?s.getLineHeightFactor():a,f=o*c,u=/\r\n|\r|\n/g,p="",d=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(p=typeof e=="string"?e.split(u):e,d=p.length||1),r+=o*(2-a),n.valign==="middle"?r-=d/2*f:n.valign==="bottom"&&(r-=d*f),n.halign==="center"||n.halign==="right"){var h=o;if(n.halign==="center"&&(h*=.5),p&&d>=1){for(var m=0;m<p.length;m++)s.text(p[m],t-s.getStringUnitWidth(p[m])*h,r),r+=f;return s}t-=s.getStringUnitWidth(e)*h}return n.halign==="justify"?s.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(e,t,r),s}var Lk={},nd=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:Lk=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,s,a;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,c=i.fontName;if(t.font&&(c=t.font),t.fontStyle){o=t.fontStyle;var f=this.getFontList()[c];f&&f.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(f[0]),o=f[0])}if(this.jsPDFDocument.setFont(c,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var u=e.unifyColor(t.fillColor);u&&(n=this.jsPDFDocument).setFillColor.apply(n,u),u=e.unifyColor(t.textColor),u&&(s=this.jsPDFDocument).setTextColor.apply(s,u),u=e.unifyColor(t.lineColor),u&&(a=this.jsPDFDocument).setDrawColor.apply(a,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,s,a){return this.jsPDFDocument.rect(t,r,n,s,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return Lk||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),Yw=function(e,t){return Yw=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},Yw(e,t)};function rP(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Yw(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var nP=function(e){rP(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function jZ(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function AZ(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function Ug(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],s=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function sP(e,t,r,n){var s=t.settings.tableLineWidth,a=t.settings.tableLineColor;e.applyStyles({lineWidth:s,lineColor:a});var i=aP(s,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function aP(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function Cx(e,t){var r,n,s,a;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(s=e.right)!==null&&s!==void 0?s:t,bottom:(a=e.bottom)!==null&&a!==void 0?a:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function iP(e,t){var r=Cx(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function TZ(e,t,r,n,s){var a={},i=1.3333333333333333,o=Fv(t,function(w){return s.getComputedStyle(w).backgroundColor});o!=null&&(a.fillColor=o);var c=Fv(t,function(w){return s.getComputedStyle(w).color});c!=null&&(a.textColor=c);var f=PZ(n,r);f&&(a.cellPadding=f);var u="borderTopColor",p=i*r,d=n.borderTopWidth;if(n.borderBottomWidth===d&&n.borderRightWidth===d&&n.borderLeftWidth===d){var h=(parseFloat(d)||0)/p;h&&(a.lineWidth=h)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/p,right:(parseFloat(n.borderRightWidth)||0)/p,bottom:(parseFloat(n.borderBottomWidth)||0)/p,left:(parseFloat(n.borderLeftWidth)||0)/p},a.lineWidth.top||(a.lineWidth.right?u="borderRightColor":a.lineWidth.bottom?u="borderBottomColor":a.lineWidth.left&&(u="borderLeftColor"));var m=Fv(t,function(w){return s.getComputedStyle(w)[u]});m!=null&&(a.lineColor=m);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var y=parseInt(n.fontSize||"");isNaN(y)||(a.fontSize=y/i);var v=CZ(n);v&&(a.fontStyle=v);var b=(n.fontFamily||"").toLowerCase();return e.indexOf(b)!==-1&&(a.font=b),a}function CZ(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Fv(e,t){var r=oP(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function oP(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:oP(e.parentElement,t):r}function PZ(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),s=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,a=r.map(function(o){return parseInt(o||"0")/n}),i=Cx(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function lP(e,t,r,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var c=Object.keys(e.getFontList()),f=e.scaleFactor(),u=[],p=[],d=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:u,body:p,foot:d};for(var h=0;h<o.rows.length;h++){var m=o.rows[h],g=(i=(a=m==null?void 0:m.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),y=FZ(c,f,r,m,n,s);y&&(g==="thead"?u.push(y):g==="tfoot"?d.push(y):p.push(y))}return{head:u,body:p,foot:d}}function FZ(e,t,r,n,s,a){for(var i=new nP(n),o=0;o<n.cells.length;o++){var c=n.cells[o],f=r.getComputedStyle(c);if(s||f.display!=="none"){var u=void 0;a&&(u=TZ(e,c,t,f,r)),i.push({rowSpan:c.rowSpan,colSpan:c.colSpan,styles:u,_element:c,content:LZ(c)})}}var p=r.getComputedStyle(n);if(i.length>0&&(s||p.display!=="none"))return i}function LZ(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function DZ(e,t,r){for(var n=0,s=[e,t,r];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function nl(e,t,r,n,s){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null)for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])}return a}function cP(e,t){var r=new nd(e),n=r.getDocumentOptions(),s=r.getGlobalOptions();DZ(s,n,t);var a=nl({},s,n,t),i;typeof window<"u"&&(i=window);var o=OZ(s,n,t),c=RZ(s,n,t),f=IZ(r,a),u=BZ(r,a,i);return{id:t.tableId,content:u,hooks:c,styles:o,settings:f}}function OZ(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(c){if(c==="columnStyles"){var f=e[c],u=t[c],p=r[c];n.columnStyles=nl({},f,u,p)}else{var d=[e,t,r],h=d.map(function(m){return m[c]||{}});n[c]=nl({},h[0],h[1],h[2])}},a=0,i=Object.keys(n);a<i.length;a++){var o=i[a];s(o)}return n}function RZ(e,t,r){for(var n=[e,t,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var o=i[a];o.didParseCell&&s.didParseCell.push(o.didParseCell),o.willDrawCell&&s.willDrawCell.push(o.willDrawCell),o.didDrawCell&&s.didDrawCell.push(o.didDrawCell),o.willDrawPage&&s.willDrawPage.push(o.willDrawPage),o.didDrawPage&&s.didDrawPage.push(o.didDrawPage)}return s}function IZ(e,t){var r,n,s,a,i,o,c,f,u,p,d,h,m=Cx(t.margin,40/e.scaleFactor()),g=(r=MZ(e,t.startY))!==null&&r!==void 0?r:m.top,y;t.showFoot===!0?y="everyPage":t.showFoot===!1?y="never":y=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var v;t.showHead===!0?v="everyPage":t.showHead===!1?v="never":v=(s=t.showHead)!==null&&s!==void 0?s:"everyPage";var b=(a=t.useCss)!==null&&a!==void 0?a:!1,w=t.theme||(b?"plain":"striped"),S=!!t.horizontalPageBreak,A=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:b,theme:w,startY:g,margin:m,pageBreak:(c=t.pageBreak)!==null&&c!==void 0?c:"auto",rowPageBreak:(f=t.rowPageBreak)!==null&&f!==void 0?f:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:v,showFoot:y,tableLineWidth:(p=t.tableLineWidth)!==null&&p!==void 0?p:0,tableLineColor:(d=t.tableLineColor)!==null&&d!==void 0?d:200,horizontalPageBreak:S,horizontalPageBreakRepeat:A,horizontalPageBreakBehaviour:(h=t.horizontalPageBreakBehaviour)!==null&&h!==void 0?h:"afterAllRows"}}function MZ(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),s=e.pageNumber(),a=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;a=i===s}return typeof t=="number"?t:(t==null||t===!1)&&a&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function BZ(e,t,r){var n=t.head||[],s=t.body||[],a=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var o=lP(e,t.html,r,i,t.useCss)||{};n=o.head||n,s=o.body||n,a=o.foot||n}else console.error("Cannot parse html in non browser environment")}var c=t.columns||UZ(n,s,a);return{columns:c,head:n,body:s,foot:a}}function UZ(e,t,r){var n=e[0]||t[0]||r[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,o;Array.isArray(n)?o=n[parseInt(a)]:o=n[a],typeof o=="object"&&!Array.isArray(o)&&(i=(o==null?void 0:o.colSpan)||1);for(var c=0;c<i;c++){var f=void 0;Array.isArray(n)?f=s.length:f=a+(c>0?"_".concat(c):"");var u={dataKey:f};s.push(u)}}),s}var Xw=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),$Z=function(e){rP(t,e);function t(r,n,s,a,i,o){var c=e.call(this,r,n,o)||this;return c.cell=s,c.row=a,c.column=i,c.section=a.section,c}return t}(Xw),zZ=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,s,a,i){for(var o=0,c=r;o<c.length;o++){var f=c[o],u=new $Z(t,this,n,s,a,i),p=f(u)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],p)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new Xw(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new Xw(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),uP=function(){function e(t,r,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof nP&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,s){var a;return Math.max(n,((a=r.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var o=r.getLineHeight(i.styles.fontSize),c=i.padding("vertical"),f=c+o;return f>s?f:s},0)},e}(),fP=function(){function e(t,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(s=t.content)!==null&&s!==void 0?s:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",o=/\r\n|\r|\n/g;this.text=i.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/t*r,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Cx(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),qZ=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,s=t.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function HZ(e,t){WZ(e,t);var r=[],n=0;t.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(t);i?a.width=i:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var s=t.getWidth(e.pageSize().width)-n;s&&(s=Jw(r,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=Jw(r,s,function(a){return a.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),KZ(t),GZ(t,e),VZ(t)}function WZ(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,s=iP(e,t);t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var c=o[i],f=a.cells[c.index];if(f){var u=t.hooks.didParseCell;t.callCellHooks(e,u,f,a,c,null);var p=f.padding("horizontal");f.contentWidth=Ug(f.text,f.styles,e)+p;var d=Ug(f.text.join(" ").split(/[^\S\u00A0]+/),f.styles,e);if(f.minReadableWidth=d+f.padding("horizontal"),typeof f.styles.cellWidth=="number")f.minWidth=f.styles.cellWidth,f.wrappedWidth=f.styles.cellWidth;else if(f.styles.cellWidth==="wrap"||n===!0)f.contentWidth>s?(f.minWidth=s,f.wrappedWidth=s):(f.minWidth=f.contentWidth,f.wrappedWidth=f.contentWidth);else{var h=10/r;f.minWidth=f.styles.minCellWidth||h,f.wrappedWidth=f.contentWidth,f.minWidth>f.wrappedWidth&&(f.wrappedWidth=f.minWidth)}}}}),t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var c=o[i],f=a.cells[c.index];if(f&&f.colSpan===1)c.wrappedWidth=Math.max(c.wrappedWidth,f.wrappedWidth),c.minWidth=Math.max(c.minWidth,f.minWidth),c.minReadableWidth=Math.max(c.minReadableWidth,f.minReadableWidth);else{var u=t.styles.columnStyles[c.dataKey]||t.styles.columnStyles[c.index]||{},p=u.cellWidth||u.minCellWidth;p&&typeof p=="number"&&(c.minWidth=p,c.wrappedWidth=p)}f&&(f.colSpan>1&&!c.minWidth&&(c.minWidth=f.minWidth),f.colSpan>1&&!c.wrappedWidth&&(c.wrappedWidth=f.minWidth))}})}function Jw(e,t,r){for(var n=t,s=e.reduce(function(h,m){return h+m.wrappedWidth},0),a=0;a<e.length;a++){var i=e[a],o=i.wrappedWidth/s,c=n*o,f=i.width+c,u=r(i),p=f<u?u:f;t-=p-i.width,i.width=p}if(t=Math.round(t*1e10)/1e10,t){var d=e.filter(function(h){return t<0?h.width>r(h):!0});d.length&&(t=Jw(d,t,r))}return t}function VZ(e){for(var t={},r=1,n=e.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,o=e.columns;i<o.length;i++){var c=o[i],f=t[c.index];if(r>1)r--,delete a.cells[c.index];else if(f)f.cell.height+=a.height,r=f.cell.colSpan,delete a.cells[c.index],f.left--,f.left<=1&&delete t[c.index];else{var u=a.cells[c.index];if(!u)continue;if(u.height=a.height,u.rowSpan>1){var p=n.length-s,d=u.rowSpan>p?p:u.rowSpan;t[c.index]={cell:u,left:d,row:a}}}}}function KZ(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],s=null,a=0,i=0,o=0;o<e.columns.length;o++){var c=e.columns[o];if(i-=1,i>1&&e.columns[o+1])a+=c.width,delete n.cells[c.index];else if(s){var f=s;delete n.cells[c.index],s=null,f.width=c.width+a}else{var f=n.cells[c.index];if(!f)continue;if(i=f.colSpan,a=0,f.colSpan>1){s=f,a+=c.width;continue}f.width=c.width+a}}}function GZ(e,t){for(var r={count:0,height:0},n=0,s=e.allRows();n<s.length;n++){for(var a=s[n],i=0,o=e.columns;i<o.length;i++){var c=o[i],f=a.cells[c.index];if(f){t.applyStyles(f.styles,!0);var u=f.width-f.padding("horizontal");if(f.styles.overflow==="linebreak")f.text=t.splitTextToSize(f.text,u+1/t.scaleFactor(),{fontSize:f.styles.fontSize});else if(f.styles.overflow==="ellipsize")f.text=Dk(f.text,u,f.styles,t,"...");else if(f.styles.overflow==="hidden")f.text=Dk(f.text,u,f.styles,t,"");else if(typeof f.styles.overflow=="function"){var p=f.styles.overflow(f.text,u);typeof p=="string"?f.text=[p]:f.text=p}f.contentHeight=f.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var d=f.contentHeight/f.rowSpan;f.rowSpan>1&&r.count*r.height<d*f.rowSpan?r={height:d,count:f.rowSpan}:r&&r.count>0&&r.height>d&&(d=r.height),d>a.height&&(a.height=d)}}r.count--}}function Dk(e,t,r,n,s){return e.map(function(a){return YZ(a,t,r,n,s)})}function YZ(e,t,r,n,s){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=Ug(e,r,n))return e;for(;t<Ug(e+s,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+s}function dP(e,t){var r=new nd(e),n=XZ(t,r.scaleFactor()),s=new zZ(t,n);return HZ(r,s),r.applyStyles(r.userStyles),s}function XZ(e,t){var r=e.content,n=QZ(r.columns);if(r.head.length===0){var s=Ok(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=Ok(n,"foot");s&&r.foot.push(s)}var a=e.settings.theme,i=e.styles;return{columns:n,head:Lv("head",r.head,n,i,a,t),body:Lv("body",r.body,n,i,a,t),foot:Lv("foot",r.foot,n,i,a,t)}}function Lv(e,t,r,n,s,a){var i={},o=t.map(function(c,f){for(var u=0,p={},d=0,h=0,m=0,g=r;m<g.length;m++){var y=g[m];if(i[y.index]==null||i[y.index].left===0)if(h===0){var v=void 0;Array.isArray(c)?v=c[y.index-d-u]:v=c[y.dataKey];var b={};typeof v=="object"&&!Array.isArray(v)&&(b=(v==null?void 0:v.styles)||{});var w=ZZ(e,y,f,s,n,a,b),S=new fP(v,w,e);p[y.dataKey]=S,p[y.index]=S,h=S.colSpan-1,i[y.index]={left:S.rowSpan-1,times:h}}else h--,d++;else i[y.index].left--,h=i[y.index].times,u++}return new uP(c,f,e,p)});return o}function Ok(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var s=JZ(t,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function JZ(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function QZ(e){return e.map(function(t,r){var n,s;return typeof t=="object"?s=(n=t.dataKey)!==null&&n!==void 0?n:r:s=r,new qZ(s,t,r)})}function ZZ(e,t,r,n,s,a,i){var o=AZ(n),c;e==="head"?c=s.headStyles:e==="body"?c=s.bodyStyles:e==="foot"&&(c=s.footStyles);var f=nl({},o.table,o[e],s.styles,c),u=s.columnStyles[t.dataKey]||s.columnStyles[t.index]||{},p=e==="body"?u:{},d=e==="body"&&r%2===0?nl({},o.alternateRow,s.alternateRowStyles):{},h=jZ(a),m=nl({},h,f,d,p);return nl(m,i)}function eee(e,t,r){var n;r===void 0&&(r={});var s=iP(e,t),a=new Map,i=[],o=[],c=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?c=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(c=[t.settings.horizontalPageBreakRepeat]),c.forEach(function(d){var h=t.columns.find(function(m){return m.dataKey===d||m.index===d});h&&!a.has(h.index)&&(a.set(h.index,!0),i.push(h.index),o.push(t.columns[h.index]),s-=h.wrappedWidth)});for(var f=!0,u=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;u<t.columns.length;){if(a.has(u)){u++;continue}var p=t.columns[u].wrappedWidth;if(f||s>=p)f=!1,i.push(u),o.push(t.columns[u]),s-=p;else break;u++}return{colIndexes:i,columns:o,lastIndex:u-1}}function tee(e,t){for(var r=[],n=0;n<t.columns.length;n++){var s=eee(e,t,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function hP(e,t){var r=t.settings,n=r.startY,s=r.margin,a={x:s.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+s.bottom+i;if(r.pageBreak==="avoid"){var c=t.body,f=c.reduce(function(d,h){return d+h.height},0);o+=f}var u=new nd(e);(r.pageBreak==="always"||r.startY!=null&&o>u.pageSize().height)&&(mP(u),a.y=s.top),t.callWillDrawPageHooks(u,a);var p=nl({},a);t.startPageNumber=u.pageNumber(),r.horizontalPageBreak?ree(u,t,p,a):(u.applyStyles(u.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(d){return ml(u,t,d,a,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(d,h){var m=h===t.body.length-1;$g(u,t,d,m,p,a,t.columns)}),u.applyStyles(u.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(d){return ml(u,t,d,a,t.columns)})),sP(u,t,p,a),t.callEndPageHooks(u,a),t.finalY=a.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function ree(e,t,r,n){var s=tee(e,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(f,u){e.applyStyles(e.userStyles),u>0?uh(e,t,r,n,f.columns,!0):Rk(e,t,n,f.columns),nee(e,t,r,n,f.columns),Dv(e,t,n,f.columns)});else for(var i=-1,o=s[0],c=function(){var f=i;if(o){e.applyStyles(e.userStyles);var u=o.columns;i>=0?uh(e,t,r,n,u,!0):Rk(e,t,n,u),f=Ik(e,t,i+1,n,u),Dv(e,t,n,u)}var p=f-i;s.slice(1).forEach(function(d){e.applyStyles(e.userStyles),uh(e,t,r,n,d.columns,!0),Ik(e,t,i+1,n,d.columns,p),Dv(e,t,n,d.columns)}),i=f};i<t.body.length-1;)c()}function Rk(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&t.head.forEach(function(a){return ml(e,t,a,r,n)})}function nee(e,t,r,n,s){e.applyStyles(e.userStyles),t.body.forEach(function(a,i){var o=i===t.body.length-1;$g(e,t,a,o,r,n,s)})}function Ik(e,t,r,n,s,a){e.applyStyles(e.userStyles),a=a??t.body.length;var i=Math.min(r+a,t.body.length),o=-1;return t.body.slice(r,i).forEach(function(c,f){var u=r+f===t.body.length-1,p=pP(e,t,u,n);c.canEntireRowFit(p,s)&&(ml(e,t,c,n,s),o=r+f)}),o}function Dv(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&t.foot.forEach(function(a){return ml(e,t,a,r,n)})}function see(e,t,r){var n=r.getLineHeight(e.styles.fontSize),s=e.padding("vertical"),a=Math.floor((t-s)/n);return Math.max(0,a)}function aee(e,t,r,n){var s={};e.spansMultiplePages=!0,e.height=0;for(var a=0,i=0,o=r.columns;i<o.length;i++){var c=o[i],f=e.cells[c.index];if(f){Array.isArray(f.text)||(f.text=[f.text]);var u=new fP(f.raw,f.styles,f.section);u=nl(u,f),u.text=[];var p=see(f,t,n);f.text.length>p&&(u.text=f.text.splice(p,f.text.length));var d=n.scaleFactor(),h=n.getLineHeightFactor();f.contentHeight=f.getContentHeight(d,h),f.contentHeight>=t&&(f.contentHeight=t,u.styles.minCellHeight-=t),f.contentHeight>e.height&&(e.height=f.contentHeight),u.contentHeight=u.getContentHeight(d,h),u.contentHeight>a&&(a=u.contentHeight),s[c.index]=u}}var m=new uP(e.raw,-1,e.section,s,!0);m.height=a;for(var g=0,y=r.columns;g<y.length;g++){var c=y[g],u=m.cells[c.index];u&&(u.height=m.height);var f=e.cells[c.index];f&&(f.height=e.height)}return m}function iee(e,t,r,n){var s=e.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,o=s-i;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var c=t.getMinimumRowHeight(n.columns,e),f=c<r;if(c>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!f)return!1;var u=t.hasRowSpan(n.columns),p=t.getMaxCellHeight(n.columns)>o;return p?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||n.settings.rowPageBreak==="avoid")}function $g(e,t,r,n,s,a,i){var o=pP(e,t,n,a);if(r.canEntireRowFit(o,i))ml(e,t,r,a,i);else if(iee(e,r,o,t)){var c=aee(r,o,t,e);ml(e,t,r,a,i),uh(e,t,s,a,i),$g(e,t,c,n,s,a,i)}else uh(e,t,s,a,i),$g(e,t,r,n,s,a,i)}function ml(e,t,r,n,s){n.x=t.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var o=i[a],c=r.cells[o.index];if(!c){n.x+=o.width;continue}e.applyStyles(c.styles),c.x=n.x,c.y=n.y;var f=t.callCellHooks(e,t.hooks.willDrawCell,c,r,o,n);if(f===!1){n.x+=o.width;continue}oee(e,c,n);var u=c.getTextPos();tP(c.text,u.x,u.y,{halign:c.styles.halign,valign:c.styles.valign,maxWidth:Math.ceil(c.width-c.padding("left")-c.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,c,r,o,n),n.x+=o.width}n.y+=r.height}function oee(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=aP(n.lineWidth,n.fillColor);s&&e.rect(t.x,r.y,t.width,t.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),lee(e,t,r,n.lineWidth))}function lee(e,t,r,n){var s,a,i,o;n.top&&(s=r.x,a=r.y,i=r.x+t.width,o=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.top,s,a,i,o)),n.bottom&&(s=r.x,a=r.y+t.height,i=r.x+t.width,o=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),c(n.bottom,s,a,i,o)),n.left&&(s=r.x,a=r.y,i=r.x,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.left,s,a,i,o)),n.right&&(s=r.x+t.width,a=r.y,i=r.x+t.width,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),c(n.right,s,a,i,o));function c(f,u,p,d,h){e.getDocument().setLineWidth(f),e.getDocument().line(u,p,d,h,"S")}}function pP(e,t,r,n){var s=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(s+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-s}function uh(e,t,r,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(o){return ml(e,t,o,n,s)}),t.callEndPageHooks(e,n);var i=t.settings.margin;sP(e,t,r,n),mP(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return ml(e,t,o,n,s)}),e.applyStyles(e.userStyles))}function mP(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function cee(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],s=cP(this,n),a=dP(this,s);return hP(this,a),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,s){tP(t,r,n,s,this)},e.API.autoTableSetDefaults=function(t){return nd.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){nd.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new nd(this),a=lP(s,t,window,r,!1),i=a.head,o=a.body,c=((n=i[0])===null||n===void 0?void 0:n.map(function(f){return f.content}))||[];return{columns:c,rows:o,data:o}}}var Ov;function zg(e,t){var r=cP(e,t),n=dP(e,r);hP(e,n)}try{if(typeof window<"u"&&window){var Mk=window,Bk=Mk.jsPDF||((Ov=Mk.jspdf)===null||Ov===void 0?void 0:Ov.jsPDF);Bk&&cee(Bk)}}catch(e){console.error("Could not apply autoTable plugin",e)}function uee(e){const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const c=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],f=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],u=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return c[o];if(o>=10&&o<20)return f[o-10];const p=Math.floor(o/10),d=o%10;if(p===7||p===9){const h=u[p],m=10+d;return m<20?h+"-"+f[m-10]:h+"-"+c[d]}return p===8?d===0?"quatre-vingts":"quatre-vingt-"+c[d]:d===0?u[p]:d===1&&p===2?"vingt et un":d===1&&(p===3||p===4||p===5||p===6)?u[p]+" et un":u[p]+"-"+c[d]},s=o=>{if(o===0)return"";const c=Math.floor(o/100),f=o%100;let u="";return c>1?(u=n(c)+" cent",f===0&&(u+="s")):c===1&&(u="cent"),f>0&&(u&&(u+=" "),u+=n(f)),u};let i=(o=>{if(o===0)return"zro";const c=Math.floor(o/1e6),f=Math.floor(o%1e6/1e3),u=o%1e3;let p="";return c>0&&(c===1?p+="un million":p+=s(c)+" millions"),f>0&&(p&&(p+=" "),f===1?p+="mille":p+=s(f)+" mille"),u>0&&(p&&(p+=" "),p+=s(u)),p})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i}async function fee(e,t,r,n,s,a,i,o,c,f=[]){const u=new mt("portrait","mm","a4"),p=u.internal.pageSize.width,d=u.internal.pageSize.height;let h=15;u.setFontSize(10),u.setFont("helvetica","bold"),u.text("ROYAUME DU MAROC",55,h,{align:"center"}),h+=5,u.setFontSize(9),u.setFont("helvetica","normal"),u.text("MINISTERE DE L'AGRICULTURE ET DE LA PECHE MARITIME",55,h,{align:"center"}),h+=4,u.text("DU DEVELOPPEMENT RURAL ET DES EAUX ET FORETS",55,h,{align:"center"}),h+=4,u.text("DIRECTION PROVINCIALE DE L'AGRICULTURE",55,h,{align:"center"}),h+=4,u.text("TATA",55,h,{align:"center"}),h+=10;const m=p-60;if(u.setFontSize(8),u.setFont("helvetica","bold"),u.text("EXER: "+e.annee,m+2,20),u.text("Chapitre: "+(e.chapitre||""),m+2,25),u.text("Programme: "+(e.programme||""),m+2,30),u.text("Projet: "+(e.projet||""),m+2,35),u.text("Ligne: "+(e.ligne||""),m+2,40),h=55,u.setFontSize(10),u.setFont("helvetica","bold"),e.typeMarche==="negocie"){const E="MARCHE NEGOCIE N"+e.marcheNo;u.text(E,p/2,h,{align:"center"});const M=u.getTextWidth(E),I=(p-M)/2;u.setLineWidth(.3),u.line(I,h+1,I+M,h+1)}else u.text("MARCHE N"+e.marcheNo,p/2,h,{align:"center"});h+=6,u.setFontSize(9),u.setFont("helvetica","normal"),u.splitTextToSize(e.objet,p-20).forEach(E=>{u.text(E,p/2,h,{align:"center"}),h+=5}),h+=5,u.setFontSize(9),u.text("Socit: "+(e.societe||"SOUS ISKE TRAVAUX DIVERS(SARL)"),10,h),h+=5;const y=h;u.text("R. C. n: "+(e.rc||"217/2021"),10,h);const v=p-70,b=60;u.rect(v,y-4,b,12),u.setFont("helvetica","bold"),u.setFontSize(8),u.text("Montant de l'acompte en Dhs:",v+b/2,y,{align:"center"}),u.setFontSize(10),u.text(s.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2}),v+b/2,y+5,{align:"center"}),h+=5,u.setFont("helvetica","normal"),u.setFontSize(9),u.text("C.B n: "+(e.cb||"007550604987600000228218"),10,h),h+=5,u.text("C.N.S.S. n: "+(e.cnss||"4444634"),10,h),h+=5,u.text("Patente: "+(e.patente||"47730296"),10,h),h+=10,u.setFont("helvetica","bold"),u.setFontSize(11);const S=t.isDecompteDernier?" et dernier":"";u.text("DECOMPTE PROVISOIRE N"+t.numero+S,p/2,h,{align:"center"}),h+=5,u.setFont("helvetica","normal"),u.setFontSize(9);const A=`Des travaux excuts au: ${new Date(t.dateFin).toLocaleDateString("fr-FR")}`;u.text(A,p/2,h,{align:"center"}),h+=10;const F=n.map(E=>[E.prixNo,E.designation,E.unite,E.quantiteRealisee.toFixed(2),E.prixUnitaireHT.toFixed(2),(E.quantiteRealisee*E.prixUnitaireHT).toFixed(2)]);let T=0,O=0,C=0,R=0,k=0;zg(u,{startY:h,head:[["Prix N","DESIGNATIONS DES PRESTATIONS","U","Quantit",`Prix U En DH
hors TVA`,`Prix Total En DH
hors TVA`]],body:F,foot:[[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral Hors TVA",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:i.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:`Total TVA (${a}%)`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:o.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral (T.T.C)",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:c.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}]],theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[255,255,255],textColor:0,fontStyle:"bold"},tableLineWidth:.1,tableLineColor:[200,200,200],willDrawCell:E=>{E.section==="foot"&&E.column.index<3&&(E.cell.styles.lineWidth=0,E.cell.styles.lineColor=[255,255,255])},didDrawCell:E=>{E.section==="body"&&E.row.index===E.table.body.length-1&&E.column.index===0&&(R=E.cell.y+E.cell.height),E.section==="body"&&E.row.index===E.table.body.length-1&&E.column.index===3&&(T=E.cell.x),E.section==="body"&&E.row.index===E.table.body.length-1&&E.column.index===5&&(O=E.cell.x+E.cell.width),E.section==="body"&&E.row.index===0&&E.column.index===0&&(k=E.cell.x),E.section==="foot"&&E.row.index===2&&E.column.index===3&&(C=E.cell.y+E.cell.height),E.section==="foot"&&E.column.index>=3&&(u.setDrawColor(200,200,200),u.setLineWidth(.1),u.rect(E.cell.x,E.cell.y,E.cell.width,E.cell.height))},didDrawPage:()=>{},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:12,halign:"center"},3:{cellWidth:20,halign:"right"},4:{cellWidth:25,halign:"right"},5:{cellWidth:30,halign:"right"}}}),u.setDrawColor(200,200,200),u.setLineWidth(.1),u.line(T,R,T,C),u.line(O,R,O,C),u.line(k,R,T,R),u.setDrawColor(255,255,255),u.setLineWidth(1),u.line(k,R+.5,k,C+.5),u.line(k,C,T,C),u.addPage(),h=20,u.setFontSize(9),u.setFont("helvetica","normal");const P=e.osc?new Date(e.osc).toLocaleDateString("fr-FR"):"../../....";u.text("Ordre de service de commencer les travaux du: "+P,10,h),h+=10,u.text("Dlais d'excution: "+(e.delaisExecution||"10")+" mois",10,h),h+=5,console.log(" PDF - Dcomptes prcdents reus:",f),f&&f.length>0?(console.log(" PDF - Affichage de",f.length,"dcomptes prcdents"),f.forEach(E=>{u.setFontSize(9),u.setFont("helvetica","normal");const M=E.isDecompteDernier?" et dernier":"",I=`D.P.n ${E.numero}${M} du ${E.date} montant: ${E.montant.toLocaleString("fr-MA",{minimumFractionDigits:2,maximumFractionDigits:2})} DH`;console.log(" PDF - Ligne:",I),u.text(I,10,h),h+=5})):console.log(" PDF - Aucun dcompte prcdent  afficher");const q=t.isDecompteDernier?" et dernier":"",D=`D.P.n ${t.numero}${q} du ${new Date(t.dateFin).toLocaleDateString("fr-FR")} montant: ${s.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2})} DH`;u.text(D,10,h),h+=9,u.setFont("helvetica","bold"),u.setFontSize(11),u.text("RECAPITULATION",p/2,h,{align:"center"}),h+=10;const V=t.isDecompteDernier?[["Travaux termins",s.travauxTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxTermines-s.retenueGarantie).toFixed(2)],["Travaux non termins","0,00","",""],["Approvisionnements",s.approvisionnements.toFixed(2),"",""]]:[["Travaux termins",s.travauxTermines.toFixed(2),"",""],["Travaux non termins",s.travauxNonTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxNonTermines-s.retenueGarantie).toFixed(2)],["Approvisionnements",s.approvisionnements.toFixed(2),"",""]];zg(u,{startY:h,head:[["NATURE DES DEPENSES","MONTANTS","RETENUE DE","RESTES"]],body:V,foot:[[{content:"TOTAUX",styles:{fontStyle:"bold"}},{content:s.totalAvantRetenue.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.retenueGarantie.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.resteAPayer.toFixed(2),styles:{halign:"right",fontStyle:"bold"}}],[{content:" dduire les dpenses imputes sur exercices antrieurs",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.depensesExercicesAnterieurs.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Reste  payer sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.resteAPayer.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:" dduire le montant des acomptes dlivrs sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:(s.totalADeduire-s.depensesExercicesAnterieurs).toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Montant de l'acompte  dlivrer:",colSpan:3,styles:{fontStyle:"bold",fillColor:[255,255,255],textColor:0}},{content:s.montantAcompte.toFixed(2),styles:{fontStyle:"bold",fontSize:10,fillColor:[255,255,255],textColor:0,halign:"right"}}]],theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"},footStyles:{fillColor:[255,255,255],textColor:0},didDrawCell:E=>{E.section==="foot"&&(u.setDrawColor(200,200,200),u.setLineWidth(.1),u.rect(E.cell.x,E.cell.y,E.cell.width,E.cell.height))},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:35,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:35,halign:"right"}}}),h=u.lastAutoTable.finalY+10,u.setFontSize(8),u.setFont("helvetica","italic"),u.splitTextToSize("Dress par 1. Le responsable du Service d'Amnagement Hydro-Agricole ou son reprsentant  et 2. Le Chef de Mission AT Gzouli Ingnieur Conseil; responsable de suivi des travaux, qui certifie que les quantits portes au prsent dcompte correspondent aux travaux rellement excuts conformment aux plans et aux stipulations du march.",p-20).forEach(E=>{h>d-40&&(u.addPage(),h=20),u.text(E,10,h),h+=4}),h+=10,u.setFontSize(9),u.setFont("helvetica","normal"),u.text("1-",10,h),u.text("2-",p/2,h),h+=20,u.text("Vu et vrifi",10,h),h+=25,u.setFillColor(255,255,255),u.rect(10,h,p-20,15,"F"),u.setDrawColor(0),u.setLineWidth(.2),u.rect(10,h,p-20,15,"S"),u.setFont("helvetica","normal"),u.setFontSize(9),u.setTextColor(0);const X=`Arrt par nous, Sous-Ordonnateur,  la somme de: ${uee(s.montantAcompte)}`,G=u.splitTextToSize(X,p-25);let ve=h+5;G.forEach(E=>{u.text(E,12,ve),ve+=4}),h+=20,u.text("A Tata, Le:",10,h),h+=10,u.text("Tata, le:",p/2,h);const ye=`Decompte_${e.marcheNo}_Periode_${t.numero}_${new Date().toISOString().split("T")[0]}.pdf`;u.save(ye)}const Hr=e=>Math.ceil(e*100)/100,dee=()=>{const{projectId:e,periodeId:t}=Pc(),r=Gn(),n=Yr(D=>D.user),[s,a]=me.useState(!1),[i,o]=me.useState([]),[c,f]=me.useState(20),[u,p]=me.useState(10),[d,h]=me.useState(0),[m,g]=me.useState(0),y=e!=null&&e.includes(":")?e:`project:${e}`,v=t!=null&&t.includes(":")?t:`periode:${t}`,b=$t(()=>y?Se.projects.get(y):void 0,[y]),w=$t(()=>v?Se.periodes.get(v):void 0,[v]),S=$t(()=>y?Se.bordereaux.where("projectId").equals(y).and(D=>!D.deletedAt).first():void 0,[y]),A=$t(async()=>v?await Se.metres.where("periodeId").equals(v).and(D=>!D.deletedAt).toArray():[],[v],[]),F=$t(()=>v?Se.decompts.where("periodeId").equals(v).and(D=>!D.deletedAt).first():void 0,[v]);me.useEffect(()=>{w&&(f(w.tauxTVA??20),p(w.tauxRetenue??10),g(Hr(w.depensesExercicesAnterieurs??0)),h(Hr(w.decomptesPrecedents??0)))},[w]),me.useEffect(()=>{(async()=>{if(!w||!y||!b)return;const V=await Se.decompts.where("projectId").equals(`project:${y}`).and(G=>!G.deletedAt&&G.numero<w.numero).toArray();if(V.length===0){g(0),h(0);return}const se=new Date(w.dateDebut).getFullYear();let ne=0,X=0;for(const G of V){const ve=await Se.periodes.get(G.periodeId);if(!ve)continue;const ye=new Date(ve.dateDebut).getFullYear();ye<se?ne+=G.montantTotal:ye===se&&(X+=G.montantTotal)}g(Hr(ne)),h(Hr(X))})()},[w,y,b]),me.useEffect(()=>{if(S&&A.length>0){const D=S.lignes.map(V=>{const se=A.find(ve=>ve.bordereauLigneId===`${S.id}-ligne-${V.numero}`),ne=Hr((se==null?void 0:se.totalPartiel)||0),X=Hr(V.prixUnitaire||0),G=Hr(ne*X);return{prixNo:V.numero,designation:V.designation,unite:V.unite,quantiteBordereau:V.quantite,quantiteRealisee:ne,prixUnitaireHT:X,montantHT:G,bordereauLigneId:`${S.id}-ligne-${V.numero}`,metreId:se==null?void 0:se.id}});o(D)}else if(S&&A.length===0){const D=S.lignes.map(V=>{const se=Hr(V.prixUnitaire||0);return{prixNo:V.numero,designation:V.designation,unite:V.unite,quantiteBordereau:V.quantite,quantiteRealisee:0,prixUnitaireHT:se,montantHT:0,bordereauLigneId:`${S.id}-ligne-${V.numero}`}});o(D)}},[S,A]);const T=Hr(i.reduce((D,V)=>D+V.montantHT,0)),O=Hr(T*c/100),C=Hr(T+O),k=(()=>{let D=0,V=0;w!=null&&w.isDecompteDernier?(D=C,V=0):(D=0,V=C);const se=0,ne=C,X=Hr((S==null?void 0:S.lignes.reduce((te,fe)=>{const ge=Hr(fe.quantite*(fe.prixUnitaire||0));return te+Hr(ge*1.2)},0))||0),G=Hr(C*.1),ve=Hr(X*.07),ye=Hr(Math.min(G,ve)),E=Hr(ne-ye),M=Hr(E-m),I=Hr(m+d),z=Hr(M-d);return{travauxTermines:D,travauxNonTermines:V,approvisionnements:se,totalAvantRetenue:ne,retenueGarantie:ye,resteAPayer:M,depensesExercicesAnterieurs:m,totalADeduire:I,montantAcompte:z}})();me.useEffect(()=>{(async()=>{if(!n||!y||!v||!w||!F||i.length===0)return;const V=new Date().toISOString(),se=k.montantAcompte;(F.montantTotal!==se||F.totalTTC!==C)&&(await Se.decompts.update(F.id,{lignes:i,montantTotal:se,totalTTC:C,updatedAt:V}),console.log(" Dcompte mis  jour automatiquement:",se,"TTC:",C))})()},[i,k.montantAcompte,F,n,y,v,w]);const P=async()=>{if(!(!n||!y||!v||!w)){a(!0);try{const D=new Date().toISOString();if(await Se.periodes.update(v,{tauxTVA:c,tauxRetenue:u,depensesExercicesAnterieurs:m,decomptesPrecedents:d,updatedAt:D}),await mn("UPDATE","periode",v.replace("periode:",""),{tauxTVA:c,tauxRetenue:u,depensesExercicesAnterieurs:m,decomptesPrecedents:d},n.id),F)await Se.decompts.update(F.id,{lignes:i,montantTotal:k.montantAcompte,totalTTC:C,statut:"draft",updatedAt:D}),await mn("UPDATE","decompt",F.id.replace("decompt:",""),{montantTotal:k.montantAcompte,lignesCount:i.length},n.id);else{const V=`decompt:${Ir()}`,se={id:V,projectId:y,periodeId:v,userId:n.id,numero:w.numero,lignes:i,montantTotal:k.montantAcompte,totalTTC:C,statut:"draft",createdAt:D,updatedAt:D};await Se.decompts.add(se),await mn("CREATE","decompt",V.replace("decompt:",""),se,n.id)}alert("Dcompte enregistr avec succs !"),r(`/projects/${y}/periodes`)}catch(D){console.error("Erreur lors de la sauvegarde:",D),alert("Erreur lors de la sauvegarde du dcompte")}finally{a(!1)}}},q=async()=>{if(!b||!w||!S||!y){alert("Donnes manquantes pour gnrer le PDF");return}try{console.log(" Recherche des dcomptes prcdents..."),console.log(" Project ID:",y),console.log(" Priode actuelle:",w);const D=await Se.decompts.where("projectId").equals(`project:${y}`).toArray();console.log(" TOUS les dcomptes du projet:",D);const V=D.filter(ne=>!ne.deletedAt&&ne.numero<w.numero);console.log(" Dcomptes prcdents filtrs:",V);const se=await Promise.all(V.map(async ne=>{const X=await Se.periodes.get(ne.periodeId);return console.log(` Priode du dcompte ${ne.numero}:`,X),{numero:ne.numero,date:X?new Date(X.dateFin).toLocaleDateString("fr-FR"):"",montant:ne.montantTotal,isDecompteDernier:(X==null?void 0:X.isDecompteDernier)||!1}}));se.sort((ne,X)=>ne.numero-X.numero),console.log(" Dcomptes prcdents avec dates (tris):",se),await fee(b,w,S,i,k,c,T,O,C,se)}catch(D){console.error("Erreur lors de la gnration du PDF:",D),alert("Erreur lors de la gnration du PDF")}};return!b||!w||!S?l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>r(`/projects/${y}/periodes`),className:"btn-secondary mb-4 flex items-center gap-2",children:[l.jsx(Ts,{className:"w-4 h-4"}),"Retour aux priodes"]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Dcompte Provisoire N",w.numero.toString().padStart(2,"0"),w.isDecompteDernier?" et dernier":""]}),l.jsxs("p",{className:"text-gray-600",children:["Priode: ",w.libelle," "," ",Vr(new Date(w.dateDebut),"dd/MM/yyyy",{locale:Ti})," -"," ",Vr(new Date(w.dateFin),"dd/MM/yyyy",{locale:Ti})]}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:b.objet})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("button",{onClick:q,className:"btn-secondary flex items-center gap-2",children:[l.jsx(qu,{className:"w-5 h-5"}),"Exporter PDF"]}),l.jsxs("button",{onClick:P,disabled:s,className:"btn-primary flex items-center gap-2",children:[l.jsx(Fc,{className:"w-5 h-5"}),s?"Enregistrement...":"Enregistrer"]})]})]})]}),l.jsxs("div",{className:"card mb-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[l.jsx(Sr,{className:"w-5 h-5 text-primary-600"}),"Informations du Projet"]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Matre d'ouvrage:"}),l.jsx("p",{className:"text-gray-900",children:"ROYAUME DU MAROC - Ministre de l'Agriculture"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Projet:"}),l.jsx("p",{className:"text-gray-900",children:b.objet})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"March N:"}),l.jsx("p",{className:"text-gray-900",children:b.marcheNo})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Montant du march (TTC):"}),l.jsxs("p",{className:"text-gray-900 font-bold text-primary-600",children:[S.lignes.reduce((D,V)=>{const ne=V.quantite*(V.prixUnitaire||0)*1.2;return D+ne},0).toLocaleString("fr-MA",{minimumFractionDigits:2})," ","DH"]})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:l.jsx(aT,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length}),l.jsx("p",{className:"text-sm text-gray-600",children:"Lignes"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:l.jsx(ka,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:T.toLocaleString("fr-MA",{maximumFractionDigits:2})}),l.jsx("p",{className:"text-sm text-gray-600",children:"Total HT (DH)"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(aa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C.toLocaleString("fr-MA",{maximumFractionDigits:2})}),l.jsx("p",{className:"text-sm text-gray-600",children:"Total TTC (DH)"})]})]})}),l.jsx("div",{className:"card",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:l.jsx(Fa,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:k.montantAcompte.toLocaleString("fr-MA",{maximumFractionDigits:2})}),l.jsx("p",{className:"text-sm text-gray-600",children:" payer (DH)"})]})]})})]}),l.jsxs("div",{className:"card mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Dsignations des Prestations"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border border-gray-300",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"Prix N"}),l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation des Prestations"}),l.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"U"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-28",children:"Quantit"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-32",children:"Prix U En DH hors TVA"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-36",children:"Prix Total En DH hors TVA"})]})}),l.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(D=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-gray-700 font-medium border-r border-gray-200",children:D.prixNo}),l.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:D.designation}),l.jsx("td",{className:"px-4 py-3 text-center border-r border-gray-200",children:l.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:D.unite})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:D.quantiteRealisee.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:D.prixUnitaireHT.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:D.montantHT.toLocaleString("fr-MA",{minimumFractionDigits:2})})]},D.bordereauLigneId))}),l.jsxs("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:[l.jsxs("tr",{children:[l.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral Hors TVA"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:T.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{children:[l.jsxs("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:["Total TVA (",c,"%)"]}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:O.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{className:"bg-primary-50",children:[l.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral (T.T.C)"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:C.toLocaleString("fr-MA",{minimumFractionDigits:2})})]})]})]})})]}),l.jsxs("div",{className:"card mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Rcapitulation"}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border border-gray-300",children:[l.jsx("thead",{className:"bg-gray-100",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Nature des Dpenses"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-40 whitespace-nowrap",children:"Montants"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-48 whitespace-nowrap",children:"Retenue de Garantie"}),l.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40 whitespace-nowrap",children:"Restes"})]})}),l.jsxs("tbody",{className:"divide-y divide-gray-200",children:[l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux termins"}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:k.travauxTermines.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:w!=null&&w.isDecompteDernier?k.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2}):""}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:w!=null&&w.isDecompteDernier?(k.travauxTermines-k.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2}):""})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux non termins"}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:k.travauxNonTermines.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:w!=null&&w.isDecompteDernier?"":k.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:w!=null&&w.isDecompteDernier?"":(k.travauxNonTermines-k.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Approvisionnements"}),l.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),l.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),l.jsx("td",{className:"px-4 py-3"})]}),l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("td",{className:"px-4 py-3 text-gray-900 font-bold border-r border-gray-200",children:"TOTAUX"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:k.totalAvantRetenue.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:k.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2})}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:(k.totalAvantRetenue-k.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire les dpenses imputes sur exercices antrieurs"}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:k.depensesExercicesAnterieurs.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{children:[l.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:"Reste  payer sur l'exercice en cours"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:k.resteAPayer.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{children:[l.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire le montant des acomptes dlivrs sur l'exercice en cours"}),l.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:d.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),l.jsxs("tr",{className:"bg-primary-50",children:[l.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-bold border-r border-gray-200",children:"Montant de l'acompte  dlivrer:"}),l.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:k.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2})})]})]})]})}),l.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["Arrt par nous, Sous-Ordonnateur,  la somme de: ",l.jsx("span",{className:"font-bold",children:hee(k.montantAcompte)})]})})]}),l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Paramtres du Dcompte"}),l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taux TVA (%)"}),l.jsx("input",{type:"number",value:c,onChange:D=>f(parseFloat(D.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retenue de garantie (%)"}),l.jsx("input",{type:"number",value:u,onChange:D=>p(parseFloat(D.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dpenses exercices antrieurs (DH)"}),l.jsx("input",{type:"number",value:m,onChange:D=>g(Hr(parseFloat(D.target.value)||0)),className:"input",min:"0",step:"0.01"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dcomptes prcdents (DH)"}),l.jsx("input",{type:"number",value:d,onChange:D=>h(Hr(parseFloat(D.target.value)||0)),className:"input",min:"0",step:"0.01"})]})]})]})]})},hee=e=>{const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const c=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],f=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],u=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return c[o];if(o>=10&&o<20)return f[o-10];const p=Math.floor(o/10),d=o%10;if(p===7||p===9){const h=u[p],m=10+d;return m<20?h+"-"+f[m-10]:h+"-"+c[d]}return p===8?d===0?"quatre-vingts":"quatre-vingt-"+c[d]:d===0?u[p]:d===1&&p===2?"vingt et un":d===1&&(p===3||p===4||p===5||p===6)?u[p]+" et un":u[p]+"-"+c[d]},s=o=>{if(o===0)return"";const c=Math.floor(o/100),f=o%100;let u="";return c>1?(u=n(c)+" cent",f===0&&(u+="s")):c===1&&(u="cent"),f>0&&(u&&(u+=" "),u+=n(f)),u};let i=(o=>{if(o===0)return"zro";const c=Math.floor(o/1e6),f=Math.floor(o%1e6/1e3),u=o%1e3;let p="";return c>0&&(c===1?p+="un million":p+=s(c)+" millions"),f>0&&(p&&(p+=" "),f===1?p+="mille":p+=s(f)+" mille"),u>0&&(p&&(p+=" "),p+=s(u)),p})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i},pee=()=>{const{projectId:e,periodeId:t}=Pc(),r=Gn(),[n,s]=me.useState(!1),a=e!=null&&e.includes(":")?e:`project:${e}`,i=t!=null&&t.includes(":")?t:`periode:${t}`,o=$t(()=>Se.projects.get(a),[a]),c=$t(()=>Se.periodes.get(i),[i]),f=$t(()=>Se.bordereaux.where("projectId").equals(a).and(m=>!m.deletedAt).first(),[a]),u=$t(()=>Se.metres.where("periodeId").equals(i).and(m=>!m.deletedAt).toArray(),[i]),d=!(f!=null&&f.lignes)||!u?[]:f.lignes.map((m,g)=>{const y=`${f.id}-ligne-${m.numero}`,v=u.find(w=>w.bordereauLigneId===y),b=(v==null?void 0:v.totalCumule)||0;return{numero:g+1,designation:m.designation,unite:m.unite||"",quantiteCumulee:b}}).filter(m=>m.quantiteCumulee>0),h=async()=>{if(!(!o||!c||!f)){s(!0);try{const m=new mt("p","mm","a4"),g=m.internal.pageSize.getWidth(),y=m.internal.pageSize.getHeight(),v=15;m.setFontSize(12),m.setFont("helvetica","bold"),m.text("Royaume du Maroc",g/2,12,{align:"center"});let b=45;try{const k=new Image;k.crossOrigin="anonymous",await new Promise((D,V)=>{k.onload=()=>D(),k.onerror=()=>V(),k.src="/maroc-logo.png"});const P=30,q=k.height/k.width*P;m.addImage(k,"PNG",(g-P)/2,16,P,q),b=16+q+4}catch{m.setFillColor(200,200,200),m.circle(g/2,28,12,"F"),b=45}m.setFontSize(9),m.setFont("helvetica","normal");const w=["Ministre de l'Agriculture, de la Pche Maritime,","du Dveloppement Rural et des Eaux et Fort","Direction Provinciale de l'Agriculture de Tata","Service des Amnagement hydro-agricole"];let S=b;w.forEach(k=>{m.text(k,g/2,S,{align:"center"}),S+=4}),S+=2,m.setFont("helvetica","bold"),m.setFontSize(10);const A=o.typeProjet==="negocie"?"MARCHE NEGOCIE":"MARCHE";m.text(`${A} N${o.marcheNo}-DPA-TA`,g/2,S,{align:"center"}),S+=8,m.setFontSize(9),m.setFont("helvetica","bold"),m.splitTextToSize(o.objet.toUpperCase(),g-2*v).forEach(k=>{m.text(k,g/2,S,{align:"center"}),S+=4}),S+=6,m.setFontSize(12),m.setFont("helvetica","bold");const T=c.isDecompteDernier?" et dernier":"";m.text(`ATTACHEMENT PROVISOIRE  N${c.numero.toString().padStart(2,"0")}${T}`,g/2,S,{align:"center"}),S+=4,m.setLineWidth(.5),m.line(v,S,g-v,S),S+=6;const O=d.map(k=>[k.numero.toString(),k.designation,k.unite,k.quantiteCumulee.toFixed(2)]);zg(m,{startY:S,head:[["N","Dsignation des ouvrages","U","Quantit"]],body:O,theme:"grid",styles:{fontSize:9,cellPadding:3,lineColor:[0,0,0],lineWidth:.3},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:20,halign:"center"},3:{cellWidth:30,halign:"right"}},didDrawPage:()=>{m.setFontSize(10),m.setFont("helvetica","normal");const k=m.getCurrentPageInfo().pageNumber;m.text(`Page ${k}`,g/2,y-10,{align:"center"})}});const C=m.lastAutoTable.finalY+15;zg(m,{startY:C,head:[["Etabli par","Accept par","Vrifi par"]],body:[["","",""]],theme:"grid",styles:{fontSize:9,cellPadding:15,lineColor:[0,0,0],lineWidth:.3,minCellHeight:25},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}}});const R=`Attachement_${o.marcheNo}_P${c.numero}.pdf`;m.save(R)}catch(m){console.error("Erreur export PDF:",m),alert("Erreur lors de l'export PDF")}finally{s(!1)}}};return!o||!c||!f?l.jsx("div",{className:"flex items-center justify-center min-h-96",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):l.jsxs("div",{className:"max-w-5xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsxs("button",{onClick:()=>r(`/projects/${a}/periodes/${i}/metre`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[l.jsx(Ts,{className:"w-5 h-5"}),"Retour au mtr"]}),l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{children:[l.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:["Attachement Provisoire N ",c.numero.toString().padStart(2,"0"),c.isDecompteDernier?" et dernier":""]}),l.jsxs("p",{className:"text-gray-600",children:["March N ",o.marcheNo," - ",o.annee]}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:o.objet})]}),l.jsxs("button",{onClick:h,disabled:n||d.length===0,className:"btn btn-primary flex items-center gap-2",children:[l.jsx(qu,{className:"w-4 h-4"}),n?"Export en cours...":"Exporter PDF"]})]})]}),l.jsxs("div",{className:"card bg-white",children:[l.jsxs("div",{className:"text-center border-b pb-6 mb-6",children:[l.jsx("h2",{className:"text-lg font-bold mb-3",children:"Royaume du Maroc"}),l.jsx("img",{src:"/maroc-logo.png",alt:"Emblme du Royaume du Maroc",className:"h-24 mx-auto mb-3",onError:m=>{m.target.style.display="none"}}),l.jsx("p",{className:"text-sm text-gray-600",children:"Ministre de l'Agriculture, de la Pche Maritime,"}),l.jsx("p",{className:"text-sm text-gray-600",children:"du Dveloppement Rural et des Eaux et Fort"}),l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Direction Provinciale de l'Agriculture de Tata"}),l.jsxs("p",{className:"font-bold text-sm mb-2",children:[o.typeProjet==="negocie"?"MARCHE NEGOCIE":"MARCHE"," N",o.marcheNo,"-DPA-TA"]}),l.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 px-8",children:o.objet.toUpperCase()}),l.jsxs("h3",{className:"text-lg font-bold border-t border-b py-2 inline-block px-8",children:["ATTACHEMENT PROVISOIRE N",c.numero.toString().padStart(2,"0"),c.isDecompteDernier?" et dernier":""]})]}),d.length>0?l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse border border-gray-400",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-gray-50",children:[l.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-16",children:"N"}),l.jsx("th",{className:"border border-gray-400 px-4 py-3 text-left font-semibold",children:"Dsignation des ouvrages"}),l.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-20",children:"U"}),l.jsx("th",{className:"border border-gray-400 px-4 py-3 text-right font-semibold w-32",children:"Quantit"})]})}),l.jsx("tbody",{children:d.map(m=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:m.numero}),l.jsx("td",{className:"border border-gray-400 px-4 py-2",children:m.designation}),l.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:m.unite}),l.jsx("td",{className:"border border-gray-400 px-4 py-2 text-right font-medium",children:m.quantiteCumulee.toFixed(2)})]},m.numero))})]})}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(Sr,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune quantit saisie"}),l.jsx("p",{className:"text-gray-600",children:"Saisissez d'abord les quantits dans le mtr pour gnrer l'attachement"})]}),d.length>0&&l.jsx("div",{className:"mt-8 pt-6 border-t",children:l.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[l.jsx("p",{className:"font-semibold mb-8",children:"Etabli par"}),l.jsx("div",{className:"h-16"})]}),l.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[l.jsx("p",{className:"font-semibold mb-8",children:"Accept par"}),l.jsx("div",{className:"h-16"})]}),l.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[l.jsx("p",{className:"font-semibold mb-8",children:"Vrifi par"}),l.jsx("div",{className:"h-16"})]})]})})]})]})},mee=()=>{const{t:e,i18n:t}=Mi(),[r,n]=me.useState(kp()),[s,a]=me.useState(localStorage.getItem("base_folder_name")),[i,o]=me.useState(!1),[c,f]=me.useState("storage"),u=[{type:"local",name:"Stockage Local",description:"Enregistrez vos projets sur votre ordinateur",icon:$9,available:!0},{type:"onedrive",name:"OneDrive",description:"Synchronisez avec Microsoft OneDrive",icon:sS,available:!1,comingSoon:!0},{type:"google-drive",name:"Google Drive",description:"Synchronisez avec Google Drive",icon:sS,available:!1,comingSoon:!0}],p=async()=>{const g=await mX();g&&(a(g),n(y=>({...y,basePath:g})))},d=()=>{n8(r),o(!0),setTimeout(()=>o(!1),2e3)},h=g=>{const y=u.find(v=>v.type===g);y!=null&&y.available&&n(v=>({...v,type:g}))},m="showDirectoryPicker"in window;return l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[l.jsx(kw,{className:"w-8 h-8 text-primary-600"}),e("settings.title")]}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Configurez les paramtres de l'application"})]}),l.jsxs("div",{className:"flex gap-6",children:[l.jsx("div",{className:"w-64 flex-shrink-0",children:l.jsxs("nav",{className:"space-y-1",children:[l.jsxs("button",{onClick:()=>f("storage"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${c==="storage"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx(Dm,{className:"w-5 h-5"}),"Stockage des fichiers",l.jsx(Gf,{className:"w-4 h-4 ml-auto"})]}),l.jsxs("button",{onClick:()=>f("general"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${c==="general"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx(kw,{className:"w-5 h-5"}),"Paramtres gnraux",l.jsx(Gf,{className:"w-4 h-4 ml-auto"})]}),l.jsxs("button",{onClick:()=>f("about"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${c==="about"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx(aS,{className:"w-5 h-5"})," propos",l.jsx(Gf,{className:"w-4 h-4 ml-auto"})]})]})}),l.jsxs("div",{className:"flex-1",children:[c==="storage"&&l.jsxs("div",{className:"card",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[l.jsx(Dm,{className:"w-6 h-6 text-primary-600"}),"Configuration du stockage"]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"flex gap-3",children:[l.jsx(aS,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-blue-800 font-medium",children:"Comment a fonctionne ?"}),l.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Choisissez un emplacement o tous vos dossiers de projets seront crs automatiquement. Chaque projet aura sa propre structure de dossiers organise (Bordereau, Mtr, Dcomptes, etc.)."})]})]})}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de stockage"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:u.map(g=>{const y=g.icon;return l.jsxs("button",{onClick:()=>h(g.type),disabled:!g.available,className:`relative p-4 rounded-lg border-2 text-left transition-all ${r.type===g.type?"border-primary-500 bg-primary-50":g.available?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"}`,children:[g.comingSoon&&l.jsx("span",{className:"absolute top-2 right-2 px-2 py-0.5 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Bientt"}),l.jsx(y,{className:`w-8 h-8 mb-2 ${r.type===g.type?"text-primary-600":"text-gray-400"}`}),l.jsx("p",{className:`font-medium ${r.type===g.type?"text-primary-900":"text-gray-900"}`,children:g.name}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:g.description}),r.type===g.type&&l.jsx("div",{className:"absolute top-2 left-2",children:l.jsx(nS,{className:"w-5 h-5 text-primary-600"})})]},g.type)})})]}),r.type==="local"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dossier de base"}),m?l.jsxs("div",{className:"flex gap-3",children:[l.jsxs("div",{className:"flex-1 flex items-center gap-3 px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx(Sw,{className:"w-5 h-5 text-gray-400"}),l.jsx("span",{className:s?"text-gray-900":"text-gray-500",children:s||"Aucun dossier slectionn"})]}),l.jsxs("button",{onClick:p,className:"btn-primary flex items-center gap-2",children:[l.jsx(Dm,{className:"w-4 h-4"}),"Choisir un dossier"]})]}):l.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-yellow-800 text-sm",children:[l.jsx("strong",{children:"Note :"})," Votre navigateur ne supporte pas la slection de dossiers. Les fichiers seront tlchargs dans votre dossier de tlchargements par dfaut.",l.jsx("br",{}),l.jsx("span",{className:"text-yellow-700",children:"Pour une meilleure exprience, utilisez Chrome, Edge ou Opera."})]})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Structure des dossiers"}),l.jsxs("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 font-mono text-sm",children:[l.jsxs("div",{className:"text-yellow-400",children:[" ",s||"MesProjetsBTP","/"]}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-blue-400",children:" 2025/"}),l.jsxs("div",{className:"ml-4",children:[l.jsx("div",{className:"text-green-400",children:" 12-2025-dpa-ta/"}),l.jsxs("div",{className:"ml-4 text-gray-400",children:[l.jsx("div",{children:" Bordereau/"}),l.jsx("div",{children:" Mtr/"}),l.jsx("div",{children:" Dcomptes/"}),l.jsx("div",{children:" Attachements/"}),l.jsx("div",{children:" Photos/"}),l.jsx("div",{children:" PV/"}),l.jsx("div",{children:" Documents/"})]})]})]})]})]})]}),l.jsx("div",{className:"mt-6 pt-6 border-t flex justify-end",children:l.jsx("button",{onClick:d,className:"btn-primary flex items-center gap-2",children:i?l.jsxs(l.Fragment,{children:[l.jsx(nS,{className:"w-4 h-4"}),"Enregistr !"]}):l.jsxs(l.Fragment,{children:[l.jsx(Fc,{className:"w-4 h-4"}),"Enregistrer les paramtres"]})})})]}),c==="general"&&l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Paramtres gnraux"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Langue de l'interface"}),l.jsx("div",{className:"flex gap-2",children:[{code:"fr",label:"Franais",flag:""},{code:"ar",label:"",flag:""},{code:"en",label:"English",flag:""}].map(g=>l.jsxs("button",{onClick:()=>t.changeLanguage(g.code),className:`flex items-center gap-2 px-4 py-2 rounded-lg border-2 transition-colors ${t.language===g.code?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("span",{className:"text-xl",children:g.flag}),l.jsx("span",{children:g.label})]},g.code))})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[l.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-gray-300 text-primary-600 focus:ring-primary-500",defaultChecked:!0}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900",children:"Sauvegarde automatique"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Enregistrer automatiquement les modifications"})]})]})}),l.jsxs("div",{className:"pt-6 border-t",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Gestion des donnes"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[l.jsx(zh,{className:"w-5 h-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900",children:"Exporter toutes les donnes"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Tlcharger une sauvegarde complte"})]})]}),l.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[l.jsx(Dm,{className:"w-5 h-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium text-gray-900",children:"Importer des donnes"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Restaurer depuis une sauvegarde"})]})]})]})]})]}),c==="about"&&l.jsxs("div",{className:"card",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:" propos"}),l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:l.jsx(Sw,{className:"w-10 h-10 text-primary-600"})}),l.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Suivi Chantier BTP"}),l.jsx("p",{className:"text-gray-500 mt-1",children:"Version 1.0.0"}),l.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[l.jsx("p",{children:"Application de gestion de projets BTP"}),l.jsxs("p",{className:"mt-2",children:["Dvelopp pour simplifier la gestion des marchs,",l.jsx("br",{}),"des mtrs, des dcomptes et des attachements."]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t text-sm text-gray-500",children:l.jsx("p",{children:" 2025 - Tous droits rservs"})})]})]})]})]})]})};function gee(){const e=Gn(),{user:t}=Yr(),[r,n]=me.useState({totalUsers:0,activeUsers:0,trialUsers:0,expiredTrials:0}),[s,a]=me.useState([]),[i,o]=me.useState(!0);me.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}c()},[t,e]);const c=async()=>{try{const u=await Se.users.toArray(),p=await Se.auditLogs.orderBy("timestamp").reverse().limit(10).toArray(),d=new Date,h=u.filter(y=>y.isActive).length,m=u.filter(y=>y.trialEndDate&&new Date(y.trialEndDate)>d).length,g=u.filter(y=>y.trialEndDate&&new Date(y.trialEndDate)<=d).length;n({totalUsers:u.length,activeUsers:h,trialUsers:m,expiredTrials:g}),a(p),o(!1)}catch(u){console.error("Error loading dashboard data:",u),o(!1)}},f=u=>({create_user:"Utilisateur cr",disable_user:"Utilisateur dsactiv",enable_user:"Utilisateur activ",delete_user:"Utilisateur supprim",extend_trial:"Essai prolong",update_role:"Rle modifi"})[u]||u;return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white border-b border-gray-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Ts,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:l.jsx(bg,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Tableau de bord Admin"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Vue d'ensemble du systme"})]})]})]}),l.jsxs("button",{onClick:()=>e("/admin/users"),className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Ew,{className:"w-4 h-4"}),"Grer les utilisateurs"]})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[l.jsx(t1,{title:"Total Utilisateurs",value:r.totalUsers,icon:Ew,color:"blue"}),l.jsx(t1,{title:"Utilisateurs Actifs",value:r.activeUsers,icon:bg,color:"green"}),l.jsx(t1,{title:"Priodes d'essai",value:r.trialUsers,icon:Ei,color:"yellow"}),l.jsx(t1,{title:"Essais Expirs",value:r.expiredTrials,icon:Qa,color:"red"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx(L9,{className:"w-5 h-5 text-gray-400"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activit Rcente"})]})}),l.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?l.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:"Aucune activit rcente"}):s.map(u=>l.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[l.jsx("span",{className:"text-sm font-medium text-gray-900",children:u.userEmail}),l.jsx("span",{className:"text-sm text-gray-500",children:""}),l.jsx("span",{className:"text-sm text-gray-600",children:f(u.action)})]}),u.details&&l.jsxs("div",{className:"text-sm text-gray-500",children:[u.details.email&&l.jsxs("span",{children:["Email: ",u.details.email]}),u.details.role&&l.jsxs("span",{className:"ml-3",children:["Rle: ",u.details.role]})]})]}),l.jsx("div",{className:"text-xs text-gray-400",children:Vr(new Date(u.timestamp),"dd MMM yyyy HH:mm",{locale:Ti})})]})},u.id))})]})]})]})}function t1({title:e,value:t,icon:r,color:n}){const s={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600"};return l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex items-center justify-between mb-4",children:l.jsx("div",{className:`p-3 rounded-lg ${s[n]}`,children:l.jsx(r,{className:"w-6 h-6"})})}),l.jsxs("div",{className:"space-y-1",children:[l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),l.jsx("p",{className:"text-sm text-gray-600",children:e})]})]})}function xee(){const e=Gn(),{user:t}=Yr(),[r,n]=me.useState([]),[s,a]=me.useState(!1),[i,o]=me.useState(!0);me.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}c()},[t,e]);const c=async()=>{try{const d=await Se.users.toArray();n(d.filter(h=>!h.email.includes("deleted"))),o(!1)}catch(d){console.error("Error loading users:",d),o(!1)}},f=async(d,h,m)=>{const g={id:`audit:${Ir()}`,userId:t.id,userEmail:t.email,action:d,entityType:"user",entityId:h,details:m,timestamp:new Date().toISOString()};await Se.auditLogs.add(g)},u=async d=>{try{await Se.users.update(d.id,{isActive:!d.isActive}),await f(d.isActive?"disable_user":"enable_user",d.id,{email:d.email,previousStatus:d.isActive}),c()}catch(h){console.error("Error toggling user status:",h),alert("Erreur lors de la modification du statut")}},p=async d=>{if(confirm(`tes-vous sr de vouloir supprimer ${d.firstName} ${d.lastName}?`))try{await Se.users.delete(d.id),await f("delete_user",d.id,{email:d.email,name:`${d.firstName} ${d.lastName}`}),c()}catch(h){console.error("Error deleting user:",h),alert("Erreur lors de la suppression")}};return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white border-b border-gray-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex items-center justify-between h-16",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Ts,{className:"w-5 h-5 text-gray-600"})}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-2 bg-primary-100 text-primary-600 rounded-lg",children:l.jsx(Ew,{className:"w-6 h-6"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Gestion des Utilisateurs"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[r.length," utilisateurs"]})]})]})]}),l.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary flex items-center gap-2",children:[l.jsx(Vs,{className:"w-4 h-4"}),"Nouvel Utilisateur"]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rle"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priode d'essai"}),l.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(d=>{const h=d.trialEndDate&&new Date(d.trialEndDate)<new Date,m=d.trialEndDate?Math.ceil((new Date(d.trialEndDate).getTime()-new Date().getTime())/(1e3*60*60*24)):null;return l.jsxs("tr",{className:h?"bg-red-50":"",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsxs("div",{children:[l.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[d.firstName," ",d.lastName]}),l.jsx("div",{className:"text-sm text-gray-500",children:d.email})]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.role==="super_admin"?"bg-purple-100 text-purple-800":d.role==="admin"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:d.role==="super_admin"?"Super Admin":d.role==="admin"?"Admin":"User"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.isActive?"Actif":"Dsactiv"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d.trialEndDate?l.jsx("div",{className:h?"text-red-600 font-medium":"",children:h?"Expir":l.jsxs("span",{children:[m," jours restants"]})}):l.jsx("span",{className:"text-gray-400",children:"-"})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:l.jsx("div",{className:"flex items-center justify-end gap-2",children:d.role!=="super_admin"&&l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>u(d),className:`p-2 rounded-lg transition-colors ${d.isActive?"hover:bg-red-50 text-red-600":"hover:bg-green-50 text-green-600"}`,title:d.isActive?"Dsactiver":"Activer",children:d.isActive?l.jsx(W9,{className:"w-4 h-4"}):l.jsx(rB,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>p(d),className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",title:"Supprimer",children:l.jsx(fa,{className:"w-4 h-4"})})]})})})]},d.id)})})]})})}),s&&l.jsx(vee,{onClose:()=>a(!1),onCreated:()=>{a(!1),c()},currentUser:t})]})}function vee({onClose:e,onCreated:t,currentUser:r}){const[n,s]=me.useState({email:"",password:"",firstName:"",lastName:"",role:"user",trialDays:30,hasTrial:!1}),a=async i=>{i.preventDefault();try{const o=n.hasTrial?new Date(Date.now()+n.trialDays*24*60*60*1e3).toISOString():void 0,c={id:`user:${Ir()}`,email:n.email,firstName:n.firstName,lastName:n.lastName,role:n.role,isActive:!0,trialEndDate:o,createdBy:r.id,createdAt:new Date().toISOString()};await Se.users.add(c);const f={id:`audit:${Ir()}`,userId:r.id,userEmail:r.email,action:"create_user",entityType:"user",entityId:c.id,details:{email:c.email,role:c.role,hasTrial:n.hasTrial,trialDays:n.trialDays},timestamp:new Date().toISOString()};await Se.auditLogs.add(f),alert(`Utilisateur cr avec succs!
Email: ${n.email}
Mot de passe: ${n.password}

Veuillez communiquer ces informations  l'utilisateur.`),t()}catch(o){console.error("Error creating user:",o),alert("Erreur lors de la cration de l'utilisateur")}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouvel Utilisateur"}),l.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:l.jsx(Ts,{className:"w-6 h-6"})})]}),l.jsxs("form",{onSubmit:a,className:"p-6 space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Prnom ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:n.firstName,onChange:i=>s({...n,firstName:i.target.value}),className:"input w-full",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nom ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:n.lastName,onChange:i=>s({...n,lastName:i.target.value}),className:"input w-full",required:!0})]})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"email",value:n.email,onChange:i=>s({...n,email:i.target.value}),className:"input w-full",placeholder:"utilisateur@agriculture.gov.ma",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mot de passe ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsx("input",{type:"text",value:n.password,onChange:i=>s({...n,password:i.target.value}),className:"input w-full",placeholder:"Gnrer un mot de passe fort",required:!0})]}),l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Rle ",l.jsx("span",{className:"text-red-500",children:"*"})]}),l.jsxs("select",{value:n.role,onChange:i=>s({...n,role:i.target.value}),className:"input w-full",children:[l.jsx("option",{value:"user",children:"Utilisateur"}),l.jsx("option",{value:"admin",children:"Administrateur"})]})]}),l.jsxs("div",{className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg",children:[l.jsx("input",{type:"checkbox",checked:n.hasTrial,onChange:i=>s({...n,hasTrial:i.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),l.jsx("label",{className:"text-sm font-medium text-gray-700 flex-1",children:"Priode d'essai"}),n.hasTrial&&l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",value:n.trialDays,onChange:i=>s({...n,trialDays:parseInt(i.target.value)||30}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-sm",min:"1"}),l.jsx("span",{className:"text-sm text-gray-600",children:"jours"})]})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),l.jsx("button",{type:"submit",className:"flex-1 btn btn-primary",children:"Crer"})]})]})]})})}const yee=()=>{const{user:e}=Yr(),[t,r]=me.useState(null),n=$t(()=>Se.projects.where("userId").equals((e==null?void 0:e.id)||"").and(i=>!!i.deletedAt).toArray(),[e==null?void 0:e.id]),s=async i=>{if(e){r(i);try{await ra.restoreProject(i),await Se.projects.update(i,{deletedAt:void 0,updatedAt:new Date().toISOString()}),await mn("UPDATE","project",i,{deletedAt:null},e.id)}catch(o){console.error("Error restoring project:",o),alert("   ")}finally{r(null)}}},a=async i=>{if(!(!e||!confirm("           !"))){r(i);try{await Se.projects.delete(i)}catch(o){console.error("Error deleting project permanently:",o),alert("    ")}finally{r(null)}}};return n?l.jsxs("div",{className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:l.jsx(fa,{className:"w-6 h-6 text-red-600"})}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),l.jsx("p",{className:"text-sm text-gray-500",children:"  "})]})]})}),l.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[l.jsx(Qa,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),l.jsxs("div",{className:"text-sm text-amber-800",children:[l.jsx("p",{className:"font-medium",children:"   "}),l.jsx("p",{className:"mt-1",children:"       .      ."})]})]}),n.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(fa,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),l.jsx("p",{className:"text-gray-500",children:"   "})]}):l.jsx("div",{className:"card overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{className:"border-b border-gray-200",children:[l.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),l.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),l.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),l.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),l.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-gray-700",children:""})]})}),l.jsx("tbody",{children:n.map(i=>l.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[l.jsxs("td",{className:"py-3 px-4",children:[l.jsx("div",{className:"font-medium text-gray-900",children:i.objet}),i.societe&&l.jsx("div",{className:"text-xs text-gray-500",children:i.societe})]}),l.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:i.marcheNo}),l.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:i.annee}),l.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(Ei,{className:"w-4 h-4 text-gray-400"}),i.deletedAt?Vr(new Date(i.deletedAt),"dd/MM/yyyy HH:mm"):"-"]})}),l.jsx("td",{className:"py-3 px-4",children:l.jsxs("div",{className:"flex items-center justify-center gap-2",children:[l.jsxs("button",{onClick:()=>s(i.id),disabled:t===i.id,className:"flex items-center gap-1 px-3 py-1.5 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:"",children:[l.jsx(Q9,{className:"w-4 h-4"}),""]}),l.jsxs("button",{onClick:()=>a(i.id),disabled:t===i.id,className:"flex items-center gap-1 px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:" ",children:[l.jsx(fa,{className:"w-4 h-4"})," "]})]})})]},i.id))})]})})})]}):l.jsx("div",{className:"flex items-center justify-center h-96",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})},ea=({children:e})=>{var d,h;const{t,i18n:r}=Mi(),n=Td(),s=Gn(),{user:a,logout:i}=Yr(),[o,c]=me.useState(!0),f=()=>{i(),s("/login")},u=m=>{r.changeLanguage(m)},p=[{path:"/",icon:z9,label:t("dashboard.title")},{path:"/projects",icon:Du,label:t("project.projects")},{path:"/delais",icon:xo,label:"Gestion des Dlais"},{path:"/trash",icon:fa,label:" "},{path:"/settings",icon:kw,label:t("settings.title")}];return(a==null?void 0:a.role)==="super_admin"&&p.splice(2,0,{path:"/admin",icon:bg,label:"Administration"}),l.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[l.jsxs("aside",{className:`${o?"w-64":"w-20"} bg-white border-r border-gray-200 transition-all duration-300 relative flex flex-col`,children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[o&&l.jsx("h1",{className:"text-xl font-bold text-primary-600",children:t("app.title")}),l.jsx("button",{onClick:()=>c(!o),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(G9,{className:"w-5 h-5"})})]}),l.jsx("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:p.map(m=>{const g=m.icon,y=n.pathname===m.path;return l.jsxs(Ai,{to:m.path,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${y?"bg-primary-50 text-primary-600":"text-gray-700 hover:bg-gray-100"}`,children:[l.jsx(g,{className:"w-5 h-5 flex-shrink-0"}),o&&l.jsx("span",{children:m.label})]},m.path)})}),l.jsxs("div",{className:"p-4 border-t mt-auto",children:[l.jsxs("div",{className:"mb-4",children:[o&&l.jsxs("div",{className:"flex gap-2",children:[l.jsx("button",{onClick:()=>u("fr"),className:`px-3 py-1 text-sm rounded ${r.language==="fr"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"FR"}),l.jsx("button",{onClick:()=>u("ar"),className:`px-3 py-1 text-sm rounded ${r.language==="ar"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"AR"}),l.jsx("button",{onClick:()=>u("en"),className:`px-3 py-1 text-sm rounded ${r.language==="en"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"EN"})]}),!o&&l.jsx(U9,{className:"w-5 h-5 mx-auto text-gray-500"})]}),l.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[l.jsxs("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 font-semibold flex-shrink-0",children:[(d=a==null?void 0:a.firstName)==null?void 0:d[0],(h=a==null?void 0:a.lastName)==null?void 0:h[0]]}),o&&l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]}),l.jsxs("button",{onClick:f,className:"w-full flex items-center gap-3 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[l.jsx(K9,{className:"w-5 h-5 flex-shrink-0"}),o&&l.jsx("span",{children:t("auth.logout")})]})]})]}),l.jsx("main",{className:"flex-1 overflow-auto",children:l.jsx("div",{className:"p-8",children:e})})]})},wee=({syncState:e,onSync:t,onClearPending:r})=>{const{t:n}=Mi(),[s,a]=me.useState(!1),[i,o]=me.useState(!1),c=()=>{if(e.realtimeConnected||e.status==="realtime")return l.jsx(J9,{className:"w-4 h-4 text-green-500 animate-pulse"});switch(e.status){case"offline":return l.jsx(sB,{className:"w-4 h-4 text-red-500"});case"syncing":case"pulling":return l.jsx(J2,{className:"w-4 h-4 text-blue-500 animate-spin"});case"synced":return l.jsx(yg,{className:"w-4 h-4 text-green-500"});case"error":return l.jsx(Qa,{className:"w-4 h-4 text-red-500"});default:return l.jsx(aB,{className:"w-4 h-4 text-gray-500"})}},f=()=>e.realtimeConnected||e.status==="realtime"?n("sync.status.realtime","En direct"):n(`sync.status.${e.status}`),u=()=>{if(e.realtimeConnected||e.status==="realtime")return"bg-green-100 text-green-800 border-green-200";switch(e.status){case"offline":return"bg-red-100 text-red-800 border-red-200";case"syncing":case"pulling":return"bg-blue-100 text-blue-800 border-blue-200";case"synced":return"bg-green-100 text-green-800 border-green-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},p=async()=>{if(r){o(!0);try{await r(),a(!1)}finally{o(!1)}}};return l.jsxs("div",{className:"fixed top-4 right-4 z-50",children:[l.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border shadow-sm ${u()} cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>e.status==="error"?a(!s):t==null?void 0:t(),title:e.status==="error"?n("sync.clickForOptions","Cliquer pour options"):n("sync.clickToSync","Cliquer pour synchroniser"),children:[c(),l.jsx("span",{className:"text-sm font-medium",children:f()}),e.pendingOperations>0&&l.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-white rounded-full",children:e.pendingOperations}),t&&e.status!=="syncing"&&e.status!=="pulling"&&l.jsx(zh,{className:"w-4 h-4 ml-1 opacity-60 hover:opacity-100"})]}),e.error&&l.jsxs("div",{className:"mt-2 p-2 text-xs text-red-700 bg-red-50 rounded-lg border border-red-200",children:[l.jsx("p",{children:e.error}),r&&e.pendingOperations>0&&l.jsxs("button",{onClick:p,disabled:i,className:"mt-2 flex items-center gap-1 px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded transition-colors disabled:opacity-50",children:[i?l.jsx(J2,{className:"w-3 h-3 animate-spin"}):l.jsx(fa,{className:"w-3 h-3"}),n("sync.clearPending","Effacer les oprations en attente")," (",e.pendingOperations,")"]})]}),s&&e.status==="error"&&l.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border shadow-lg",children:[l.jsxs("button",{onClick:()=>{t==null||t(),a(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[l.jsx(zh,{className:"w-4 h-4"}),n("sync.retry","Ressayer la synchronisation")]}),r&&l.jsxs("button",{onClick:p,disabled:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-700 hover:bg-red-50 rounded disabled:opacity-50",children:[i?l.jsx(J2,{className:"w-4 h-4 animate-spin"}):l.jsx(fa,{className:"w-4 h-4"}),n("sync.clearAndRetry","Effacer et ressayer")]})]})]})};function bee(){const{isUpdateAvailable:e,updateInfo:t,isDownloading:r,downloadProgress:n,isUpdateDownloaded:s,error:a}=sT(),[i,o]=me.useState(!1);if(i||!e&&!s&&!a)return null;const c=async()=>{if(window.electron)try{const p=await window.electron.downloadUpdate();p.error&&console.error("Failed to download update:",p.error)}catch(p){console.error("Error downloading update:",p)}},f=async()=>{if(window.electron)try{await window.electron.installUpdate()}catch(p){console.error("Error installing update:",p)}},u=p=>{if(p===0)return"0 Bytes";const d=1024,h=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(p)/Math.log(d));return Math.round(p/Math.pow(d,m)*100)/100+" "+h[m]};return l.jsx("div",{className:"fixed top-4 right-4 z-50 w-96 animate-in slide-in-from-top-5",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:[l.jsxs("div",{className:"flex items-start justify-between p-4 bg-gradient-to-r from-blue-500 to-blue-600",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[s?l.jsx(yg,{className:"h-6 w-6 text-white"}):a?l.jsx(Qa,{className:"h-6 w-6 text-white"}):l.jsx(zh,{className:`h-6 w-6 text-white ${r?"animate-spin":""}`}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-white",children:s?"  ":a?"  ":r?"  ...":" "}),t&&l.jsxs("p",{className:"text-sm text-blue-100",children:[" ",t.version]})]})]}),l.jsx("button",{onClick:()=>o(!0),className:"text-white hover:text-gray-200 transition-colors",children:l.jsx(vo,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"p-4",children:a?l.jsxs("div",{className:"text-sm text-red-600",children:[l.jsx("p",{className:"font-medium",children:"   :"}),l.jsx("p",{className:"mt-1 text-xs",children:a})]}):s?l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"   .       ."}),l.jsxs("button",{onClick:f,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[l.jsx(zh,{className:"h-4 w-4"}),"  "]})]}):r&&n?l.jsxs("div",{children:[l.jsxs("div",{className:"mb-2 flex justify-between text-sm text-gray-600",children:[l.jsx("span",{children:" ..."}),l.jsxs("span",{children:[n.percent,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2 overflow-hidden",children:l.jsx("div",{className:"bg-blue-500 h-full transition-all duration-300 ease-out",style:{width:`${n.percent}%`}})}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[l.jsxs("span",{children:[u(n.transferred)," / ",u(n.total)]}),l.jsxs("span",{children:[u(n.bytesPerSecond),"/s"]})]})]}):l.jsxs("div",{children:[(t==null?void 0:t.releaseNotes)&&l.jsxs("div",{className:"mb-4 text-sm text-gray-700 max-h-32 overflow-y-auto",children:[l.jsx("p",{className:"font-medium mb-1",children:" :"}),l.jsx("div",{className:"text-xs whitespace-pre-wrap",children:t.releaseNotes})]}),l.jsxs("button",{onClick:c,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[l.jsx(qu,{className:"h-4 w-4"})," "]})]})}),!a&&!s&&l.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:l.jsx("p",{className:"text-xs text-gray-500 text-center",children:"      "})})]})})}function Nee(){Mi();const{user:e,checkAuth:t}=Yr(),{syncState:r,sync:n,clearPendingOperations:s}=T9((e==null?void 0:e.id)||null);return C9(),me.useEffect(()=>{t()},[t]),me.useEffect(()=>{if(e){const a=setTimeout(()=>{n().catch(i=>{var o;((o=i.response)==null?void 0:o.status)!==401&&console.error("Sync error on mount:",i)})},500);return()=>clearTimeout(a)}},[e==null?void 0:e.id]),l.jsxs(l.Fragment,{children:[l.jsx(wee,{syncState:r,onSync:n,onClearPending:s}),l.jsx(bee,{}),l.jsxs(ND,{children:[l.jsx(Sn,{path:"/login",element:l.jsx(oB,{})}),l.jsx(Sn,{path:"/register",element:l.jsx(lB,{})}),l.jsx(Sn,{path:"/",element:e?l.jsx(ea,{children:l.jsx(AU,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects",element:e?l.jsx(ea,{children:l.jsx(TU,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/new",element:e?l.jsx(ea,{children:l.jsx(yX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:id",element:e?l.jsx(ea,{children:l.jsx(gX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:id/edit",element:e?l.jsx(ea,{children:l.jsx(wX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/delais",element:e?l.jsx(ea,{children:l.jsx(_X,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/bordereau",element:e?l.jsx(ea,{children:l.jsx(EX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/metre",element:e?l.jsx(ea,{children:l.jsx(LX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/periodes",element:e?l.jsx(ea,{children:l.jsx(DX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/periodes/:periodeId/metre",element:e?l.jsx(ea,{children:l.jsx(RX,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/periodes/:periodeId/decompte",element:e?l.jsx(ea,{children:l.jsx(dee,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/projects/:projectId/periodes/:periodeId/attachement",element:e?l.jsx(ea,{children:l.jsx(pee,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/settings",element:e?l.jsx(ea,{children:l.jsx(mee,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/trash",element:e?l.jsx(ea,{children:l.jsx(yee,{})}):l.jsx(es,{to:"/login",replace:!0})}),l.jsx(Sn,{path:"/admin",element:(e==null?void 0:e.role)==="super_admin"?l.jsx(gee,{}):l.jsx(es,{to:"/",replace:!0})}),l.jsx(Sn,{path:"/admin/users",element:(e==null?void 0:e.role)==="super_admin"?l.jsx(xee,{}):l.jsx(es,{to:"/",replace:!0})}),l.jsx(Sn,{path:"*",element:l.jsx(es,{to:"/",replace:!0})})]})]})}const It=e=>typeof e=="string",k0=()=>{let e,t;const r=new Promise((n,s)=>{e=n,t=s});return r.resolve=e,r.reject=t,r},Uk=e=>e==null?"":""+e,See=(e,t,r)=>{e.forEach(n=>{t[n]&&(r[n]=t[n])})},_ee=/###/g,$k=e=>e&&e.indexOf("###")>-1?e.replace(_ee,"."):e,zk=e=>!e||It(e),fh=(e,t,r)=>{const n=It(t)?t.split("."):t;let s=0;for(;s<n.length-1;){if(zk(e))return{};const a=$k(n[s]);!e[a]&&r&&(e[a]=new r),Object.prototype.hasOwnProperty.call(e,a)?e=e[a]:e={},++s}return zk(e)?{}:{obj:e,k:$k(n[s])}},qk=(e,t,r)=>{const{obj:n,k:s}=fh(e,t,Object);if(n!==void 0||t.length===1){n[s]=r;return}let a=t[t.length-1],i=t.slice(0,t.length-1),o=fh(e,i,Object);for(;o.obj===void 0&&i.length;)a=`${i[i.length-1]}.${a}`,i=i.slice(0,i.length-1),o=fh(e,i,Object),o&&o.obj&&typeof o.obj[`${o.k}.${a}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${a}`]=r},kee=(e,t,r,n)=>{const{obj:s,k:a}=fh(e,t,Object);s[a]=s[a]||[],s[a].push(r)},qg=(e,t)=>{const{obj:r,k:n}=fh(e,t);if(r)return r[n]},Eee=(e,t,r)=>{const n=qg(e,r);return n!==void 0?n:qg(t,r)},gP=(e,t,r)=>{for(const n in t)n!=="__proto__"&&n!=="constructor"&&(n in e?It(e[n])||e[n]instanceof String||It(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):gP(e[n],t[n],r):e[n]=t[n]);return e},yf=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var jee={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Aee=e=>It(e)?e.replace(/[&<>"'\/]/g,t=>jee[t]):e;class Tee{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}const Cee=[" ",",","?","!",";"],Pee=new Tee(20),Fee=(e,t,r)=>{t=t||"",r=r||"";const n=Cee.filter(i=>t.indexOf(i)<0&&r.indexOf(i)<0);if(n.length===0)return!0;const s=Pee.getRegExp(`(${n.map(i=>i==="?"?"\\?":i).join("|")})`);let a=!s.test(e);if(!a){const i=e.indexOf(r);i>0&&!s.test(e.substring(0,i))&&(a=!0)}return a},Qw=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];const n=t.split(r);let s=e;for(let a=0;a<n.length;){if(!s||typeof s!="object")return;let i,o="";for(let c=a;c<n.length;++c)if(c!==a&&(o+=r),o+=n[c],i=s[o],i!==void 0){if(["string","number","boolean"].indexOf(typeof i)>-1&&c<n.length-1)continue;a+=c-a+1;break}s=i}return s},Hg=e=>e&&e.replace("_","-"),Lee={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class Wg{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||Lee,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,n,s){return s&&!this.debug?null:(It(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new Wg(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Wg(this.logger,t)}}var fo=new Wg;class Px{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const s=this.observers[n].get(r)||0;this.observers[n].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(i=>{let[o,c]=i;for(let f=0;f<c;f++)o(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(i=>{let[o,c]=i;for(let f=0;f<c;f++)o.apply(o,[t,...n])})}}class Hk extends Px{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,i=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;t.indexOf(".")>-1?o=t.split("."):(o=[t,r],n&&(Array.isArray(n)?o.push(...n):It(n)&&a?o.push(...n.split(a)):o.push(n)));const c=qg(this.data,o);return!c&&!r&&!n&&t.indexOf(".")>-1&&(t=o[0],r=o[1],n=o.slice(2).join(".")),c||!i||!It(n)?c:Qw(this.data&&this.data[t]&&this.data[t][r],n,a)}addResource(t,r,n,s){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let o=[t,r];n&&(o=o.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(o=t.split("."),s=r,r=o[1]),this.addNamespaces(r),qk(this.data,o,s),a.silent||this.emit("added",t,r,n,s)}addResources(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in n)(It(n[a])||Array.isArray(n[a]))&&this.addResource(t,r,a,n[a],{silent:!0});s.silent||this.emit("added",t,r,n)}addResourceBundle(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[t,r];t.indexOf(".")>-1&&(o=t.split("."),s=n,n=r,r=o[1]),this.addNamespaces(r);let c=qg(this.data,o)||{};i.skipCopy||(n=JSON.parse(JSON.stringify(n))),s?gP(c,n,a):c={...c,...n},qk(this.data,o,c),i.silent||this.emit("added",t,r,n)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var xP={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,s){return e.forEach(a=>{this.processors[a]&&(t=this.processors[a].process(t,r,n,s))}),t}};const Wk={};class Vg extends Px{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),See(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=fo.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const n=this.resolve(t,r);return n&&n.res!==void 0}extractFromKey(t,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let a=r.ns||this.options.defaultNS||[];const i=n&&t.indexOf(n)>-1,o=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!Fee(t,n,s);if(i&&!o){const c=t.match(this.interpolator.nestingRegexp);if(c&&c.length>0)return{key:t,namespaces:It(a)?[a]:a};const f=t.split(n);(n!==s||n===s&&this.options.ns.indexOf(f[0])>-1)&&(a=f.shift()),t=f.join(s)}return{key:t,namespaces:It(a)?[a]:a}}translate(t,r,n){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:i,namespaces:o}=this.extractFromKey(t[t.length-1],r),c=o[o.length-1],f=r.lng||this.language,u=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(f&&f.toLowerCase()==="cimode"){if(u){const S=r.nsSeparator||this.options.nsSeparator;return s?{res:`${c}${S}${i}`,usedKey:i,exactUsedKey:i,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${S}${i}`}return s?{res:i,usedKey:i,exactUsedKey:i,usedLng:f,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:i}const p=this.resolve(t,r);let d=p&&p.res;const h=p&&p.usedKey||i,m=p&&p.exactUsedKey||i,g=Object.prototype.toString.apply(d),y=["[object Number]","[object Function]","[object RegExp]"],v=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,w=!It(d)&&typeof d!="boolean"&&typeof d!="number";if(b&&d&&w&&y.indexOf(g)<0&&!(It(v)&&Array.isArray(d))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const S=this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,d,{...r,ns:o}):`key '${i} (${this.language})' returned an object instead of string.`;return s?(p.res=S,p.usedParams=this.getUsedParamsDetails(r),p):S}if(a){const S=Array.isArray(d),A=S?[]:{},F=S?m:h;for(const T in d)if(Object.prototype.hasOwnProperty.call(d,T)){const O=`${F}${a}${T}`;A[T]=this.translate(O,{...r,joinArrays:!1,ns:o}),A[T]===O&&(A[T]=d[T])}d=A}}else if(b&&It(v)&&Array.isArray(d))d=d.join(v),d&&(d=this.extendTranslation(d,t,r,n));else{let S=!1,A=!1;const F=r.count!==void 0&&!It(r.count),T=Vg.hasDefaultValue(r),O=F?this.pluralResolver.getSuffix(f,r.count,r):"",C=r.ordinal&&F?this.pluralResolver.getSuffix(f,r.count,{ordinal:!1}):"",R=F&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),k=R&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${O}`]||r[`defaultValue${C}`]||r.defaultValue;!this.isValidLookup(d)&&T&&(S=!0,d=k),this.isValidLookup(d)||(A=!0,d=i);const q=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&A?void 0:d,D=T&&k!==d&&this.options.updateMissing;if(A||S||D){if(this.logger.log(D?"updateKey":"missingKey",f,c,i,D?k:d),a){const X=this.resolve(i,{...r,keySeparator:!1});X&&X.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let V=[];const se=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&se&&se[0])for(let X=0;X<se.length;X++)V.push(se[X]);else this.options.saveMissingTo==="all"?V=this.languageUtils.toResolveHierarchy(r.lng||this.language):V.push(r.lng||this.language);const ne=(X,G,ve)=>{const ye=T&&ve!==d?ve:q;this.options.missingKeyHandler?this.options.missingKeyHandler(X,c,G,ye,D,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(X,c,G,ye,D,r),this.emit("missingKey",X,c,G,d)};this.options.saveMissing&&(this.options.saveMissingPlurals&&F?V.forEach(X=>{const G=this.pluralResolver.getSuffixes(X,r);R&&r[`defaultValue${this.options.pluralSeparator}zero`]&&G.indexOf(`${this.options.pluralSeparator}zero`)<0&&G.push(`${this.options.pluralSeparator}zero`),G.forEach(ve=>{ne([X],i+ve,r[`defaultValue${ve}`]||k)})}):ne(V,i,k))}d=this.extendTranslation(d,t,r,p,n),A&&d===i&&this.options.appendNamespaceToMissingKey&&(d=`${c}:${i}`),(A||S)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?d=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}:${i}`:i,S?d:void 0):d=this.options.parseMissingKeyHandler(d))}return s?(p.res=d,p.usedParams=this.getUsedParamsDetails(r),p):d}extendTranslation(t,r,n,s,a){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const f=It(t)&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let u;if(f){const d=t.match(this.interpolator.nestingRegexp);u=d&&d.length}let p=n.replace&&!It(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(p={...this.options.interpolation.defaultVariables,...p}),t=this.interpolator.interpolate(t,p,n.lng||this.language||s.usedLng,n),f){const d=t.match(this.interpolator.nestingRegexp),h=d&&d.length;u<h&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&s&&s.res&&(n.lng=this.language||s.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var d=arguments.length,h=new Array(d),m=0;m<d;m++)h[m]=arguments[m];return a&&a[0]===h[0]&&!n.context?(i.logger.warn(`It seems you are nesting recursively key: ${h[0]} in key: ${r[0]}`),null):i.translate(...h,r)},n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,c=It(o)?[o]:o;return t!=null&&c&&c.length&&n.applyPostProcessor!==!1&&(t=xP.handle(c,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,s,a,i,o;return It(t)&&(t=[t]),t.forEach(c=>{if(this.isValidLookup(n))return;const f=this.extractFromKey(c,r),u=f.key;s=u;let p=f.namespaces;this.options.fallbackNS&&(p=p.concat(this.options.fallbackNS));const d=r.count!==void 0&&!It(r.count),h=d&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),m=r.context!==void 0&&(It(r.context)||typeof r.context=="number")&&r.context!=="",g=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);p.forEach(y=>{this.isValidLookup(n)||(o=y,!Wk[`${g[0]}-${y}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(Wk[`${g[0]}-${y}`]=!0,this.logger.warn(`key "${s}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(v=>{if(this.isValidLookup(n))return;i=v;const b=[u];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(b,u,v,y,r);else{let S;d&&(S=this.pluralResolver.getSuffix(v,r.count,r));const A=`${this.options.pluralSeparator}zero`,F=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(d&&(b.push(u+S),r.ordinal&&S.indexOf(F)===0&&b.push(u+S.replace(F,this.options.pluralSeparator)),h&&b.push(u+A)),m){const T=`${u}${this.options.contextSeparator}${r.context}`;b.push(T),d&&(b.push(T+S),r.ordinal&&S.indexOf(F)===0&&b.push(T+S.replace(F,this.options.pluralSeparator)),h&&b.push(T+A))}}let w;for(;w=b.pop();)this.isValidLookup(n)||(a=w,n=this.getResource(v,y,w,r))}))})}),{res:n,usedKey:s,exactUsedKey:a,usedLng:i,usedNS:o}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,n,s):this.resourceStore.getResource(t,r,n,s)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!It(t.replace);let s=n?t.replace:t;if(n&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!n){s={...s};for(const a of r)delete s[a]}return s}static hasDefaultValue(t){const r="defaultValue";for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r===n.substring(0,r.length)&&t[n]!==void 0)return!0;return!1}}const Rv=e=>e.charAt(0).toUpperCase()+e.slice(1);class Vk{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=fo.create("languageUtils")}getScriptPartFromCode(t){if(t=Hg(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Hg(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(It(t)&&t.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let s=Intl.getCanonicalLocales(t)[0];if(s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s)return s}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let n=t.split("-");return this.options.lowerCaseLng?n=n.map(s=>s.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Rv(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Rv(n[1].toLowerCase())),r.indexOf(n[2].toLowerCase())>-1&&(n[2]=Rv(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(n=>{if(r)return;const s=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(n=>{if(r)return;const s=this.getLanguagePartFromCode(n);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(a=>{if(a===s)return a;if(!(a.indexOf("-")<0&&s.indexOf("-")<0)&&(a.indexOf("-")>0&&s.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===s||a.indexOf(s)===0&&s.length>1))return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),It(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let n=t[r];return n||(n=t[this.getScriptPartFromCode(r)]),n||(n=t[this.formatLanguageCode(r)]),n||(n=t[this.getLanguagePartFromCode(r)]),n||(n=t.default),n||[]}toResolveHierarchy(t,r){const n=this.getFallbackCodes(r||this.options.fallbackLng||[],t),s=[],a=i=>{i&&(this.isSupportedCode(i)?s.push(i):this.logger.warn(`rejecting language code not found in supportedLngs: ${i}`))};return It(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):It(t)&&a(this.formatLanguageCode(t)),n.forEach(i=>{s.indexOf(i)<0&&a(this.formatLanguageCode(i))}),s}}let Dee=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Oee={1:e=>+(e>1),2:e=>+(e!=1),3:e=>0,4:e=>e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,5:e=>e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5,6:e=>e==1?0:e>=2&&e<=4?1:2,7:e=>e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,8:e=>e==1?0:e==2?1:e!=8&&e!=11?2:3,9:e=>+(e>=2),10:e=>e==1?0:e==2?1:e<7?2:e<11?3:4,11:e=>e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3,12:e=>+(e%10!=1||e%100==11),13:e=>+(e!==0),14:e=>e==1?0:e==2?1:e==3?2:3,15:e=>e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2,16:e=>e%10==1&&e%100!=11?0:e!==0?1:2,17:e=>e==1||e%10==1&&e%100!=11?0:1,18:e=>e==0?0:e==1?1:2,19:e=>e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3,20:e=>e==1?0:e==0||e%100>0&&e%100<20?1:2,21:e=>e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0,22:e=>e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3};const Ree=["v1","v2","v3"],Iee=["v4"],Kk={zero:0,one:1,two:2,few:3,many:4,other:5},Mee=()=>{const e={};return Dee.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:Oee[t.fc]}})}),e};class Bee{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=fo.create("pluralResolver"),(!this.options.compatibilityJSON||Iee.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Mee(),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const n=Hg(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:s});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let i;try{i=new Intl.PluralRules(n,{type:s})}catch{if(!t.match(/-|_/))return;const c=this.languageUtils.getLanguagePartFromCode(t);i=this.getRule(c,r)}return this.pluralRulesCache[a]=i,i}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(s=>`${r}${s}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((s,a)=>Kk[s]-Kk[a]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):n.numbers.map(s=>this.getSuffix(t,s,r)):[]}getSuffix(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(t,n);return s?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:this.getSuffixRetroCompatible(s,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){const n=t.noAbs?t.plurals(r):t.plurals(Math.abs(r));let s=t.numbers[n];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(s===2?s="plural":s===1&&(s=""));const a=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return this.options.compatibilityJSON==="v1"?s===1?"":typeof s=="number"?`_plural_${s.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!Ree.includes(this.options.compatibilityJSON)}}const Gk=function(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=Eee(e,t,r);return!a&&s&&It(r)&&(a=Qw(e,r,n),a===void 0&&(a=Qw(t,r,n))),a},Iv=e=>e.replace(/\$/g,"$$$$");class Uee{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=fo.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:s,prefix:a,prefixEscaped:i,suffix:o,suffixEscaped:c,formatSeparator:f,unescapeSuffix:u,unescapePrefix:p,nestingPrefix:d,nestingPrefixEscaped:h,nestingSuffix:m,nestingSuffixEscaped:g,nestingOptionsSeparator:y,maxReplaces:v,alwaysFormat:b}=t.interpolation;this.escape=r!==void 0?r:Aee,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=a?yf(a):i||"{{",this.suffix=o?yf(o):c||"}}",this.formatSeparator=f||",",this.unescapePrefix=u?"":p||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=d?yf(d):h||yf("$t("),this.nestingSuffix=m?yf(m):g||yf(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=v||1e3,this.alwaysFormat=b!==void 0?b:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,n)=>r&&r.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,n,s){let a,i,o;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},f=h=>{if(h.indexOf(this.formatSeparator)<0){const v=Gk(r,c,h,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(v,void 0,n,{...s,...r,interpolationkey:h}):v}const m=h.split(this.formatSeparator),g=m.shift().trim(),y=m.join(this.formatSeparator).trim();return this.format(Gk(r,c,g,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...s,...r,interpolationkey:g})};this.resetRegExp();const u=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,p=s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:h=>Iv(h)},{regex:this.regexp,safeValue:h=>this.escapeValue?Iv(this.escape(h)):Iv(h)}].forEach(h=>{for(o=0;a=h.regex.exec(t);){const m=a[1].trim();if(i=f(m),i===void 0)if(typeof u=="function"){const y=u(t,a,s);i=It(y)?y:""}else if(s&&Object.prototype.hasOwnProperty.call(s,m))i="";else if(p){i=a[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${t}`),i="";else!It(i)&&!this.useRawValueToEscape&&(i=Uk(i));const g=h.safeValue(i);if(t=t.replace(a[0],g),p?(h.regex.lastIndex+=i.length,h.regex.lastIndex-=a[0].length):h.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),t}nest(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,a,i;const o=(c,f)=>{const u=this.nestingOptionsSeparator;if(c.indexOf(u)<0)return c;const p=c.split(new RegExp(`${u}[ ]*{`));let d=`{${p[1]}`;c=p[0],d=this.interpolate(d,i);const h=d.match(/'/g),m=d.match(/"/g);(h&&h.length%2===0&&!m||m.length%2!==0)&&(d=d.replace(/'/g,'"'));try{i=JSON.parse(d),f&&(i={...f,...i})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${c}`,g),`${c}${u}${d}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,c};for(;s=this.nestingRegexp.exec(t);){let c=[];i={...n},i=i.replace&&!It(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;let f=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const u=s[1].split(this.formatSeparator).map(p=>p.trim());s[1]=u.shift(),c=u,f=!0}if(a=r(o.call(this,s[1].trim(),i),i),a&&s[0]===t&&!It(a))return a;It(a)||(a=Uk(a)),a||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),a=""),f&&(a=c.reduce((u,p)=>this.format(u,p,n.lng,{...n,interpolationkey:s[1].trim()}),a.trim())),t=t.replace(s[0],a),this.regexp.lastIndex=0}return t}}const $ee=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const s=n[1].substring(0,n[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(i=>{if(i){const[o,...c]=i.split(":"),f=c.join(":").trim().replace(/^'+|'+$/g,""),u=o.trim();r[u]||(r[u]=f),f==="false"&&(r[u]=!1),f==="true"&&(r[u]=!0),isNaN(f)||(r[u]=parseInt(f,10))}})}return{formatName:t,formatOptions:r}},wf=e=>{const t={};return(r,n,s)=>{let a=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(a={...a,[s.interpolationkey]:void 0});const i=n+JSON.stringify(a);let o=t[i];return o||(o=e(Hg(n),s),t[i]=o),o(r)}};class zee{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=fo.create("formatter"),this.options=t,this.formats={number:wf((r,n)=>{const s=new Intl.NumberFormat(r,{...n});return a=>s.format(a)}),currency:wf((r,n)=>{const s=new Intl.NumberFormat(r,{...n,style:"currency"});return a=>s.format(a)}),datetime:wf((r,n)=>{const s=new Intl.DateTimeFormat(r,{...n});return a=>s.format(a)}),relativetime:wf((r,n)=>{const s=new Intl.RelativeTimeFormat(r,{...n});return a=>s.format(a,n.range||"day")}),list:wf((r,n)=>{const s=new Intl.ListFormat(r,{...n});return a=>s.format(a)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=wf(r)}format(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(o=>o.indexOf(")")>-1)){const o=a.findIndex(c=>c.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,o)].join(this.formatSeparator)}return a.reduce((o,c)=>{const{formatName:f,formatOptions:u}=$ee(c);if(this.formats[f]){let p=o;try{const d=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},h=d.locale||d.lng||s.locale||s.lng||n;p=this.formats[f](o,h,{...u,...s,...d})}catch(d){this.logger.warn(d)}return p}else this.logger.warn(`there was no format function for ${f}`);return o},t)}}const qee=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Hee extends Px{constructor(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=s,this.logger=fo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,s.backend,s)}queueLoad(t,r,n,s){const a={},i={},o={},c={};return t.forEach(f=>{let u=!0;r.forEach(p=>{const d=`${f}|${p}`;!n.reload&&this.store.hasResourceBundle(f,p)?this.state[d]=2:this.state[d]<0||(this.state[d]===1?i[d]===void 0&&(i[d]=!0):(this.state[d]=1,u=!1,i[d]===void 0&&(i[d]=!0),a[d]===void 0&&(a[d]=!0),c[p]===void 0&&(c[p]=!0)))}),u||(o[f]=!0)}),(Object.keys(a).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(a),pending:Object.keys(i),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(c)}}loaded(t,r,n){const s=t.split("|"),a=s[0],i=s[1];r&&this.emit("failedLoading",a,i,r),!r&&n&&this.store.addResourceBundle(a,i,n,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&n&&(this.state[t]=0);const o={};this.queue.forEach(c=>{kee(c.loaded,[a],i),qee(c,t),r&&c.errors.push(r),c.pendingCount===0&&!c.done&&(Object.keys(c.loaded).forEach(f=>{o[f]||(o[f]={});const u=c.loaded[f];u.length&&u.forEach(p=>{o[f][p]===void 0&&(o[f][p]=!0)})}),c.done=!0,c.errors.length?c.callback(c.errors):c.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(c=>!c.done)}read(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!t.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:n,tried:s,wait:a,callback:i});return}this.readingCalls++;const o=(f,u)=>{if(this.readingCalls--,this.waitingReads.length>0){const p=this.waitingReads.shift();this.read(p.lng,p.ns,p.fcName,p.tried,p.wait,p.callback)}if(f&&u&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,n,s+1,a*2,i)},a);return}i(f,u)},c=this.backend[n].bind(this.backend);if(c.length===2){try{const f=c(t,r);f&&typeof f.then=="function"?f.then(u=>o(null,u)).catch(o):o(null,f)}catch(f){o(f)}return}return c(t,r,o)}prepareLoading(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();It(t)&&(t=this.languageUtils.toResolveHierarchy(t)),It(r)&&(r=[r]);const a=this.queueLoad(t,r,n,s);if(!a.toLoad.length)return a.pending.length||s(),null;a.toLoad.forEach(i=>{this.loadOne(i)})}load(t,r,n){this.prepareLoading(t,r,{},n)}reload(t,r,n){this.prepareLoading(t,r,{reload:!0},n)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=t.split("|"),s=n[0],a=n[1];this.read(s,a,"read",void 0,void 0,(i,o)=>{i&&this.logger.warn(`${r}loading namespace ${a} for language ${s} failed`,i),!i&&o&&this.logger.log(`${r}loaded namespace ${a} for language ${s}`,o),this.loaded(t,i,o)})}saveMissing(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){const c={...i,isUpdate:a},f=this.backend.create.bind(this.backend);if(f.length<6)try{let u;f.length===5?u=f(t,r,n,s,c):u=f(t,r,n,s),u&&typeof u.then=="function"?u.then(p=>o(null,p)).catch(o):o(null,u)}catch(u){o(u)}else f(t,r,n,s,o,c)}!t||!t[0]||this.store.addResource(t[0],r,n,s)}}}const Yk=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),It(e[1])&&(t.defaultValue=e[1]),It(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(n=>{t[n]=r[n]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),Xk=e=>(It(e.ns)&&(e.ns=[e.ns]),It(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),It(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),r1=()=>{},Wee=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class np extends Px{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=Xk(t),this.services={},this.logger=fo,this.modules={external:[]},Wee(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(n=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(It(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const s=Yk();this.options={...s,...this.options,...Xk(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const a=u=>u?typeof u=="function"?new u:u:null;if(!this.options.isClone){this.modules.logger?fo.init(a(this.modules.logger),this.options):fo.init(null,this.options);let u;this.modules.formatter?u=this.modules.formatter:typeof Intl<"u"&&(u=zee);const p=new Vk(this.options);this.store=new Hk(this.options.resources,this.options);const d=this.services;d.logger=fo,d.resourceStore=this.store,d.languageUtils=p,d.pluralResolver=new Bee(p,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),u&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(d.formatter=a(u),d.formatter.init(d,this.options),this.options.interpolation.format=d.formatter.format.bind(d.formatter)),d.interpolator=new Uee(this.options),d.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},d.backendConnector=new Hee(a(this.modules.backend),d.resourceStore,d,this.options),d.backendConnector.on("*",function(h){for(var m=arguments.length,g=new Array(m>1?m-1:0),y=1;y<m;y++)g[y-1]=arguments[y];t.emit(h,...g)}),this.modules.languageDetector&&(d.languageDetector=a(this.modules.languageDetector),d.languageDetector.init&&d.languageDetector.init(d,this.options.detection,this.options)),this.modules.i18nFormat&&(d.i18nFormat=a(this.modules.i18nFormat),d.i18nFormat.init&&d.i18nFormat.init(this)),this.translator=new Vg(this.services,this.options),this.translator.on("*",function(h){for(var m=arguments.length,g=new Array(m>1?m-1:0),y=1;y<m;y++)g[y-1]=arguments[y];t.emit(h,...g)}),this.modules.external.forEach(h=>{h.init&&h.init(this)})}if(this.format=this.options.interpolation.format,n||(n=r1),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const u=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);u.length>0&&u[0]!=="dev"&&(this.options.lng=u[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(u=>{this[u]=function(){return t.store[u](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(u=>{this[u]=function(){return t.store[u](...arguments),t}});const c=k0(),f=()=>{const u=(p,d)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),c.resolve(d),n(p,d)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return u(null,this.t.bind(this));this.changeLanguage(this.options.lng,u)};return this.options.resources||!this.options.initImmediate?f():setTimeout(f,0),c}loadResources(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r1;const s=It(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(s&&s.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],i=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(f=>{f!=="cimode"&&a.indexOf(f)<0&&a.push(f)})};s?i(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(c=>i(c)),this.options.preload&&this.options.preload.forEach(o=>i(o)),this.services.backendConnector.load(a,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(o)})}else n(null)}reloadResources(t,r,n){const s=k0();return typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),n||(n=r1),this.services.backendConnector.reload(t,r,a=>{s.resolve(),n(a)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&xP.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,r){var n=this;this.isLanguageChangingTo=t;const s=k0();this.emit("languageChanging",t);const a=c=>{this.language=c,this.languages=this.services.languageUtils.toResolveHierarchy(c),this.resolvedLanguage=void 0,this.setResolvedLanguage(c)},i=(c,f)=>{f?(a(f),this.translator.changeLanguage(f),this.isLanguageChangingTo=void 0,this.emit("languageChanged",f),this.logger.log("languageChanged",f)):this.isLanguageChangingTo=void 0,s.resolve(function(){return n.t(...arguments)}),r&&r(c,function(){return n.t(...arguments)})},o=c=>{!t&&!c&&this.services.languageDetector&&(c=[]);const f=It(c)?c:this.services.languageUtils.getBestMatchFromCodes(c);f&&(this.language||a(f),this.translator.language||this.translator.changeLanguage(f),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(f)),this.loadResources(f,u=>{i(u,f)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),s}getFixedT(t,r,n){var s=this;const a=function(i,o){let c;if(typeof o!="object"){for(var f=arguments.length,u=new Array(f>2?f-2:0),p=2;p<f;p++)u[p-2]=arguments[p];c=s.options.overloadTranslationOptionHandler([i,o].concat(u))}else c={...o};c.lng=c.lng||a.lng,c.lngs=c.lngs||a.lngs,c.ns=c.ns||a.ns,c.keyPrefix!==""&&(c.keyPrefix=c.keyPrefix||n||a.keyPrefix);const d=s.options.keySeparator||".";let h;return c.keyPrefix&&Array.isArray(i)?h=i.map(m=>`${c.keyPrefix}${d}${m}`):h=c.keyPrefix?`${c.keyPrefix}${d}${i}`:i,s.t(h,c)};return It(t)?a.lng=t:a.lngs=t,a.ns=r,a.keyPrefix=n,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,c)=>{const f=this.services.backendConnector.state[`${o}|${c}`];return f===-1||f===0||f===2};if(r.precheck){const o=r.precheck(this,i);if(o!==void 0)return o}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||i(n,t)&&(!s||i(a,t)))}loadNamespaces(t,r){const n=k0();return this.options.ns?(It(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{n.resolve(),r&&r(s)}),n):(r&&r(),Promise.resolve())}loadLanguages(t,r){const n=k0();It(t)&&(t=[t]);const s=this.options.preload||[],a=t.filter(i=>s.indexOf(i)<0&&this.services.languageUtils.isSupportedCode(i));return a.length?(this.options.preload=s.concat(a),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new Vk(Yk());return r.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new np(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:r1;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},a=new np(s);return(t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(o=>{a[o]=this[o]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new Hk(this.store.data,s),a.services.resourceStore=a.store),a.translator=new Vg(a.services,s),a.translator.on("*",function(o){for(var c=arguments.length,f=new Array(c>1?c-1:0),u=1;u<c;u++)f[u-1]=arguments[u];a.emit(o,...f)}),a.init(s,r),a.translator.options=s,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const cs=np.createInstance();cs.createInstance=np.createInstance;cs.createInstance;cs.dir;cs.init;cs.loadResources;cs.reloadResources;cs.use;cs.changeLanguage;cs.getFixedT;cs.t;cs.exists;cs.setDefaultNamespace;cs.hasLoadedNamespace;cs.loadNamespaces;cs.loadLanguages;const Vee={title:"Gestion de Projets",subtitle:"Application de gestion de projets offline-first"},Kee={save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",edit:"Modifier",create:"Crer",search:"Rechercher",filter:"Filtrer",export:"Exporter",import:"Importer",back:"Retour",next:"Suivant",previous:"Prcdent",loading:"Chargement...",error:"Erreur",success:"Succs",warning:"Avertissement",info:"Information",confirm:"Confirmer",close:"Fermer",viewAll:"Voir tout"},Gee={login:"Connexion",register:"Inscription",logout:"Dconnexion",email:"Email",password:"Mot de passe",firstName:"Prnom",lastName:"Nom",forgotPassword:"Mot de passe oubli?",loginSuccess:"Connexion russie",loginError:"Erreur de connexion",registerSuccess:"Inscription russie",registerError:"Erreur lors de l'inscription"},Yee={status:{offline:"Hors ligne",syncing:"Synchronisation...",synced:" jour",error:"Erreur de synchronisation",idle:"En attente"},lastSync:"Dernire sync: {{time}}",pendingOperations:"{{count}} oprations en attente",syncNow:"Synchroniser maintenant",autoSync:"Synchronisation automatique",conflicts:"Conflits dtects",resolveConflict:"Rsoudre le conflit"},Xee={title:"Tableau de bord",totalProjects:"Projets totaux",activeProjects:"Projets actifs",completedProjects:"Projets termins",totalBudget:"Budget total",recentProjects:"Projets rcents",recentActivities:"Activits rcentes",upcomingDeadlines:"chances  venir",statistics:"Statistiques"},Jee={title:"Projet",projects:"Projets",new:"Nouveau projet",newProject:"Nouveau projet",createDescription:"Crez un nouveau projet en remplissant les informations ci-dessous",editProject:"Modifier le projet",deleteProject:"Supprimer le projet",projectDetails:"Dtails du projet",noProjects:"Aucun projet pour le moment",objet:"Objet",marcheNo:"March N",annee:"Anne",dateOuverture:"Date d'ouverture",montant:"Montant (MAD)",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"Socit",patente:"Patente",delaisEntreeService:"Dlais d'entre en service",osc:"OSC",status:{draft:"Brouillon",active:"Actif",completed:"Termin",archived:"Archiv"},progress:"Avancement",folderPath:"Chemin du dossier"},Qee={title:"Bordereau",bordereaux:"Bordereaux",newBordereau:"Nouveau bordereau",reference:"Rfrence",designation:"Dsignation",unite:"Unit",quantite:"Quantit",prixUnitaire:"Prix unitaire",montantTotal:"Montant total"},Zee={title:"Mtr",metres:"Mtrs",newMetre:"Nouveau mtr",reference:"Rfrence",designation:"Dsignation",mesures:"Mesures",longueur:"Longueur",largeur:"Largeur",hauteur:"Hauteur",quantite:"Quantit",totalQuantite:"Quantit totale"},ete={title:"Dcompte",decompts:"Dcomptes",newDecompt:"Nouveau dcompte",periode:"Priode",numero:"Numro",lignes:"Lignes",montantTotal:"Montant total",statut:{draft:"Brouillon",submitted:"Soumis",validated:"Valid",paid:"Pay"},generatePDF:"Gnrer PDF"},tte={title:"Photo",photos:"Photos",uploadPhoto:"Tlcharger une photo",description:"Description",tags:"tiquettes",location:"Localisation"},rte={title:"Procs-Verbal",pvs:"Procs-Verbaux",newPV:"Nouveau PV",type:{installation:"Installation",reception:"Rception",constat:"Constat",other:"Autre"},numero:"Numro",date:"Date",objet:"Objet",contenu:"Contenu",participants:"Participants",attachments:"Pices jointes"},nte={title:"Pice jointe",attachments:"Pices jointes",uploadFile:"Tlcharger un fichier",category:{facture:"Facture",bp:"Bon de paiement",plan:"Plan",autre:"Autre"}},ste={title:"Paramtres",language:"Langue",theme:"Thme",notifications:"Notifications",account:"Compte",sync:"Synchronisation"},ate={app:Vee,common:Kee,auth:Gee,sync:Yee,dashboard:Xee,project:Jee,bordereau:Qee,metre:Zee,decompt:ete,photo:tte,pv:rte,attachment:nte,settings:ste},ite={title:" ",subtitle:"     "},ote={save:"",cancel:"",delete:"",edit:"",create:"",search:"",filter:"",export:"",import:"",back:"",next:"",previous:"",loading:" ...",error:"",success:"",warning:"",info:"",confirm:"",close:""},lte={login:" ",register:"",logout:" ",email:" ",password:" ",firstName:" ",lastName:" ",forgotPassword:"   ",loginSuccess:"   ",loginError:"   ",registerSuccess:"  ",registerError:"  "},cte={status:{offline:" ",syncing:" ...",synced:"",error:"  ",idle:" "},lastSync:" : {{time}}",pendingOperations:"{{count}}  ",syncNow:" ",autoSync:" ",conflicts:" ",resolveConflict:" "},ute={title:" ",totalProjects:" ",activeProjects:" ",completedProjects:" ",totalBudget:" ",recentProjects:" ",recentActivities:" ",upcomingDeadlines:"  ",statistics:""},fte={title:"",projects:"",newProject:" ",editProject:" ",deleteProject:" ",projectDetails:" ",objet:"",marcheNo:" ",annee:"",dateOuverture:" ",montant:" ()",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"",patente:"",delaisEntreeService:"   ",osc:"OSC",status:{draft:"",active:"",completed:"",archived:""},progress:"",folderPath:" "},dte={title:" ",bordereaux:" ",newBordereau:"  ",reference:"",designation:"",unite:"",quantite:"",prixUnitaire:" ",montantTotal:" "},hte={title:"",metres:"",newMetre:" ",reference:"",designation:"",mesures:"",longueur:"",largeur:"",hauteur:"",quantite:"",totalQuantite:" "},pte={title:"",decompts:"",newDecompt:" ",periode:"",numero:"",lignes:"",montantTotal:" ",statut:{draft:"",submitted:"",validated:" ",paid:""},generatePDF:" PDF"},mte={title:"",photos:"",uploadPhoto:" ",description:"",tags:"",location:""},gte={title:"",pvs:"",newPV:" ",type:{installation:"",reception:"",constat:"",other:""},numero:"",date:"",objet:"",contenu:"",participants:"",attachments:""},xte={title:"",attachments:"",uploadFile:" ",category:{facture:"",bp:" ",plan:"",autre:""}},vte={title:"",language:"",theme:"",notifications:"",account:"",sync:""},yte={app:ite,common:ote,auth:lte,sync:cte,dashboard:ute,project:fte,bordereau:dte,metre:hte,decompt:pte,photo:mte,pv:gte,attachment:xte,settings:vte},wte={title:"Project Management",subtitle:"Offline-first project management application"},bte={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",create:"Create",search:"Search",filter:"Filter",export:"Export",import:"Import",back:"Back",next:"Next",previous:"Previous",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",close:"Close"},Nte={login:"Login",register:"Register",logout:"Logout",email:"Email",password:"Password",firstName:"First Name",lastName:"Last Name",forgotPassword:"Forgot password?",loginSuccess:"Login successful",loginError:"Login error",registerSuccess:"Registration successful",registerError:"Registration error"},Ste={status:{offline:"Offline",syncing:"Syncing...",synced:"Up to date",error:"Sync error",idle:"Idle"},lastSync:"Last sync: {{time}}",pendingOperations:"{{count}} pending operations",syncNow:"Sync now",autoSync:"Auto sync",conflicts:"Conflicts detected",resolveConflict:"Resolve conflict"},_te={title:"Dashboard",totalProjects:"Total Projects",activeProjects:"Active Projects",completedProjects:"Completed Projects",totalBudget:"Total Budget",recentProjects:"Recent Projects",recentActivities:"Recent Activities",upcomingDeadlines:"Upcoming Deadlines",statistics:"Statistics"},kte={title:"Project",projects:"Projects",newProject:"New Project",editProject:"Edit Project",deleteProject:"Delete Project",projectDetails:"Project Details",objet:"Object",marcheNo:"Contract No.",annee:"Year",dateOuverture:"Opening Date",montant:"Amount (MAD)",snss:"SNSS",cbn:"C.B.No.",rcn:"R.C.No.",societe:"Company",patente:"License",delaisEntreeService:"Service Entry Deadline",osc:"OSC",status:{draft:"Draft",active:"Active",completed:"Completed",archived:"Archived"},progress:"Progress",folderPath:"Folder Path"},Ete={title:"Price Schedule",bordereaux:"Price Schedules",newBordereau:"New Price Schedule",reference:"Reference",designation:"Designation",unite:"Unit",quantite:"Quantity",prixUnitaire:"Unit Price",montantTotal:"Total Amount"},jte={title:"Measurement",metres:"Measurements",newMetre:"New Measurement",reference:"Reference",designation:"Designation",mesures:"Measurements",longueur:"Length",largeur:"Width",hauteur:"Height",quantite:"Quantity",totalQuantite:"Total Quantity"},Ate={title:"Payment Statement",decompts:"Payment Statements",newDecompt:"New Payment Statement",periode:"Period",numero:"Number",lignes:"Lines",montantTotal:"Total Amount",statut:{draft:"Draft",submitted:"Submitted",validated:"Validated",paid:"Paid"},generatePDF:"Generate PDF"},Tte={title:"Photo",photos:"Photos",uploadPhoto:"Upload Photo",description:"Description",tags:"Tags",location:"Location"},Cte={title:"Report",pvs:"Reports",newPV:"New Report",type:{installation:"Installation",reception:"Reception",constat:"Finding",other:"Other"},numero:"Number",date:"Date",objet:"Subject",contenu:"Content",participants:"Participants",attachments:"Attachments"},Pte={title:"Attachment",attachments:"Attachments",uploadFile:"Upload File",category:{facture:"Invoice",bp:"Payment Slip",plan:"Plan",autre:"Other"}},Fte={title:"Settings",language:"Language",theme:"Theme",notifications:"Notifications",account:"Account",sync:"Synchronization"},Lte={app:wte,common:bte,auth:Nte,sync:Ste,dashboard:_te,project:kte,bordereau:Ete,metre:jte,decompt:Ate,photo:Tte,pv:Cte,attachment:Pte,settings:Fte},Dte={fr:{translation:ate},ar:{translation:yte},en:{translation:Lte}},Ote=localStorage.getItem("language")||"fr";cs.use(yO).init({resources:Dte,lng:Ote,fallbackLng:"fr",interpolation:{escapeValue:!1}});cs.on("languageChanged",e=>{document.documentElement.setAttribute("dir",e==="ar"?"rtl":"ltr"),document.documentElement.setAttribute("lang",e),localStorage.setItem("language",e)});const Rte=new sO({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1,staleTime:5*60*1e3}}});Mv.createRoot(document.getElementById("root")).render(l.jsx(Wl.StrictMode,{children:l.jsx(iO,{client:Rte,children:l.jsx(TD,{children:l.jsx(Nee,{})})})}));export{xr as _,Mte as c,i6 as g};
