var bL=Object.defineProperty;var J4=e=>{throw TypeError(e)};var NL=(e,t,r)=>t in e?bL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Pt=(e,t,r)=>NL(e,typeof t!="symbol"?t+"":t,r),x2=(e,t,r)=>t.has(e)||J4("Cannot "+r);var Be=(e,t,r)=>(x2(e,t,"read from private field"),r?r.call(e):t.get(e)),lr=(e,t,r)=>t.has(e)?J4("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),Vt=(e,t,r,n)=>(x2(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),vs=(e,t,r)=>(x2(e,t,"access private method"),r);var fm=(e,t,r,n)=>({set _(s){Vt(e,t,s,r)},get _(){return Be(e,t,n)}});function SL(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Sre=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var EE={exports:{}},ex={},AE={exports:{}},sr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hp=Symbol.for("react.element"),kL=Symbol.for("react.portal"),_L=Symbol.for("react.fragment"),EL=Symbol.for("react.strict_mode"),AL=Symbol.for("react.profiler"),jL=Symbol.for("react.provider"),TL=Symbol.for("react.context"),CL=Symbol.for("react.forward_ref"),PL=Symbol.for("react.suspense"),LL=Symbol.for("react.memo"),FL=Symbol.for("react.lazy"),Q4=Symbol.iterator;function DL(e){return e===null||typeof e!="object"?null:(e=Q4&&e[Q4]||e["@@iterator"],typeof e=="function"?e:null)}var jE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},TE=Object.assign,CE={};function Ed(e,t,r){this.props=e,this.context=t,this.refs=CE,this.updater=r||jE}Ed.prototype.isReactComponent={};Ed.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ed.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function PE(){}PE.prototype=Ed.prototype;function o5(e,t,r){this.props=e,this.context=t,this.refs=CE,this.updater=r||jE}var l5=o5.prototype=new PE;l5.constructor=o5;TE(l5,Ed.prototype);l5.isPureReactComponent=!0;var Z4=Array.isArray,LE=Object.prototype.hasOwnProperty,c5={current:null},FE={key:!0,ref:!0,__self:!0,__source:!0};function DE(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)LE.call(t,n)&&!FE.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:hp,type:e,key:a,ref:i,props:s,_owner:c5.current}}function RL(e,t){return{$$typeof:hp,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function u5(e){return typeof e=="object"&&e!==null&&e.$$typeof===hp}function OL(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var e3=/\/+/g;function v2(e,t){return typeof e=="object"&&e!==null&&e.key!=null?OL(""+e.key):t.toString(36)}function u1(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case hp:case kL:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+v2(i,0):n,Z4(s)?(r="",e!=null&&(r=e.replace(e3,"$&/")+"/"),u1(s,t,r,"",function(u){return u})):s!=null&&(u5(s)&&(s=RL(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(e3,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",Z4(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+v2(a,o);i+=u1(a,t,r,l,s)}else if(l=DL(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+v2(a,o++),i+=u1(a,t,r,l,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function dm(e,t,r){if(e==null)return e;var n=[],s=0;return u1(e,n,"","",function(a){return t.call(r,a,s++)}),n}function IL(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ra={current:null},f1={transition:null},ML={ReactCurrentDispatcher:ra,ReactCurrentBatchConfig:f1,ReactCurrentOwner:c5};function RE(){throw Error("act(...) is not supported in production builds of React.")}sr.Children={map:dm,forEach:function(e,t,r){dm(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return dm(e,function(){t++}),t},toArray:function(e){return dm(e,function(t){return t})||[]},only:function(e){if(!u5(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};sr.Component=Ed;sr.Fragment=_L;sr.Profiler=AL;sr.PureComponent=o5;sr.StrictMode=EL;sr.Suspense=PL;sr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ML;sr.act=RE;sr.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=TE({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=c5.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)LE.call(t,l)&&!FE.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:hp,type:e.type,key:s,ref:a,props:n,_owner:i}};sr.createContext=function(e){return e={$$typeof:TL,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:jL,_context:e},e.Consumer=e};sr.createElement=DE;sr.createFactory=function(e){var t=DE.bind(null,e);return t.type=e,t};sr.createRef=function(){return{current:null}};sr.forwardRef=function(e){return{$$typeof:CL,render:e}};sr.isValidElement=u5;sr.lazy=function(e){return{$$typeof:FL,_payload:{_status:-1,_result:e},_init:IL}};sr.memo=function(e,t){return{$$typeof:LL,type:e,compare:t===void 0?null:t}};sr.startTransition=function(e){var t=f1.transition;f1.transition={};try{e()}finally{f1.transition=t}};sr.unstable_act=RE;sr.useCallback=function(e,t){return ra.current.useCallback(e,t)};sr.useContext=function(e){return ra.current.useContext(e)};sr.useDebugValue=function(){};sr.useDeferredValue=function(e){return ra.current.useDeferredValue(e)};sr.useEffect=function(e,t){return ra.current.useEffect(e,t)};sr.useId=function(){return ra.current.useId()};sr.useImperativeHandle=function(e,t,r){return ra.current.useImperativeHandle(e,t,r)};sr.useInsertionEffect=function(e,t){return ra.current.useInsertionEffect(e,t)};sr.useLayoutEffect=function(e,t){return ra.current.useLayoutEffect(e,t)};sr.useMemo=function(e,t){return ra.current.useMemo(e,t)};sr.useReducer=function(e,t,r){return ra.current.useReducer(e,t,r)};sr.useRef=function(e){return ra.current.useRef(e)};sr.useState=function(e){return ra.current.useState(e)};sr.useSyncExternalStore=function(e,t,r){return ra.current.useSyncExternalStore(e,t,r)};sr.useTransition=function(){return ra.current.useTransition()};sr.version="18.3.1";AE.exports=sr;var ee=AE.exports;const Vl=_E(ee),BL=SL({__proto__:null,default:Vl},[ee]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var UL=ee,$L=Symbol.for("react.element"),zL=Symbol.for("react.fragment"),HL=Object.prototype.hasOwnProperty,qL=UL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WL={key:!0,ref:!0,__self:!0,__source:!0};function OE(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)HL.call(t,n)&&!WL.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:$L,type:e,key:a,ref:i,props:s,_owner:qL.current}}ex.Fragment=zL;ex.jsx=OE;ex.jsxs=OE;EE.exports=ex;var c=EE.exports,Kv={},IE={exports:{}},Oa={},ME={exports:{}},BE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(re,G){var ge=re.length;re.push(G);e:for(;0<ge;){var ve=ge-1>>>1,_=re[ve];if(0<s(_,G))re[ve]=G,re[ge]=_,ge=ve;else break e}}function r(re){return re.length===0?null:re[0]}function n(re){if(re.length===0)return null;var G=re[0],ge=re.pop();if(ge!==G){re[0]=ge;e:for(var ve=0,_=re.length,R=_>>>1;ve<R;){var I=2*(ve+1)-1,B=re[I],W=I+1,se=re[W];if(0>s(B,ge))W<_&&0>s(se,B)?(re[ve]=se,re[W]=ge,ve=W):(re[ve]=B,re[I]=ge,ve=I);else if(W<_&&0>s(se,ge))re[ve]=se,re[W]=ge,ve=W;else break e}}return G}function s(re,G){var ge=re.sortIndex-G.sortIndex;return ge!==0?ge:re.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],u=[],f=1,h=null,p=3,d=!1,m=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(re){for(var G=r(u);G!==null;){if(G.callback===null)n(u);else if(G.startTime<=re)n(u),G.sortIndex=G.expirationTime,t(l,G);else break;G=r(u)}}function S(re){if(g=!1,b(re),!m)if(r(l)!==null)m=!0,fe(T);else{var G=r(u);G!==null&&me(S,G.startTime-re)}}function T(re,G){m=!1,g&&(g=!1,x(D),D=-1),d=!0;var ge=p;try{for(b(G),h=r(l);h!==null&&(!(h.expirationTime>G)||re&&!E());){var ve=h.callback;if(typeof ve=="function"){h.callback=null,p=h.priorityLevel;var _=ve(h.expirationTime<=G);G=e.unstable_now(),typeof _=="function"?h.callback=_:h===r(l)&&n(l),b(G)}else n(l);h=r(l)}if(h!==null)var R=!0;else{var I=r(u);I!==null&&me(S,I.startTime-G),R=!1}return R}finally{h=null,p=ge,d=!1}}var L=!1,A=null,D=-1,C=5,O=-1;function E(){return!(e.unstable_now()-O<C)}function P(){if(A!==null){var re=e.unstable_now();O=re;var G=!0;try{G=A(!0,re)}finally{G?q():(L=!1,A=null)}}else L=!1}var q;if(typeof y=="function")q=function(){y(P)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,ne=M.port2;M.port1.onmessage=P,q=function(){ne.postMessage(null)}}else q=function(){w(P,0)};function fe(re){A=re,L||(L=!0,q())}function me(re,G){D=w(function(){re(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(re){re.callback=null},e.unstable_continueExecution=function(){m||d||(m=!0,fe(T))},e.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<re?Math.floor(1e3/re):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(re){switch(p){case 1:case 2:case 3:var G=3;break;default:G=p}var ge=p;p=G;try{return re()}finally{p=ge}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(re,G){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var ge=p;p=re;try{return G()}finally{p=ge}},e.unstable_scheduleCallback=function(re,G,ge){var ve=e.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?ve+ge:ve):ge=ve,re){case 1:var _=-1;break;case 2:_=250;break;case 5:_=1073741823;break;case 4:_=1e4;break;default:_=5e3}return _=ge+_,re={id:f++,callback:G,priorityLevel:re,startTime:ge,expirationTime:_,sortIndex:-1},ge>ve?(re.sortIndex=ge,t(u,re),r(l)===null&&re===r(u)&&(g?(x(D),D=-1):g=!0,me(S,ge-ve))):(re.sortIndex=_,t(l,re),m||d||(m=!0,fe(T))),re},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(re){var G=p;return function(){var ge=p;p=G;try{return re.apply(this,arguments)}finally{p=ge}}}})(BE);ME.exports=BE;var VL=ME.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KL=ee,Fa=VL;function tt(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var UE=new Set,y0={};function Uu(e,t){pd(e,t),pd(e+"Capture",t)}function pd(e,t){for(y0[e]=t,e=0;e<t.length;e++)UE.add(t[e])}var cl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gv=Object.prototype.hasOwnProperty,GL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,t3={},r3={};function YL(e){return Gv.call(r3,e)?!0:Gv.call(t3,e)?!1:GL.test(e)?r3[e]=!0:(t3[e]=!0,!1)}function XL(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function JL(e,t,r,n){if(t===null||typeof t>"u"||XL(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function na(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var ps={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ps[e]=new na(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ps[t]=new na(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ps[e]=new na(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ps[e]=new na(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ps[e]=new na(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ps[e]=new na(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ps[e]=new na(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ps[e]=new na(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ps[e]=new na(e,5,!1,e.toLowerCase(),null,!1,!1)});var f5=/[\-:]([a-z])/g;function d5(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(f5,d5);ps[t]=new na(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(f5,d5);ps[t]=new na(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(f5,d5);ps[t]=new na(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ps[e]=new na(e,1,!1,e.toLowerCase(),null,!1,!1)});ps.xlinkHref=new na("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ps[e]=new na(e,1,!1,e.toLowerCase(),null,!0,!0)});function h5(e,t,r,n){var s=ps.hasOwnProperty(t)?ps[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(JL(t,r,s,n)&&(r=null),n||s===null?YL(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var xl=KL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hm=Symbol.for("react.element"),Af=Symbol.for("react.portal"),jf=Symbol.for("react.fragment"),p5=Symbol.for("react.strict_mode"),Yv=Symbol.for("react.profiler"),$E=Symbol.for("react.provider"),zE=Symbol.for("react.context"),m5=Symbol.for("react.forward_ref"),Xv=Symbol.for("react.suspense"),Jv=Symbol.for("react.suspense_list"),g5=Symbol.for("react.memo"),Hl=Symbol.for("react.lazy"),HE=Symbol.for("react.offscreen"),n3=Symbol.iterator;function mh(e){return e===null||typeof e!="object"?null:(e=n3&&e[n3]||e["@@iterator"],typeof e=="function"?e:null)}var nn=Object.assign,y2;function Lh(e){if(y2===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);y2=t&&t[1]||""}return`
`+y2+e}var w2=!1;function b2(e,t){if(!e||w2)return"";w2=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{w2=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Lh(e):""}function QL(e){switch(e.tag){case 5:return Lh(e.type);case 16:return Lh("Lazy");case 13:return Lh("Suspense");case 19:return Lh("SuspenseList");case 0:case 2:case 15:return e=b2(e.type,!1),e;case 11:return e=b2(e.type.render,!1),e;case 1:return e=b2(e.type,!0),e;default:return""}}function Qv(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case jf:return"Fragment";case Af:return"Portal";case Yv:return"Profiler";case p5:return"StrictMode";case Xv:return"Suspense";case Jv:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zE:return(e.displayName||"Context")+".Consumer";case $E:return(e._context.displayName||"Context")+".Provider";case m5:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case g5:return t=e.displayName||null,t!==null?t:Qv(e.type)||"Memo";case Hl:t=e._payload,e=e._init;try{return Qv(e(t))}catch{}}return null}function ZL(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qv(t);case 8:return t===p5?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Nc(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function qE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function eF(e){var t=qE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pm(e){e._valueTracker||(e._valueTracker=eF(e))}function WE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=qE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function H1(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Zv(e,t){var r=t.checked;return nn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function s3(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Nc(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function VE(e,t){t=t.checked,t!=null&&h5(e,"checked",t,!1)}function ey(e,t){VE(e,t);var r=Nc(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?ty(e,t.type,r):t.hasOwnProperty("defaultValue")&&ty(e,t.type,Nc(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function a3(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function ty(e,t,r){(t!=="number"||H1(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Fh=Array.isArray;function $f(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Nc(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function ry(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(tt(91));return nn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function i3(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(tt(92));if(Fh(r)){if(1<r.length)throw Error(tt(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Nc(r)}}function KE(e,t){var r=Nc(t.value),n=Nc(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function o3(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function GE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ny(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?GE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var mm,YE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(mm=mm||document.createElement("div"),mm.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=mm.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function w0(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Wh={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tF=["Webkit","ms","Moz","O"];Object.keys(Wh).forEach(function(e){tF.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Wh[t]=Wh[e]})});function XE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Wh.hasOwnProperty(e)&&Wh[e]?(""+t).trim():t+"px"}function JE(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=XE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var rF=nn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sy(e,t){if(t){if(rF[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(tt(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(tt(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(tt(61))}if(t.style!=null&&typeof t.style!="object")throw Error(tt(62))}}function ay(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iy=null;function x5(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oy=null,zf=null,Hf=null;function l3(e){if(e=gp(e)){if(typeof oy!="function")throw Error(tt(280));var t=e.stateNode;t&&(t=ax(t),oy(e.stateNode,e.type,t))}}function QE(e){zf?Hf?Hf.push(e):Hf=[e]:zf=e}function ZE(){if(zf){var e=zf,t=Hf;if(Hf=zf=null,l3(e),t)for(e=0;e<t.length;e++)l3(t[e])}}function e6(e,t){return e(t)}function t6(){}var N2=!1;function r6(e,t,r){if(N2)return e(t,r);N2=!0;try{return e6(e,t,r)}finally{N2=!1,(zf!==null||Hf!==null)&&(t6(),ZE())}}function b0(e,t){var r=e.stateNode;if(r===null)return null;var n=ax(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(tt(231,t,typeof r));return r}var ly=!1;if(cl)try{var gh={};Object.defineProperty(gh,"passive",{get:function(){ly=!0}}),window.addEventListener("test",gh,gh),window.removeEventListener("test",gh,gh)}catch{ly=!1}function nF(e,t,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Vh=!1,q1=null,W1=!1,cy=null,sF={onError:function(e){Vh=!0,q1=e}};function aF(e,t,r,n,s,a,i,o,l){Vh=!1,q1=null,nF.apply(sF,arguments)}function iF(e,t,r,n,s,a,i,o,l){if(aF.apply(this,arguments),Vh){if(Vh){var u=q1;Vh=!1,q1=null}else throw Error(tt(198));W1||(W1=!0,cy=u)}}function $u(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function n6(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function c3(e){if($u(e)!==e)throw Error(tt(188))}function oF(e){var t=e.alternate;if(!t){if(t=$u(e),t===null)throw Error(tt(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return c3(s),e;if(a===n)return c3(s),t;a=a.sibling}throw Error(tt(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(tt(189))}}if(r.alternate!==n)throw Error(tt(190))}if(r.tag!==3)throw Error(tt(188));return r.stateNode.current===r?e:t}function s6(e){return e=oF(e),e!==null?a6(e):null}function a6(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=a6(e);if(t!==null)return t;e=e.sibling}return null}var i6=Fa.unstable_scheduleCallback,u3=Fa.unstable_cancelCallback,lF=Fa.unstable_shouldYield,cF=Fa.unstable_requestPaint,wn=Fa.unstable_now,uF=Fa.unstable_getCurrentPriorityLevel,v5=Fa.unstable_ImmediatePriority,o6=Fa.unstable_UserBlockingPriority,V1=Fa.unstable_NormalPriority,fF=Fa.unstable_LowPriority,l6=Fa.unstable_IdlePriority,tx=null,fo=null;function dF(e){if(fo&&typeof fo.onCommitFiberRoot=="function")try{fo.onCommitFiberRoot(tx,e,void 0,(e.current.flags&128)===128)}catch{}}var Pi=Math.clz32?Math.clz32:mF,hF=Math.log,pF=Math.LN2;function mF(e){return e>>>=0,e===0?32:31-(hF(e)/pF|0)|0}var gm=64,xm=4194304;function Dh(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function K1(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Dh(o):(a&=i,a!==0&&(n=Dh(a)))}else i=r&~s,i!==0?n=Dh(i):a!==0&&(n=Dh(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Pi(t),s=1<<r,n|=e[r],t&=~s;return n}function gF(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xF(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Pi(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=gF(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function uy(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function c6(){var e=gm;return gm<<=1,!(gm&4194240)&&(gm=64),e}function S2(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function pp(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Pi(t),e[t]=r}function vF(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Pi(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function y5(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Pi(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var Er=0;function u6(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var f6,w5,d6,h6,p6,fy=!1,vm=[],uc=null,fc=null,dc=null,N0=new Map,S0=new Map,Kl=[],yF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function f3(e,t){switch(e){case"focusin":case"focusout":uc=null;break;case"dragenter":case"dragleave":fc=null;break;case"mouseover":case"mouseout":dc=null;break;case"pointerover":case"pointerout":N0.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":S0.delete(t.pointerId)}}function xh(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=gp(t),t!==null&&w5(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function wF(e,t,r,n,s){switch(t){case"focusin":return uc=xh(uc,e,t,r,n,s),!0;case"dragenter":return fc=xh(fc,e,t,r,n,s),!0;case"mouseover":return dc=xh(dc,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return N0.set(a,xh(N0.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,S0.set(a,xh(S0.get(a)||null,e,t,r,n,s)),!0}return!1}function m6(e){var t=nu(e.target);if(t!==null){var r=$u(t);if(r!==null){if(t=r.tag,t===13){if(t=n6(r),t!==null){e.blockedOn=t,p6(e.priority,function(){d6(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function d1(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=dy(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);iy=n,r.target.dispatchEvent(n),iy=null}else return t=gp(r),t!==null&&w5(t),e.blockedOn=r,!1;t.shift()}return!0}function d3(e,t,r){d1(e)&&r.delete(t)}function bF(){fy=!1,uc!==null&&d1(uc)&&(uc=null),fc!==null&&d1(fc)&&(fc=null),dc!==null&&d1(dc)&&(dc=null),N0.forEach(d3),S0.forEach(d3)}function vh(e,t){e.blockedOn===t&&(e.blockedOn=null,fy||(fy=!0,Fa.unstable_scheduleCallback(Fa.unstable_NormalPriority,bF)))}function k0(e){function t(s){return vh(s,e)}if(0<vm.length){vh(vm[0],e);for(var r=1;r<vm.length;r++){var n=vm[r];n.blockedOn===e&&(n.blockedOn=null)}}for(uc!==null&&vh(uc,e),fc!==null&&vh(fc,e),dc!==null&&vh(dc,e),N0.forEach(t),S0.forEach(t),r=0;r<Kl.length;r++)n=Kl[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Kl.length&&(r=Kl[0],r.blockedOn===null);)m6(r),r.blockedOn===null&&Kl.shift()}var qf=xl.ReactCurrentBatchConfig,G1=!0;function NF(e,t,r,n){var s=Er,a=qf.transition;qf.transition=null;try{Er=1,b5(e,t,r,n)}finally{Er=s,qf.transition=a}}function SF(e,t,r,n){var s=Er,a=qf.transition;qf.transition=null;try{Er=4,b5(e,t,r,n)}finally{Er=s,qf.transition=a}}function b5(e,t,r,n){if(G1){var s=dy(e,t,r,n);if(s===null)F2(e,t,n,Y1,r),f3(e,n);else if(wF(s,e,t,r,n))n.stopPropagation();else if(f3(e,n),t&4&&-1<yF.indexOf(e)){for(;s!==null;){var a=gp(s);if(a!==null&&f6(a),a=dy(e,t,r,n),a===null&&F2(e,t,n,Y1,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else F2(e,t,n,null,r)}}var Y1=null;function dy(e,t,r,n){if(Y1=null,e=x5(n),e=nu(e),e!==null)if(t=$u(e),t===null)e=null;else if(r=t.tag,r===13){if(e=n6(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Y1=e,null}function g6(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uF()){case v5:return 1;case o6:return 4;case V1:case fF:return 16;case l6:return 536870912;default:return 16}default:return 16}}var nc=null,N5=null,h1=null;function x6(){if(h1)return h1;var e,t=N5,r=t.length,n,s="value"in nc?nc.value:nc.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return h1=s.slice(e,1<n?1-n:void 0)}function p1(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ym(){return!0}function h3(){return!1}function Ia(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ym:h3,this.isPropagationStopped=h3,this}return nn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=ym)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=ym)},persist:function(){},isPersistent:ym}),t}var Ad={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},S5=Ia(Ad),mp=nn({},Ad,{view:0,detail:0}),kF=Ia(mp),k2,_2,yh,rx=nn({},mp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:k5,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yh&&(yh&&e.type==="mousemove"?(k2=e.screenX-yh.screenX,_2=e.screenY-yh.screenY):_2=k2=0,yh=e),k2)},movementY:function(e){return"movementY"in e?e.movementY:_2}}),p3=Ia(rx),_F=nn({},rx,{dataTransfer:0}),EF=Ia(_F),AF=nn({},mp,{relatedTarget:0}),E2=Ia(AF),jF=nn({},Ad,{animationName:0,elapsedTime:0,pseudoElement:0}),TF=Ia(jF),CF=nn({},Ad,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),PF=Ia(CF),LF=nn({},Ad,{data:0}),m3=Ia(LF),FF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},RF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function OF(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=RF[e])?!!t[e]:!1}function k5(){return OF}var IF=nn({},mp,{key:function(e){if(e.key){var t=FF[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=p1(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?DF[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:k5,charCode:function(e){return e.type==="keypress"?p1(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?p1(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),MF=Ia(IF),BF=nn({},rx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),g3=Ia(BF),UF=nn({},mp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:k5}),$F=Ia(UF),zF=nn({},Ad,{propertyName:0,elapsedTime:0,pseudoElement:0}),HF=Ia(zF),qF=nn({},rx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),WF=Ia(qF),VF=[9,13,27,32],_5=cl&&"CompositionEvent"in window,Kh=null;cl&&"documentMode"in document&&(Kh=document.documentMode);var KF=cl&&"TextEvent"in window&&!Kh,v6=cl&&(!_5||Kh&&8<Kh&&11>=Kh),x3=" ",v3=!1;function y6(e,t){switch(e){case"keyup":return VF.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function w6(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Tf=!1;function GF(e,t){switch(e){case"compositionend":return w6(t);case"keypress":return t.which!==32?null:(v3=!0,x3);case"textInput":return e=t.data,e===x3&&v3?null:e;default:return null}}function YF(e,t){if(Tf)return e==="compositionend"||!_5&&y6(e,t)?(e=x6(),h1=N5=nc=null,Tf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return v6&&t.locale!=="ko"?null:t.data;default:return null}}var XF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function y3(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!XF[e.type]:t==="textarea"}function b6(e,t,r,n){QE(n),t=X1(t,"onChange"),0<t.length&&(r=new S5("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Gh=null,_0=null;function JF(e){L6(e,0)}function nx(e){var t=Lf(e);if(WE(t))return e}function QF(e,t){if(e==="change")return t}var N6=!1;if(cl){var A2;if(cl){var j2="oninput"in document;if(!j2){var w3=document.createElement("div");w3.setAttribute("oninput","return;"),j2=typeof w3.oninput=="function"}A2=j2}else A2=!1;N6=A2&&(!document.documentMode||9<document.documentMode)}function b3(){Gh&&(Gh.detachEvent("onpropertychange",S6),_0=Gh=null)}function S6(e){if(e.propertyName==="value"&&nx(_0)){var t=[];b6(t,_0,e,x5(e)),r6(JF,t)}}function ZF(e,t,r){e==="focusin"?(b3(),Gh=t,_0=r,Gh.attachEvent("onpropertychange",S6)):e==="focusout"&&b3()}function e7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return nx(_0)}function t7(e,t){if(e==="click")return nx(t)}function r7(e,t){if(e==="input"||e==="change")return nx(t)}function n7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ri=typeof Object.is=="function"?Object.is:n7;function E0(e,t){if(Ri(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!Gv.call(t,s)||!Ri(e[s],t[s]))return!1}return!0}function N3(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function S3(e,t){var r=N3(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=N3(r)}}function k6(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?k6(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function _6(){for(var e=window,t=H1();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=H1(e.document)}return t}function E5(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function s7(e){var t=_6(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&k6(r.ownerDocument.documentElement,r)){if(n!==null&&E5(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=S3(r,a);var i=S3(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var a7=cl&&"documentMode"in document&&11>=document.documentMode,Cf=null,hy=null,Yh=null,py=!1;function k3(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;py||Cf==null||Cf!==H1(n)||(n=Cf,"selectionStart"in n&&E5(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yh&&E0(Yh,n)||(Yh=n,n=X1(hy,"onSelect"),0<n.length&&(t=new S5("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Cf)))}function wm(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Pf={animationend:wm("Animation","AnimationEnd"),animationiteration:wm("Animation","AnimationIteration"),animationstart:wm("Animation","AnimationStart"),transitionend:wm("Transition","TransitionEnd")},T2={},E6={};cl&&(E6=document.createElement("div").style,"AnimationEvent"in window||(delete Pf.animationend.animation,delete Pf.animationiteration.animation,delete Pf.animationstart.animation),"TransitionEvent"in window||delete Pf.transitionend.transition);function sx(e){if(T2[e])return T2[e];if(!Pf[e])return e;var t=Pf[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in E6)return T2[e]=t[r];return e}var A6=sx("animationend"),j6=sx("animationiteration"),T6=sx("animationstart"),C6=sx("transitionend"),P6=new Map,_3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pc(e,t){P6.set(e,t),Uu(t,[e])}for(var C2=0;C2<_3.length;C2++){var P2=_3[C2],i7=P2.toLowerCase(),o7=P2[0].toUpperCase()+P2.slice(1);Pc(i7,"on"+o7)}Pc(A6,"onAnimationEnd");Pc(j6,"onAnimationIteration");Pc(T6,"onAnimationStart");Pc("dblclick","onDoubleClick");Pc("focusin","onFocus");Pc("focusout","onBlur");Pc(C6,"onTransitionEnd");pd("onMouseEnter",["mouseout","mouseover"]);pd("onMouseLeave",["mouseout","mouseover"]);pd("onPointerEnter",["pointerout","pointerover"]);pd("onPointerLeave",["pointerout","pointerover"]);Uu("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Uu("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Uu("onBeforeInput",["compositionend","keypress","textInput","paste"]);Uu("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Uu("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),l7=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rh));function E3(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,iF(n,t,void 0,e),e.currentTarget=null}function L6(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;E3(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;E3(s,o,u),a=l}}}if(W1)throw e=cy,W1=!1,cy=null,e}function zr(e,t){var r=t[yy];r===void 0&&(r=t[yy]=new Set);var n=e+"__bubble";r.has(n)||(F6(t,e,2,!1),r.add(n))}function L2(e,t,r){var n=0;t&&(n|=4),F6(r,e,n,t)}var bm="_reactListening"+Math.random().toString(36).slice(2);function A0(e){if(!e[bm]){e[bm]=!0,UE.forEach(function(r){r!=="selectionchange"&&(l7.has(r)||L2(r,!1,e),L2(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[bm]||(t[bm]=!0,L2("selectionchange",!1,t))}}function F6(e,t,r,n){switch(g6(t)){case 1:var s=NF;break;case 4:s=SF;break;default:s=b5}r=s.bind(null,t,r,e),s=void 0,!ly||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function F2(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=nu(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}r6(function(){var u=a,f=x5(r),h=[];e:{var p=P6.get(e);if(p!==void 0){var d=S5,m=e;switch(e){case"keypress":if(p1(r)===0)break e;case"keydown":case"keyup":d=MF;break;case"focusin":m="focus",d=E2;break;case"focusout":m="blur",d=E2;break;case"beforeblur":case"afterblur":d=E2;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":d=p3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":d=EF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":d=$F;break;case A6:case j6:case T6:d=TF;break;case C6:d=HF;break;case"scroll":d=kF;break;case"wheel":d=WF;break;case"copy":case"cut":case"paste":d=PF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":d=g3}var g=(t&4)!==0,w=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var y=u,b;y!==null;){b=y;var S=b.stateNode;if(b.tag===5&&S!==null&&(b=S,x!==null&&(S=b0(y,x),S!=null&&g.push(j0(y,S,b)))),w)break;y=y.return}0<g.length&&(p=new d(p,m,null,r,f),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",d=e==="mouseout"||e==="pointerout",p&&r!==iy&&(m=r.relatedTarget||r.fromElement)&&(nu(m)||m[ul]))break e;if((d||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,d?(m=r.relatedTarget||r.toElement,d=u,m=m?nu(m):null,m!==null&&(w=$u(m),m!==w||m.tag!==5&&m.tag!==6)&&(m=null)):(d=null,m=u),d!==m)){if(g=p3,S="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(g=g3,S="onPointerLeave",x="onPointerEnter",y="pointer"),w=d==null?p:Lf(d),b=m==null?p:Lf(m),p=new g(S,y+"leave",d,r,f),p.target=w,p.relatedTarget=b,S=null,nu(f)===u&&(g=new g(x,y+"enter",m,r,f),g.target=b,g.relatedTarget=w,S=g),w=S,d&&m)t:{for(g=d,x=m,y=0,b=g;b;b=cf(b))y++;for(b=0,S=x;S;S=cf(S))b++;for(;0<y-b;)g=cf(g),y--;for(;0<b-y;)x=cf(x),b--;for(;y--;){if(g===x||x!==null&&g===x.alternate)break t;g=cf(g),x=cf(x)}g=null}else g=null;d!==null&&A3(h,p,d,g,!1),m!==null&&w!==null&&A3(h,w,m,g,!0)}}e:{if(p=u?Lf(u):window,d=p.nodeName&&p.nodeName.toLowerCase(),d==="select"||d==="input"&&p.type==="file")var T=QF;else if(y3(p))if(N6)T=r7;else{T=e7;var L=ZF}else(d=p.nodeName)&&d.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(T=t7);if(T&&(T=T(e,u))){b6(h,T,r,f);break e}L&&L(e,p,u),e==="focusout"&&(L=p._wrapperState)&&L.controlled&&p.type==="number"&&ty(p,"number",p.value)}switch(L=u?Lf(u):window,e){case"focusin":(y3(L)||L.contentEditable==="true")&&(Cf=L,hy=u,Yh=null);break;case"focusout":Yh=hy=Cf=null;break;case"mousedown":py=!0;break;case"contextmenu":case"mouseup":case"dragend":py=!1,k3(h,r,f);break;case"selectionchange":if(a7)break;case"keydown":case"keyup":k3(h,r,f)}var A;if(_5)e:{switch(e){case"compositionstart":var D="onCompositionStart";break e;case"compositionend":D="onCompositionEnd";break e;case"compositionupdate":D="onCompositionUpdate";break e}D=void 0}else Tf?y6(e,r)&&(D="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(D="onCompositionStart");D&&(v6&&r.locale!=="ko"&&(Tf||D!=="onCompositionStart"?D==="onCompositionEnd"&&Tf&&(A=x6()):(nc=f,N5="value"in nc?nc.value:nc.textContent,Tf=!0)),L=X1(u,D),0<L.length&&(D=new m3(D,e,null,r,f),h.push({event:D,listeners:L}),A?D.data=A:(A=w6(r),A!==null&&(D.data=A)))),(A=KF?GF(e,r):YF(e,r))&&(u=X1(u,"onBeforeInput"),0<u.length&&(f=new m3("onBeforeInput","beforeinput",null,r,f),h.push({event:f,listeners:u}),f.data=A))}L6(h,t)})}function j0(e,t,r){return{instance:e,listener:t,currentTarget:r}}function X1(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=b0(e,r),a!=null&&n.unshift(j0(e,a,s)),a=b0(e,t),a!=null&&n.push(j0(e,a,s))),e=e.return}return n}function cf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function A3(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=b0(r,a),l!=null&&i.unshift(j0(r,l,o))):s||(l=b0(r,a),l!=null&&i.push(j0(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var c7=/\r\n?/g,u7=/\u0000|\uFFFD/g;function j3(e){return(typeof e=="string"?e:""+e).replace(c7,`
`).replace(u7,"")}function Nm(e,t,r){if(t=j3(t),j3(e)!==t&&r)throw Error(tt(425))}function J1(){}var my=null,gy=null;function xy(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var vy=typeof setTimeout=="function"?setTimeout:void 0,f7=typeof clearTimeout=="function"?clearTimeout:void 0,T3=typeof Promise=="function"?Promise:void 0,d7=typeof queueMicrotask=="function"?queueMicrotask:typeof T3<"u"?function(e){return T3.resolve(null).then(e).catch(h7)}:vy;function h7(e){setTimeout(function(){throw e})}function D2(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),k0(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);k0(t)}function hc(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function C3(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var jd=Math.random().toString(36).slice(2),io="__reactFiber$"+jd,T0="__reactProps$"+jd,ul="__reactContainer$"+jd,yy="__reactEvents$"+jd,p7="__reactListeners$"+jd,m7="__reactHandles$"+jd;function nu(e){var t=e[io];if(t)return t;for(var r=e.parentNode;r;){if(t=r[ul]||r[io]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=C3(e);e!==null;){if(r=e[io])return r;e=C3(e)}return t}e=r,r=e.parentNode}return null}function gp(e){return e=e[io]||e[ul],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Lf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(tt(33))}function ax(e){return e[T0]||null}var wy=[],Ff=-1;function Lc(e){return{current:e}}function Wr(e){0>Ff||(e.current=wy[Ff],wy[Ff]=null,Ff--)}function Mr(e,t){Ff++,wy[Ff]=e.current,e.current=t}var Sc={},Ds=Lc(Sc),ua=Lc(!1),Eu=Sc;function md(e,t){var r=e.type.contextTypes;if(!r)return Sc;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function fa(e){return e=e.childContextTypes,e!=null}function Q1(){Wr(ua),Wr(Ds)}function P3(e,t,r){if(Ds.current!==Sc)throw Error(tt(168));Mr(Ds,t),Mr(ua,r)}function D6(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(tt(108,ZL(e)||"Unknown",s));return nn({},r,n)}function Z1(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Sc,Eu=Ds.current,Mr(Ds,e),Mr(ua,ua.current),!0}function L3(e,t,r){var n=e.stateNode;if(!n)throw Error(tt(169));r?(e=D6(e,t,Eu),n.__reactInternalMemoizedMergedChildContext=e,Wr(ua),Wr(Ds),Mr(Ds,e)):Wr(ua),Mr(ua,r)}var Ko=null,ix=!1,R2=!1;function R6(e){Ko===null?Ko=[e]:Ko.push(e)}function g7(e){ix=!0,R6(e)}function Fc(){if(!R2&&Ko!==null){R2=!0;var e=0,t=Er;try{var r=Ko;for(Er=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ko=null,ix=!1}catch(s){throw Ko!==null&&(Ko=Ko.slice(e+1)),i6(v5,Fc),s}finally{Er=t,R2=!1}}return null}var Df=[],Rf=0,eg=null,tg=0,Ga=[],Ya=0,Au=null,Qo=1,Zo="";function Jc(e,t){Df[Rf++]=tg,Df[Rf++]=eg,eg=e,tg=t}function O6(e,t,r){Ga[Ya++]=Qo,Ga[Ya++]=Zo,Ga[Ya++]=Au,Au=e;var n=Qo;e=Zo;var s=32-Pi(n)-1;n&=~(1<<s),r+=1;var a=32-Pi(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Qo=1<<32-Pi(t)+s|r<<s|n,Zo=a+e}else Qo=1<<a|r<<s|n,Zo=e}function A5(e){e.return!==null&&(Jc(e,1),O6(e,1,0))}function j5(e){for(;e===eg;)eg=Df[--Rf],Df[Rf]=null,tg=Df[--Rf],Df[Rf]=null;for(;e===Au;)Au=Ga[--Ya],Ga[Ya]=null,Zo=Ga[--Ya],Ga[Ya]=null,Qo=Ga[--Ya],Ga[Ya]=null}var La=null,Ca=null,Jr=!1,ki=null;function I6(e,t){var r=Ja(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function F3(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,La=e,Ca=hc(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,La=e,Ca=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Au!==null?{id:Qo,overflow:Zo}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Ja(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,La=e,Ca=null,!0):!1;default:return!1}}function by(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Ny(e){if(Jr){var t=Ca;if(t){var r=t;if(!F3(e,t)){if(by(e))throw Error(tt(418));t=hc(r.nextSibling);var n=La;t&&F3(e,t)?I6(n,r):(e.flags=e.flags&-4097|2,Jr=!1,La=e)}}else{if(by(e))throw Error(tt(418));e.flags=e.flags&-4097|2,Jr=!1,La=e}}}function D3(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;La=e}function Sm(e){if(e!==La)return!1;if(!Jr)return D3(e),Jr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!xy(e.type,e.memoizedProps)),t&&(t=Ca)){if(by(e))throw M6(),Error(tt(418));for(;t;)I6(e,t),t=hc(t.nextSibling)}if(D3(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(tt(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ca=hc(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ca=null}}else Ca=La?hc(e.stateNode.nextSibling):null;return!0}function M6(){for(var e=Ca;e;)e=hc(e.nextSibling)}function gd(){Ca=La=null,Jr=!1}function T5(e){ki===null?ki=[e]:ki.push(e)}var x7=xl.ReactCurrentBatchConfig;function wh(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(tt(309));var n=r.stateNode}if(!n)throw Error(tt(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(tt(284));if(!r._owner)throw Error(tt(290,e))}return e}function km(e,t){throw e=Object.prototype.toString.call(t),Error(tt(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function R3(e){var t=e._init;return t(e._payload)}function B6(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function r(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function n(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function s(x,y){return x=xc(x,y),x.index=0,x.sibling=null,x}function a(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,y,b,S){return y===null||y.tag!==6?(y=z2(b,x.mode,S),y.return=x,y):(y=s(y,b),y.return=x,y)}function l(x,y,b,S){var T=b.type;return T===jf?f(x,y,b.props.children,S,b.key):y!==null&&(y.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Hl&&R3(T)===y.type)?(S=s(y,b.props),S.ref=wh(x,y,b),S.return=x,S):(S=b1(b.type,b.key,b.props,null,x.mode,S),S.ref=wh(x,y,b),S.return=x,S)}function u(x,y,b,S){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=H2(b,x.mode,S),y.return=x,y):(y=s(y,b.children||[]),y.return=x,y)}function f(x,y,b,S,T){return y===null||y.tag!==7?(y=gu(b,x.mode,S,T),y.return=x,y):(y=s(y,b),y.return=x,y)}function h(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=z2(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case hm:return b=b1(y.type,y.key,y.props,null,x.mode,b),b.ref=wh(x,null,y),b.return=x,b;case Af:return y=H2(y,x.mode,b),y.return=x,y;case Hl:var S=y._init;return h(x,S(y._payload),b)}if(Fh(y)||mh(y))return y=gu(y,x.mode,b,null),y.return=x,y;km(x,y)}return null}function p(x,y,b,S){var T=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:o(x,y,""+b,S);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case hm:return b.key===T?l(x,y,b,S):null;case Af:return b.key===T?u(x,y,b,S):null;case Hl:return T=b._init,p(x,y,T(b._payload),S)}if(Fh(b)||mh(b))return T!==null?null:f(x,y,b,S,null);km(x,b)}return null}function d(x,y,b,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return x=x.get(b)||null,o(y,x,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hm:return x=x.get(S.key===null?b:S.key)||null,l(y,x,S,T);case Af:return x=x.get(S.key===null?b:S.key)||null,u(y,x,S,T);case Hl:var L=S._init;return d(x,y,b,L(S._payload),T)}if(Fh(S)||mh(S))return x=x.get(b)||null,f(y,x,S,T,null);km(y,S)}return null}function m(x,y,b,S){for(var T=null,L=null,A=y,D=y=0,C=null;A!==null&&D<b.length;D++){A.index>D?(C=A,A=null):C=A.sibling;var O=p(x,A,b[D],S);if(O===null){A===null&&(A=C);break}e&&A&&O.alternate===null&&t(x,A),y=a(O,y,D),L===null?T=O:L.sibling=O,L=O,A=C}if(D===b.length)return r(x,A),Jr&&Jc(x,D),T;if(A===null){for(;D<b.length;D++)A=h(x,b[D],S),A!==null&&(y=a(A,y,D),L===null?T=A:L.sibling=A,L=A);return Jr&&Jc(x,D),T}for(A=n(x,A);D<b.length;D++)C=d(A,x,D,b[D],S),C!==null&&(e&&C.alternate!==null&&A.delete(C.key===null?D:C.key),y=a(C,y,D),L===null?T=C:L.sibling=C,L=C);return e&&A.forEach(function(E){return t(x,E)}),Jr&&Jc(x,D),T}function g(x,y,b,S){var T=mh(b);if(typeof T!="function")throw Error(tt(150));if(b=T.call(b),b==null)throw Error(tt(151));for(var L=T=null,A=y,D=y=0,C=null,O=b.next();A!==null&&!O.done;D++,O=b.next()){A.index>D?(C=A,A=null):C=A.sibling;var E=p(x,A,O.value,S);if(E===null){A===null&&(A=C);break}e&&A&&E.alternate===null&&t(x,A),y=a(E,y,D),L===null?T=E:L.sibling=E,L=E,A=C}if(O.done)return r(x,A),Jr&&Jc(x,D),T;if(A===null){for(;!O.done;D++,O=b.next())O=h(x,O.value,S),O!==null&&(y=a(O,y,D),L===null?T=O:L.sibling=O,L=O);return Jr&&Jc(x,D),T}for(A=n(x,A);!O.done;D++,O=b.next())O=d(A,x,D,O.value,S),O!==null&&(e&&O.alternate!==null&&A.delete(O.key===null?D:O.key),y=a(O,y,D),L===null?T=O:L.sibling=O,L=O);return e&&A.forEach(function(P){return t(x,P)}),Jr&&Jc(x,D),T}function w(x,y,b,S){if(typeof b=="object"&&b!==null&&b.type===jf&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case hm:e:{for(var T=b.key,L=y;L!==null;){if(L.key===T){if(T=b.type,T===jf){if(L.tag===7){r(x,L.sibling),y=s(L,b.props.children),y.return=x,x=y;break e}}else if(L.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Hl&&R3(T)===L.type){r(x,L.sibling),y=s(L,b.props),y.ref=wh(x,L,b),y.return=x,x=y;break e}r(x,L);break}else t(x,L);L=L.sibling}b.type===jf?(y=gu(b.props.children,x.mode,S,b.key),y.return=x,x=y):(S=b1(b.type,b.key,b.props,null,x.mode,S),S.ref=wh(x,y,b),S.return=x,x=S)}return i(x);case Af:e:{for(L=b.key;y!==null;){if(y.key===L)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){r(x,y.sibling),y=s(y,b.children||[]),y.return=x,x=y;break e}else{r(x,y);break}else t(x,y);y=y.sibling}y=H2(b,x.mode,S),y.return=x,x=y}return i(x);case Hl:return L=b._init,w(x,y,L(b._payload),S)}if(Fh(b))return m(x,y,b,S);if(mh(b))return g(x,y,b,S);km(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(r(x,y.sibling),y=s(y,b),y.return=x,x=y):(r(x,y),y=z2(b,x.mode,S),y.return=x,x=y),i(x)):r(x,y)}return w}var xd=B6(!0),U6=B6(!1),rg=Lc(null),ng=null,Of=null,C5=null;function P5(){C5=Of=ng=null}function L5(e){var t=rg.current;Wr(rg),e._currentValue=t}function Sy(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Wf(e,t){ng=e,C5=Of=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ca=!0),e.firstContext=null)}function ei(e){var t=e._currentValue;if(C5!==e)if(e={context:e,memoizedValue:t,next:null},Of===null){if(ng===null)throw Error(tt(308));Of=e,ng.dependencies={lanes:0,firstContext:e}}else Of=Of.next=e;return t}var su=null;function F5(e){su===null?su=[e]:su.push(e)}function $6(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,F5(t)):(r.next=s.next,s.next=r),t.interleaved=r,fl(e,n)}function fl(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var ql=!1;function D5(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z6(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function nl(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function pc(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,xr&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,fl(e,r)}return s=n.interleaved,s===null?(t.next=t,F5(n)):(t.next=s.next,s.next=t),n.interleaved=t,fl(e,r)}function m1(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y5(e,r)}}function O3(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function sg(e,t,r,n){var s=e.updateQueue;ql=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(a!==null){var h=s.baseState;i=0,f=u=l=null,o=a;do{var p=o.lane,d=o.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:d,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(p=t,d=r,g.tag){case 1:if(m=g.payload,typeof m=="function"){h=m.call(d,h,p);break e}h=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=g.payload,p=typeof m=="function"?m.call(d,h,p):m,p==null)break e;h=nn({},h,p);break e;case 2:ql=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[o]:p.push(o))}else d={eventTime:d,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=d,l=h):f=f.next=d,i|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;p=o,o=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(f===null&&(l=h),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);Tu|=i,e.lanes=i,e.memoizedState=h}}function I3(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(tt(191,s));s.call(n)}}}var xp={},ho=Lc(xp),C0=Lc(xp),P0=Lc(xp);function au(e){if(e===xp)throw Error(tt(174));return e}function R5(e,t){switch(Mr(P0,t),Mr(C0,e),Mr(ho,xp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ny(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=ny(t,e)}Wr(ho),Mr(ho,t)}function vd(){Wr(ho),Wr(C0),Wr(P0)}function H6(e){au(P0.current);var t=au(ho.current),r=ny(t,e.type);t!==r&&(Mr(C0,e),Mr(ho,r))}function O5(e){C0.current===e&&(Wr(ho),Wr(C0))}var tn=Lc(0);function ag(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var O2=[];function I5(){for(var e=0;e<O2.length;e++)O2[e]._workInProgressVersionPrimary=null;O2.length=0}var g1=xl.ReactCurrentDispatcher,I2=xl.ReactCurrentBatchConfig,ju=0,rn=null,Hn=null,Jn=null,ig=!1,Xh=!1,L0=0,v7=0;function ys(){throw Error(tt(321))}function M5(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!Ri(e[r],t[r]))return!1;return!0}function B5(e,t,r,n,s,a){if(ju=a,rn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,g1.current=e===null||e.memoizedState===null?N7:S7,e=r(n,s),Xh){a=0;do{if(Xh=!1,L0=0,25<=a)throw Error(tt(301));a+=1,Jn=Hn=null,t.updateQueue=null,g1.current=k7,e=r(n,s)}while(Xh)}if(g1.current=og,t=Hn!==null&&Hn.next!==null,ju=0,Jn=Hn=rn=null,ig=!1,t)throw Error(tt(300));return e}function U5(){var e=L0!==0;return L0=0,e}function to(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?rn.memoizedState=Jn=e:Jn=Jn.next=e,Jn}function ti(){if(Hn===null){var e=rn.alternate;e=e!==null?e.memoizedState:null}else e=Hn.next;var t=Jn===null?rn.memoizedState:Jn.next;if(t!==null)Jn=t,Hn=e;else{if(e===null)throw Error(tt(310));Hn=e,e={memoizedState:Hn.memoizedState,baseState:Hn.baseState,baseQueue:Hn.baseQueue,queue:Hn.queue,next:null},Jn===null?rn.memoizedState=Jn=e:Jn=Jn.next=e}return Jn}function F0(e,t){return typeof t=="function"?t(e):t}function M2(e){var t=ti(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var n=Hn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var f=u.lane;if((ju&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,i=n):l=l.next=h,rn.lanes|=f,Tu|=f}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,Ri(n,t.memoizedState)||(ca=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,rn.lanes|=a,Tu|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function B2(e){var t=ti(),r=t.queue;if(r===null)throw Error(tt(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);Ri(a,t.memoizedState)||(ca=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function q6(){}function W6(e,t){var r=rn,n=ti(),s=t(),a=!Ri(n.memoizedState,s);if(a&&(n.memoizedState=s,ca=!0),n=n.queue,$5(G6.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Jn!==null&&Jn.memoizedState.tag&1){if(r.flags|=2048,D0(9,K6.bind(null,r,n,s,t),void 0,null),Zn===null)throw Error(tt(349));ju&30||V6(r,t,s)}return s}function V6(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function K6(e,t,r,n){t.value=r,t.getSnapshot=n,Y6(t)&&X6(e)}function G6(e,t,r){return r(function(){Y6(t)&&X6(e)})}function Y6(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Ri(e,r)}catch{return!0}}function X6(e){var t=fl(e,1);t!==null&&Li(t,e,1,-1)}function M3(e){var t=to();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:F0,lastRenderedState:e},t.queue=e,e=e.dispatch=b7.bind(null,rn,e),[t.memoizedState,e]}function D0(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=rn.updateQueue,t===null?(t={lastEffect:null,stores:null},rn.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function J6(){return ti().memoizedState}function x1(e,t,r,n){var s=to();rn.flags|=e,s.memoizedState=D0(1|t,r,void 0,n===void 0?null:n)}function ox(e,t,r,n){var s=ti();n=n===void 0?null:n;var a=void 0;if(Hn!==null){var i=Hn.memoizedState;if(a=i.destroy,n!==null&&M5(n,i.deps)){s.memoizedState=D0(t,r,a,n);return}}rn.flags|=e,s.memoizedState=D0(1|t,r,a,n)}function B3(e,t){return x1(8390656,8,e,t)}function $5(e,t){return ox(2048,8,e,t)}function Q6(e,t){return ox(4,2,e,t)}function Z6(e,t){return ox(4,4,e,t)}function eA(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tA(e,t,r){return r=r!=null?r.concat([e]):null,ox(4,4,eA.bind(null,t,e),r)}function z5(){}function rA(e,t){var r=ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&M5(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function nA(e,t){var r=ti();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&M5(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function sA(e,t,r){return ju&21?(Ri(r,t)||(r=c6(),rn.lanes|=r,Tu|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ca=!0),e.memoizedState=r)}function y7(e,t){var r=Er;Er=r!==0&&4>r?r:4,e(!0);var n=I2.transition;I2.transition={};try{e(!1),t()}finally{Er=r,I2.transition=n}}function aA(){return ti().memoizedState}function w7(e,t,r){var n=gc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},iA(e))oA(t,r);else if(r=$6(e,t,r,n),r!==null){var s=Xs();Li(r,e,n,s),lA(r,t,n)}}function b7(e,t,r){var n=gc(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(iA(e))oA(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Ri(o,i)){var l=t.interleaved;l===null?(s.next=s,F5(t)):(s.next=l.next,l.next=s),t.interleaved=s;return}}catch{}finally{}r=$6(e,t,s,n),r!==null&&(s=Xs(),Li(r,e,n,s),lA(r,t,n))}}function iA(e){var t=e.alternate;return e===rn||t!==null&&t===rn}function oA(e,t){Xh=ig=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function lA(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,y5(e,r)}}var og={readContext:ei,useCallback:ys,useContext:ys,useEffect:ys,useImperativeHandle:ys,useInsertionEffect:ys,useLayoutEffect:ys,useMemo:ys,useReducer:ys,useRef:ys,useState:ys,useDebugValue:ys,useDeferredValue:ys,useTransition:ys,useMutableSource:ys,useSyncExternalStore:ys,useId:ys,unstable_isNewReconciler:!1},N7={readContext:ei,useCallback:function(e,t){return to().memoizedState=[e,t===void 0?null:t],e},useContext:ei,useEffect:B3,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,x1(4194308,4,eA.bind(null,t,e),r)},useLayoutEffect:function(e,t){return x1(4194308,4,e,t)},useInsertionEffect:function(e,t){return x1(4,2,e,t)},useMemo:function(e,t){var r=to();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=to();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=w7.bind(null,rn,e),[n.memoizedState,e]},useRef:function(e){var t=to();return e={current:e},t.memoizedState=e},useState:M3,useDebugValue:z5,useDeferredValue:function(e){return to().memoizedState=e},useTransition:function(){var e=M3(!1),t=e[0];return e=y7.bind(null,e[1]),to().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=rn,s=to();if(Jr){if(r===void 0)throw Error(tt(407));r=r()}else{if(r=t(),Zn===null)throw Error(tt(349));ju&30||V6(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,B3(G6.bind(null,n,a,e),[e]),n.flags|=2048,D0(9,K6.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=to(),t=Zn.identifierPrefix;if(Jr){var r=Zo,n=Qo;r=(n&~(1<<32-Pi(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=L0++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=v7++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},S7={readContext:ei,useCallback:rA,useContext:ei,useEffect:$5,useImperativeHandle:tA,useInsertionEffect:Q6,useLayoutEffect:Z6,useMemo:nA,useReducer:M2,useRef:J6,useState:function(){return M2(F0)},useDebugValue:z5,useDeferredValue:function(e){var t=ti();return sA(t,Hn.memoizedState,e)},useTransition:function(){var e=M2(F0)[0],t=ti().memoizedState;return[e,t]},useMutableSource:q6,useSyncExternalStore:W6,useId:aA,unstable_isNewReconciler:!1},k7={readContext:ei,useCallback:rA,useContext:ei,useEffect:$5,useImperativeHandle:tA,useInsertionEffect:Q6,useLayoutEffect:Z6,useMemo:nA,useReducer:B2,useRef:J6,useState:function(){return B2(F0)},useDebugValue:z5,useDeferredValue:function(e){var t=ti();return Hn===null?t.memoizedState=e:sA(t,Hn.memoizedState,e)},useTransition:function(){var e=B2(F0)[0],t=ti().memoizedState;return[e,t]},useMutableSource:q6,useSyncExternalStore:W6,useId:aA,unstable_isNewReconciler:!1};function gi(e,t){if(e&&e.defaultProps){t=nn({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ky(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:nn({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var lx={isMounted:function(e){return(e=e._reactInternals)?$u(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Xs(),s=gc(e),a=nl(n,s);a.payload=t,r!=null&&(a.callback=r),t=pc(e,a,s),t!==null&&(Li(t,e,s,n),m1(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Xs(),s=gc(e),a=nl(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=pc(e,a,s),t!==null&&(Li(t,e,s,n),m1(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Xs(),n=gc(e),s=nl(r,n);s.tag=2,t!=null&&(s.callback=t),t=pc(e,s,n),t!==null&&(Li(t,e,n,r),m1(t,e,n))}};function U3(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!E0(r,n)||!E0(s,a):!0}function cA(e,t,r){var n=!1,s=Sc,a=t.contextType;return typeof a=="object"&&a!==null?a=ei(a):(s=fa(t)?Eu:Ds.current,n=t.contextTypes,a=(n=n!=null)?md(e,s):Sc),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=lx,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function $3(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&lx.enqueueReplaceState(t,t.state,null)}function _y(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},D5(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=ei(a):(a=fa(t)?Eu:Ds.current,s.context=md(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ky(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&lx.enqueueReplaceState(s,s.state,null),sg(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function yd(e,t){try{var r="",n=t;do r+=QL(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function U2(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ey(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var _7=typeof WeakMap=="function"?WeakMap:Map;function uA(e,t,r){r=nl(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){cg||(cg=!0,Oy=n),Ey(e,t)},r}function fA(e,t,r){r=nl(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Ey(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Ey(e,t),typeof n!="function"&&(mc===null?mc=new Set([this]):mc.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function z3(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new _7;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=B7.bind(null,e,t,r),t.then(e,e))}function H3(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function q3(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=nl(-1,1),t.tag=2,pc(r,t,1))),r.lanes|=1),e)}var E7=xl.ReactCurrentOwner,ca=!1;function Hs(e,t,r,n){t.child=e===null?U6(t,null,r,n):xd(t,e.child,r,n)}function W3(e,t,r,n,s){r=r.render;var a=t.ref;return Wf(t,s),n=B5(e,t,r,n,a,s),r=U5(),e!==null&&!ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,dl(e,t,s)):(Jr&&r&&A5(t),t.flags|=1,Hs(e,t,n,s),t.child)}function V3(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!X5(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,dA(e,t,a,n,s)):(e=b1(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:E0,r(i,n)&&e.ref===t.ref)return dl(e,t,s)}return t.flags|=1,e=xc(a,n),e.ref=t.ref,e.return=t,t.child=e}function dA(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(E0(a,n)&&e.ref===t.ref)if(ca=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(ca=!0);else return t.lanes=e.lanes,dl(e,t,s)}return Ay(e,t,r,n,s)}function hA(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mr(Mf,Aa),Aa|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mr(Mf,Aa),Aa|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Mr(Mf,Aa),Aa|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,Mr(Mf,Aa),Aa|=n;return Hs(e,t,s,r),t.child}function pA(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ay(e,t,r,n,s){var a=fa(r)?Eu:Ds.current;return a=md(t,a),Wf(t,s),r=B5(e,t,r,n,a,s),n=U5(),e!==null&&!ca?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,dl(e,t,s)):(Jr&&n&&A5(t),t.flags|=1,Hs(e,t,r,s),t.child)}function K3(e,t,r,n,s){if(fa(r)){var a=!0;Z1(t)}else a=!1;if(Wf(t,s),t.stateNode===null)v1(e,t),cA(t,r,n),_y(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=ei(u):(u=fa(r)?Eu:Ds.current,u=md(t,u));var f=r.getDerivedStateFromProps,h=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&$3(t,i,n,u),ql=!1;var p=t.memoizedState;i.state=p,sg(t,n,i,s),l=t.memoizedState,o!==n||p!==l||ua.current||ql?(typeof f=="function"&&(ky(t,r,f,n),l=t.memoizedState),(o=ql||U3(t,r,o,n,p,l,u))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,z6(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:gi(t.type,o),i.props=u,h=t.pendingProps,p=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=ei(l):(l=fa(r)?Eu:Ds.current,l=md(t,l));var d=r.getDerivedStateFromProps;(f=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||p!==l)&&$3(t,i,n,l),ql=!1,p=t.memoizedState,i.state=p,sg(t,n,i,s);var m=t.memoizedState;o!==h||p!==m||ua.current||ql?(typeof d=="function"&&(ky(t,r,d,n),m=t.memoizedState),(u=ql||U3(t,r,u,n,p,m,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,m,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,m,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return jy(e,t,r,n,a,s)}function jy(e,t,r,n,s,a){pA(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&L3(t,r,!1),dl(e,t,a);n=t.stateNode,E7.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=xd(t,e.child,null,a),t.child=xd(t,null,o,a)):Hs(e,t,o,a),t.memoizedState=n.state,s&&L3(t,r,!0),t.child}function mA(e){var t=e.stateNode;t.pendingContext?P3(e,t.pendingContext,t.pendingContext!==t.context):t.context&&P3(e,t.context,!1),R5(e,t.containerInfo)}function G3(e,t,r,n,s){return gd(),T5(s),t.flags|=256,Hs(e,t,r,n),t.child}var Ty={dehydrated:null,treeContext:null,retryLane:0};function Cy(e){return{baseLanes:e,cachePool:null,transitions:null}}function gA(e,t,r){var n=t.pendingProps,s=tn.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Mr(tn,s&1),e===null)return Ny(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=fx(i,n,0,null),e=gu(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Cy(r),t.memoizedState=Ty,e):H5(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return A7(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=xc(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=xc(o,a):(a=gu(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Cy(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Ty,n}return a=e.child,e=a.sibling,n=xc(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function H5(e,t){return t=fx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function _m(e,t,r,n){return n!==null&&T5(n),xd(t,e.child,null,r),e=H5(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function A7(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=U2(Error(tt(422))),_m(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=fx({mode:"visible",children:n.children},s,0,null),a=gu(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&xd(t,e.child,null,i),t.child.memoizedState=Cy(i),t.memoizedState=Ty,a);if(!(t.mode&1))return _m(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(tt(419)),n=U2(a,n,void 0),_m(e,t,i,n)}if(o=(i&e.childLanes)!==0,ca||o){if(n=Zn,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,fl(e,s),Li(n,e,s,-1))}return Y5(),n=U2(Error(tt(421))),_m(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=U7.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,Ca=hc(s.nextSibling),La=t,Jr=!0,ki=null,e!==null&&(Ga[Ya++]=Qo,Ga[Ya++]=Zo,Ga[Ya++]=Au,Qo=e.id,Zo=e.overflow,Au=t),t=H5(t,n.children),t.flags|=4096,t)}function Y3(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Sy(e.return,t,r)}function $2(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function xA(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Hs(e,t,n.children,r),n=tn.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Y3(e,r,t);else if(e.tag===19)Y3(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Mr(tn,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&ag(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),$2(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&ag(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}$2(t,!0,r,null,a);break;case"together":$2(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function v1(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function dl(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Tu|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(tt(153));if(t.child!==null){for(e=t.child,r=xc(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=xc(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function j7(e,t,r){switch(t.tag){case 3:mA(t),gd();break;case 5:H6(t);break;case 1:fa(t.type)&&Z1(t);break;case 4:R5(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;Mr(rg,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Mr(tn,tn.current&1),t.flags|=128,null):r&t.child.childLanes?gA(e,t,r):(Mr(tn,tn.current&1),e=dl(e,t,r),e!==null?e.sibling:null);Mr(tn,tn.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return xA(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Mr(tn,tn.current),n)break;return null;case 22:case 23:return t.lanes=0,hA(e,t,r)}return dl(e,t,r)}var vA,Py,yA,wA;vA=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Py=function(){};yA=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,au(ho.current);var a=null;switch(r){case"input":s=Zv(e,s),n=Zv(e,n),a=[];break;case"select":s=nn({},s,{value:void 0}),n=nn({},n,{value:void 0}),a=[];break;case"textarea":s=ry(e,s),n=ry(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=J1)}sy(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(y0.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(y0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&zr("scroll",e),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};wA=function(e,t,r,n){r!==n&&(t.flags|=4)};function bh(e,t){if(!Jr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function ws(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function T7(e,t,r){var n=t.pendingProps;switch(j5(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ws(t),null;case 1:return fa(t.type)&&Q1(),ws(t),null;case 3:return n=t.stateNode,vd(),Wr(ua),Wr(Ds),I5(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Sm(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ki!==null&&(By(ki),ki=null))),Py(e,t),ws(t),null;case 5:O5(t);var s=au(P0.current);if(r=t.type,e!==null&&t.stateNode!=null)yA(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(tt(166));return ws(t),null}if(e=au(ho.current),Sm(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[io]=t,n[T0]=a,e=(t.mode&1)!==0,r){case"dialog":zr("cancel",n),zr("close",n);break;case"iframe":case"object":case"embed":zr("load",n);break;case"video":case"audio":for(s=0;s<Rh.length;s++)zr(Rh[s],n);break;case"source":zr("error",n);break;case"img":case"image":case"link":zr("error",n),zr("load",n);break;case"details":zr("toggle",n);break;case"input":s3(n,a),zr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},zr("invalid",n);break;case"textarea":i3(n,a),zr("invalid",n)}sy(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Nm(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Nm(n.textContent,o,e),s=["children",""+o]):y0.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&zr("scroll",n)}switch(r){case"input":pm(n),a3(n,a,!0);break;case"textarea":pm(n),o3(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=J1)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=GE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[io]=t,e[T0]=n,vA(e,t,!1,!1),t.stateNode=e;e:{switch(i=ay(r,n),r){case"dialog":zr("cancel",e),zr("close",e),s=n;break;case"iframe":case"object":case"embed":zr("load",e),s=n;break;case"video":case"audio":for(s=0;s<Rh.length;s++)zr(Rh[s],e);s=n;break;case"source":zr("error",e),s=n;break;case"img":case"image":case"link":zr("error",e),zr("load",e),s=n;break;case"details":zr("toggle",e),s=n;break;case"input":s3(e,n),s=Zv(e,n),zr("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=nn({},n,{value:void 0}),zr("invalid",e);break;case"textarea":i3(e,n),s=ry(e,n),zr("invalid",e);break;default:s=n}sy(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?JE(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&YE(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&w0(e,l):typeof l=="number"&&w0(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(y0.hasOwnProperty(a)?l!=null&&a==="onScroll"&&zr("scroll",e):l!=null&&h5(e,a,l,i))}switch(r){case"input":pm(e),a3(e,n,!1);break;case"textarea":pm(e),o3(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Nc(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?$f(e,!!n.multiple,a,!1):n.defaultValue!=null&&$f(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=J1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ws(t),null;case 6:if(e&&t.stateNode!=null)wA(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(tt(166));if(r=au(P0.current),au(ho.current),Sm(t)){if(n=t.stateNode,r=t.memoizedProps,n[io]=t,(a=n.nodeValue!==r)&&(e=La,e!==null))switch(e.tag){case 3:Nm(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Nm(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[io]=t,t.stateNode=n}return ws(t),null;case 13:if(Wr(tn),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Jr&&Ca!==null&&t.mode&1&&!(t.flags&128))M6(),gd(),t.flags|=98560,a=!1;else if(a=Sm(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(tt(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(tt(317));a[io]=t}else gd(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ws(t),a=!1}else ki!==null&&(By(ki),ki=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||tn.current&1?qn===0&&(qn=3):Y5())),t.updateQueue!==null&&(t.flags|=4),ws(t),null);case 4:return vd(),Py(e,t),e===null&&A0(t.stateNode.containerInfo),ws(t),null;case 10:return L5(t.type._context),ws(t),null;case 17:return fa(t.type)&&Q1(),ws(t),null;case 19:if(Wr(tn),a=t.memoizedState,a===null)return ws(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)bh(a,!1);else{if(qn!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=ag(e),i!==null){for(t.flags|=128,bh(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Mr(tn,tn.current&1|2),t.child}e=e.sibling}a.tail!==null&&wn()>wd&&(t.flags|=128,n=!0,bh(a,!1),t.lanes=4194304)}else{if(!n)if(e=ag(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),bh(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Jr)return ws(t),null}else 2*wn()-a.renderingStartTime>wd&&r!==1073741824&&(t.flags|=128,n=!0,bh(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=wn(),t.sibling=null,r=tn.current,Mr(tn,n?r&1|2:r&1),t):(ws(t),null);case 22:case 23:return G5(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Aa&1073741824&&(ws(t),t.subtreeFlags&6&&(t.flags|=8192)):ws(t),null;case 24:return null;case 25:return null}throw Error(tt(156,t.tag))}function C7(e,t){switch(j5(t),t.tag){case 1:return fa(t.type)&&Q1(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return vd(),Wr(ua),Wr(Ds),I5(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return O5(t),null;case 13:if(Wr(tn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(tt(340));gd()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wr(tn),null;case 4:return vd(),null;case 10:return L5(t.type._context),null;case 22:case 23:return G5(),null;case 24:return null;default:return null}}var Em=!1,As=!1,P7=typeof WeakSet=="function"?WeakSet:Set,gt=null;function If(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){un(e,t,n)}else r.current=null}function Ly(e,t,r){try{r()}catch(n){un(e,t,n)}}var X3=!1;function L7(e,t){if(my=G1,e=_6(),E5(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,f=0,h=e,p=null;t:for(;;){for(var d;h!==r||s!==0&&h.nodeType!==3||(o=i+s),h!==a||n!==0&&h.nodeType!==3||(l=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(d=h.firstChild)!==null;)p=h,h=d;for(;;){if(h===e)break t;if(p===r&&++u===s&&(o=i),p===a&&++f===n&&(l=i),(d=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=d}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(gy={focusedElem:e,selectionRange:r},G1=!1,gt=t;gt!==null;)if(t=gt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,gt=e;else for(;gt!==null;){t=gt;try{var m=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var g=m.memoizedProps,w=m.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:gi(t.type,g),w);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(tt(163))}}catch(S){un(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,gt=e;break}gt=t.return}return m=X3,X3=!1,m}function Jh(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Ly(t,r,a)}s=s.next}while(s!==n)}}function cx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Fy(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function bA(e){var t=e.alternate;t!==null&&(e.alternate=null,bA(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[io],delete t[T0],delete t[yy],delete t[p7],delete t[m7])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function NA(e){return e.tag===5||e.tag===3||e.tag===4}function J3(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||NA(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Dy(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=J1));else if(n!==4&&(e=e.child,e!==null))for(Dy(e,t,r),e=e.sibling;e!==null;)Dy(e,t,r),e=e.sibling}function Ry(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Ry(e,t,r),e=e.sibling;e!==null;)Ry(e,t,r),e=e.sibling}var os=null,wi=!1;function Ol(e,t,r){for(r=r.child;r!==null;)SA(e,t,r),r=r.sibling}function SA(e,t,r){if(fo&&typeof fo.onCommitFiberUnmount=="function")try{fo.onCommitFiberUnmount(tx,r)}catch{}switch(r.tag){case 5:As||If(r,t);case 6:var n=os,s=wi;os=null,Ol(e,t,r),os=n,wi=s,os!==null&&(wi?(e=os,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):os.removeChild(r.stateNode));break;case 18:os!==null&&(wi?(e=os,r=r.stateNode,e.nodeType===8?D2(e.parentNode,r):e.nodeType===1&&D2(e,r),k0(e)):D2(os,r.stateNode));break;case 4:n=os,s=wi,os=r.stateNode.containerInfo,wi=!0,Ol(e,t,r),os=n,wi=s;break;case 0:case 11:case 14:case 15:if(!As&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Ly(r,t,i),s=s.next}while(s!==n)}Ol(e,t,r);break;case 1:if(!As&&(If(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){un(r,t,o)}Ol(e,t,r);break;case 21:Ol(e,t,r);break;case 22:r.mode&1?(As=(n=As)||r.memoizedState!==null,Ol(e,t,r),As=n):Ol(e,t,r);break;default:Ol(e,t,r)}}function Q3(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new P7),t.forEach(function(n){var s=$7.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function di(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:os=o.stateNode,wi=!1;break e;case 3:os=o.stateNode.containerInfo,wi=!0;break e;case 4:os=o.stateNode.containerInfo,wi=!0;break e}o=o.return}if(os===null)throw Error(tt(160));SA(a,i,s),os=null,wi=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){un(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kA(t,e),t=t.sibling}function kA(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(di(t,e),Gi(e),n&4){try{Jh(3,e,e.return),cx(3,e)}catch(g){un(e,e.return,g)}try{Jh(5,e,e.return)}catch(g){un(e,e.return,g)}}break;case 1:di(t,e),Gi(e),n&512&&r!==null&&If(r,r.return);break;case 5:if(di(t,e),Gi(e),n&512&&r!==null&&If(r,r.return),e.flags&32){var s=e.stateNode;try{w0(s,"")}catch(g){un(e,e.return,g)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&VE(s,a),ay(o,i);var u=ay(o,a);for(i=0;i<l.length;i+=2){var f=l[i],h=l[i+1];f==="style"?JE(s,h):f==="dangerouslySetInnerHTML"?YE(s,h):f==="children"?w0(s,h):h5(s,f,h,u)}switch(o){case"input":ey(s,a);break;case"textarea":KE(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var d=a.value;d!=null?$f(s,!!a.multiple,d,!1):p!==!!a.multiple&&(a.defaultValue!=null?$f(s,!!a.multiple,a.defaultValue,!0):$f(s,!!a.multiple,a.multiple?[]:"",!1))}s[T0]=a}catch(g){un(e,e.return,g)}}break;case 6:if(di(t,e),Gi(e),n&4){if(e.stateNode===null)throw Error(tt(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(g){un(e,e.return,g)}}break;case 3:if(di(t,e),Gi(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{k0(t.containerInfo)}catch(g){un(e,e.return,g)}break;case 4:di(t,e),Gi(e);break;case 13:di(t,e),Gi(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(V5=wn())),n&4&&Q3(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(As=(u=As)||f,di(t,e),As=u):di(t,e),Gi(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(gt=e,f=e.child;f!==null;){for(h=gt=f;gt!==null;){switch(p=gt,d=p.child,p.tag){case 0:case 11:case 14:case 15:Jh(4,p,p.return);break;case 1:If(p,p.return);var m=p.stateNode;if(typeof m.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){un(n,r,g)}}break;case 5:If(p,p.return);break;case 22:if(p.memoizedState!==null){eN(h);continue}}d!==null?(d.return=p,gt=d):eN(h)}f=f.sibling}e:for(f=null,h=e;;){if(h.tag===5){if(f===null){f=h;try{s=h.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=h.stateNode,l=h.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=XE("display",i))}catch(g){un(e,e.return,g)}}}else if(h.tag===6){if(f===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){un(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:di(t,e),Gi(e),n&4&&Q3(e);break;case 21:break;default:di(t,e),Gi(e)}}function Gi(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(NA(r)){var n=r;break e}r=r.return}throw Error(tt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(w0(s,""),n.flags&=-33);var a=J3(e);Ry(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=J3(e);Dy(e,o,i);break;default:throw Error(tt(161))}}catch(l){un(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function F7(e,t,r){gt=e,_A(e)}function _A(e,t,r){for(var n=(e.mode&1)!==0;gt!==null;){var s=gt,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Em;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||As;o=Em;var u=As;if(Em=i,(As=l)&&!u)for(gt=s;gt!==null;)i=gt,l=i.child,i.tag===22&&i.memoizedState!==null?tN(s):l!==null?(l.return=i,gt=l):tN(s);for(;a!==null;)gt=a,_A(a),a=a.sibling;gt=s,Em=o,As=u}Z3(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,gt=a):Z3(e)}}function Z3(e){for(;gt!==null;){var t=gt;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:As||cx(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!As)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:gi(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&I3(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}I3(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var h=f.dehydrated;h!==null&&k0(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(tt(163))}As||t.flags&512&&Fy(t)}catch(p){un(t,t.return,p)}}if(t===e){gt=null;break}if(r=t.sibling,r!==null){r.return=t.return,gt=r;break}gt=t.return}}function eN(e){for(;gt!==null;){var t=gt;if(t===e){gt=null;break}var r=t.sibling;if(r!==null){r.return=t.return,gt=r;break}gt=t.return}}function tN(e){for(;gt!==null;){var t=gt;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{cx(4,t)}catch(l){un(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(l){un(t,s,l)}}var a=t.return;try{Fy(t)}catch(l){un(t,a,l)}break;case 5:var i=t.return;try{Fy(t)}catch(l){un(t,i,l)}}}catch(l){un(t,t.return,l)}if(t===e){gt=null;break}var o=t.sibling;if(o!==null){o.return=t.return,gt=o;break}gt=t.return}}var D7=Math.ceil,lg=xl.ReactCurrentDispatcher,q5=xl.ReactCurrentOwner,Qa=xl.ReactCurrentBatchConfig,xr=0,Zn=null,Ln=null,fs=0,Aa=0,Mf=Lc(0),qn=0,R0=null,Tu=0,ux=0,W5=0,Qh=null,la=null,V5=0,wd=1/0,Vo=null,cg=!1,Oy=null,mc=null,Am=!1,sc=null,ug=0,Zh=0,Iy=null,y1=-1,w1=0;function Xs(){return xr&6?wn():y1!==-1?y1:y1=wn()}function gc(e){return e.mode&1?xr&2&&fs!==0?fs&-fs:x7.transition!==null?(w1===0&&(w1=c6()),w1):(e=Er,e!==0||(e=window.event,e=e===void 0?16:g6(e.type)),e):1}function Li(e,t,r,n){if(50<Zh)throw Zh=0,Iy=null,Error(tt(185));pp(e,r,n),(!(xr&2)||e!==Zn)&&(e===Zn&&(!(xr&2)&&(ux|=r),qn===4&&Gl(e,fs)),da(e,n),r===1&&xr===0&&!(t.mode&1)&&(wd=wn()+500,ix&&Fc()))}function da(e,t){var r=e.callbackNode;xF(e,t);var n=K1(e,e===Zn?fs:0);if(n===0)r!==null&&u3(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&u3(r),t===1)e.tag===0?g7(rN.bind(null,e)):R6(rN.bind(null,e)),d7(function(){!(xr&6)&&Fc()}),r=null;else{switch(u6(n)){case 1:r=v5;break;case 4:r=o6;break;case 16:r=V1;break;case 536870912:r=l6;break;default:r=V1}r=FA(r,EA.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function EA(e,t){if(y1=-1,w1=0,xr&6)throw Error(tt(327));var r=e.callbackNode;if(Vf()&&e.callbackNode!==r)return null;var n=K1(e,e===Zn?fs:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=fg(e,n);else{t=n;var s=xr;xr|=2;var a=jA();(Zn!==e||fs!==t)&&(Vo=null,wd=wn()+500,mu(e,t));do try{I7();break}catch(o){AA(e,o)}while(!0);P5(),lg.current=a,xr=s,Ln!==null?t=0:(Zn=null,fs=0,t=qn)}if(t!==0){if(t===2&&(s=uy(e),s!==0&&(n=s,t=My(e,s))),t===1)throw r=R0,mu(e,0),Gl(e,n),da(e,wn()),r;if(t===6)Gl(e,n);else{if(s=e.current.alternate,!(n&30)&&!R7(s)&&(t=fg(e,n),t===2&&(a=uy(e),a!==0&&(n=a,t=My(e,a))),t===1))throw r=R0,mu(e,0),Gl(e,n),da(e,wn()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(tt(345));case 2:Qc(e,la,Vo);break;case 3:if(Gl(e,n),(n&130023424)===n&&(t=V5+500-wn(),10<t)){if(K1(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Xs(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=vy(Qc.bind(null,e,la,Vo),t);break}Qc(e,la,Vo);break;case 4:if(Gl(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-Pi(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=wn()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*D7(n/1960))-n,10<n){e.timeoutHandle=vy(Qc.bind(null,e,la,Vo),n);break}Qc(e,la,Vo);break;case 5:Qc(e,la,Vo);break;default:throw Error(tt(329))}}}return da(e,wn()),e.callbackNode===r?EA.bind(null,e):null}function My(e,t){var r=Qh;return e.current.memoizedState.isDehydrated&&(mu(e,t).flags|=256),e=fg(e,t),e!==2&&(t=la,la=r,t!==null&&By(t)),e}function By(e){la===null?la=e:la.push.apply(la,e)}function R7(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Ri(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Gl(e,t){for(t&=~W5,t&=~ux,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Pi(t),n=1<<r;e[r]=-1,t&=~n}}function rN(e){if(xr&6)throw Error(tt(327));Vf();var t=K1(e,0);if(!(t&1))return da(e,wn()),null;var r=fg(e,t);if(e.tag!==0&&r===2){var n=uy(e);n!==0&&(t=n,r=My(e,n))}if(r===1)throw r=R0,mu(e,0),Gl(e,t),da(e,wn()),r;if(r===6)throw Error(tt(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Qc(e,la,Vo),da(e,wn()),null}function K5(e,t){var r=xr;xr|=1;try{return e(t)}finally{xr=r,xr===0&&(wd=wn()+500,ix&&Fc())}}function Cu(e){sc!==null&&sc.tag===0&&!(xr&6)&&Vf();var t=xr;xr|=1;var r=Qa.transition,n=Er;try{if(Qa.transition=null,Er=1,e)return e()}finally{Er=n,Qa.transition=r,xr=t,!(xr&6)&&Fc()}}function G5(){Aa=Mf.current,Wr(Mf)}function mu(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,f7(r)),Ln!==null)for(r=Ln.return;r!==null;){var n=r;switch(j5(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Q1();break;case 3:vd(),Wr(ua),Wr(Ds),I5();break;case 5:O5(n);break;case 4:vd();break;case 13:Wr(tn);break;case 19:Wr(tn);break;case 10:L5(n.type._context);break;case 22:case 23:G5()}r=r.return}if(Zn=e,Ln=e=xc(e.current,null),fs=Aa=t,qn=0,R0=null,W5=ux=Tu=0,la=Qh=null,su!==null){for(t=0;t<su.length;t++)if(r=su[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}su=null}return e}function AA(e,t){do{var r=Ln;try{if(P5(),g1.current=og,ig){for(var n=rn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}ig=!1}if(ju=0,Jn=Hn=rn=null,Xh=!1,L0=0,q5.current=null,r===null||r.return===null){qn=1,R0=t,Ln=null;break}e:{var a=e,i=r.return,o=r,l=t;if(t=fs,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,h=f.tag;if(!(f.mode&1)&&(h===0||h===11||h===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var d=H3(i);if(d!==null){d.flags&=-257,q3(d,i,o,a,t),d.mode&1&&z3(a,u,t),t=d,l=u;var m=t.updateQueue;if(m===null){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}else{if(!(t&1)){z3(a,u,t),Y5();break e}l=Error(tt(426))}}else if(Jr&&o.mode&1){var w=H3(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),q3(w,i,o,a,t),T5(yd(l,o));break e}}a=l=yd(l,o),qn!==4&&(qn=2),Qh===null?Qh=[a]:Qh.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=uA(a,l,t);O3(a,x);break e;case 1:o=l;var y=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(mc===null||!mc.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=fA(a,o,t);O3(a,S);break e}}a=a.return}while(a!==null)}CA(r)}catch(T){t=T,Ln===r&&r!==null&&(Ln=r=r.return);continue}break}while(!0)}function jA(){var e=lg.current;return lg.current=og,e===null?og:e}function Y5(){(qn===0||qn===3||qn===2)&&(qn=4),Zn===null||!(Tu&268435455)&&!(ux&268435455)||Gl(Zn,fs)}function fg(e,t){var r=xr;xr|=2;var n=jA();(Zn!==e||fs!==t)&&(Vo=null,mu(e,t));do try{O7();break}catch(s){AA(e,s)}while(!0);if(P5(),xr=r,lg.current=n,Ln!==null)throw Error(tt(261));return Zn=null,fs=0,qn}function O7(){for(;Ln!==null;)TA(Ln)}function I7(){for(;Ln!==null&&!lF();)TA(Ln)}function TA(e){var t=LA(e.alternate,e,Aa);e.memoizedProps=e.pendingProps,t===null?CA(e):Ln=t,q5.current=null}function CA(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=C7(r,t),r!==null){r.flags&=32767,Ln=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{qn=6,Ln=null;return}}else if(r=T7(r,t,Aa),r!==null){Ln=r;return}if(t=t.sibling,t!==null){Ln=t;return}Ln=t=e}while(t!==null);qn===0&&(qn=5)}function Qc(e,t,r){var n=Er,s=Qa.transition;try{Qa.transition=null,Er=1,M7(e,t,r,n)}finally{Qa.transition=s,Er=n}return null}function M7(e,t,r,n){do Vf();while(sc!==null);if(xr&6)throw Error(tt(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(tt(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(vF(e,a),e===Zn&&(Ln=Zn=null,fs=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Am||(Am=!0,FA(V1,function(){return Vf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Qa.transition,Qa.transition=null;var i=Er;Er=1;var o=xr;xr|=4,q5.current=null,L7(e,r),kA(r,e),s7(gy),G1=!!my,gy=my=null,e.current=r,F7(r),cF(),xr=o,Er=i,Qa.transition=a}else e.current=r;if(Am&&(Am=!1,sc=e,ug=s),a=e.pendingLanes,a===0&&(mc=null),dF(r.stateNode),da(e,wn()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(cg)throw cg=!1,e=Oy,Oy=null,e;return ug&1&&e.tag!==0&&Vf(),a=e.pendingLanes,a&1?e===Iy?Zh++:(Zh=0,Iy=e):Zh=0,Fc(),null}function Vf(){if(sc!==null){var e=u6(ug),t=Qa.transition,r=Er;try{if(Qa.transition=null,Er=16>e?16:e,sc===null)var n=!1;else{if(e=sc,sc=null,ug=0,xr&6)throw Error(tt(331));var s=xr;for(xr|=4,gt=e.current;gt!==null;){var a=gt,i=a.child;if(gt.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(gt=u;gt!==null;){var f=gt;switch(f.tag){case 0:case 11:case 15:Jh(8,f,a)}var h=f.child;if(h!==null)h.return=f,gt=h;else for(;gt!==null;){f=gt;var p=f.sibling,d=f.return;if(bA(f),f===u){gt=null;break}if(p!==null){p.return=d,gt=p;break}gt=d}}}var m=a.alternate;if(m!==null){var g=m.child;if(g!==null){m.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}gt=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,gt=i;else e:for(;gt!==null;){if(a=gt,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Jh(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,gt=x;break e}gt=a.return}}var y=e.current;for(gt=y;gt!==null;){i=gt;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,gt=b;else e:for(i=y;gt!==null;){if(o=gt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:cx(9,o)}}catch(T){un(o,o.return,T)}if(o===i){gt=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,gt=S;break e}gt=o.return}}if(xr=s,Fc(),fo&&typeof fo.onPostCommitFiberRoot=="function")try{fo.onPostCommitFiberRoot(tx,e)}catch{}n=!0}return n}finally{Er=r,Qa.transition=t}}return!1}function nN(e,t,r){t=yd(r,t),t=uA(e,t,1),e=pc(e,t,1),t=Xs(),e!==null&&(pp(e,1,t),da(e,t))}function un(e,t,r){if(e.tag===3)nN(e,e,r);else for(;t!==null;){if(t.tag===3){nN(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(mc===null||!mc.has(n))){e=yd(r,e),e=fA(t,e,1),t=pc(t,e,1),e=Xs(),t!==null&&(pp(t,1,e),da(t,e));break}}t=t.return}}function B7(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Xs(),e.pingedLanes|=e.suspendedLanes&r,Zn===e&&(fs&r)===r&&(qn===4||qn===3&&(fs&130023424)===fs&&500>wn()-V5?mu(e,0):W5|=r),da(e,t)}function PA(e,t){t===0&&(e.mode&1?(t=xm,xm<<=1,!(xm&130023424)&&(xm=4194304)):t=1);var r=Xs();e=fl(e,t),e!==null&&(pp(e,t,r),da(e,r))}function U7(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),PA(e,r)}function $7(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(tt(314))}n!==null&&n.delete(t),PA(e,r)}var LA;LA=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ua.current)ca=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ca=!1,j7(e,t,r);ca=!!(e.flags&131072)}else ca=!1,Jr&&t.flags&1048576&&O6(t,tg,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;v1(e,t),e=t.pendingProps;var s=md(t,Ds.current);Wf(t,r),s=B5(null,t,n,e,s,r);var a=U5();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,fa(n)?(a=!0,Z1(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,D5(t),s.updater=lx,t.stateNode=s,s._reactInternals=t,_y(t,n,e,r),t=jy(null,t,n,!0,a,r)):(t.tag=0,Jr&&a&&A5(t),Hs(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(v1(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=H7(n),e=gi(n,e),s){case 0:t=Ay(null,t,n,e,r);break e;case 1:t=K3(null,t,n,e,r);break e;case 11:t=W3(null,t,n,e,r);break e;case 14:t=V3(null,t,n,gi(n.type,e),r);break e}throw Error(tt(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:gi(n,s),Ay(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:gi(n,s),K3(e,t,n,s,r);case 3:e:{if(mA(t),e===null)throw Error(tt(387));n=t.pendingProps,a=t.memoizedState,s=a.element,z6(e,t),sg(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=yd(Error(tt(423)),t),t=G3(e,t,n,r,s);break e}else if(n!==s){s=yd(Error(tt(424)),t),t=G3(e,t,n,r,s);break e}else for(Ca=hc(t.stateNode.containerInfo.firstChild),La=t,Jr=!0,ki=null,r=U6(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(gd(),n===s){t=dl(e,t,r);break e}Hs(e,t,n,r)}t=t.child}return t;case 5:return H6(t),e===null&&Ny(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,xy(n,s)?i=null:a!==null&&xy(n,a)&&(t.flags|=32),pA(e,t),Hs(e,t,i,r),t.child;case 6:return e===null&&Ny(t),null;case 13:return gA(e,t,r);case 4:return R5(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=xd(t,null,n,r):Hs(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:gi(n,s),W3(e,t,n,s,r);case 7:return Hs(e,t,t.pendingProps,r),t.child;case 8:return Hs(e,t,t.pendingProps.children,r),t.child;case 12:return Hs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,Mr(rg,n._currentValue),n._currentValue=i,a!==null)if(Ri(a.value,i)){if(a.children===s.children&&!ua.current){t=dl(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=nl(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),Sy(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(tt(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Sy(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Hs(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Wf(t,r),s=ei(s),n=n(s),t.flags|=1,Hs(e,t,n,r),t.child;case 14:return n=t.type,s=gi(n,t.pendingProps),s=gi(n.type,s),V3(e,t,n,s,r);case 15:return dA(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:gi(n,s),v1(e,t),t.tag=1,fa(n)?(e=!0,Z1(t)):e=!1,Wf(t,r),cA(t,n,s),_y(t,n,s,r),jy(null,t,n,!0,e,r);case 19:return xA(e,t,r);case 22:return hA(e,t,r)}throw Error(tt(156,t.tag))};function FA(e,t){return i6(e,t)}function z7(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ja(e,t,r,n){return new z7(e,t,r,n)}function X5(e){return e=e.prototype,!(!e||!e.isReactComponent)}function H7(e){if(typeof e=="function")return X5(e)?1:0;if(e!=null){if(e=e.$$typeof,e===m5)return 11;if(e===g5)return 14}return 2}function xc(e,t){var r=e.alternate;return r===null?(r=Ja(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function b1(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")X5(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case jf:return gu(r.children,s,a,t);case p5:i=8,s|=8;break;case Yv:return e=Ja(12,r,t,s|2),e.elementType=Yv,e.lanes=a,e;case Xv:return e=Ja(13,r,t,s),e.elementType=Xv,e.lanes=a,e;case Jv:return e=Ja(19,r,t,s),e.elementType=Jv,e.lanes=a,e;case HE:return fx(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $E:i=10;break e;case zE:i=9;break e;case m5:i=11;break e;case g5:i=14;break e;case Hl:i=16,n=null;break e}throw Error(tt(130,e==null?e:typeof e,""))}return t=Ja(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function gu(e,t,r,n){return e=Ja(7,e,n,t),e.lanes=r,e}function fx(e,t,r,n){return e=Ja(22,e,n,t),e.elementType=HE,e.lanes=r,e.stateNode={isHidden:!1},e}function z2(e,t,r){return e=Ja(6,e,null,t),e.lanes=r,e}function H2(e,t,r){return t=Ja(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function q7(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=S2(0),this.expirationTimes=S2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=S2(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function J5(e,t,r,n,s,a,i,o,l){return e=new q7(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ja(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},D5(a),e}function W7(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Af,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function DA(e){if(!e)return Sc;e=e._reactInternals;e:{if($u(e)!==e||e.tag!==1)throw Error(tt(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(fa(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(tt(171))}if(e.tag===1){var r=e.type;if(fa(r))return D6(e,r,t)}return t}function RA(e,t,r,n,s,a,i,o,l){return e=J5(r,n,!0,e,s,a,i,o,l),e.context=DA(null),r=e.current,n=Xs(),s=gc(r),a=nl(n,s),a.callback=t??null,pc(r,a,s),e.current.lanes=s,pp(e,s,n),da(e,n),e}function dx(e,t,r,n){var s=t.current,a=Xs(),i=gc(s);return r=DA(r),t.context===null?t.context=r:t.pendingContext=r,t=nl(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=pc(s,t,i),e!==null&&(Li(e,s,i,a),m1(e,s,i)),i}function dg(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function sN(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Q5(e,t){sN(e,t),(e=e.alternate)&&sN(e,t)}function V7(){return null}var OA=typeof reportError=="function"?reportError:function(e){console.error(e)};function Z5(e){this._internalRoot=e}hx.prototype.render=Z5.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(tt(409));dx(e,t,null,null)};hx.prototype.unmount=Z5.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Cu(function(){dx(null,e,null,null)}),t[ul]=null}};function hx(e){this._internalRoot=e}hx.prototype.unstable_scheduleHydration=function(e){if(e){var t=h6();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Kl.length&&t!==0&&t<Kl[r].priority;r++);Kl.splice(r,0,e),r===0&&m6(e)}};function eb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function px(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function aN(){}function K7(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=dg(i);a.call(u)}}var i=RA(t,n,e,0,null,!1,!1,"",aN);return e._reactRootContainer=i,e[ul]=i.current,A0(e.nodeType===8?e.parentNode:e),Cu(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=dg(l);o.call(u)}}var l=J5(e,0,!1,null,null,!1,!1,"",aN);return e._reactRootContainer=l,e[ul]=l.current,A0(e.nodeType===8?e.parentNode:e),Cu(function(){dx(t,l,r,n)}),l}function mx(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=dg(i);o.call(l)}}dx(t,i,e,s)}else i=K7(r,t,e,s,n);return dg(i)}f6=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Dh(t.pendingLanes);r!==0&&(y5(t,r|1),da(t,wn()),!(xr&6)&&(wd=wn()+500,Fc()))}break;case 13:Cu(function(){var n=fl(e,1);if(n!==null){var s=Xs();Li(n,e,1,s)}}),Q5(e,1)}};w5=function(e){if(e.tag===13){var t=fl(e,134217728);if(t!==null){var r=Xs();Li(t,e,134217728,r)}Q5(e,134217728)}};d6=function(e){if(e.tag===13){var t=gc(e),r=fl(e,t);if(r!==null){var n=Xs();Li(r,e,t,n)}Q5(e,t)}};h6=function(){return Er};p6=function(e,t){var r=Er;try{return Er=e,t()}finally{Er=r}};oy=function(e,t,r){switch(t){case"input":if(ey(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=ax(n);if(!s)throw Error(tt(90));WE(n),ey(n,s)}}}break;case"textarea":KE(e,r);break;case"select":t=r.value,t!=null&&$f(e,!!r.multiple,t,!1)}};e6=K5;t6=Cu;var G7={usingClientEntryPoint:!1,Events:[gp,Lf,ax,QE,ZE,K5]},Nh={findFiberByHostInstance:nu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Y7={bundleType:Nh.bundleType,version:Nh.version,rendererPackageName:Nh.rendererPackageName,rendererConfig:Nh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xl.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=s6(e),e===null?null:e.stateNode},findFiberByHostInstance:Nh.findFiberByHostInstance||V7,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var jm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!jm.isDisabled&&jm.supportsFiber)try{tx=jm.inject(Y7),fo=jm}catch{}}Oa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G7;Oa.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!eb(t))throw Error(tt(200));return W7(e,t,null,r)};Oa.createRoot=function(e,t){if(!eb(e))throw Error(tt(299));var r=!1,n="",s=OA;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=J5(e,1,!1,null,null,r,!1,n,s),e[ul]=t.current,A0(e.nodeType===8?e.parentNode:e),new Z5(t)};Oa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(tt(188)):(e=Object.keys(e).join(","),Error(tt(268,e)));return e=s6(t),e=e===null?null:e.stateNode,e};Oa.flushSync=function(e){return Cu(e)};Oa.hydrate=function(e,t,r){if(!px(t))throw Error(tt(200));return mx(null,e,t,!0,r)};Oa.hydrateRoot=function(e,t,r){if(!eb(e))throw Error(tt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=OA;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=RA(t,null,e,1,r??null,s,!1,a,i),e[ul]=t.current,A0(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new hx(t)};Oa.render=function(e,t,r){if(!px(t))throw Error(tt(200));return mx(null,e,t,!1,r)};Oa.unmountComponentAtNode=function(e){if(!px(e))throw Error(tt(40));return e._reactRootContainer?(Cu(function(){mx(null,null,e,!1,function(){e._reactRootContainer=null,e[ul]=null})}),!0):!1};Oa.unstable_batchedUpdates=K5;Oa.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!px(r))throw Error(tt(200));if(e==null||e._reactInternals===void 0)throw Error(tt(38));return mx(e,t,r,!1,n)};Oa.version="18.3.1-next-f1338f8080-20240426";function IA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IA)}catch(e){console.error(e)}}IA(),IE.exports=Oa;var X7=IE.exports,iN=X7;Kv.createRoot=iN.createRoot,Kv.hydrateRoot=iN.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function O0(){return O0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O0.apply(this,arguments)}var ac;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(ac||(ac={}));const oN="popstate";function J7(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Uy("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:hg(s)}return Z7(t,r,null,e)}function kn(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function tb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Q7(){return Math.random().toString(36).substr(2,8)}function lN(e,t){return{usr:e.state,key:e.key,idx:t}}function Uy(e,t,r,n){return r===void 0&&(r=null),O0({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Td(t):t,{state:r,key:t&&t.key||n||Q7()})}function hg(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Td(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Z7(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=ac.Pop,l=null,u=f();u==null&&(u=0,i.replaceState(O0({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function h(){o=ac.Pop;let w=f(),x=w==null?null:w-u;u=w,l&&l({action:o,location:g.location,delta:x})}function p(w,x){o=ac.Push;let y=Uy(g.location,w,x);u=f()+1;let b=lN(y,u),S=g.createHref(y);try{i.pushState(b,"",S)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(S)}a&&l&&l({action:o,location:g.location,delta:1})}function d(w,x){o=ac.Replace;let y=Uy(g.location,w,x);u=f();let b=lN(y,u),S=g.createHref(y);i.replaceState(b,"",S),a&&l&&l({action:o,location:g.location,delta:0})}function m(w){let x=s.location.origin!=="null"?s.location.origin:s.location.href,y=typeof w=="string"?w:hg(w);return y=y.replace(/ $/,"%20"),kn(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let g={get action(){return o},get location(){return e(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(oN,h),l=w,()=>{s.removeEventListener(oN,h),l=null}},createHref(w){return t(s,w)},createURL:m,encodeLocation(w){let x=m(w);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:d,go(w){return i.go(w)}};return g}var cN;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(cN||(cN={}));function eD(e,t,r){return r===void 0&&(r="/"),tD(e,t,r)}function tD(e,t,r,n){let s=typeof t=="string"?Td(t):t,a=rb(s.pathname||"/",r);if(a==null)return null;let i=MA(e);rD(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=pD(a);o=fD(i[l],u)}return o}function MA(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(kn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=vc([n,l.relativePath]),f=r.concat(l);a.children&&a.children.length>0&&(kn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),MA(a.children,t,f,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:cD(u,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of BA(a.path))s(a,i,l)}),t}function BA(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=BA(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function rD(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:uD(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const nD=/^:[\w-]+$/,sD=3,aD=2,iD=1,oD=10,lD=-2,uN=e=>e==="*";function cD(e,t){let r=e.split("/"),n=r.length;return r.some(uN)&&(n+=lD),t&&(n+=aD),r.filter(s=>!uN(s)).reduce((s,a)=>s+(nD.test(a)?sD:a===""?iD:oD),n)}function uD(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function fD(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",h=dD({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},f),p=l.route;if(!h)return null;Object.assign(s,h.params),i.push({params:s,pathname:vc([a,h.pathname]),pathnameBase:yD(vc([a,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(a=vc([a,h.pathnameBase]))}return i}function dD(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=hD(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,f,h)=>{let{paramName:p,isOptional:d}=f;if(p==="*"){let g=o[h]||"";i=a.slice(0,a.length-g.length).replace(/(.)\/+$/,"$1")}const m=o[h];return d&&!m?u[p]=void 0:u[p]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function hD(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),tb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function pD(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return tb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function rb(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}const mD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gD=e=>mD.test(e);function xD(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Td(e):e,a;if(r)if(gD(r))a=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),tb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?a=fN(r.substring(1),"/"):a=fN(r,t)}else a=t;return{pathname:a,search:wD(n),hash:bD(s)}}function fN(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function q2(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function vD(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function nb(e,t){let r=vD(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function sb(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Td(e):(s=O0({},e),kn(!s.pathname||!s.pathname.includes("?"),q2("?","pathname","search",s)),kn(!s.pathname||!s.pathname.includes("#"),q2("#","pathname","hash",s)),kn(!s.search||!s.search.includes("#"),q2("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let h=t.length-1;if(!n&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),h-=1;s.pathname=p.join("/")}o=h>=0?t[h]:"/"}let l=xD(s,o),u=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||f)&&(l.pathname+="/"),l}const vc=e=>e.join("/").replace(/\/\/+/g,"/"),yD=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),wD=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,bD=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ND(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const UA=["post","put","patch","delete"];new Set(UA);const SD=["get",...UA];new Set(SD);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function I0(){return I0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},I0.apply(this,arguments)}const ab=ee.createContext(null),kD=ee.createContext(null),Dc=ee.createContext(null),gx=ee.createContext(null),vl=ee.createContext({outlet:null,matches:[],isDataRoute:!1}),$A=ee.createContext(null);function _D(e,t){let{relative:r}=t===void 0?{}:t;Cd()||kn(!1);let{basename:n,navigator:s}=ee.useContext(Dc),{hash:a,pathname:i,search:o}=HA(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:vc([n,i])),s.createHref({pathname:l,search:o,hash:a})}function Cd(){return ee.useContext(gx)!=null}function Pd(){return Cd()||kn(!1),ee.useContext(gx).location}function zA(e){ee.useContext(Dc).static||ee.useLayoutEffect(e)}function Os(){let{isDataRoute:e}=ee.useContext(vl);return e?MD():ED()}function ED(){Cd()||kn(!1);let e=ee.useContext(ab),{basename:t,future:r,navigator:n}=ee.useContext(Dc),{matches:s}=ee.useContext(vl),{pathname:a}=Pd(),i=JSON.stringify(nb(s,r.v7_relativeSplatPath)),o=ee.useRef(!1);return zA(()=>{o.current=!0}),ee.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=sb(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:vc([t,h.pathname])),(f.replace?n.replace:n.push)(h,f.state,f)},[t,n,i,a,e])}function Ld(){let{matches:e}=ee.useContext(vl),t=e[e.length-1];return t?t.params:{}}function HA(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=ee.useContext(Dc),{matches:s}=ee.useContext(vl),{pathname:a}=Pd(),i=JSON.stringify(nb(s,n.v7_relativeSplatPath));return ee.useMemo(()=>sb(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function AD(e,t){return jD(e,t)}function jD(e,t,r,n){Cd()||kn(!1);let{navigator:s}=ee.useContext(Dc),{matches:a}=ee.useContext(vl),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Pd(),f;if(t){var h;let w=typeof t=="string"?Td(t):t;l==="/"||(h=w.pathname)!=null&&h.startsWith(l)||kn(!1),f=w}else f=u;let p=f.pathname||"/",d=p;if(l!=="/"){let w=l.replace(/^\//,"").split("/");d="/"+p.replace(/^\//,"").split("/").slice(w.length).join("/")}let m=eD(e,{pathname:d}),g=FD(m&&m.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:vc([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:vc([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return t&&g?ee.createElement(gx.Provider,{value:{location:I0({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:ac.Pop}},g):g}function TD(){let e=ID(),t=ND(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return ee.createElement(ee.Fragment,null,ee.createElement("h2",null,"Unexpected Application Error!"),ee.createElement("h3",{style:{fontStyle:"italic"}},t),r?ee.createElement("pre",{style:s},r):null,null)}const CD=ee.createElement(TD,null);class PD extends ee.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?ee.createElement(vl.Provider,{value:this.props.routeContext},ee.createElement($A.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function LD(e){let{routeContext:t,match:r,children:n}=e,s=ee.useContext(ab);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),ee.createElement(vl.Provider,{value:t},n)}function FD(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(h=>h.route.id&&(o==null?void 0:o[h.route.id])!==void 0);f>=0||kn(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let h=i[f];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=f),h.route.id){let{loaderData:p,errors:d}=r,m=h.route.loader&&p[h.route.id]===void 0&&(!d||d[h.route.id]===void 0);if(h.route.lazy||m){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,h,p)=>{let d,m=!1,g=null,w=null;r&&(d=o&&h.route.id?o[h.route.id]:void 0,g=h.route.errorElement||CD,l&&(u<0&&p===0?(BD("route-fallback"),m=!0,w=null):u===p&&(m=!0,w=h.route.hydrateFallbackElement||null)));let x=t.concat(i.slice(0,p+1)),y=()=>{let b;return d?b=g:m?b=w:h.route.Component?b=ee.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=f,ee.createElement(LD,{match:h,routeContext:{outlet:f,matches:x,isDataRoute:r!=null},children:b})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?ee.createElement(PD,{location:r.location,revalidation:r.revalidation,component:g,error:d,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var qA=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(qA||{}),WA=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(WA||{});function DD(e){let t=ee.useContext(ab);return t||kn(!1),t}function RD(e){let t=ee.useContext(kD);return t||kn(!1),t}function OD(e){let t=ee.useContext(vl);return t||kn(!1),t}function VA(e){let t=OD(),r=t.matches[t.matches.length-1];return r.route.id||kn(!1),r.route.id}function ID(){var e;let t=ee.useContext($A),r=RD(),n=VA();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function MD(){let{router:e}=DD(qA.UseNavigateStable),t=VA(WA.UseNavigateStable),r=ee.useRef(!1);return zA(()=>{r.current=!0}),ee.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,I0({fromRouteId:t},a)))},[e,t])}const dN={};function BD(e,t,r){dN[e]||(dN[e]=!0)}function UD(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function $r(e){let{to:t,replace:r,state:n,relative:s}=e;Cd()||kn(!1);let{future:a,static:i}=ee.useContext(Dc),{matches:o}=ee.useContext(vl),{pathname:l}=Pd(),u=Os(),f=sb(t,nb(o,a.v7_relativeSplatPath),l,s==="path"),h=JSON.stringify(f);return ee.useEffect(()=>u(JSON.parse(h),{replace:r,state:n,relative:s}),[u,h,s,r,n]),null}function Lr(e){kn(!1)}function $D(e){let{basename:t="/",children:r=null,location:n,navigationType:s=ac.Pop,navigator:a,static:i=!1,future:o}=e;Cd()&&kn(!1);let l=t.replace(/^\/*/,"/"),u=ee.useMemo(()=>({basename:l,navigator:a,static:i,future:I0({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=Td(n));let{pathname:f="/",search:h="",hash:p="",state:d=null,key:m="default"}=n,g=ee.useMemo(()=>{let w=rb(f,l);return w==null?null:{location:{pathname:w,search:h,hash:p,state:d,key:m},navigationType:s}},[l,f,h,p,d,m,s]);return g==null?null:ee.createElement(Dc.Provider,{value:u},ee.createElement(gx.Provider,{children:r,value:g}))}function zD(e){let{children:t,location:r}=e;return AD($y(t),r)}new Promise(()=>{});function $y(e,t){t===void 0&&(t=[]);let r=[];return ee.Children.forEach(e,(n,s)=>{if(!ee.isValidElement(n))return;let a=[...t,s];if(n.type===ee.Fragment){r.push.apply(r,$y(n.props.children,a));return}n.type!==Lr&&kn(!1),!n.props.index||!n.props.children||kn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=$y(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zy(){return zy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zy.apply(this,arguments)}function HD(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function qD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function WD(e,t){return e.button===0&&(!t||t==="_self")&&!qD(e)}const VD=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],KD="6";try{window.__reactRouterVersion=KD}catch{}const GD="startTransition",hN=BL[GD];function YD(e){let{basename:t,children:r,future:n,window:s}=e,a=ee.useRef();a.current==null&&(a.current=J7({window:s,v5Compat:!0}));let i=a.current,[o,l]=ee.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},f=ee.useCallback(h=>{u&&hN?hN(()=>l(h)):l(h)},[l,u]);return ee.useLayoutEffect(()=>i.listen(f),[i,f]),ee.useEffect(()=>UD(n),[n]),ee.createElement($D,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const XD=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",JD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ji=ee.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:l,to:u,preventScrollReset:f,viewTransition:h}=t,p=HD(t,VD),{basename:d}=ee.useContext(Dc),m,g=!1;if(typeof u=="string"&&JD.test(u)&&(m=u,XD))try{let b=new URL(window.location.href),S=u.startsWith("//")?new URL(b.protocol+u):new URL(u),T=rb(S.pathname,d);S.origin===b.origin&&T!=null?u=T+S.search+S.hash:g=!0}catch{}let w=_D(u,{relative:s}),x=QD(u,{replace:i,state:o,target:l,preventScrollReset:f,relative:s,viewTransition:h});function y(b){n&&n(b),b.defaultPrevented||x(b)}return ee.createElement("a",zy({},p,{href:m||w,onClick:g||a?n:y,ref:r,target:l}))});var pN;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(pN||(pN={}));var mN;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(mN||(mN={}));function QD(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,l=Os(),u=Pd(),f=HA(e,{relative:i});return ee.useCallback(h=>{if(WD(h,r)){h.preventDefault();let p=n!==void 0?n:hg(u)===hg(f);l(e,{replace:p,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,l,f,n,s,r,e,a,i,o])}var xx=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},ZD={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Jl,i5,gE,eR=(gE=class{constructor(){lr(this,Jl,ZD);lr(this,i5,!1)}setTimeoutProvider(e){Vt(this,Jl,e)}setTimeout(e,t){return Be(this,Jl).setTimeout(e,t)}clearTimeout(e){Be(this,Jl).clearTimeout(e)}setInterval(e,t){return Be(this,Jl).setInterval(e,t)}clearInterval(e){Be(this,Jl).clearInterval(e)}},Jl=new WeakMap,i5=new WeakMap,gE),Hy=new eR;function tR(e){setTimeout(e,0)}var vx=typeof window>"u"||"Deno"in globalThis;function xi(){}function rR(e,t){return typeof e=="function"?e(t):e}function nR(e){return typeof e=="number"&&e>=0&&e!==1/0}function sR(e,t){return Math.max(e+(t||0)-Date.now(),0)}function qy(e,t){return typeof e=="function"?e(t):e}function aR(e,t){return typeof e=="function"?e(t):e}function gN(e,t){const{type:r="all",exact:n,fetchStatus:s,predicate:a,queryKey:i,stale:o}=e;if(i){if(n){if(t.queryHash!==ib(i,t.options))return!1}else if(!B0(t.queryKey,i))return!1}if(r!=="all"){const l=t.isActive();if(r==="active"&&!l||r==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||s&&s!==t.state.fetchStatus||a&&!a(t))}function xN(e,t){const{exact:r,status:n,predicate:s,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(M0(t.options.mutationKey)!==M0(a))return!1}else if(!B0(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||s&&!s(t))}function ib(e,t){return((t==null?void 0:t.queryKeyHashFn)||M0)(e)}function M0(e){return JSON.stringify(e,(t,r)=>Wy(r)?Object.keys(r).sort().reduce((n,s)=>(n[s]=r[s],n),{}):r)}function B0(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>B0(e[r],t[r])):!1}var iR=Object.prototype.hasOwnProperty;function KA(e,t){if(e===t)return e;const r=vN(e)&&vN(t);if(!r&&!(Wy(e)&&Wy(t)))return t;const s=(r?e:Object.keys(e)).length,a=r?t:Object.keys(t),i=a.length,o=r?new Array(i):{};let l=0;for(let u=0;u<i;u++){const f=r?u:a[u],h=e[f],p=t[f];if(h===p){o[f]=h,(r?u<s:iR.call(e,f))&&l++;continue}if(h===null||p===null||typeof h!="object"||typeof p!="object"){o[f]=p;continue}const d=KA(h,p);o[f]=d,d===h&&l++}return s===i&&l===s?e:o}function vN(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Wy(e){if(!yN(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!yN(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function yN(e){return Object.prototype.toString.call(e)==="[object Object]"}function oR(e){return new Promise(t=>{Hy.setTimeout(t,e)})}function lR(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?KA(e,t):t}function cR(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function uR(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var ob=Symbol();function GA(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===ob?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var cu,Ql,id,xE,fR=(xE=class extends xx{constructor(){super();lr(this,cu);lr(this,Ql);lr(this,id);Vt(this,id,t=>{if(!vx&&window.addEventListener){const r=()=>t();return window.addEventListener("visibilitychange",r,!1),()=>{window.removeEventListener("visibilitychange",r)}}})}onSubscribe(){Be(this,Ql)||this.setEventListener(Be(this,id))}onUnsubscribe(){var t;this.hasListeners()||((t=Be(this,Ql))==null||t.call(this),Vt(this,Ql,void 0))}setEventListener(t){var r;Vt(this,id,t),(r=Be(this,Ql))==null||r.call(this),Vt(this,Ql,t(n=>{typeof n=="boolean"?this.setFocused(n):this.onFocus()}))}setFocused(t){Be(this,cu)!==t&&(Vt(this,cu,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(r=>{r(t)})}isFocused(){var t;return typeof Be(this,cu)=="boolean"?Be(this,cu):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},cu=new WeakMap,Ql=new WeakMap,id=new WeakMap,xE),YA=new fR;function dR(){let e,t;const r=new Promise((s,a)=>{e=s,t=a});r.status="pending",r.catch(()=>{});function n(s){Object.assign(r,s),delete r.resolve,delete r.reject}return r.resolve=s=>{n({status:"fulfilled",value:s}),e(s)},r.reject=s=>{n({status:"rejected",reason:s}),t(s)},r}var hR=tR;function pR(){let e=[],t=0,r=o=>{o()},n=o=>{o()},s=hR;const a=o=>{t?e.push(o):s(()=>{r(o)})},i=()=>{const o=e;e=[],o.length&&s(()=>{n(()=>{o.forEach(l=>{r(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||i()}return l},batchCalls:o=>(...l)=>{a(()=>{o(...l)})},schedule:a,setNotifyFunction:o=>{r=o},setBatchNotifyFunction:o=>{n=o},setScheduler:o=>{s=o}}}var Ws=pR(),od,Zl,ld,vE,mR=(vE=class extends xx{constructor(){super();lr(this,od,!0);lr(this,Zl);lr(this,ld);Vt(this,ld,t=>{if(!vx&&window.addEventListener){const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}}})}onSubscribe(){Be(this,Zl)||this.setEventListener(Be(this,ld))}onUnsubscribe(){var t;this.hasListeners()||((t=Be(this,Zl))==null||t.call(this),Vt(this,Zl,void 0))}setEventListener(t){var r;Vt(this,ld,t),(r=Be(this,Zl))==null||r.call(this),Vt(this,Zl,t(this.setOnline.bind(this)))}setOnline(t){Be(this,od)!==t&&(Vt(this,od,t),this.listeners.forEach(n=>{n(t)}))}isOnline(){return Be(this,od)}},od=new WeakMap,Zl=new WeakMap,ld=new WeakMap,vE),pg=new mR;function gR(e){return Math.min(1e3*2**e,3e4)}function XA(e){return(e??"online")==="online"?pg.isOnline():!0}var Vy=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function JA(e){let t=!1,r=0,n;const s=dR(),a=()=>s.status!=="pending",i=g=>{var w;if(!a()){const x=new Vy(g);p(x),(w=e.onCancel)==null||w.call(e,x)}},o=()=>{t=!0},l=()=>{t=!1},u=()=>YA.isFocused()&&(e.networkMode==="always"||pg.isOnline())&&e.canRun(),f=()=>XA(e.networkMode)&&e.canRun(),h=g=>{a()||(n==null||n(),s.resolve(g))},p=g=>{a()||(n==null||n(),s.reject(g))},d=()=>new Promise(g=>{var w;n=x=>{(a()||u())&&g(x)},(w=e.onPause)==null||w.call(e)}).then(()=>{var g;n=void 0,a()||(g=e.onContinue)==null||g.call(e)}),m=()=>{if(a())return;let g;const w=r===0?e.initialPromise:void 0;try{g=w??e.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(h).catch(x=>{var L;if(a())return;const y=e.retry??(vx?0:3),b=e.retryDelay??gR,S=typeof b=="function"?b(r,x):b,T=y===!0||typeof y=="number"&&r<y||typeof y=="function"&&y(r,x);if(t||!T){p(x);return}r++,(L=e.onFail)==null||L.call(e,r,x),oR(S).then(()=>u()?void 0:d()).then(()=>{t?p(x):m()})})};return{promise:s,status:()=>s.status,cancel:i,continue:()=>(n==null||n(),s),cancelRetry:o,continueRetry:l,canStart:f,start:()=>(f()?m():d().then(m),s)}}var uu,yE,QA=(yE=class{constructor(){lr(this,uu)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),nR(this.gcTime)&&Vt(this,uu,Hy.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(vx?1/0:5*60*1e3))}clearGcTimeout(){Be(this,uu)&&(Hy.clearTimeout(Be(this,uu)),Vt(this,uu,void 0))}},uu=new WeakMap,yE),fu,cd,Ka,du,Yn,up,hu,vi,Wo,wE,xR=(wE=class extends QA{constructor(t){super();lr(this,vi);lr(this,fu);lr(this,cd);lr(this,Ka);lr(this,du);lr(this,Yn);lr(this,up);lr(this,hu);Vt(this,hu,!1),Vt(this,up,t.defaultOptions),this.setOptions(t.options),this.observers=[],Vt(this,du,t.client),Vt(this,Ka,Be(this,du).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Vt(this,fu,bN(this.options)),this.state=t.state??Be(this,fu),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Be(this,Yn))==null?void 0:t.promise}setOptions(t){if(this.options={...Be(this,up),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=bN(this.options);r.data!==void 0&&(this.setState(wN(r.data,r.dataUpdatedAt)),Vt(this,fu,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Be(this,Ka).remove(this)}setData(t,r){const n=lR(this.state.data,t,this.options);return vs(this,vi,Wo).call(this,{data:n,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),n}setState(t,r){vs(this,vi,Wo).call(this,{type:"setState",state:t,setStateOptions:r})}cancel(t){var n,s;const r=(n=Be(this,Yn))==null?void 0:n.promise;return(s=Be(this,Yn))==null||s.cancel(t),r?r.then(xi).catch(xi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Be(this,fu))}isActive(){return this.observers.some(t=>aR(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===ob||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>qy(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!sR(this.state.dataUpdatedAt,t)}onFocus(){var r;const t=this.observers.find(n=>n.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(r=Be(this,Yn))==null||r.continue()}onOnline(){var r;const t=this.observers.find(n=>n.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(r=Be(this,Yn))==null||r.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Be(this,Ka).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(r=>r!==t),this.observers.length||(Be(this,Yn)&&(Be(this,hu)?Be(this,Yn).cancel({revert:!0}):Be(this,Yn).cancelRetry()),this.scheduleGc()),Be(this,Ka).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vs(this,vi,Wo).call(this,{type:"invalidate"})}async fetch(t,r){var l,u,f,h,p,d,m,g,w,x,y,b;if(this.state.fetchStatus!=="idle"&&((l=Be(this,Yn))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Be(this,Yn))return Be(this,Yn).continueRetry(),Be(this,Yn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const S=this.observers.find(T=>T.options.queryFn);S&&this.setOptions(S.options)}const n=new AbortController,s=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(Vt(this,hu,!0),n.signal)})},a=()=>{const S=GA(this.options,r),L=(()=>{const A={client:Be(this,du),queryKey:this.queryKey,meta:this.meta};return s(A),A})();return Vt(this,hu,!1),this.options.persister?this.options.persister(S,L,this):S(L)},o=(()=>{const S={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Be(this,du),state:this.state,fetchFn:a};return s(S),S})();(u=this.options.behavior)==null||u.onFetch(o,this),Vt(this,cd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((f=o.fetchOptions)==null?void 0:f.meta))&&vs(this,vi,Wo).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),Vt(this,Yn,JA({initialPromise:r==null?void 0:r.initialPromise,fn:o.fetchFn,onCancel:S=>{S instanceof Vy&&S.revert&&this.setState({...Be(this,cd),fetchStatus:"idle"}),n.abort()},onFail:(S,T)=>{vs(this,vi,Wo).call(this,{type:"failed",failureCount:S,error:T})},onPause:()=>{vs(this,vi,Wo).call(this,{type:"pause"})},onContinue:()=>{vs(this,vi,Wo).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const S=await Be(this,Yn).start();if(S===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(S),(d=(p=Be(this,Ka).config).onSuccess)==null||d.call(p,S,this),(g=(m=Be(this,Ka).config).onSettled)==null||g.call(m,S,this.state.error,this),S}catch(S){if(S instanceof Vy){if(S.silent)return Be(this,Yn).promise;if(S.revert){if(this.state.data===void 0)throw S;return this.state.data}}throw vs(this,vi,Wo).call(this,{type:"error",error:S}),(x=(w=Be(this,Ka).config).onError)==null||x.call(w,S,this),(b=(y=Be(this,Ka).config).onSettled)==null||b.call(y,this.state.data,S,this),S}finally{this.scheduleGc()}}},fu=new WeakMap,cd=new WeakMap,Ka=new WeakMap,du=new WeakMap,Yn=new WeakMap,up=new WeakMap,hu=new WeakMap,vi=new WeakSet,Wo=function(t){const r=n=>{switch(t.type){case"failed":return{...n,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,...vR(n.data,this.options),fetchMeta:t.meta??null};case"success":const s={...n,...wN(t.data,t.dataUpdatedAt),dataUpdateCount:n.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Vt(this,cd,t.manual?s:void 0),s;case"error":const a=t.error;return{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...t.state}}};this.state=r(this.state),Ws.batch(()=>{this.observers.forEach(n=>{n.onQueryUpdate()}),Be(this,Ka).notify({query:this,type:"updated",action:t})})},wE);function vR(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:XA(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function wN(e,t){return{data:e,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function bN(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function NN(e){return{onFetch:(t,r)=>{var f,h,p,d,m;const n=t.options,s=(p=(h=(f=t.fetchOptions)==null?void 0:f.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,a=((d=t.state.data)==null?void 0:d.pages)||[],i=((m=t.state.data)==null?void 0:m.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let g=!1;const w=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},x=GA(t.options,t.fetchOptions),y=async(b,S,T)=>{if(g)return Promise.reject();if(S==null&&b.pages.length)return Promise.resolve(b);const A=(()=>{const E={client:t.client,queryKey:t.queryKey,pageParam:S,direction:T?"backward":"forward",meta:t.options.meta};return w(E),E})(),D=await x(A),{maxPages:C}=t.options,O=T?uR:cR;return{pages:O(b.pages,D,C),pageParams:O(b.pageParams,S,C)}};if(s&&a.length){const b=s==="backward",S=b?yR:SN,T={pages:a,pageParams:i},L=S(n,T);o=await y(T,L,b)}else{const b=e??a.length;do{const S=l===0?i[0]??n.initialPageParam:SN(n,o);if(l>0&&S==null)break;o=await y(o,S),l++}while(l<b)}return o};t.options.persister?t.fetchFn=()=>{var g,w;return(w=(g=t.options).persister)==null?void 0:w.call(g,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r)}:t.fetchFn=u}}}function SN(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function yR(e,{pages:t,pageParams:r}){var n;return t.length>0?(n=e.getPreviousPageParam)==null?void 0:n.call(e,t[0],t,r[0],r):void 0}var fp,no,zs,pu,so,$l,bE,wR=(bE=class extends QA{constructor(t){super();lr(this,so);lr(this,fp);lr(this,no);lr(this,zs);lr(this,pu);Vt(this,fp,t.client),this.mutationId=t.mutationId,Vt(this,zs,t.mutationCache),Vt(this,no,[]),this.state=t.state||bR(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Be(this,no).includes(t)||(Be(this,no).push(t),this.clearGcTimeout(),Be(this,zs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Vt(this,no,Be(this,no).filter(r=>r!==t)),this.scheduleGc(),Be(this,zs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Be(this,no).length||(this.state.status==="pending"?this.scheduleGc():Be(this,zs).remove(this))}continue(){var t;return((t=Be(this,pu))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,u,f,h,p,d,m,g,w,x,y,b,S,T,L,A,D,C;const r=()=>{vs(this,so,$l).call(this,{type:"continue"})},n={client:Be(this,fp),meta:this.options.meta,mutationKey:this.options.mutationKey};Vt(this,pu,JA({fn:()=>this.options.mutationFn?this.options.mutationFn(t,n):Promise.reject(new Error("No mutationFn found")),onFail:(O,E)=>{vs(this,so,$l).call(this,{type:"failed",failureCount:O,error:E})},onPause:()=>{vs(this,so,$l).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Be(this,zs).canRun(this)}));const s=this.state.status==="pending",a=!Be(this,pu).canStart();try{if(s)r();else{vs(this,so,$l).call(this,{type:"pending",variables:t,isPaused:a}),await((o=(i=Be(this,zs).config).onMutate)==null?void 0:o.call(i,t,this,n));const E=await((u=(l=this.options).onMutate)==null?void 0:u.call(l,t,n));E!==this.state.context&&vs(this,so,$l).call(this,{type:"pending",context:E,variables:t,isPaused:a})}const O=await Be(this,pu).start();return await((h=(f=Be(this,zs).config).onSuccess)==null?void 0:h.call(f,O,t,this.state.context,this,n)),await((d=(p=this.options).onSuccess)==null?void 0:d.call(p,O,t,this.state.context,n)),await((g=(m=Be(this,zs).config).onSettled)==null?void 0:g.call(m,O,null,this.state.variables,this.state.context,this,n)),await((x=(w=this.options).onSettled)==null?void 0:x.call(w,O,null,t,this.state.context,n)),vs(this,so,$l).call(this,{type:"success",data:O}),O}catch(O){try{throw await((b=(y=Be(this,zs).config).onError)==null?void 0:b.call(y,O,t,this.state.context,this,n)),await((T=(S=this.options).onError)==null?void 0:T.call(S,O,t,this.state.context,n)),await((A=(L=Be(this,zs).config).onSettled)==null?void 0:A.call(L,void 0,O,this.state.variables,this.state.context,this,n)),await((C=(D=this.options).onSettled)==null?void 0:C.call(D,void 0,O,t,this.state.context,n)),O}finally{vs(this,so,$l).call(this,{type:"error",error:O})}}finally{Be(this,zs).runNext(this)}}},fp=new WeakMap,no=new WeakMap,zs=new WeakMap,pu=new WeakMap,so=new WeakSet,$l=function(t){const r=n=>{switch(t.type){case"failed":return{...n,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...n,isPaused:!0};case"continue":return{...n,isPaused:!1};case"pending":return{...n,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...n,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...n,data:void 0,error:t.error,failureCount:n.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Ws.batch(()=>{Be(this,no).forEach(n=>{n.onMutationUpdate(t)}),Be(this,zs).notify({mutation:this,type:"updated",action:t})})},bE);function bR(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Xo,yi,dp,NE,NR=(NE=class extends xx{constructor(t={}){super();lr(this,Xo);lr(this,yi);lr(this,dp);this.config=t,Vt(this,Xo,new Set),Vt(this,yi,new Map),Vt(this,dp,0)}build(t,r,n){const s=new wR({client:t,mutationCache:this,mutationId:++fm(this,dp)._,options:t.defaultMutationOptions(r),state:n});return this.add(s),s}add(t){Be(this,Xo).add(t);const r=Tm(t);if(typeof r=="string"){const n=Be(this,yi).get(r);n?n.push(t):Be(this,yi).set(r,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Be(this,Xo).delete(t)){const r=Tm(t);if(typeof r=="string"){const n=Be(this,yi).get(r);if(n)if(n.length>1){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}else n[0]===t&&Be(this,yi).delete(r)}}this.notify({type:"removed",mutation:t})}canRun(t){const r=Tm(t);if(typeof r=="string"){const n=Be(this,yi).get(r),s=n==null?void 0:n.find(a=>a.state.status==="pending");return!s||s===t}else return!0}runNext(t){var n;const r=Tm(t);if(typeof r=="string"){const s=(n=Be(this,yi).get(r))==null?void 0:n.find(a=>a!==t&&a.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Ws.batch(()=>{Be(this,Xo).forEach(t=>{this.notify({type:"removed",mutation:t})}),Be(this,Xo).clear(),Be(this,yi).clear()})}getAll(){return Array.from(Be(this,Xo))}find(t){const r={exact:!0,...t};return this.getAll().find(n=>xN(r,n))}findAll(t={}){return this.getAll().filter(r=>xN(t,r))}notify(t){Ws.batch(()=>{this.listeners.forEach(r=>{r(t)})})}resumePausedMutations(){const t=this.getAll().filter(r=>r.state.isPaused);return Ws.batch(()=>Promise.all(t.map(r=>r.continue().catch(xi))))}},Xo=new WeakMap,yi=new WeakMap,dp=new WeakMap,NE);function Tm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var ao,SE,SR=(SE=class extends xx{constructor(t={}){super();lr(this,ao);this.config=t,Vt(this,ao,new Map)}build(t,r,n){const s=r.queryKey,a=r.queryHash??ib(s,r);let i=this.get(a);return i||(i=new xR({client:t,queryKey:s,queryHash:a,options:t.defaultQueryOptions(r),state:n,defaultOptions:t.getQueryDefaults(s)}),this.add(i)),i}add(t){Be(this,ao).has(t.queryHash)||(Be(this,ao).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const r=Be(this,ao).get(t.queryHash);r&&(t.destroy(),r===t&&Be(this,ao).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ws.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Be(this,ao).get(t)}getAll(){return[...Be(this,ao).values()]}find(t){const r={exact:!0,...t};return this.getAll().find(n=>gN(r,n))}findAll(t={}){const r=this.getAll();return Object.keys(t).length>0?r.filter(n=>gN(t,n)):r}notify(t){Ws.batch(()=>{this.listeners.forEach(r=>{r(t)})})}onFocus(){Ws.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ws.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ao=new WeakMap,SE),ln,ec,tc,ud,fd,rc,dd,hd,kE,kR=(kE=class{constructor(e={}){lr(this,ln);lr(this,ec);lr(this,tc);lr(this,ud);lr(this,fd);lr(this,rc);lr(this,dd);lr(this,hd);Vt(this,ln,e.queryCache||new SR),Vt(this,ec,e.mutationCache||new NR),Vt(this,tc,e.defaultOptions||{}),Vt(this,ud,new Map),Vt(this,fd,new Map),Vt(this,rc,0)}mount(){fm(this,rc)._++,Be(this,rc)===1&&(Vt(this,dd,YA.subscribe(async e=>{e&&(await this.resumePausedMutations(),Be(this,ln).onFocus())})),Vt(this,hd,pg.subscribe(async e=>{e&&(await this.resumePausedMutations(),Be(this,ln).onOnline())})))}unmount(){var e,t;fm(this,rc)._--,Be(this,rc)===0&&((e=Be(this,dd))==null||e.call(this),Vt(this,dd,void 0),(t=Be(this,hd))==null||t.call(this),Vt(this,hd,void 0))}isFetching(e){return Be(this,ln).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Be(this,ec).findAll({...e,status:"pending"}).length}getQueryData(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Be(this,ln).get(t.queryHash))==null?void 0:r.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=Be(this,ln).build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(qy(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return Be(this,ln).findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),s=Be(this,ln).get(n.queryHash),a=s==null?void 0:s.state.data,i=rR(t,a);if(i!==void 0)return Be(this,ln).build(this,n).setData(i,{...r,manual:!0})}setQueriesData(e,t,r){return Ws.batch(()=>Be(this,ln).findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){var r;const t=this.defaultQueryOptions({queryKey:e});return(r=Be(this,ln).get(t.queryHash))==null?void 0:r.state}removeQueries(e){const t=Be(this,ln);Ws.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=Be(this,ln);return Ws.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Ws.batch(()=>Be(this,ln).findAll(e).map(s=>s.cancel(r)));return Promise.all(n).then(xi).catch(xi)}invalidateQueries(e,t={}){return Ws.batch(()=>(Be(this,ln).findAll(e).forEach(r=>{r.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Ws.batch(()=>Be(this,ln).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let a=s.fetch(void 0,r);return r.throwOnError||(a=a.catch(xi)),s.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(xi)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=Be(this,ln).build(this,t);return r.isStaleByTime(qy(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(xi).catch(xi)}fetchInfiniteQuery(e){return e.behavior=NN(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(xi).catch(xi)}ensureInfiniteQueryData(e){return e.behavior=NN(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return pg.isOnline()?Be(this,ec).resumePausedMutations():Promise.resolve()}getQueryCache(){return Be(this,ln)}getMutationCache(){return Be(this,ec)}getDefaultOptions(){return Be(this,tc)}setDefaultOptions(e){Vt(this,tc,e)}setQueryDefaults(e,t){Be(this,ud).set(M0(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Be(this,ud).values()],r={};return t.forEach(n=>{B0(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){Be(this,fd).set(M0(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Be(this,fd).values()],r={};return t.forEach(n=>{B0(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Be(this,tc).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=ib(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===ob&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Be(this,tc).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Be(this,ln).clear(),Be(this,ec).clear()}},ln=new WeakMap,ec=new WeakMap,tc=new WeakMap,ud=new WeakMap,fd=new WeakMap,rc=new WeakMap,dd=new WeakMap,hd=new WeakMap,kE),_R=ee.createContext(void 0),ER=({client:e,children:t})=>(ee.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),c.jsx(_R.Provider,{value:e,children:t}));function AR(){if(console&&console.warn){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];xu(t[0])&&(t[0]=`react-i18next:: ${t[0]}`),console.warn(...t)}}const kN={};function Ky(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];xu(t[0])&&kN[t[0]]||(xu(t[0])&&(kN[t[0]]=new Date),AR(...t))}const ZA=(e,t)=>()=>{if(e.isInitialized)t();else{const r=()=>{setTimeout(()=>{e.off("initialized",r)},0),t()};e.on("initialized",r)}},_N=(e,t,r)=>{e.loadNamespaces(t,ZA(e,r))},EN=(e,t,r,n)=>{xu(r)&&(r=[r]),r.forEach(s=>{e.options.ns.indexOf(s)<0&&e.options.ns.push(s)}),e.loadLanguages(t,ZA(e,n))},jR=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=t.languages[0],s=t.options?t.options.fallbackLng:!1,a=t.languages[t.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,l)=>{const u=t.services.backendConnector.state[`${o}|${l}`];return u===-1||u===2};return r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!i(t.isLanguageChangingTo,e)?!1:!!(t.hasResourceBundle(n,e)||!t.services.backendConnector.backend||t.options.resources&&!t.options.partialBundledLanguages||i(n,e)&&(!s||i(a,e)))},TR=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!t.languages||!t.languages.length?(Ky("i18n.languages were undefined or empty",t.languages),!0):t.options.ignoreJSONStructure!==void 0?t.hasLoadedNamespace(e,{lng:r.lng,precheck:(s,a)=>{if(r.bindI18n&&r.bindI18n.indexOf("languageChanging")>-1&&s.services.backendConnector.backend&&s.isLanguageChangingTo&&!a(s.isLanguageChangingTo,e))return!1}}):jR(e,t,r)},xu=e=>typeof e=="string",CR=e=>typeof e=="object"&&e!==null,PR=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,LR={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},FR=e=>LR[e],DR=e=>e.replace(PR,FR);let Gy={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:DR};const RR=function(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Gy={...Gy,...e}},OR=()=>Gy;let ej;const IR=e=>{ej=e},MR=()=>ej,BR={type:"3rdParty",init(e){RR(e.options.react),IR(e)}},UR=ee.createContext();class $R{constructor(){Pt(this,"getUsedNamespaces",()=>Object.keys(this.usedNamespaces));this.usedNamespaces={}}addUsedNamespaces(t){t.forEach(r=>{this.usedNamespaces[r]||(this.usedNamespaces[r]=!0)})}}const zR=(e,t)=>{const r=ee.useRef();return ee.useEffect(()=>{r.current=e},[e,t]),r.current},tj=(e,t,r,n)=>e.getFixedT(t,r,n),HR=(e,t,r,n)=>ee.useCallback(tj(e,t,r,n),[e,t,r,n]),Ii=function(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:r}=t,{i18n:n,defaultNS:s}=ee.useContext(UR)||{},a=r||n||MR();if(a&&!a.reportNamespaces&&(a.reportNamespaces=new $R),!a){Ky("You will need to pass in an i18next instance by using initReactI18next");const S=(L,A)=>xu(A)?A:CR(A)&&xu(A.defaultValue)?A.defaultValue:Array.isArray(L)?L[L.length-1]:L,T=[S,{},!1];return T.t=S,T.i18n={},T.ready=!1,T}a.options.react&&a.options.react.wait!==void 0&&Ky("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const i={...OR(),...a.options.react,...t},{useSuspense:o,keyPrefix:l}=i;let u=s||a.options&&a.options.defaultNS;u=xu(u)?[u]:u||["translation"],a.reportNamespaces.addUsedNamespaces&&a.reportNamespaces.addUsedNamespaces(u);const f=(a.isInitialized||a.initializedStoreOnce)&&u.every(S=>TR(S,a,i)),h=HR(a,t.lng||null,i.nsMode==="fallback"?u:u[0],l),p=()=>h,d=()=>tj(a,t.lng||null,i.nsMode==="fallback"?u:u[0],l),[m,g]=ee.useState(p);let w=u.join();t.lng&&(w=`${t.lng}${w}`);const x=zR(w),y=ee.useRef(!0);ee.useEffect(()=>{const{bindI18n:S,bindI18nStore:T}=i;y.current=!0,!f&&!o&&(t.lng?EN(a,t.lng,u,()=>{y.current&&g(d)}):_N(a,u,()=>{y.current&&g(d)})),f&&x&&x!==w&&y.current&&g(d);const L=()=>{y.current&&g(d)};return S&&a&&a.on(S,L),T&&a&&a.store.on(T,L),()=>{y.current=!1,S&&a&&S.split(" ").forEach(A=>a.off(A,L)),T&&a&&T.split(" ").forEach(A=>a.store.off(A,L))}},[a,w]),ee.useEffect(()=>{y.current&&f&&g(p)},[a,l,f]);const b=[m,a,f];if(b.t=m,b.i18n=a,b.ready=f,f||!f&&!o)return b;throw new Promise(S=>{t.lng?EN(a,t.lng,u,()=>S()):_N(a,u,()=>S())})},qR={},AN=e=>{let t;const r=new Set,n=(f,h)=>{const p=typeof f=="function"?f(t):f;if(!Object.is(p,t)){const d=t;t=h??(typeof p!="object"||p===null)?p:Object.assign({},t,p),r.forEach(m=>m(t,d))}},s=()=>t,l={setState:n,getState:s,getInitialState:()=>u,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(qR?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},u=t=e(n,s,l);return l},WR=e=>e?AN(e):AN;var rj={exports:{}},nj={},sj={exports:{}},aj={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bd=ee;function VR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var KR=typeof Object.is=="function"?Object.is:VR,GR=bd.useState,YR=bd.useEffect,XR=bd.useLayoutEffect,JR=bd.useDebugValue;function QR(e,t){var r=t(),n=GR({inst:{value:r,getSnapshot:t}}),s=n[0].inst,a=n[1];return XR(function(){s.value=r,s.getSnapshot=t,W2(s)&&a({inst:s})},[e,r,t]),YR(function(){return W2(s)&&a({inst:s}),e(function(){W2(s)&&a({inst:s})})},[e]),JR(r),r}function W2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!KR(e,r)}catch{return!0}}function ZR(e,t){return t()}var eO=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ZR:QR;aj.useSyncExternalStore=bd.useSyncExternalStore!==void 0?bd.useSyncExternalStore:eO;sj.exports=aj;var tO=sj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yx=ee,rO=tO;function nO(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sO=typeof Object.is=="function"?Object.is:nO,aO=rO.useSyncExternalStore,iO=yx.useRef,oO=yx.useEffect,lO=yx.useMemo,cO=yx.useDebugValue;nj.useSyncExternalStoreWithSelector=function(e,t,r,n,s){var a=iO(null);if(a.current===null){var i={hasValue:!1,value:null};a.current=i}else i=a.current;a=lO(function(){function l(d){if(!u){if(u=!0,f=d,d=n(d),s!==void 0&&i.hasValue){var m=i.value;if(s(m,d))return h=m}return h=d}if(m=h,sO(f,d))return m;var g=n(d);return s!==void 0&&s(m,g)?(f=d,m):(f=d,h=g)}var u=!1,f,h,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,s]);var o=aO(e,a[0],a[1]);return oO(function(){i.hasValue=!0,i.value=o},[o]),cO(o),o};rj.exports=nj;var uO=rj.exports;const fO=_E(uO),ij={},{useDebugValue:dO}=Vl,{useSyncExternalStoreWithSelector:hO}=fO;let jN=!1;const pO=e=>e;function mO(e,t=pO,r){(ij?"production":void 0)!=="production"&&r&&!jN&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),jN=!0);const n=hO(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return dO(n),n}const TN=e=>{(ij?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?WR(e):e,r=(n,s)=>mO(t,n,s);return Object.assign(r,t),r},lb=e=>e?TN(e):TN,gO={};function xO(e,t){let r;try{r=e()}catch{return}return{getItem:s=>{var a;const i=l=>l===null?null:JSON.parse(l,void 0),o=(a=r.getItem(s))!=null?a:null;return o instanceof Promise?o.then(i):i(o)},setItem:(s,a)=>r.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>r.removeItem(s)}}const U0=e=>t=>{try{const r=e(t);return r instanceof Promise?r:{then(n){return U0(n)(r)},catch(n){return this}}}catch(r){return{then(n){return this},catch(n){return U0(n)(r)}}}},vO=(e,t)=>(r,n,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:w=>w,version:0,merge:(w,x)=>({...x,...w}),...t},i=!1;const o=new Set,l=new Set;let u;try{u=a.getStorage()}catch{}if(!u)return e((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...w)},n,s);const f=U0(a.serialize),h=()=>{const w=a.partialize({...n()});let x;const y=f({state:w,version:a.version}).then(b=>u.setItem(a.name,b)).catch(b=>{x=b});if(x)throw x;return y},p=s.setState;s.setState=(w,x)=>{p(w,x),h()};const d=e((...w)=>{r(...w),h()},n,s);let m;const g=()=>{var w;if(!u)return;i=!1,o.forEach(y=>y(n()));const x=((w=a.onRehydrateStorage)==null?void 0:w.call(a,n()))||void 0;return U0(u.getItem.bind(u))(a.name).then(y=>{if(y)return a.deserialize(y)}).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate)return a.migrate(y.state,y.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return y.state}).then(y=>{var b;return m=a.merge(y,(b=n())!=null?b:d),r(m,!0),h()}).then(()=>{x==null||x(m,void 0),i=!0,l.forEach(y=>y(m))}).catch(y=>{x==null||x(void 0,y)})};return s.persist={setOptions:w=>{a={...a,...w},w.getStorage&&(u=w.getStorage())},clearStorage:()=>{u==null||u.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>g(),hasHydrated:()=>i,onHydrate:w=>(o.add(w),()=>{o.delete(w)}),onFinishHydration:w=>(l.add(w),()=>{l.delete(w)})},g(),m||d},yO=(e,t)=>(r,n,s)=>{let a={storage:xO(()=>localStorage),partialize:g=>g,version:0,merge:(g,w)=>({...w,...g}),...t},i=!1;const o=new Set,l=new Set;let u=a.storage;if(!u)return e((...g)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),r(...g)},n,s);const f=()=>{const g=a.partialize({...n()});return u.setItem(a.name,{state:g,version:a.version})},h=s.setState;s.setState=(g,w)=>{h(g,w),f()};const p=e((...g)=>{r(...g),f()},n,s);s.getInitialState=()=>p;let d;const m=()=>{var g,w;if(!u)return;i=!1,o.forEach(y=>{var b;return y((b=n())!=null?b:p)});const x=((w=a.onRehydrateStorage)==null?void 0:w.call(a,(g=n())!=null?g:p))||void 0;return U0(u.getItem.bind(u))(a.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==a.version){if(a.migrate)return[!0,a.migrate(y.state,y.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var b;const[S,T]=y;if(d=a.merge(T,(b=n())!=null?b:p),r(d,!0),S)return f()}).then(()=>{x==null||x(d,void 0),d=n(),i=!0,l.forEach(y=>y(d))}).catch(y=>{x==null||x(void 0,y)})};return s.persist={setOptions:g=>{a={...a,...g},g.storage&&(u=g.storage)},clearStorage:()=>{u==null||u.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>m(),hasHydrated:()=>i,onHydrate:g=>(o.add(g),()=>{o.delete(g)}),onFinishHydration:g=>(l.add(g),()=>{l.delete(g)})},a.skipHydration||m(),d||p},wO=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((gO?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),vO(e,t)):yO(e,t),bO=wO;function oj(e,t){return function(){return e.apply(t,arguments)}}const{toString:NO}=Object.prototype,{getPrototypeOf:cb}=Object,{iterator:wx,toStringTag:lj}=Symbol,bx=(e=>t=>{const r=NO.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Mi=e=>(e=e.toLowerCase(),t=>bx(t)===e),Nx=e=>t=>typeof t===e,{isArray:Fd}=Array,Nd=Nx("undefined");function vp(e){return e!==null&&!Nd(e)&&e.constructor!==null&&!Nd(e.constructor)&&ha(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const cj=Mi("ArrayBuffer");function SO(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&cj(e.buffer),t}const kO=Nx("string"),ha=Nx("function"),uj=Nx("number"),yp=e=>e!==null&&typeof e=="object",_O=e=>e===!0||e===!1,N1=e=>{if(bx(e)!=="object")return!1;const t=cb(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(lj in e)&&!(wx in e)},EO=e=>{if(!yp(e)||vp(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},AO=Mi("Date"),jO=Mi("File"),TO=Mi("Blob"),CO=Mi("FileList"),PO=e=>yp(e)&&ha(e.pipe),LO=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ha(e.append)&&((t=bx(e))==="formdata"||t==="object"&&ha(e.toString)&&e.toString()==="[object FormData]"))},FO=Mi("URLSearchParams"),[DO,RO,OO,IO]=["ReadableStream","Request","Response","Headers"].map(Mi),MO=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wp(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),Fd(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(vp(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function fj(e,t){if(vp(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const iu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,dj=e=>!Nd(e)&&e!==iu;function Yy(){const{caseless:e,skipUndefined:t}=dj(this)&&this||{},r={},n=(s,a)=>{const i=e&&fj(r,a)||a;N1(r[i])&&N1(s)?r[i]=Yy(r[i],s):N1(s)?r[i]=Yy({},s):Fd(s)?r[i]=s.slice():(!t||!Nd(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&wp(arguments[s],n);return r}const BO=(e,t,r,{allOwnKeys:n}={})=>(wp(t,(s,a)=>{r&&ha(s)?e[a]=oj(s,r):e[a]=s},{allOwnKeys:n}),e),UO=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),$O=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},zO=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&cb(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},HO=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},qO=e=>{if(!e)return null;if(Fd(e))return e;let t=e.length;if(!uj(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},WO=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&cb(Uint8Array)),VO=(e,t)=>{const n=(e&&e[wx]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},KO=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},GO=Mi("HTMLFormElement"),YO=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),CN=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),XO=Mi("RegExp"),hj=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};wp(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},JO=e=>{hj(e,(t,r)=>{if(ha(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(ha(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},QO=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return Fd(e)?n(e):n(String(e).split(t)),r},ZO=()=>{},eI=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function tI(e){return!!(e&&ha(e.append)&&e[lj]==="FormData"&&e[wx])}const rI=e=>{const t=new Array(10),r=(n,s)=>{if(yp(n)){if(t.indexOf(n)>=0)return;if(vp(n))return n;if(!("toJSON"in n)){t[s]=n;const a=Fd(n)?[]:{};return wp(n,(i,o)=>{const l=r(i,s+1);!Nd(l)&&(a[o]=l)}),t[s]=void 0,a}}return n};return r(e,0)},nI=Mi("AsyncFunction"),sI=e=>e&&(yp(e)||ha(e))&&ha(e.then)&&ha(e.catch),pj=((e,t)=>e?setImmediate:t?((r,n)=>(iu.addEventListener("message",({source:s,data:a})=>{s===iu&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),iu.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",ha(iu.postMessage)),aI=typeof queueMicrotask<"u"?queueMicrotask.bind(iu):typeof process<"u"&&process.nextTick||pj,iI=e=>e!=null&&ha(e[wx]),Fe={isArray:Fd,isArrayBuffer:cj,isBuffer:vp,isFormData:LO,isArrayBufferView:SO,isString:kO,isNumber:uj,isBoolean:_O,isObject:yp,isPlainObject:N1,isEmptyObject:EO,isReadableStream:DO,isRequest:RO,isResponse:OO,isHeaders:IO,isUndefined:Nd,isDate:AO,isFile:jO,isBlob:TO,isRegExp:XO,isFunction:ha,isStream:PO,isURLSearchParams:FO,isTypedArray:WO,isFileList:CO,forEach:wp,merge:Yy,extend:BO,trim:MO,stripBOM:UO,inherits:$O,toFlatObject:zO,kindOf:bx,kindOfTest:Mi,endsWith:HO,toArray:qO,forEachEntry:VO,matchAll:KO,isHTMLForm:GO,hasOwnProperty:CN,hasOwnProp:CN,reduceDescriptors:hj,freezeMethods:JO,toObjectSet:QO,toCamelCase:YO,noop:ZO,toFiniteNumber:eI,findKey:fj,global:iu,isContextDefined:dj,isSpecCompliantForm:tI,toJSONObject:rI,isAsyncFn:nI,isThenable:sI,setImmediate:pj,asap:aI,isIterable:iI};function tr(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Fe.inherits(tr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Fe.toJSONObject(this.config),code:this.code,status:this.status}}});const mj=tr.prototype,gj={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{gj[e]={value:e}});Object.defineProperties(tr,gj);Object.defineProperty(mj,"isAxiosError",{value:!0});tr.from=(e,t,r,n,s,a)=>{const i=Object.create(mj);Fe.toFlatObject(e,i,function(f){return f!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",l=t==null&&e?e.code:t;return tr.call(i,o,l,r,n,s),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const oI=null;function Xy(e){return Fe.isPlainObject(e)||Fe.isArray(e)}function xj(e){return Fe.endsWith(e,"[]")?e.slice(0,-2):e}function PN(e,t,r){return e?e.concat(t).map(function(s,a){return s=xj(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function lI(e){return Fe.isArray(e)&&!e.some(Xy)}const cI=Fe.toFlatObject(Fe,{},null,function(t){return/^is[A-Z]/.test(t)});function Sx(e,t,r){if(!Fe.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Fe.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,w){return!Fe.isUndefined(w[g])});const n=r.metaTokens,s=r.visitor||f,a=r.dots,i=r.indexes,l=(r.Blob||typeof Blob<"u"&&Blob)&&Fe.isSpecCompliantForm(t);if(!Fe.isFunction(s))throw new TypeError("visitor must be a function");function u(m){if(m===null)return"";if(Fe.isDate(m))return m.toISOString();if(Fe.isBoolean(m))return m.toString();if(!l&&Fe.isBlob(m))throw new tr("Blob is not supported. Use a Buffer instead.");return Fe.isArrayBuffer(m)||Fe.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function f(m,g,w){let x=m;if(m&&!w&&typeof m=="object"){if(Fe.endsWith(g,"{}"))g=n?g:g.slice(0,-2),m=JSON.stringify(m);else if(Fe.isArray(m)&&lI(m)||(Fe.isFileList(m)||Fe.endsWith(g,"[]"))&&(x=Fe.toArray(m)))return g=xj(g),x.forEach(function(b,S){!(Fe.isUndefined(b)||b===null)&&t.append(i===!0?PN([g],S,a):i===null?g:g+"[]",u(b))}),!1}return Xy(m)?!0:(t.append(PN(w,g,a),u(m)),!1)}const h=[],p=Object.assign(cI,{defaultVisitor:f,convertValue:u,isVisitable:Xy});function d(m,g){if(!Fe.isUndefined(m)){if(h.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(m),Fe.forEach(m,function(x,y){(!(Fe.isUndefined(x)||x===null)&&s.call(t,x,Fe.isString(y)?y.trim():y,g,p))===!0&&d(x,g?g.concat(y):[y])}),h.pop()}}if(!Fe.isObject(e))throw new TypeError("data must be an object");return d(e),t}function LN(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function ub(e,t){this._pairs=[],e&&Sx(e,this,t)}const vj=ub.prototype;vj.append=function(t,r){this._pairs.push([t,r])};vj.toString=function(t){const r=t?function(n){return t.call(this,n,LN)}:LN;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function uI(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function yj(e,t,r){if(!t)return e;const n=r&&r.encode||uI;Fe.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=Fe.isURLSearchParams(t)?t.toString():new ub(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class FN{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Fe.forEach(this.handlers,function(n){n!==null&&t(n)})}}const wj={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},fI=typeof URLSearchParams<"u"?URLSearchParams:ub,dI=typeof FormData<"u"?FormData:null,hI=typeof Blob<"u"?Blob:null,pI={isBrowser:!0,classes:{URLSearchParams:fI,FormData:dI,Blob:hI},protocols:["http","https","file","blob","url","data"]},fb=typeof window<"u"&&typeof document<"u",Jy=typeof navigator=="object"&&navigator||void 0,mI=fb&&(!Jy||["ReactNative","NativeScript","NS"].indexOf(Jy.product)<0),gI=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",xI=fb&&window.location.href||"http://localhost",vI=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:fb,hasStandardBrowserEnv:mI,hasStandardBrowserWebWorkerEnv:gI,navigator:Jy,origin:xI},Symbol.toStringTag,{value:"Module"})),js={...vI,...pI};function yI(e,t){return Sx(e,new js.classes.URLSearchParams,{visitor:function(r,n,s,a){return js.isNode&&Fe.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function wI(e){return Fe.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function bI(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function bj(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),l=a>=r.length;return i=!i&&Fe.isArray(s)?s.length:i,l?(Fe.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Fe.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Fe.isArray(s[i])&&(s[i]=bI(s[i])),!o)}if(Fe.isFormData(e)&&Fe.isFunction(e.entries)){const r={};return Fe.forEachEntry(e,(n,s)=>{t(wI(n),s,r,0)}),r}return null}function NI(e,t,r){if(Fe.isString(e))try{return(t||JSON.parse)(e),Fe.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const bp={transitional:wj,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Fe.isObject(t);if(a&&Fe.isHTMLForm(t)&&(t=new FormData(t)),Fe.isFormData(t))return s?JSON.stringify(bj(t)):t;if(Fe.isArrayBuffer(t)||Fe.isBuffer(t)||Fe.isStream(t)||Fe.isFile(t)||Fe.isBlob(t)||Fe.isReadableStream(t))return t;if(Fe.isArrayBufferView(t))return t.buffer;if(Fe.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return yI(t,this.formSerializer).toString();if((o=Fe.isFileList(t))||n.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Sx(o?{"files[]":t}:t,l&&new l,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),NI(t)):t}],transformResponse:[function(t){const r=this.transitional||bp.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Fe.isResponse(t)||Fe.isReadableStream(t))return t;if(t&&Fe.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?tr.from(o,tr.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:js.classes.FormData,Blob:js.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Fe.forEach(["delete","get","head","post","put","patch"],e=>{bp.headers[e]={}});const SI=Fe.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),kI=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&SI[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},DN=Symbol("internals");function Sh(e){return e&&String(e).trim().toLowerCase()}function S1(e){return e===!1||e==null?e:Fe.isArray(e)?e.map(S1):String(e)}function _I(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const EI=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function V2(e,t,r,n,s){if(Fe.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Fe.isString(t)){if(Fe.isString(n))return t.indexOf(n)!==-1;if(Fe.isRegExp(n))return n.test(t)}}function AI(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function jI(e,t){const r=Fe.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let pa=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,l,u){const f=Sh(l);if(!f)throw new Error("header name must be a non-empty string");const h=Fe.findKey(s,f);(!h||s[h]===void 0||u===!0||u===void 0&&s[h]!==!1)&&(s[h||l]=S1(o))}const i=(o,l)=>Fe.forEach(o,(u,f)=>a(u,f,l));if(Fe.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Fe.isString(t)&&(t=t.trim())&&!EI(t))i(kI(t),r);else if(Fe.isObject(t)&&Fe.isIterable(t)){let o={},l,u;for(const f of t){if(!Fe.isArray(f))throw TypeError("Object iterator must return a key-value pair");o[u=f[0]]=(l=o[u])?Fe.isArray(l)?[...l,f[1]]:[l,f[1]]:f[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=Sh(t),t){const n=Fe.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return _I(s);if(Fe.isFunction(r))return r.call(this,s,n);if(Fe.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=Sh(t),t){const n=Fe.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||V2(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=Sh(i),i){const o=Fe.findKey(n,i);o&&(!r||V2(n,n[o],o,r))&&(delete n[o],s=!0)}}return Fe.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||V2(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Fe.forEach(this,(s,a)=>{const i=Fe.findKey(n,a);if(i){r[i]=S1(s),delete r[a];return}const o=t?AI(a):String(a).trim();o!==a&&delete r[a],r[o]=S1(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Fe.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Fe.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[DN]=this[DN]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=Sh(i);n[o]||(jI(s,i),n[o]=!0)}return Fe.isArray(t)?t.forEach(a):a(t),this}};pa.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Fe.reduceDescriptors(pa.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Fe.freezeMethods(pa);function K2(e,t){const r=this||bp,n=t||r,s=pa.from(n.headers);let a=n.data;return Fe.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function Nj(e){return!!(e&&e.__CANCEL__)}function Dd(e,t,r){tr.call(this,e??"canceled",tr.ERR_CANCELED,t,r),this.name="CanceledError"}Fe.inherits(Dd,tr,{__CANCEL__:!0});function Sj(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new tr("Request failed with status code "+r.status,[tr.ERR_BAD_REQUEST,tr.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function TI(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function CI(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(l){const u=Date.now(),f=n[a];i||(i=u),r[s]=l,n[s]=u;let h=a,p=0;for(;h!==s;)p+=r[h++],h=h%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-i<t)return;const d=f&&u-f;return d?Math.round(p*1e3/d):void 0}}function PI(e,t){let r=0,n=1e3/t,s,a;const i=(u,f=Date.now())=>{r=f,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const f=Date.now(),h=f-r;h>=n?i(u,f):(s=u,a||(a=setTimeout(()=>{a=null,i(s)},n-h)))},()=>s&&i(s)]}const mg=(e,t,r=3)=>{let n=0;const s=CI(50,250);return PI(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,l=i-n,u=s(l),f=i<=o;n=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:l,rate:u||void 0,estimated:u&&o&&f?(o-i)/u:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(h)},r)},RN=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},ON=e=>(...t)=>Fe.asap(()=>e(...t)),LI=js.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,js.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(js.origin),js.navigator&&/(msie|trident)/i.test(js.navigator.userAgent)):()=>!0,FI=js.hasStandardBrowserEnv?{write(e,t,r,n,s,a,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(t)}`];Fe.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),Fe.isString(n)&&o.push(`path=${n}`),Fe.isString(s)&&o.push(`domain=${s}`),a===!0&&o.push("secure"),Fe.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function DI(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function RI(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function kj(e,t,r){let n=!DI(t);return e&&(n||r==!1)?RI(e,t):t}const IN=e=>e instanceof pa?{...e}:e;function Pu(e,t){t=t||{};const r={};function n(u,f,h,p){return Fe.isPlainObject(u)&&Fe.isPlainObject(f)?Fe.merge.call({caseless:p},u,f):Fe.isPlainObject(f)?Fe.merge({},f):Fe.isArray(f)?f.slice():f}function s(u,f,h,p){if(Fe.isUndefined(f)){if(!Fe.isUndefined(u))return n(void 0,u,h,p)}else return n(u,f,h,p)}function a(u,f){if(!Fe.isUndefined(f))return n(void 0,f)}function i(u,f){if(Fe.isUndefined(f)){if(!Fe.isUndefined(u))return n(void 0,u)}else return n(void 0,f)}function o(u,f,h){if(h in t)return n(u,f);if(h in e)return n(void 0,u)}const l={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(u,f,h)=>s(IN(u),IN(f),h,!0)};return Fe.forEach(Object.keys({...e,...t}),function(f){const h=l[f]||s,p=h(e[f],t[f],f);Fe.isUndefined(p)&&h!==o||(r[f]=p)}),r}const _j=e=>{const t=Pu({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=pa.from(i),t.url=yj(kj(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Fe.isFormData(r)){if(js.hasStandardBrowserEnv||js.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Fe.isFunction(r.getHeaders)){const l=r.getHeaders(),u=["content-type","content-length"];Object.entries(l).forEach(([f,h])=>{u.includes(f.toLowerCase())&&i.set(f,h)})}}if(js.hasStandardBrowserEnv&&(n&&Fe.isFunction(n)&&(n=n(t)),n||n!==!1&&LI(t.url))){const l=s&&a&&FI.read(a);l&&i.set(s,l)}return t},OI=typeof XMLHttpRequest<"u",II=OI&&function(e){return new Promise(function(r,n){const s=_j(e);let a=s.data;const i=pa.from(s.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:u}=s,f,h,p,d,m;function g(){d&&d(),m&&m(),s.cancelToken&&s.cancelToken.unsubscribe(f),s.signal&&s.signal.removeEventListener("abort",f)}let w=new XMLHttpRequest;w.open(s.method.toUpperCase(),s.url,!0),w.timeout=s.timeout;function x(){if(!w)return;const b=pa.from("getAllResponseHeaders"in w&&w.getAllResponseHeaders()),T={data:!o||o==="text"||o==="json"?w.responseText:w.response,status:w.status,statusText:w.statusText,headers:b,config:e,request:w};Sj(function(A){r(A),g()},function(A){n(A),g()},T),w=null}"onloadend"in w?w.onloadend=x:w.onreadystatechange=function(){!w||w.readyState!==4||w.status===0&&!(w.responseURL&&w.responseURL.indexOf("file:")===0)||setTimeout(x)},w.onabort=function(){w&&(n(new tr("Request aborted",tr.ECONNABORTED,e,w)),w=null)},w.onerror=function(S){const T=S&&S.message?S.message:"Network Error",L=new tr(T,tr.ERR_NETWORK,e,w);L.event=S||null,n(L),w=null},w.ontimeout=function(){let S=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const T=s.transitional||wj;s.timeoutErrorMessage&&(S=s.timeoutErrorMessage),n(new tr(S,T.clarifyTimeoutError?tr.ETIMEDOUT:tr.ECONNABORTED,e,w)),w=null},a===void 0&&i.setContentType(null),"setRequestHeader"in w&&Fe.forEach(i.toJSON(),function(S,T){w.setRequestHeader(T,S)}),Fe.isUndefined(s.withCredentials)||(w.withCredentials=!!s.withCredentials),o&&o!=="json"&&(w.responseType=s.responseType),u&&([p,m]=mg(u,!0),w.addEventListener("progress",p)),l&&w.upload&&([h,d]=mg(l),w.upload.addEventListener("progress",h),w.upload.addEventListener("loadend",d)),(s.cancelToken||s.signal)&&(f=b=>{w&&(n(!b||b.type?new Dd(null,e,w):b),w.abort(),w=null)},s.cancelToken&&s.cancelToken.subscribe(f),s.signal&&(s.signal.aborted?f():s.signal.addEventListener("abort",f)));const y=TI(s.url);if(y&&js.protocols.indexOf(y)===-1){n(new tr("Unsupported protocol "+y+":",tr.ERR_BAD_REQUEST,e));return}w.send(a||null)})},MI=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,o();const f=u instanceof Error?u:this.reason;n.abort(f instanceof tr?f:new Dd(f instanceof Error?f.message:f))}};let i=t&&setTimeout(()=>{i=null,a(new tr(`timeout ${t} of ms exceeded`,tr.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:l}=n;return l.unsubscribe=()=>Fe.asap(o),l}},BI=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},UI=async function*(e,t){for await(const r of $I(e))yield*BI(r,t)},$I=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},MN=(e,t,r,n)=>{const s=UI(e,t);let a=0,i,o=l=>{i||(i=!0,n&&n(l))};return new ReadableStream({async pull(l){try{const{done:u,value:f}=await s.next();if(u){o(),l.close();return}let h=f.byteLength;if(r){let p=a+=h;r(p)}l.enqueue(new Uint8Array(f))}catch(u){throw o(u),u}},cancel(l){return o(l),s.return()}},{highWaterMark:2})},BN=64*1024,{isFunction:Cm}=Fe,zI=(({Request:e,Response:t})=>({Request:e,Response:t}))(Fe.global),{ReadableStream:UN,TextEncoder:$N}=Fe.global,zN=(e,...t)=>{try{return!!e(...t)}catch{return!1}},HI=e=>{e=Fe.merge.call({skipUndefined:!0},zI,e);const{fetch:t,Request:r,Response:n}=e,s=t?Cm(t):typeof fetch=="function",a=Cm(r),i=Cm(n);if(!s)return!1;const o=s&&Cm(UN),l=s&&(typeof $N=="function"?(m=>g=>m.encode(g))(new $N):async m=>new Uint8Array(await new r(m).arrayBuffer())),u=a&&o&&zN(()=>{let m=!1;const g=new r(js.origin,{body:new UN,method:"POST",get duplex(){return m=!0,"half"}}).headers.has("Content-Type");return m&&!g}),f=i&&o&&zN(()=>Fe.isReadableStream(new n("").body)),h={stream:f&&(m=>m.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(m=>{!h[m]&&(h[m]=(g,w)=>{let x=g&&g[m];if(x)return x.call(g);throw new tr(`Response type '${m}' is not supported`,tr.ERR_NOT_SUPPORT,w)})});const p=async m=>{if(m==null)return 0;if(Fe.isBlob(m))return m.size;if(Fe.isSpecCompliantForm(m))return(await new r(js.origin,{method:"POST",body:m}).arrayBuffer()).byteLength;if(Fe.isArrayBufferView(m)||Fe.isArrayBuffer(m))return m.byteLength;if(Fe.isURLSearchParams(m)&&(m=m+""),Fe.isString(m))return(await l(m)).byteLength},d=async(m,g)=>{const w=Fe.toFiniteNumber(m.getContentLength());return w??p(g)};return async m=>{let{url:g,method:w,data:x,signal:y,cancelToken:b,timeout:S,onDownloadProgress:T,onUploadProgress:L,responseType:A,headers:D,withCredentials:C="same-origin",fetchOptions:O}=_j(m),E=t||fetch;A=A?(A+"").toLowerCase():"text";let P=MI([y,b&&b.toAbortSignal()],S),q=null;const M=P&&P.unsubscribe&&(()=>{P.unsubscribe()});let ne;try{if(L&&u&&w!=="get"&&w!=="head"&&(ne=await d(D,x))!==0){let ve=new r(g,{method:"POST",body:x,duplex:"half"}),_;if(Fe.isFormData(x)&&(_=ve.headers.get("content-type"))&&D.setContentType(_),ve.body){const[R,I]=RN(ne,mg(ON(L)));x=MN(ve.body,BN,R,I)}}Fe.isString(C)||(C=C?"include":"omit");const fe=a&&"credentials"in r.prototype,me={...O,signal:P,method:w.toUpperCase(),headers:D.normalize().toJSON(),body:x,duplex:"half",credentials:fe?C:void 0};q=a&&new r(g,me);let re=await(a?E(q,O):E(g,me));const G=f&&(A==="stream"||A==="response");if(f&&(T||G&&M)){const ve={};["status","statusText","headers"].forEach(B=>{ve[B]=re[B]});const _=Fe.toFiniteNumber(re.headers.get("content-length")),[R,I]=T&&RN(_,mg(ON(T),!0))||[];re=new n(MN(re.body,BN,R,()=>{I&&I(),M&&M()}),ve)}A=A||"text";let ge=await h[Fe.findKey(h,A)||"text"](re,m);return!G&&M&&M(),await new Promise((ve,_)=>{Sj(ve,_,{data:ge,headers:pa.from(re.headers),status:re.status,statusText:re.statusText,config:m,request:q})})}catch(fe){throw M&&M(),fe&&fe.name==="TypeError"&&/Load failed|fetch/i.test(fe.message)?Object.assign(new tr("Network Error",tr.ERR_NETWORK,m,q),{cause:fe.cause||fe}):tr.from(fe,fe&&fe.code,m,q)}}},qI=new Map,Ej=e=>{let t=e&&e.env||{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,l,u,f=qI;for(;o--;)l=a[o],u=f.get(l),u===void 0&&f.set(l,u=o?new Map:HI(t)),f=u;return u};Ej();const db={http:oI,xhr:II,fetch:{get:Ej}};Fe.forEach(db,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const HN=e=>`- ${e}`,WI=e=>Fe.isFunction(e)||e===null||e===!1;function VI(e,t){e=Fe.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!WI(n)&&(s=db[(o=String(n)).toLowerCase()],s===void 0))throw new tr(`Unknown adapter '${o}'`);if(s&&(Fe.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([l,u])=>`adapter ${l} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(HN).join(`
`):" "+HN(i[0]):"as no adapter specified";throw new tr("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s}const Aj={getAdapter:VI,adapters:db};function G2(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Dd(null,e)}function qN(e){return G2(e),e.headers=pa.from(e.headers),e.data=K2.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Aj.getAdapter(e.adapter||bp.adapter,e)(e).then(function(n){return G2(e),n.data=K2.call(e,e.transformResponse,n),n.headers=pa.from(n.headers),n},function(n){return Nj(n)||(G2(e),n&&n.response&&(n.response.data=K2.call(e,e.transformResponse,n.response),n.response.headers=pa.from(n.response.headers))),Promise.reject(n)})}const jj="1.13.2",kx={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{kx[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const WN={};kx.transitional=function(t,r,n){function s(a,i){return"[Axios v"+jj+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new tr(s(i," has been removed"+(r?" in "+r:"")),tr.ERR_DEPRECATED);return r&&!WN[i]&&(WN[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};kx.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function KI(e,t,r){if(typeof e!="object")throw new tr("options must be an object",tr.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],l=o===void 0||i(o,a,e);if(l!==!0)throw new tr("option "+a+" must be "+l,tr.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new tr("Unknown option "+a,tr.ERR_BAD_OPTION)}}const k1={assertOptions:KI,validators:kx},Yi=k1.validators;let vu=class{constructor(t){this.defaults=t||{},this.interceptors={request:new FN,response:new FN}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=Pu(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&k1.assertOptions(n,{silentJSONParsing:Yi.transitional(Yi.boolean),forcedJSONParsing:Yi.transitional(Yi.boolean),clarifyTimeoutError:Yi.transitional(Yi.boolean)},!1),s!=null&&(Fe.isFunction(s)?r.paramsSerializer={serialize:s}:k1.assertOptions(s,{encode:Yi.function,serialize:Yi.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),k1.assertOptions(r,{baseUrl:Yi.spelling("baseURL"),withXsrfToken:Yi.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Fe.merge(a.common,a[r.method]);a&&Fe.forEach(["delete","get","head","post","put","patch","common"],m=>{delete a[m]}),r.headers=pa.concat(i,a);const o=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(r)===!1||(l=l&&g.synchronous,o.unshift(g.fulfilled,g.rejected))});const u=[];this.interceptors.response.forEach(function(g){u.push(g.fulfilled,g.rejected)});let f,h=0,p;if(!l){const m=[qN.bind(this),void 0];for(m.unshift(...o),m.push(...u),p=m.length,f=Promise.resolve(r);h<p;)f=f.then(m[h++],m[h++]);return f}p=o.length;let d=r;for(;h<p;){const m=o[h++],g=o[h++];try{d=m(d)}catch(w){g.call(this,w);break}}try{f=qN.call(this,d)}catch(m){return Promise.reject(m)}for(h=0,p=u.length;h<p;)f=f.then(u[h++],u[h++]);return f}getUri(t){t=Pu(this.defaults,t);const r=kj(t.baseURL,t.url,t.allowAbsoluteUrls);return yj(r,t.params,t.paramsSerializer)}};Fe.forEach(["delete","get","head","options"],function(t){vu.prototype[t]=function(r,n){return this.request(Pu(n||{},{method:t,url:r,data:(n||{}).data}))}});Fe.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(Pu(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}vu.prototype[t]=r(),vu.prototype[t+"Form"]=r(!0)});let GI=class Tj{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new Dd(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new Tj(function(s){t=s}),cancel:t}}};function YI(e){return function(r){return e.apply(null,r)}}function XI(e){return Fe.isObject(e)&&e.isAxiosError===!0}const Qy={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Qy).forEach(([e,t])=>{Qy[t]=e});function Cj(e){const t=new vu(e),r=oj(vu.prototype.request,t);return Fe.extend(r,vu.prototype,t,{allOwnKeys:!0}),Fe.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return Cj(Pu(e,s))},r}const dn=Cj(bp);dn.Axios=vu;dn.CanceledError=Dd;dn.CancelToken=GI;dn.isCancel=Nj;dn.VERSION=jj;dn.toFormData=Sx;dn.AxiosError=tr;dn.Cancel=dn.CanceledError;dn.all=function(t){return Promise.all(t)};dn.spread=YI;dn.isAxiosError=XI;dn.mergeConfig=Pu;dn.AxiosHeaders=pa;dn.formToJSON=e=>bj(Fe.isHTMLForm(e)?new FormData(e):e);dn.getAdapter=Aj.getAdapter;dn.HttpStatusCode=Qy;dn.default=dn;const{Axios:Ere,AxiosError:Are,CanceledError:jre,isCancel:Tre,CancelToken:Cre,VERSION:Pre,all:Lre,Cancel:Fre,isAxiosError:Dre,spread:Rre,toFormData:Ore,AxiosHeaders:Ire,HttpStatusCode:Mre,formToJSON:Bre,getAdapter:Ure,mergeConfig:$re}=dn,JI=()=>{var t;if(typeof window<"u"&&((t=window.electron)!=null&&t.apiUrl)){const r=window.electron.apiUrl;return console.log(" [API] Using Electron API URL:",r),`${r}/api`}const e="http://162.55.219.151/api";return console.log(" [API] Using VITE_API_URL:",e),e};class QI{constructor(){Pt(this,"client");const t=JI();this.client=dn.create({baseURL:t,headers:{"Content-Type":"application/json"}}),console.log("API Service initialized with baseURL:",t),this.client.interceptors.request.use(r=>{var s;console.log("API Request:",(s=r.method)==null?void 0:s.toUpperCase(),r.url,r.data);const n=localStorage.getItem("authToken");return n&&(r.headers.Authorization=`Bearer ${n}`),r},r=>Promise.reject(r)),this.client.interceptors.response.use(r=>{console.log("API Response:",r.status,r.config.url,r.data);const n=r.headers["x-new-token"];return n&&(console.log(" Token auto-refreshed by server, updating storage"),this.updateStoredToken(n)),r},async r=>{var a,i,o,l,u,f,h,p,d;const n=(a=r.response)==null?void 0:a.status;console.error("API Error:",n,(i=r.config)==null?void 0:i.url,(o=r.response)==null?void 0:o.data);const s=r.config;if(n&&n>=500)return console.warn(` Server error ${n} - session preserved, app will work offline`),Promise.reject(r);if(!r.response&&r.code==="ERR_NETWORK")return console.warn(" Network error - session preserved, app will work offline"),Promise.reject(r);if(n===401&&s&&!((l=s.url)!=null&&l.includes("/auth/login"))&&!((u=s.url)!=null&&u.includes("/auth/register"))&&!((f=s.url)!=null&&f.includes("/auth/refresh"))&&!s._retry){s._retry=!0;const m=localStorage.getItem("authToken");if(m)try{console.log(" Attempting to refresh token...");const w=await dn.create({baseURL:this.client.defaults.baseURL,headers:{"Content-Type":"application/json"},timeout:1e4}).post("/auth/refresh",{token:m});if((p=(h=w.data)==null?void 0:h.data)!=null&&p.token){const x=w.data.data.token;return console.log(" Token refreshed successfully"),this.updateStoredToken(x),s.headers=s.headers||{},s.headers.Authorization=`Bearer ${x}`,this.client.request(s)}}catch(g){const w=(d=g.response)==null?void 0:d.status;if(console.log(" Token refresh failed:",w||g.message),(w===401||w===403)&&this.handleLogout(),w&&w>=500)return console.warn(" Server error during refresh - session preserved"),Promise.reject(r)}else this.handleLogout()}return Promise.reject(r)})}updateStoredToken(t){localStorage.setItem("authToken",t);const r=localStorage.getItem("auth-storage");if(r)try{const n=JSON.parse(r);n.state&&(n.state.token=t,localStorage.setItem("auth-storage",JSON.stringify(n)))}catch(n){console.warn("Failed to update auth storage:",n)}}handleLogout(){console.log(" Logging out user due to auth failure"),localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp");const t=window.location.hash.includes("#/");(t?window.location.hash.replace("#",""):window.location.pathname).includes("/login")||(t?window.location.hash="#/login":window.location.href="/login")}async refreshToken(t){return(await this.client.post("/auth/refresh",{token:t})).data}async register(t){return(await this.client.post("/auth/register",t)).data}async login(t,r){return(await this.client.post("/auth/login",{email:t,password:r})).data}async getCurrentUser(){return(await this.client.get("/auth/me")).data}async getProjects(t){return(await this.client.get("/projects",{params:{status:t}})).data}async getProject(t){return(await this.client.get(`/projects/${t}`)).data}async createProject(t){return(await this.client.post("/projects",t)).data}async updateProject(t,r){return(await this.client.put(`/projects/${t}`,r)).data}async deleteProject(t){return(await this.client.delete(`/projects/${t}`)).data}async getDeletedProjects(){return(await this.client.get("/projects/deleted/list")).data}async restoreProject(t){return(await this.client.post(`/projects/${t}/restore`)).data}async permanentDeleteProject(t){return(await this.client.delete(`/projects/${t}/permanent`)).data}async getBordereaux(t){return(await this.client.get(`/bordereau/project/${t}`)).data}async getPeriodes(t){return(await this.client.get(`/periodes/project/${t}`)).data}async createPeriode(t,r){return(await this.client.post(`/periodes/project/${t}`,r)).data}async updatePeriode(t,r){return(await this.client.put(`/periodes/${t}`,r)).data}async createBordereau(t){return(await this.client.post("/bordereau",t)).data}async updateBordereau(t,r){return(await this.client.put(`/bordereau/${t}`,r)).data}async deleteBordereau(t){return(await this.client.delete(`/bordereau/${t}`)).data}async getMetres(t){return(await this.client.get(`/metre/project/${t}`)).data}async createMetre(t){return(await this.client.post("/metre",t)).data}async updateMetre(t,r){return(await this.client.put(`/metre/${t}`,r)).data}async deleteMetre(t){return(await this.client.delete(`/metre/${t}`)).data}async getDecompts(t){return(await this.client.get(`/decompt/project/${t}`)).data}async createDecompt(t){return(await this.client.post("/decompt",t)).data}async updateDecompt(t,r){return(await this.client.put(`/decompt/${t}`,r)).data}async deleteDecompt(t){return(await this.client.delete(`/decompt/${t}`)).data}async uploadPhoto(t,r,n){const s=new FormData;return s.append("photo",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/photos",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getPhotos(t){return(await this.client.get(`/photos/project/${t}`)).data}async deletePhoto(t){return(await this.client.delete(`/photos/${t}`)).data}async getPVs(t){return(await this.client.get(`/pv/project/${t}`)).data}async createPV(t){return(await this.client.post("/pv",t)).data}async updatePV(t,r){return(await this.client.put(`/pv/${t}`,r)).data}async deletePV(t){return(await this.client.delete(`/pv/${t}`)).data}async uploadAttachment(t,r,n){const s=new FormData;return s.append("file",r),s.append("projectId",t),Object.keys(n).forEach(i=>{s.append(i,n[i])}),(await this.client.post("/attachments",s,{headers:{"Content-Type":"multipart/form-data"}})).data}async getAttachments(t,r){return(await this.client.get(`/attachments/project/${t}`,{params:{category:r}})).data}async deleteAttachment(t){return(await this.client.delete(`/attachments/${t}`)).data}async syncPush(t,r){return(await this.client.post("/sync/push",{operations:t,deviceId:r})).data}async syncPull(t,r){return(await this.client.get("/sync/pull",{params:{lastSync:t,deviceId:r}})).data}async getLastSyncTime(){return(await this.client.get("/sync/last")).data}async resolveConflict(t,r,n){return(await this.client.post(`/sync/conflict/${t}`,{resolution:r,mergedData:n})).data}}const Rt=new QI,Hr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Dn=Object.keys,Ps=Array.isArray;function Zs(e,t){return typeof t!="object"||Dn(t).forEach(function(r){e[r]=t[r]}),e}typeof Promise>"u"||Hr.Promise||(Hr.Promise=Promise);const $0=Object.getPrototypeOf,ZI={}.hasOwnProperty;function Da(e,t){return ZI.call(e,t)}function Sd(e,t){typeof t=="function"&&(t=t($0(e))),(typeof Reflect>"u"?Dn:Reflect.ownKeys)(t).forEach(r=>{sl(e,r,t[r])})}const Pj=Object.defineProperty;function sl(e,t,r,n){Pj(e,t,Zs(r&&Da(r,"get")&&typeof r.get=="function"?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function Kf(e){return{from:function(t){return e.prototype=Object.create(t.prototype),sl(e.prototype,"constructor",e),{extend:Sd.bind(null,e.prototype)}}}}const eM=Object.getOwnPropertyDescriptor;function hb(e,t){let r;return eM(e,t)||(r=$0(e))&&hb(r,t)}const tM=[].slice;function gg(e,t,r){return tM.call(e,t,r)}function Lj(e,t){return t(e)}function Oh(e){if(!e)throw new Error("Assertion Failed")}function Fj(e){Hr.setImmediate?setImmediate(e):setTimeout(e,0)}function Dj(e,t){return e.reduce((r,n,s)=>{var a=t(n,s);return a&&(r[a[0]]=a[1]),r},{})}function al(e,t){if(typeof t=="string"&&Da(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var r=[],n=0,s=t.length;n<s;++n){var a=al(e,t[n]);r.push(a)}return r}var i=t.indexOf(".");if(i!==-1){var o=e[t.substr(0,i)];return o==null?void 0:al(o,t.substr(i+1))}}function Fi(e,t,r){if(e&&t!==void 0&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Oh(typeof r!="string"&&"length"in r);for(var n=0,s=t.length;n<s;++n)Fi(e,t[n],r[n])}else{var a=t.indexOf(".");if(a!==-1){var i=t.substr(0,a),o=t.substr(a+1);if(o==="")r===void 0?Ps(e)&&!isNaN(parseInt(i))?e.splice(i,1):delete e[i]:e[i]=r;else{var l=e[i];l&&Da(e,i)||(l=e[i]={}),Fi(l,o,r)}}else r===void 0?Ps(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=r}}function Rj(e){var t={};for(var r in e)Da(e,r)&&(t[r]=e[r]);return t}const rM=[].concat;function Oj(e){return rM.apply([],e)}const Ij="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Oj([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>Hr[e]),nM=Ij.map(e=>Hr[e]);Dj(Ij,e=>[e,!0]);let Wl=null;function Np(e){Wl=typeof WeakMap<"u"&&new WeakMap;const t=Zy(e);return Wl=null,t}function Zy(e){if(!e||typeof e!="object")return e;let t=Wl&&Wl.get(e);if(t)return t;if(Ps(e)){t=[],Wl&&Wl.set(e,t);for(var r=0,n=e.length;r<n;++r)t.push(Zy(e[r]))}else if(nM.indexOf(e.constructor)>=0)t=e;else{const a=$0(e);for(var s in t=a===Object.prototype?{}:Object.create(a),Wl&&Wl.set(e,t),e)Da(e,s)&&(t[s]=Zy(e[s]))}return t}const{toString:sM}={};function ew(e){return sM.call(e).slice(8,-1)}const tw=typeof Symbol<"u"?Symbol.iterator:"@@iterator",aM=typeof tw=="symbol"?function(e){var t;return e!=null&&(t=e[tw])&&t.apply(e)}:function(){return null},Nf={};function Jo(e){var t,r,n,s;if(arguments.length===1){if(Ps(e))return e.slice();if(this===Nf&&typeof e=="string")return[e];if(s=aM(e)){for(r=[];!(n=s.next()).done;)r.push(n.value);return r}if(e==null)return[e];if(typeof(t=e.length)=="number"){for(r=new Array(t);t--;)r[t]=e[t];return r}return[e]}for(t=arguments.length,r=new Array(t);t--;)r[t]=arguments[t];return r}const pb=typeof Symbol<"u"?e=>e[Symbol.toStringTag]==="AsyncFunction":()=>!1;var wo=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Mj(e,t){wo=e,Bj=t}var Bj=()=>!0;const iM=!new Error("").stack;function zu(){if(iM)try{throw zu.arguments,new Error}catch(e){return e}return new Error}function rw(e,t){var r=e.stack;return r?(t=t||0,r.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),r.split(`
`).slice(t).filter(Bj).map(n=>`
`+n).join("")):""}var Uj=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],mb=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Uj),oM={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Gf(e,t){this._e=zu(),this.name=e,this.message=t}function $j(e,t){return e+". Errors: "+Object.keys(t).map(r=>t[r].toString()).filter((r,n,s)=>s.indexOf(r)===n).join(`
`)}function xg(e,t,r,n){this._e=zu(),this.failures=t,this.failedKeys=n,this.successCount=r,this.message=$j(e,t)}function e0(e,t){this._e=zu(),this.name="BulkError",this.failures=Object.keys(t).map(r=>t[r]),this.failuresByPos=t,this.message=$j(e,t)}Kf(Gf).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+rw(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Kf(xg).from(Gf),Kf(e0).from(Gf);var gb=mb.reduce((e,t)=>(e[t]=t+"Error",e),{});const lM=Gf;var Ut=mb.reduce((e,t)=>{var r=t+"Error";function n(s,a){this._e=zu(),this.name=r,s?typeof s=="string"?(this.message=`${s}${a?`
 `+a:""}`,this.inner=a||null):typeof s=="object"&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=oM[t]||r,this.inner=null)}return Kf(n).from(lM),e[t]=n,e},{});Ut.Syntax=SyntaxError,Ut.Type=TypeError,Ut.Range=RangeError;var VN=Uj.reduce((e,t)=>(e[t+"Error"]=Ut[t],e),{}),_1=mb.reduce((e,t)=>(["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=Ut[t]),e),{});function Dr(){}function z0(e){return e}function cM(e,t){return e==null||e===z0?t:function(r){return t(e(r))}}function Lu(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function uM(e,t){return e===Dr?t:function(){var r=e.apply(this,arguments);r!==void 0&&(arguments[0]=r);var n=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?Lu(n,this.onsuccess):n),s&&(this.onerror=this.onerror?Lu(s,this.onerror):s),a!==void 0?a:r}}function fM(e,t){return e===Dr?t:function(){e.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?Lu(r,this.onsuccess):r),n&&(this.onerror=this.onerror?Lu(n,this.onerror):n)}}function dM(e,t){return e===Dr?t:function(r){var n=e.apply(this,arguments);Zs(r,n);var s=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?Lu(s,this.onsuccess):s),a&&(this.onerror=this.onerror?Lu(a,this.onerror):a),n===void 0?i===void 0?void 0:i:Zs(n,i)}}function hM(e,t){return e===Dr?t:function(){return t.apply(this,arguments)!==!1&&e.apply(this,arguments)}}function xb(e,t){return e===Dr?t:function(){var r=e.apply(this,arguments);if(r&&typeof r.then=="function"){for(var n=this,s=arguments.length,a=new Array(s);s--;)a[s]=arguments[s];return r.then(function(){return t.apply(n,a)})}return t.apply(this,arguments)}}_1.ModifyError=xg,_1.DexieError=Gf,_1.BulkError=e0;var H0={};const zj=100,[nw,vg,sw]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,$0(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,$0(t),e]})(),Hj=vg&&vg.then,E1=nw&&nw.constructor,vb=!!sw;var aw=!1,pM=sw?()=>{sw.then(Pm)}:Hr.setImmediate?setImmediate.bind(null,Pm):Hr.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Pm(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Pm,0)},t0=function(e,t){Ih.push([e,t]),yg&&(pM(),yg=!1)},iw=!0,yg=!0,yu=[],A1=[],ow=null,lw=z0,Yf={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:YN,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{YN(e[0],e[1])}catch{}})}},Dt=Yf,Ih=[],wu=0,j1=[];function mt(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Dr,this._lib=!1;var t=this._PSD=Dt;if(wo&&(this._stackHolder=zu(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==H0)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&uw(this,this._value))}this._state=null,this._value=null,++t.ref,Wj(this,e)}const cw={get:function(){var e=Dt,t=wg;function r(n,s){var a=!e.global&&(e!==Dt||t!==wg);const i=a&&!hl();var o=new mt((l,u)=>{yb(this,new qj(bg(n,e,a,i),bg(s,e,a,i),l,u,e))});return wo&&Gj(o,this),o}return r.prototype=H0,r},set:function(e){sl(this,"then",e&&e.prototype===H0?cw:{get:function(){return e},set:cw.set})}};function qj(e,t,r,n,s){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=r,this.reject=n,this.psd=s}function Wj(e,t){try{t(r=>{if(e._state===null){if(r===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Sp();r&&typeof r.then=="function"?Wj(e,(s,a)=>{r instanceof mt?r._then(s,a):r.then(s,a)}):(e._state=!0,e._value=r,Vj(e)),n&&kp()}},uw.bind(null,e))}catch(r){uw(e,r)}}function uw(e,t){if(A1.push(t),e._state===null){var r=e._lib&&Sp();t=lw(t),e._state=!1,e._value=t,wo&&t!==null&&typeof t=="object"&&!t._promise&&function(n,s,a){try{n.apply(null,a)}catch{}}(()=>{var n=hb(t,"stack");t._promise=e,sl(t,"stack",{get:()=>aw?n&&(n.get?n.get.apply(t):n.value):e.stack})}),function(n){yu.some(s=>s._value===n._value)||yu.push(n)}(e),Vj(e),r&&kp()}}function Vj(e){var t=e._listeners;e._listeners=[];for(var r=0,n=t.length;r<n;++r)yb(e,t[r]);var s=e._PSD;--s.ref||s.finalize(),wu===0&&(++wu,t0(()=>{--wu==0&&wb()},[]))}function yb(e,t){if(e._state!==null){var r=e._state?t.onFulfilled:t.onRejected;if(r===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++wu,t0(mM,[r,e,t])}else e._listeners.push(t)}function mM(e,t,r){try{ow=t;var n,s=t._value;t._state?n=e(s):(A1.length&&(A1=[]),n=e(s),A1.indexOf(s)===-1&&function(a){for(var i=yu.length;i;)if(yu[--i]._value===a._value)return void yu.splice(i,1)}(t)),r.resolve(n)}catch(a){r.reject(a)}finally{ow=null,--wu==0&&wb(),--r.psd.ref||r.psd.finalize()}}function Kj(e,t,r){if(t.length===r)return t;var n="";if(e._state===!1){var s,a,i=e._value;i!=null?(s=i.name||"Error",a=i.message||i,n=rw(i,0)):(s=i,a=""),t.push(s+(a?": "+a:"")+n)}return wo&&((n=rw(e._stackHolder,2))&&t.indexOf(n)===-1&&t.push(n),e._prev&&Kj(e._prev,t,r)),t}function Gj(e,t){var r=t?t._numPrev+1:0;r<100&&(e._prev=t,e._numPrev=r)}function Pm(){Sp()&&kp()}function Sp(){var e=iw;return iw=!1,yg=!1,e}function kp(){var e,t,r;do for(;Ih.length>0;)for(e=Ih,Ih=[],r=e.length,t=0;t<r;++t){var n=e[t];n[0].apply(null,n[1])}while(Ih.length>0);iw=!0,yg=!0}function wb(){var e=yu;yu=[],e.forEach(n=>{n._PSD.onunhandled.call(null,n._value,n)});for(var t=j1.slice(0),r=t.length;r;)t[--r]()}function Lm(e){return new mt(H0,!1,e)}function Yr(e,t){var r=Dt;return function(){var n=Sp(),s=Dt;try{return _c(r,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{_c(s,!1),n&&kp()}}}Sd(mt.prototype,{then:cw,_then:function(e,t){yb(this,new qj(null,null,e,t,Dt))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],r=arguments[1];return typeof t=="function"?this.then(null,n=>n instanceof t?r(n):Lm(n)):this.then(null,n=>n&&n.name===t?r(n):Lm(n))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),Lm(t)))},stack:{get:function(){if(this._stack)return this._stack;try{aw=!0;var e=Kj(this,[],20).join(`
From previous: `);return this._state!==null&&(this._stack=e),e}finally{aw=!1}}},timeout:function(e,t){return e<1/0?new mt((r,n)=>{var s=setTimeout(()=>n(new Ut.Timeout(t)),e);this.then(r,n).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&sl(mt.prototype,Symbol.toStringTag,"Dexie.Promise"),Yf.env=Yj(),Sd(mt,{all:function(){var e=Jo.apply(null,arguments).map(Fm);return new mt(function(t,r){e.length===0&&t([]);var n=e.length;e.forEach((s,a)=>mt.resolve(s).then(i=>{e[a]=i,--n||t(e)},r))})},resolve:e=>{if(e instanceof mt)return e;if(e&&typeof e.then=="function")return new mt((r,n)=>{e.then(r,n)});var t=new mt(H0,!0,e);return Gj(t,ow),t},reject:Lm,race:function(){var e=Jo.apply(null,arguments).map(Fm);return new mt((t,r)=>{e.map(n=>mt.resolve(n).then(t,r))})},PSD:{get:()=>Dt,set:e=>Dt=e},totalEchoes:{get:()=>wg},newPSD:kc,usePSD:Od,scheduler:{get:()=>t0,set:e=>{t0=e}},rejectionMapper:{get:()=>lw,set:e=>{lw=e}},follow:(e,t)=>new mt((r,n)=>kc((s,a)=>{var i=Dt;i.unhandleds=[],i.onunhandled=a,i.finalize=Lu(function(){(function(o){function l(){o(),j1.splice(j1.indexOf(l),1)}j1.push(l),++wu,t0(()=>{--wu==0&&wb()},[])})(()=>{this.unhandleds.length===0?s():a(this.unhandleds[0])})},i.finalize),e()},t,r,n))}),E1&&(E1.allSettled&&sl(mt,"allSettled",function(){const e=Jo.apply(null,arguments).map(Fm);return new mt(t=>{e.length===0&&t([]);let r=e.length;const n=new Array(r);e.forEach((s,a)=>mt.resolve(s).then(i=>n[a]={status:"fulfilled",value:i},i=>n[a]={status:"rejected",reason:i}).then(()=>--r||t(n)))})}),E1.any&&typeof AggregateError<"u"&&sl(mt,"any",function(){const e=Jo.apply(null,arguments).map(Fm);return new mt((t,r)=>{e.length===0&&r(new AggregateError([]));let n=e.length;const s=new Array(n);e.forEach((a,i)=>mt.resolve(a).then(o=>t(o),o=>{s[i]=o,--n||r(new AggregateError(s))}))})}));const Ts={awaits:0,echoes:0,id:0};var gM=0,T1=[],Y2=0,wg=0,xM=0;function kc(e,t,r,n){var s=Dt,a=Object.create(s);a.parent=s,a.ref=0,a.global=!1,a.id=++xM;var i=Yf.env;a.env=vb?{Promise:mt,PromiseProp:{value:mt,configurable:!0,writable:!0},all:mt.all,race:mt.race,allSettled:mt.allSettled,any:mt.any,resolve:mt.resolve,reject:mt.reject,nthen:KN(i.nthen,a),gthen:KN(i.gthen,a)}:{},t&&Zs(a,t),++s.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var o=Od(a,e,r,n);return a.ref===0&&a.finalize(),o}function Rd(){return Ts.id||(Ts.id=++gM),++Ts.awaits,Ts.echoes+=zj,Ts.id}function hl(){return!!Ts.awaits&&(--Ts.awaits==0&&(Ts.id=0),Ts.echoes=Ts.awaits*zj,!0)}function Fm(e){return Ts.echoes&&e&&e.constructor===E1?(Rd(),e.then(t=>(hl(),t),t=>(hl(),Vn(t)))):e}function vM(e){++wg,Ts.echoes&&--Ts.echoes!=0||(Ts.echoes=Ts.id=0),T1.push(Dt),_c(e,!0)}function yM(){var e=T1[T1.length-1];T1.pop(),_c(e,!1)}function _c(e,t){var r=Dt;if((t?!Ts.echoes||Y2++&&e===Dt:!Y2||--Y2&&e===Dt)||Xj(t?vM.bind(null,e):yM),e!==Dt&&(Dt=e,r===Yf&&(Yf.env=Yj()),vb)){var n=Yf.env.Promise,s=e.env;vg.then=s.nthen,n.prototype.then=s.gthen,(r.global||e.global)&&(Object.defineProperty(Hr,"Promise",s.PromiseProp),n.all=s.all,n.race=s.race,n.resolve=s.resolve,n.reject=s.reject,s.allSettled&&(n.allSettled=s.allSettled),s.any&&(n.any=s.any))}}function Yj(){var e=Hr.Promise;return vb?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Hr,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:vg.then,gthen:e.prototype.then}:{}}function Od(e,t,r,n,s){var a=Dt;try{return _c(e,!0),t(r,n,s)}finally{_c(a,!1)}}function Xj(e){Hj.call(nw,e)}function bg(e,t,r,n){return typeof e!="function"?e:function(){var s=Dt;r&&Rd(),_c(t,!0);try{return e.apply(this,arguments)}finally{_c(s,!1),n&&Xj(hl)}}}function KN(e,t){return function(r,n){return e.call(this,bg(r,t),bg(n,t))}}(""+Hj).indexOf("[native code]")===-1&&(Rd=hl=Dr);const GN="unhandledrejection";function YN(e,t){var r;try{r=t.onuncatched(e)}catch{}if(r!==!1)try{var n,s={promise:t,reason:e};if(Hr.document&&document.createEvent?((n=document.createEvent("Event")).initEvent(GN,!0,!0),Zs(n,s)):Hr.CustomEvent&&Zs(n=new CustomEvent(GN,{detail:s}),s),n&&Hr.dispatchEvent&&(dispatchEvent(n),!Hr.PromiseRejectionEvent&&Hr.onunhandledrejection))try{Hr.onunhandledrejection(n)}catch{}wo&&n&&!n.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var Vn=mt.reject;function fw(e,t,r,n){if(e.idbdb&&(e._state.openComplete||Dt.letThrough||e._vip)){var s=e._createTransaction(t,r,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===gb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>fw(e,t,r,n))):Vn(a)}return s._promise(t,(a,i)=>kc(()=>(Dt.trans=s,n(a,i,s)))).then(a=>s._completion.then(()=>a))}if(e._state.openComplete)return Vn(new Ut.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Vn(new Ut.DatabaseClosed);e.open().catch(Dr)}return e._state.dbReadyPromise.then(()=>fw(e,t,r,n))}const XN="3.2.7",ou="",dw=-1/0,Bo="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Jj="String expected.",r0=[],_x=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),wM=_x,bM=_x,Qj=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),Ex="__dbnames",X2="readonly",J2="readwrite";function Fu(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const Zj={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Dm(e){return typeof e!="string"||/\./.test(e)?t=>t:t=>(t[e]===void 0&&e in t&&delete(t=Np(t))[e],t)}let NM=class{_trans(t,r,n){const s=this._tx||Dt.trans,a=this.name;function i(l,u,f){if(!f.schema[a])throw new Ut.NotFound("Table "+a+" not part of transaction");return r(f.idbtrans,f)}const o=Sp();try{return s&&s.db===this.db?s===Dt.trans?s._promise(t,i,n):kc(()=>s._promise(t,i,n),{trans:s,transless:Dt.transless||Dt}):fw(this.db,t,[this.name],i)}finally{o&&kp()}}get(t,r){return t&&t.constructor===Object?this.where(t).first(r):this._trans("readonly",n=>this.core.get({trans:n,key:t}).then(s=>this.hook.reading.fire(s))).then(r)}where(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(Ps(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const r=Dn(t);if(r.length===1)return this.where(r[0]).equals(t[r[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter(u=>{if(u.compound&&r.every(f=>u.keyPath.indexOf(f)>=0)){for(let f=0;f<r.length;++f)if(r.indexOf(u.keyPath[f])===-1)return!1;return!0}return!1}).sort((u,f)=>u.keyPath.length-f.keyPath.length)[0];if(n&&this.db._maxKey!==ou){const u=n.keyPath.slice(0,r.length);return this.where(u).equals(u.map(f=>t[f]))}!n&&wo&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${r.join("+")}]`);const{idxByName:s}=this.schema,a=this.db._deps.indexedDB;function i(u,f){try{return a.cmp(u,f)===0}catch{return!1}}const[o,l]=r.reduce(([u,f],h)=>{const p=s[h],d=t[h];return[u||p,u||!p?Fu(f,p&&p.multi?m=>{const g=al(m,h);return Ps(g)&&g.some(w=>i(d,w))}:m=>i(d,al(m,h))):f]},[null,null]);return o?this.where(o.name).equals(t[o.keyPath]).filter(l):n?this.filter(l):this.where(r).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,Ps(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const r=n=>{if(!n)return n;const s=Object.create(t.prototype);for(var a in n)if(Da(n,a))try{s[a]=n[a]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),t}defineClass(){return this.mapToClass(function(t){Zs(this,t)})}add(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Dm(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"add",keys:r!=null?[r]:null,values:[a]})).then(i=>i.numFailures?mt.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Fi(t,s,i)}catch{}return i})}update(t,r){if(typeof t!="object"||Ps(t))return this.where(":id").equals(t).modify(r);{const n=al(t,this.schema.primKey.keyPath);if(n===void 0)return Vn(new Ut.InvalidArgument("Given object does not contain its primary key"));try{typeof r!="function"?Dn(r).forEach(s=>{Fi(t,s,r[s])}):r(t,{value:t,primKey:n})}catch{}return this.where(":id").equals(n).modify(r)}}put(t,r){const{auto:n,keyPath:s}=this.schema.primKey;let a=t;return s&&n&&(a=Dm(s)(t)),this._trans("readwrite",i=>this.core.mutate({trans:i,type:"put",values:[a],keys:r!=null?[r]:null})).then(i=>i.numFailures?mt.reject(i.failures[0]):i.lastResult).then(i=>{if(s)try{Fi(t,s,i)}catch{}return i})}delete(t){return this._trans("readwrite",r=>this.core.mutate({trans:r,type:"delete",keys:[t]})).then(r=>r.numFailures?mt.reject(r.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:Zj})).then(t=>t.numFailures?mt.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",r=>this.core.getMany({keys:t,trans:r}).then(n=>n.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new Ut.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new Ut.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let f=l&&o?t.map(Dm(l)):t;return this.core.mutate({trans:i,type:"add",keys:s,values:f,wantResults:a}).then(({numFailures:h,results:p,lastResult:d,failures:m})=>{if(h===0)return a?p:d;throw new e0(`${this.name}.bulkAdd(): ${h} of ${u} operations failed`,m)})})}bulkPut(t,r,n){const s=Array.isArray(r)?r:void 0,a=(n=n||(s?void 0:r))?n.allKeys:void 0;return this._trans("readwrite",i=>{const{auto:o,keyPath:l}=this.schema.primKey;if(l&&s)throw new Ut.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new Ut.InvalidArgument("Arguments objects and keys must have the same length");const u=t.length;let f=l&&o?t.map(Dm(l)):t;return this.core.mutate({trans:i,type:"put",keys:s,values:f,wantResults:a}).then(({numFailures:h,results:p,lastResult:d,failures:m})=>{if(h===0)return a?p:d;throw new e0(`${this.name}.bulkPut(): ${h} of ${u} operations failed`,m)})})}bulkDelete(t){const r=t.length;return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:t})).then(({numFailures:n,lastResult:s,failures:a})=>{if(n===0)return s;throw new e0(`${this.name}.bulkDelete(): ${n} of ${r} operations failed`,a)})}};function n0(e){var t={},r=function(i,o){if(o){for(var l=arguments.length,u=new Array(l-1);--l;)u[l-1]=arguments[l];return t[i].subscribe.apply(null,u),e}if(typeof i=="string")return t[i]};r.addEventType=a;for(var n=1,s=arguments.length;n<s;++n)a(arguments[n]);return r;function a(i,o,l){if(typeof i!="object"){var u;o||(o=hM),l||(l=Dr);var f={subscribers:[],fire:l,subscribe:function(h){f.subscribers.indexOf(h)===-1&&(f.subscribers.push(h),f.fire=o(f.fire,h))},unsubscribe:function(h){f.subscribers=f.subscribers.filter(function(p){return p!==h}),f.fire=f.subscribers.reduce(o,l)}};return t[i]=r[i]=f,f}Dn(u=i).forEach(function(h){var p=u[h];if(Ps(p))a(h,u[h][0],u[h][1]);else{if(p!=="asap")throw new Ut.InvalidArgument("Invalid event config");var d=a(h,z0,function(){for(var m=arguments.length,g=new Array(m);m--;)g[m]=arguments[m];d.subscribers.forEach(function(w){Fj(function(){w.apply(null,g)})})})}})}}function kh(e,t){return Kf(t).from({prototype:e}),t}function uf(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Q2(e,t){e.filter=Fu(e.filter,t)}function Z2(e,t,r){var n=e.replayFilter;e.replayFilter=n?()=>Fu(n(),t()):t,e.justLimit=r&&!n}function C1(e,t){if(e.isPrimKey)return t.primaryKey;const r=t.getIndexByKeyPath(e.index);if(!r)throw new Ut.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return r}function JN(e,t,r){const n=C1(e,t.schema);return t.openCursor({trans:r,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:n,range:e.range}})}function Rm(e,t,r,n){const s=e.replayFilter?Fu(e.filter,e.replayFilter()):e.filter;if(e.or){const a={},i=(o,l,u)=>{if(!s||s(l,u,p=>l.stop(p),p=>l.fail(p))){var f=l.primaryKey,h=""+f;h==="[object ArrayBuffer]"&&(h=""+new Uint8Array(f)),Da(a,h)||(a[h]=!0,t(o,l,u))}};return Promise.all([e.or._iterate(i,r),QN(JN(e,n,r),e.algorithm,i,!e.keysOnly&&e.valueMapper)])}return QN(JN(e,n,r),Fu(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function QN(e,t,r,n){var s=Yr(n?(a,i,o)=>r(n(a),i,o):r);return e.then(a=>{if(a)return a.start(()=>{var i=()=>a.continue();t&&!t(a,o=>i=o,o=>{a.stop(o),i=Dr},o=>{a.fail(o),i=Dr})||s(a.value,a,o=>i=o),i()})})}function Ks(e,t){try{const r=ZN(e),n=ZN(t);if(r!==n)return r==="Array"?1:n==="Array"?-1:r==="binary"?1:n==="binary"?-1:r==="string"?1:n==="string"?-1:r==="Date"?1:n!=="Date"?NaN:-1;switch(r){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(s,a){const i=s.length,o=a.length,l=i<o?i:o;for(let u=0;u<l;++u)if(s[u]!==a[u])return s[u]<a[u]?-1:1;return i===o?0:i<o?-1:1}(eS(e),eS(t));case"Array":return function(s,a){const i=s.length,o=a.length,l=i<o?i:o;for(let u=0;u<l;++u){const f=Ks(s[u],a[u]);if(f!==0)return f}return i===o?0:i<o?-1:1}(e,t)}}catch{}return NaN}function ZN(e){const t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";const r=ew(e);return r==="ArrayBuffer"?"binary":r}function eS(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}let SM=class{_read(t,r){var n=this._ctx;return n.error?n.table._trans(null,Vn.bind(null,n.error)):n.table._trans("readonly",t).then(r)}_write(t){var r=this._ctx;return r.error?r.table._trans(null,Vn.bind(null,r.error)):r.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var r=this._ctx;r.algorithm=Fu(r.algorithm,t)}_iterate(t,r){return Rm(this._ctx,t,r,this._ctx.table.core)}clone(t){var r=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return t&&Zs(n,t),r._ctx=n,r}raw(){return this._ctx.valueMapper=null,this}each(t){var r=this._ctx;return this._read(n=>Rm(r,t,n,r.table.core))}count(t){return this._read(r=>{const n=this._ctx,s=n.table.core;if(uf(n,!0))return s.count({trans:r,query:{index:C1(n,s.schema),range:n.range}}).then(i=>Math.min(i,n.limit));var a=0;return Rm(n,()=>(++a,!1),r,s).then(()=>a)}).then(t)}sortBy(t,r){const n=t.split(".").reverse(),s=n[0],a=n.length-1;function i(u,f){return f?i(u[n[f]],f-1):u[s]}var o=this._ctx.dir==="next"?1:-1;function l(u,f){var h=i(u,a),p=i(f,a);return h<p?-o:h>p?o:0}return this.toArray(function(u){return u.sort(l)}).then(r)}toArray(t){return this._read(r=>{var n=this._ctx;if(n.dir==="next"&&uf(n,!0)&&n.limit>0){const{valueMapper:s}=n,a=C1(n,n.table.core.schema);return n.table.core.query({trans:r,limit:n.limit,values:!0,query:{index:a,range:n.range}}).then(({result:i})=>s?i.map(s):i)}{const s=[];return Rm(n,a=>s.push(a),r,n.table.core).then(()=>s)}},t)}offset(t){var r=this._ctx;return t<=0||(r.offset+=t,uf(r)?Z2(r,()=>{var n=t;return(s,a)=>n===0||(n===1?(--n,!1):(a(()=>{s.advance(n),n=0}),!1))}):Z2(r,()=>{var n=t;return()=>--n<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Z2(this._ctx,()=>{var r=t;return function(n,s,a){return--r<=0&&s(a),r>=0}},!0),this}until(t,r){return Q2(this._ctx,function(n,s,a){return!t(n.value)||(s(a),r)}),this}first(t){return this.limit(1).toArray(function(r){return r[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var r,n;return Q2(this._ctx,function(s){return t(s.value)}),r=this._ctx,n=t,r.isMatch=Fu(r.isMatch,n),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var r=this._ctx;return r.keysOnly=!r.isMatch,this.each(function(n,s){t(s.primaryKey,s)})}keys(t){var r=this._ctx;r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.key)}).then(function(){return n}).then(t)}primaryKeys(t){var r=this._ctx;if(r.dir==="next"&&uf(r,!0)&&r.limit>0)return this._read(s=>{var a=C1(r,r.table.core.schema);return r.table.core.query({trans:s,values:!1,limit:r.limit,query:{index:a,range:r.range}})}).then(({result:s})=>s).then(t);r.keysOnly=!r.isMatch;var n=[];return this.each(function(s,a){n.push(a.primaryKey)}).then(function(){return n}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(r){return r[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,r=t.index&&t.table.schema.idxByName[t.index];if(!r||!r.multi)return this;var n={};return Q2(this._ctx,function(s){var a=s.primaryKey.toString(),i=Da(n,a);return n[a]=!0,!i}),this}modify(t){var r=this._ctx;return this._write(n=>{var s;if(typeof t=="function")s=t;else{var a=Dn(t),i=a.length;s=function(g){for(var w=!1,x=0;x<i;++x){var y=a[x],b=t[y];al(g,y)!==b&&(Fi(g,y,b),w=!0)}return w}}const o=r.table.core,{outbound:l,extractKey:u}=o.schema.primaryKey,f=this.db._options.modifyChunkSize||200,h=[];let p=0;const d=[],m=(g,w)=>{const{failures:x,numFailures:y}=w;p+=g-y;for(let b of Dn(x))h.push(x[b])};return this.clone().primaryKeys().then(g=>{const w=x=>{const y=Math.min(f,g.length-x);return o.getMany({trans:n,keys:g.slice(x,x+y),cache:"immutable"}).then(b=>{const S=[],T=[],L=l?[]:null,A=[];for(let C=0;C<y;++C){const O=b[C],E={value:Np(O),primKey:g[x+C]};s.call(E,E.value,E)!==!1&&(E.value==null?A.push(g[x+C]):l||Ks(u(O),u(E.value))===0?(T.push(E.value),l&&L.push(g[x+C])):(A.push(g[x+C]),S.push(E.value)))}const D=uf(r)&&r.limit===1/0&&(typeof t!="function"||t===ev)&&{index:r.index,range:r.range};return Promise.resolve(S.length>0&&o.mutate({trans:n,type:"add",values:S}).then(C=>{for(let O in C.failures)A.splice(parseInt(O),1);m(S.length,C)})).then(()=>(T.length>0||D&&typeof t=="object")&&o.mutate({trans:n,type:"put",keys:L,values:T,criteria:D,changeSpec:typeof t!="function"&&t}).then(C=>m(T.length,C))).then(()=>(A.length>0||D&&t===ev)&&o.mutate({trans:n,type:"delete",keys:A,criteria:D}).then(C=>m(A.length,C))).then(()=>g.length>x+y&&w(x+f))})};return w(0).then(()=>{if(h.length>0)throw new xg("Error modifying one or more objects",h,p,d);return g.length})})})}delete(){var t=this._ctx,r=t.range;return uf(t)&&(t.isPrimKey&&!bM||r.type===3)?this._write(n=>{const{primaryKey:s}=t.table.core.schema,a=r;return t.table.core.count({trans:n,query:{index:s,range:a}}).then(i=>t.table.core.mutate({trans:n,type:"deleteRange",range:a}).then(({failures:o,lastResult:l,results:u,numFailures:f})=>{if(f)throw new xg("Could not delete some values",Object.keys(o).map(h=>o[h]),i-f);return i-f}))}):this.modify(ev)}};const ev=(e,t)=>t.value=null;function kM(e,t){return e<t?-1:e===t?0:1}function _M(e,t){return e>t?-1:e===t?0:1}function Ea(e,t,r){var n=e instanceof tT?new e.Collection(e):e;return n._ctx.error=r?new r(t):new TypeError(t),n}function ff(e){return new e.Collection(e,()=>eT("")).limit(0)}function EM(e,t,r,n,s,a){for(var i=Math.min(e.length,n.length),o=-1,l=0;l<i;++l){var u=t[l];if(u!==n[l])return s(e[l],r[l])<0?e.substr(0,l)+r[l]+r.substr(l+1):s(e[l],n[l])<0?e.substr(0,l)+n[l]+r.substr(l+1):o>=0?e.substr(0,o)+t[o]+r.substr(o+1):null;s(e[l],u)<0&&(o=l)}return i<n.length&&a==="next"?e+r.substr(e.length):i<e.length&&a==="prev"?e.substr(0,r.length):o<0?null:e.substr(0,o)+n[o]+r.substr(o+1)}function Om(e,t,r,n){var s,a,i,o,l,u,f,h=r.length;if(!r.every(g=>typeof g=="string"))return Ea(e,Jj);function p(g){s=function(x){return x==="next"?y=>y.toUpperCase():y=>y.toLowerCase()}(g),a=function(x){return x==="next"?y=>y.toLowerCase():y=>y.toUpperCase()}(g),i=g==="next"?kM:_M;var w=r.map(function(x){return{lower:a(x),upper:s(x)}}).sort(function(x,y){return i(x.lower,y.lower)});o=w.map(function(x){return x.upper}),l=w.map(function(x){return x.lower}),u=g,f=g==="next"?"":n}p("next");var d=new e.Collection(e,()=>zl(o[0],l[h-1]+n));d._ondirectionchange=function(g){p(g)};var m=0;return d._addAlgorithm(function(g,w,x){var y=g.key;if(typeof y!="string")return!1;var b=a(y);if(t(b,l,m))return!0;for(var S=null,T=m;T<h;++T){var L=EM(y,b,o[T],l[T],i,u);L===null&&S===null?m=T+1:(S===null||i(S,L)>0)&&(S=L)}return w(S!==null?function(){g.continue(S+f)}:x),!1}),d}function zl(e,t,r,n){return{type:2,lower:e,upper:t,lowerOpen:r,upperOpen:n}}function eT(e){return{type:1,lower:e,upper:e}}class tT{get Collection(){return this._ctx.table.db.Collection}between(t,r,n,s){n=n!==!1,s=s===!0;try{return this._cmp(t,r)>0||this._cmp(t,r)===0&&(n||s)&&(!n||!s)?ff(this):new this.Collection(this,()=>zl(t,r,!n,!s))}catch{return Ea(this,Bo)}}equals(t){return t==null?Ea(this,Bo):new this.Collection(this,()=>eT(t))}above(t){return t==null?Ea(this,Bo):new this.Collection(this,()=>zl(t,void 0,!0))}aboveOrEqual(t){return t==null?Ea(this,Bo):new this.Collection(this,()=>zl(t,void 0,!1))}below(t){return t==null?Ea(this,Bo):new this.Collection(this,()=>zl(void 0,t,!1,!0))}belowOrEqual(t){return t==null?Ea(this,Bo):new this.Collection(this,()=>zl(void 0,t))}startsWith(t){return typeof t!="string"?Ea(this,Jj):this.between(t,t+ou,!0,!0)}startsWithIgnoreCase(t){return t===""?this.startsWith(t):Om(this,(r,n)=>r.indexOf(n[0])===0,[t],ou)}equalsIgnoreCase(t){return Om(this,(r,n)=>r===n[0],[t],"")}anyOfIgnoreCase(){var t=Jo.apply(Nf,arguments);return t.length===0?ff(this):Om(this,(r,n)=>n.indexOf(r)!==-1,t,"")}startsWithAnyOfIgnoreCase(){var t=Jo.apply(Nf,arguments);return t.length===0?ff(this):Om(this,(r,n)=>n.some(s=>r.indexOf(s)===0),t,ou)}anyOf(){const t=Jo.apply(Nf,arguments);let r=this._cmp;try{t.sort(r)}catch{return Ea(this,Bo)}if(t.length===0)return ff(this);const n=new this.Collection(this,()=>zl(t[0],t[t.length-1]));n._ondirectionchange=a=>{r=a==="next"?this._ascending:this._descending,t.sort(r)};let s=0;return n._addAlgorithm((a,i,o)=>{const l=a.key;for(;r(l,t[s])>0;)if(++s,s===t.length)return i(o),!1;return r(l,t[s])===0||(i(()=>{a.continue(t[s])}),!1)}),n}notEqual(t){return this.inAnyRange([[dw,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=Jo.apply(Nf,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return Ea(this,Bo)}const r=t.reduce((n,s)=>n?n.concat([[n[n.length-1][1],s]]):[[dw,s]],null);return r.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(r,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,r){const n=this._cmp,s=this._ascending,a=this._descending,i=this._min,o=this._max;if(t.length===0)return ff(this);if(!t.every(y=>y[0]!==void 0&&y[1]!==void 0&&s(y[0],y[1])<=0))return Ea(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ut.InvalidArgument);const l=!r||r.includeLowers!==!1,u=r&&r.includeUppers===!0;let f,h=s;function p(y,b){return h(y[0],b[0])}try{f=t.reduce(function(y,b){let S=0,T=y.length;for(;S<T;++S){const L=y[S];if(n(b[0],L[1])<0&&n(b[1],L[0])>0){L[0]=i(L[0],b[0]),L[1]=o(L[1],b[1]);break}}return S===T&&y.push(b),y},[]),f.sort(p)}catch{return Ea(this,Bo)}let d=0;const m=u?y=>s(y,f[d][1])>0:y=>s(y,f[d][1])>=0,g=l?y=>a(y,f[d][0])>0:y=>a(y,f[d][0])>=0;let w=m;const x=new this.Collection(this,()=>zl(f[0][0],f[f.length-1][1],!l,!u));return x._ondirectionchange=y=>{y==="next"?(w=m,h=s):(w=g,h=a),f.sort(p)},x._addAlgorithm((y,b,S)=>{for(var T=y.key;w(T);)if(++d,d===f.length)return b(S),!1;return!!function(L){return!m(L)&&!g(L)}(T)||(this._cmp(T,f[d][1])===0||this._cmp(T,f[d][0])===0||b(()=>{h===s?y.continue(f[d][0]):y.continue(f[d][1])}),!1)}),x}startsWithAnyOf(){const t=Jo.apply(Nf,arguments);return t.every(r=>typeof r=="string")?t.length===0?ff(this):this.inAnyRange(t.map(r=>[r,r+ou])):Ea(this,"startsWithAnyOf() only works with strings")}}function ro(e){return Yr(function(t){return q0(t),e(t.target.error),!1})}function q0(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const W0="storagemutated",Yl="x-storagemutated-1",Ec=n0(null,W0);class AM{_lock(){return Oh(!Dt.global),++this._reculock,this._reculock!==1||Dt.global||(Dt.lockOwnerFor=this),this}_unlock(){if(Oh(!Dt.global),--this._reculock==0)for(Dt.global||(Dt.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Od(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&Dt.lockOwnerFor!==this}create(t){if(!this.mode)return this;const r=this.db.idbdb,n=this.db._state.dbOpenError;if(Oh(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new Ut.DatabaseClosed(n);case"MissingAPIError":throw new Ut.MissingAPI(n.message,n);default:throw new Ut.OpenFailed(n)}if(!this.active)throw new Ut.TransactionInactive;return Oh(this._completion._state===null),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Yr(s=>{q0(s),this._reject(t.error)}),t.onabort=Yr(s=>{q0(s),this.active&&this._reject(new Ut.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=Yr(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&Ec.storagemutated.fire(t.mutatedParts)}),this}_promise(t,r,n){if(t==="readwrite"&&this.mode!=="readwrite")return Vn(new Ut.ReadOnly("Transaction is readonly"));if(!this.active)return Vn(new Ut.TransactionInactive);if(this._locked())return new mt((a,i)=>{this._blockedFuncs.push([()=>{this._promise(t,r,n).then(a,i)},Dt])});if(n)return kc(()=>{var a=new mt((i,o)=>{this._lock();const l=r(i,o,this);l&&l.then&&l.then(i,o)});return a.finally(()=>this._unlock()),a._lib=!0,a});var s=new mt((a,i)=>{var o=r(a,i,this);o&&o.then&&o.then(a,i)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var r=this._root();const n=mt.resolve(t);if(r._waitingFor)r._waitingFor=r._waitingFor.then(()=>n);else{r._waitingFor=n,r._waitingQueue=[];var s=r.idbtrans.objectStore(r.storeNames[0]);(function i(){for(++r._spinCount;r._waitingQueue.length;)r._waitingQueue.shift()();r._waitingFor&&(s.get(-1/0).onsuccess=i)})()}var a=r._waitingFor;return new mt((i,o)=>{n.then(l=>r._waitingQueue.push(Yr(i.bind(null,l))),l=>r._waitingQueue.push(Yr(o.bind(null,l)))).finally(()=>{r._waitingFor===a&&(r._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ut.Abort))}table(t){const r=this._memoizedTables||(this._memoizedTables={});if(Da(r,t))return r[t];const n=this.schema[t];if(!n)throw new Ut.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,n,this);return s.core=this.db.core.table(t),r[t]=s,s}}function hw(e,t,r,n,s,a,i){return{name:e,keyPath:t,unique:r,multi:n,auto:s,compound:a,src:(r&&!i?"&":"")+(n?"*":"")+(s?"++":"")+rT(t)}}function rT(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function nT(e,t,r){return{name:e,primKey:t,indexes:r,mappedClass:null,idxByName:Dj(r,n=>[n.name,n])}}let V0=e=>{try{return e.only([[]]),V0=()=>[[]],[[]]}catch{return V0=()=>ou,ou}};function pw(e){return e==null?()=>{}:typeof e=="string"?function(t){return t.split(".").length===1?n=>n[t]:n=>al(n,t)}(e):t=>al(t,e)}function tS(e){return[].slice.call(e)}let jM=0;function s0(e){return e==null?":id":typeof e=="string"?e:`[${e.join("+")}]`}function TM(e,t,r){function n(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:u,upper:f,lowerOpen:h,upperOpen:p}=l;return u===void 0?f===void 0?null:t.upperBound(f,!!p):f===void 0?t.lowerBound(u,!!h):t.bound(u,f,!!h,!!p)}const{schema:s,hasGetAll:a}=function(l,u){const f=tS(l.objectStoreNames);return{schema:{name:l.name,tables:f.map(h=>u.objectStore(h)).map(h=>{const{keyPath:p,autoIncrement:d}=h,m=Ps(p),g=p==null,w={},x={name:h.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:m,keyPath:p,autoIncrement:d,unique:!0,extractKey:pw(p)},indexes:tS(h.indexNames).map(y=>h.index(y)).map(y=>{const{name:b,unique:S,multiEntry:T,keyPath:L}=y,A={name:b,compound:Ps(L),keyPath:L,unique:S,multiEntry:T,extractKey:pw(L)};return w[s0(L)]=A,A}),getIndexByKeyPath:y=>w[s0(y)]};return w[":id"]=x.primaryKey,p!=null&&(w[s0(p)]=x.primaryKey),x})},hasGetAll:f.length>0&&"getAll"in u.objectStore(f[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,r),i=s.tables.map(l=>function(u){const f=u.name;return{name:f,schema:u,mutate:function({trans:h,type:p,keys:d,values:m,range:g}){return new Promise((w,x)=>{w=Yr(w);const y=h.objectStore(f),b=y.keyPath==null,S=p==="put"||p==="add";if(!S&&p!=="delete"&&p!=="deleteRange")throw new Error("Invalid operation type: "+p);const{length:T}=d||m||{length:1};if(d&&m&&d.length!==m.length)throw new Error("Given keys array must have same length as given values array.");if(T===0)return w({numFailures:0,failures:{},results:[],lastResult:void 0});let L;const A=[],D=[];let C=0;const O=P=>{++C,q0(P)};if(p==="deleteRange"){if(g.type===4)return w({numFailures:C,failures:D,results:[],lastResult:void 0});g.type===3?A.push(L=y.clear()):A.push(L=y.delete(n(g)))}else{const[P,q]=S?b?[m,d]:[m,null]:[d,null];if(S)for(let M=0;M<T;++M)A.push(L=q&&q[M]!==void 0?y[p](P[M],q[M]):y[p](P[M])),L.onerror=O;else for(let M=0;M<T;++M)A.push(L=y[p](P[M])),L.onerror=O}const E=P=>{const q=P.target.result;A.forEach((M,ne)=>M.error!=null&&(D[ne]=M.error)),w({numFailures:C,failures:D,results:p==="delete"?d:A.map(M=>M.result),lastResult:q})};L.onerror=P=>{O(P),E(P)},L.onsuccess=E})},getMany:({trans:h,keys:p})=>new Promise((d,m)=>{d=Yr(d);const g=h.objectStore(f),w=p.length,x=new Array(w);let y,b=0,S=0;const T=A=>{const D=A.target;x[D._pos]=D.result,++S===b&&d(x)},L=ro(m);for(let A=0;A<w;++A)p[A]!=null&&(y=g.get(p[A]),y._pos=A,y.onsuccess=T,y.onerror=L,++b);b===0&&d(x)}),get:({trans:h,key:p})=>new Promise((d,m)=>{d=Yr(d);const g=h.objectStore(f).get(p);g.onsuccess=w=>d(w.target.result),g.onerror=ro(m)}),query:function(h){return p=>new Promise((d,m)=>{d=Yr(d);const{trans:g,values:w,limit:x,query:y}=p,b=x===1/0?void 0:x,{index:S,range:T}=y,L=g.objectStore(f),A=S.isPrimaryKey?L:L.index(S.name),D=n(T);if(x===0)return d({result:[]});if(h){const C=w?A.getAll(D,b):A.getAllKeys(D,b);C.onsuccess=O=>d({result:O.target.result}),C.onerror=ro(m)}else{let C=0;const O=w||!("openKeyCursor"in A)?A.openCursor(D):A.openKeyCursor(D),E=[];O.onsuccess=P=>{const q=O.result;return q?(E.push(w?q.value:q.primaryKey),++C===x?d({result:E}):void q.continue()):d({result:E})},O.onerror=ro(m)}})}(a),openCursor:function({trans:h,values:p,query:d,reverse:m,unique:g}){return new Promise((w,x)=>{w=Yr(w);const{index:y,range:b}=d,S=h.objectStore(f),T=y.isPrimaryKey?S:S.index(y.name),L=m?g?"prevunique":"prev":g?"nextunique":"next",A=p||!("openKeyCursor"in T)?T.openCursor(n(b),L):T.openKeyCursor(n(b),L);A.onerror=ro(x),A.onsuccess=Yr(D=>{const C=A.result;if(!C)return void w(null);C.___id=++jM,C.done=!1;const O=C.continue.bind(C);let E=C.continuePrimaryKey;E&&(E=E.bind(C));const P=C.advance.bind(C),q=()=>{throw new Error("Cursor not stopped")};C.trans=h,C.stop=C.continue=C.continuePrimaryKey=C.advance=()=>{throw new Error("Cursor not started")},C.fail=Yr(x),C.next=function(){let M=1;return this.start(()=>M--?this.continue():this.stop()).then(()=>this)},C.start=M=>{const ne=new Promise((me,re)=>{me=Yr(me),A.onerror=ro(re),C.fail=re,C.stop=G=>{C.stop=C.continue=C.continuePrimaryKey=C.advance=q,me(G)}}),fe=()=>{if(A.result)try{M()}catch(me){C.fail(me)}else C.done=!0,C.start=()=>{throw new Error("Cursor behind last entry")},C.stop()};return A.onsuccess=Yr(me=>{A.onsuccess=fe,fe()}),C.continue=O,C.continuePrimaryKey=E,C.advance=P,fe(),ne},w(C)},x)})},count({query:h,trans:p}){const{index:d,range:m}=h;return new Promise((g,w)=>{const x=p.objectStore(f),y=d.isPrimaryKey?x:x.index(d.name),b=n(m),S=b?y.count(b):y.count();S.onsuccess=Yr(T=>g(T.target.result)),S.onerror=ro(w)})}}}(l)),o={};return i.forEach(l=>o[l.name]=l),{stack:"dbcore",transaction:e.transaction.bind(e),table(l){if(!o[l])throw new Error(`Table '${l}' not found`);return o[l]},MIN_KEY:-1/0,MAX_KEY:V0(t),schema:s}}function mw({_novip:e},t){const r=t.db,n=function(s,a,{IDBKeyRange:i,indexedDB:o},l){return{dbcore:function(f,h){return h.reduce((p,{create:d})=>({...p,...d(p)}),f)}(TM(a,i,l),s.dbcore)}}(e._middlewares,r,e._deps,t);e.core=n.dbcore,e.tables.forEach(s=>{const a=s.name;e.core.schema.tables.some(i=>i.name===a)&&(s.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=s.core))})}function Ng({_novip:e},t,r,n){r.forEach(s=>{const a=n[s];t.forEach(i=>{const o=hb(i,s);(!o||"value"in o&&o.value===void 0)&&(i===e.Transaction.prototype||i instanceof e.Transaction?sl(i,s,{get(){return this.table(s)},set(l){Pj(this,s,{value:l,writable:!0,configurable:!0,enumerable:!0})}}):i[s]=new e.Table(s,a))})})}function gw({_novip:e},t){t.forEach(r=>{for(let n in r)r[n]instanceof e.Table&&delete r[n]})}function CM(e,t){return e._cfg.version-t._cfg.version}function PM(e,t,r,n){const s=e._dbSchema,a=e._createTransaction("readwrite",e._storeNames,s);a.create(r),a._completion.catch(n);const i=a._reject.bind(a),o=Dt.transless||Dt;kc(()=>{Dt.trans=a,Dt.transless=o,t===0?(Dn(s).forEach(l=>{tv(r,l,s[l].primKey,s[l].indexes)}),mw(e,r),mt.follow(()=>e.on.populate.fire(a)).catch(i)):function({_novip:l},u,f,h){const p=[],d=l._versions;let m=l._dbSchema=vw(l,l.idbdb,h),g=!1;const w=d.filter(y=>y._cfg.version>=u);function x(){return p.length?mt.resolve(p.shift()(f.idbtrans)).then(x):mt.resolve()}return w.forEach(y=>{p.push(()=>{const b=m,S=y._cfg.dbschema;yw(l,b,h),yw(l,S,h),m=l._dbSchema=S;const T=sT(b,S);T.add.forEach(A=>{tv(h,A[0],A[1].primKey,A[1].indexes)}),T.change.forEach(A=>{if(A.recreate)throw new Ut.Upgrade("Not yet support for changing primary key");{const D=h.objectStore(A.name);A.add.forEach(C=>xw(D,C)),A.change.forEach(C=>{D.deleteIndex(C.name),xw(D,C)}),A.del.forEach(C=>D.deleteIndex(C))}});const L=y._cfg.contentUpgrade;if(L&&y._cfg.version>u){mw(l,h),f._memoizedTables={},g=!0;let A=Rj(S);T.del.forEach(E=>{A[E]=b[E]}),gw(l,[l.Transaction.prototype]),Ng(l,[l.Transaction.prototype],Dn(A),A),f.schema=A;const D=pb(L);let C;D&&Rd();const O=mt.follow(()=>{if(C=L(f),C&&D){var E=hl.bind(null,null);C.then(E,E)}});return C&&typeof C.then=="function"?mt.resolve(C):O.then(()=>C)}}),p.push(b=>{(!g||!wM)&&function(S,T){[].slice.call(T.db.objectStoreNames).forEach(L=>S[L]==null&&T.db.deleteObjectStore(L))}(y._cfg.dbschema,b),gw(l,[l.Transaction.prototype]),Ng(l,[l.Transaction.prototype],l._storeNames,l._dbSchema),f.schema=l._dbSchema})}),x().then(()=>{var y,b;b=h,Dn(y=m).forEach(S=>{b.db.objectStoreNames.contains(S)||tv(b,S,y[S].primKey,y[S].indexes)})})}(e,t,a,r).catch(i)})}function sT(e,t){const r={del:[],add:[],change:[]};let n;for(n in e)t[n]||r.del.push(n);for(n in t){const s=e[n],a=t[n];if(s){const i={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||s.primKey.auto!==a.primKey.auto&&!_x)i.recreate=!0,r.change.push(i);else{const o=s.idxByName,l=a.idxByName;let u;for(u in o)l[u]||i.del.push(u);for(u in l){const f=o[u],h=l[u];f?f.src!==h.src&&i.change.push(h):i.add.push(h)}(i.del.length>0||i.add.length>0||i.change.length>0)&&r.change.push(i)}}else r.add.push([n,a])}return r}function tv(e,t,r,n){const s=e.db.createObjectStore(t,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach(a=>xw(s,a)),s}function xw(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function vw(e,t,r){const n={};return gg(t.objectStoreNames,0).forEach(s=>{const a=r.objectStore(s);let i=a.keyPath;const o=hw(rT(i),i||"",!1,!1,!!a.autoIncrement,i&&typeof i!="string",!0),l=[];for(let f=0;f<a.indexNames.length;++f){const h=a.index(a.indexNames[f]);i=h.keyPath;var u=hw(h.name,i,!!h.unique,!!h.multiEntry,!1,i&&typeof i!="string",!1);l.push(u)}n[s]=nT(s,o,l)}),n}function yw({_novip:e},t,r){const n=r.db.objectStoreNames;for(let s=0;s<n.length;++s){const a=n[s],i=r.objectStore(a);e._hasGetAll="getAll"in i;for(let o=0;o<i.indexNames.length;++o){const l=i.indexNames[o],u=i.index(l).keyPath,f=typeof u=="string"?u:"["+gg(u).join("+")+"]";if(t[a]){const h=t[a].idxByName[f];h&&(h.name=l,delete t[a].idxByName[f],t[a].idxByName[l]=h)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Hr.WorkerGlobalScope&&Hr instanceof Hr.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class LM{_parseStoresSpec(t,r){Dn(t).forEach(n=>{if(t[n]!==null){var s=t[n].split(",").map((i,o)=>{const l=(i=i.trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(l)?l.match(/^\[(.*)\]$/)[1].split("+"):l;return hw(l,u||null,/\&/.test(i),/\*/.test(i),/\+\+/.test(i),Ps(u),o===0)}),a=s.shift();if(a.multi)throw new Ut.Schema("Primary key cannot be multi-valued");s.forEach(i=>{if(i.auto)throw new Ut.Schema("Only primary key can be marked as autoIncrement (++)");if(!i.keyPath)throw new Ut.Schema("Index must have a name and cannot be an empty string")}),r[n]=nT(n,a,s)}})}stores(t){const r=this.db;this._cfg.storesSource=this._cfg.storesSource?Zs(this._cfg.storesSource,t):t;const n=r._versions,s={};let a={};return n.forEach(i=>{Zs(s,i._cfg.storesSource),a=i._cfg.dbschema={},i._parseStoresSpec(s,a)}),r._dbSchema=a,gw(r,[r._allTables,r,r.Transaction.prototype]),Ng(r,[r._allTables,r,r.Transaction.prototype,this._cfg.tables],Dn(a),a),r._storeNames=Dn(a),this}upgrade(t){return this._cfg.contentUpgrade=xb(this._cfg.contentUpgrade||Dr,t),this}}function bb(e,t){let r=e._dbNamesDB;return r||(r=e._dbNamesDB=new bu(Ex,{addons:[],indexedDB:e,IDBKeyRange:t}),r.version(1).stores({dbnames:"name"})),r.table("dbnames")}function Nb(e){return e&&typeof e.databases=="function"}function ww(e){return kc(function(){return Dt.letThrough=!0,e()})}function FM(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var r=function(){return indexedDB.databases().finally(t)};e=setInterval(r,100),r()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function DM(e){const t=e._state,{indexedDB:r}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?Vn(t.dbOpenError):e);wo&&(t.openCanceller._stackHolder=zu()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const n=t.openCanceller;function s(){if(t.openCanceller!==n)throw new Ut.DatabaseClosed("db.open() was cancelled")}let a=t.dbReadyResolve,i=null,o=!1;const l=()=>new mt((u,f)=>{if(s(),!r)throw new Ut.MissingAPI;const h=e.name,p=t.autoSchema?r.open(h):r.open(h,Math.round(10*e.verno));if(!p)throw new Ut.MissingAPI;p.onerror=ro(f),p.onblocked=Yr(e._fireOnBlocked),p.onupgradeneeded=Yr(d=>{if(i=p.transaction,t.autoSchema&&!e._options.allowEmptyDB){p.onerror=q0,i.abort(),p.result.close();const g=r.deleteDatabase(h);g.onsuccess=g.onerror=Yr(()=>{f(new Ut.NoSuchDatabase(`Database ${h} doesnt exist`))})}else{i.onerror=ro(f);var m=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;o=m<1,e._novip.idbdb=p.result,PM(e,m/10,i,f)}},f),p.onsuccess=Yr(()=>{i=null;const d=e._novip.idbdb=p.result,m=gg(d.objectStoreNames);if(m.length>0)try{const w=d.transaction((g=m).length===1?g[0]:g,"readonly");t.autoSchema?function({_novip:x},y,b){x.verno=y.version/10;const S=x._dbSchema=vw(0,y,b);x._storeNames=gg(y.objectStoreNames,0),Ng(x,[x._allTables],Dn(S),S)}(e,d,w):(yw(e,e._dbSchema,w),function(x,y){const b=sT(vw(0,x.idbdb,y),x._dbSchema);return!(b.add.length||b.change.some(S=>S.add.length||S.change.length))}(e,w)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),mw(e,w)}catch{}var g;r0.push(e),d.onversionchange=Yr(w=>{t.vcFired=!0,e.on("versionchange").fire(w)}),d.onclose=Yr(w=>{e.on("close").fire(w)}),o&&function({indexedDB:w,IDBKeyRange:x},y){!Nb(w)&&y!==Ex&&bb(w,x).put({name:y}).catch(Dr)}(e._deps,h),u()},f)}).catch(u=>u&&u.name==="UnknownError"&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l()):mt.reject(u));return mt.race([n,(typeof navigator>"u"?mt.resolve():FM()).then(l)]).then(()=>(s(),t.onReadyBeingFired=[],mt.resolve(ww(()=>e.on.ready.fire(e.vip))).then(function u(){if(t.onReadyBeingFired.length>0){let f=t.onReadyBeingFired.reduce(xb,Dr);return t.onReadyBeingFired=[],mt.resolve(ww(()=>f(e.vip))).then(u)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(u=>{t.dbOpenError=u;try{i&&i.abort()}catch{}return n===t.openCanceller&&e._close(),Vn(u)}).finally(()=>{t.openComplete=!0,a()})}function bw(e){var t=a=>e.next(a),r=s(t),n=s(a=>e.throw(a));function s(a){return i=>{var o=a(i),l=o.value;return o.done?l:l&&typeof l.then=="function"?l.then(r,n):Ps(l)?Promise.all(l).then(r,n):r(l)}}return s(t)()}function RM(e,t,r){var n=arguments.length;if(n<2)throw new Ut.InvalidArgument("Too few arguments");for(var s=new Array(n-1);--n;)s[n-1]=arguments[n];return r=s.pop(),[e,Oj(s),r]}function aT(e,t,r,n,s){return mt.resolve().then(()=>{const a=Dt.transless||Dt,i=e._createTransaction(t,r,e._dbSchema,n),o={trans:i,transless:a};if(n)i.idbtrans=n.idbtrans;else try{i.create(),e._state.PR1398_maxLoop=3}catch(h){return h.name===gb.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>aT(e,t,r,null,s))):Vn(h)}const l=pb(s);let u;l&&Rd();const f=mt.follow(()=>{if(u=s.call(i,i),u)if(l){var h=hl.bind(null,null);u.then(h,h)}else typeof u.next=="function"&&typeof u.throw=="function"&&(u=bw(u))},o);return(u&&typeof u.then=="function"?mt.resolve(u).then(h=>i.active?h:Vn(new Ut.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):f.then(()=>u)).then(h=>(n&&i._resolve(),i._completion.then(()=>h))).catch(h=>(i._reject(h),Vn(h)))})}function Im(e,t,r){const n=Ps(e)?e.slice():[e];for(let s=0;s<r;++s)n.push(t);return n}const OM={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const r=e.table(t),{schema:n}=r,s={},a=[];function i(f,h,p){const d=s0(f),m=s[d]=s[d]||[],g=f==null?0:typeof f=="string"?1:f.length,w=h>0,x={...p,isVirtual:w,keyTail:h,keyLength:g,extractKey:pw(f),unique:!w&&p.unique};return m.push(x),x.isPrimaryKey||a.push(x),g>1&&i(g===2?f[0]:f.slice(0,g-1),h+1,p),m.sort((y,b)=>y.keyTail-b.keyTail),x}const o=i(n.primaryKey.keyPath,0,n.primaryKey);s[":id"]=[o];for(const f of n.indexes)i(f.keyPath,0,f);function l(f){const h=f.query.index;return h.isVirtual?{...f,query:{index:h,range:(p=f.query.range,d=h.keyTail,{type:p.type===1?2:p.type,lower:Im(p.lower,p.lowerOpen?e.MAX_KEY:e.MIN_KEY,d),lowerOpen:!0,upper:Im(p.upper,p.upperOpen?e.MIN_KEY:e.MAX_KEY,d),upperOpen:!0})}}:f;var p,d}return{...r,schema:{...n,primaryKey:o,indexes:a,getIndexByKeyPath:function(f){const h=s[s0(f)];return h&&h[0]}},count:f=>r.count(l(f)),query:f=>r.query(l(f)),openCursor(f){const{keyTail:h,isVirtual:p,keyLength:d}=f.query.index;return p?r.openCursor(l(f)).then(m=>m&&function(g){return Object.create(g,{continue:{value:function(x){x!=null?g.continue(Im(x,f.reverse?e.MAX_KEY:e.MIN_KEY,h)):f.unique?g.continue(g.key.slice(0,d).concat(f.reverse?e.MIN_KEY:e.MAX_KEY,h)):g.continue()}},continuePrimaryKey:{value(x,y){g.continuePrimaryKey(Im(x,e.MAX_KEY,h),y)}},primaryKey:{get:()=>g.primaryKey},key:{get(){const x=g.key;return d===1?x[0]:x.slice(0,d)}},value:{get:()=>g.value}})}(m)):r.openCursor(f)}}}}}};function Sb(e,t,r,n){return r=r||{},n=n||"",Dn(e).forEach(s=>{if(Da(t,s)){var a=e[s],i=t[s];if(typeof a=="object"&&typeof i=="object"&&a&&i){const o=ew(a);o!==ew(i)?r[n+s]=t[s]:o==="Object"?Sb(a,i,r,n+s+"."):a!==i&&(r[n+s]=t[s])}else a!==i&&(r[n+s]=t[s])}else r[n+s]=void 0}),Dn(t).forEach(s=>{Da(e,s)||(r[n+s]=t[s])}),r}const IM={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const r=e.table(t),{primaryKey:n}=r.schema;return{...r,mutate(a){const i=Dt.trans,{deleting:o,creating:l,updating:u}=i.table(t).hook;switch(a.type){case"add":if(l.fire===Dr)break;return i._promise("readwrite",()=>f(a),!0);case"put":if(l.fire===Dr&&u.fire===Dr)break;return i._promise("readwrite",()=>f(a),!0);case"delete":if(o.fire===Dr)break;return i._promise("readwrite",()=>f(a),!0);case"deleteRange":if(o.fire===Dr)break;return i._promise("readwrite",()=>function(p){return h(p.trans,p.range,1e4)}(a),!0)}return r.mutate(a);function f(p){const d=Dt.trans,m=p.keys||function(g,w){return w.type==="delete"?w.keys:w.keys||w.values.map(g.extractKey)}(n,p);if(!m)throw new Error("Keys missing");return(p=p.type==="add"||p.type==="put"?{...p,keys:m}:{...p}).type!=="delete"&&(p.values=[...p.values]),p.keys&&(p.keys=[...p.keys]),function(g,w,x){return w.type==="add"?Promise.resolve([]):g.getMany({trans:w.trans,keys:x,cache:"immutable"})}(r,p,m).then(g=>{const w=m.map((x,y)=>{const b=g[y],S={onerror:null,onsuccess:null};if(p.type==="delete")o.fire.call(S,x,b,d);else if(p.type==="add"||b===void 0){const T=l.fire.call(S,x,p.values[y],d);x==null&&T!=null&&(x=T,p.keys[y]=x,n.outbound||Fi(p.values[y],n.keyPath,x))}else{const T=Sb(b,p.values[y]),L=u.fire.call(S,T,x,b,d);if(L){const A=p.values[y];Object.keys(L).forEach(D=>{Da(A,D)?A[D]=L[D]:Fi(A,D,L[D])})}}return S});return r.mutate(p).then(({failures:x,results:y,numFailures:b,lastResult:S})=>{for(let T=0;T<m.length;++T){const L=y?y[T]:m[T],A=w[T];L==null?A.onerror&&A.onerror(x[T]):A.onsuccess&&A.onsuccess(p.type==="put"&&g[T]?p.values[T]:L)}return{failures:x,results:y,numFailures:b,lastResult:S}}).catch(x=>(w.forEach(y=>y.onerror&&y.onerror(x)),Promise.reject(x)))})}function h(p,d,m){return r.query({trans:p,values:!1,query:{index:n,range:d},limit:m}).then(({result:g})=>f({type:"delete",keys:g,trans:p}).then(w=>w.numFailures>0?Promise.reject(w.failures[0]):g.length<m?{failures:[],numFailures:0,lastResult:void 0}:h(p,{...d,lower:g[g.length-1],lowerOpen:!0},m)))}}}}})};function iT(e,t,r){try{if(!t||t.keys.length<e.length)return null;const n=[];for(let s=0,a=0;s<t.keys.length&&a<e.length;++s)Ks(t.keys[s],e[a])===0&&(n.push(r?Np(t.values[s]):t.values[s]),++a);return n.length===e.length?n:null}catch{return null}}const MM={stack:"dbcore",level:-1,create:e=>({table:t=>{const r=e.table(t);return{...r,getMany:n=>{if(!n.cache)return r.getMany(n);const s=iT(n.keys,n.trans._cache,n.cache==="clone");return s?mt.resolve(s):r.getMany(n).then(a=>(n.trans._cache={keys:n.keys,values:n.cache==="clone"?Np(a):a},a))},mutate:n=>(n.type!=="add"&&(n.trans._cache=null),r.mutate(n))}}})};function kb(e){return!("from"in e)}const Go=function(e,t){if(!this){const r=new Go;return e&&"d"in e&&Zs(r,e),r}Zs(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function K0(e,t,r){const n=Ks(t,r);if(isNaN(n))return;if(n>0)throw RangeError();if(kb(e))return Zs(e,{from:t,to:r,d:1});const s=e.l,a=e.r;if(Ks(r,e.from)<0)return s?K0(s,t,r):e.l={from:t,to:r,d:1,l:null,r:null},rS(e);if(Ks(t,e.to)>0)return a?K0(a,t,r):e.r={from:t,to:r,d:1,l:null,r:null},rS(e);Ks(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),Ks(r,e.to)>0&&(e.to=r,e.r=null,e.d=e.l?e.l.d+1:1);const i=!e.r;s&&!e.l&&Sg(e,s),a&&i&&Sg(e,a)}function Sg(e,t){kb(t)||function r(n,{from:s,to:a,l:i,r:o}){K0(n,s,a),i&&r(n,i),o&&r(n,o)}(e,t)}function BM(e,t){const r=Nw(t);let n=r.next();if(n.done)return!1;let s=n.value;const a=Nw(e);let i=a.next(s.from),o=i.value;for(;!n.done&&!i.done;){if(Ks(o.from,s.to)<=0&&Ks(o.to,s.from)>=0)return!0;Ks(s.from,o.from)<0?s=(n=r.next(o.from)).value:o=(i=a.next(s.from)).value}return!1}function Nw(e){let t=kb(e)?null:{s:0,n:e};return{next(r){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Ks(r,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Ks(r,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function rS(e){var t,r;const n=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((r=e.l)===null||r===void 0?void 0:r.d)||0),s=n>1?"r":n<-1?"l":"";if(s){const a=s==="r"?"l":"r",i={...e},o=e[s];e.from=o.from,e.to=o.to,e[s]=o[s],i[s]=o[a],e[a]=i,i.d=nS(i)}e.d=nS(e)}function nS({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Sd(Go.prototype,{add(e){return Sg(this,e),this},addKey(e){return K0(this,e,e),this},addKeys(e){return e.forEach(t=>K0(this,t,t)),this},[tw](){return Nw(this)}});const UM={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,r=new Go(e.MIN_KEY,e.MAX_KEY);return{...e,table:n=>{const s=e.table(n),{schema:a}=s,{primaryKey:i}=a,{extractKey:o,outbound:l}=i,u={...s,mutate:p=>{const d=p.trans,m=d.mutatedParts||(d.mutatedParts={}),g=L=>{const A=`idb://${t}/${n}/${L}`;return m[A]||(m[A]=new Go)},w=g(""),x=g(":dels"),{type:y}=p;let[b,S]=p.type==="deleteRange"?[p.range]:p.type==="delete"?[p.keys]:p.values.length<50?[[],p.values]:[];const T=p.trans._cache;return s.mutate(p).then(L=>{if(Ps(b)){y!=="delete"&&(b=L.results),w.addKeys(b);const A=iT(b,T);A||y==="add"||x.addKeys(b),(A||S)&&function(D,C,O,E){function P(q){const M=D(q.name||"");function ne(me){return me!=null?q.extractKey(me):null}const fe=me=>q.multiEntry&&Ps(me)?me.forEach(re=>M.addKey(re)):M.addKey(me);(O||E).forEach((me,re)=>{const G=O&&ne(O[re]),ge=E&&ne(E[re]);Ks(G,ge)!==0&&(G!=null&&fe(G),ge!=null&&fe(ge))})}C.indexes.forEach(P)}(g,a,A,S)}else if(b){const A={from:b.lower,to:b.upper};x.add(A),w.add(A)}else w.add(r),x.add(r),a.indexes.forEach(A=>g(A.name).add(r));return L})}},f=({query:{index:p,range:d}})=>{var m,g;return[p,new Go((m=d.lower)!==null&&m!==void 0?m:e.MIN_KEY,(g=d.upper)!==null&&g!==void 0?g:e.MAX_KEY)]},h={get:p=>[i,new Go(p.key)],getMany:p=>[i,new Go().addKeys(p.keys)],count:f,query:f,openCursor:f};return Dn(h).forEach(p=>{u[p]=function(d){const{subscr:m}=Dt;if(m){const g=S=>{const T=`idb://${t}/${n}/${S}`;return m[T]||(m[T]=new Go)},w=g(""),x=g(":dels"),[y,b]=h[p](d);if(g(y.name||"").add(b),!y.isPrimaryKey){if(p!=="count"){const S=p==="query"&&l&&d.values&&s.query({...d,values:!1});return s[p].apply(this,arguments).then(T=>{if(p==="query"){if(l&&d.values)return S.then(({result:A})=>(w.addKeys(A),T));const L=d.values?T.result.map(o):T.result;d.values?w.addKeys(L):x.addKeys(L)}else if(p==="openCursor"){const L=T,A=d.values;return L&&Object.create(L,{key:{get:()=>(x.addKey(L.primaryKey),L.key)},primaryKey:{get(){const D=L.primaryKey;return x.addKey(D),D}},value:{get:()=>(A&&w.addKey(L.primaryKey),L.value)}})}return T})}x.add(r)}}return s[p].apply(this,arguments)}}),u}}}};class bu{constructor(t,r){this._middlewares={},this.verno=0;const n=bu.dependencies;this._options=r={addons:bu.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...r},this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};const{addons:s}=r;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Dr,dbReadyPromise:null,cancelOpen:Dr,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var i;a.dbReadyPromise=new mt(o=>{a.dbReadyResolve=o}),a.openCanceller=new mt((o,l)=>{a.cancelOpen=l}),this._state=a,this.name=t,this.on=n0(this,"populate","blocked","versionchange","close",{ready:[xb,Dr]}),this.on.ready.subscribe=Lj(this.on.ready.subscribe,o=>(l,u)=>{bu.vip(()=>{const f=this._state;if(f.openComplete)f.dbOpenError||mt.resolve().then(l),u&&o(l);else if(f.onReadyBeingFired)f.onReadyBeingFired.push(l),u&&o(l);else{o(l);const h=this;u||o(function p(){h.on.ready.unsubscribe(l),h.on.ready.unsubscribe(p)})}})}),this.Collection=(i=this,kh(SM.prototype,function(o,l){this.db=i;let u=Zj,f=null;if(l)try{u=l()}catch(m){f=m}const h=o._ctx,p=h.table,d=p.hook.reading.fire;this._ctx={table:p,index:h.index,isPrimKey:!h.index||p.schema.primKey.keyPath&&h.index===p.schema.primKey.name,range:u,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:f,or:h.or,valueMapper:d!==z0?d:null}})),this.Table=function(o){return kh(NM.prototype,function(l,u,f){this.db=o,this._tx=f,this.name=l,this.schema=u,this.hook=o._allTables[l]?o._allTables[l].hook:n0(null,{creating:[uM,Dr],reading:[cM,z0],updating:[dM,Dr],deleting:[fM,Dr]})})}(this),this.Transaction=function(o){return kh(AM.prototype,function(l,u,f,h,p){this.db=o,this.mode=l,this.storeNames=u,this.schema=f,this.chromeTransactionDurability=h,this.idbtrans=null,this.on=n0(this,"complete","error","abort"),this.parent=p||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new mt((d,m)=>{this._resolve=d,this._reject=m}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},d=>{var m=this.active;return this.active=!1,this.on.error.fire(d),this.parent?this.parent._reject(d):m&&this.idbtrans&&this.idbtrans.abort(),Vn(d)})})}(this),this.Version=function(o){return kh(LM.prototype,function(l){this.db=o,this._cfg={version:l,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(o){return kh(tT.prototype,function(l,u,f){this.db=o,this._ctx={table:l,index:u===":id"?null:u,or:f};const h=o._deps.indexedDB;if(!h)throw new Ut.MissingAPI;this._cmp=this._ascending=h.cmp.bind(h),this._descending=(p,d)=>h.cmp(d,p),this._max=(p,d)=>h.cmp(p,d)>0?p:d,this._min=(p,d)=>h.cmp(p,d)<0?p:d,this._IDBKeyRange=o._deps.IDBKeyRange})}(this),this.on("versionchange",o=>{o.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",o=>{!o.newVersion||o.newVersion<o.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${o.oldVersion/10}`)}),this._maxKey=V0(r.IDBKeyRange),this._createTransaction=(o,l,u,f)=>new this.Transaction(o,l,u,this._options.chromeTransactionDurability,f),this._fireOnBlocked=o=>{this.on("blocked").fire(o),r0.filter(l=>l.name===this.name&&l!==this&&!l._state.vcFired).map(l=>l.on("versionchange").fire(o))},this.use(OM),this.use(IM),this.use(UM),this.use(MM),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(o=>o(this))}version(t){if(isNaN(t)||t<.1)throw new Ut.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new Ut.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const r=this._versions;var n=r.filter(s=>s._cfg.version===t)[0];return n||(n=new this.Version(t),r.push(n),r.sort(CM),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(t){return this.idbdb&&(this._state.openComplete||Dt.letThrough||this._vip)?t():new mt((r,n)=>{if(this._state.openComplete)return n(new Ut.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void n(new Ut.DatabaseClosed);this.open().catch(Dr)}this._state.dbReadyPromise.then(r,n)}).then(t)}use({stack:t,create:r,level:n,name:s}){s&&this.unuse({stack:t,name:s});const a=this._middlewares[t]||(this._middlewares[t]=[]);return a.push({stack:t,create:r,level:n??10,name:s}),a.sort((i,o)=>i.level-o.level),this}unuse({stack:t,name:r,create:n}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>n?s.create!==n:!!r&&s.name!==r)),this}open(){return DM(this)}_close(){const t=this._state,r=r0.indexOf(this);if(r>=0&&r0.splice(r,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new mt(n=>{t.dbReadyResolve=n}),t.openCanceller=new mt((n,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new Ut.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,r=this._state;return new mt((n,s)=>{const a=()=>{this.close();var i=this._deps.indexedDB.deleteDatabase(this.name);i.onsuccess=Yr(()=>{(function({indexedDB:o,IDBKeyRange:l},u){!Nb(o)&&u!==Ex&&bb(o,l).delete(u).catch(Dr)})(this._deps,this.name),n()}),i.onerror=ro(s),i.onblocked=this._fireOnBlocked};if(t)throw new Ut.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})}backendDB(){return this.idbdb}isOpen(){return this.idbdb!==null}hasBeenClosed(){const t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"}hasFailed(){return this._state.dbOpenError!==null}dynamicallyOpened(){return this._state.autoSchema}get tables(){return Dn(this._allTables).map(t=>this._allTables[t])}transaction(){const t=RM.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,r,n){let s=Dt.trans;s&&s.db===this&&t.indexOf("!")===-1||(s=null);const a=t.indexOf("?")!==-1;let i,o;t=t.replace("!","").replace("?","");try{if(o=r.map(u=>{var f=u instanceof this.Table?u.name:u;if(typeof f!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return f}),t=="r"||t===X2)i=X2;else{if(t!="rw"&&t!=J2)throw new Ut.InvalidArgument("Invalid transaction mode: "+t);i=J2}if(s){if(s.mode===X2&&i===J2){if(!a)throw new Ut.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&o.forEach(u=>{if(s&&s.storeNames.indexOf(u)===-1){if(!a)throw new Ut.SubTransaction("Table "+u+" not included in parent transaction.");s=null}}),a&&s&&!s.active&&(s=null)}}catch(u){return s?s._promise(null,(f,h)=>{h(u)}):Vn(u)}const l=aT.bind(null,this,i,o,s,n);return s?s._promise(i,l,"lock"):Dt.trans?Od(Dt.transless,()=>this._whenReady(l)):this._whenReady(l)}table(t){if(!Da(this._allTables,t))throw new Ut.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const $M=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class zM{constructor(t){this._subscribe=t}subscribe(t,r,n){return this._subscribe(t&&typeof t!="function"?t:{next:t,error:r,complete:n})}[$M](){return this}}function oT(e,t){return Dn(t).forEach(r=>{Sg(e[r]||(e[r]=new Go),t[r])}),e}function lT(e){let t,r=!1;const n=new zM(s=>{const a=pb(e);let i=!1,o={},l={};const u={get closed(){return i},unsubscribe:()=>{i=!0,Ec.storagemutated.unsubscribe(d)}};s.start&&s.start(u);let f=!1,h=!1;function p(){return Dn(l).some(g=>o[g]&&BM(o[g],l[g]))}const d=g=>{oT(o,g),p()&&m()},m=()=>{if(f||i)return;o={};const g={},w=function(x){a&&Rd();const y=()=>kc(e,{subscr:x,trans:null}),b=Dt.trans?Od(Dt.transless,y):y();return a&&b.then(hl,hl),b}(g);h||(Ec(W0,d),h=!0),f=!0,Promise.resolve(w).then(x=>{r=!0,t=x,f=!1,i||(p()?m():(o={},l=g,s.next&&s.next(x)))},x=>{f=!1,r=!1,s.error&&s.error(x),u.unsubscribe()})};return m(),u});return n.hasValue=()=>r,n.getValue=()=>t,n}let Sw;try{Sw={indexedDB:Hr.indexedDB||Hr.mozIndexedDB||Hr.webkitIndexedDB||Hr.msIndexedDB,IDBKeyRange:Hr.IDBKeyRange||Hr.webkitIDBKeyRange}}catch{Sw={indexedDB:null,IDBKeyRange:null}}const Xc=bu;function P1(e){let t=el;try{el=!0,Ec.storagemutated.fire(e)}finally{el=t}}Sd(Xc,{..._1,delete:e=>new Xc(e,{addons:[]}).delete(),exists:e=>new Xc(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:r}){return Nb(t)?Promise.resolve(t.databases()).then(n=>n.map(s=>s.name).filter(s=>s!==Ex)):bb(t,r).toCollection().primaryKeys()}(Xc.dependencies).then(e)}catch{return Vn(new Ut.MissingAPI)}},defineClass:()=>function(e){Zs(this,e)},ignoreTransaction:e=>Dt.trans?Od(Dt.transless,e):e(),vip:ww,async:function(e){return function(){try{var t=bw(e.apply(this,arguments));return t&&typeof t.then=="function"?t:mt.resolve(t)}catch(r){return Vn(r)}}},spawn:function(e,t,r){try{var n=bw(e.apply(r,t||[]));return n&&typeof n.then=="function"?n:mt.resolve(n)}catch(s){return Vn(s)}},currentTransaction:{get:()=>Dt.trans||null},waitFor:function(e,t){const r=mt.resolve(typeof e=="function"?Xc.ignoreTransaction(e):e).timeout(t||6e4);return Dt.trans?Dt.trans.waitFor(r):r},Promise:mt,debug:{get:()=>wo,set:e=>{Mj(e,e==="dexie"?()=>!0:Qj)}},derive:Kf,extend:Zs,props:Sd,override:Lj,Events:n0,on:Ec,liveQuery:lT,extendObservabilitySet:oT,getByKeyPath:al,setByKeyPath:Fi,delByKeyPath:function(e,t){typeof t=="string"?Fi(e,t,void 0):"length"in t&&[].map.call(t,function(r){Fi(e,r,void 0)})},shallowClone:Rj,deepClone:Np,getObjectDiff:Sb,cmp:Ks,asap:Fj,minKey:dw,addons:[],connections:r0,errnames:gb,dependencies:Sw,semVer:XN,version:XN.split(".").map(e=>parseInt(e)).reduce((e,t,r)=>e+t/Math.pow(10,2*r))}),Xc.maxKey=V0(Xc.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Ec(W0,e=>{if(!el){let t;_x?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Yl,!0,!0,e)):t=new CustomEvent(Yl,{detail:e}),el=!0,dispatchEvent(t),el=!1}}),addEventListener(Yl,({detail:e})=>{el||P1(e)}));let el=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Yl);typeof e.unref=="function"&&e.unref(),Ec(W0,t=>{el||e.postMessage(t)}),e.onmessage=t=>{t.data&&P1(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){Ec(W0,t=>{try{el||(typeof localStorage<"u"&&localStorage.setItem(Yl,JSON.stringify({trig:Math.random(),changedParts:t})),typeof self.clients=="object"&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(r=>r.postMessage({type:Yl,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Yl){const r=JSON.parse(t.newValue);r&&P1(r.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Yl&&P1(t.changedParts)})}mt.rejectionMapper=function(e,t){if(!e||e instanceof Gf||e instanceof TypeError||e instanceof SyntaxError||!e.name||!VN[e.name])return e;var r=new VN[e.name](t||e.message,e);return"stack"in e&&sl(r,"stack",{get:function(){return this.inner.stack}}),r},Mj(wo,Qj);class HM extends bu{constructor(){super("ProjetGestionDB");Pt(this,"users");Pt(this,"projects");Pt(this,"bordereaux");Pt(this,"periodes");Pt(this,"metres");Pt(this,"decompts");Pt(this,"photos");Pt(this,"pvs");Pt(this,"attachments");Pt(this,"syncOperations");Pt(this,"auditLogs");Pt(this,"companies");this.version(1).stores({users:"id, email",projects:"id, userId, status, annee, marcheNo",bordereaux:"id, projectId, userId, reference",metres:"id, projectId, bordereauLigneId, userId, reference",decompts:"id, projectId, userId, periode, numero",photos:"id, projectId, userId, syncStatus",pvs:"id, projectId, userId, type, date",attachments:"id, projectId, userId, category, syncStatus",syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(2).stores({syncOperations:"id, userId, deviceId, entity, timestamp, synced, syncedAt"}),this.version(3).stores({periodes:"id, projectId, userId, numero, statut",metres:"id, projectId, periodeId, bordereauLigneId, userId, reference",decompts:"id, projectId, periodeId, userId, numero"}),this.version(4).stores({periodes:"id, projectId, userId, numero, statut"}),this.version(5).stores({projects:"id, userId, status, annee, marcheNo"}),this.version(6).stores({users:"id, email, role, isActive, createdBy",auditLogs:"id, userId, action, entityType, timestamp"}),this.version(7).stores({companies:"id, userId, nom, rc, cnss, usageCount, lastUsed"}),this.version(8).stores({syncOperations:"id, userId, deviceId, entity, entityId, timestamp, synced, syncedAt, [userId+synced]",projects:"id, userId, status, annee, marcheNo, deletedAt",bordereaux:"id, projectId, userId, reference, deletedAt",metres:"id, projectId, periodeId, bordereauLigneId, userId, deletedAt",decompts:"id, projectId, periodeId, userId, numero, deletedAt",periodes:"id, projectId, userId, numero, statut, deletedAt"})}}const Le=new HM,yc=()=>typeof window>"u"?!1:window.navigator.userAgent.includes("Electron")||window.location.protocol==="app:"||window.electron!==void 0||window.electronAPI!==void 0,It=()=>!yc();typeof window<"u"&&(yc()?(console.log(" [PLATFORM] Electron Mode (OFFLINE-FIRST)"),console.log("    Primary storage: IndexedDB"),console.log("    Sync: Enabled"),console.log("    Offline work: Enabled")):(console.log(" [PLATFORM] Web Mode (SERVER-FIRST)"),console.log("    Primary storage: Server (PostgreSQL)"),console.log("    Sync: Disabled"),console.log("    Offline work: Disabled")));const qM=async()=>{console.log(" [WEB] Clearing all cached data for server-first mode...");try{await Le.projects.clear(),await Le.bordereaux.clear(),await Le.metres.clear(),await Le.decompts.clear(),await Le.periodes.clear(),await Le.pvs.clear(),await Le.photos.clear(),await Le.attachments.clear(),await Le.syncOperations.clear(),console.log(" [WEB] Cache cleared successfully")}catch(e){console.error(" [WEB] Failed to clear cache:",e)}},Rn=lb()(bO((e,t)=>({user:null,token:null,isLoading:!1,isInitialized:!1,error:null,login:async(r,n)=>{var s,a,i;e({isLoading:!0,error:null});try{const o=await Rt.login(r,n),{user:l,token:u}=o.data;if(localStorage.removeItem("lastSyncTimestamp"),localStorage.removeItem("sync-server-seq"),console.log(" Cleared lastSyncTimestamp for full sync"),It()&&await qM(),l.trialEndDate&&new Date(l.trialEndDate)<new Date)throw await Le.users.update(l.id,{isActive:!1}),new Error("Votre priode d'essai a expir. Veuillez contacter l'administrateur.");if(l.isActive===!1)throw new Error("Votre compte est dsactiv. Veuillez contacter l'administrateur.");await Le.users.update(l.id,{lastLogin:new Date().toISOString()}),localStorage.setItem("authToken",u),await Le.users.put({id:l.id,email:l.email,firstName:l.firstName,lastName:l.lastName,role:l.role||"user",isActive:l.isActive??!0,trialEndDate:l.trialEndDate,createdBy:l.createdBy,createdAt:l.createdAt||new Date().toISOString(),lastLogin:new Date().toISOString(),token:u}),e({user:l,token:u,isLoading:!1,isInitialized:!0})}catch(o){throw e({error:((i=(a=(s=o.response)==null?void 0:s.data)==null?void 0:a.error)==null?void 0:i.message)||o.message||"Login failed",isLoading:!1}),o}},register:async r=>{var n,s,a;e({isLoading:!0,error:null});try{console.log(" Sending registration request:",r);const i=await Rt.register(r);console.log(" Registration response:",i);const{user:o,token:l}=i.data;localStorage.setItem("authToken",l),await Le.users.put({id:o.id,email:o.email,firstName:o.firstName,lastName:o.lastName,role:o.role,isActive:o.isActive??!0,createdAt:o.createdAt||new Date().toISOString(),token:l}),e({user:o,token:l,isLoading:!1,isInitialized:!0})}catch(i){console.error(" Registration error:",i),console.error(" Error response:",i.response);const o=((a=(s=(n=i.response)==null?void 0:n.data)==null?void 0:s.error)==null?void 0:a.message)||i.message||"Registration failed";throw e({error:o,isLoading:!1}),i}},logout:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("lastSyncTimestamp"),localStorage.removeItem("auth-storage"),e({user:null,token:null,error:null,isInitialized:!0})},refreshToken:async()=>{var n;const r=localStorage.getItem("authToken");if(!r)return!1;try{console.log(" Attempting to refresh token from authStore...");const s=await Rt.refreshToken(r);if((n=s.data)!=null&&n.token){const a=s.data.token;return localStorage.setItem("authToken",a),e(i=>({...i,token:a})),console.log(" Token refreshed successfully in authStore"),!0}return!1}catch{return console.error(" Token refresh failed in authStore"),!1}},checkAuth:async()=>{var s,a;let r=localStorage.getItem("authToken");if(r||(r=t().token,r&&(localStorage.setItem("authToken",r),console.log(" Restored authToken to localStorage from state"))),!r){console.log(" No token found, setting initialized"),e({user:null,token:null,error:null,isInitialized:!0});return}const n=t();if(n.user&&n.token===r&&n.isInitialized){console.log(" Auth already validated, skipping API call");return}try{e({isLoading:!0}),console.log(" Checking auth with server...");const o=(await Rt.getCurrentUser()).data,l=localStorage.getItem("authToken")||r;console.log(" Auth check successful for user:",o.email),e({user:o,token:l,error:null,isInitialized:!0,isLoading:!1})}catch(i){const o=(s=i.response)==null?void 0:s.status;if(console.log(" Auth check failed:",o||i.message),o&&o>=500){console.warn(" Server error during auth check - preserving session for offline mode");const u=n.user;if(u)e({user:u,token:r,error:null,isInitialized:!0,isLoading:!1});else try{const h=(await Le.users.toArray()).find(p=>p.token===r);h?(console.log(" Using cached user from IndexedDB for offline mode"),e({user:h,token:r,error:null,isInitialized:!0,isLoading:!1})):e({user:null,token:r,error:"Server indisponible - mode hors ligne",isInitialized:!0,isLoading:!1})}catch{e({user:null,token:r,error:"Server indisponible - mode hors ligne",isInitialized:!0,isLoading:!1})}return}if(!i.response&&(i.code==="ERR_NETWORK"||i.message==="Network Error")){console.warn(" Network error - preserving session for offline mode");const u=n.user;e(u?{user:u,token:r,error:null,isInitialized:!0,isLoading:!1}:{user:null,token:r,error:"Hors ligne",isInitialized:!0,isLoading:!1});return}const l=localStorage.getItem("authToken");if(!l)console.log(" Token was cleared by interceptor, clearing state"),e({user:null,token:null,error:null,isInitialized:!0,isLoading:!1});else try{console.log(" Retrying auth check after potential refresh...");const f=(await Rt.getCurrentUser()).data,h=localStorage.getItem("authToken")||r;console.log(" Retry successful for user:",f.email),e({user:f,token:h,error:null,isInitialized:!0,isLoading:!1})}catch(u){const f=(a=u.response)==null?void 0:a.status;if(f&&f>=500){console.warn(" Server still down - preserving session"),e({user:n.user,token:l,error:"Server indisponible",isInitialized:!0,isLoading:!1});return}console.log(" Retry also failed, clearing state"),localStorage.removeItem("authToken"),localStorage.removeItem("auth-storage"),localStorage.removeItem("lastSyncTimestamp"),e({user:null,token:null,error:null,isInitialized:!0,isLoading:!1})}}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token}),onRehydrateStorage:()=>e=>{if(e!=null&&e.token){const t=localStorage.getItem("authToken");(!t||t!==e.token)&&(localStorage.setItem("authToken",e.token),console.log(" Synced authToken to localStorage on rehydrate"))}}}));function WM(e,t,r){var n,s;typeof e=="function"?(n=t||[],s=r):(n=[],s=t);var a=Vl.useRef({hasResult:!1,result:s,error:null}),i=Vl.useReducer(function(u){return u+1},0);i[0];var o=i[1],l=Vl.useMemo(function(){var u=typeof e=="function"?e():e;if(!u||typeof u.subscribe!="function")throw e===u?new TypeError("Given argument to useObservable() was neither a valid observable nor a function."):new TypeError("Observable factory given to useObservable() did not return a valid observable.");if(!a.current.hasResult&&typeof window<"u"&&(typeof u.hasValue!="function"||u.hasValue()))if(typeof u.getValue=="function")a.current.result=u.getValue(),a.current.hasResult=!0;else{var f=u.subscribe(function(h){a.current.result=h,a.current.hasResult=!0});typeof f=="function"?f():f.unsubscribe()}return u},n);if(Vl.useDebugValue(a.current.result),Vl.useEffect(function(){var u=l.subscribe(function(f){var h=a.current;(h.error!==null||h.result!==f)&&(h.error=null,h.result=f,h.hasResult=!0,o())},function(f){var h=a.current;h.error!==f&&(h.error=f,o())});return typeof u=="function"?u:u.unsubscribe.bind(u)},n),a.current.error)throw a.current.error;return a.current.result}function Js(e,t,r){return WM(function(){return lT(e)},t||[],r)}let Mm;const VM=new Uint8Array(16);function KM(){if(!Mm&&(Mm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mm(VM)}const is=[];for(let e=0;e<256;++e)is.push((e+256).toString(16).slice(1));function GM(e,t=0){return is[e[t+0]]+is[e[t+1]]+is[e[t+2]]+is[e[t+3]]+"-"+is[e[t+4]]+is[e[t+5]]+"-"+is[e[t+6]]+is[e[t+7]]+"-"+is[e[t+8]]+is[e[t+9]]+"-"+is[e[t+10]]+is[e[t+11]]+is[e[t+12]]+is[e[t+13]]+is[e[t+14]]+is[e[t+15]]}const YM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),sS={randomUUID:YM};function jr(e,t,r){if(sS.randomUUID&&!e)return sS.randomUUID();e=e||{};const n=e.random||(e.rng||KM)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,GM(n)}const kg={DEVICE_ID_KEY:"sync-device-id",LAST_SYNC_KEY:"lastSyncTimestamp"},aS=()=>typeof window>"u"?!1:window.navigator.userAgent.includes("Electron")||window.location.protocol==="app:"||window.electronAPI!==void 0,Mh=()=>{const e=aS()?`${kg.DEVICE_ID_KEY}-electron`:`${kg.DEVICE_ID_KEY}-browser`;let t=localStorage.getItem(e);return t||(t=`${aS()?"electron":"browser"}-${jr()}`,localStorage.setItem(e,t),console.log(" Generated new deviceId:",t)),t},iS=()=>{const e=localStorage.getItem(kg.LAST_SYNC_KEY);return e?parseInt(e,10):0},oS=e=>{localStorage.setItem(kg.LAST_SYNC_KEY,e.toString())},us=async(e,t,r,n,s)=>{const a=jr(),i={id:a,userId:s,deviceId:Mh(),type:e,entity:t,entityId:r,data:n,timestamp:Date.now(),synced:!1};return await Le.syncOperations.add(i),console.log(` Logged ${e} operation for ${t}:${r} (op_id: ${a})`),a},Uo=()=>navigator.onLine,XM=(e,t)=>(window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}),mo=Object.create(null);mo.open="0";mo.close="1";mo.ping="2";mo.pong="3";mo.message="4";mo.upgrade="5";mo.noop="6";const L1=Object.create(null);Object.keys(mo).forEach(e=>{L1[mo[e]]=e});const kw={type:"error",data:"parser error"},cT=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",uT=typeof ArrayBuffer=="function",fT=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,_b=({type:e,data:t},r,n)=>cT&&t instanceof Blob?r?n(t):lS(t,n):uT&&(t instanceof ArrayBuffer||fT(t))?r?n(t):lS(new Blob([t]),n):n(mo[e]+(t||"")),lS=(e,t)=>{const r=new FileReader;return r.onload=function(){const n=r.result.split(",")[1];t("b"+(n||""))},r.readAsDataURL(e)};function cS(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let rv;function JM(e,t){if(cT&&e.data instanceof Blob)return e.data.arrayBuffer().then(cS).then(t);if(uT&&(e.data instanceof ArrayBuffer||fT(e.data)))return t(cS(e.data));_b(e,!1,r=>{rv||(rv=new TextEncoder),t(rv.encode(r))})}const uS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bh=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let e=0;e<uS.length;e++)Bh[uS.charCodeAt(e)]=e;const QM=e=>{let t=e.length*.75,r=e.length,n,s=0,a,i,o,l;e[e.length-1]==="="&&(t--,e[e.length-2]==="="&&t--);const u=new ArrayBuffer(t),f=new Uint8Array(u);for(n=0;n<r;n+=4)a=Bh[e.charCodeAt(n)],i=Bh[e.charCodeAt(n+1)],o=Bh[e.charCodeAt(n+2)],l=Bh[e.charCodeAt(n+3)],f[s++]=a<<2|i>>4,f[s++]=(i&15)<<4|o>>2,f[s++]=(o&3)<<6|l&63;return u},ZM=typeof ArrayBuffer=="function",Eb=(e,t)=>{if(typeof e!="string")return{type:"message",data:dT(e,t)};const r=e.charAt(0);return r==="b"?{type:"message",data:e9(e.substring(1),t)}:L1[r]?e.length>1?{type:L1[r],data:e.substring(1)}:{type:L1[r]}:kw},e9=(e,t)=>{if(ZM){const r=QM(e);return dT(r,t)}else return{base64:!0,data:e}},dT=(e,t)=>{switch(t){case"blob":return e instanceof Blob?e:new Blob([e]);case"arraybuffer":default:return e instanceof ArrayBuffer?e:e.buffer}},hT="",t9=(e,t)=>{const r=e.length,n=new Array(r);let s=0;e.forEach((a,i)=>{_b(a,!1,o=>{n[i]=o,++s===r&&t(n.join(hT))})})},r9=(e,t)=>{const r=e.split(hT),n=[];for(let s=0;s<r.length;s++){const a=Eb(r[s],t);if(n.push(a),a.type==="error")break}return n};function n9(){return new TransformStream({transform(e,t){JM(e,r=>{const n=r.length;let s;if(n<126)s=new Uint8Array(1),new DataView(s.buffer).setUint8(0,n);else if(n<65536){s=new Uint8Array(3);const a=new DataView(s.buffer);a.setUint8(0,126),a.setUint16(1,n)}else{s=new Uint8Array(9);const a=new DataView(s.buffer);a.setUint8(0,127),a.setBigUint64(1,BigInt(n))}e.data&&typeof e.data!="string"&&(s[0]|=128),t.enqueue(s),t.enqueue(r)})}})}let nv;function Bm(e){return e.reduce((t,r)=>t+r.length,0)}function Um(e,t){if(e[0].length===t)return e.shift();const r=new Uint8Array(t);let n=0;for(let s=0;s<t;s++)r[s]=e[0][n++],n===e[0].length&&(e.shift(),n=0);return e.length&&n<e[0].length&&(e[0]=e[0].slice(n)),r}function s9(e,t){nv||(nv=new TextDecoder);const r=[];let n=0,s=-1,a=!1;return new TransformStream({transform(i,o){for(r.push(i);;){if(n===0){if(Bm(r)<1)break;const l=Um(r,1);a=(l[0]&128)===128,s=l[0]&127,s<126?n=3:s===126?n=1:n=2}else if(n===1){if(Bm(r)<2)break;const l=Um(r,2);s=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),n=3}else if(n===2){if(Bm(r)<8)break;const l=Um(r,8),u=new DataView(l.buffer,l.byteOffset,l.length),f=u.getUint32(0);if(f>Math.pow(2,21)-1){o.enqueue(kw);break}s=f*Math.pow(2,32)+u.getUint32(4),n=3}else{if(Bm(r)<s)break;const l=Um(r,s);o.enqueue(Eb(a?l:nv.decode(l),t)),n=0}if(s===0||s>e){o.enqueue(kw);break}}}})}const pT=4;function Fn(e){if(e)return a9(e)}function a9(e){for(var t in Fn.prototype)e[t]=Fn.prototype[t];return e}Fn.prototype.on=Fn.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this};Fn.prototype.once=function(e,t){function r(){this.off(e,r),t.apply(this,arguments)}return r.fn=t,this.on(e,r),this};Fn.prototype.off=Fn.prototype.removeListener=Fn.prototype.removeAllListeners=Fn.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks["$"+e];if(!r)return this;if(arguments.length==1)return delete this._callbacks["$"+e],this;for(var n,s=0;s<r.length;s++)if(n=r[s],n===t||n.fn===t){r.splice(s,1);break}return r.length===0&&delete this._callbacks["$"+e],this};Fn.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),r=this._callbacks["$"+e],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,t)}return this};Fn.prototype.emitReserved=Fn.prototype.emit;Fn.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]};Fn.prototype.hasListeners=function(e){return!!this.listeners(e).length};const Ax=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,r)=>r(t,0),Xa=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),i9="arraybuffer";function mT(e,...t){return t.reduce((r,n)=>(e.hasOwnProperty(n)&&(r[n]=e[n]),r),{})}const o9=Xa.setTimeout,l9=Xa.clearTimeout;function jx(e,t){t.useNativeTimers?(e.setTimeoutFn=o9.bind(Xa),e.clearTimeoutFn=l9.bind(Xa)):(e.setTimeoutFn=Xa.setTimeout.bind(Xa),e.clearTimeoutFn=Xa.clearTimeout.bind(Xa))}const c9=1.33;function u9(e){return typeof e=="string"?f9(e):Math.ceil((e.byteLength||e.size)*c9)}function f9(e){let t=0,r=0;for(let n=0,s=e.length;n<s;n++)t=e.charCodeAt(n),t<128?r+=1:t<2048?r+=2:t<55296||t>=57344?r+=3:(n++,r+=4);return r}function gT(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function d9(e){let t="";for(let r in e)e.hasOwnProperty(r)&&(t.length&&(t+="&"),t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t}function h9(e){let t={},r=e.split("&");for(let n=0,s=r.length;n<s;n++){let a=r[n].split("=");t[decodeURIComponent(a[0])]=decodeURIComponent(a[1])}return t}class p9 extends Error{constructor(t,r,n){super(t),this.description=r,this.context=n,this.type="TransportError"}}class Ab extends Fn{constructor(t){super(),this.writable=!1,jx(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,r,n){return super.emitReserved("error",new p9(t,r,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const r=Eb(t,this.socket.binaryType);this.onPacket(r)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,r={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(r)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const r=d9(t);return r.length?"?"+r:""}}class m9 extends Ab{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const r=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let n=0;this._polling&&(n++,this.once("pollComplete",function(){--n||r()})),this.writable||(n++,this.once("drain",function(){--n||r()}))}else r()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const r=n=>{if(this.readyState==="opening"&&n.type==="open"&&this.onOpen(),n.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(n)};r9(t,this.socket.binaryType).forEach(r),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,t9(t,r=>{this.doWrite(r,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",r=this.query||{};return this.opts.timestampRequests!==!1&&(r[this.opts.timestampParam]=gT()),!this.supportsBinary&&!r.sid&&(r.b64=1),this.createUri(t,r)}}let xT=!1;try{xT=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const g9=xT;function x9(){}class v9 extends m9{constructor(t){if(super(t),typeof location<"u"){const r=location.protocol==="https:";let n=location.port;n||(n=r?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||n!==t.port}}doWrite(t,r){const n=this.request({method:"POST",data:t});n.on("success",r),n.on("error",(s,a)=>{this.onError("xhr post error",s,a)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(r,n)=>{this.onError("xhr poll error",r,n)}),this.pollXhr=t}}class po extends Fn{constructor(t,r,n){super(),this.createRequest=t,jx(this,n),this._opts=n,this._method=n.method||"GET",this._uri=r,this._data=n.data!==void 0?n.data:null,this._create()}_create(){var t;const r=mT(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(r);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let s in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(s)&&n.setRequestHeader(s,this._opts.extraHeaders[s])}}catch{}if(this._method==="POST")try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var s;n.readyState===3&&((s=this._opts.cookieJar)===null||s===void 0||s.parseCookies(n.getResponseHeader("set-cookie"))),n.readyState===4&&(n.status===200||n.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof n.status=="number"?n.status:0)},0))},n.send(this._data)}catch(s){this.setTimeoutFn(()=>{this._onError(s)},0);return}typeof document<"u"&&(this._index=po.requestsCount++,po.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=x9,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete po.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}po.requestsCount=0;po.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",fS);else if(typeof addEventListener=="function"){const e="onpagehide"in Xa?"pagehide":"unload";addEventListener(e,fS,!1)}}function fS(){for(let e in po.requests)po.requests.hasOwnProperty(e)&&po.requests[e].abort()}const y9=function(){const e=vT({xdomain:!1});return e&&e.responseType!==null}();class w9 extends v9{constructor(t){super(t);const r=t&&t.forceBase64;this.supportsBinary=y9&&!r}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new po(vT,this.uri(),t)}}function vT(e){const t=e.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||g9))return new XMLHttpRequest}catch{}if(!t)try{return new Xa[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const yT=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class b9 extends Ab{get name(){return"websocket"}doOpen(){const t=this.uri(),r=this.opts.protocols,n=yT?{}:mT(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,r,n)}catch(s){return this.emitReserved("error",s)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;_b(n,this.supportsBinary,a=>{try{this.doWrite(n,a)}catch{}s&&Ax(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",r=this.query||{};return this.opts.timestampRequests&&(r[this.opts.timestampParam]=gT()),this.supportsBinary||(r.b64=1),this.createUri(t,r)}}const sv=Xa.WebSocket||Xa.MozWebSocket;class N9 extends b9{createSocket(t,r,n){return yT?new sv(t,r,n):r?new sv(t,r):new sv(t)}doWrite(t,r){this.ws.send(r)}}class S9 extends Ab{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const r=s9(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=t.readable.pipeThrough(r).getReader(),s=n9();s.readable.pipeTo(t.writable),this._writer=s.writable.getWriter();const a=()=>{n.read().then(({done:o,value:l})=>{o||(this.onPacket(l),a())}).catch(o=>{})};a();const i={type:"open"};this.query.sid&&(i.data=`{"sid":"${this.query.sid}"}`),this._writer.write(i).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let r=0;r<t.length;r++){const n=t[r],s=r===t.length-1;this._writer.write(n).then(()=>{s&&Ax(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const k9={websocket:N9,webtransport:S9,polling:w9},_9=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,E9=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function _w(e){if(e.length>8e3)throw"URI too long";const t=e,r=e.indexOf("["),n=e.indexOf("]");r!=-1&&n!=-1&&(e=e.substring(0,r)+e.substring(r,n).replace(/:/g,";")+e.substring(n,e.length));let s=_9.exec(e||""),a={},i=14;for(;i--;)a[E9[i]]=s[i]||"";return r!=-1&&n!=-1&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a.pathNames=A9(a,a.path),a.queryKey=j9(a,a.query),a}function A9(e,t){const r=/\/{2,9}/g,n=t.replace(r,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&n.splice(0,1),t.slice(-1)=="/"&&n.splice(n.length-1,1),n}function j9(e,t){const r={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(n,s,a){s&&(r[s]=a)}),r}const Ew=typeof addEventListener=="function"&&typeof removeEventListener=="function",F1=[];Ew&&addEventListener("offline",()=>{F1.forEach(e=>e())},!1);class wc extends Fn{constructor(t,r){if(super(),this.binaryType=i9,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(r=t,t=null),t){const n=_w(t);r.hostname=n.host,r.secure=n.protocol==="https"||n.protocol==="wss",r.port=n.port,n.query&&(r.query=n.query)}else r.host&&(r.hostname=_w(r.host).host);jx(this,r),this.secure=r.secure!=null?r.secure:typeof location<"u"&&location.protocol==="https:",r.hostname&&!r.port&&(r.port=this.secure?"443":"80"),this.hostname=r.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=r.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},r.transports.forEach(n=>{const s=n.prototype.name;this.transports.push(s),this._transportsByName[s]=n}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},r),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=h9(this.opts.query)),Ew&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},F1.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const r=Object.assign({},this.opts.query);r.EIO=pT,r.transport=t,this.id&&(r.sid=this.id);const n=Object.assign({},this.opts,{query:r,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](n)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&wc.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const r=this.createTransport(t);r.open(),this.setTransport(r)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",r=>this._onClose("transport close",r))}onOpen(){this.readyState="open",wc.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const r=new Error("server error");r.code=t.data,this._onError(r);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let r=1;for(let n=0;n<this.writeBuffer.length;n++){const s=this.writeBuffer[n].data;if(s&&(r+=u9(s)),n>0&&r>this._maxPayload)return this.writeBuffer.slice(0,n);r+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Ax(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,r,n){return this._sendPacket("message",t,r,n),this}send(t,r,n){return this._sendPacket("message",t,r,n),this}_sendPacket(t,r,n,s){if(typeof r=="function"&&(s=r,r=void 0),typeof n=="function"&&(s=n,n=null),this.readyState==="closing"||this.readyState==="closed")return;n=n||{},n.compress=n.compress!==!1;const a={type:t,data:r,options:n};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),s&&this.once("flush",s),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},r=()=>{this.off("upgrade",r),this.off("upgradeError",r),t()},n=()=>{this.once("upgrade",r),this.once("upgradeError",r)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():t()}):this.upgrading?n():t()),this}_onError(t){if(wc.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,r){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Ew&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const n=F1.indexOf(this._offlineEventListener);n!==-1&&F1.splice(n,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,r),this.writeBuffer=[],this._prevBufferLen=0}}}wc.protocol=pT;class T9 extends wc{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let r=this.createTransport(t),n=!1;wc.priorWebsocketSuccess=!1;const s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",h=>{if(!n)if(h.type==="pong"&&h.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",r),!r)return;wc.priorWebsocketSuccess=r.name==="websocket",this.transport.pause(()=>{n||this.readyState!=="closed"&&(f(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())})}else{const p=new Error("probe error");p.transport=r.name,this.emitReserved("upgradeError",p)}}))};function a(){n||(n=!0,f(),r.close(),r=null)}const i=h=>{const p=new Error("probe error: "+h);p.transport=r.name,a(),this.emitReserved("upgradeError",p)};function o(){i("transport closed")}function l(){i("socket closed")}function u(h){r&&h.name!==r.name&&a()}const f=()=>{r.removeListener("open",s),r.removeListener("error",i),r.removeListener("close",o),this.off("close",l),this.off("upgrading",u)};r.once("open",s),r.once("error",i),r.once("close",o),this.once("close",l),this.once("upgrading",u),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const r=[];for(let n=0;n<t.length;n++)~this.transports.indexOf(t[n])&&r.push(t[n]);return r}}let C9=class extends T9{constructor(t,r={}){const n=typeof t=="object"?t:r;(!n.transports||n.transports&&typeof n.transports[0]=="string")&&(n.transports=(n.transports||["polling","websocket","webtransport"]).map(s=>k9[s]).filter(s=>!!s)),super(t,n)}};function P9(e,t="",r){let n=e;r=r||typeof location<"u"&&location,e==null&&(e=r.protocol+"//"+r.host),typeof e=="string"&&(e.charAt(0)==="/"&&(e.charAt(1)==="/"?e=r.protocol+e:e=r.host+e),/^(https?|wss?):\/\//.test(e)||(typeof r<"u"?e=r.protocol+"//"+e:e="https://"+e),n=_w(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";const a=n.host.indexOf(":")!==-1?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+a+":"+n.port+t,n.href=n.protocol+"://"+a+(r&&r.port===n.port?"":":"+n.port),n}const L9=typeof ArrayBuffer=="function",F9=e=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer,wT=Object.prototype.toString,D9=typeof Blob=="function"||typeof Blob<"u"&&wT.call(Blob)==="[object BlobConstructor]",R9=typeof File=="function"||typeof File<"u"&&wT.call(File)==="[object FileConstructor]";function jb(e){return L9&&(e instanceof ArrayBuffer||F9(e))||D9&&e instanceof Blob||R9&&e instanceof File}function D1(e,t){if(!e||typeof e!="object")return!1;if(Array.isArray(e)){for(let r=0,n=e.length;r<n;r++)if(D1(e[r]))return!0;return!1}if(jb(e))return!0;if(e.toJSON&&typeof e.toJSON=="function"&&arguments.length===1)return D1(e.toJSON(),!0);for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&D1(e[r]))return!0;return!1}function O9(e){const t=[],r=e.data,n=e;return n.data=Aw(r,t),n.attachments=t.length,{packet:n,buffers:t}}function Aw(e,t){if(!e)return e;if(jb(e)){const r={_placeholder:!0,num:t.length};return t.push(e),r}else if(Array.isArray(e)){const r=new Array(e.length);for(let n=0;n<e.length;n++)r[n]=Aw(e[n],t);return r}else if(typeof e=="object"&&!(e instanceof Date)){const r={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=Aw(e[n],t));return r}return e}function I9(e,t){return e.data=jw(e.data,t),delete e.attachments,e}function jw(e,t){if(!e)return e;if(e&&e._placeholder===!0){if(typeof e.num=="number"&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}else if(Array.isArray(e))for(let r=0;r<e.length;r++)e[r]=jw(e[r],t);else if(typeof e=="object")for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=jw(e[r],t));return e}const M9=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],B9=5;var cr;(function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"})(cr||(cr={}));class U9{constructor(t){this.replacer=t}encode(t){return(t.type===cr.EVENT||t.type===cr.ACK)&&D1(t)?this.encodeAsBinary({type:t.type===cr.EVENT?cr.BINARY_EVENT:cr.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let r=""+t.type;return(t.type===cr.BINARY_EVENT||t.type===cr.BINARY_ACK)&&(r+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(r+=t.nsp+","),t.id!=null&&(r+=t.id),t.data!=null&&(r+=JSON.stringify(t.data,this.replacer)),r}encodeAsBinary(t){const r=O9(t),n=this.encodeAsString(r.packet),s=r.buffers;return s.unshift(n),s}}function dS(e){return Object.prototype.toString.call(e)==="[object Object]"}class Tb extends Fn{constructor(t){super(),this.reviver=t}add(t){let r;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");r=this.decodeString(t);const n=r.type===cr.BINARY_EVENT;n||r.type===cr.BINARY_ACK?(r.type=n?cr.EVENT:cr.ACK,this.reconstructor=new $9(r),r.attachments===0&&super.emitReserved("decoded",r)):super.emitReserved("decoded",r)}else if(jb(t)||t.base64)if(this.reconstructor)r=this.reconstructor.takeBinaryData(t),r&&(this.reconstructor=null,super.emitReserved("decoded",r));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let r=0;const n={type:Number(t.charAt(0))};if(cr[n.type]===void 0)throw new Error("unknown packet type "+n.type);if(n.type===cr.BINARY_EVENT||n.type===cr.BINARY_ACK){const a=r+1;for(;t.charAt(++r)!=="-"&&r!=t.length;);const i=t.substring(a,r);if(i!=Number(i)||t.charAt(r)!=="-")throw new Error("Illegal attachments");n.attachments=Number(i)}if(t.charAt(r+1)==="/"){const a=r+1;for(;++r&&!(t.charAt(r)===","||r===t.length););n.nsp=t.substring(a,r)}else n.nsp="/";const s=t.charAt(r+1);if(s!==""&&Number(s)==s){const a=r+1;for(;++r;){const i=t.charAt(r);if(i==null||Number(i)!=i){--r;break}if(r===t.length)break}n.id=Number(t.substring(a,r+1))}if(t.charAt(++r)){const a=this.tryParse(t.substr(r));if(Tb.isPayloadValid(n.type,a))n.data=a;else throw new Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,r){switch(t){case cr.CONNECT:return dS(r);case cr.DISCONNECT:return r===void 0;case cr.CONNECT_ERROR:return typeof r=="string"||dS(r);case cr.EVENT:case cr.BINARY_EVENT:return Array.isArray(r)&&(typeof r[0]=="number"||typeof r[0]=="string"&&M9.indexOf(r[0])===-1);case cr.ACK:case cr.BINARY_ACK:return Array.isArray(r)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class $9{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const r=I9(this.reconPack,this.buffers);return this.finishedReconstruction(),r}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const z9=Object.freeze(Object.defineProperty({__proto__:null,Decoder:Tb,Encoder:U9,get PacketType(){return cr},protocol:B9},Symbol.toStringTag,{value:"Module"}));function bi(e,t,r){return e.on(t,r),function(){e.off(t,r)}}const H9=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class bT extends Fn{constructor(t,r,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=r,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[bi(t,"open",this.onopen.bind(this)),bi(t,"packet",this.onpacket.bind(this)),bi(t,"error",this.onerror.bind(this)),bi(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...r){var n,s,a;if(H9.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(r.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(r),this;const i={type:cr.EVENT,data:r};if(i.options={},i.options.compress=this.flags.compress!==!1,typeof r[r.length-1]=="function"){const f=this.ids++,h=r.pop();this._registerAckCallback(f,h),i.id=f}const o=(s=(n=this.io.engine)===null||n===void 0?void 0:n.transport)===null||s===void 0?void 0:s.writable,l=this.connected&&!(!((a=this.io.engine)===null||a===void 0)&&a._hasPingExpired());return this.flags.volatile&&!o||(l?(this.notifyOutgoingListeners(i),this.packet(i)):this.sendBuffer.push(i)),this.flags={},this}_registerAckCallback(t,r){var n;const s=(n=this.flags.timeout)!==null&&n!==void 0?n:this._opts.ackTimeout;if(s===void 0){this.acks[t]=r;return}const a=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let o=0;o<this.sendBuffer.length;o++)this.sendBuffer[o].id===t&&this.sendBuffer.splice(o,1);r.call(this,new Error("operation has timed out"))},s),i=(...o)=>{this.io.clearTimeoutFn(a),r.apply(this,o)};i.withError=!0,this.acks[t]=i}emitWithAck(t,...r){return new Promise((n,s)=>{const a=(i,o)=>i?s(i):n(o);a.withError=!0,r.push(a),this.emit(t,...r)})}_addToQueue(t){let r;typeof t[t.length-1]=="function"&&(r=t.pop());const n={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((s,...a)=>n!==this._queue[0]?void 0:(s!==null?n.tryCount>this._opts.retries&&(this._queue.shift(),r&&r(s)):(this._queue.shift(),r&&r(null,...a)),n.pending=!1,this._drainQueue())),this._queue.push(n),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const r=this._queue[0];r.pending&&!t||(r.pending=!0,r.tryCount++,this.flags=r.flags,this.emit.apply(this,r.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:cr.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,r){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,r),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(n=>String(n.id)===t)){const n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case cr.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case cr.EVENT:case cr.BINARY_EVENT:this.onevent(t);break;case cr.ACK:case cr.BINARY_ACK:this.onack(t);break;case cr.DISCONNECT:this.ondisconnect();break;case cr.CONNECT_ERROR:this.destroy();const n=new Error(t.data.message);n.data=t.data.data,this.emitReserved("connect_error",n);break}}onevent(t){const r=t.data||[];t.id!=null&&r.push(this.ack(t.id)),this.connected?this.emitEvent(r):this.receiveBuffer.push(Object.freeze(r))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const r=this._anyListeners.slice();for(const n of r)n.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const r=this;let n=!1;return function(...s){n||(n=!0,r.packet({type:cr.ACK,id:t,data:s}))}}onack(t){const r=this.acks[t.id];typeof r=="function"&&(delete this.acks[t.id],r.withError&&t.data.unshift(null),r.apply(this,t.data))}onconnect(t,r){this.id=t,this.recovered=r&&this._pid===r,this._pid=r,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:cr.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const r=this._anyListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const r=this._anyOutgoingListeners;for(let n=0;n<r.length;n++)if(t===r[n])return r.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const r=this._anyOutgoingListeners.slice();for(const n of r)n.apply(this,t.data)}}}function Id(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}Id.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),r=Math.floor(t*this.jitter*e);e=Math.floor(t*10)&1?e+r:e-r}return Math.min(e,this.max)|0};Id.prototype.reset=function(){this.attempts=0};Id.prototype.setMin=function(e){this.ms=e};Id.prototype.setMax=function(e){this.max=e};Id.prototype.setJitter=function(e){this.jitter=e};class Tw extends Fn{constructor(t,r){var n;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(r=t,t=void 0),r=r||{},r.path=r.path||"/socket.io",this.opts=r,jx(this,r),this.reconnection(r.reconnection!==!1),this.reconnectionAttempts(r.reconnectionAttempts||1/0),this.reconnectionDelay(r.reconnectionDelay||1e3),this.reconnectionDelayMax(r.reconnectionDelayMax||5e3),this.randomizationFactor((n=r.randomizationFactor)!==null&&n!==void 0?n:.5),this.backoff=new Id({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(r.timeout==null?2e4:r.timeout),this._readyState="closed",this.uri=t;const s=r.parser||z9;this.encoder=new s.Encoder,this.decoder=new s.Decoder,this._autoConnect=r.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var r;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(r=this.backoff)===null||r===void 0||r.setMin(t),this)}randomizationFactor(t){var r;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(r=this.backoff)===null||r===void 0||r.setJitter(t),this)}reconnectionDelayMax(t){var r;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(r=this.backoff)===null||r===void 0||r.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new C9(this.uri,this.opts);const r=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const s=bi(r,"open",function(){n.onopen(),t&&t()}),a=o=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",o),t?t(o):this.maybeReconnectOnOpen()},i=bi(r,"error",a);if(this._timeout!==!1){const o=this._timeout,l=this.setTimeoutFn(()=>{s(),a(new Error("timeout")),r.close()},o);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(s),this.subs.push(i),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(bi(t,"ping",this.onping.bind(this)),bi(t,"data",this.ondata.bind(this)),bi(t,"error",this.onerror.bind(this)),bi(t,"close",this.onclose.bind(this)),bi(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(r){this.onclose("parse error",r)}}ondecoded(t){Ax(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,r){let n=this.nsps[t];return n?this._autoConnect&&!n.active&&n.connect():(n=new bT(this,t,r),this.nsps[t]=n),n}_destroy(t){const r=Object.keys(this.nsps);for(const n of r)if(this.nsps[n].active)return;this._close()}_packet(t){const r=this.encoder.encode(t);for(let n=0;n<r.length;n++)this.engine.write(r[n],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,r){var n;this.cleanup(),(n=this.engine)===null||n===void 0||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,r),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const r=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(s=>{s?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",s)):t.onreconnect()}))},r);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const _h={};function R1(e,t){typeof e=="object"&&(t=e,e=void 0),t=t||{};const r=P9(e,t.path||"/socket.io"),n=r.source,s=r.id,a=r.path,i=_h[s]&&a in _h[s].nsps,o=t.forceNew||t["force new connection"]||t.multiplex===!1||i;let l;return o?l=new Tw(n,t):(_h[s]||(_h[s]=new Tw(n,t)),l=_h[s]),r.query&&!t.query&&(t.query=r.queryKey),l.socket(r.path,t)}Object.assign(R1,{Manager:Tw,Socket:bT,io:R1,connect:R1});const Cb=lb((e,t)=>({dirtyPages:new Map,setDirty:(r,n)=>{e(s=>{const a=new Map(s.dirtyPages);return a.set(r,{pageId:r,pageName:n,isDirty:!0,lastModified:new Date}),console.log(` Dirty state SET: ${n} (${r})`),{dirtyPages:a}})},clearDirty:r=>{e(n=>{const s=new Map(n.dirtyPages),a=s.get(r);return a&&console.log(` Dirty state CLEARED: ${a.pageName} (${r})`),s.delete(r),{dirtyPages:s}})},hasAnyDirtyPages:()=>t().dirtyPages.size>0,getDirtyPages:()=>Array.from(t().dirtyPages.values()),isPageDirty:r=>t().dirtyPages.has(r),clearAll:()=>{console.log(" All dirty states CLEARED"),e({dirtyPages:new Map})}})),$o={RECONNECT_DELAY_MIN:1e3,RECONNECT_DELAY_MAX:3e4,RECONNECT_ATTEMPTS_MAX:10,SERVER_SEQ_KEY:"realtime-server-seq",FALLBACK_POLL_INTERVAL:3e3},Zg=class Zg{constructor(){Pt(this,"socket",null);Pt(this,"state",{status:"disconnected",lastConnected:null,reconnectAttempts:0,serverSeq:0});Pt(this,"operationListeners",new Set);Pt(this,"statusListeners",new Set);Pt(this,"reconnectTimer",null);Pt(this,"fallbackPollTimer",null);Pt(this,"token",null);Pt(this,"deviceId",null);Pt(this,"userId",null);Pt(this,"serverUrl",null);Pt(this,"subscribedProjects",new Set);Pt(this,"lastFullSyncTime",0);const t=localStorage.getItem($o.SERVER_SEQ_KEY);t&&(this.state.serverSeq=parseInt(t,10)||0)}connect(t,r,n,s){var o;if(this.token=r,this.deviceId=n,this.userId=s,this.serverUrl=t.replace(/\/api\/?$/,""),(o=this.socket)!=null&&o.connected){console.log(" Already connected to realtime server");return}console.log(" Connecting to realtime server:",t),this.updateStatus("connecting");let a=t.replace(/\/api\/?$/,"");!a.startsWith("http://")&&!a.startsWith("https://")&&(a=`http://${a}`),console.log(" Socket.IO URL:",a);const i=()=>{let l=localStorage.getItem("clientSessionId");return l||(l=`session-${n}-${Date.now()}`,localStorage.setItem("clientSessionId",l)),l};this.socket=R1(a,{path:"/socket.io/",auth:{token:r,deviceId:n,clientSessionId:i()},transports:["websocket","polling"],reconnection:!0,reconnectionDelay:$o.RECONNECT_DELAY_MIN,reconnectionDelayMax:$o.RECONNECT_DELAY_MAX,reconnectionAttempts:$o.RECONNECT_ATTEMPTS_MAX,timeout:2e4,forceNew:!1}),this.setupEventListeners()}setupEventListeners(){this.socket&&(this.socket.on("connect",()=>{var t;console.log(" Connected to realtime server"),this.updateStatus("connected"),this.state.lastConnected=Date.now(),this.state.reconnectAttempts=0,this.stopFallbackPolling();for(const r of this.subscribedProjects)(t=this.socket)==null||t.emit("join:project",r),console.log(" Re-joined project room:",r);this.requestMissedOperations()}),this.socket.on("disconnect",t=>{var r;console.log(" Disconnected from realtime server:",t),this.updateStatus("disconnected"),(t==="io server disconnect"||t==="transport close")&&((r=this.socket)==null||r.connect()),t!=="io client disconnect"&&this.startFallbackPolling()}),this.socket.on("connect_error",t=>{console.error(" Connection error:",t.message),this.updateStatus("error"),this.state.reconnectAttempts++,this.state.reconnectAttempts>=3&&this.startFallbackPolling()}),this.socket.on("sync:op",t=>{console.log(" Received realtime op:",t.opId,t.type,t.entity),this.handleOperation(t)}),this.socket.on("sync:state",t=>{console.log(" Received sync state:",t.operations.length,"operations");const r=Date.now()-this.lastFullSyncTime;if(r<Zg.FULL_SYNC_COOLDOWN){if(console.log(" Skipping sync:state - full sync was done",Math.round(r/1e3),"seconds ago"),t.operations.length>0){const n=Math.max(...t.operations.map(s=>s.serverSeq));this.state.serverSeq=Math.max(this.state.serverSeq,n),localStorage.setItem($o.SERVER_SEQ_KEY,this.state.serverSeq.toString())}return}for(const n of t.operations)this.handleOperation(n)}),this.socket.on("sync:error",t=>{console.error(" Sync error:",t.message)}),this.socket.on("error",t=>{console.error(" Socket error:",t)}))}async handleOperation(t){if(t.clientId===this.deviceId){console.log(" Skipping own operation:",t.opId);return}if(t.type==="DELETE"){console.log(" BLOCKED DELETE from realtime/polling:",t.entity,t.entityId),this.state.serverSeq=Math.max(this.state.serverSeq,t.serverSeq),localStorage.setItem($o.SERVER_SEQ_KEY,this.state.serverSeq.toString());return}if(t.serverSeq<=this.state.serverSeq){console.log(" Skipping already processed operation:",t.opId);return}await this.applyOperation(t),this.state.serverSeq=Math.max(this.state.serverSeq,t.serverSeq),localStorage.setItem($o.SERVER_SEQ_KEY,this.state.serverSeq.toString());for(const r of this.operationListeners)try{r(t)}catch(n){console.error("Error in operation listener:",n)}}async applyOperation(t){const r=Cb.getState();if(t.entity==="metre"&&r.hasAnyDirtyPages()){const i=r.getDirtyPages();console.log(" Realtime METRE update skipped: Dirty pages exist:",i.map(o=>o.pageName).join(", "));return}const s={project:Le.projects,bordereau:Le.bordereaux,periode:Le.periodes,metre:Le.metres,decompt:Le.decompts,photo:Le.photos,pv:Le.pvs,attachment:Le.attachments,company:Le.companies}[t.entity];if(!s){console.warn("Unknown entity type:",t.entity);return}const a=this.normalizeEntityId(t.entity,t.entityId);try{await Le.transaction("rw",[s,Le.syncOperations],async()=>{if(await Le.syncOperations.where("entityId").equals(a).filter(o=>o.entity===t.entity&&!o.synced).count()>0){console.warn(` Conflict detected for ${t.entity}:${a}. Skipping remote update to preserve local pending changes.`);return}switch(t.type){case"CREATE":case"UPDATE":{const o=this.normalizeData(t.entity,t.data,a);await s.put(o),console.log(` Applied ${t.type} to ${t.entity}:${a}`);break}case"DELETE":{await s.delete(a),console.log(` Applied DELETE to ${t.entity}:${a}`);break}}})}catch(i){console.error(` Failed to apply ${t.type} to ${t.entity}:${a}:`,i.message)}}normalizeEntityId(t,r){if(!r)return"";const n=r.includes(":")?r.split(":").pop():r;return`${t}:${n}`}normalizeData(t,r,n){const s={...r,id:n};return s.projectId&&(s.projectId=this.normalizeEntityId("project",s.projectId)),s.periodeId&&s.periodeId.trim()!==""&&(s.periodeId=this.normalizeEntityId("periode",s.periodeId)),s.bordereauId&&(s.bordereauId=this.normalizeEntityId("bordereau",s.bordereauId)),s.userId&&(s.userId=this.normalizeEntityId("user",s.userId)),s}requestMissedOperations(){var t;(t=this.socket)!=null&&t.connected&&(console.log(" Requesting operations since seq:",this.state.serverSeq),this.socket.emit("sync:request",{since:this.state.serverSeq}))}subscribeToProject(t){var r;this.subscribedProjects.add(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("join:project",t),console.log(" Subscribed to project:",t))}unsubscribeFromProject(t){var r;this.subscribedProjects.delete(t),(r=this.socket)!=null&&r.connected&&(this.socket.emit("leave:project",t),console.log(" Unsubscribed from project:",t))}startFallbackPolling(){this.fallbackPollTimer||(console.log(" Starting fallback polling..."),this.fallbackPollTimer=setInterval(async()=>{var t;if((t=this.socket)!=null&&t.connected){this.stopFallbackPolling();return}await this.pollForUpdates()},$o.FALLBACK_POLL_INTERVAL))}stopFallbackPolling(){this.fallbackPollTimer&&(clearInterval(this.fallbackPollTimer),this.fallbackPollTimer=null,console.log(" Stopped fallback polling"))}async pollForUpdates(){var t;if(this.token)try{const n=`${this.serverUrl||""}/api/sync/pull?since=${this.state.serverSeq}&deviceId=${this.deviceId}`,s=await fetch(n,{headers:{Authorization:`Bearer ${this.token}`}});if(s.ok){const i=((t=(await s.json()).data)==null?void 0:t.operations)||[];for(const o of i)await this.handleOperation({serverSeq:o.serverSeq,opId:o.opId||o.id,clientId:o.clientId,type:o.type,entity:o.entity,entityId:o.entityId,data:o.data,timestamp:o.timestamp,userId:o.userId||this.userId||""})}}catch(r){console.error("Polling error:",r)}}onOperation(t){return this.operationListeners.add(t),()=>this.operationListeners.delete(t)}onStatusChange(t){return this.statusListeners.add(t),t(this.state.status),()=>this.statusListeners.delete(t)}updateStatus(t){this.state.status=t;for(const r of this.statusListeners)try{r(t)}catch(n){console.error("Error in status listener:",n)}}getState(){return{...this.state}}isConnected(){var t;return((t=this.socket)==null?void 0:t.connected)??!1}getServerSeq(){return this.state.serverSeq}setServerSeq(t){this.state.serverSeq=t,localStorage.setItem($o.SERVER_SEQ_KEY,t.toString())}markFullSyncComplete(){this.lastFullSyncTime=Date.now(),console.log(" Full sync marked complete - will skip sync:state for 10 seconds")}disconnect(){console.log(" Disconnecting from realtime server"),this.stopFallbackPolling(),this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.socket&&(this.socket.disconnect(),this.socket=null),this.updateStatus("disconnected"),this.subscribedProjects.clear()}reconnect(){if(this.token&&this.deviceId&&this.userId){const t=this.getServerUrl();this.disconnect(),this.connect(t,this.token,this.deviceId,this.userId)}}getServerUrl(){var r,n,s;if(typeof window<"u"&&((r=window.electron)!=null&&r.apiUrl)){const a=window.electron.apiUrl;return console.log(" [REALTIME] Using Electron API URL:",a),a}const t=(s=(n=import.meta)==null?void 0:n.env)==null?void 0:s.VITE_API_URL;return t?(console.log(" [REALTIME] Using VITE_API_URL:",t),t.replace("/api","")):typeof window<"u"?window.location.protocol==="app:"||window.location.protocol==="file:"?(console.log(" [REALTIME] Electron detected, using production URL"),"http://162.55.219.151"):window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1"?(console.log(" [REALTIME] Development mode, using localhost"),"http://localhost:5000"):window.location.origin:"http://localhost:5000"}};Pt(Zg,"FULL_SYNC_COOLDOWN",1e4);let Cw=Zg;const Xi=new Cw,df=new Map,hS={emit(e,t){const r=df.get(e);if(r)for(const n of r)try{n(t)}catch(s){console.error("Event listener error:",s)}},on(e,t){return df.has(e)||df.set(e,new Set),df.get(e).add(t),()=>{var r;(r=df.get(e))==null||r.delete(t)}},off(e,t){var r;(r=df.get(e))==null||r.delete(t)}},zo={PROJECT_UPDATED:"project:updated",BORDEREAU_UPDATED:"bordereau:updated",PERIODE_UPDATED:"periode:updated",METRE_UPDATED:"metre:updated",DECOMPT_UPDATED:"decompt:updated",PHOTO_UPDATED:"photo:updated",PV_UPDATED:"pv:updated",ATTACHMENT_UPDATED:"attachment:updated",DATA_CHANGED:"data:changed"},pS={project:"projects",bordereau:"bordereaux",metre:"metres",decompt:"decompts",pv:"pvs",periode:"periodes",photo:"photos",attachment:"attachments",user:"users",company:"companies",auditLog:"auditLogs"},ls=(e,t)=>{if(!t)return"";const r=t.includes(":")?t.split(":").pop():t;return`${e}:${r}`},Ei=e=>e?e.includes(":")?e.split(":").pop():e:"",a0=[],q9=500,kr=e=>{a0.unshift({...e,timestamp:new Date}),a0.length>q9&&a0.pop();const t=e.success?"":"";console.log(`${t} [SYNC] ${e.action}`,e.entity?`${e.entity}:${e.entityId}`:"",e.error||"")},W9=()=>[...a0],V9=()=>{a0.length=0},K9=async e=>{const t={localCounts:{},missingEntities:[],orphanedEntities:[],errors:[]};try{t.localCounts={projects:await Le.projects.count(),bordereaux:await Le.bordereaux.count(),metres:await Le.metres.count(),decompts:await Le.decompts.count(),periodes:await Le.periodes.count(),pvs:await Le.pvs.count(),photos:await Le.photos.count(),attachments:await Le.attachments.count()};const r=await Rt.getProjects(),n=r.data||r;if(Array.isArray(n))for(const a of n){const i=ls("project",a.id);await Le.projects.get(i)||t.missingEntities.push({entity:"project",id:a.id})}const s=await Le.projects.toArray();for(const a of s){const i=Ei(a.id);!(Array.isArray(n)&&n.some(l=>Ei(l.id)===i||l.id===i))&&!a.deletedAt&&t.orphanedEntities.push({entity:"project",id:a.id})}kr({action:"INSPECT",success:!0,data:t})}catch(r){t.errors.push(r.message),kr({action:"INSPECT",success:!1,error:r.message})}return t},G9=e=>{const t={CREATE:0,UPDATE:1,DELETE:2};return[...e].sort((r,n)=>{const s=t[r.type]-t[n.type];if(s!==0)return s;const a=typeof r.timestamp=="string"?new Date(r.timestamp).getTime():r.timestamp,i=typeof n.timestamp=="string"?new Date(n.timestamp).getTime():n.timestamp;return a-i})},Y9=async e=>{var a,i;const t={applied:0,skipped:0,errors:[]};if(e.length===0)return t;const r=G9(e);console.log(` Applying ${r.length} operations (sorted: CREATEUPDATEDELETE)...`);const n=[];for(const o of r){const l=ls(o.entity,o.entityId),u=Ei(o.entityId);if(o.type==="DELETE"){console.log(` BLOCKED DELETE from sync pull: ${o.entity}:${l}`),t.skipped++,kr({action:"SKIP_DELETE",entity:o.entity,entityId:o.entityId,success:!1,error:"DELETE blocked from remote sync"});continue}if(await Le.syncOperations.where("entityId").anyOf([l,u]).filter(h=>h.entity===o.entity&&!h.synced).count()>0){console.warn(` Conflict detected for ${o.entity}:${l} during PULL. Skipping remote update.`),t.skipped++,kr({action:"SKIP_CONFLICT",entity:o.entity,entityId:o.entityId,success:!1,error:"Local pending changes exist"});continue}n.push(o)}const s={};for(const o of n){const l=pS[o.entity];if(!l){t.skipped++,kr({action:"SKIP",entity:o.entity,entityId:o.entityId,success:!1,error:`Unknown entity: ${o.entity}`});continue}s[l]||(s[l]={creates:[],updates:[],deletes:[]});const u=ls(o.entity,o.entityId),f=o.data?{...o.data}:{};switch(f.projectId&&(f.projectId=ls("project",f.projectId)),f.periodeId&&String(f.periodeId).trim()!==""&&(f.periodeId=ls("periode",f.periodeId)),f.bordereauId&&(f.bordereauId=ls("bordereau",f.bordereauId)),o.type){case"CREATE":s[l].creates.push({...f,id:u});break;case"UPDATE":s[l].updates.push({id:u,data:f});break;case"DELETE":s[l].deletes.push(u);break}}try{const o=[Le.projects,Le.bordereaux,Le.metres,Le.decompts,Le.periodes,Le.pvs,Le.photos];await Le.transaction("rw",o,async()=>{var l,u,f,h;for(const[p,d]of Object.entries(s)){const m=Le[p];if(m){if(d.creates.length>0)try{for(const g of d.creates)try{const w=await m.get(g.id);if(w)if(p==="metres"){const x={...g,sections:g.sections&&g.sections.length>0?g.sections:w.sections||[],subSections:g.subSections&&g.subSections.length>0?g.subSections:w.subSections||[],lignes:g.lignes&&g.lignes.length>0?g.lignes:w.lignes||[],totalPartiel:g.totalPartiel||w.totalPartiel||0,totalCumule:g.totalCumule||w.totalCumule||0};await m.put(x),console.log(` Merged metre data for ${g.id} - preserved local sections/lignes`)}else if(p==="bordereaux"){const x=(l=w.lignes)==null?void 0:l.some(S=>S.quantite>0),y=(u=g.lignes)==null?void 0:u.some(S=>S.quantite>0),b={...g,lignes:y||!x?g.lignes:w.lignes,montantTotal:y||!x?g.montantTotal:w.montantTotal};await m.put(b),console.log(` Merged bordereau data for ${g.id} - preserved local lignes with quantite`)}else await m.put({...g,updatedAt:g.updatedAt||w.updatedAt});else await m.put(g);t.applied++}catch(w){t.errors.push({op:{type:"CREATE",entity:p,entityId:g.id,data:g},error:w.message}),kr({action:"CREATE",entity:p,entityId:g.id,success:!1,error:w.message})}kr({action:"BULK_CREATE",entity:p,success:!0,data:{count:d.creates.length}})}catch(g){console.error(` Error in bulk create for ${p}:`,g),t.errors.push({op:{type:"CREATE",entity:p},error:g.message})}for(const g of d.updates)try{const w=await m.get(g.id);if(w)if(p==="metres"){const x={...g.data,sections:g.data.sections&&g.data.sections.length>0?g.data.sections:w.sections,subSections:g.data.subSections&&g.data.subSections.length>0?g.data.subSections:w.subSections,lignes:g.data.lignes&&g.data.lignes.length>0?g.data.lignes:w.lignes};await m.update(g.id,x),console.log(` Merged metre update for ${g.id} - preserved local hierarchical data`)}else if(p==="bordereaux"){const x=(f=w.lignes)==null?void 0:f.some(S=>S.quantite>0),y=(h=g.data.lignes)==null?void 0:h.some(S=>S.quantite>0),b={...g.data,lignes:y||!x?g.data.lignes:w.lignes,montantTotal:y||!x?g.data.montantTotal:w.montantTotal};await m.update(g.id,b),console.log(` Merged bordereau update for ${g.id} - preserved local lignes`)}else await m.update(g.id,g.data);else await m.put({...g.data,id:g.id});t.applied++,kr({action:"UPDATE",entity:p,entityId:g.id,success:!0})}catch(w){t.errors.push({op:{type:"UPDATE",entity:p,entityId:g.id,data:g.data},error:w.message}),kr({action:"UPDATE",entity:p,entityId:g.id,success:!1,error:w.message})}if(d.deletes.length>0)try{await m.bulkDelete(d.deletes),t.applied+=d.deletes.length,kr({action:"BULK_DELETE",entity:p,success:!0,data:{count:d.deletes.length}})}catch{for(const w of d.deletes)try{await m.delete(w),t.applied++,kr({action:"DELETE",entity:p,entityId:w,success:!0})}catch(x){t.errors.push({op:{type:"DELETE",entity:p,entityId:w},error:x.message}),kr({action:"DELETE",entity:p,entityId:w,success:!1,error:x.message})}}}}})}catch(o){console.error(" Transaction error:",o),kr({action:"TRANSACTION",success:!1,error:o.message});for(const l of r)try{const u=pS[l.entity];if(!u)continue;const f=Le[u];if(!f)continue;const h=ls(l.entity,l.entityId),p=l.data?{...l.data}:{};switch(p.projectId&&(p.projectId=ls("project",p.projectId)),l.type){case"CREATE":case"UPDATE":{const d=await f.get(h);if(u==="metres"&&d){const m={...p,id:h,sections:p.sections&&p.sections.length>0?p.sections:d.sections||[],subSections:p.subSections&&p.subSections.length>0?p.subSections:d.subSections||[],lignes:p.lignes&&p.lignes.length>0?p.lignes:d.lignes||[]};await f.put(m),console.log(` Fallback: Merged metre data for ${h}`)}else if(u==="bordereaux"&&d){const m=(a=d.lignes)==null?void 0:a.some(x=>x.quantite>0),g=(i=p.lignes)==null?void 0:i.some(x=>x.quantite>0),w={...p,id:h,lignes:g||!m?p.lignes:d.lignes,montantTotal:g||!m?p.montantTotal:d.montantTotal};await f.put(w),console.log(` Fallback: Merged bordereau data for ${h}`)}else await f.put({...p,id:h});break}case"DELETE":await f.delete(h);break}t.applied++,kr({action:l.type,entity:l.entity,entityId:h,success:!0})}catch(u){t.errors.push({op:l,error:u.message}),kr({action:l.type,entity:l.entity,entityId:l.entityId,success:!1,error:u.message})}}return console.log(` Applied: ${t.applied}, Skipped: ${t.skipped}, Errors: ${t.errors.length}`),t},Sf=async(e,t=!1)=>{var s;const r=Cb.getState();if(r.hasAnyDirtyPages()&&!t){const a=r.getDirtyPages();return console.log(" PULL SKIPPED: Unsaved changes detected in:",a.map(i=>i.pageName).join(", ")),kr({action:"PULL_SKIPPED",success:!0,data:{reason:"unsaved_changes",dirtyPages:a.map(i=>i.pageName)}}),0}let n=0;console.log(" Starting direct data pull...",e?`for project: ${e}`:"all data"),kr({action:"PULL_START",success:!0,data:{projectId:e}});try{const a=await Rt.getProjects(),i=a.data||a;if(Array.isArray(i)){await Le.transaction("rw",Le.projects,async()=>{for(const l of i){if(e&&Ei(l.id)!==Ei(e))continue;const u=ls("project",l.id);await Le.projects.put({...l,id:u,userId:l.userId?ls("user",l.userId):l.userId}),n++}});const o=e?i.filter(l=>Ei(l.id)===Ei(e)):i;for(const l of o){const u=Ei(l.id),f=ls("project",u);try{const h=await Rt.getBordereaux(u),p=h.data||h;Array.isArray(p)&&p.length>0&&await Le.transaction("rw",Le.bordereaux,async()=>{for(const d of p)await Le.bordereaux.put({...d,id:ls("bordereau",d.id),projectId:f}),n++})}catch{console.log("No bordereaux for project:",u)}try{const h=await((s=Rt.getPeriodes)==null?void 0:s.call(Rt,u)),p=(h==null?void 0:h.data)||h;Array.isArray(p)&&p.length>0&&await Le.transaction("rw",Le.periodes,async()=>{for(const d of p)await Le.periodes.put({...d,id:ls("periode",d.id),projectId:f}),n++})}catch{console.log("No periodes for project:",u)}try{const h=await Rt.getMetres(u),p=h.data||h;Array.isArray(p)&&p.length>0&&await Le.transaction("rw",Le.metres,async()=>{for(const d of p)await Le.metres.put({...d,id:ls("metre",d.id),projectId:f,periodeId:d.periodeId?ls("periode",d.periodeId):""}),n++})}catch{console.log("No metres for project:",u)}try{const h=await Rt.getDecompts(u),p=h.data||h;Array.isArray(p)&&p.length>0&&await Le.transaction("rw",Le.decompts,async()=>{for(const d of p)await Le.decompts.put({...d,id:ls("decompt",d.id),projectId:f,periodeId:d.periodeId?ls("periode",d.periodeId):""}),n++})}catch{console.log("No decompts for project:",u)}}}kr({action:"PULL_COMPLETE",success:!0,data:{totalPulled:n}}),console.log(` Direct pull complete: ${n} items`)}catch(a){throw console.error(" Direct pull error:",a),kr({action:"PULL_ERROR",success:!1,error:a.message}),a}return n},X9=e=>{const t=Js(async()=>e?await Le.syncOperations.where("synced").equals(0).count():0,[e])||0,[r,n]=ee.useState({status:Uo()?"idle":"offline",lastSyncTime:iS()||null,pendingOperations:0,error:null,lastPullCount:0,realtimeConnected:!1});ee.useEffect(()=>{n(x=>({...x,pendingOperations:t}))},[t]);const[s,a]=ee.useState(!0),i=ee.useRef(!1),o=ee.useRef(!1),l=ee.useCallback(()=>{if(!e||o.current&&Xi.isConnected())return;const x=localStorage.getItem("authToken");if(!x)return;const y=Mh();let b="http://localhost:3000";typeof window<"u"&&window.location.hostname!=="localhost"&&(b=window.location.origin),(window.navigator.userAgent.includes("Electron")||window.electronAPI)&&(b="http://162.55.219.151"),console.log(" Connecting to realtime server:",b),Xi.connect(b,x,y,e),o.current=!0;const S=Xi.onStatusChange(L=>{n(A=>({...A,realtimeConnected:L==="connected",status:L==="connected"?"realtime":A.status}))}),T=Xi.onOperation(L=>{console.log(" Realtime op in sync manager:",L.type,L.entity);const D={project:zo.PROJECT_UPDATED,bordereau:zo.BORDEREAU_UPDATED,periode:zo.PERIODE_UPDATED,metre:zo.METRE_UPDATED,decompt:zo.DECOMPT_UPDATED,photo:zo.PHOTO_UPDATED,pv:zo.PV_UPDATED,attachment:zo.ATTACHMENT_UPDATED}[L.entity];D&&hS.emit(D,{type:L.type,entityId:L.entityId,data:L.data}),hS.emit(zo.DATA_CHANGED,{entity:L.entity,type:L.type,entityId:L.entityId,data:L.data})});return()=>{S(),T()}},[e]),u=ee.useCallback(async()=>{if(e)try{const x=await Le.syncOperations.where("synced").equals(0).count();n(y=>({...y,pendingOperations:x}))}catch(x){console.error("Error updating pending count:",x)}},[e]),f=ee.useCallback(async()=>{var x,y,b;if(!e||!Uo()){console.log(" Cannot push: user not authenticated or offline");return}console.log(" [v3] Starting sync push..."),kr({action:"PUSH_START",success:!0});try{const S=await Le.syncOperations.filter(C=>!C.synced&&C.userId===e).toArray();if(S.length===0){console.log(" No pending operations");return}console.log(` Found ${S.length} pending operations`);const T=S.map(C=>({id:C.id,type:C.type,entity:C.entity,entityId:Ei(C.entityId),data:C.data,timestamp:C.timestamp})),L=await Rt.syncPush(T,Mh());console.log(" Server response:",L);const A=((x=L.data)==null?void 0:x.success)||L.success||[];if(Array.isArray(A)&&A.length>0){const C=S.filter(O=>A.includes(O.id)||A.includes(Ei(O.entityId))).map(O=>O.id);C.length>0&&await Le.transaction("rw",Le.syncOperations,async()=>{for(const O of C)await Le.syncOperations.update(O,{synced:!0,syncedAt:new Date().toISOString()})})}const D=((y=L.data)==null?void 0:y.failed)||L.failed||[];if(D.length>0){console.error(" Some operations failed:",D),kr({action:"PUSH_ERRORS",success:!1,data:{errors:D}});const C=["overflow","invalid input","duplicate key","not-null"],O=["foreign key","fkey"];for(const E of D){const P=(E.error||"").toLowerCase(),q=O.some(ne=>P.includes(ne));if(C.some(ne=>P.includes(ne))&&!q){const ne=S.find(fe=>fe.id===E.id||Ei(fe.entityId)===E.id||fe.entityId.includes(E.id));ne&&ne.id&&(console.warn(` Marking permanently failed op for deletion: ${ne.entity}:${ne.entityId}`),await Le.syncOperations.delete(ne.id),kr({action:"DELETE_FAILED_OP",entity:ne.entity,entityId:ne.entityId,success:!0,error:E.error}))}else q&&console.log(` Recoverable error, keeping op for retry: ${(b=E.error)==null?void 0:b.slice(0,50)}...`)}}kr({action:"PUSH_COMPLETE",success:!0,data:{pushed:A.length}})}catch(S){throw console.error(" Push error:",S),kr({action:"PUSH_ERROR",success:!1,error:S.message}),S}},[e]),h=ee.useCallback(async()=>{var x,y,b;if(!e||!Uo()){console.log(" Cannot pull: user not authenticated or offline");return}console.log(" [v3] Starting sync pull..."),n(S=>({...S,status:"pulling"})),kr({action:"PULL_START",success:!0});try{const S=iS(),T=await Rt.syncPull(S,Mh());console.log(" Pull response received");const L=((x=T.data)==null?void 0:x.operations)||T.operations||[],A=((y=T.data)==null?void 0:y.serverTime)||T.serverTime||Date.now();if(L.length===0&&S===0){console.log(" No sync operations, performing direct fetch...");const D=await Sf();n(C=>({...C,lastPullCount:D}))}else if(L.length>0){const D=await Y9(L);n(C=>({...C,lastPullCount:D.applied})),D.errors.length>0&&console.error(" Some operations failed to apply:",D.errors)}oS(A),Xi.markFullSyncComplete(),kr({action:"PULL_COMPLETE",success:!0})}catch(S){if(console.error(" Pull error:",S),kr({action:"PULL_ERROR",success:!1,error:S.message}),((b=S.response)==null?void 0:b.status)!==401)throw S}},[e]),p=ee.useCallback(async()=>{if(i.current){console.log(" Sync already in progress");return}if(!e||!Uo()){n(x=>({...x,status:"offline",error:"Cannot sync while offline"}));return}i.current=!0,n(x=>({...x,status:"syncing",error:null}));try{await f(),await h();const x=new Date;x.setDate(x.getDate()-30),await Le.syncOperations.where("syncedAt").below(x.toISOString()).delete(),n(y=>({...y,status:"synced",lastSyncTime:Date.now(),error:null})),kr({action:"SYNC_COMPLETE",success:!0})}catch(x){n(y=>({...y,status:"error",error:x.message||"Sync failed"})),kr({action:"SYNC_ERROR",success:!1,error:x.message})}finally{i.current=!1}},[e,f,h,u]);ee.useEffect(()=>XM(()=>{n(S=>({...S,status:"idle"})),s&&setTimeout(()=>p(),1e3)},()=>{n(S=>({...S,status:"offline"}))}),[p,s]),ee.useEffect(()=>{if(!s||!Uo())return;const x=()=>r.realtimeConnected?2*60*1e3:10*1e3;let y;return(()=>{clearInterval(y),y=setInterval(()=>{p().catch(console.error)},x())})(),()=>clearInterval(y)},[p,s,r.realtimeConnected]),ee.useEffect(()=>{u()},[u]),ee.useEffect(()=>{if(e&&Uo()){const x=l();return()=>{x&&x(),o.current=!1}}},[e,l]),ee.useEffect(()=>{const x=()=>{e&&!Xi.isConnected()&&(console.log(" Back online, reconnecting realtime..."),l())};return window.addEventListener("online",x),()=>window.removeEventListener("online",x)},[e,l]),ee.useEffect(()=>{if(!e||!Uo())return;const x=setInterval(()=>{Xi.isConnected()||(console.log(" WebSocket health check: Not connected, attempting reconnect..."),l())},3e4);return()=>clearInterval(x)},[e,l]);const d=ee.useCallback(async()=>{try{const x=await Le.syncOperations.filter(b=>b.synced===!1||b.synced===void 0).toArray();if(x.length===0)return console.log(" No pending operations to clear"),{cleared:0};console.log(` Clearing ${x.length} pending operations...`);const y=x.map(b=>b.id).filter(b=>b!=null);return await Le.syncOperations.bulkDelete(y),n(b=>({...b,pendingOperations:0,error:null,status:"idle"})),console.log(` Cleared ${x.length} pending operations`),{cleared:x.length}}catch(x){return console.error(" Failed to clear pending operations:",x),{cleared:0,error:x.message}}},[]),m=ee.useCallback(async()=>{if(!e)return{repaired:0,errors:[]};console.log(" Starting orphaned entity repair...");const x=Mh(),y=Date.now();let b=0;const S=[];try{const T=await Le.projects.where("userId").equals(e).toArray();for(const A of T)if(!await Le.syncOperations.where("entityId").equals(A.id).filter(C=>C.type==="CREATE"&&!C.synced).first()){console.log(` Creating missing sync op for project: ${A.id}`);const C={id:`repair:${A.id}:${y}`,userId:e,deviceId:x,type:"CREATE",entity:"project",entityId:A.id,data:A,timestamp:y-1e3,synced:!1};await Le.syncOperations.add(C),b++,console.log(` Created repair sync op for project: ${A.marcheNo}`)}const L=[{table:Le.bordereaux,entity:"bordereau"},{table:Le.periodes,entity:"periode"},{table:Le.metres,entity:"metre"},{table:Le.decompts,entity:"decompt"}];for(const A of L){const D=await A.table.where("userId").equals(e).toArray();for(const C of D)if(!await Le.syncOperations.where("entityId").equals(C.id).filter(E=>E.type==="CREATE"&&!E.synced).first()){const E={id:`repair:${C.id}:${y}`,userId:e,deviceId:x,type:"CREATE",entity:A.entity,entityId:C.id,data:C,timestamp:y,synced:!1};await Le.syncOperations.add(E),b++}}return console.log(` Repaired ${b} orphaned entities`),b>0&&await u(),{repaired:b,errors:S}}catch(T){return console.error(" Repair failed:",T),S.push(T.message),{repaired:b,errors:S}}},[e,u]),g=ee.useCallback(async()=>{if(e)try{console.log(" Starting full reset and resync..."),await d(),oS(0),await Sf(),console.log(" Reset and resync completed")}catch(x){console.error(" Reset and resync failed:",x)}},[e,d,Sf]),w=ee.useCallback(async x=>{if(!e||!Uo()){console.log(" Cannot refresh: user not authenticated or offline");return}console.log(" [SERVER_REFRESH] Forcing data refresh from server..."),n(y=>({...y,status:"pulling"}));try{await f();const y=await Sf(x,!0);console.log(` [SERVER_REFRESH] Refreshed ${y} items from server`),n(b=>({...b,status:"synced",lastPullCount:y}))}catch(y){console.error(" [SERVER_REFRESH] Failed:",y),n(b=>({...b,status:"error",error:y.message}))}},[e,f]);return{syncState:r,sync:p,syncPush:f,syncPull:h,pullLatestData:Sf,refreshFromServer:w,updatePendingCount:u,autoSyncEnabled:s,setAutoSyncEnabled:a,isOnline:Uo(),isRealtimeConnected:r.realtimeConnected,connectRealtime:l,disconnectRealtime:()=>Xi.disconnect(),subscribeToProject:x=>Xi.subscribeToProject(x),unsubscribeFromProject:x=>Xi.unsubscribeFromProject(x),clearPendingOperations:d,resetAndResync:g,repairOrphanedEntities:m,getSyncLogs:W9,clearSyncLogs:V9,inspectSync:()=>e?K9():Promise.resolve({localCounts:{},missingEntities:[],orphanedEntities:[],errors:["No user ID"]})}},NT=lb(e=>({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null,currentVersion:"",setUpdateAvailable:t=>e({isUpdateAvailable:!0,updateInfo:t,error:null}),setDownloading:t=>e({isDownloading:t}),setDownloadProgress:t=>e({downloadProgress:t}),setUpdateDownloaded:t=>e({isUpdateDownloaded:!0,isDownloading:!1,downloadProgress:null}),setError:t=>e({error:t,isDownloading:!1}),setCurrentVersion:t=>e({currentVersion:t}),reset:()=>e({isUpdateAvailable:!1,updateInfo:null,isDownloading:!1,downloadProgress:null,isUpdateDownloaded:!1,error:null})}));function J9(){const{setUpdateAvailable:e,setDownloadProgress:t,setUpdateDownloaded:r,setError:n,setCurrentVersion:s}=NT();ee.useEffect(()=>{if(!window.electron){console.log("Not running in Electron, auto-updater disabled");return}window.electron.getAppVersion().then(f=>{s(f),console.log("Current app version:",f)});const a=window.electron.onUpdateAvailable(f=>{console.log("Update available:",f),e(f)}),i=window.electron.onUpdateNotAvailable(f=>{console.log("No updates available, current version:",f.version)}),o=window.electron.onDownloadProgress(f=>{console.log("Download progress:",f.percent+"%"),t(f)}),l=window.electron.onUpdateDownloaded(f=>{console.log("Update downloaded:",f.version),r(f)}),u=window.electron.onUpdateError(f=>{console.error("Update error:",f.message),n(f.message)});return()=>{a(),i(),o(),l(),u()}},[e,t,r,n,s])}/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Q9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),dt=(e,t)=>{const r=ee.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:l,...u},f)=>ee.createElement("svg",{ref:f,...Q9,width:s,height:s,stroke:n,strokeWidth:i?Number(a)*24/Number(s):a,className:["lucide",`lucide-${Z9(e)}`,o].join(" "),...u},[...t.map(([h,p])=>ee.createElement(h,p)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eB=dt("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=dt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=dt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tB=dt("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=dt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rB=dt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=dt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=dt("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pb=dt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const go=dt("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _g=dt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=dt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const av=dt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=dt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pl=dt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gS=dt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eg=dt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=dt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Md=dt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=dt("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=dt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=dt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=dt("FileSpreadsheet",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=dt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=dt("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Du=dt("FolderKanban",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M12 10v2",key:"hh53o1"}],["path",{d:"M16 10v6",key:"1d6xys"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pw=dt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $m=dt("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=dt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=dt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eh=dt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=dt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=dt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=dt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=dt("LayoutGrid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kT=dt("Library",[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=dt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=dt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iv=dt("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=dt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=dt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=dt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ov=dt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=dt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=dt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=dt("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=dt("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=dt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=dt("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=dt("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=dt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=dt("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=dt("Radio",[["path",{d:"M4.9 19.1C1 15.2 1 8.8 4.9 4.9",key:"1vaf9d"}],["path",{d:"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5",key:"u1ii0m"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5",key:"1j5fej"}],["path",{d:"M19.1 4.9C23 8.8 23 15.1 19.1 19",key:"10b0cb"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=dt("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1-2-1Z",key:"wqdwcb"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17V7",key:"pyj7ub"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=dt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bB=dt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hu=dt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=dt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lw=dt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NB=dt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jg=dt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=dt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=dt("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=dt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=dt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=dt("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=dt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=dt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=dt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=dt("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=dt("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=dt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ac=dt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jB=dt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),TB=()=>{const{t:e}=Ii(),t=Os(),{login:r,isLoading:n,error:s}=Rn(),[a,i]=ee.useState({email:"",password:""}),o=async l=>{l.preventDefault();try{await r(a.email,a.password),t("/")}catch{}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("app.title")}),c.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),c.jsxs("form",{onSubmit:o,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),c.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:l=>i({...a,email:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),c.jsx("input",{id:"password",type:"password",required:!0,className:"input",value:a.password,onChange:l=>i({...a,password:l.target.value})})]}),s&&c.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),c.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?c.jsx("span",{children:e("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsx(pB,{className:"w-5 h-5"}),c.jsx("span",{children:e("auth.login")})]})})]}),c.jsx("div",{className:"mt-6 text-center",children:c.jsxs("div",{className:"text-sm text-gray-500 bg-gray-50 p-3 rounded-lg border border-gray-200",children:[c.jsx("p",{className:"font-medium mb-1",children:"Accs restreint"}),c.jsx("p",{className:"text-xs",children:"Les comptes utilisateurs sont crs uniquement par l'administrateur systme. Pour demander un accs, veuillez contacter votre administrateur."})]})})]})})})},CB=()=>{const{t:e}=Ii(),t=Os(),{register:r,isLoading:n,error:s}=Rn(),[a,i]=ee.useState({email:"",password:"",firstName:"",lastName:""}),o=async l=>{l.preventDefault();try{await r(a),t("/")}catch{}};return c.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center p-4",children:c.jsx("div",{className:"w-full max-w-md",children:c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:e("auth.register")}),c.jsx("p",{className:"text-gray-600",children:e("app.subtitle")})]}),c.jsxs("form",{onSubmit:o,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.firstName")}),c.jsx("input",{id:"firstName",type:"text",required:!0,className:"input",value:a.firstName,onChange:l=>i({...a,firstName:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.lastName")}),c.jsx("input",{id:"lastName",type:"text",required:!0,className:"input",value:a.lastName,onChange:l=>i({...a,lastName:l.target.value})})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.email")}),c.jsx("input",{id:"email",type:"email",required:!0,className:"input",value:a.email,onChange:l=>i({...a,email:l.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:e("auth.password")}),c.jsx("input",{id:"password",type:"password",required:!0,minLength:6,className:"input",value:a.password,onChange:l=>i({...a,password:l.target.value})})]}),s&&c.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-50 rounded-lg border border-red-200",children:s}),c.jsx("button",{type:"submit",disabled:n,className:"w-full btn btn-primary flex items-center justify-center gap-2",children:n?c.jsx("span",{children:e("common.loading")}):c.jsxs(c.Fragment,{children:[c.jsx(EB,{className:"w-5 h-5"}),c.jsx("span",{children:e("auth.register")})]})})]}),c.jsxs("div",{className:"mt-6 text-center text-sm text-gray-600",children:[e("auth.login")," ",c.jsx(ji,{to:"/login",className:"text-primary-600 hover:text-primary-700 font-medium",children:e("auth.login")})]})]})})})},PB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),o=ee.useRef(!0),l=ee.useRef(null),u=ee.useCallback(async(f=!0)=>{var h;if(!e){r([]),s(!1),i(null);return}f&&s(!0),i(null);try{console.log(" [WEB] Fetching projects from server...");const p=await Rt.getProjects();if(!o.current)return;const m=(p.data||p).filter(g=>!g.deletedAt);console.log(` [WEB] Loaded ${m.length} projects from server`),r(m),s(!1)}catch(p){if(!o.current)return;console.error(" [WEB] Failed to fetch projects:",p),s(!1),i(((h=p.response)==null?void 0:h.status)===401?"Session expire, veuillez vous reconnecter":"Impossible de charger les projets")}},[e]);return ee.useEffect(()=>(o.current=!0,e!==l.current&&(l.current=e,u(!0)),()=>{o.current=!1}),[e,u]),{projects:t,isLoading:n,error:a,refresh:()=>u(!0),silentRefresh:()=>u(!1)}},LB=e=>{const[t,r]=ee.useState(null),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),o=ee.useRef(!0),l=ee.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,f=ee.useCallback(async()=>{if(!u){r(null),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching project ${u}...`);const h=await Rt.getProject(u);if(!o.current)return;const p=h.data||h;r(p),s(!1),console.log(` [WEB] Loaded project ${u}`)}catch(h){if(!o.current)return;console.error(` [WEB] Failed to fetch project ${u}:`,h),i("Impossible de charger le projet"),s(!1)}},[u]);return ee.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,f()),()=>{o.current=!1}),[u,f]),{project:t,isLoading:n,error:a,refresh:f}},FB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),o=ee.useRef(!0),l=ee.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,f=ee.useCallback(async()=>{if(!u){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching bordereaux for project ${u}...`);const h=await Rt.getBordereaux(u);if(!o.current)return;const p=h.data||h;r(p.filter(d=>!d.deletedAt)),s(!1)}catch(h){if(!o.current)return;console.error(" [WEB] Failed to fetch bordereaux:",h),s(!1),i("Impossible de charger le bordereau")}},[u]);return ee.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,f()),()=>{o.current=!1}),[u,f]),{bordereaux:t,bordereau:t[0]||null,isLoading:n,error:a,refresh:f}},DB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),o=ee.useRef(!0),l=ee.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,f=ee.useCallback(async()=>{if(!u){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching priodes for project ${u}...`);const h=await Rt.getPeriodes(u);if(!o.current)return;const d=(h.data||h).filter(m=>!m.deletedAt).sort((m,g)=>m.numero-g.numero);r(d),s(!1)}catch(h){if(!o.current)return;console.error(" [WEB] Failed to fetch priodes:",h),s(!1),r([])}},[u]);return ee.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,f()),()=>{o.current=!1}),[u,f]),{periodes:t,isLoading:n,error:a,refresh:f}},RB=(e,t)=>{const[r,n]=ee.useState([]),[s,a]=ee.useState(!1),[i,o]=ee.useState(null),l=ee.useRef(!0),u=ee.useRef(""),f=(e==null?void 0:e.replace("project:",""))||null,h=(t==null?void 0:t.replace("periode:",""))||null,p=`${f}-${h}`,d=ee.useCallback(async()=>{if(!f){n([]),a(!1);return}a(!0),o(null);try{console.log(` [WEB] Fetching mtrs for project ${f}...`);const m=await Rt.getMetres(f);if(!l.current)return;let g=m.data||m;h&&(g=g.filter(w=>w.periodeId===h||w.periodeId===`periode:${h}`)),n(g.filter(w=>!w.deletedAt)),a(!1)}catch(m){if(!l.current)return;console.error(" [WEB] Failed to fetch mtrs:",m),a(!1),n([])}},[f,h]);return ee.useEffect(()=>(l.current=!0,p!==u.current&&(u.current=p,d()),()=>{l.current=!1}),[p,d]),{metres:r,isLoading:s,error:i,refresh:d}},OB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),o=ee.useRef(!0),l=ee.useRef(null),u=(e==null?void 0:e.replace("project:",""))||null,f=ee.useCallback(async()=>{if(!u){r([]),s(!1);return}s(!0),i(null);try{console.log(` [WEB] Fetching dcomptes for project ${u}...`);const h=await Rt.getDecompts(u);if(!o.current)return;const p=h.data||h;r(p.filter(d=>!d.deletedAt)),s(!1)}catch(h){if(!o.current)return;console.error(" [WEB] Failed to fetch dcomptes:",h),s(!1),r([])}},[u]);return ee.useEffect(()=>(o.current=!0,u!==l.current&&(l.current=u,f()),()=>{o.current=!1}),[u,f]),{decompts:t,isLoading:n,error:a,refresh:f}},IB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),a=ee.useRef(!0),i=ee.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=ee.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await Rt.getPhotos(o);if(!a.current)return;const f=u.data||u;r(f.filter(h=>!h.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch photos:",u),r([])}finally{a.current&&s(!1)}},[o]);return ee.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{photos:t,isLoading:n,refresh:l}},MB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),a=ee.useRef(!0),i=ee.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=ee.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await Rt.getPVs(o);if(!a.current)return;const f=u.data||u;r(f.filter(h=>!h.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch PVs:",u),r([])}finally{a.current&&s(!1)}},[o]);return ee.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{pvs:t,isLoading:n,refresh:l}},BB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),a=ee.useRef(!0),i=ee.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=ee.useCallback(async()=>{if(!o){r([]),s(!1);return}s(!0);try{const u=await Rt.getAttachments(o);if(!a.current)return;const f=u.data||u;r(f.filter(h=>!h.deletedAt))}catch(u){if(!a.current)return;console.error(" [WEB] Failed to fetch attachments:",u),r([])}finally{a.current&&s(!1)}},[o]);return ee.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{attachments:t,isLoading:n,refresh:l}},UB=e=>{const[t,r]=ee.useState([]),[n,s]=ee.useState(!1),a=ee.useRef(!0),i=ee.useRef(null),o=(e==null?void 0:e.replace("project:",""))||null,l=ee.useCallback(async()=>{var u;if(!o){r([]),s(!1);return}s(!0);try{const[f,h]=await Promise.all([Rt.getMetres(o),Rt.getPeriodes(o)]);if(!a.current)return;const p=(f.data||f).filter(S=>!S.deletedAt),d=(h.data||h).filter(S=>!S.deletedAt);if(p.length===0){r([]),s(!1);return}const m=d.sort((S,T)=>T.numero-S.numero),g=m.length>0?m[0].id:null,w=g==null?void 0:g.replace("periode:",""),x=S=>{if(S.includes("_")){const T=S.split("_");return T[T.length-1]}return S},y=new Map;for(const S of p){const T=x(S.bordereauLigneId),A=((u=S.periodeId)==null?void 0:u.replace("periode:",""))===w||S.periodeId===g,D=y.get(T);D?(D.totalCumule+=S.totalPartiel||0,A&&(D.totalPartiel=S.totalPartiel||0)):y.set(T,{reference:S.reference,designationBordereau:S.designationBordereau,unite:S.unite,quantiteBordereau:S.quantiteBordereau,totalCumule:S.totalPartiel||0,totalPartiel:A&&S.totalPartiel||0})}const b=Array.from(y.entries()).map(([S,T])=>{const L=Number(T.quantiteBordereau)||0,A=Number(T.totalCumule)||0,D=L>0?A/L*100:0,C=T.reference.split("-"),O=C.length>0?C[C.length-1]:T.reference;return{id:S,reference:O,designationBordereau:T.designationBordereau,unite:T.unite,quantiteBordereau:L,totalPartiel:Number(T.totalPartiel)||0,totalCumule:A,pourcentageRealisation:isNaN(D)?0:D}});b.sort((S,T)=>{const L=parseInt(S.reference.replace(/\D/g,""))||0,A=parseInt(T.reference.replace(/\D/g,""))||0;return L-A}),r(b)}catch(f){if(!a.current)return;console.error(" [WEB] Failed to fetch aggregated mtrs:",f),r([])}finally{a.current&&s(!1)}},[o]);return ee.useEffect(()=>(a.current=!0,o!==i.current&&(i.current=o,l()),()=>{a.current=!1}),[o,l]),{aggregatedMetres:t,isLoading:n,refresh:l}},$B=()=>{const[e,t]=ee.useState(navigator.onLine);return ee.useEffect(()=>{const r=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",r),window.addEventListener("offline",n),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",n)}},[]),e},zB=e=>{const[t,r]=ee.useState(!0),[n]=ee.useState(null),s=ee.useRef(!1),a=Js(async()=>{if(!e)return[];const o=[e,e.includes(":")?e.split(":").pop():e,e.includes(":")?e:`user:${e}`];return(await Le.projects.filter(u=>!u.deletedAt).toArray()).filter(u=>o.includes(u.userId))},[e]),i=ee.useCallback(async()=>{if(!(!e||!navigator.onLine))try{const o=await Rt.getProjects(),l=o.data||o;await Le.transaction("rw",Le.projects,async()=>{for(const u of l){const f=u.id.includes(":")?u.id:`project:${u.id}`;await Le.projects.put({...u,id:f})}})}catch(o){console.error("[ELECTRON] Sync failed:",o)}},[e]);return ee.useEffect(()=>{e&&!s.current&&navigator.onLine?(s.current=!0,i().finally(()=>r(!1))):a!==void 0&&r(!1)},[e,a,i]),{projects:a||[],isLoading:t,error:n,refresh:i,silentRefresh:i}},HB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(()=>t?Le.projects.get(t):void 0,[t]);return{project:r||null,isLoading:r===void 0,error:null,refresh:async()=>{}}},qB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.bordereaux.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{bordereaux:r||[],bordereau:(r==null?void 0:r[0])||null,isLoading:r===void 0,error:null,refresh:async()=>{}}},WB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.periodes.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{periodes:(r||[]).sort((n,s)=>n.numero-s.numero),isLoading:r===void 0,error:null,refresh:async()=>{}}},VB=(e,t)=>{const r=e!=null&&e.includes(":")?e:`project:${e}`,n=t?t.includes(":")?t:`periode:${t}`:null,s=Js(async()=>{if(!r)return[];const i=await Le.metres.where("projectId").equals(r).filter(o=>!o.deletedAt).toArray();return n?i.filter(o=>o.periodeId===n):i},[r,n]);return{metres:s||[],isLoading:s===void 0,error:null,refresh:async()=>{}}},KB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.decompts.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{decompts:r||[],isLoading:r===void 0,error:null,refresh:async()=>{}}},GB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.photos.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{photos:r||[],isLoading:r===void 0,refresh:async()=>{}}},YB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.pvs.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{pvs:r||[],isLoading:r===void 0,refresh:async()=>{}}},XB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>t?Le.attachments.where("projectId").equals(t).filter(n=>!n.deletedAt).toArray():[],[t]);return{attachments:r||[],isLoading:r===void 0,refresh:async()=>{}}},JB=e=>{const t=e!=null&&e.includes(":")?e:`project:${e}`,r=Js(async()=>{if(!t)return[];const n=await Le.metres.where("projectId").equals(t).filter(f=>!f.deletedAt).toArray();if(n.length===0)return[];const a=(await Le.periodes.where("projectId").equals(t).filter(f=>!f.deletedAt).toArray()).sort((f,h)=>h.numero-f.numero),i=a.length>0?a[0].id:null,o=f=>{if(f.includes("_")){const h=f.split("_");return h[h.length-1]}return f},l=new Map;for(const f of n){const h=o(f.bordereauLigneId),p=l.get(h);p?(p.totalCumule+=f.totalPartiel||0,f.periodeId===i&&(p.totalPartiel=f.totalPartiel||0)):l.set(h,{reference:f.reference,designationBordereau:f.designationBordereau,unite:f.unite,quantiteBordereau:f.quantiteBordereau,totalCumule:f.totalPartiel||0,totalPartiel:f.periodeId===i&&f.totalPartiel||0})}const u=Array.from(l.entries()).map(([f,h])=>{const p=Number(h.quantiteBordereau)||0,d=Number(h.totalCumule)||0,m=p>0?d/p*100:0,g=h.reference.split("-"),w=g.length>0?g[g.length-1]:h.reference;return{id:f,reference:w,designationBordereau:h.designationBordereau,unite:h.unite,quantiteBordereau:p,totalPartiel:Number(h.totalPartiel)||0,totalCumule:d,pourcentageRealisation:isNaN(m)?0:m}});return u.sort((f,h)=>{const p=parseInt(f.reference.replace(/\D/g,""))||0,d=parseInt(h.reference.replace(/\D/g,""))||0;return p-d}),u},[t]);return{aggregatedMetres:r||[],isLoading:r===void 0,refresh:async()=>{}}},Db=e=>It()?PB(e):zB(e),Bd=e=>It()?LB(e):HB(e),_p=e=>It()?FB(e):qB(e),Tx=e=>It()?DB(e):WB(e),Cx=(e,t)=>It()?RB(e,t):VB(e,t),AT=e=>It()?OB(e):KB(e),QB=e=>It()?IB(e):GB(e),ZB=e=>It()?MB(e):YB(e),eU=e=>It()?BB(e):XB(e),tU=e=>It()?UB(e):JB(e),Ep=()=>{const e=$B();return yc()?{canModify:!0,reason:null}:e?{canModify:!0,reason:null}:{canModify:!1,reason:"Vous devez tre connect pour crer ou modifier des donnes"}};function ea(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function vo(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function rU(e,t){const r=ea(e);return isNaN(t)?vo(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function Uh(e,t){const r=ea(e);if(isNaN(t))return vo(e,NaN);if(!t)return r;const n=r.getDate(),s=vo(e,r.getTime());s.setMonth(r.getMonth()+t+1,0);const a=s.getDate();return n>=a?s:(r.setFullYear(s.getFullYear(),s.getMonth(),n),r)}const jT=6048e5,nU=864e5,TT=6e4,CT=36e5;let sU={};function Px(){return sU}function Y0(e,t){var o,l,u,f;const r=Px(),n=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.weekStartsOn)??0,s=ea(e),a=s.getDay(),i=(a<n?7:0)+a-n;return s.setDate(s.getDate()-i),s.setHours(0,0,0,0),s}function Tg(e){return Y0(e,{weekStartsOn:1})}function PT(e){const t=ea(e),r=t.getFullYear(),n=vo(e,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=Tg(n),a=vo(e,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const i=Tg(a);return t.getTime()>=s.getTime()?r+1:t.getTime()>=i.getTime()?r:r-1}function NS(e){const t=ea(e);return t.setHours(0,0,0,0),t}function SS(e){const t=ea(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function LT(e,t){const r=NS(e),n=NS(t),s=+r-SS(r),a=+n-SS(n);return Math.round((s-a)/nU)}function aU(e){const t=PT(e),r=vo(e,0);return r.setFullYear(t,0,4),r.setHours(0,0,0,0),Tg(r)}function iU(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function X0(e){if(!iU(e)&&typeof e!="number")return!1;const t=ea(e);return!isNaN(Number(t))}function Ni(e,t){const r=ea(e),n=ea(t),s=kS(r,n),a=Math.abs(LT(r,n));r.setDate(r.getDate()-s*a);const i=+(kS(r,n)===-s),o=s*(a-i);return o===0?0:o}function kS(e,t){const r=e.getFullYear()-t.getFullYear()||e.getMonth()-t.getMonth()||e.getDate()-t.getDate()||e.getHours()-t.getHours()||e.getMinutes()-t.getMinutes()||e.getSeconds()-t.getSeconds()||e.getMilliseconds()-t.getMilliseconds();return r<0?-1:r>0?1:r}function oU(e){const t=ea(e),r=vo(e,0);return r.setFullYear(t.getFullYear(),0,1),r.setHours(0,0,0,0),r}const lU={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},cU=(e,t,r)=>{let n;const s=lU[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Jf(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const uU={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},fU={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dU={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},hU={date:Jf({formats:uU,defaultWidth:"full"}),time:Jf({formats:fU,defaultWidth:"full"}),dateTime:Jf({formats:dU,defaultWidth:"full"})},pU={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},mU=(e,t,r,n)=>pU[e];function oo(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&e.formattingValues){const i=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):i;s=e.formattingValues[o]||e.formattingValues[i]}else{const i=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;s=e.values[o]||e.values[i]}const a=e.argumentCallback?e.argumentCallback(t):t;return s[a]}}const gU={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xU={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},vU={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},yU={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},wU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},bU={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},NU=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},SU={ordinalNumber:NU,era:oo({values:gU,defaultWidth:"wide"}),quarter:oo({values:xU,defaultWidth:"wide",argumentCallback:e=>e-1}),month:oo({values:vU,defaultWidth:"wide"}),day:oo({values:yU,defaultWidth:"wide"}),dayPeriod:oo({values:wU,defaultWidth:"wide",formattingValues:bU,defaultFormattingWidth:"wide"})};function lo(e){return(t,r={})=>{const n=r.width,s=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(s);if(!a)return null;const i=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?_U(o,h=>h.test(i)):kU(o,h=>h.test(i));let u;u=e.valueCallback?e.valueCallback(l):l,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(i.length);return{value:u,rest:f}}}function kU(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function _U(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function FT(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const s=n[0],a=t.match(e.parsePattern);if(!a)return null;let i=e.valueCallback?e.valueCallback(a[0]):a[0];i=r.valueCallback?r.valueCallback(i):i;const o=t.slice(s.length);return{value:i,rest:o}}}const EU=/^(\d+)(th|st|nd|rd)?/i,AU=/\d+/i,jU={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},TU={any:[/^b/i,/^(a|c)/i]},CU={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},PU={any:[/1/i,/2/i,/3/i,/4/i]},LU={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},FU={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},DU={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},RU={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},OU={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},IU={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},MU={ordinalNumber:FT({matchPattern:EU,parsePattern:AU,valueCallback:e=>parseInt(e,10)}),era:lo({matchPatterns:jU,defaultMatchWidth:"wide",parsePatterns:TU,defaultParseWidth:"any"}),quarter:lo({matchPatterns:CU,defaultMatchWidth:"wide",parsePatterns:PU,defaultParseWidth:"any",valueCallback:e=>e+1}),month:lo({matchPatterns:LU,defaultMatchWidth:"wide",parsePatterns:FU,defaultParseWidth:"any"}),day:lo({matchPatterns:DU,defaultMatchWidth:"wide",parsePatterns:RU,defaultParseWidth:"any"}),dayPeriod:lo({matchPatterns:OU,defaultMatchWidth:"any",parsePatterns:IU,defaultParseWidth:"any"})},BU={code:"en-US",formatDistance:cU,formatLong:hU,formatRelative:mU,localize:SU,match:MU,options:{weekStartsOn:0,firstWeekContainsDate:1}};function UU(e){const t=ea(e);return LT(t,oU(t))+1}function $U(e){const t=ea(e),r=+Tg(t)-+aU(t);return Math.round(r/jT)+1}function DT(e,t){var f,h,p,d;const r=ea(e),n=r.getFullYear(),s=Px(),a=(t==null?void 0:t.firstWeekContainsDate)??((h=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((d=(p=s.locale)==null?void 0:p.options)==null?void 0:d.firstWeekContainsDate)??1,i=vo(e,0);i.setFullYear(n+1,0,a),i.setHours(0,0,0,0);const o=Y0(i,t),l=vo(e,0);l.setFullYear(n,0,a),l.setHours(0,0,0,0);const u=Y0(l,t);return r.getTime()>=o.getTime()?n+1:r.getTime()>=u.getTime()?n:n-1}function zU(e,t){var o,l,u,f;const r=Px(),n=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((f=(u=r.locale)==null?void 0:u.options)==null?void 0:f.firstWeekContainsDate)??1,s=DT(e,t),a=vo(e,0);return a.setFullYear(s,0,n),a.setHours(0,0,0,0),Y0(a,t)}function HU(e,t){const r=ea(e),n=+Y0(r,t)-+zU(r,t);return Math.round(n/jT)+1}function Sr(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Il={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Sr(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Sr(r+1,2)},d(e,t){return Sr(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Sr(e.getHours()%12||12,t.length)},H(e,t){return Sr(e.getHours(),t.length)},m(e,t){return Sr(e.getMinutes(),t.length)},s(e,t){return Sr(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Sr(s,t.length)}},hf={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},_S={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Il.y(e,t)},Y:function(e,t,r,n){const s=DT(e,n),a=s>0?s:1-s;if(t==="YY"){const i=a%100;return Sr(i,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):Sr(a,t.length)},R:function(e,t){const r=PT(e);return Sr(r,t.length)},u:function(e,t){const r=e.getFullYear();return Sr(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Sr(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Sr(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Il.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Sr(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const s=HU(e,n);return t==="wo"?r.ordinalNumber(s,{unit:"week"}):Sr(s,t.length)},I:function(e,t,r){const n=$U(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Sr(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Il.d(e,t)},D:function(e,t,r){const n=UU(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Sr(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return Sr(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const s=e.getDay(),a=(s-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return Sr(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),s=n===0?7:n;switch(t){case"i":return String(s);case"ii":return Sr(s,t.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let s;switch(n===12?s=hf.noon:n===0?s=hf.midnight:s=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let s;switch(n>=17?s=hf.evening:n>=12?s=hf.afternoon:n>=4?s=hf.morning:s=hf.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Il.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Il.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Sr(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Sr(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Il.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Il.s(e,t)},S:function(e,t){return Il.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return AS(n);case"XXXX":case"XX":return Zc(n);case"XXXXX":case"XXX":default:return Zc(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return AS(n);case"xxxx":case"xx":return Zc(n);case"xxxxx":case"xxx":default:return Zc(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ES(n,":");case"OOOO":default:return"GMT"+Zc(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ES(n,":");case"zzzz":default:return"GMT"+Zc(n,":")}},t:function(e,t,r){const n=Math.trunc(e.getTime()/1e3);return Sr(n,t.length)},T:function(e,t,r){const n=e.getTime();return Sr(n,t.length)}};function ES(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Math.trunc(n/60),a=n%60;return a===0?r+String(s):r+String(s)+t+Sr(a,2)}function AS(e,t){return e%60===0?(e>0?"-":"+")+Sr(Math.abs(e)/60,2):Zc(e,t)}function Zc(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),s=Sr(Math.trunc(n/60),2),a=Sr(n%60,2);return r+s+t+a}const jS=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},RT=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},qU=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return jS(e,t);let a;switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",jS(n,t)).replace("{{time}}",RT(s,t))},WU={p:RT,P:qU},VU=/^D+$/,KU=/^Y+$/,GU=["D","DD","YY","YYYY"];function YU(e){return VU.test(e)}function XU(e){return KU.test(e)}function JU(e,t,r){const n=QU(e,t,r);if(console.warn(n),GU.includes(e))throw new RangeError(n)}function QU(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const ZU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,e$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,t$=/^'([^]*?)'?$/,r$=/''/g,n$=/[a-zA-Z]/;function oa(e,t,r){var f,h,p,d,m,g,w,x;const n=Px(),s=(r==null?void 0:r.locale)??n.locale??BU,a=(r==null?void 0:r.firstWeekContainsDate)??((h=(f=r==null?void 0:r.locale)==null?void 0:f.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(p=n.locale)==null?void 0:p.options)==null?void 0:d.firstWeekContainsDate)??1,i=(r==null?void 0:r.weekStartsOn)??((g=(m=r==null?void 0:r.locale)==null?void 0:m.options)==null?void 0:g.weekStartsOn)??n.weekStartsOn??((x=(w=n.locale)==null?void 0:w.options)==null?void 0:x.weekStartsOn)??0,o=ea(e);if(!X0(o))throw new RangeError("Invalid time value");let l=t.match(e$).map(y=>{const b=y[0];if(b==="p"||b==="P"){const S=WU[b];return S(y,s.formatLong)}return y}).join("").match(ZU).map(y=>{if(y==="''")return{isToken:!1,value:"'"};const b=y[0];if(b==="'")return{isToken:!1,value:s$(y)};if(_S[b])return{isToken:!0,value:y};if(b.match(n$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:y}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const u={firstWeekContainsDate:a,weekStartsOn:i,locale:s};return l.map(y=>{if(!y.isToken)return y.value;const b=y.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&XU(b)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&YU(b))&&JU(b,t,String(e));const S=_S[b[0]];return S(o,b,s.localize,u)}).join("")}function s$(e){const t=e.match(t$);return t?t[1].replace(r$,"'"):e}function Si(e,t){const n=l$(e);let s;if(n.date){const l=c$(n.date,2);s=u$(l.restDateString,l.year)}if(!s||isNaN(s.getTime()))return new Date(NaN);const a=s.getTime();let i=0,o;if(n.time&&(i=f$(n.time),isNaN(i)))return new Date(NaN);if(n.timezone){if(o=d$(n.timezone),isNaN(o))return new Date(NaN)}else{const l=new Date(a+i),u=new Date(0);return u.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),u.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),u}return new Date(a+i+o)}const Hm={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},a$=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,i$=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,o$=/^([+-])(\d{2})(?::?(\d{2}))?$/;function l$(e){const t={},r=e.split(Hm.dateTimeDelimiter);let n;if(r.length>2)return t;if(/:/.test(r[0])?n=r[0]:(t.date=r[0],n=r[1],Hm.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Hm.timeZoneDelimiter)[0],n=e.substr(t.date.length,e.length))),n){const s=Hm.timezone.exec(n);s?(t.time=n.replace(s[1],""),t.timezone=s[1]):t.time=n}return t}function c$(e,t){const r=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(r);if(!n)return{year:NaN,restDateString:""};const s=n[1]?parseInt(n[1]):null,a=n[2]?parseInt(n[2]):null;return{year:a===null?s:a*100,restDateString:e.slice((n[1]||n[2]).length)}}function u$(e,t){if(t===null)return new Date(NaN);const r=e.match(a$);if(!r)return new Date(NaN);const n=!!r[4],s=Ah(r[1]),a=Ah(r[2])-1,i=Ah(r[3]),o=Ah(r[4]),l=Ah(r[5])-1;if(n)return x$(t,o,l)?h$(t,o,l):new Date(NaN);{const u=new Date(0);return!m$(t,a,i)||!g$(t,s)?new Date(NaN):(u.setUTCFullYear(t,a,Math.max(s,i)),u)}}function Ah(e){return e?parseInt(e):1}function f$(e){const t=e.match(i$);if(!t)return NaN;const r=lv(t[1]),n=lv(t[2]),s=lv(t[3]);return v$(r,n,s)?r*CT+n*TT+s*1e3:NaN}function lv(e){return e&&parseFloat(e.replace(",","."))||0}function d$(e){if(e==="Z")return 0;const t=e.match(o$);if(!t)return 0;const r=t[1]==="+"?-1:1,n=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return y$(n,s)?r*(n*CT+s*TT):NaN}function h$(e,t,r){const n=new Date(0);n.setUTCFullYear(e,0,4);const s=n.getUTCDay()||7,a=(t-1)*7+r+1-s;return n.setUTCDate(n.getUTCDate()+a),n}const p$=[31,null,31,30,31,30,31,31,30,31,30,31];function OT(e){return e%400===0||e%4===0&&e%100!==0}function m$(e,t,r){return t>=0&&t<=11&&r>=1&&r<=(p$[t]||(OT(e)?29:28))}function g$(e,t){return t>=1&&t<=(OT(e)?366:365)}function x$(e,t,r){return t>=1&&t<=53&&r>=0&&r<=6}function v$(e,t,r){return e===24?t===0&&r===0:r>=0&&r<60&&t>=0&&t<60&&e>=0&&e<25}function y$(e,t){return t>=0&&t<=59}const w$=()=>yc()?require("../db/database").db:null,b$=()=>{Ii();const{user:e}=Rn(),t=Os(),{projects:r,isLoading:n,error:s,refresh:a}=Db((e==null?void 0:e.id)||null),{canModify:i,reason:o}=Ep(),[l,u]=ee.useState([]),[f,h]=ee.useState([]);ee.useEffect(()=>{(async()=>{if(r!=null&&r.length)if(It())try{const b=r.map(A=>Rt.getDecompts(A.id.replace("project:","")).catch(()=>({data:[]}))),S=r.map(A=>Rt.getBordereaux(A.id.replace("project:","")).catch(()=>({data:[]}))),[T,L]=await Promise.all([Promise.all(b),Promise.all(S)]);u(T.flatMap(A=>A.data||A||[])),h(L.flatMap(A=>A.data||A||[]))}catch(b){console.error("Failed to load decompts/bordereaux:",b)}else{const b=w$();if(b){const S=r.map(A=>A.id),[T,L]=await Promise.all([b.decompts.filter(A=>!A.deletedAt&&S.includes(A.projectId)).toArray(),b.bordereaux.filter(A=>!A.deletedAt&&S.includes(A.projectId)).toArray()]);u(T),h(L)}}})()},[r]);const p=ee.useMemo(()=>{if(!r)return{totalProjects:0,activeProjects:0,completedProjects:0,totalBudget:0,totalRealized:0,averageProgress:0,projectsNeedingDecompte:0,upcomingDeadlines:0};const y=r.filter(C=>C.status==="active"),b=r.filter(C=>C.status==="completed");let S=0,T=0;for(const C of r){const E=((f==null?void 0:f.filter(M=>M.projectId===C.id))||[]).reduce((M,ne)=>{const fe=ne.lignes.reduce((me,re)=>me+Number(re.quantite)*Number(re.prixUnitaire||0),0);return M+fe*1.2},0);S+=E;const q=((l==null?void 0:l.filter(M=>M.projectId===C.id))||[]).reduce((M,ne)=>M+(Number(ne.totalTTC)||Number(ne.montantTotal)||0),0);T+=q}const L=S>0?Math.round(T/S*100):0,A=y.filter(C=>{const O=(l==null?void 0:l.filter(P=>P.projectId===C.id))||[];if(O.length===0)return!0;const E=O.sort((P,q)=>new Date(q.createdAt).getTime()-new Date(P.createdAt).getTime())[0];return Ni(new Date,new Date(E.createdAt))>30}),D=y.filter(C=>{if(!C.osc||!C.delaisExecution)return!1;const O=Uh(new Date(C.osc),C.delaisExecution),E=Ni(O,new Date);return E<=30&&E>=0});return{totalProjects:r.length,activeProjects:y.length,completedProjects:b.length,totalBudget:S,totalRealized:T,averageProgress:L,projectsNeedingDecompte:A.length,upcomingDeadlines:D.length}},[r,l,f]),d=ee.useMemo(()=>{if(!r)return[];const y=[],b=new Date;return r.forEach(S=>{const T=S.id.replace("project:","");if(S.status==="active"&&S.osc&&S.delaisExecution){const L=Uh(new Date(S.osc),S.delaisExecution),A=Ni(b,L);A>0?y.push({id:`overdue-${S.id}`,type:"danger",icon:G0,title:`Dlai dpass de ${A} jours`,description:`${S.objet} (${S.marcheNo})`,action:{label:"Voir",path:`/projects/${T}`},projectId:S.id,priority:1}):A>-30&&y.push({id:`deadline-${S.id}`,type:"warning",icon:kB,title:`Fin de dlai dans ${Math.abs(A)} jours`,description:`${S.objet} (${S.marcheNo})`,action:{label:"Voir",path:`/projects/${T}`},projectId:S.id,priority:2})}if(S.status==="active"){const L=(l==null?void 0:l.filter(A=>A.projectId===S.id))||[];if(L.length===0)Ni(b,new Date(S.createdAt))>15&&y.push({id:`no-decompte-${S.id}`,type:"warning",icon:_i,title:"Aucun dcompte cr",description:`${S.objet}`,action:{label:"Crer",path:`/projects/${T}`},projectId:S.id,priority:2});else{const A=L.sort((C,O)=>new Date(O.createdAt).getTime()-new Date(C.createdAt).getTime())[0],D=Ni(b,new Date(A.createdAt));D>30&&y.push({id:`old-decompte-${S.id}`,type:"info",icon:bS,title:`Dcompte ancien (${D}j)`,description:`${S.objet}`,action:{label:"Nouveau",path:`/projects/${T}`},projectId:S.id,priority:3})}}if(S.dateReceptionProvisoire&&!S.dateReceptionDefinitive){const L=new Date(S.dateReceptionProvisoire),A=Uh(L,12),D=Ni(A,b);D<=30&&D>=0&&y.push({id:`garantie-${S.id}`,type:"warning",icon:jg,title:`Fin garantie dans ${D}j`,description:`${S.objet}`,action:{label:"Planifier",path:`/projects/${T}/edit`},projectId:S.id,priority:2})}S.status==="active"&&((f==null?void 0:f.filter(A=>A.projectId===S.id))||[]).length===0&&y.push({id:`no-bordereau-${S.id}`,type:"danger",icon:yn,title:"Bordereau manquant",description:`${S.objet}`,action:{label:"Crer",path:`/projects/${T}`},projectId:S.id,priority:1})}),y.sort((S,T)=>S.priority-T.priority)},[r,l,f]),m=ee.useMemo(()=>r?r.filter(y=>y.status==="active").map(y=>{const b=(l==null?void 0:l.filter(E=>E.projectId===y.id))||[],S=b.sort((E,P)=>new Date(P.createdAt).getTime()-new Date(E.createdAt).getTime())[0],L=((f==null?void 0:f.filter(E=>E.projectId===y.id))||[]).reduce((E,P)=>{const q=P.lignes.reduce((M,ne)=>M+ne.quantite*(ne.prixUnitaire||0),0);return E+q*1.2},0),A=b.reduce((E,P)=>E+(Number(P.totalTTC)||Number(P.montantTotal)||0),0);let D="normal",C="";if(y.osc&&y.delaisExecution){const E=Uh(new Date(y.osc),y.delaisExecution),P=Ni(E,new Date);P<0?(D="critical",C=`Retard ${Math.abs(P)}j`):P<15?(D="high",C=`${P}j restants`):P<30&&(D="medium",C=`${P}j restants`)}const O=parseInt(y.marcheNo.split("/")[0])||999;return{...y,lastDecompte:S,urgency:D,reason:C,montantTTC:L,montantRealise:A,marcheNum:O}}).sort((y,b)=>y.marcheNum-b.marcheNum).slice(0,10):[],[r,l,f]),g=y=>({danger:"bg-red-50 border-red-200 text-red-800",warning:"bg-yellow-50 border-yellow-200 text-yellow-800",info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800"})[y],w=y=>({danger:"text-red-500",warning:"text-yellow-500",info:"text-blue-500",success:"text-green-500"})[y];if(n&&It())return c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(_T,{className:"w-8 h-8 animate-spin text-blue-600 mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Chargement des donnes depuis le serveur..."})]});if(s&&It())return c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(Nu,{className:"w-12 h-12 text-red-500 mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:s}),c.jsxs("button",{onClick:()=>a(),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(xo,{className:"w-4 h-4"}),"Ressayer"]})]});const x=navigator.onLine;return c.jsxs("div",{className:"space-y-6",children:[!x&&It()&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-center gap-3",children:[c.jsx(Nu,{className:"w-5 h-5 text-yellow-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-yellow-800",children:"Mode hors ligne"}),c.jsx("p",{className:"text-sm text-yellow-700",children:"Les modifications sont dsactives. Reconnectez-vous pour continuer."})]})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Tableau de bord"}),c.jsxs("p",{className:"text-gray-600 mt-1",children:["Bienvenue, ",e==null?void 0:e.firstName," ! Voici l'tat de vos projets."]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>a(),disabled:n,className:"btn btn-secondary flex items-center gap-2",title:"Rafrachir depuis le serveur",children:c.jsx(xo,{className:`w-4 h-4 ${n?"animate-spin":""}`})}),i?c.jsxs(ji,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Gs,{className:"w-5 h-5"}),"Nouveau projet"]}):c.jsxs("button",{disabled:!0,className:"btn btn-primary flex items-center gap-2 opacity-50 cursor-not-allowed",title:o||"Non disponible hors ligne",children:[c.jsx(Nu,{className:"w-5 h-5"}),"Nouveau projet"]})]})]}),d.length>0&&c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(rB,{className:"w-5 h-5 text-gray-700"}),c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Alertes (",d.length,")"]})]}),c.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:d.slice(0,4).map(y=>{const b=y.icon;return c.jsxs("div",{className:`p-4 rounded-lg border ${g(y.type)} flex items-start gap-3`,children:[c.jsx(b,{className:`w-5 h-5 mt-0.5 flex-shrink-0 ${w(y.type)}`}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium",children:y.title}),c.jsx("p",{className:"text-sm opacity-80 truncate",children:y.description})]}),y.action&&c.jsxs(ji,{to:y.action.path,className:"flex-shrink-0 text-sm font-medium hover:underline flex items-center gap-1",children:[y.action.label,c.jsx(il,{className:"w-4 h-4"})]})]},y.id)})}),d.length>4&&c.jsxs("p",{className:"text-sm text-gray-500",children:["+ ",d.length-4," autres alertes"]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsx("div",{className:"card bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-500 rounded-xl text-white",children:c.jsx(Du,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-blue-700",children:"Total projets"}),c.jsx("p",{className:"text-2xl font-bold text-blue-900",children:p.totalProjects})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-500 rounded-xl text-white",children:c.jsx(pl,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-green-700",children:"En cours"}),c.jsx("p",{className:"text-2xl font-bold text-green-900",children:p.activeProjects})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-purple-50 to-purple-100 border-purple-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-500 rounded-xl text-white",children:c.jsx(SB,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-purple-700",children:"Progression"}),c.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[p.averageProgress,"%"]})]})]})}),c.jsx("div",{className:"card bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-500 rounded-xl text-white",children:c.jsx(ic,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-orange-700",children:"Budget"}),c.jsxs("p",{className:"text-xl font-bold text-orange-900",children:[isNaN(p.totalBudget)||p.totalBudget===0?"0":(p.totalBudget/1e6).toFixed(1),"M"]})]})]})})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:c.jsx(Za,{className:"w-5 h-5 text-red-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.upcomingDeadlines}),c.jsx("p",{className:"text-xs text-gray-500",children:"Dlais proches"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:c.jsx(bS,{className:"w-5 h-5 text-yellow-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.projectsNeedingDecompte}),c.jsx("p",{className:"text-xs text-gray-500",children:"Besoins dcompte"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:c.jsx(go,{className:"w-5 h-5 text-green-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:p.completedProjects}),c.jsx("p",{className:"text-xs text-gray-500",children:"Termins"})]})]}),c.jsxs("div",{className:"card flex items-center gap-3 py-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(_i,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{children:[c.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[isNaN(p.totalRealized)||p.totalRealized===0?"0":(p.totalRealized/1e6).toFixed(1),"M"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"Ralis"})]})]})]}),c.jsxs("div",{className:"grid lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 card",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[c.jsx(jB,{className:"w-5 h-5 text-yellow-500"}),"Mes projets"]}),c.jsx(ji,{to:"/projects",className:"text-sm text-primary-600 hover:text-primary-700 font-medium",children:"Voir tout"})]}),!r||r.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(Du,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-500 mb-3",children:"Aucun projet"}),c.jsxs(ji,{to:"/projects/new",className:"btn btn-primary btn-sm inline-flex items-center gap-2",children:[c.jsx(Gs,{className:"w-4 h-4"}),"Crer un projet"]})]}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-blue-50 border-y border-blue-200",children:[c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"N March"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Objet"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"CT"}),c.jsx("th",{className:"py-2 px-3 text-left font-semibold text-blue-900",children:"Titulaire du march"}),c.jsx("th",{className:"py-2 px-3 text-right font-semibold text-blue-900",children:"Montant march DH"}),c.jsx("th",{className:"py-2 px-3 text-center font-semibold text-blue-900",children:"Dlai du march"})]})}),c.jsx("tbody",{children:m.map((y,b)=>c.jsxs("tr",{onClick:()=>t(`/projects/${y.id.replace("project:","")}`),className:`border-b border-gray-200 hover:bg-blue-50 cursor-pointer transition-colors ${b%2===0?"bg-white":"bg-gray-50"}`,children:[c.jsx("td",{className:"py-3 px-3 font-medium text-gray-900",children:y.marcheNo}),c.jsx("td",{className:"py-3 px-3 text-gray-700 max-w-xs",children:c.jsx("p",{className:"line-clamp-2",children:y.objet})}),c.jsx("td",{className:"py-3 px-3 text-gray-600",children:y.commune||"-"}),c.jsx("td",{className:"py-3 px-3 text-gray-600",children:y.societe||"-"}),c.jsx("td",{className:"py-3 px-3 text-right font-medium text-gray-900",children:y.montantTTC>0?y.montantTTC.toLocaleString("fr-FR",{minimumFractionDigits:2,maximumFractionDigits:2}):"-"}),c.jsx("td",{className:"py-3 px-3 text-center text-gray-600",children:y.delaisExecution?`${String(y.delaisExecution).padStart(2,"0")} Mois`:"-"})]},y.id))})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rsum financier"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Budget total"}),c.jsxs("span",{className:"font-medium",children:[(p.totalBudget/1e6).toFixed(2)," M DH"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:"100%"}})})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Montant ralis"}),c.jsxs("span",{className:"font-medium",children:[(p.totalRealized/1e6).toFixed(2)," M DH"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:`${p.totalBudget>0?p.totalRealized/p.totalBudget*100:0}%`}})})]}),c.jsx("div",{className:"pt-3 border-t border-gray-100",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Reste  raliser"}),c.jsxs("span",{className:"font-medium text-orange-600",children:[((p.totalBudget-p.totalRealized)/1e6).toFixed(2)," M DH"]})]})}),c.jsx("div",{className:"pt-3 border-t border-gray-100",children:c.jsxs("div",{className:"flex justify-between text-sm",children:[c.jsx("span",{className:"text-gray-600",children:"Taux de ralisation"}),c.jsxs("span",{className:`font-bold ${p.totalBudget>0&&p.totalRealized/p.totalBudget>=.7?"text-green-600":p.totalBudget>0&&p.totalRealized/p.totalBudget>=.4?"text-yellow-600":"text-red-600"}`,children:[p.totalBudget>0?(p.totalRealized/p.totalBudget*100).toFixed(1):0,"%"]})]})}),c.jsxs("div",{className:"pt-3 border-t border-gray-100",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Rpartition des projets"}),c.jsxs("div",{className:"flex gap-1 h-3 rounded-full overflow-hidden",children:[p.activeProjects>0&&c.jsx("div",{className:"bg-green-500",style:{width:`${p.activeProjects/p.totalProjects*100}%`},title:`En cours: ${p.activeProjects}`}),p.completedProjects>0&&c.jsx("div",{className:"bg-blue-500",style:{width:`${p.completedProjects/p.totalProjects*100}%`},title:`Termins: ${p.completedProjects}`}),p.totalProjects-p.activeProjects-p.completedProjects>0&&c.jsx("div",{className:"bg-gray-300",style:{width:`${(p.totalProjects-p.activeProjects-p.completedProjects)/p.totalProjects*100}%`},title:"Autres"})]}),c.jsxs("div",{className:"flex gap-4 mt-2 text-xs",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),"En cours (",p.activeProjects,")"]}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),"Termins (",p.completedProjects,")"]})]})]})]})]})]})]})},TS=()=>yc()?require("../db/database").db:null,N$=()=>{const{t:e}=Ii(),{user:t}=Rn(),r=Os(),[n,s]=ee.useState(""),[a,i]=ee.useState("all"),[o,l]=ee.useState("all"),[u,f]=ee.useState("grid"),{projects:h,isLoading:p,error:d,refresh:m}=Db((t==null?void 0:t.id)||null),{canModify:g,reason:w}=Ep(),[x,y]=ee.useState([]);ee.useEffect(()=>{(async()=>{if(h!=null&&h.length)if(It())try{const E=h.map(M=>Rt.getBordereaux(M.id.replace("project:","")).catch(()=>({data:[]}))),q=(await Promise.all(E)).flatMap(M=>M.data||M||[]);y(q)}catch(E){console.error("Failed to load bordereaux:",E)}else{const E=TS();if(E){const P=h.map(M=>M.id),q=await E.bordereaux.filter(M=>P.includes(M.projectId)&&!M.deletedAt).toArray();y(q)}}})()},[h]);const b=O=>{var q;if(!x.length)return 0;const E=x.find(M=>M.projectId===O);return E?(((q=E.lignes)==null?void 0:q.reduce((M,ne)=>M+ne.quantite*(ne.prixUnitaire||0),0))||0)*1.2:0},S=Array.from(new Set((h==null?void 0:h.map(O=>O.annee))||[])).sort().reverse(),T=h==null?void 0:h.filter(O=>{var M;const E=O.objet.toLowerCase().includes(n.toLowerCase())||O.marcheNo.toLowerCase().includes(n.toLowerCase())||((M=O.societe)==null?void 0:M.toLowerCase().includes(n.toLowerCase())),P=a==="all"||O.status===a,q=o==="all"||O.annee===o;return E&&P&&q}),L=async(O,E)=>{if(E.preventDefault(),E.stopPropagation(),!(!t||!confirm("tes-vous sr de vouloir supprimer ce projet?")))try{if(It()){const P=O.replace("project:","");await Rt.deleteProject(P),m()}else{const P=TS();if(P){const{logSyncOperation:q}=require("../services/syncService"),M=await P.projects.get(O);M&&(await P.projects.update(O,{deletedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),await q("DELETE","project",O.replace("project:",""),M,t.id))}}}catch(P){console.error("Failed to delete project:",P),alert("Erreur lors de la suppression du projet")}},A={total:(T==null?void 0:T.length)||0,active:(T==null?void 0:T.filter(O=>O.status==="active").length)||0,completed:(T==null?void 0:T.filter(O=>O.status==="completed").length)||0,draft:(T==null?void 0:T.filter(O=>O.status==="draft").length)||0,totalBudget:(T==null?void 0:T.reduce((O,E)=>O+b(E.id),0))||0},D=O=>{switch(O){case"active":return c.jsx(pl,{className:"w-4 h-4"});case"completed":return c.jsx(go,{className:"w-4 h-4"});case"archived":return c.jsx(tB,{className:"w-4 h-4"});default:return c.jsx(yn,{className:"w-4 h-4"})}},C=O=>{switch(O){case"active":return"bg-green-100 text-green-700";case"completed":return"bg-blue-100 text-blue-700";case"archived":return"bg-gray-100 text-gray-700";default:return"bg-yellow-100 text-yellow-700"}};return p&&It()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(_T,{className:"w-8 h-8 animate-spin text-blue-600 mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Chargement des projets depuis le serveur..."})]}):d&&It()?c.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[c.jsx(Nu,{className:"w-12 h-12 text-red-500 mb-4"}),c.jsx("p",{className:"text-red-600 font-medium mb-2",children:d}),c.jsxs("button",{onClick:()=>m(),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(xo,{className:"w-4 h-4"}),"Ressayer"]})]}):c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-8",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.projects")}),c.jsxs("p",{className:"text-gray-600 mt-1",children:[A.total," ",A.total>1?"projets":"projet"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("button",{onClick:()=>m(),disabled:p,className:"btn btn-secondary flex items-center gap-2",title:"Rafrachir depuis le serveur",children:c.jsx(xo,{className:`w-4 h-4 ${p?"animate-spin":""}`})}),g?c.jsxs(ji,{to:"/projects/new",className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Gs,{className:"w-5 h-5"}),e("project.newProject")]}):c.jsxs("button",{disabled:!0,className:"btn btn-primary flex items-center gap-2 opacity-50 cursor-not-allowed",title:w||"Non disponible hors ligne",children:[c.jsx(Nu,{className:"w-5 h-5"}),e("project.newProject")]})]})]}),!navigator.onLine&&It()&&c.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 flex items-center gap-3",children:[c.jsx(Nu,{className:"w-5 h-5 text-yellow-600"}),c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-yellow-800",children:"Mode hors ligne"}),c.jsx("p",{className:"text-sm text-yellow-700",children:"Les modifications sont dsactives. Reconnectez-vous pour continuer."})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(Du,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.total}),c.jsx("p",{className:"text-xs text-gray-600",children:"Total"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-green-100 text-green-600 rounded-lg",children:c.jsx(pl,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.active}),c.jsx("p",{className:"text-xs text-gray-600",children:"Actifs"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(go,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.completed}),c.jsx("p",{className:"text-xs text-gray-600",children:"Termins"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-yellow-100 text-yellow-600 rounded-lg",children:c.jsx(yn,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.draft}),c.jsx("p",{className:"text-xs text-gray-600",children:"Brouillons"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(ic,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[(A.totalBudget/1e6).toFixed(1),"M"]}),c.jsx("p",{className:"text-xs text-gray-600",children:"MAD"})]})]})})]}),c.jsx("div",{className:"card mb-6",children:c.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Lb,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),c.jsx("input",{type:"text",placeholder:"Rechercher (Objet, March, Socit...)",className:"input pl-10",value:n,onChange:O=>s(O.target.value)})]}),c.jsxs("select",{className:"input md:w-48",value:a,onChange:O=>i(O.target.value),children:[c.jsx("option",{value:"all",children:"Tous les statuts"}),c.jsx("option",{value:"draft",children:e("project.status.draft")}),c.jsx("option",{value:"active",children:e("project.status.active")}),c.jsx("option",{value:"completed",children:e("project.status.completed")}),c.jsx("option",{value:"archived",children:e("project.status.archived")})]}),c.jsxs("select",{className:"input md:w-32",value:o,onChange:O=>l(O.target.value),children:[c.jsx("option",{value:"all",children:"Toutes"}),S.map(O=>c.jsx("option",{value:O,children:O},O))]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>f("grid"),className:`p-2 rounded-lg border ${u==="grid"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:c.jsx(fB,{className:"w-5 h-5"})}),c.jsx("button",{onClick:()=>f("list"),className:`p-2 rounded-lg border ${u==="list"?"bg-primary-50 border-primary-500 text-primary-600":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:c.jsx(dB,{className:"w-5 h-5"})})]})]})}),!T||T.length===0?c.jsxs("div",{className:"card text-center py-12",children:[c.jsx(Du,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500 mb-4",children:n||a!=="all"||o!=="all"?"Aucun rsultat trouv":"Aucun projet pour le moment"}),!n&&a==="all"&&o==="all"&&c.jsxs(ji,{to:"/projects/new",className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Gs,{className:"w-5 h-5"}),e("project.newProject")]})]}):u==="grid"?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:T.map(O=>{const E=O.id.includes(":")?O.id.split(":").pop():O.id;return c.jsxs("div",{className:"card hover:shadow-lg transition-shadow relative group",children:[c.jsxs(ji,{to:`/projects/${E}`,className:"block",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-lg text-gray-900 flex-1 pr-2 line-clamp-2",children:O.objet}),c.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full flex-shrink-0 ${C(O.status)}`,children:[D(O.status),e(`project.status.${O.status}`)]})]}),c.jsxs("div",{className:"space-y-2 text-sm text-gray-600 mb-4",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"March:"}),c.jsx("span",{className:"font-medium",children:O.marcheNo})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Anne:"}),c.jsx("span",{className:"font-medium",children:O.annee})]}),O.societe&&c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Socit:"}),c.jsx("span",{className:"font-medium truncate ml-2",children:O.societe})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Montant (TTC):"}),c.jsxs("span",{className:"font-medium text-primary-600",children:[b(O.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{className:"flex justify-between text-xs",children:[c.jsx("span",{children:"Cr le:"}),c.jsx("span",{children:oa(new Date(O.createdAt),"dd/MM/yyyy")})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[c.jsx("span",{children:e("project.progress")}),c.jsxs("span",{className:"font-medium",children:[O.progress,"%"]})]}),c.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500 transition-all",style:{width:`${O.progress}%`}})})]})]}),c.jsxs("div",{className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity flex gap-2",children:[c.jsx("button",{onClick:P=>{P.preventDefault(),r(`/projects/${E}`)},className:"p-2 bg-white rounded-lg shadow-md hover:bg-primary-50 text-primary-600",title:"Voir",children:c.jsx(Ag,{className:"w-4 h-4"})}),c.jsx("button",{onClick:P=>L(O.id,P),className:"p-2 bg-white rounded-lg shadow-md hover:bg-red-50 text-red-600",title:"Supprimer",children:c.jsx(ma,{className:"w-4 h-4"})})]})]},O.id)})}):c.jsx("div",{className:"card overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Objet"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"March"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Anne"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Montant (TTC)"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Statut"}),c.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-700",children:"Avancement"}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:"Actions"})]})}),c.jsx("tbody",{children:T.map(O=>{const E=O.id.includes(":")?O.id.split(":").pop():O.id;return c.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 cursor-pointer",onClick:()=>r(`/projects/${E}`),children:[c.jsxs("td",{className:"py-3 px-4",children:[c.jsx("div",{className:"font-medium text-gray-900",children:O.objet}),O.societe&&c.jsx("div",{className:"text-xs text-gray-500",children:O.societe})]}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:O.marcheNo}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:O.annee}),c.jsxs("td",{className:"py-3 px-4 text-sm font-medium text-primary-600",children:[b(O.id).toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${C(O.status)}`,children:[D(O.status),e(`project.status.${O.status}`)]})}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:"h-full bg-primary-500",style:{width:`${O.progress}%`}})}),c.jsxs("span",{className:"text-xs text-gray-600 w-10",children:[O.progress,"%"]})]})}),c.jsx("td",{className:"py-3 px-4 text-right",children:c.jsxs("div",{className:"flex items-center justify-end gap-2",children:[c.jsx("button",{onClick:P=>{P.stopPropagation(),r(`/projects/${E}`)},className:"p-1.5 hover:bg-primary-50 text-primary-600 rounded",title:"Voir",children:c.jsx(Ag,{className:"w-4 h-4"})}),c.jsx("button",{onClick:P=>L(O.id,P),className:"p-1.5 hover:bg-red-50 text-red-600 rounded",title:"Supprimer",children:c.jsx(ma,{className:"w-4 h-4"})})]})})]},O.id)})})]})})})]})},S$={lessThanXSeconds:{one:"moins dune seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dune minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dun an",other:"plus de {{count}} ans"},almostXYears:{one:"presquun an",other:"presque {{count}} ans"}},k$=(e,t,r)=>{let n;const s=S$[e];return typeof s=="string"?n=s:t===1?n=s.one:n=s.other.replace("{{count}}",String(t)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},_$={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},E$={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},A$={full:"{{date}} '' {{time}}",long:"{{date}} '' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},j$={date:Jf({formats:_$,defaultWidth:"full"}),time:Jf({formats:E$,defaultWidth:"full"}),dateTime:Jf({formats:A$,defaultWidth:"full"})},T$={lastWeek:"eeee 'dernier ' p",yesterday:"'hier ' p",today:"'aujourdhui ' p",tomorrow:"'demain ' p'",nextWeek:"eeee 'prochain ' p",other:"P"},C$=(e,t,r,n)=>T$[e],P$={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant Jsus-Christ","aprs Jsus-Christ"]},L$={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2me trim.","3me trim.","4me trim."],wide:["1er trimestre","2me trimestre","3me trimestre","4me trimestre"]},F$={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fvr.","mars","avr.","mai","juin","juil.","aot","sept.","oct.","nov.","dc."],wide:["janvier","fvrier","mars","avril","mai","juin","juillet","aot","septembre","octobre","novembre","dcembre"]},D$={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},R$={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprs-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de laprs-midi",evening:"du soir",night:"du matin"}},O$=(e,t)=>{const r=Number(e),n=t==null?void 0:t.unit;if(r===0)return"0";const s=["year","week","hour","minute","second"];let a;return r===1?a=n&&s.includes(n)?"re":"er":a="me",r+a},I$=["MMM","MMMM"],M$={preprocessor:(e,t)=>e.getDate()===1||!t.some(n=>n.isToken&&I$.includes(n.value))?t:t.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:O$,era:oo({values:P$,defaultWidth:"wide"}),quarter:oo({values:L$,defaultWidth:"wide",argumentCallback:e=>e-1}),month:oo({values:F$,defaultWidth:"wide"}),day:oo({values:D$,defaultWidth:"wide"}),dayPeriod:oo({values:R$,defaultWidth:"wide"})},B$=/^(\d+)(ime|re|me|er|e)?/i,U$=/\d+/i,$$={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant Jsus-Christ|aprs Jsus-Christ)/i},z$={any:[/^av/i,/^ap/i]},H$={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|me|e)? trim\.?/i,wide:/^[1234](er|me|e)? trimestre/i},q$={any:[/1/i,/2/i,/3/i,/4/i]},W$={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fvr|mars|avr|mai|juin|juill|juil|aot|sept|oct|nov|dc)\.?/i,wide:/^(janvier|fvrier|mars|avril|mai|juin|juillet|aot|septembre|octobre|novembre|dcembre)/i},V$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},K$={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},G$={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},Y$={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprs[-\s]midi|du soir|de la nuit)/i},X$={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},J$={ordinalNumber:FT({matchPattern:B$,parsePattern:U$,valueCallback:e=>parseInt(e)}),era:lo({matchPatterns:$$,defaultMatchWidth:"wide",parsePatterns:z$,defaultParseWidth:"any"}),quarter:lo({matchPatterns:H$,defaultMatchWidth:"wide",parsePatterns:q$,defaultParseWidth:"any",valueCallback:e=>e+1}),month:lo({matchPatterns:W$,defaultMatchWidth:"wide",parsePatterns:V$,defaultParseWidth:"any"}),day:lo({matchPatterns:K$,defaultMatchWidth:"wide",parsePatterns:G$,defaultParseWidth:"any"}),dayPeriod:lo({matchPatterns:Y$,defaultMatchWidth:"any",parsePatterns:X$,defaultParseWidth:"any"})},Rb={code:"fr",formatDistance:k$,formatLong:j$,formatRelative:C$,localize:M$,match:J$,options:{weekStartsOn:1,firstWeekContainsDate:4}},J0=[{id:"DEB-001",code:"1.1",designation:"Dblais pour ouvrages excuts dans l'eau en terrain de toute nature y compris la roche et  toute profondeur LE METRE CUBE",unite:"M",prixReference:48,categorie:"Terrassement",tags:["dblais","eau","terrain","roche"]},{id:"FOU-001",code:"1.2",designation:"Fourniture et mise en place de gabions y compris cage, enrochement et terrassements LE METRE CUBE",unite:"M",prixReference:400,categorie:"Terrassement",tags:["fourniture","gabions","cage","enrochement"]},{id:"BET-001",code:"1.3",designation:"Gros bton dos  300kg/m3 de ciment CPJ 45 y compris coffrage et dcoffrage et toutes sujtions LE METRE CUBE",unite:"M",prixReference:753.5,categorie:"Bton",tags:["bton","ciment","coffrage","dcoffrage"]},{id:"REM-001",code:"1.4",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:30,categorie:"Terrassement",tags:["remblais","compact","ouvrages"]},{id:"DEB-002",code:"2.1",designation:"Dblais pour ouvrages et canaux excuts dans le lit de l'oued y compris rocher et terrassement dans l'eau toutes sujtions. LE METRE CUBE",unite:"M",prixReference:70,categorie:"Hydro-Agricole",tags:["dblais","canaux","oued","rocher"]},{id:"HER-001",code:"2.2",designation:"Hrissonnage de gros pierres sches poses  la main sur le sol et point en l'air  recopiissage  la pierre casse et fortement dame. LE METRE CARRE",unite:"M",prixReference:50,categorie:"Hydro-Agricole",tags:["hrissonnage","pierres","casse","dame"]},{id:"BET-002",code:"2.3",designation:"Bton pour bton arm dos  350kg/m3 de ciment CPJ 45 y compris coffrage, dcoffrage et toutes sujtions. LE METRE CUBE",unite:"M",prixReference:1150,categorie:"Bton",tags:["bton arm","ciment","coffrage"]},{id:"FOU-002",code:"2.4",designation:"Fourniture et pose des aciers mi-durs  haute adhrence pour armatures de tout diamtre y compris toutes sujtions de mise en dpts. LE KILOGRAMME",unite:"KG",prixReference:15,categorie:"Ferraillage",tags:["fourniture","aciers","armatures","adhrence"]},{id:"CUR-001",code:"2.5",designation:"Curage et reprofilage de khettaras LE METRE LINEAIRE",unite:"ML",prixReference:400,categorie:"Hydro-Agricole",tags:["curage","reprofilage","khettaras"]},{id:"REM-002",code:"2.6",designation:"Remblais ordinaire tal sur les bords des ouvrages et compact lgrement y compris toutes sujtions de mise en dpts. LE METRE CUBE",unite:"M",prixReference:40,categorie:"Terrassement",tags:["remblais","ordinaire","compact"]},{id:"JOI-001",code:"2.7",designation:"Joint de retrait ralis au moyen d'un produit bitumineux y compris toutes sujtions LE METRE LINEAIRE",unite:"ML",prixReference:100,categorie:"tanchit",tags:["joint","retrait","bitumineux"]},{id:"FOU-003",code:"2.8",designation:"Fourniture et pose de tle mtalliques pour vannette LE KILOGRAMME",unite:"KG",prixReference:60,categorie:"Mtallerie",tags:["fourniture","tle","vannette"]},{id:"MUR-001",code:"3.1",designation:"Mur en moellons de pierre y compris mortier et toutes sujtions LE METRE CUBE",unite:"M",prixReference:850,categorie:"Maonnerie",tags:["mur","moellons","pierre","mortier"]},{id:"END-001",code:"3.2",designation:"Enduit de ciment liss sur murs y compris toutes sujtions LE METRE CARRE",unite:"M",prixReference:45,categorie:"Finition",tags:["enduit","ciment","liss","murs"]},{id:"CHA-001",code:"4.1",designation:"Charpente mtallique y compris peinture antirouille LE KILOGRAMME",unite:"KG",prixReference:25,categorie:"Charpente",tags:["charpente","mtallique","peinture"]},{id:"TUI-001",code:"4.2",designation:"Tuiles mcaniques y compris pose et accessoires LE METRE CARRE",unite:"M",prixReference:120,categorie:"Couverture",tags:["tuiles","mcaniques","pose"]}],Q$=["Terrassement","Bton","Ferraillage","Hydro-Agricole","Maonnerie","Finition","tanchit","Mtallerie","Charpente","Couverture"],Z$=e=>{if(!e)return J0;const t=e.toLowerCase();return J0.filter(r=>r.designation.toLowerCase().includes(t)||r.code.includes(t)||r.categorie.toLowerCase().includes(t)||r.tags.some(n=>n.includes(t)))},ez=e=>J0.filter(t=>t.categorie===e),IT=({bordereauId:e,onClose:t})=>{const{user:r}=Rn(),[n,s]=ee.useState([]),[a,i]=ee.useState(null),[o,l]=ee.useState(""),[u,f]=ee.useState(!1),[h,p]=ee.useState(0),d=ee.useRef({}),m=Js(()=>Le.bordereaux.get(e),[e]),g=o.length>=2?Z$(o).slice(0,5):[];ee.useEffect(()=>{m!=null&&m.lignes&&s(m.lignes)},[m]);const w=()=>{const E=n.reduce((M,ne)=>M+ne.montant,0),P=E*.2,q=E+P;return{montantHT:E,tva:P,montantTTC:q}},x=()=>{const E={id:jr(),numero:n.length+1,designation:"",unite:"",quantite:0,prixUnitaire:0,montant:0};s([...n,E]),i(E.id),setTimeout(()=>{var P;(P=d.current[`designation-${E.id}`])==null||P.focus()},50)},y=(E,P,q)=>{s(M=>M.map(ne=>{if(ne.id===E){const fe={...ne,[P]:q};return(P==="quantite"||P==="prixUnitaire")&&(fe.montant=fe.quantite*fe.prixUnitaire),fe}return ne}))},b=E=>{const q=n.filter(M=>M.id!==E).map((M,ne)=>({...M,numero:ne+1}));s(q)},S=E=>{if(!a||!g[E])return;const P=g[E];y(a,"designation",P.designation),y(a,"unite",P.unite),y(a,"prixUnitaire",P.prixReference),l(""),f(!1),p(0),setTimeout(()=>{var q;(q=d.current[`quantite-${a}`])==null||q.focus()},50)},T=(E,P,q)=>{q==="designation"&&u?E.key==="ArrowDown"?(E.preventDefault(),p(M=>Math.min(M+1,g.length-1))):E.key==="ArrowUp"?(E.preventDefault(),p(M=>Math.max(M-1,0))):E.key==="Enter"?(E.preventDefault(),S(h)):E.key==="Escape"&&(f(!1),l("")):E.key==="Enter"&&(E.preventDefault(),(q==="montant"||q==="prixUnitaire")&&x())},L=async()=>{if(!r||!m)return;const{montantHT:E}=w(),P={...m,lignes:n,montantTotal:E,updatedAt:new Date().toISOString()};await Le.bordereaux.update(e,P),await us("UPDATE","bordereau",e.replace("bordereau:",""),P,r.id),alert("Bordereau enregistr avec succs !")},A=()=>{if(!m)return;const{montantHT:E,tva:P,montantTTC:q}=w();let M=`N,Dsignation des ouvrages,U,Quantit,Prix unitaire (MAD),Montant (MAD)
`;n.forEach(me=>{M+=`${me.numero},"${me.designation}",${me.unite},${me.quantite},${me.prixUnitaire},${me.montant}
`}),M+=`
,,,Total HT:,,${E.toFixed(2)}
`,M+=`,,,TVA 20%:,,${P.toFixed(2)}
`,M+=`,,,Total TTC:,,${q.toFixed(2)}
`;const ne=new Blob([M],{type:"text/csv;charset=utf-8;"}),fe=document.createElement("a");fe.href=URL.createObjectURL(ne),fe.download=`${m.reference}.csv`,fe.click()};if(!m)return c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})});const{montantHT:D,tva:C,montantTTC:O}=w();return c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6 pb-4 border-b",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ri,{className:"w-5 h-5"})}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:m.reference}),c.jsx("p",{className:"text-sm text-gray-600",children:m.designation})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:A,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Md,{className:"w-4 h-4"}),"Exporter CSV"]}),c.jsxs("button",{onClick:L,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Hu,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50 border-b-2 border-gray-200",children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 w-16",children:"N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Dsignation des ouvrages"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 w-24",children:"Unit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-32",children:"Quantit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Prix unitaire (MAD)"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40",children:"Montant (MAD)"}),c.jsx("th",{className:"px-4 py-3 w-12"})]})}),c.jsx("tbody",{children:n.map(E=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-2 text-gray-700",children:E.numero}),c.jsxs("td",{className:"px-4 py-2 relative",children:[c.jsx("input",{ref:P=>d.current[`designation-${E.id}`]=P,type:"text",value:a===E.id&&o||E.designation,onChange:P=>{const q=P.target.value;y(E.id,"designation",q),a===E.id&&(l(q),f(q.length>=2),p(0))},onFocus:()=>{i(E.id),l(E.designation),E.designation.length>=2&&f(!0)},onBlur:()=>{setTimeout(()=>{f(!1),i(null),l("")},200)},onKeyDown:P=>T(P,E.id,"designation"),className:"input text-sm w-full",placeholder:"Rechercher ou taper..."}),a===E.id&&u&&g.length>0&&c.jsx("div",{className:"absolute z-50 mt-1 w-full bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:g.map((P,q)=>c.jsxs("div",{onClick:()=>S(q),className:`px-4 py-2 cursor-pointer ${q===h?"bg-primary-50":"hover:bg-gray-50"}`,children:[c.jsx("div",{className:"font-medium text-sm text-gray-900",children:P.code}),c.jsx("div",{className:"text-xs text-gray-600 truncate",children:P.designation}),c.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[c.jsxs("span",{className:"font-medium text-primary-600",children:[P.prixReference," MAD"]}),c.jsx("span",{children:""}),c.jsx("span",{children:P.unite})]})]},P.id))})]}),c.jsx("td",{className:"px-2 py-2 w-24",children:c.jsxs("select",{value:E.unite||"",onChange:P=>y(E.id,"unite",P.target.value),className:"w-full px-2 py-1.5 text-sm border border-gray-300 rounded-md bg-white focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[c.jsx("option",{value:"",children:"--"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"ML",children:"ML"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"KG",children:"KG"}),c.jsx("option",{value:"T",children:"T"}),c.jsx("option",{value:"U",children:"U"}),c.jsx("option",{value:"ENS",children:"ENS"}),c.jsx("option",{value:"M",children:"M"}),c.jsx("option",{value:"FF",children:"FF"}),c.jsx("option",{value:"L",children:"L"})]})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{ref:P=>d.current[`quantite-${E.id}`]=P,type:"number",step:"0.01",value:E.quantite||"",onChange:P=>y(E.id,"quantite",parseFloat(P.target.value)||0),onKeyDown:P=>T(P,E.id,"quantite"),className:"input text-sm text-right w-full"})}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("input",{type:"number",step:"0.01",value:E.prixUnitaire||"",onChange:P=>y(E.id,"prixUnitaire",parseFloat(P.target.value)||0),onKeyDown:P=>T(P,E.id,"prixUnitaire"),className:"input text-sm text-right w-full"})}),c.jsx("td",{className:"px-4 py-2 text-right font-medium text-gray-900",children:E.montant.toFixed(2)}),c.jsx("td",{className:"px-4 py-2",children:c.jsx("button",{onClick:()=>b(E.id),className:"p-1 hover:bg-red-50 text-red-600 rounded transition-colors",children:c.jsx(ma,{className:"w-4 h-4"})})})]},E.id))}),c.jsx("tfoot",{children:c.jsx("tr",{children:c.jsx("td",{colSpan:7,className:"px-4 py-2",children:c.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-primary-600 hover:text-primary-700 font-medium text-sm",children:[c.jsx(Gs,{className:"w-4 h-4"}),"Ajouter une ligne"]})})})})]})}),c.jsx("div",{className:"mt-6 pt-6 border-t",children:c.jsxs("div",{className:"max-w-md ml-auto space-y-2",children:[c.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[c.jsx("span",{children:"Total HT:"}),c.jsxs("span",{className:"font-semibold",children:[D.toFixed(2)," MAD"]})]}),c.jsxs("div",{className:"flex items-center justify-between text-gray-700",children:[c.jsx("span",{children:"TVA 20%:"}),c.jsxs("span",{className:"font-semibold",children:[C.toFixed(2)," MAD"]})]}),c.jsxs("div",{className:"flex items-center justify-between text-lg font-bold text-gray-900 pt-2 border-t",children:[c.jsx("span",{children:"Total TTC:"}),c.jsxs("span",{className:"text-primary-600",children:[O.toFixed(2)," MAD"]})]})]})})]})},MT=({onClose:e,onCreate:t})=>{const[r,n]=ee.useState(""),[s,a]=ee.useState(""),i=o=>{o.preventDefault(),r.trim()&&s.trim()&&t({reference:r.trim(),designation:s.trim()})};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full mx-4",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Nouveau bordereau"}),c.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Ac,{className:"w-5 h-5"})})]}),c.jsxs("form",{onSubmit:i,className:"p-6 space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:r,onChange:o=>n(o.target.value),className:"input",placeholder:"Ex: BPU-2024-01",required:!0,autoFocus:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),c.jsx("textarea",{value:s,onChange:o=>a(o.target.value),className:"input",rows:3,placeholder:"Ex: Bordereau des Prix Unitaires - Terrassement",required:!0})]}),c.jsxs("div",{className:"flex items-center gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:"Crer"})]})]})]})})},BT=({projectId:e,onClose:t,onCreated:r})=>{const{user:n}=Rn(),[s,a]=ee.useState(""),[i,o]=ee.useState(""),[l,u]=ee.useState(new Set),f=i?ez(i):J0.filter(d=>s===""||d.designation.toLowerCase().includes(s.toLowerCase())||d.code.toLowerCase().includes(s.toLowerCase())||d.tags.some(m=>m.toLowerCase().includes(s.toLowerCase()))),h=d=>{const m=new Set(l);m.has(d)?m.delete(d):m.add(d),u(m)},p=async()=>{if(!n||l.size===0){alert("Veuillez slectionner au moins un article");return}const d=`bordereau:${jr()}`,m=new Date().toISOString(),g=new Date().getFullYear(),w=Array.from(l).map((y,b)=>{const S=J0.find(T=>T.id===y);return S?{id:jr(),numero:b+1,designation:S.designation,unite:S.unite,quantite:0,prixUnitaire:S.prixReference,montant:0}:null}).filter(y=>y!==null),x={id:d,projectId:e,userId:n.id,reference:`BPU-${g}`,designation:"Bordereau des Prix Unitaires",lignes:w,montantTotal:0,createdAt:m,updatedAt:m};await Le.bordereaux.add(x),await us("CREATE","bordereau",d.replace("bordereau:",""),x,n.id),r(d)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Bibliothque de modles"}),c.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[l.size," article(s) slectionn(s)"]})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Ac,{className:"w-5 h-5"})})]}),c.jsx("div",{className:"p-6 border-b space-y-4",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("div",{className:"flex-1 relative",children:[c.jsx(Lb,{className:"w-5 h-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),c.jsx("input",{type:"text",value:s,onChange:d=>a(d.target.value),className:"input pl-10",placeholder:"Rechercher par dsignation, code ou tag..."})]}),c.jsxs("select",{value:i,onChange:d=>o(d.target.value),className:"input w-64",children:[c.jsx("option",{value:"",children:"Toutes les catgories"}),Q$.map(d=>c.jsx("option",{value:d,children:d},d))]})]})}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:f.map(d=>c.jsx("div",{onClick:()=>h(d.id),className:`card cursor-pointer transition-all border-2 ${l.has(d.id)?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("input",{type:"checkbox",checked:l.has(d.id),onChange:()=>{},className:"mt-1"}),c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-start justify-between gap-2",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-900",children:d.code}),c.jsx("div",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:d.designation})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"font-semibold text-primary-600",children:[d.prixReference," MAD"]}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:d.unite})]})]}),c.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[c.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-700 rounded",children:d.categorie}),d.tags.slice(0,2).map((m,g)=>c.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:m},g))]})]})]})},d.id))}),f.length===0&&c.jsxs("div",{className:"text-center py-12",children:[c.jsx(iB,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),c.jsx("p",{className:"text-gray-500",children:"Aucun modle trouv"})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:p,disabled:l.size===0,className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed",children:["Crer avec ",l.size," article(s)"]})]})})]})})},UT=({currentProjectId:e,onClose:t,onCopied:r})=>{var w;const{user:n}=Rn(),[s,a]=ee.useState(""),[i,o]=ee.useState(""),[l,u]=ee.useState(""),[f,h]=ee.useState(""),p=Js(()=>Le.projects.where("userId").equals((n==null?void 0:n.id)||"").and(x=>!x.deletedAt&&x.id!==`project:${e}`).toArray(),[n,e]),d=Js(()=>s?Le.bordereaux.where("projectId").equals(s).and(x=>!x.deletedAt).toArray():Promise.resolve([]),[s]),m=Js(()=>i?Le.bordereaux.get(i):Promise.resolve(null),[i]),g=async()=>{if(!n||!m||!l.trim()||!f.trim()){alert("Veuillez remplir tous les champs et slectionner un bordereau");return}const x=`bordereau:${jr()}`,y=new Date().toISOString(),b=m.lignes.map((T,L)=>({...T,id:jr(),numero:L+1,quantite:0,montant:0})),S={id:x,projectId:e,userId:n.id,reference:l.trim(),designation:f.trim(),lignes:b,montantTotal:0,createdAt:y,updatedAt:y};await Le.bordereaux.add(S),await us("CREATE","bordereau",x.replace("bordereau:",""),S,n.id),r(x)};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Copier depuis un projet"}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Ac,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"1. Slectionner le projet source"}),c.jsxs("select",{value:s,onChange:x=>{a(x.target.value),o("")},className:"input w-full",children:[c.jsx("option",{value:"",children:"Choisir un projet..."}),p==null?void 0:p.map(x=>c.jsxs("option",{value:x.id,children:[x.objet," - March N ",x.marcheNo]},x.id))]})]}),s&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"2. Slectionner le bordereau  copier"}),d&&d.length>0?c.jsx("div",{className:"space-y-2",children:d.map(x=>{var y,b;return c.jsx("div",{onClick:()=>o(x.id),className:`card cursor-pointer transition-all border-2 ${i===x.id?"border-primary-500 bg-primary-50":"border-gray-200 hover:border-primary-300"}`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"w-10 h-10 bg-primary-100 text-primary-600 rounded-lg flex items-center justify-center",children:c.jsx(yn,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("div",{className:"font-medium text-gray-900",children:x.reference}),c.jsx("div",{className:"text-sm text-gray-600",children:x.designation}),c.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[((y=x.lignes)==null?void 0:y.length)||0," lignes  ",(b=x.montantTotal)==null?void 0:b.toLocaleString()," MAD"]})]})]})},x.id)})}):c.jsxs("div",{className:"text-center py-8 text-gray-500",children:[c.jsx(yn,{className:"w-12 h-12 text-gray-300 mx-auto mb-2"}),c.jsx("p",{children:"Aucun bordereau dans ce projet"})]})]}),i&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"3. Informations du nouveau bordereau"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:l,onChange:x=>u(x.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-02"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Dsignation *"}),c.jsx("input",{type:"text",value:f,onChange:x=>h(x.target.value),className:"input w-full",placeholder:"Ex: Bordereau copi"})]}),m&&c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(Eg,{className:"w-5 h-5 text-blue-600 mt-0.5"}),c.jsxs("div",{className:"text-sm text-blue-900",children:[c.jsx("p",{className:"font-medium mb-1",children:"Contenu  copier:"}),c.jsxs("ul",{className:"list-disc list-inside space-y-1 text-blue-700",children:[c.jsxs("li",{children:[((w=m.lignes)==null?void 0:w.length)||0," lignes de bordereau"]}),c.jsx("li",{children:"Dsignations et units"}),c.jsx("li",{children:"Prix unitaires de rfrence"}),c.jsx("li",{className:"font-medium",children:"Les quantits seront remises  0"})]})]})]})})]})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:g,disabled:!i||!l.trim()||!f.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx(Eg,{className:"w-4 h-4"}),"Copier le bordereau"]})]})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var $T=1252,tz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ob={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Ib=function(e){tz.indexOf(e)!=-1&&($T=Ob[0]=e)};function rz(){Ib(1252)}var Ti=function(e){Ib(e)};function zT(){Ti(1200),rz()}function CS(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function nz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function HT(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var $h=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?nz(e.slice(2)):t==254&&r==255?HT(e.slice(2)):t==65279?e.slice(1):e},qm=function(t){return String.fromCharCode(t)},PS=function(t){return String.fromCharCode(t)},Q0,oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function LS(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),t+=oc.charAt(a)+oc.charAt(i)+oc.charAt(o)+oc.charAt(l);return t}function Ra(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=oc.indexOf(e.charAt(u++)),i=oc.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=oc.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=oc.indexOf(e.charAt(u++)),s=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(s));return t}var ur=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qu=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function jc(e){return ur?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function FS(e){return ur?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ai=function(t){return ur?qu(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Wu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Mb(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Mb(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xl=ur?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:qu(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function sz(e){for(var t=[],r=0,n=e.length+250,s=jc(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=jc(65535),n=65530)}return t.push(s.slice(0,r)),Xl(t)}var Qs=/\u0000/g,zh=/[\u0001-\u0006]/g;function Qf(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Ci(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}function Bb(e,t){var r=""+e;return r.length>=t?r:fn(" ",t-r.length)+r}function Cg(e,t){var r=""+e;return r.length>=t?r:r+fn(" ",t-r.length)}function az(e,t){var r=""+Math.round(e);return r.length>=t?r:fn("0",t-r.length)+r}function iz(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}var DS=Math.pow(2,32);function pf(e,t){if(e>DS||e<-DS)return az(e,t);var r=Math.round(e);return iz(r,t)}function Pg(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var RS=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function oz(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var er={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},OS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},lz={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Lg(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,l=1,u=0,f=0,h=Math.floor(s);u<t&&(h=Math.floor(s),o=h*i+a,f=h*u+l,!(s-h<5e-8));)s=1/(s-h),a=i,i=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=a):(f=u,o=i)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function lu(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=pz(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var qT=new Date(1899,11,31,0,0,0),cz=qT.getTime(),uz=new Date(1900,2,1,0,0,0);function WT(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=uz&&(r+=24*60*60*1e3),(r-(cz+(e.getTimezoneOffset()-qT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ub(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function fz(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function dz(e){var t=e<0?12:11,r=Ub(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function hz(e){var t=Ub(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Z0(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=dz(e):t===10?r=e.toFixed(10).substr(0,12):r=hz(e),Ub(fz(r.toUpperCase()))}function Ru(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Z0(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ni(14,WT(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function pz(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function mz(e,t,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return cv[r.m-1][1];case 5:return cv[r.m-1][0];default:return cv[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return RS[r.q][0];default:return RS[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Ci(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Ci(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?Ci(l,u):"";return f}function lc(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var VT=/%/g;function gz(e,t,r){var n=t.replace(VT,""),s=t.length-n.length;return ol(e,n,r*Math.pow(10,2*s))+fn("%",s)}function xz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function KT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+KT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var GT=/# (\?+)( ?)\/( ?)(\d+)/;function vz(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?fn(" ",e[1].length+1+e[4].length):Bb(i,e[1].length)+e[2]+"/"+e[3]+Ci(o,e[4].length))}function yz(e,t,r){return r+(t===0?"":""+t)+fn(" ",e[1].length+2+e[4].length)}var YT=/^#*0*\.([0#]+)/,XT=/\).*[0#]/,JT=/\(###\) ###\\?-####/;function qs(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function IS(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function MS(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function wz(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function bz(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Wa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(XT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wa("n",n,r):"("+Wa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return xz(e,t,r);if(t.indexOf("%")!==-1)return gz(e,t,r);if(t.indexOf("E")!==-1)return KT(t,r);if(t.charCodeAt(0)===36)return"$"+Wa(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+pf(l,t.length);if(t.match(/^[#?]+$/))return s=pf(r,0),s==="0"&&(s=""),s.length>t.length?s:qs(t.substr(0,t.length-s.length))+s;if(a=t.match(GT))return vz(a,l,u);if(t.match(/^#+0+$/))return u+pf(l,t.length-t.indexOf("0"));if(a=t.match(YT))return s=IS(r,a[1].length).replace(/^([^\.]+)$/,"$1."+qs(a[1])).replace(/\.$/,"."+qs(a[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+fn("0",qs(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+IS(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+lc(pf(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wa(e,t,-r):lc(""+(Math.floor(r)+wz(r,a[1].length)))+"."+Ci(MS(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Wa(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qf(Wa(e,t.replace(/[\\-]/g,""),r)),i=0,Qf(Qf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(JT))return s=Wa(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Lg(l,Math.pow(10,i)-1,!1),s=""+u,f=ol("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=Cg(o[2],i),f.length<a[4].length&&(f=qs(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Lg(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bb(o[1],i)+a[2]+"/"+a[3]+Cg(o[2],i):fn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=pf(r,0),t.length<=s.length?s:qs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,p=t.length-s.length-h;return qs(t.substr(0,h)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=MS(r,a[1].length),r<0?"-"+Wa(e,t,-r):lc(bz(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ci(0,3-m.length):"")+m})+"."+Ci(i,a[1].length);switch(t){case"###,##0.00":return Wa(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=lc(pf(l,0));return d!=="0"?u+d:"";case"###,###.00":return Wa(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wa(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Nz(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ol(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Sz(e,t,r){var n=t.replace(VT,""),s=t.length-n.length;return ol(e,n,r*Math.pow(10,2*s))+fn("%",s)}function QT(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+QT(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Zi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(XT)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Zi("n",n,r):"("+Zi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nz(e,t,r);if(t.indexOf("%")!==-1)return Sz(e,t,r);if(t.indexOf("E")!==-1)return QT(t,r);if(t.charCodeAt(0)===36)return"$"+Zi(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ci(l,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:qs(t.substr(0,t.length-s.length))+s;if(a=t.match(GT))return yz(a,l,u);if(t.match(/^#+0+$/))return u+Ci(l,t.length-t.indexOf("0"));if(a=t.match(YT))return s=(""+r).replace(/^([^\.]+)$/,"$1."+qs(a[1])).replace(/\.$/,"."+qs(a[1])),s=s.replace(/\.(\d*)$/,function(m,g){return"."+g+fn("0",qs(a[1]).length-g.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+lc(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Zi(e,t,-r):lc(""+r)+"."+fn("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Zi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qf(Zi(e,t.replace(/[\\-]/g,""),r)),i=0,Qf(Qf(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return i<s.length?s.charAt(i++):m==="0"?"0":""}));if(t.match(JT))return s=Zi(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Lg(l,Math.pow(10,i)-1,!1),s=""+u,f=ol("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=Cg(o[2],i),f.length<a[4].length&&(f=qs(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Lg(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Bb(o[1],i)+a[2]+"/"+a[3]+Cg(o[2],i):fn(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:qs(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var h=t.indexOf(".")-i,p=t.length-s.length-h;return qs(t.substr(0,h)+s+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Zi(e,t,-r):lc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Ci(0,3-m.length):"")+m})+"."+Ci(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=lc(""+l);return d!=="0"?u+d:"";default:if(t.match(/\.[0#?]*$/))return Zi(e,t.slice(0,t.lastIndexOf(".")),r)+qs(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ol(e,t,r){return(r|0)===r?Zi(e,t,r):Wa(e,t,r)}function kz(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var ZT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ud(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Pg(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(ZT))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function _z(e,t,r,n){for(var s=[],a="",i=0,o="",l="t",u,f,h,p="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Pg(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(h=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(h);s[s.length]={t:"t",v:a},++i;break;case"\\":var d=e.charAt(++i),m=d==="("||d===")"?d:"t";s[s.length]={t:m,v:d},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=lu(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=lu(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=lu(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",i+=5,p="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",i+=5,p="h"):(g.t="t",++i),u==null&&g.t==="T")return"";s[s.length]=g,l=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(ZT)){if(u==null&&(u=lu(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ud(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,x=0,y;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=p,l="h",w<1&&(w=1);break;case"s":(y=s[i].v.match(/\.0+$/))&&(x=Math.max(x,y[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var b="",S;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=mz(s[i].t.charCodeAt(0),s[i].v,u,x),s[i].t="t";break;case"n":case"?":for(S=i+1;s[S]!=null&&((o=s[S].t)==="?"||o==="D"||(o===" "||o==="t")&&s[S+1]!=null&&(s[S+1].t==="?"||s[S+1].t==="t"&&s[S+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[S].v==="/"||s[S].v===" "&&s[S+1]!=null&&s[S+1].t=="?"));)s[i].v+=s[S].v,s[S]={v:"",t:";"},++S;b+=s[i].v,i=S-1;break;case"G":s[i].t="t",s[i].v=Ru(t,r);break}var T="",L,A;if(b.length>0){b.charCodeAt(0)==40?(L=t<0&&b.charCodeAt(0)===45?-t:t,A=ol("n",b,L)):(L=t<0&&n>1?-t:t,A=ol("n",b,L),L<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),S=A.length-1;var D=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){D=i;break}var C=s.length;if(D===s.length&&A.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(S>=s[i].v.length-1?(S-=s[i].v.length,s[i].v=A.substr(S+1,s[i].v.length)):S<0?s[i].v="":(s[i].v=A.substr(0,S+1),S=-1),s[i].t="t",C=i);S>=0&&C<s.length&&(s[C].v=A.substr(0,S+1)+s[C].v)}else if(D!==s.length&&A.indexOf("E")===-1){for(S=A.indexOf(".")-1,i=D;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===D?s[i].v.indexOf(".")-1:s[i].v.length-1,T=s[i].v.substr(f+1);f>=0;--f)S>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(T=A.charAt(S--)+T);s[i].v=T,s[i].t="t",C=i}for(S>=0&&C<s.length&&(s[C].v=A.substr(0,S+1)+s[C].v),S=A.indexOf(".")+1,i=D;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==D)){for(f=s[i].v.indexOf(".")>-1&&i===D?s[i].v.indexOf(".")+1:0,T=s[i].v.substr(0,f);f<s[i].v.length;++f)S<A.length&&(T+=A.charAt(S++));s[i].v=T,s[i].t="t",C=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(L=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=ol(s[i].t,s[i].v,L),s[i].t="t");var O="";for(i=0;i!==s.length;++i)s[i]!=null&&(O+=s[i].v);return O}var BS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function US(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function Ez(e,t){var r=kz(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(BS),o=r[1].match(BS);return US(t,i)?[n,r[0]]:US(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function ni(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:er)[e],n==null&&(n=r.table&&r.table[OS[e]]||er[OS[e]]),n==null&&(n=lz[e]||"General");break}if(Pg(n,0))return Ru(t,r);t instanceof Date&&(t=WT(t,r.date1904));var s=Ez(n,t);if(Pg(s[1]))return Ru(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return _z(s[1],t,r,s[0])}function Su(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(er[r]==null){t<0&&(t=r);continue}if(er[r]==e){t=r;break}}t<0&&(t=391)}return er[t]=e,t}function eC(){er=oz()}var Az={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},tC=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function jz(e){var t=typeof e=="number"?er[e]:e;return t=t.replace(tC,"(\\d+)"),new RegExp("^"+t+"$")}function Tz(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(t.match(tC)||[]).forEach(function(h,p){var d=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":i=d;break;case"s":l=d;break;case"m":i>=0?o=d:s=d;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?f:u+"T"+f}var Cz=function(){var e={};e.version="1.2.0";function t(){for(var A=0,D=new Array(256),C=0;C!=256;++C)A=C,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,D[C]=A;return typeof Int32Array<"u"?new Int32Array(D):D}var r=t();function n(A){var D=0,C=0,O=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)E[O]=A[O];for(O=0;O!=256;++O)for(C=A[O],D=256+O;D<4096;D+=256)C=E[D]=C>>>8^A[C&255];var P=[];for(O=1;O!=16;++O)P[O-1]=typeof Int32Array<"u"?E.subarray(O*256,O*256+256):E.slice(O*256,O*256+256);return P}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],f=s[5],h=s[6],p=s[7],d=s[8],m=s[9],g=s[10],w=s[11],x=s[12],y=s[13],b=s[14];function S(A,D){for(var C=D^-1,O=0,E=A.length;O<E;)C=C>>>8^r[(C^A.charCodeAt(O++))&255];return~C}function T(A,D){for(var C=D^-1,O=A.length-15,E=0;E<O;)C=b[A[E++]^C&255]^y[A[E++]^C>>8&255]^x[A[E++]^C>>16&255]^w[A[E++]^C>>>24]^g[A[E++]]^m[A[E++]]^d[A[E++]]^p[A[E++]]^h[A[E++]]^f[A[E++]]^u[A[E++]]^l[A[E++]]^o[A[E++]]^i[A[E++]]^a[A[E++]]^r[A[E++]];for(O+=15;E<O;)C=C>>>8^r[(C^A[E++])&255];return~C}function L(A,D){for(var C=D^-1,O=0,E=A.length,P=0,q=0;O<E;)P=A.charCodeAt(O++),P<128?C=C>>>8^r[(C^P)&255]:P<2048?(C=C>>>8^r[(C^(192|P>>6&31))&255],C=C>>>8^r[(C^(128|P&63))&255]):P>=55296&&P<57344?(P=(P&1023)+64,q=A.charCodeAt(O++)&1023,C=C>>>8^r[(C^(240|P>>8&7))&255],C=C>>>8^r[(C^(128|P>>2&63))&255],C=C>>>8^r[(C^(128|q>>6&15|(P&3)<<4))&255],C=C>>>8^r[(C^(128|q&63))&255]):(C=C>>>8^r[(C^(224|P>>12&15))&255],C=C>>>8^r[(C^(128|P>>6&63))&255],C=C>>>8^r[(C^(128|P&63))&255]);return~C}return e.table=r,e.bstr=S,e.buf=T,e.str=L,e}(),hr=function(){var t={};t.version="1.2.1";function r(H,ae){for(var Q=H.split("/"),te=ae.split("/"),le=0,ue=0,ke=Math.min(Q.length,te.length);le<ke;++le){if(ue=Q[le].length-te[le].length)return ue;if(Q[le]!=te[le])return Q[le]<te[le]?-1:1}return Q.length-te.length}function n(H){if(H.charAt(H.length-1)=="/")return H.slice(0,-1).indexOf("/")===-1?H:n(H.slice(0,-1));var ae=H.lastIndexOf("/");return ae===-1?H:H.slice(0,ae+1)}function s(H){if(H.charAt(H.length-1)=="/")return s(H.slice(0,-1));var ae=H.lastIndexOf("/");return ae===-1?H:H.slice(ae+1)}function a(H,ae){typeof ae=="string"&&(ae=new Date(ae));var Q=ae.getHours();Q=Q<<6|ae.getMinutes(),Q=Q<<5|ae.getSeconds()>>>1,H.write_shift(2,Q);var te=ae.getFullYear()-1980;te=te<<4|ae.getMonth()+1,te=te<<5|ae.getDate(),H.write_shift(2,te)}function i(H){var ae=H.read_shift(2)&65535,Q=H.read_shift(2)&65535,te=new Date,le=Q&31;Q>>>=5;var ue=Q&15;Q>>>=4,te.setMilliseconds(0),te.setFullYear(Q+1980),te.setMonth(ue-1),te.setDate(le);var ke=ae&31;ae>>>=5;var Oe=ae&63;return ae>>>=6,te.setHours(ae),te.setMinutes(Oe),te.setSeconds(ke<<1),te}function o(H){cs(H,0);for(var ae={},Q=0;H.l<=H.length-4;){var te=H.read_shift(2),le=H.read_shift(2),ue=H.l+le,ke={};switch(te){case 21589:Q=H.read_shift(1),Q&1&&(ke.mtime=H.read_shift(4)),le>5&&(Q&2&&(ke.atime=H.read_shift(4)),Q&4&&(ke.ctime=H.read_shift(4))),ke.mtime&&(ke.mt=new Date(ke.mtime*1e3));break}H.l=ue,ae[te]=ke}return ae}var l;function u(){return l||(l={})}function f(H,ae){if(H[0]==80&&H[1]==75)return Pe(H,ae);if((H[0]|32)==109&&(H[1]|32)==105)return ut(H,ae);if(H.length<512)throw new Error("CFB file size "+H.length+" < 512");var Q=3,te=512,le=0,ue=0,ke=0,Oe=0,_e=0,Ee=[],Ce=H.slice(0,512);cs(Ce,0);var Ze=h(Ce);switch(Q=Ze[0],Q){case 3:te=512;break;case 4:te=4096;break;case 0:if(Ze[1]==0)return Pe(H,ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+Q)}te!==512&&(Ce=H.slice(0,te),cs(Ce,28));var st=H.slice(0,te);p(Ce,Q);var ft=Ce.read_shift(4,"i");if(Q===3&&ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ft);Ce.l+=4,ke=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),Oe=Ce.read_shift(4,"i"),le=Ce.read_shift(4,"i"),_e=Ce.read_shift(4,"i"),ue=Ce.read_shift(4,"i");for(var rt=-1,lt=0;lt<109&&(rt=Ce.read_shift(4,"i"),!(rt<0));++lt)Ee[lt]=rt;var Bt=d(H,te);w(_e,ue,Bt,te,Ee);var Ar=y(Bt,ke,Ee,te);Ar[ke].name="!Directory",le>0&&Oe!==q&&(Ar[Oe].name="!MiniFAT"),Ar[Ee[0]].name="!FAT",Ar.fat_addrs=Ee,Ar.ssz=te;var ir={},sn=[],$i=[],ii=[];b(ke,Ar,Bt,sn,le,ir,$i,Oe),m($i,ii,sn),sn.shift();var zi={FileIndex:$i,FullPaths:ii};return ae&&ae.raw&&(zi.raw={header:st,sectors:Bt}),zi}function h(H){if(H[H.l]==80&&H[H.l+1]==75)return[0,0];H.chk(M,"Header Signature: "),H.l+=16;var ae=H.read_shift(2,"u");return[H.read_shift(2,"u"),ae]}function p(H,ae){var Q=9;switch(H.l+=2,Q=H.read_shift(2)){case 9:if(ae!=3)throw new Error("Sector Shift: Expected 9 saw "+Q);break;case 12:if(ae!=4)throw new Error("Sector Shift: Expected 12 saw "+Q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Q)}H.chk("0600","Mini Sector Shift: "),H.chk("000000000000","Reserved: ")}function d(H,ae){for(var Q=Math.ceil(H.length/ae)-1,te=[],le=1;le<Q;++le)te[le-1]=H.slice(le*ae,(le+1)*ae);return te[Q-1]=H.slice(Q*ae),te}function m(H,ae,Q){for(var te=0,le=0,ue=0,ke=0,Oe=0,_e=Q.length,Ee=[],Ce=[];te<_e;++te)Ee[te]=Ce[te]=te,ae[te]=Q[te];for(;Oe<Ce.length;++Oe)te=Ce[Oe],le=H[te].L,ue=H[te].R,ke=H[te].C,Ee[te]===te&&(le!==-1&&Ee[le]!==le&&(Ee[te]=Ee[le]),ue!==-1&&Ee[ue]!==ue&&(Ee[te]=Ee[ue])),ke!==-1&&(Ee[ke]=te),le!==-1&&te!=Ee[te]&&(Ee[le]=Ee[te],Ce.lastIndexOf(le)<Oe&&Ce.push(le)),ue!==-1&&te!=Ee[te]&&(Ee[ue]=Ee[te],Ce.lastIndexOf(ue)<Oe&&Ce.push(ue));for(te=1;te<_e;++te)Ee[te]===te&&(ue!==-1&&Ee[ue]!==ue?Ee[te]=Ee[ue]:le!==-1&&Ee[le]!==le&&(Ee[te]=Ee[le]));for(te=1;te<_e;++te)if(H[te].type!==0){if(Oe=te,Oe!=Ee[Oe])do Oe=Ee[Oe],ae[te]=ae[Oe]+"/"+ae[te];while(Oe!==0&&Ee[Oe]!==-1&&Oe!=Ee[Oe]);Ee[te]=-1}for(ae[0]+="/",te=1;te<_e;++te)H[te].type!==2&&(ae[te]+="/")}function g(H,ae,Q){for(var te=H.start,le=H.size,ue=[],ke=te;Q&&le>0&&ke>=0;)ue.push(ae.slice(ke*P,ke*P+P)),le-=P,ke=tu(Q,ke*4);return ue.length===0?zn(0):Xl(ue).slice(0,H.size)}function w(H,ae,Q,te,le){var ue=q;if(H===q){if(ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(H!==-1){var ke=Q[H],Oe=(te>>>2)-1;if(!ke)return;for(var _e=0;_e<Oe&&(ue=tu(ke,_e*4))!==q;++_e)le.push(ue);w(tu(ke,te-4),ae-1,Q,te,le)}}function x(H,ae,Q,te,le){var ue=[],ke=[];le||(le=[]);var Oe=te-1,_e=0,Ee=0;for(_e=ae;_e>=0;){le[_e]=!0,ue[ue.length]=_e,ke.push(H[_e]);var Ce=Q[Math.floor(_e*4/te)];if(Ee=_e*4&Oe,te<4+Ee)throw new Error("FAT boundary crossed: "+_e+" 4 "+te);if(!H[Ce])break;_e=tu(H[Ce],Ee)}return{nodes:ue,data:XS([ke])}}function y(H,ae,Q,te){var le=H.length,ue=[],ke=[],Oe=[],_e=[],Ee=te-1,Ce=0,Ze=0,st=0,ft=0;for(Ce=0;Ce<le;++Ce)if(Oe=[],st=Ce+ae,st>=le&&(st-=le),!ke[st]){_e=[];var rt=[];for(Ze=st;Ze>=0;){rt[Ze]=!0,ke[Ze]=!0,Oe[Oe.length]=Ze,_e.push(H[Ze]);var lt=Q[Math.floor(Ze*4/te)];if(ft=Ze*4&Ee,te<4+ft)throw new Error("FAT boundary crossed: "+Ze+" 4 "+te);if(!H[lt]||(Ze=tu(H[lt],ft),rt[Ze]))break}ue[st]={nodes:Oe,data:XS([_e])}}return ue}function b(H,ae,Q,te,le,ue,ke,Oe){for(var _e=0,Ee=te.length?2:0,Ce=ae[H].data,Ze=0,st=0,ft;Ze<Ce.length;Ze+=128){var rt=Ce.slice(Ze,Ze+128);cs(rt,64),st=rt.read_shift(2),ft=Wb(rt,0,st-Ee),te.push(ft);var lt={name:ft,type:rt.read_shift(1),color:rt.read_shift(1),L:rt.read_shift(4,"i"),R:rt.read_shift(4,"i"),C:rt.read_shift(4,"i"),clsid:rt.read_shift(16),state:rt.read_shift(4,"i"),start:0,size:0},Bt=rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2);Bt!==0&&(lt.ct=S(rt,rt.l-8));var Ar=rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2)+rt.read_shift(2);Ar!==0&&(lt.mt=S(rt,rt.l-8)),lt.start=rt.read_shift(4,"i"),lt.size=rt.read_shift(4,"i"),lt.size<0&&lt.start<0&&(lt.size=lt.type=0,lt.start=q,lt.name=""),lt.type===5?(_e=lt.start,le>0&&_e!==q&&(ae[_e].name="!StreamData")):lt.size>=4096?(lt.storage="fat",ae[lt.start]===void 0&&(ae[lt.start]=x(Q,lt.start,ae.fat_addrs,ae.ssz)),ae[lt.start].name=lt.name,lt.content=ae[lt.start].data.slice(0,lt.size)):(lt.storage="minifat",lt.size<0?lt.size=0:_e!==q&&lt.start!==q&&ae[_e]&&(lt.content=g(lt,ae[_e].data,(ae[Oe]||{}).data))),lt.content&&cs(lt.content,0),ue[ft]=lt,ke.push(lt)}}function S(H,ae){return new Date((ja(H,ae+4)/1e7*Math.pow(2,32)+ja(H,ae)/1e7-11644473600)*1e3)}function T(H,ae){return u(),f(l.readFileSync(H),ae)}function L(H,ae){var Q=ae&&ae.type;switch(Q||ur&&Buffer.isBuffer(H)&&(Q="buffer"),Q||"base64"){case"file":return T(H,ae);case"base64":return f(Ai(Ra(H)),ae);case"binary":return f(Ai(H),ae)}return f(H,ae)}function A(H,ae){var Q=ae||{},te=Q.root||"Root Entry";if(H.FullPaths||(H.FullPaths=[]),H.FileIndex||(H.FileIndex=[]),H.FullPaths.length!==H.FileIndex.length)throw new Error("inconsistent CFB structure");H.FullPaths.length===0&&(H.FullPaths[0]=te+"/",H.FileIndex[0]={name:te,type:5}),Q.CLSID&&(H.FileIndex[0].clsid=Q.CLSID),D(H)}function D(H){var ae="Sh33tJ5";if(!hr.find(H,"/"+ae)){var Q=zn(4);Q[0]=55,Q[1]=Q[3]=50,Q[2]=54,H.FileIndex.push({name:ae,type:2,content:Q,size:4,L:69,R:69,C:69}),H.FullPaths.push(H.FullPaths[0]+ae),C(H)}}function C(H,ae){A(H);for(var Q=!1,te=!1,le=H.FullPaths.length-1;le>=0;--le){var ue=H.FileIndex[le];switch(ue.type){case 0:te?Q=!0:(H.FileIndex.pop(),H.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(ue.R*ue.L*ue.C)&&(Q=!0),ue.R>-1&&ue.L>-1&&ue.R==ue.L&&(Q=!0);break;default:Q=!0;break}}if(!(!Q&&!ae)){var ke=new Date(1987,1,19),Oe=0,_e=Object.create?Object.create(null):{},Ee=[];for(le=0;le<H.FullPaths.length;++le)_e[H.FullPaths[le]]=!0,H.FileIndex[le].type!==0&&Ee.push([H.FullPaths[le],H.FileIndex[le]]);for(le=0;le<Ee.length;++le){var Ce=n(Ee[le][0]);te=_e[Ce],te||(Ee.push([Ce,{name:s(Ce).replace("/",""),type:1,clsid:fe,ct:ke,mt:ke,content:null}]),_e[Ce]=!0)}for(Ee.sort(function(ft,rt){return r(ft[0],rt[0])}),H.FullPaths=[],H.FileIndex=[],le=0;le<Ee.length;++le)H.FullPaths[le]=Ee[le][0],H.FileIndex[le]=Ee[le][1];for(le=0;le<Ee.length;++le){var Ze=H.FileIndex[le],st=H.FullPaths[le];if(Ze.name=s(st).replace("/",""),Ze.L=Ze.R=Ze.C=-(Ze.color=1),Ze.size=Ze.content?Ze.content.length:0,Ze.start=0,Ze.clsid=Ze.clsid||fe,le===0)Ze.C=Ee.length>1?1:-1,Ze.size=0,Ze.type=5;else if(st.slice(-1)=="/"){for(Oe=le+1;Oe<Ee.length&&n(H.FullPaths[Oe])!=st;++Oe);for(Ze.C=Oe>=Ee.length?-1:Oe,Oe=le+1;Oe<Ee.length&&n(H.FullPaths[Oe])!=n(st);++Oe);Ze.R=Oe>=Ee.length?-1:Oe,Ze.type=1}else n(H.FullPaths[le+1]||"")==n(st)&&(Ze.R=le+1),Ze.type=2}}}function O(H,ae){var Q=ae||{};if(Q.fileType=="mad")return gs(H,Q);switch(C(H),Q.fileType){case"zip":return Qe(H,Q)}var te=function(ft){for(var rt=0,lt=0,Bt=0;Bt<ft.FileIndex.length;++Bt){var Ar=ft.FileIndex[Bt];if(Ar.content){var ir=Ar.content.length;ir>0&&(ir<4096?rt+=ir+63>>6:lt+=ir+511>>9)}}for(var sn=ft.FullPaths.length+3>>2,$i=rt+7>>3,ii=rt+127>>7,zi=$i+lt+sn+ii,Ma=zi+127>>7,wl=Ma<=109?0:Math.ceil((Ma-109)/127);zi+Ma+wl+127>>7>Ma;)wl=++Ma<=109?0:Math.ceil((Ma-109)/127);var _n=[1,wl,Ma,ii,sn,lt,rt,0];return ft.FileIndex[0].size=rt<<6,_n[7]=(ft.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n}(H),le=zn(te[7]<<9),ue=0,ke=0;{for(ue=0;ue<8;++ue)le.write_shift(1,ne[ue]);for(ue=0;ue<8;++ue)le.write_shift(2,0);for(le.write_shift(2,62),le.write_shift(2,3),le.write_shift(2,65534),le.write_shift(2,9),le.write_shift(2,6),ue=0;ue<3;++ue)le.write_shift(2,0);for(le.write_shift(4,0),le.write_shift(4,te[2]),le.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),le.write_shift(4,0),le.write_shift(4,4096),le.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:q),le.write_shift(4,te[3]),le.write_shift(-4,te[1]?te[0]-1:q),le.write_shift(4,te[1]),ue=0;ue<109;++ue)le.write_shift(-4,ue<te[2]?te[1]+ue:-1)}if(te[1])for(ke=0;ke<te[1];++ke){for(;ue<236+ke*127;++ue)le.write_shift(-4,ue<te[2]?te[1]+ue:-1);le.write_shift(-4,ke===te[1]-1?q:ke+1)}var Oe=function(ft){for(ke+=ft;ue<ke-1;++ue)le.write_shift(-4,ue+1);ft&&(++ue,le.write_shift(-4,q))};for(ke=ue=0,ke+=te[1];ue<ke;++ue)le.write_shift(-4,me.DIFSECT);for(ke+=te[2];ue<ke;++ue)le.write_shift(-4,me.FATSECT);Oe(te[3]),Oe(te[4]);for(var _e=0,Ee=0,Ce=H.FileIndex[0];_e<H.FileIndex.length;++_e)Ce=H.FileIndex[_e],Ce.content&&(Ee=Ce.content.length,!(Ee<4096)&&(Ce.start=ke,Oe(Ee+511>>9)));for(Oe(te[6]+7>>3);le.l&511;)le.write_shift(-4,me.ENDOFCHAIN);for(ke=ue=0,_e=0;_e<H.FileIndex.length;++_e)Ce=H.FileIndex[_e],Ce.content&&(Ee=Ce.content.length,!(!Ee||Ee>=4096)&&(Ce.start=ke,Oe(Ee+63>>6)));for(;le.l&511;)le.write_shift(-4,me.ENDOFCHAIN);for(ue=0;ue<te[4]<<2;++ue){var Ze=H.FullPaths[ue];if(!Ze||Ze.length===0){for(_e=0;_e<17;++_e)le.write_shift(4,0);for(_e=0;_e<3;++_e)le.write_shift(4,-1);for(_e=0;_e<12;++_e)le.write_shift(4,0);continue}Ce=H.FileIndex[ue],ue===0&&(Ce.start=Ce.size?Ce.start-1:q);var st=ue===0&&Q.root||Ce.name;if(Ee=2*(st.length+1),le.write_shift(64,st,"utf16le"),le.write_shift(2,Ee),le.write_shift(1,Ce.type),le.write_shift(1,Ce.color),le.write_shift(-4,Ce.L),le.write_shift(-4,Ce.R),le.write_shift(-4,Ce.C),Ce.clsid)le.write_shift(16,Ce.clsid,"hex");else for(_e=0;_e<4;++_e)le.write_shift(4,0);le.write_shift(4,Ce.state||0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,0),le.write_shift(4,Ce.start),le.write_shift(4,Ce.size),le.write_shift(4,0)}for(ue=1;ue<H.FileIndex.length;++ue)if(Ce=H.FileIndex[ue],Ce.size>=4096)if(le.l=Ce.start+1<<9,ur&&Buffer.isBuffer(Ce.content))Ce.content.copy(le,le.l,0,Ce.size),le.l+=Ce.size+511&-512;else{for(_e=0;_e<Ce.size;++_e)le.write_shift(1,Ce.content[_e]);for(;_e&511;++_e)le.write_shift(1,0)}for(ue=1;ue<H.FileIndex.length;++ue)if(Ce=H.FileIndex[ue],Ce.size>0&&Ce.size<4096)if(ur&&Buffer.isBuffer(Ce.content))Ce.content.copy(le,le.l,0,Ce.size),le.l+=Ce.size+63&-64;else{for(_e=0;_e<Ce.size;++_e)le.write_shift(1,Ce.content[_e]);for(;_e&63;++_e)le.write_shift(1,0)}if(ur)le.l=le.length;else for(;le.l<le.length;)le.write_shift(1,0);return le}function E(H,ae){var Q=H.FullPaths.map(function(_e){return _e.toUpperCase()}),te=Q.map(function(_e){var Ee=_e.split("/");return Ee[Ee.length-(_e.slice(-1)=="/"?2:1)]}),le=!1;ae.charCodeAt(0)===47?(le=!0,ae=Q[0].slice(0,-1)+ae):le=ae.indexOf("/")!==-1;var ue=ae.toUpperCase(),ke=le===!0?Q.indexOf(ue):te.indexOf(ue);if(ke!==-1)return H.FileIndex[ke];var Oe=!ue.match(zh);for(ue=ue.replace(Qs,""),Oe&&(ue=ue.replace(zh,"!")),ke=0;ke<Q.length;++ke)if((Oe?Q[ke].replace(zh,"!"):Q[ke]).replace(Qs,"")==ue||(Oe?te[ke].replace(zh,"!"):te[ke]).replace(Qs,"")==ue)return H.FileIndex[ke];return null}var P=64,q=-2,M="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],fe="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:q,FREESECT:-1,HEADER_SIGNATURE:M,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:fe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function re(H,ae,Q){u();var te=O(H,Q);l.writeFileSync(ae,te)}function G(H){for(var ae=new Array(H.length),Q=0;Q<H.length;++Q)ae[Q]=String.fromCharCode(H[Q]);return ae.join("")}function ge(H,ae){var Q=O(H,ae);switch(ae&&ae.type||"buffer"){case"file":return u(),l.writeFileSync(ae.filename,Q),Q;case"binary":return typeof Q=="string"?Q:G(Q);case"base64":return LS(typeof Q=="string"?Q:G(Q));case"buffer":if(ur)return Buffer.isBuffer(Q)?Q:qu(Q);case"array":return typeof Q=="string"?Ai(Q):Q}return Q}var ve;function _(H){try{var ae=H.InflateRaw,Q=new ae;if(Q._processChunk(new Uint8Array([3,0]),Q._finishFlushFlag),Q.bytesRead)ve=H;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function R(H,ae){if(!ve)return Ge(H,ae);var Q=ve.InflateRaw,te=new Q,le=te._processChunk(H.slice(H.l),te._finishFlushFlag);return H.l+=te.bytesRead,le}function I(H){return ve?ve.deflateRawSync(H):nt(H)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function pe(H){var ae=(H<<1|H<<11)&139536|(H<<5|H<<15)&558144;return(ae>>16|ae>>8|ae)&255}for(var he=typeof Uint8Array<"u",de=he?new Uint8Array(256):[],je=0;je<256;++je)de[je]=pe(je);function Y(H,ae){var Q=de[H&255];return ae<=8?Q>>>8-ae:(Q=Q<<8|de[H>>8&255],ae<=16?Q>>>16-ae:(Q=Q<<8|de[H>>16&255],Q>>>24-ae))}function We(H,ae){var Q=ae&7,te=ae>>>3;return(H[te]|(Q<=6?0:H[te+1]<<8))>>>Q&3}function Ke(H,ae){var Q=ae&7,te=ae>>>3;return(H[te]|(Q<=5?0:H[te+1]<<8))>>>Q&7}function J(H,ae){var Q=ae&7,te=ae>>>3;return(H[te]|(Q<=4?0:H[te+1]<<8))>>>Q&15}function ze(H,ae){var Q=ae&7,te=ae>>>3;return(H[te]|(Q<=3?0:H[te+1]<<8))>>>Q&31}function He(H,ae){var Q=ae&7,te=ae>>>3;return(H[te]|(Q<=1?0:H[te+1]<<8))>>>Q&127}function it(H,ae,Q){var te=ae&7,le=ae>>>3,ue=(1<<Q)-1,ke=H[le]>>>te;return Q<8-te||(ke|=H[le+1]<<8-te,Q<16-te)||(ke|=H[le+2]<<16-te,Q<24-te)||(ke|=H[le+3]<<24-te),ke&ue}function qe(H,ae,Q){var te=ae&7,le=ae>>>3;return te<=5?H[le]|=(Q&7)<<te:(H[le]|=Q<<te&255,H[le+1]=(Q&7)>>8-te),ae+3}function ht(H,ae,Q){var te=ae&7,le=ae>>>3;return Q=(Q&1)<<te,H[le]|=Q,ae+1}function ct(H,ae,Q){var te=ae&7,le=ae>>>3;return Q<<=te,H[le]|=Q&255,Q>>>=8,H[le+1]=Q,ae+8}function Et(H,ae,Q){var te=ae&7,le=ae>>>3;return Q<<=te,H[le]|=Q&255,Q>>>=8,H[le+1]=Q&255,H[le+2]=Q>>>8,ae+16}function xt(H,ae){var Q=H.length,te=2*Q>ae?2*Q:ae+5,le=0;if(Q>=ae)return H;if(ur){var ue=FS(te);if(H.copy)H.copy(ue);else for(;le<H.length;++le)ue[le]=H[le];return ue}else if(he){var ke=new Uint8Array(te);if(ke.set)ke.set(H);else for(;le<Q;++le)ke[le]=H[le];return ke}return H.length=te,H}function Ht(H){for(var ae=new Array(H),Q=0;Q<H;++Q)ae[Q]=0;return ae}function Mt(H,ae,Q){var te=1,le=0,ue=0,ke=0,Oe=0,_e=H.length,Ee=he?new Uint16Array(32):Ht(32);for(ue=0;ue<32;++ue)Ee[ue]=0;for(ue=_e;ue<Q;++ue)H[ue]=0;_e=H.length;var Ce=he?new Uint16Array(_e):Ht(_e);for(ue=0;ue<_e;++ue)Ee[le=H[ue]]++,te<le&&(te=le),Ce[ue]=0;for(Ee[0]=0,ue=1;ue<=te;++ue)Ee[ue+16]=Oe=Oe+Ee[ue-1]<<1;for(ue=0;ue<_e;++ue)Oe=H[ue],Oe!=0&&(Ce[ue]=Ee[Oe+16]++);var Ze=0;for(ue=0;ue<_e;++ue)if(Ze=H[ue],Ze!=0)for(Oe=Y(Ce[ue],te)>>te-Ze,ke=(1<<te+4-Ze)-1;ke>=0;--ke)ae[Oe|ke<<Ze]=Ze&15|ue<<4;return te}var Ft=he?new Uint16Array(512):Ht(512),Yt=he?new Uint16Array(32):Ht(32);if(!he){for(var Lt=0;Lt<512;++Lt)Ft[Lt]=0;for(Lt=0;Lt<32;++Lt)Yt[Lt]=0}(function(){for(var H=[],ae=0;ae<32;ae++)H.push(5);Mt(H,Yt,32);var Q=[];for(ae=0;ae<=143;ae++)Q.push(8);for(;ae<=255;ae++)Q.push(9);for(;ae<=279;ae++)Q.push(7);for(;ae<=287;ae++)Q.push(8);Mt(Q,Ft,288)})();var pt=function(){for(var ae=he?new Uint8Array(32768):[],Q=0,te=0;Q<se.length-1;++Q)for(;te<se[Q+1];++te)ae[te]=Q;for(;te<32768;++te)ae[te]=29;var le=he?new Uint8Array(259):[];for(Q=0,te=0;Q<W.length-1;++Q)for(;te<W[Q+1];++te)le[te]=Q;function ue(Oe,_e){for(var Ee=0;Ee<Oe.length;){var Ce=Math.min(65535,Oe.length-Ee),Ze=Ee+Ce==Oe.length;for(_e.write_shift(1,+Ze),_e.write_shift(2,Ce),_e.write_shift(2,~Ce&65535);Ce-- >0;)_e[_e.l++]=Oe[Ee++]}return _e.l}function ke(Oe,_e){for(var Ee=0,Ce=0,Ze=he?new Uint16Array(32768):[];Ce<Oe.length;){var st=Math.min(65535,Oe.length-Ce);if(st<10){for(Ee=qe(_e,Ee,+(Ce+st==Oe.length)),Ee&7&&(Ee+=8-(Ee&7)),_e.l=Ee/8|0,_e.write_shift(2,st),_e.write_shift(2,~st&65535);st-- >0;)_e[_e.l++]=Oe[Ce++];Ee=_e.l*8;continue}Ee=qe(_e,Ee,+(Ce+st==Oe.length)+2);for(var ft=0;st-- >0;){var rt=Oe[Ce];ft=(ft<<5^rt)&32767;var lt=-1,Bt=0;if((lt=Ze[ft])&&(lt|=Ce&-32768,lt>Ce&&(lt-=32768),lt<Ce))for(;Oe[lt+Bt]==Oe[Ce+Bt]&&Bt<250;)++Bt;if(Bt>2){rt=le[Bt],rt<=22?Ee=ct(_e,Ee,de[rt+1]>>1)-1:(ct(_e,Ee,3),Ee+=5,ct(_e,Ee,de[rt-23]>>5),Ee+=3);var Ar=rt<8?0:rt-4>>2;Ar>0&&(Et(_e,Ee,Bt-W[rt]),Ee+=Ar),rt=ae[Ce-lt],Ee=ct(_e,Ee,de[rt]>>3),Ee-=3;var ir=rt<4?0:rt-2>>1;ir>0&&(Et(_e,Ee,Ce-lt-se[rt]),Ee+=ir);for(var sn=0;sn<Bt;++sn)Ze[ft]=Ce&32767,ft=(ft<<5^Oe[Ce])&32767,++Ce;st-=Bt-1}else rt<=143?rt=rt+48:Ee=ht(_e,Ee,1),Ee=ct(_e,Ee,de[rt]),Ze[ft]=Ce&32767,++Ce}Ee=ct(_e,Ee,0)-1}return _e.l=(Ee+7)/8|0,_e.l}return function(_e,Ee){return _e.length<8?ue(_e,Ee):ke(_e,Ee)}}();function nt(H){var ae=zn(50+Math.floor(H.length*1.1)),Q=pt(H,ae);return ae.slice(0,Q)}var at=he?new Uint16Array(32768):Ht(32768),ar=he?new Uint16Array(32768):Ht(32768),Ct=he?new Uint16Array(128):Ht(128),Ot=1,we=1;function Je(H,ae){var Q=ze(H,ae)+257;ae+=5;var te=ze(H,ae)+1;ae+=5;var le=J(H,ae)+4;ae+=4;for(var ue=0,ke=he?new Uint8Array(19):Ht(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Ee=he?new Uint8Array(8):Ht(8),Ce=he?new Uint8Array(8):Ht(8),Ze=ke.length,st=0;st<le;++st)ke[B[st]]=ue=Ke(H,ae),_e<ue&&(_e=ue),Ee[ue]++,ae+=3;var ft=0;for(Ee[0]=0,st=1;st<=_e;++st)Ce[st]=ft=ft+Ee[st-1]<<1;for(st=0;st<Ze;++st)(ft=ke[st])!=0&&(Oe[st]=Ce[ft]++);var rt=0;for(st=0;st<Ze;++st)if(rt=ke[st],rt!=0){ft=de[Oe[st]]>>8-rt;for(var lt=(1<<7-rt)-1;lt>=0;--lt)Ct[ft|lt<<rt]=rt&7|st<<3}var Bt=[];for(_e=1;Bt.length<Q+te;)switch(ft=Ct[He(H,ae)],ae+=ft&7,ft>>>=3){case 16:for(ue=3+We(H,ae),ae+=2,ft=Bt[Bt.length-1];ue-- >0;)Bt.push(ft);break;case 17:for(ue=3+Ke(H,ae),ae+=3;ue-- >0;)Bt.push(0);break;case 18:for(ue=11+He(H,ae),ae+=7;ue-- >0;)Bt.push(0);break;default:Bt.push(ft),_e<ft&&(_e=ft);break}var Ar=Bt.slice(0,Q),ir=Bt.slice(Q);for(st=Q;st<286;++st)Ar[st]=0;for(st=te;st<30;++st)ir[st]=0;return Ot=Mt(Ar,at,286),we=Mt(ir,ar,30),ae}function De(H,ae){if(H[0]==3&&!(H[1]&3))return[jc(ae),2];for(var Q=0,te=0,le=FS(ae||1<<18),ue=0,ke=le.length>>>0,Oe=0,_e=0;!(te&1);){if(te=Ke(H,Q),Q+=3,te>>>1)te>>1==1?(Oe=9,_e=5):(Q=Je(H,Q),Oe=Ot,_e=we);else{Q&7&&(Q+=8-(Q&7));var Ee=H[Q>>>3]|H[(Q>>>3)+1]<<8;if(Q+=32,Ee>0)for(!ae&&ke<ue+Ee&&(le=xt(le,ue+Ee),ke=le.length);Ee-- >0;)le[ue++]=H[Q>>>3],Q+=8;continue}for(;;){!ae&&ke<ue+32767&&(le=xt(le,ue+32767),ke=le.length);var Ce=it(H,Q,Oe),Ze=te>>>1==1?Ft[Ce]:at[Ce];if(Q+=Ze&15,Ze>>>=4,!(Ze>>>8&255))le[ue++]=Ze;else{if(Ze==256)break;Ze-=257;var st=Ze<8?0:Ze-4>>2;st>5&&(st=0);var ft=ue+W[Ze];st>0&&(ft+=it(H,Q,st),Q+=st),Ce=it(H,Q,_e),Ze=te>>>1==1?Yt[Ce]:ar[Ce],Q+=Ze&15,Ze>>>=4;var rt=Ze<4?0:Ze-2>>1,lt=se[Ze];for(rt>0&&(lt+=it(H,Q,rt),Q+=rt),!ae&&ke<ft&&(le=xt(le,ft+100),ke=le.length);ue<ft;)le[ue]=le[ue-lt],++ue}}}return ae?[le,Q+7>>>3]:[le.slice(0,ue),Q+7>>>3]}function Ge(H,ae){var Q=H.slice(H.l||0),te=De(Q,ae);return H.l+=te[1],te[0]}function Re(H,ae){if(H)typeof console<"u"&&console.error(ae);else throw new Error(ae)}function Pe(H,ae){var Q=H;cs(Q,0);var te=[],le=[],ue={FileIndex:te,FullPaths:le};A(ue,{root:ae.root});for(var ke=Q.length-4;(Q[ke]!=80||Q[ke+1]!=75||Q[ke+2]!=5||Q[ke+3]!=6)&&ke>=0;)--ke;Q.l=ke+4,Q.l+=4;var Oe=Q.read_shift(2);Q.l+=6;var _e=Q.read_shift(4);for(Q.l=_e,ke=0;ke<Oe;++ke){Q.l+=20;var Ee=Q.read_shift(4),Ce=Q.read_shift(4),Ze=Q.read_shift(2),st=Q.read_shift(2),ft=Q.read_shift(2);Q.l+=8;var rt=Q.read_shift(4),lt=o(Q.slice(Q.l+Ze,Q.l+Ze+st));Q.l+=Ze+st+ft;var Bt=Q.l;Q.l=rt+4,bt(Q,Ee,Ce,ue,lt),Q.l=Bt}return ue}function bt(H,ae,Q,te,le){H.l+=2;var ue=H.read_shift(2),ke=H.read_shift(2),Oe=i(H);if(ue&8257)throw new Error("Unsupported ZIP encryption");for(var _e=H.read_shift(4),Ee=H.read_shift(4),Ce=H.read_shift(4),Ze=H.read_shift(2),st=H.read_shift(2),ft="",rt=0;rt<Ze;++rt)ft+=String.fromCharCode(H[H.l++]);if(st){var lt=o(H.slice(H.l,H.l+st));(lt[21589]||{}).mt&&(Oe=lt[21589].mt),((le||{})[21589]||{}).mt&&(Oe=le[21589].mt)}H.l+=st;var Bt=H.slice(H.l,H.l+Ee);switch(ke){case 8:Bt=R(H,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ke)}var Ar=!1;ue&8&&(_e=H.read_shift(4),_e==134695760&&(_e=H.read_shift(4),Ar=!0),Ee=H.read_shift(4),Ce=H.read_shift(4)),Ee!=ae&&Re(Ar,"Bad compressed size: "+ae+" != "+Ee),Ce!=Q&&Re(Ar,"Bad uncompressed size: "+Q+" != "+Ce),Rr(te,ft,Bt,{unsafe:!0,mt:Oe})}function Qe(H,ae){var Q=ae||{},te=[],le=[],ue=zn(1),ke=Q.compression?8:0,Oe=0,_e=0,Ee=0,Ce=0,Ze=0,st=H.FullPaths[0],ft=st,rt=H.FileIndex[0],lt=[],Bt=0;for(_e=1;_e<H.FullPaths.length;++_e)if(ft=H.FullPaths[_e].slice(st.length),rt=H.FileIndex[_e],!(!rt.size||!rt.content||ft=="Sh33tJ5")){var Ar=Ce,ir=zn(ft.length);for(Ee=0;Ee<ft.length;++Ee)ir.write_shift(1,ft.charCodeAt(Ee)&127);ir=ir.slice(0,ir.l),lt[Ze]=Cz.buf(rt.content,0);var sn=rt.content;ke==8&&(sn=I(sn)),ue=zn(30),ue.write_shift(4,67324752),ue.write_shift(2,20),ue.write_shift(2,Oe),ue.write_shift(2,ke),rt.mt?a(ue,rt.mt):ue.write_shift(4,0),ue.write_shift(-4,lt[Ze]),ue.write_shift(4,sn.length),ue.write_shift(4,rt.content.length),ue.write_shift(2,ir.length),ue.write_shift(2,0),Ce+=ue.length,te.push(ue),Ce+=ir.length,te.push(ir),Ce+=sn.length,te.push(sn),ue=zn(46),ue.write_shift(4,33639248),ue.write_shift(2,0),ue.write_shift(2,20),ue.write_shift(2,Oe),ue.write_shift(2,ke),ue.write_shift(4,0),ue.write_shift(-4,lt[Ze]),ue.write_shift(4,sn.length),ue.write_shift(4,rt.content.length),ue.write_shift(2,ir.length),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(4,0),ue.write_shift(4,Ar),Bt+=ue.l,le.push(ue),Bt+=ir.length,le.push(ir),++Ze}return ue=zn(22),ue.write_shift(4,101010256),ue.write_shift(2,0),ue.write_shift(2,0),ue.write_shift(2,Ze),ue.write_shift(2,Ze),ue.write_shift(4,Bt),ue.write_shift(4,Ce),ue.write_shift(2,0),Xl([Xl(te),Xl(le),ue])}var Ve={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function yt(H,ae){if(H.ctype)return H.ctype;var Q=H.name||"",te=Q.match(/\.([^\.]+)$/);return te&&Ve[te[1]]||ae&&(te=(Q=ae).match(/[\.\\]([^\.\\])+$/),te&&Ve[te[1]])?Ve[te[1]]:"application/octet-stream"}function qt(H){for(var ae=LS(H),Q=[],te=0;te<ae.length;te+=76)Q.push(ae.slice(te,te+76));return Q.join(`\r
`)+`\r
`}function Tr(H){var ae=H.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Ce=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});ae=ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ae.charAt(0)==`
`&&(ae="=0D"+ae.slice(1)),ae=ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Q=[],te=ae.split(`\r
`),le=0;le<te.length;++le){var ue=te[le];if(ue.length==0){Q.push("");continue}for(var ke=0;ke<ue.length;){var Oe=76,_e=ue.slice(ke,ke+Oe);_e.charAt(Oe-1)=="="?Oe--:_e.charAt(Oe-2)=="="?Oe-=2:_e.charAt(Oe-3)=="="&&(Oe-=3),_e=ue.slice(ke,ke+Oe),ke+=Oe,ke<ue.length&&(_e+="="),Q.push(_e)}}return Q.join(`\r
`)}function wr(H){for(var ae=[],Q=0;Q<H.length;++Q){for(var te=H[Q];Q<=H.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+H[++Q];ae.push(te)}for(var le=0;le<ae.length;++le)ae[le]=ae[le].replace(/[=][0-9A-Fa-f]{2}/g,function(ue){return String.fromCharCode(parseInt(ue.slice(1),16))});return Ai(ae.join(`\r
`))}function Qr(H,ae,Q){for(var te="",le="",ue="",ke,Oe=0;Oe<10;++Oe){var _e=ae[Oe];if(!_e||_e.match(/^\s*$/))break;var Ee=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":te=Ee[2].trim();break;case"content-type":ue=Ee[2].trim();break;case"content-transfer-encoding":le=Ee[2].trim();break}}switch(++Oe,le.toLowerCase()){case"base64":ke=Ai(Ra(ae.slice(Oe).join("")));break;case"quoted-printable":ke=wr(ae.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+le)}var Ce=Rr(H,te.slice(Q.length),ke,{unsafe:!0});ue&&(Ce.ctype=ue)}function ut(H,ae){if(G(H.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Q=ae&&ae.root||"",te=(ur&&Buffer.isBuffer(H)?H.toString("binary"):G(H)).split(`\r
`),le=0,ue="";for(le=0;le<te.length;++le)if(ue=te[le],!!/^Content-Location:/i.test(ue)&&(ue=ue.slice(ue.indexOf("file")),Q||(Q=ue.slice(0,ue.lastIndexOf("/")+1)),ue.slice(0,Q.length)!=Q))for(;Q.length>0&&(Q=Q.slice(0,Q.length-1),Q=Q.slice(0,Q.lastIndexOf("/")+1),ue.slice(0,Q.length)!=Q););var ke=(te[1]||"").match(/boundary="(.*?)"/);if(!ke)throw new Error("MAD cannot find boundary");var Oe="--"+(ke[1]||""),_e=[],Ee=[],Ce={FileIndex:_e,FullPaths:Ee};A(Ce);var Ze,st=0;for(le=0;le<te.length;++le){var ft=te[le];ft!==Oe&&ft!==Oe+"--"||(st++&&Qr(Ce,te.slice(Ze,le),Q),Ze=le)}return Ce}function gs(H,ae){var Q=ae||{},te=Q.boundary||"SheetJS";te="------="+te;for(var le=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],ue=H.FullPaths[0],ke=ue,Oe=H.FileIndex[0],_e=1;_e<H.FullPaths.length;++_e)if(ke=H.FullPaths[_e].slice(ue.length),Oe=H.FileIndex[_e],!(!Oe.size||!Oe.content||ke=="Sh33tJ5")){ke=ke.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Bt){return"_x"+Bt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Bt){return"_u"+Bt.charCodeAt(0).toString(16)+"_"});for(var Ee=Oe.content,Ce=ur&&Buffer.isBuffer(Ee)?Ee.toString("binary"):G(Ee),Ze=0,st=Math.min(1024,Ce.length),ft=0,rt=0;rt<=st;++rt)(ft=Ce.charCodeAt(rt))>=32&&ft<128&&++Ze;var lt=Ze>=st*4/5;le.push(te),le.push("Content-Location: "+(Q.root||"file:///C:/SheetJS/")+ke),le.push("Content-Transfer-Encoding: "+(lt?"quoted-printable":"base64")),le.push("Content-Type: "+yt(Oe,ke)),le.push(""),le.push(lt?Tr(Ce):qt(Ce))}return le.push(te+`--\r
`),le.join(`\r
`)}function Vr(H){var ae={};return A(ae,H),ae}function Rr(H,ae,Q,te){var le=te&&te.unsafe;le||A(H);var ue=!le&&hr.find(H,ae);if(!ue){var ke=H.FullPaths[0];ae.slice(0,ke.length)==ke?ke=ae:(ke.slice(-1)!="/"&&(ke+="/"),ke=(ke+ae).replace("//","/")),ue={name:s(ae),type:2},H.FileIndex.push(ue),H.FullPaths.push(ke),le||hr.utils.cfb_gc(H)}return ue.content=Q,ue.size=Q?Q.length:0,te&&(te.CLSID&&(ue.clsid=te.CLSID),te.mt&&(ue.mt=te.mt),te.ct&&(ue.ct=te.ct)),ue}function Kr(H,ae){A(H);var Q=hr.find(H,ae);if(Q){for(var te=0;te<H.FileIndex.length;++te)if(H.FileIndex[te]==Q)return H.FileIndex.splice(te,1),H.FullPaths.splice(te,1),!0}return!1}function fr(H,ae,Q){A(H);var te=hr.find(H,ae);if(te){for(var le=0;le<H.FileIndex.length;++le)if(H.FileIndex[le]==te)return H.FileIndex[le].name=s(Q),H.FullPaths[le]=Q,!0}return!1}function St(H){C(H,!0)}return t.find=E,t.read=L,t.parse=f,t.write=ge,t.writeFile=re,t.utils={cfb_new:Vr,cfb_add:Rr,cfb_del:Kr,cfb_mov:fr,cfb_gc:St,ReadShift:i0,CheckField:SC,prep_blob:cs,bconcat:Xl,use_zlib:_,_deflateRaw:nt,_inflateRaw:Ge,consts:me},t}();function Pz(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function yo(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function $b(e){for(var t=[],r=yo(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Fg=new Date(1899,11,30,0,0,0);function ta(e,t){var r=e.getTime(),n=Fg.getTime()+(e.getTimezoneOffset()-Fg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var rC=new Date,Lz=Fg.getTime()+(rC.getTimezoneOffset()-Fg.getTimezoneOffset())*6e4,$S=rC.getTimezoneOffset();function Lx(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Lz),t.getTimezoneOffset()!==$S&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$S)*6e4),t}function Fz(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var zS=new Date("2017-02-19T19:06:09.000Z"),nC=isNaN(zS.getFullYear())?new Date("2/19/17"):zS,Dz=nC.getFullYear()==2017;function es(e,t){var r=new Date(e);if(Dz)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(nC.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ou(e,t){if(ur&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return qh(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return qh(HT(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return qh(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return qh(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function ds(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ds(e[r]));return t}function fn(e,t){for(var r="";r.length<t;)r+=e;return r}function Di(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Rz=["january","february","march","april","may","june","july","august","september","october","november","december"];function kd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Rz.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Oz=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function sC(e){return e?e.content&&e.type?Ou(e.content,!0):e.data?$h(e.data):e.asNodeBuffer&&ur?$h(e.asNodeBuffer().toString("binary")):e.asBinary?$h(e.asBinary()):e._data&&e._data.getContent?$h(Ou(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function aC(e){if(!e)return null;if(e.data)return CS(e.data);if(e.asNodeBuffer&&ur)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?CS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Iz(e){return e&&e.name.slice(-4)===".bin"?aC(e):sC(e)}function Va(e,t){for(var r=e.FullPaths||yo(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function zb(e,t){var r=Va(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Cn(e,t,r){if(!r)return Iz(zb(e,t));if(!t)return null;try{return Cn(e,t)}catch{return null}}function Ta(e,t,r){if(!r)return sC(zb(e,t));if(!t)return null;try{return Ta(e,t)}catch{return null}}function Mz(e,t,r){return aC(zb(e,t))}function HS(e){for(var t=e.FullPaths||yo(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Bz(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ur?n=qu(r):n=sz(r),hr.utils.cfb_add(e,t,n)}hr.utils.cfb_add(e,t,r)}else e.file(t,r)}function iC(e,t){switch(t.type){case"base64":return hr.read(e,{type:"base64"});case"binary":return hr.read(e,{type:"binary"});case"buffer":case"array":return hr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hh(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var oC=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Uz=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,qS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,$z=/<[^>]*>/g,Is=oC.match(qS)?qS:$z,zz=/<\w*:/,Hz=/<(\/?)\w+:/;function $t(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(Uz),o=0,l="",u=0,f="",h="",p=1;if(i)for(u=0;u!=i.length;++u){for(h=i[u],a=0;a!=h.length&&h.charCodeAt(a)!==61;++a);for(f=h.slice(0,a).trim();h.charCodeAt(a+1)==32;)++a;for(p=(s=h.charCodeAt(a+1))==34||s==39?1:0,l=h.slice(a+1+p,h.length-p),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var d=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[d]&&f.slice(o-3,o)=="ext")continue;n[d]=l,n[d.toLowerCase()]=l}}return n}function bo(e){return e.replace(Hz,"<$1")}var lC={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},qz=$b(lC),vr=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,l){return lC[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),Wz=/[&<>'"]/g,Vz=/[\u0000-\u001f]/g;function Hb(e){var t=e+"";return t.replace(Wz,function(r){return qz[r]}).replace(/\n/g,"<br/>").replace(Vz,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var WS=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function Xr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function uv(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function VS(e){var t=jc(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function KS(e){return qu(e,"binary").toString("utf8")}var Wm="foo bar baz",Br=ur&&(KS(Wm)==uv(Wm)&&KS||VS(Wm)==uv(Wm)&&VS)||uv,qh=ur?function(e){return qu(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},ep=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),cC=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),Kz=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),Gz=/<\/?(?:vt:)?variant>/g,Yz=/<(?:vt:)([^>]*)>([\s\S]*)</;function GS(e,t){var r=$t(e),n=e.match(Kz(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(Gz,"").match(Yz);i&&s.push({v:Br(i[2]),t:i[1]})}),s}var Xz=/(^\s|\s$|\n)/;function Jz(e){return yo(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Qz(e,t,r){return"<"+e+(r!=null?Jz(r):"")+(t!=null?(t.match(Xz)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function qb(e){if(ur&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Br(Wu(Mb(e)));throw new Error("Bad input format: expected Buffer or string")}var tp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Zz={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},eH=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function tH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function rH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var YS=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},XS=ur?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:qu(t)})):YS(e)}:YS,JS=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(tl(e,s)));return n.join("").replace(Qs,"")},Wb=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Qs,""):JS(e,t,r)}:JS,QS=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},uC=ur?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):QS(e,t,r)}:QS,ZS=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(kf(e,s)));return n.join("")},Ap=ur?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ZS(t,r,n)}:ZS,fC=function(e,t){var r=ja(e,t);return r>0?Ap(e,t+4,t+4+r-1):""},dC=fC,hC=function(e,t){var r=ja(e,t);return r>0?Ap(e,t+4,t+4+r-1):""},pC=hC,mC=function(e,t){var r=2*ja(e,t);return r>0?Ap(e,t+4,t+4+r-1):""},gC=mC,xC=function(t,r){var n=ja(t,r);return n>0?Wb(t,r+4,r+4+n):""},vC=xC,yC=function(e,t){var r=ja(e,t);return r>0?Ap(e,t+4,t+4+r):""},wC=yC,bC=function(e,t){return tH(e,t)},Dg=bC,NC=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ur&&(dC=function(t,r){if(!Buffer.isBuffer(t))return fC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},pC=function(t,r){if(!Buffer.isBuffer(t))return hC(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},gC=function(t,r){if(!Buffer.isBuffer(t))return mC(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},vC=function(t,r){if(!Buffer.isBuffer(t))return xC(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},wC=function(t,r){if(!Buffer.isBuffer(t))return yC(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Dg=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):bC(t,r)},NC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var kf=function(e,t){return e[t]},tl=function(e,t){return e[t+1]*256+e[t]},nH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ja=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},tu=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},sH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function i0(e,t){var r="",n,s,a=[],i,o,l,u;switch(t){case"dbcs":if(u=this.l,ur&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(tl(this,u)),u+=2;e*=2;break;case"utf8":r=Ap(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Wb(this,this.l,this.l+e);break;case"wstr":return i0.call(this,e,"dbcs");case"lpstr-ansi":r=dC(this,this.l),e=4+ja(this,this.l);break;case"lpstr-cp":r=pC(this,this.l),e=4+ja(this,this.l);break;case"lpwstr":r=gC(this,this.l),e=4+2*ja(this,this.l);break;case"lpp4":e=4+ja(this,this.l),r=vC(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ja(this,this.l),r=wC(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=kf(this,this.l+e++))!==0;)a.push(qm(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=tl(this,this.l+e))!==0;)a.push(qm(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=kf(this,u),this.l=u+1,o=i0.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(qm(tl(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=kf(this,u),this.l=u+1,o=i0.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(qm(kf(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=kf(this,this.l),this.l++,n;case 2:return n=(t==="i"?nH:tl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?tu:sH)(this,this.l),this.l+=4,n):(s=ja(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Dg(this,this.l):s=Dg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=uC(this,this.l,e);break}}return this.l+=e,r}var aH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},iH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},oH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function lH(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)oH(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,aH(this,t,this.l);break;case 8:if(n=8,r==="f"){rH(this,t,this.l);break}case 16:break;case-4:n=4,iH(this,t,this.l);break}return this.l+=n,this}function SC(e,t){var r=uC(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function cs(e,t){e.l=t,e.read_shift=i0,e.chk=SC,e.write_shift=lH}function Rs(e,t){e.l+=t}function zn(e){var t=jc(e);return cs(t,0),t}function yl(e,t,r){if(e){var n,s,a;cs(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Ug[o]||Ug[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;l=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=l,t(f,u,o))return}}}function Dw(){var e=[],t=ur?256:2048,r=function(u){var f=zn(u);return cs(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Xl(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function o0(e,t,r){var n=ds(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function ek(e,t,r){var n=ds(e);return n.s=o0(n.s,t.s,r),n.e=o0(n.e,t.s,r),n}function l0(e,t){if(e.cRel&&e.c<0)for(e=ds(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ds(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Jt(e);return!e.cRel&&e.cRel!=null&&(r=fH(r)),!e.rRel&&e.rRel!=null&&(r=cH(r)),r}function fv(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Wn(e.s.c)+":"+(e.e.cRel?"":"$")+Wn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+hs(e.s.r)+":"+(e.e.rRel?"":"$")+hs(e.e.r):l0(e.s,t.biff)+":"+l0(e.e,t.biff)}function Vb(e){return parseInt(uH(e),10)-1}function hs(e){return""+(e+1)}function cH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uH(e){return e.replace(/\$(\d+)$/,"$1")}function Kb(e){for(var t=dH(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fH(e){return e.replace(/^([A-Z])/,"$$$1")}function dH(e){return e.replace(/^\$([A-Z])/,"$1")}function hH(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ys(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Jt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function $d(e){var t=e.indexOf(":");return t==-1?{s:Ys(e),e:Ys(e)}:{s:Ys(e.slice(0,t)),e:Ys(e.slice(t+1))}}function pr(e,t){return typeof t>"u"||typeof t=="number"?pr(e.s,e.e):(typeof e!="string"&&(e=Jt(e)),typeof t!="string"&&(t=Jt(t)),e==t?e:e+":"+t)}function hn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function tk(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ni(e.z,r?ta(t):t)}catch{}try{return e.w=ni((e.XF||{}).numFmtId||(r?14:0),r?ta(t):t)}catch{return""+t}}function ml(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Gu[e.v]||e.v:t==null?tk(e,e.v):tk(e,t))}function Rc(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function kC(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ys(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=hn(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var d={v:t[h][p]},m=i+h,g=o+p;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))d=t[h][p];else if(Array.isArray(d.v)&&(d.f=t[h][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||er[14],n.cellDates?(d.t="d",d.w=ni(d.z,ta(d.v))):(d.t="n",d.v=ta(d.v),d.w=ni(d.z,d.v))):d.t="s";if(s)a[m]||(a[m]=[]),a[m][g]&&a[m][g].z&&(d.z=a[m][g].z),a[m][g]=d;else{var w=Jt({c:g,r:m});a[w]&&a[w].z&&(d.z=a[w].z),a[w]=d}}}return u.s.c<1e7&&(a["!ref"]=pr(u)),a}function zd(e,t){return kC(null,e,t)}function pH(e){return e.read_shift(4,"i")}function Fs(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function mH(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Gb(e,t){var r=e.l,n=e.read_shift(1),s=Fs(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(mH(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var gH=Gb;function ai(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Vu(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var xH=Fs;function Yb(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var vH=Fs,Rw=Yb;function Xb(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Dg([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):tu(t,0)>>2;return r?s/100:s}function _C(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var Ku=_C;function Cs(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function yH(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=ku[s];u&&(t.rgb=np(u));break;case 2:t.rgb=np([i,o,l]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function wH(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function EC(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function bH(e){return EC(e,1)}function NH(e){return EC(e,2)}var Jb=2,ia=3,Vm=11,rk=12,Rg=19,Km=64,SH=65,kH=71,_H=4108,EH=4126,Xn=80,AC=81,AH=[Xn,AC],jH={1:{n:"CodePage",t:Jb},2:{n:"Category",t:Xn},3:{n:"PresentationFormat",t:Xn},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:Vm},12:{n:"HeadingPairs",t:_H},13:{n:"TitlesOfParts",t:EH},14:{n:"Manager",t:Xn},15:{n:"Company",t:Xn},16:{n:"LinksUpToDate",t:Vm},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:Vm},22:{n:"HyperlinksChanged",t:Vm},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:SH},26:{n:"ContentType",t:Xn},27:{n:"ContentStatus",t:Xn},28:{n:"Language",t:Xn},29:{n:"Version",t:Xn},255:{},2147483648:{n:"Locale",t:Rg},2147483651:{n:"Behavior",t:Rg},1919054434:{}},TH={1:{n:"CodePage",t:Jb},2:{n:"Title",t:Xn},3:{n:"Subject",t:Xn},4:{n:"Author",t:Xn},5:{n:"Keywords",t:Xn},6:{n:"Comments",t:Xn},7:{n:"Template",t:Xn},8:{n:"LastAuthor",t:Xn},9:{n:"RevNumber",t:Xn},10:{n:"EditTime",t:Km},11:{n:"LastPrinted",t:Km},12:{n:"CreatedDate",t:Km},13:{n:"ModifiedDate",t:Km},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:kH},18:{n:"Application",t:Xn},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:Rg},2147483651:{n:"Behavior",t:Rg},1919054434:{}},nk={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},CH=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function PH(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var LH=PH([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ku=ds(LH),Gu={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jC={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},sk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function FH(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function DH(e){var t=FH();if(!e||!e.match)return t;var r={};if((e.match(Is)||[]).forEach(function(n){var s=$t(n);switch(s[0].replace(zz,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[sk[s.ContentType]]!==void 0&&t[sk[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Zz.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Bf={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ow(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function c0(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Is)||[]).forEach(function(s){var a=$t(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Hh(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}var RH="application/vnd.oasis.opendocument.spreadsheet";function OH(e,t){for(var r=qb(e),n,s;n=tp.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=$t(n[0],!1),s.path=="/"&&s.type!==RH)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var u0=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],IH=function(){for(var e=new Array(u0.length),t=0;t<u0.length;++t){var r=u0[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function TC(e){var t={};e=Br(e);for(var r=0;r<u0.length;++r){var n=u0[r],s=e.match(IH[r]);s!=null&&s.length>0&&(t[n[1]]=vr(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=es(t[n[1]]))}return t}var MH=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function CC(e,t,r,n){var s=[];if(typeof e=="string")s=GS(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?GS(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function BH(e,t,r){var n={};return t||(t={}),e=Br(e),MH.forEach(function(s){var a=(e.match(ep(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=vr(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&CC(n.HeadingPairs,n.TitlesOfParts,t,r),t}var UH=/<[^>]+>[^<]*/g;function $H(e,t){var r={},n="",s=e.match(UH);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=$t(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=vr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),f=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=vr(f);break;case"bool":r[n]=Xr(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=es(f);break;case"cy":case"error":r[n]=vr(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var zH={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dv;function HH(e,t,r){dv||(dv=$b(zH)),t=dv[t]||t,e[t]=r}function Qb(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function PC(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function LC(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function FC(e,t,r){return t===31?LC(e):PC(e,t,r)}function Iw(e,t,r){return FC(e,t,r===!1?0:4)}function qH(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return FC(e,t,0)}function WH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Qs,""),e.l-s&2&&(e.l+=2)}return r}function VH(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Qs,"");return r}function KH(e){var t=e.l,r=Og(e,AC);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Og(e,ia);return[r,n]}function GH(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(KH(e));return r}function ak(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Qs,"").replace(zh,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function DC(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function YH(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Og(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==rk&&n!==t&&AH.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===rk?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return PC(e,n,4).replace(Qs,"");case 31:return LC(e);case 64:return Qb(e);case 65:return DC(e);case 71:return YH(e);case 80:return Iw(e,n,!a.raw).replace(Qs,"");case 81:return qH(e,n).replace(Qs,"");case 4108:return GH(e);case 4126:case 4127:return n==4127?WH(e):VH(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function ik(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var f=e.read_shift(4),h=e.read_shift(4);a[i]=[f,h+r]}a.sort(function(y,b){return y[1]-b[1]});var p={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var d=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,d=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],d=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],d=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(d=!1,e.l=a[i][1]),d)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[a[i][0]];if(p[m.n]=Og(e,m.t,{raw:!0}),m.p==="version"&&(p[m.n]=String(p[m.n]>>16)+"."+("0000"+String(p[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(p[m.n]){case 0:p[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ti(o=p[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[m.n])}}else if(a[i][0]===1){if(o=p.CodePage=Og(e,Jb),Ti(o),l!==-1){var g=e.l;e.l=a[l][1],u=ak(e,o),e.l=g}}else if(a[i][0]===0){if(o===0){l=i,e.l=a[i+1][1];continue}u=ak(e,o)}else{var w=u[a[i][0]],x;switch(e[e.l]){case 65:e.l+=4,x=DC(e);break;case 30:e.l+=4,x=Iw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Iw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=vn(e,4);break;case 64:e.l+=4,x=es(Qb(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[w]=x}}return e.l=r+n,p}function ok(e,t,r){var n=e.content;if(!n)return{};cs(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==hr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var h=ik(n,t),p={SystemIdentifier:u};for(var d in h)p[d]=h[d];if(p.FMTID=a,s===1)return p;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=ik(n,null)}catch{}for(d in m)p[d]=m[d];return p.FMTID=[a,i],p}function Ml(e,t){return e.read_shift(t),null}function XH(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function vn(e,t){return e.read_shift(t)===1}function Pn(e){return e.read_shift(2,"u")}function RC(e,t){return XH(e,t,Pn)}function JH(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function jp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function QH(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function Iu(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Tp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Iu(e,n,r)}function Yu(e,t,r){if(r.biff>5)return Tp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function ZH(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function eq(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Qs,"");return n&&(e.l+=24),s}function tq(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Qs,"");return r+i}function rq(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return eq(e);case"0303000000000000c000000000000046":return tq(e);default:throw new Error("Unsupported Moniker "+r)}}function Gm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Qs,""):"";return r}function nq(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,l,u="",f,h;s&16&&(a=Gm(e,r-e.l)),s&128&&(i=Gm(e,r-e.l)),(s&257)===257&&(o=Gm(e,r-e.l)),(s&257)===1&&(l=rq(e,r-e.l)),s&8&&(u=Gm(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(h=Qb(e)),e.l=r;var p=i||o||l||"";p&&u&&(p+="#"+u),p||(p="#"+u),s&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var d={Target:p};return f&&(d.guid=f),h&&(d.time=h),a&&(d.Tooltip=a),d}function OC(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function IC(e,t){var r=OC(e);return r[3]=0,r}function No(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function sq(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function aq(e,t,r){return t===0?"":Yu(e,t,r)}function iq(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function MC(e){var t=e.read_shift(2),r=Xb(e);return[t,r]}function oq(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=jp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function Fx(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function BC(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var lq=BC;function UC(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function cq(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function uq(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function bs(e){e.l+=2,e.l+=e.read_shift(2)}var fq={0:bs,4:bs,5:bs,6:bs,7:uq,8:bs,9:bs,10:bs,11:bs,12:bs,13:cq,14:bs,15:bs,16:bs,17:bs,18:bs,19:bs,20:bs,21:UC};function dq(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(fq[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Ym(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function hq(e,t){return t===0||e.read_shift(2),1200}function pq(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Yu(e,0,r);return e.read_shift(t+n-e.l),s}function mq(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gq(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=jp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function xq(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(QH(e));return a.Count=n,a.Unique=s,a}function vq(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function yq(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function wq(e){var t=sq(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bq(e){return e.read_shift(2),e.read_shift(4)}function lk(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function Nq(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function Sq(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function kq(){}function _q(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=jp(e,0,r),n}function Eq(e){var t=No(e);return t.isst=e.read_shift(4),t}function Aq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=No(e);r.biff==2&&e.l++;var a=Tp(e,n-e.l,r);return s.val=a,s}function jq(e,t,r){var n=e.read_shift(2),s=Yu(e,0,r);return[n,s]}var Tq=Yu;function ck(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function Cq(e){var t=e.read_shift(2),r=e.read_shift(2),n=MC(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Pq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(MC(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function Lq(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Fq(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return s.patternType=CH[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Dq(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Fq(e,t,n.fStyle,r),n}function Rq(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function uk(e,t,r){var n=No(e);(r.biff==2||t==9)&&++e.l;var s=JH(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Oq(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=No(e),s=Cs(e);return n.val=s,n}var fk=aq;function Iq(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Iu(e,a),o=[];n>e.l;)o.push(Tp(e));return[a,s,i,o]}function dk(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=oq(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var Mq=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function hk(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Iu(e,i,r);s&32&&(u=Mq[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var h=n==e.l||o===0||!(f>0)?[]:yG(e,f,r,o);return{chKey:a,Name:u,itab:l,rgce:h}}function $C(e,t,r){if(r.biff<8)return Bq(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(iq(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Bq(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=jp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Uq(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Iu(e,n,r),i=Iu(e,s,r);return[a,i]}function $q(e,t,r){var n=BC(e);e.l++;var s=e.read_shift(1);return t-=8,[wG(e,t,r),s,n]}function pk(e,t,r){var n=lq(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,xG(e,t,r)]}function zq(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Hq(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Yu(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function qq(e,t,r){return Hq(e,t,r)}function Wq(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Fx(e));return r}function Vq(e,t,r){if(r&&r.biff<8)return Gq(e,t,r);var n=UC(e),s=dq(e,t-22,n[1]);return{cmo:n,ft:s}}var Kq={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Gq(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Kq[n]||Rs)(e,t,r)),{cmo:[s,n,a],ft:i}}function Yq(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=ZH(e,6,r);var o=e.read_shift(2);e.read_shift(2),Pn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],h=Iu(e,e.lens[u+1]-e.lens[u]-1);if(s+=h,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Xq(e,t){var r=Fx(e);e.l+=16;var n=nq(e,t-24);return[r,n]}function Jq(e,t){e.read_shift(2);var r=Fx(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Qs,""),[r,n]}function Qq(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=nk[r]||r,r=e.read_shift(2),t[1]=nk[r]||r,t}function Zq(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(IC(e));return r}function eW(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(IC(e));return r}function tW(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function zC(e,t,r){if(!r.cellStyles)return Rs(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function rW(e,t){var r={};return t<32||(e.l+=16,r.header=Cs(e),r.footer=Cs(e),e.l+=2),r}function nW(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}var sW=No,aW=RC,iW=Tp;function oW(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function lW(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=No(e);++e.l;var s=Yu(e,t-7,r);return n.t="str",n.val=s,n}function cW(e){var t=No(e);++e.l;var r=Cs(e);return t.t="n",t.val=r,t}function uW(e){var t=No(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function fW(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function dW(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function hW(e,t,r){var n=e.l+t,s=No(e),a=e.read_shift(2),i=Iu(e,a,r);return e.l=n,s.t="str",s.val=i,s}var pW=[2,3,48,49,131,139,140,245],mk=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=$b({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=jc(1);switch(l.type){case"base64":f=Ai(Ra(o));break;case"binary":f=Ai(o);break;case"buffer":case"array":f=o;break}cs(f,0);var h=f.read_shift(1),p=!!(h&136),d=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=f.read_shift(2));var x=f.read_shift(2),y=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),m&&(f.l+=36);for(var b=[],S={},T=Math.min(f.length,h==2?521:w-10-(d?264:0)),L=m?32:11;f.l<T&&f[f.l]!=13;)switch(S={},S.name=Q0.utils.decode(y,f.slice(f.l,f.l+L)).replace(/[\u0000\r\n].*$/g,""),f.l+=L,S.type=String.fromCharCode(f.read_shift(1)),h!=2&&!m&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),h==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&b.push(S),h!=2&&(f.l+=m?13:14),S.type){case"B":(!d||S.len!=8)&&l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=w-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=w;var A=0,D=0;for(u[0]=[],D=0;D!=b.length;++D)u[0][D]=b[D].name;for(;g-- >0;){if(f[f.l]===42){f.l+=x;continue}for(++f.l,u[++A]=[],D=0,D=0;D!=b.length;++D){var C=f.slice(f.l,f.l+b[D].len);f.l+=b[D].len,cs(C,0);var O=Q0.utils.decode(y,C);switch(b[D].type){case"C":O.trim().length&&(u[A][D]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[A][D]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[A][D]=O;break;case"F":u[A][D]=parseFloat(O.trim());break;case"+":case"I":u[A][D]=m?C.read_shift(-4,"i")^2147483648:C.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[A][D]=!0;break;case"N":case"F":u[A][D]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[A][D]="##MEMO##"+(m?parseInt(O.trim(),10):C.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[A][D]=+O||0);break;case"@":u[A][D]=new Date(C.read_shift(-8,"f")-621356832e5);break;case"T":u[A][D]=new Date((C.read_shift(4)-2440588)*864e5+C.read_shift(4));break;case"Y":u[A][D]=C.read_shift(4,"i")/1e4+C.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][D]=-C.read_shift(-8,"f");break;case"B":if(d&&b[D].len==8){u[A][D]=C.read_shift(8,"f");break}case"G":case"P":C.l+=b[D].len;break;case"0":if(b[D].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[D].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=b,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=zd(r(o,u),u);return f["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,f}function s(o,l){try{return Rc(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Ti(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Dw(),h=qw(o,{header:1,raw:!0,cellDates:!0}),p=h[0],d=h.slice(1),m=o["!cols"]||[],g=0,w=0,x=0,y=1;for(g=0;g<p.length;++g){if(((m[g]||{}).DBF||{}).name){p[g]=m[g].DBF.name,++x;continue}if(p[g]!=null){if(++x,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(w=0;w<1024;++w)if(p.indexOf(p[g]+"_"+w)==-1){p[g]+="_"+w;break}}}}var b=hn(o["!ref"]),S=[],T=[],L=[];for(g=0;g<=b.e.c-b.s.c;++g){var A="",D="",C=0,O=[];for(w=0;w<d.length;++w)d[w][g]!=null&&O.push(d[w][g]);if(O.length==0||p[g]==null){S[g]="?";continue}for(w=0;w<O.length;++w){switch(typeof O[w]){case"number":D="B";break;case"string":D="C";break;case"boolean":D="L";break;case"object":D=O[w]instanceof Date?"D":"C";break;default:D="C"}C=Math.max(C,String(O[w]).length),A=A&&A!=D?"C":D}C>250&&(C=250),D=((m[g]||{}).DBF||{}).type,D=="C"&&m[g].DBF.len>C&&(C=m[g].DBF.len),A=="B"&&D=="N"&&(A="N",L[g]=m[g].DBF.dec,C=m[g].DBF.len),T[g]=A=="C"||D=="N"?C:a[A]||0,y+=T[g],S[g]=A}var E=f.next(32);for(E.write_shift(4,318902576),E.write_shift(4,d.length),E.write_shift(2,296+32*x),E.write_shift(2,y),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[$T]||3)<<8),g=0,w=0;g<p.length;++g)if(p[g]!=null){var P=f.next(32),q=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);P.write_shift(1,q,"sbcs"),P.write_shift(1,S[g]=="?"?"C":S[g],"sbcs"),P.write_shift(4,w),P.write_shift(1,T[g]||a[S[g]]||0),P.write_shift(1,L[g]||0),P.write_shift(1,2),P.write_shift(4,0),P.write_shift(1,0),P.write_shift(4,0),P.write_shift(4,0),w+=T[g]||a[S[g]]||0}var M=f.next(264);for(M.write_shift(4,13),g=0;g<65;++g)M.write_shift(4,0);for(g=0;g<d.length;++g){var ne=f.next(y);for(ne.write_shift(1,0),w=0;w<p.length;++w)if(p[w]!=null)switch(S[w]){case"L":ne.write_shift(1,d[g][w]==null?63:d[g][w]?84:70);break;case"B":ne.write_shift(8,d[g][w]||0,"f");break;case"N":var fe="0";for(typeof d[g][w]=="number"&&(fe=d[g][w].toFixed(L[w]||0)),x=0;x<T[w]-fe.length;++x)ne.write_shift(1,32);ne.write_shift(1,fe,"sbcs");break;case"D":d[g][w]?(ne.write_shift(4,("0000"+d[g][w].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(d[g][w].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+d[g][w].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var me=String(d[g][w]!=null?d[g][w]:"").slice(0,T[w]);for(ne.write_shift(1,me,"sbcs"),x=0;x<T[w]-me.length;++x)ne.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),mW=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+yo(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var m=e[d];return typeof m=="number"?PS(m):m},n=function(p,d,m){var g=d.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?p:PS(g)};e["|"]=254;function s(p,d){switch(d.type){case"base64":return a(Ra(p),d);case"binary":return a(p,d);case"buffer":return a(ur&&Buffer.isBuffer(p)?p.toString("binary"):Wu(p),d);case"array":return a(Ou(p),d)}throw new Error("Unrecognized type "+d.type)}function a(p,d){var m=p.split(/[\n\r]+/),g=-1,w=-1,x=0,y=0,b=[],S=[],T=null,L={},A=[],D=[],C=[],O=0,E;for(+d.codepage>=0&&Ti(+d.codepage);x!==m.length;++x){O=0;var P=m[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),q=P.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),M=q[0],ne;if(P.length>0)switch(M){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":q[1].charAt(0)=="P"&&S.push(P.slice(3).replace(/;;/g,";"));break;case"C":var fe=!1,me=!1,re=!1,G=!1,ge=-1,ve=-1;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"A":break;case"X":w=parseInt(q[y].slice(1))-1,me=!0;break;case"Y":for(g=parseInt(q[y].slice(1))-1,me||(w=0),E=b.length;E<=g;++E)b[E]=[];break;case"K":ne=q[y].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(Di(ne))?isNaN(kd(ne).getDate())||(ne=es(ne)):(ne=Di(ne),T!==null&&Ud(T)&&(ne=Lx(ne))),fe=!0;break;case"E":G=!0;var _=Zf(q[y].slice(1),{r:g,c:w});b[g][w]=[b[g][w],_];break;case"S":re=!0,b[g][w]=[b[g][w],"S5S"];break;case"G":break;case"R":ge=parseInt(q[y].slice(1))-1;break;case"C":ve=parseInt(q[y].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+P)}if(fe&&(b[g][w]&&b[g][w].length==2?b[g][w][0]=ne:b[g][w]=ne,T=null),re){if(G)throw new Error("SYLK shared formula cannot have own formula");var R=ge>-1&&b[ge][ve];if(!R||!R[1])throw new Error("SYLK shared formula cannot find base");b[g][w][1]=QC(R[1],{r:g-ge,c:w-ve})}break;case"F":var I=0;for(y=1;y<q.length;++y)switch(q[y].charAt(0)){case"X":w=parseInt(q[y].slice(1))-1,++I;break;case"Y":for(g=parseInt(q[y].slice(1))-1,E=b.length;E<=g;++E)b[E]=[];break;case"M":O=parseInt(q[y].slice(1))/20;break;case"F":break;case"G":break;case"P":T=S[parseInt(q[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(C=q[y].slice(1).split(" "),E=parseInt(C[0],10);E<=parseInt(C[1],10);++E)O=parseInt(C[2],10),D[E-1]=O===0?{hidden:!0}:{wch:O},_d(D[E-1]);break;case"C":w=parseInt(q[y].slice(1))-1,D[w]||(D[w]={});break;case"R":g=parseInt(q[y].slice(1))-1,A[g]||(A[g]={}),O>0?(A[g].hpt=O,A[g].hpx=sp(O)):O===0&&(A[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+P)}I<1&&(T=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+P)}}return A.length>0&&(L["!rows"]=A),D.length>0&&(L["!cols"]=D),d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),[b,L]}function i(p,d){var m=s(p,d),g=m[0],w=m[1],x=zd(g,d);return yo(w).forEach(function(y){x[y]=w[y]}),x}function o(p,d){return Rc(i(p,d),d)}function l(p,d,m,g){var w="C;Y"+(m+1)+";X"+(g+1)+";K";switch(p.t){case"n":w+=p.v||0,p.f&&!p.F&&(w+=";E"+tK(p.f,{r:m,c:g}));break;case"b":w+=p.v?"TRUE":"FALSE";break;case"e":w+=p.w||p.v;break;case"d":w+='"'+(p.w||p.v)+'"';break;case"s":w+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(p,d){d.forEach(function(m,g){var w="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?w+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Mg(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Bg(m.wpx)),typeof m.wch=="number"&&(w+=Math.round(m.wch))),w.charAt(w.length-1)!=" "&&p.push(w)})}function f(p,d){d.forEach(function(m,g){var w="F;";m.hidden?w+="M0;":m.hpt?w+="M"+20*m.hpt+";":m.hpx&&(w+="M"+20*YC(m.hpx)+";"),w.length>2&&p.push(w+"R"+(g+1))})}function h(p,d){var m=["ID;PWXL;N;E"],g=[],w=hn(p["!ref"]),x,y=Array.isArray(p),b=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),p["!cols"]&&u(m,p["!cols"]),p["!rows"]&&f(m,p["!rows"]),m.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var S=w.s.r;S<=w.e.r;++S)for(var T=w.s.c;T<=w.e.c;++T){var L=Jt({r:S,c:T});x=y?(p[S]||[])[T]:p[L],!(!x||x.v==null&&(!x.f||x.F))&&g.push(l(x,p,S,T))}return m.join(b)+b+g.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:i,from_sheet:h}}(),gW=function(){function e(a,i){switch(i.type){case"base64":return t(Ra(a),i);case"binary":return t(a,i);case"buffer":return t(ur&&Buffer.isBuffer(a)?a.toString("binary"):Wu(a),i);case"array":return t(Ou(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),l=-1,u=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var p=o[f].trim().split(","),d=p[0],m=p[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+d){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(Di(m))?isNaN(kd(m).getDate())?h[l][u]=m:h[l][u]=es(m):h[l][u]=Di(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return i&&i.sheetRows&&(h=h.slice(0,i.sheetRows)),h}function r(a,i){return zd(e(a,i),i)}function n(a,i){return Rc(r(a,i),i)}var s=function(){var a=function(l,u,f,h,p){l.push(u),l.push(f+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},i=function(l,u,f,h){l.push(u+","+f),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],f=hn(l["!ref"]),h,p=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){i(u,-1,0,"BOT");for(var m=f.s.c;m<=f.e.c;++m){var g=Jt({r:d,c:m});if(h=p?(l[d]||[])[m]:l[g],!h){i(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?i(u,1,0,"="+h.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ni(h.z||er[14],ta(es(h.v)))),i(u,0,h.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var x=`\r
`,y=u.join(x);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),xW=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var d=h.split(`
`),m=-1,g=-1,w=0,x=[];w!==d.length;++w){var y=d[w].trim().split(":");if(y[0]==="cell"){var b=Ys(y[1]);if(x.length<=b.r)for(m=x.length;m<=b.r;++m)x[m]||(x[m]=[]);switch(m=b.r,g=b.c,y[2]){case"t":x[m][g]=e(y[3]);break;case"v":x[m][g]=+y[3];break;case"vtf":var S=y[y.length-1];case"vtc":switch(y[3]){case"nl":x[m][g]=!!+y[4];break;default:x[m][g]=+y[4];break}y[2]=="vtf"&&(x[m][g]=[x[m][g],S])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function n(h,p){return zd(r(h,p),p)}function s(h,p){return Rc(n(h,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],d=[],m,g="",w=$d(h["!ref"]),x=Array.isArray(h),y=w.s.r;y<=w.e.r;++y)for(var b=w.s.c;b<=w.e.c;++b)if(g=Jt({r:y,c:b}),m=x?(h[y]||[])[b]:h[g],!(!m||m.v==null||m.t==="z")){switch(d=["cell",g,"t"],m.t){case"s":case"str":d.push(t(m.v));break;case"n":m.f?(d[2]="vtf",d[3]="n",d[4]=m.v,d[5]=t(m.f)):(d[2]="v",d[3]=m.v);break;case"b":d[2]="vt"+(m.f?"f":"c"),d[3]="nl",d[4]=m.v?"1":"0",d[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var S=ta(es(m.v));d[2]="vtc",d[3]="nd",d[4]=""+S,d[5]=m.w||ni(m.z||er[14],S);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(h){return[a,i,o,i,u(h),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),rp=function(){function e(f,h,p,d,m){m.raw?h[p][d]=f:f===""||(f==="TRUE"?h[p][d]=!0:f==="FALSE"?h[p][d]=!1:isNaN(Di(f))?isNaN(kd(f).getDate())?h[p][d]=f:h[p][d]=es(f):h[p][d]=Di(f))}function t(f,h){var p=h||{},d=[];if(!f||f.length===0)return d;for(var m=f.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var w=10,x=0,y=0;y<=g;++y)x=m[y].indexOf(" "),x==-1?x=m[y].length:x++,w=Math.max(w,x);for(y=0;y<=g;++y){d[y]=[];var b=0;for(e(m[y].slice(0,w).trim(),d,y,b,p),b=1;b<=(m[y].length-w)/10+1;++b)e(m[y].slice(w+(b-1)*10,w+b*10).trim(),d,y,b,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var h={},p=!1,d=0,m=0;d<f.length;++d)(m=f.charCodeAt(d))==34?p=!p:!p&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d]);if(!m.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&m.push([h[d],d])}return m.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[m.pop()[1]]||44}function a(f,h){var p=h||{},d="",m=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=s(f.slice(0,1024)):p&&p.FS?d=p.FS:d=s(f.slice(0,1024));var w=0,x=0,y=0,b=0,S=0,T=d.charCodeAt(0),L=!1,A=0,D=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var C=p.dateNF!=null?jz(p.dateNF):null;function O(){var E=f.slice(b,S),P={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)P.t="z";else if(p.raw)P.t="s",P.v=E;else if(E.trim().length===0)P.t="s",P.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(P.t="s",P.v=E.slice(2,-1).replace(/""/g,'"')):nK(E)?(P.t="n",P.f=E.slice(1)):(P.t="s",P.v=E);else if(E=="TRUE")P.t="b",P.v=!0;else if(E=="FALSE")P.t="b",P.v=!1;else if(!isNaN(y=Di(E)))P.t="n",p.cellText!==!1&&(P.w=E),P.v=y;else if(!isNaN(kd(E).getDate())||C&&E.match(C)){P.z=p.dateNF||er[14];var q=0;C&&E.match(C)&&(E=Tz(E,p.dateNF,E.match(C)||[]),q=1),p.cellDates?(P.t="d",P.v=es(E,q)):(P.t="n",P.v=ta(es(E,q))),p.cellText!==!1&&(P.w=ni(P.z,P.v instanceof Date?ta(P.v):P.v)),p.cellNF||delete P.z}else P.t="s",P.v=E;if(P.t=="z"||(p.dense?(m[w]||(m[w]=[]),m[w][x]=P):m[Jt({c:x,r:w})]=P),b=S+1,D=f.charCodeAt(b),g.e.c<x&&(g.e.c=x),g.e.r<w&&(g.e.r=w),A==T)++x;else if(x=0,++w,p.sheetRows&&p.sheetRows<=w)return!0}e:for(;S<f.length;++S)switch(A=f.charCodeAt(S)){case 34:D===34&&(L=!L);break;case T:case 10:case 13:if(!L&&O())break e;break}return S-b>0&&O(),m["!ref"]=pr(g),m}function i(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,h):zd(t(f,h),h)}function o(f,h){var p="",d=h.type=="string"?[0,0,0,0]:i4(f,h);switch(h.type){case"base64":p=Ra(f);break;case"binary":p=f;break;case"buffer":h.codepage==65001?p=f.toString("utf8"):h.codepage&&typeof Q0<"u"||(p=ur&&Buffer.isBuffer(f)?f.toString("binary"):Wu(f));break;case"array":p=Ou(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=Br(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=Br(p):h.type=="binary"&&typeof Q0<"u",p.slice(0,19)=="socialcalc:version:"?xW.to_sheet(h.type=="string"?p:Br(p),h):i(p,h)}function l(f,h){return Rc(o(f,h),h)}function u(f){for(var h=[],p=hn(f["!ref"]),d,m=Array.isArray(f),g=p.s.r;g<=p.e.r;++g){for(var w=[],x=p.s.c;x<=p.e.c;++x){var y=Jt({r:g,c:x});if(d=m?(f[g]||[])[x]:f[y],!d||d.v==null){w.push("          ");continue}for(var b=(d.w||(ml(d),d.w)||"").slice(0,10);b.length<10;)b+=" ";w.push(b+(x===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function vW(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=mW.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return rp.to_workbook(e,t)}}var f0=function(){function e(_,R,I){if(_){cs(_,_.l||0);for(var B=I.Enum||ge;_.l<_.length;){var W=_.read_shift(2),se=B[W]||B[65535],pe=_.read_shift(2),he=_.l+pe,de=se.f&&se.f(_,pe,I);if(_.l=he,R(de,se,W))return}}}function t(_,R){switch(R.type){case"base64":return r(Ai(Ra(_)),R);case"binary":return r(Ai(_),R);case"buffer":case"array":return r(_,R)}throw"Unsupported type "+R.type}function r(_,R){if(!_)return _;var I=R||{},B=I.dense?[]:{},W="Sheet1",se="",pe=0,he={},de=[],je=[],Y={s:{r:0,c:0},e:{r:0,c:0}},We=I.sheetRows||0;if(_[2]==0&&(_[3]==8||_[3]==9)&&_.length>=16&&_[14]==5&&_[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(_[2]==2)I.Enum=ge,e(_,function(He,it,qe){switch(qe){case 0:I.vers=He,He>=4096&&(I.qpro=!0);break;case 6:Y=He;break;case 204:He&&(se=He);break;case 222:se=He;break;case 15:case 51:I.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:qe==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=I.dateNF||er[14],I.cellDates&&(He[1].t="d",He[1].v=Lx(He[1].v))),I.qpro&&He[3]>pe&&(B["!ref"]=pr(Y),he[W]=B,de.push(W),B=I.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},pe=He[3],W=se||"Sheet"+(pe+1),se="");var ht=I.dense?(B[He[0].r]||[])[He[0].c]:B[Jt(He[0])];if(ht){ht.t=He[1].t,ht.v=He[1].v,He[1].z!=null&&(ht.z=He[1].z),He[1].f!=null&&(ht.f=He[1].f);break}I.dense?(B[He[0].r]||(B[He[0].r]=[]),B[He[0].r][He[0].c]=He[1]):B[Jt(He[0])]=He[1];break}},I);else if(_[2]==26||_[2]==14)I.Enum=ve,_[2]==14&&(I.qpro=!0,_.l=0),e(_,function(He,it,qe){switch(qe){case 204:W=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>pe&&(B["!ref"]=pr(Y),he[W]=B,de.push(W),B=I.dense?[]:{},Y={s:{r:0,c:0},e:{r:0,c:0}},pe=He[3],W="Sheet"+(pe+1)),We>0&&He[0].r>=We)break;I.dense?(B[He[0].r]||(B[He[0].r]=[]),B[He[0].r][He[0].c]=He[1]):B[Jt(He[0])]=He[1],Y.e.c<He[0].c&&(Y.e.c=He[0].c),Y.e.r<He[0].r&&(Y.e.r=He[0].r);break;case 27:He[14e3]&&(je[He[14e3][0]]=He[14e3][1]);break;case 1537:je[He[0]]=He[1],He[0]==pe&&(W=He[1]);break}},I);else throw new Error("Unrecognized LOTUS BOF "+_[2]);if(B["!ref"]=pr(Y),he[se||W]=B,de.push(se||W),!je.length)return{SheetNames:de,Sheets:he};for(var Ke={},J=[],ze=0;ze<je.length;++ze)he[de[ze]]?(J.push(je[ze]||de[ze]),Ke[je[ze]]=he[je[ze]]||he[de[ze]]):(J.push(je[ze]),Ke[je[ze]]={"!ref":"A1"});return{SheetNames:J,Sheets:Ke}}function n(_,R){var I=R||{};if(+I.codepage>=0&&Ti(+I.codepage),I.type=="string")throw new Error("Cannot write WK1 to JS string");var B=Dw(),W=hn(_["!ref"]),se=Array.isArray(_),pe=[];pi(B,0,a(1030)),pi(B,6,l(W));for(var he=Math.min(W.e.r,8191),de=W.s.r;de<=he;++de)for(var je=hs(de),Y=W.s.c;Y<=W.e.c;++Y){de===W.s.r&&(pe[Y]=Wn(Y));var We=pe[Y]+je,Ke=se?(_[de]||[])[Y]:_[We];if(!(!Ke||Ke.t=="z"))if(Ke.t=="n")(Ke.v|0)==Ke.v&&Ke.v>=-32768&&Ke.v<=32767?pi(B,13,d(de,Y,Ke.v)):pi(B,14,g(de,Y,Ke.v));else{var J=ml(Ke);pi(B,15,h(de,Y,J.slice(0,239)))}}return pi(B,1),B.end()}function s(_,R){var I=R||{};if(+I.codepage>=0&&Ti(+I.codepage),I.type=="string")throw new Error("Cannot write WK3 to JS string");var B=Dw();pi(B,0,i(_));for(var W=0,se=0;W<_.SheetNames.length;++W)(_.Sheets[_.SheetNames[W]]||{})["!ref"]&&pi(B,27,G(_.SheetNames[W],se++));var pe=0;for(W=0;W<_.SheetNames.length;++W){var he=_.Sheets[_.SheetNames[W]];if(!(!he||!he["!ref"])){for(var de=hn(he["!ref"]),je=Array.isArray(he),Y=[],We=Math.min(de.e.r,8191),Ke=de.s.r;Ke<=We;++Ke)for(var J=hs(Ke),ze=de.s.c;ze<=de.e.c;++ze){Ke===de.s.r&&(Y[ze]=Wn(ze));var He=Y[ze]+J,it=je?(he[Ke]||[])[ze]:he[He];if(!(!it||it.t=="z"))if(it.t=="n")pi(B,23,O(Ke,ze,pe,it.v));else{var qe=ml(it);pi(B,22,A(Ke,ze,pe,qe.slice(0,239)))}}++pe}}return pi(B,1),B.end()}function a(_){var R=zn(2);return R.write_shift(2,_),R}function i(_){var R=zn(26);R.write_shift(2,4096),R.write_shift(2,4),R.write_shift(4,0);for(var I=0,B=0,W=0,se=0;se<_.SheetNames.length;++se){var pe=_.SheetNames[se],he=_.Sheets[pe];if(!(!he||!he["!ref"])){++W;var de=$d(he["!ref"]);I<de.e.r&&(I=de.e.r),B<de.e.c&&(B=de.e.c)}}return I>8191&&(I=8191),R.write_shift(2,I),R.write_shift(1,W),R.write_shift(1,B),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(1,1),R.write_shift(1,2),R.write_shift(4,0),R.write_shift(4,0),R}function o(_,R,I){var B={s:{c:0,r:0},e:{c:0,r:0}};return R==8&&I.qpro?(B.s.c=_.read_shift(1),_.l++,B.s.r=_.read_shift(2),B.e.c=_.read_shift(1),_.l++,B.e.r=_.read_shift(2),B):(B.s.c=_.read_shift(2),B.s.r=_.read_shift(2),R==12&&I.qpro&&(_.l+=2),B.e.c=_.read_shift(2),B.e.r=_.read_shift(2),R==12&&I.qpro&&(_.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function l(_){var R=zn(8);return R.write_shift(2,_.s.c),R.write_shift(2,_.s.r),R.write_shift(2,_.e.c),R.write_shift(2,_.e.r),R}function u(_,R,I){var B=[{c:0,r:0},{t:"n",v:0},0,0];return I.qpro&&I.vers!=20768?(B[0].c=_.read_shift(1),B[3]=_.read_shift(1),B[0].r=_.read_shift(2),_.l+=2):(B[2]=_.read_shift(1),B[0].c=_.read_shift(2),B[0].r=_.read_shift(2)),B}function f(_,R,I){var B=_.l+R,W=u(_,R,I);if(W[1].t="s",I.vers==20768){_.l++;var se=_.read_shift(1);return W[1].v=_.read_shift(se,"utf8"),W}return I.qpro&&_.l++,W[1].v=_.read_shift(B-_.l,"cstr"),W}function h(_,R,I){var B=zn(7+I.length);B.write_shift(1,255),B.write_shift(2,R),B.write_shift(2,_),B.write_shift(1,39);for(var W=0;W<B.length;++W){var se=I.charCodeAt(W);B.write_shift(1,se>=128?95:se)}return B.write_shift(1,0),B}function p(_,R,I){var B=u(_,R,I);return B[1].v=_.read_shift(2,"i"),B}function d(_,R,I){var B=zn(7);return B.write_shift(1,255),B.write_shift(2,R),B.write_shift(2,_),B.write_shift(2,I,"i"),B}function m(_,R,I){var B=u(_,R,I);return B[1].v=_.read_shift(8,"f"),B}function g(_,R,I){var B=zn(13);return B.write_shift(1,255),B.write_shift(2,R),B.write_shift(2,_),B.write_shift(8,I,"f"),B}function w(_,R,I){var B=_.l+R,W=u(_,R,I);if(W[1].v=_.read_shift(8,"f"),I.qpro)_.l=B;else{var se=_.read_shift(2);S(_.slice(_.l,_.l+se),W),_.l+=se}return W}function x(_,R,I){var B=R&32768;return R&=-32769,R=(B?_:0)+(R>=8192?R-16384:R),(B?"":"$")+(I?Wn(R):hs(R))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(_,R){cs(_,0);for(var I=[],B=0,W="",se="",pe="",he="";_.l<_.length;){var de=_[_.l++];switch(de){case 0:I.push(_.read_shift(8,"f"));break;case 1:se=x(R[0].c,_.read_shift(2),!0),W=x(R[0].r,_.read_shift(2),!1),I.push(se+W);break;case 2:{var je=x(R[0].c,_.read_shift(2),!0),Y=x(R[0].r,_.read_shift(2),!1);se=x(R[0].c,_.read_shift(2),!0),W=x(R[0].r,_.read_shift(2),!1),I.push(je+Y+":"+se+W)}break;case 3:if(_.l<_.length){console.error("WK1 premature formula end");return}break;case 4:I.push("("+I.pop()+")");break;case 5:I.push(_.read_shift(2));break;case 6:{for(var We="";de=_[_.l++];)We+=String.fromCharCode(de);I.push('"'+We.replace(/"/g,'""')+'"')}break;case 8:I.push("-"+I.pop());break;case 23:I.push("+"+I.pop());break;case 22:I.push("NOT("+I.pop()+")");break;case 20:case 21:he=I.pop(),pe=I.pop(),I.push(["AND","OR"][de-20]+"("+pe+","+he+")");break;default:if(de<32&&b[de])he=I.pop(),pe=I.pop(),I.push(pe+b[de]+he);else if(y[de]){if(B=y[de][1],B==69&&(B=_[_.l++]),B>I.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+I.join("|")+"|");return}var Ke=I.slice(-B);I.length-=B,I.push(y[de][0]+"("+Ke.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}I.length==1?R[1].f=""+I[0]:console.error("WK1 bad formula parse |"+I.join("|")+"|")}function T(_){var R=[{c:0,r:0},{t:"n",v:0},0];return R[0].r=_.read_shift(2),R[3]=_[_.l++],R[0].c=_[_.l++],R}function L(_,R){var I=T(_);return I[1].t="s",I[1].v=_.read_shift(R-4,"cstr"),I}function A(_,R,I,B){var W=zn(6+B.length);W.write_shift(2,_),W.write_shift(1,I),W.write_shift(1,R),W.write_shift(1,39);for(var se=0;se<B.length;++se){var pe=B.charCodeAt(se);W.write_shift(1,pe>=128?95:pe)}return W.write_shift(1,0),W}function D(_,R){var I=T(_);I[1].v=_.read_shift(2);var B=I[1].v>>1;if(I[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return I[1].v=B,I}function C(_,R){var I=T(_),B=_.read_shift(4),W=_.read_shift(4),se=_.read_shift(2);if(se==65535)return B===0&&W===3221225472?(I[1].t="e",I[1].v=15):B===0&&W===3489660928?(I[1].t="e",I[1].v=42):I[1].v=0,I;var pe=se&32768;return se=(se&32767)-16446,I[1].v=(1-pe*2)*(W*Math.pow(2,se+32)+B*Math.pow(2,se)),I}function O(_,R,I,B){var W=zn(14);if(W.write_shift(2,_),W.write_shift(1,I),W.write_shift(1,R),B==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var se=0,pe=0,he=0,de=0;return B<0&&(se=1,B=-B),pe=Math.log2(B)|0,B/=Math.pow(2,pe-31),de=B>>>0,de&2147483648||(B/=2,++pe,de=B>>>0),B-=de,de|=2147483648,de>>>=0,B*=Math.pow(2,32),he=B>>>0,W.write_shift(4,he),W.write_shift(4,de),pe+=16383+(se?32768:0),W.write_shift(2,pe),W}function E(_,R){var I=C(_);return _.l+=R-14,I}function P(_,R){var I=T(_),B=_.read_shift(4);return I[1].v=B>>6,I}function q(_,R){var I=T(_),B=_.read_shift(8,"f");return I[1].v=B,I}function M(_,R){var I=q(_);return _.l+=R-10,I}function ne(_,R){return _[_.l+R-1]==0?_.read_shift(R,"cstr"):""}function fe(_,R){var I=_[_.l++];I>R-1&&(I=R-1);for(var B="";B.length<I;)B+=String.fromCharCode(_[_.l++]);return B}function me(_,R,I){if(!(!I.qpro||R<21)){var B=_.read_shift(1);_.l+=17,_.l+=1,_.l+=2;var W=_.read_shift(R-21,"cstr");return[B,W]}}function re(_,R){for(var I={},B=_.l+R;_.l<B;){var W=_.read_shift(2);if(W==14e3){for(I[W]=[0,""],I[W][0]=_.read_shift(2);_[_.l];)I[W][1]+=String.fromCharCode(_[_.l]),_.l++;_.l++}}return I}function G(_,R){var I=zn(5+_.length);I.write_shift(2,14e3),I.write_shift(2,R);for(var B=0;B<_.length;++B){var W=_.charCodeAt(B);I[I.l++]=W>127?95:W}return I[I.l++]=0,I}var ge={0:{n:"BOF",f:Pn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:m},15:{n:"LABEL",f},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:fe},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:C},24:{n:"NUMBER18",f:D},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:P},38:{n:"??"},39:{n:"NUMBER27",f:q},40:{n:"FORMULA28",f:M},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function yW(e){var t={},r=e.match(Is),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=$t(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=Ob[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var wW=function(){var e=ep("t"),t=ep("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:vr(i[1])},l=a.match(t);return l&&(o.s=yW(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),bW=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),NW=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,SW=/<(?:\w+:)?r>/,kW=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Zb(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=vr(Br(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Br(e),r&&(n.h=Hb(n.t))):e.match(SW)&&(n.r=Br(e),n.t=vr(Br((e.replace(kW,"").match(NW)||[]).join("").replace(Is,""))),r&&(n.h=bW(wW(n.r)))),n):{t:""}}var _W=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,EW=/<(?:\w+:)?(?:si|sstItem)>/g,AW=/<\/(?:\w+:)?(?:si|sstItem)>/;function jW(e,t){var r=[],n="";if(!e)return r;var s=e.match(_W);if(s){n=s[2].replace(EW,"").split(AW);for(var a=0;a!=n.length;++a){var i=Zb(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=$t(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}function TW(e){return[e.read_shift(4),e.read_shift(4)]}function CW(e,t){var r=[],n=!1;return yl(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function HC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ll(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function PW(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function LW(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function FW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(LW(e));return t}function DW(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function RW(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function OW(e){var t=RW(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function qC(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function WC(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function IW(e){var t=ll(e);switch(t.Minor){case 2:return[t.Minor,MW(e)];case 3:return[t.Minor,BW()];case 4:return[t.Minor,UW(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function MW(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=qC(e,r),s=WC(e,e.length-e.l);return{t:"Std",h:n,v:s}}function BW(){throw new Error("File is password-protected: ECMA-376 Extensible")}function UW(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Is,function(a){var i=$t(a);switch(bo(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function $W(e,t){var r={},n=r.EncryptionVersionInfo=ll(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=qC(e,s),t-=s,r.EncryptionVerifier=WC(e,t),r}function zW(e){var t={},r=t.EncryptionVersionInfo=ll(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function HW(e){var t=0,r,n=HC(e),s=n.length+1,a,i,o,l,u;for(r=jc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^i;return t^52811}var VC=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var f=i[u],h=0;h!=7;++h)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=HC(i),l=a(o),u=o.length,f=jc(16),h=0;h!=16;++h)f[h]=0;var p,d,m;for((u&1)===1&&(p=l>>8,f[u]=s(e[0],p),--u,p=l&255,d=o[o.length-1],f[u]=s(d,p));u>0;)--u,p=l>>8,f[u]=s(o[u],p),--u,p=l&255,f[u]=s(o[u],p);for(u=15,m=15-o.length;m>0;)p=l>>8,f[u]=s(e[m],p),--u,--m,p=l&255,f[u]=s(o[u],p),--u,--m;return f}}(),qW=function(e,t,r,n,s){s||(s=t),n||(n=VC(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},WW=function(e){var t=0,r=VC(e);return function(n){var s=qW("",n,t,r);return t=s[1],s[0]}};function VW(e,t,r,n){var s={key:Pn(e),verificationBytes:Pn(e)};return r.password&&(s.verifier=HW(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=WW(r.password)),s}function KW(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=zW(e):n.Data=$W(e,t),n}function GW(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?KW(e,t-2,n):VW(e,r.biff>=8?t:t-2,r,n),n}var YW=function(){function e(s,a){switch(a.type){case"base64":return t(Ra(s),a);case"binary":return t(s,a);case"buffer":return t(ur&&Buffer.isBuffer(s)?s.toString("binary"):Wu(s),a);case"array":return t(Ou(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,d=0,m,g=-1;m=p.exec(f);){switch(m[0]){case"\\cell":var w=f.slice(d,p.lastIndex-m[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var x={v:w,t:"s"};Array.isArray(o)?o[h][g]=x:o[Jt({r:h,c:g})]=x}break}d=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=pr(u),o}function r(s,a){return Rc(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=hn(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var h=Jt({r:u,c:f});o=l?(s[u]||[])[f]:s[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(ml(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function XW(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function np(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function JW(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,u/2]}function QW(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Ig(e,t){if(t===0)return e;var r=JW(XW(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),np(QW(r))}var KC=6,ZW=15,eV=1,Vs=KC;function Mg(e){return Math.floor((e+Math.round(128/Vs)/256)*Vs)}function Bg(e){return Math.floor((e-5)/Vs*100+.5)/100}function Mw(e){return Math.round((e*Vs+5)/Vs*256)/256}function hv(e){return Mw(Bg(Mg(e)))}function e4(e){var t=Math.abs(e-hv(e)),r=Vs;if(t>.005)for(Vs=eV;Vs<ZW;++Vs)Math.abs(e-hv(e))<=t&&(t=Math.abs(e-hv(e)),r=Vs);Vs=r}function _d(e){e.width?(e.wpx=Mg(e.width),e.wch=Bg(e.wpx),e.MDW=Vs):e.wpx?(e.wch=Bg(e.wpx),e.width=Mw(e.wch),e.MDW=Vs):typeof e.wch=="number"&&(e.width=Mw(e.wch),e.wpx=Mg(e.width),e.MDW=Vs),e.customWidth&&delete e.customWidth}var tV=96,GC=tV;function YC(e){return e*96/GC}function sp(e){return e*GC/96}var rV={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function nV(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Is)||[]).forEach(function(i){var o=$t(i);switch(bo(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Xr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Xr(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function sV(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Is)||[]).forEach(function(i){var o=$t(i);switch(bo(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function aV(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Is)||[]).forEach(function(i){var o=$t(i);switch(bo(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=Br(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Xr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Xr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Xr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Xr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Xr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Xr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Xr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Ob[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Xr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=ku[s.color.index];s.color.index==81&&(l=ku[1]),l||(l=ku[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Ig(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function iV(e,t,r){t.NumberFmt=[];for(var n=yo(er),s=0;s<n.length;++s)t.NumberFmt[n[s]]=er[n[s]];var a=e[0].match(Is);if(a)for(s=0;s<a.length;++s){var i=$t(a[s]);switch(bo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=vr(Br(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Su(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var Xm=["numFmtId","fillId","fontId","borderId","xfId"],Jm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oV(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Is)||[]).forEach(function(a){var i=$t(a),o=0;switch(bo(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Xm.length;++o)n[Xm[o]]&&(n[Xm[o]]=parseInt(n[Xm[o]],10));for(o=0;o<Jm.length;++o)n[Jm[o]]&&(n[Jm[o]]=Xr(n[Jm[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Xr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var lV=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&iV(h,f,u),(h=o.match(s))&&aV(h,f,l,u),(h=o.match(n))&&sV(h,f,l,u),(h=o.match(a))&&nV(h,f,l,u),(h=o.match(r))&&oV(h,f,u),f}}();function cV(e,t){var r=e.read_shift(2),n=Fs(e);return[r,n]}function uV(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=wH(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=yH(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Fs(e),n}var fV=Rs;function dV(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}var hV=Rs;function pV(e,t,r){var n={};n.NumberFmt=[];for(var s in er)n.NumberFmt[s]=er[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return yl(e,function(l,u,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Su(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=Ig(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var mV=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function gV(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Is)||[]).forEach(function(s){var a=$t(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[mV.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function xV(){}function vV(){}var yV=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,wV=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,bV=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function NV(e,t,r){t.themeElements={};var n;[["clrScheme",yV,gV],["fontScheme",wV,xV],["fmtScheme",bV,vV]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var SV=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function XC(e,t){(!e||e.length===0)&&(e=kV());var r,n={};if(!(r=e.match(SV)))throw new Error("themeElements not found in theme");return NV(r[0],n,t),n.raw=e,n}function kV(e,t){var r=[oC];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function _V(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=iC(a,{type:"array"})}catch{return}var o=Ta(i,"theme/theme/theme1.xml",!0);if(o)return XC(o,r)}}function EV(e){return e.read_shift(4)}function AV(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=jV(e,4);break;case 2:t.xclrValue=OC(e);break;case 3:t.xclrValue=EV(e);break;case 4:e.l+=4;break}return e.l+=8,t}function jV(e,t){return Rs(e,t)}function TV(e,t){return Rs(e,t)}function CV(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=AV(e);break;case 6:n[1]=TV(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function PV(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(CV(e,r-e.l));return{ixfe:n,ext:a}}function LV(e,t){t.forEach(function(r){switch(r[0]){}})}function FV(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Fs(e)}}function DV(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function RV(e){return e.l+=4,e.read_shift(4)!=0}function OV(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return yl(e,function(l,u,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):o==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function IV(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Is,function(o){var l=$t(o);switch(bo(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function MV(e){var t=[];if(!e)return t;var r=1;return(e.match(Is)||[]).forEach(function(n){var s=$t(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function BV(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Jt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function UV(e,t,r){var n=[];return yl(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function $V(e,t,r,n){if(!e)return e;var s=n||{},a=!1;yl(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function zV(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function gk(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Ys(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var l=hn(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=pr(l);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var h=a.c.length-1;h>=0;--h){if(!r&&a.c[h].T)return;r&&!a.c[h].T&&a.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(f.a==n[h].id){f.a=n[h].name||f.a;break}}a.c.push(f)})}function HV(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=$t(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Ys(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var h=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&Zb(h[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),n.push(u)}}}}),n}function qV(e,t){var r=[],n=!1,s={},a=0;return e.replace(Is,function(o,l){var u=$t(o);switch(bo(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=e.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function WV(e,t){var r=[],n=!1;return e.replace(Is,function(a){var i=$t(a);switch(bo(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function VV(e){var t={};t.iauthor=e.read_shift(4);var r=Ku(e);return t.rfx=r.s,t.ref=Jt(r.s),e.l+=16,t}var KV=Fs;function GV(e,t){var r=[],n=[],s={},a=!1;return yl(e,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}var YV="application/vnd.ms-office.vbaProject";function XV(e){var t=hr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");hr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),hr.write(t)}function JV(){return{"!type":"dialog"}}function QV(){return{"!type":"dialog"}}function ZV(){return{"!type":"macro"}}function eK(){return{"!type":"macro"}}var Zf=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,s+(o?"":"$")+Wn(f)+(l?"":"$")+hs(u)}return function(s,a){return t=a,s.replace(e,r)}}(),JC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,tK=function(){return function(t,r){return t.replace(JC,function(n,s,a,i,o,l){var u=Kb(i)-(a?0:r.c),f=Vb(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",p=u==0?"":a?u+1:"["+u+"]";return s+"R"+h+"C"+p})}}();function QC(e,t){return e.replace(JC,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Wn(Kb(a)+t.c))+(i=="$"?i+o:hs(Vb(o)+t.r))})}function rK(e,t,r){var n=$d(t),s=n.s,a=Ys(r),i={r:a.r-s.r,c:a.c-s.c};return QC(e,i)}function nK(e){return e.length!=1}function xk(e){return e.replace(/_xlfn\./g,"")}function Tn(e){e.l+=1}function Tc(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function ZC(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return e8(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Tc(e),o=Tc(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function e8(e){var t=Tc(e),r=Tc(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function sK(e,t,r){if(r.biff<8)return e8(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Tc(e),i=Tc(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function t8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return aK(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Tc(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function aK(e){var t=Tc(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function iK(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function oK(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return lK(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function lK(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function cK(e,t,r){var n=(e[e.l++]&96)>>5,s=ZC(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function uK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=ZC(e,a,r);return[n,s,i]}function fK(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function dK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function hK(e,t,r){var n=(e[e.l++]&96)>>5,s=sK(e,t-1,r);return[n,s]}function pK(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function vk(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function mK(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function gK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function vK(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function yK(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function r8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function wK(e){return e.read_shift(2),r8(e)}function bK(e){return e.read_shift(2),r8(e)}function NK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=t8(e,0,r);return[n,s]}function SK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=oK(e,0,r);return[n,s]}function kK(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=t8(e,0,r);return[n,s,a]}function _K(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[EG[s],a8[s],n]}function EK(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:AK(e);return[s,(a[0]===0?a8:_G)[a[1]]]}function AK(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function jK(e,t,r){e.l+=r&&r.biff==2?3:4}function TK(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function CK(e){return e.l++,Gu[e.read_shift(1)]}function PK(e){return e.l++,e.read_shift(2)}function LK(e){return e.l++,e.read_shift(1)!==0}function FK(e){return e.l++,Cs(e)}function DK(e,t,r){return e.l++,jp(e,t-1,r)}function RK(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=vn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Gu[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Cs(e);break;case 2:r[1]=Yu(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function OK(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Ku:Fx)(e));return s}function IK(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=RK(e,r.biff);return i}function MK(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function BK(e,t,r){if(r.biff==5)return UK(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function UK(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function $K(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function zK(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function HK(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function qK(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var WK=Rs,VK=Rs,KK=Rs;function Cp(e,t,r){return e.l+=2,[iK(e)]}function t4(e){return e.l+=6,[]}var GK=Cp,YK=t4,XK=t4,JK=Cp;function n8(e){return e.l+=2,[Pn(e),e.read_shift(2)&1]}var QK=Cp,ZK=n8,eG=t4,tG=Cp,rG=Cp,nG=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function sG(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=nG[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function aG(e){return e.l+=2,[e.read_shift(4)]}function iG(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function oG(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function lG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function cG(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function uG(e){return e.l+=4,[0,0]}var yk={1:{n:"PtgExp",f:TK},2:{n:"PtgTbl",f:KK},3:{n:"PtgAdd",f:Tn},4:{n:"PtgSub",f:Tn},5:{n:"PtgMul",f:Tn},6:{n:"PtgDiv",f:Tn},7:{n:"PtgPower",f:Tn},8:{n:"PtgConcat",f:Tn},9:{n:"PtgLt",f:Tn},10:{n:"PtgLe",f:Tn},11:{n:"PtgEq",f:Tn},12:{n:"PtgGe",f:Tn},13:{n:"PtgGt",f:Tn},14:{n:"PtgNe",f:Tn},15:{n:"PtgIsect",f:Tn},16:{n:"PtgUnion",f:Tn},17:{n:"PtgRange",f:Tn},18:{n:"PtgUplus",f:Tn},19:{n:"PtgUminus",f:Tn},20:{n:"PtgPercent",f:Tn},21:{n:"PtgParen",f:Tn},22:{n:"PtgMissArg",f:Tn},23:{n:"PtgStr",f:DK},26:{n:"PtgSheet",f:iG},27:{n:"PtgEndSheet",f:oG},28:{n:"PtgErr",f:CK},29:{n:"PtgBool",f:LK},30:{n:"PtgInt",f:PK},31:{n:"PtgNum",f:FK},32:{n:"PtgArray",f:pK},33:{n:"PtgFunc",f:_K},34:{n:"PtgFuncVar",f:EK},35:{n:"PtgName",f:MK},36:{n:"PtgRef",f:NK},37:{n:"PtgArea",f:cK},38:{n:"PtgMemArea",f:$K},39:{n:"PtgMemErr",f:WK},40:{n:"PtgMemNoMem",f:VK},41:{n:"PtgMemFunc",f:zK},42:{n:"PtgRefErr",f:HK},43:{n:"PtgAreaErr",f:fK},44:{n:"PtgRefN",f:SK},45:{n:"PtgAreaN",f:hK},46:{n:"PtgMemAreaN",f:lG},47:{n:"PtgMemNoMemN",f:cG},57:{n:"PtgNameX",f:BK},58:{n:"PtgRef3d",f:kK},59:{n:"PtgArea3d",f:uK},60:{n:"PtgRefErr3d",f:qK},61:{n:"PtgAreaErr3d",f:dK},255:{}},fG={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},dG={1:{n:"PtgElfLel",f:n8},2:{n:"PtgElfRw",f:tG},3:{n:"PtgElfCol",f:GK},6:{n:"PtgElfRwV",f:rG},7:{n:"PtgElfColV",f:JK},10:{n:"PtgElfRadical",f:QK},11:{n:"PtgElfRadicalS",f:eG},13:{n:"PtgElfColS",f:YK},15:{n:"PtgElfColSV",f:XK},16:{n:"PtgElfRadicalLel",f:ZK},25:{n:"PtgList",f:sG},29:{n:"PtgSxName",f:aG},255:{}},hG={0:{n:"PtgAttrNoop",f:uG},1:{n:"PtgAttrSemi",f:yK},2:{n:"PtgAttrIf",f:xK},4:{n:"PtgAttrChoose",f:mK},8:{n:"PtgAttrGoto",f:gK},16:{n:"PtgAttrSum",f:jK},32:{n:"PtgAttrBaxcel",f:vk},33:{n:"PtgAttrBaxcel",f:vk},64:{n:"PtgAttrSpace",f:wK},65:{n:"PtgAttrSpaceSemi",f:bK},128:{n:"PtgAttrIfError",f:vK},255:{}};function Pp(e,t,r,n){if(n.biff<8)return Rs(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=IK(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=OK(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Rs(e,t)),a}function Lp(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=yk[a]||yk[fG[a]],(a===24||a===25)&&(s=(a===24?dG:hG)[e[e.l+1]]),!s||!s.f?Rs(e,t):i.push([s.n,s.f(e,t,r)]);return i}function pG(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var mG={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function gG(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function s8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function wk(e,t,r){var n=s8(e,t,r);return n=="#REF"?n:gG(n,r)}function Es(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,f,h=0,p=0,d,m="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",x=0,y=e[0].length;x<y;++x){var b=e[0][x];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=fn(" ",e[0][g][1][1]);break;case 1:w=fn("\r",e[0][g][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+w,g=-1}o.push(u+mG[b[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=o0(b[1][1],i,s),o.push(l0(f,a));break;case"PtgRefN":f=r?o0(b[1][1],r,s):b[1][1],o.push(l0(f,a));break;case"PtgRef3d":h=b[1][1],f=o0(b[1][2],i,s),m=wk(n,h,s),o.push(m+"!"+l0(f,a));break;case"PtgFunc":case"PtgFuncVar":var S=b[1][0],T=b[1][1];S||(S=0),S&=127;var L=S==0?[]:o.slice(-S);o.length-=S,T==="User"&&(T=L.shift()),o.push(T+"("+L.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":d=ek(b[1][1],r?{s:r}:i,s),o.push(fv(d,s));break;case"PtgArea":d=ek(b[1][1],i,s),o.push(fv(d,s));break;case"PtgArea3d":h=b[1][1],d=b[1][2],m=wk(n,h,s),o.push(m+"!"+fv(d,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=b[1][2];var A=(n.names||[])[p-1]||(n[0]||[])[p],D=A?A.Name:"SH33TJSNAME"+String(p);D&&D.slice(0,6)=="_xlfn."&&!s.xlfn&&(D=D.slice(6)),o.push(D);break;case"PtgNameX":var C=b[1][1];p=b[1][2];var O;if(s.biff<=5)C<0&&(C=-C),n[C]&&(O=n[C][p]);else{var E="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][p]&&n[C][p].itab>0&&(E=n.SheetNames[n[C][p].itab-1]+"!"):E=n.SheetNames[p-1]+"!"),n[C]&&n[C][p])E+=n[C][p].Name;else if(n[0]&&n[0][p])E+=n[0][p].Name;else{var P=(s8(n,C,s)||"").split(";;");P[p-1]?E=P[p-1]:E+="SH33TJSERRX"}o.push(E);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var q="(",M=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:q=fn(" ",e[0][g][1][1])+q;break;case 3:q=fn("\r",e[0][g][1][1])+q;break;case 4:M=fn(" ",e[0][g][1][1])+M;break;case 5:M=fn("\r",e[0][g][1][1])+M;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(q+o.pop()+M);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:b[1][1],r:b[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[Jt(f)]){var fe=n.sharedf[Jt(f)];o.push(Es(fe,i,ne,n,s))}else{var me=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(Es(u[1],i,ne,n,s)),me=!0;break}me||o.push(b[1])}break;case"PtgArray":o.push("{"+pG(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var re=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&g>=0&&re.indexOf(e[0][x][0])==-1){b=e[0][g];var G=!0;switch(b[1][0]){case 4:G=!1;case 0:w=fn(" ",b[1][1]);break;case 5:G=!1;case 1:w=fn("\r",b[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((G?w:"")+o.pop()+(G?"":w)),g=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function xG(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Rs(e,t-2)];var o=Lp(e,i,r);return t!==i+s&&(a=Pp(e,t-i-s,o,r)),e.l=n,[o,a]}function vG(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Rs(e,t-2)];var o=Lp(e,i,r);return t!==i+s&&(a=Pp(e,t-i-s,o,r)),e.l=n,[o,a]}function yG(e,t,r,n){var s=e.l+t,a=Lp(e,n,r),i;return s!==e.l&&(i=Pp(e,s-e.l,a,r)),[a,i]}function wG(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Lp(e,a,r);return a==65535?[[],Rs(e,t-2)]:(t!==a+2&&(s=Pp(e,n-a-2,i,r)),[i,s])}function bG(e){var t;if(tl(e,e.l+6)!==65535)return[Cs(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function pv(e,t,r){var n=e.l+t,s=No(e);r.biff==2&&++e.l;var a=bG(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=vG(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Dx(e,t,r){var n=e.read_shift(4),s=Lp(e,n,r),a=e.read_shift(4),i=a>0?Pp(e,a,s,r):null;return[s,i]}var NG=Dx,Rx=Dx,SG=Dx,kG=Dx,_G={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},a8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},EG={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bk(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function mv(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var d0={},ed={};function h0(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function i8(e,t,r,n,s,a){try{n.cellNF&&(e.z=er[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=es(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(er[t]==null&&Su(Az[t]||"General",t),e.t==="e")e.w=e.w||Gu[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Z0(e.v);else if(e.t==="d"){var i=ta(e.v);(i|0)===i?e.w=i.toString(10):e.w=Z0(i)}else{if(e.v===void 0)return"";e.w=Ru(e.v,ed)}else e.t==="d"?e.w=ni(t,ta(e.v),ed):e.w=ni(t,e.v,ed)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Ig(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Ig(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function AG(e,t){var r=hn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=pr(r))}var jG=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TG=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,CG=/<(?:\w:)?hyperlink [^>]*>/mg,PG=/"(\w*:\w*)"/,LG=/<(?:\w:)?col\b[^>]*[\/]?>/g,FG=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,DG=/<(?:\w:)?pageMargins[^>]*\/>/g,o8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,RG=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,OG=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IG(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",h=e.match(TG);h?(u=e.slice(0,h.index),f=e.slice(h.index+h[0].length)):u=f=e;var p=u.match(o8);p?r4(p[0],o,s,r):(p=u.match(RG))&&MG(p[0],p[1]||"",o,s,r);var d=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(d>0){var m=u.slice(d,d+50).match(PG);m&&AG(o,m[1])}var g=u.match(OG);g&&g[1]&&qG(g[1],s);var w=[];if(t.cellStyles){var x=u.match(LG);x&&$G(w,x)}h&&WG(h[1],o,t,l,a,i);var y=f.match(FG);y&&(o["!autofilter"]=zG(y[0]));var b=[],S=f.match(jG);if(S)for(d=0;d!=S.length;++d)b[d]=hn(S[d].slice(S[d].indexOf('"')+1));var T=f.match(CG);T&&BG(o,T,n);var L=f.match(DG);if(L&&(o["!margins"]=UG($t(L[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=pr(l)),t.sheetRows>0&&o["!ref"]){var A=hn(o["!ref"]);t.sheetRows<=+A.e.r&&(A.e.r=t.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=pr(A))}return w.length>0&&(o["!cols"]=w),b.length>0&&(o["!merges"]=b),o}function r4(e,t,r,n){var s=$t(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=vr(Br(s.codeName)))}function MG(e,t,r,n,s){r4(e.slice(0,e.indexOf(">")),r,n,s)}function BG(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=$t(Br(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+vr(a.location))):(a.Target="#"+vr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=hn(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var f=Jt({c:u,r:l});n?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function UG(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function $G(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=$t(t[n],!0);s.hidden&&(s.hidden=Xr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,e4(s.width)),_d(s);a<=i;)e[a++]=ds(s)}}function zG(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var HG=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function qG(e,t){t.Views||(t.Views=[{}]),(e.match(HG)||[]).forEach(function(r,n){var s=$t(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Xr(s.rightToLeft)&&(t.Views[n].RTL=!0)})}var WG=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=ep("v"),i=ep("f");return function(l,u,f,h,p,d){for(var m=0,g="",w=[],x=[],y=0,b=0,S=0,T="",L,A,D=0,C=0,O,E,P=0,q=0,M=Array.isArray(d.CellXf),ne,fe=[],me=[],re=Array.isArray(u),G=[],ge={},ve=!1,_=!!f.sheetStubs,R=l.split(t),I=0,B=R.length;I!=B;++I){g=R[I].trim();var W=g.length;if(W!==0){var se=0;e:for(m=0;m<W;++m)switch(g[m]){case">":if(g[m-1]!="/"){++m;break e}if(f&&f.cellStyles){if(A=$t(g.slice(se,m),!0),D=A.r!=null?parseInt(A.r,10):D+1,C=-1,f.sheetRows&&f.sheetRows<D)continue;ge={},ve=!1,A.ht&&(ve=!0,ge.hpt=parseFloat(A.ht),ge.hpx=sp(ge.hpt)),A.hidden=="1"&&(ve=!0,ge.hidden=!0),A.outlineLevel!=null&&(ve=!0,ge.level=+A.outlineLevel),ve&&(G[D-1]=ge)}break;case"<":se=m;break}if(se>=m)break;if(A=$t(g.slice(se,m),!0),D=A.r!=null?parseInt(A.r,10):D+1,C=-1,!(f.sheetRows&&f.sheetRows<D)){h.s.r>D-1&&(h.s.r=D-1),h.e.r<D-1&&(h.e.r=D-1),f&&f.cellStyles&&(ge={},ve=!1,A.ht&&(ve=!0,ge.hpt=parseFloat(A.ht),ge.hpx=sp(ge.hpt)),A.hidden=="1"&&(ve=!0,ge.hidden=!0),A.outlineLevel!=null&&(ve=!0,ge.level=+A.outlineLevel),ve&&(G[D-1]=ge)),w=g.slice(m).split(e);for(var pe=0;pe!=w.length&&w[pe].trim().charAt(0)=="<";++pe);for(w=w.slice(pe),m=0;m!=w.length;++m)if(g=w[m].trim(),g.length!==0){if(x=g.match(r),y=m,b=0,S=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,x!=null&&x.length===2){for(y=0,T=x[1],b=0;b!=T.length&&!((S=T.charCodeAt(b)-64)<1||S>26);++b)y=26*y+S;--y,C=y}else++C;for(b=0;b!=g.length&&g.charCodeAt(b)!==62;++b);if(++b,A=$t(g.slice(0,b),!0),A.r||(A.r=Jt({r:D-1,c:C})),T=g.slice(b),L={t:""},(x=T.match(a))!=null&&x[1]!==""&&(L.v=vr(x[1])),f.cellFormula){if((x=T.match(i))!=null&&x[1]!==""){if(L.f=vr(Br(x[1])).replace(/\r\n/g,`
`),f.xlfn||(L.f=xk(L.f)),x[0].indexOf('t="array"')>-1)L.F=(T.match(s)||[])[1],L.F.indexOf(":")>-1&&fe.push([hn(L.F),L.F]);else if(x[0].indexOf('t="shared"')>-1){E=$t(x[0]);var he=vr(Br(x[1]));f.xlfn||(he=xk(he)),me[parseInt(E.si,10)]=[E,he,A.r]}}else(x=T.match(/<f[^>]*\/>/))&&(E=$t(x[0]),me[E.si]&&(L.f=rK(me[E.si][1],me[E.si][2],A.r)));var de=Ys(A.r);for(b=0;b<fe.length;++b)de.r>=fe[b][0].s.r&&de.r<=fe[b][0].e.r&&de.c>=fe[b][0].s.c&&de.c<=fe[b][0].e.c&&(L.F=fe[b][1])}if(A.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(_)L.t="z";else continue;else L.t=A.t||"n";switch(h.s.c>C&&(h.s.c=C),h.e.c<C&&(h.e.c=C),L.t){case"n":if(L.v==""||L.v==null){if(!_)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!_)continue;L.t="z"}else O=d0[parseInt(L.v,10)],L.v=O.t,L.r=O.r,f.cellHTML&&(L.h=O.h);break;case"str":L.t="s",L.v=L.v!=null?Br(L.v):"",f.cellHTML&&(L.h=Hb(L.v));break;case"inlineStr":x=T.match(n),L.t="s",x!=null&&(O=Zb(x[1]))?(L.v=O.t,f.cellHTML&&(L.h=O.h)):L.v="";break;case"b":L.v=Xr(L.v);break;case"d":f.cellDates?L.v=es(L.v,1):(L.v=ta(es(L.v,1)),L.t="n");break;case"e":(!f||f.cellText!==!1)&&(L.w=L.v),L.v=jC[L.v];break}if(P=q=0,ne=null,M&&A.s!==void 0&&(ne=d.CellXf[A.s],ne!=null&&(ne.numFmtId!=null&&(P=ne.numFmtId),f.cellStyles&&ne.fillId!=null&&(q=ne.fillId))),i8(L,P,q,f,p,d),f.cellDates&&M&&L.t=="n"&&Ud(er[P])&&(L.t="d",L.v=Lx(L.v)),A.cm&&f.xlmeta){var je=(f.xlmeta.Cell||[])[+A.cm-1];je&&je.type=="XLDAPR"&&(L.D=!0)}if(re){var Y=Ys(A.r);u[Y.r]||(u[Y.r]=[]),u[Y.r][Y.c]=L}else u[A.r]=L}}}}G.length>0&&(u["!rows"]=G)}}();function VG(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}var KG=Ku;function GG(){}function YG(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=xH(e),r}function XG(e){var t=ai(e);return[t]}function JG(e){var t=Vu(e);return[t]}function QG(e){var t=ai(e),r=e.read_shift(1);return[t,r,"b"]}function ZG(e){var t=Vu(e),r=e.read_shift(1);return[t,r,"b"]}function eY(e){var t=ai(e),r=e.read_shift(1);return[t,r,"e"]}function tY(e){var t=Vu(e),r=e.read_shift(1);return[t,r,"e"]}function rY(e){var t=ai(e),r=e.read_shift(4);return[t,r,"s"]}function nY(e){var t=Vu(e),r=e.read_shift(4);return[t,r,"s"]}function sY(e){var t=ai(e),r=Cs(e);return[t,r,"n"]}function l8(e){var t=Vu(e),r=Cs(e);return[t,r,"n"]}function aY(e){var t=ai(e),r=Xb(e);return[t,r,"n"]}function iY(e){var t=Vu(e),r=Xb(e);return[t,r,"n"]}function oY(e){var t=ai(e),r=Gb(e);return[t,r,"is"]}function lY(e){var t=ai(e),r=Fs(e);return[t,r,"str"]}function cY(e){var t=Vu(e),r=Fs(e);return[t,r,"str"]}function uY(e,t,r){var n=e.l+t,s=ai(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=Rx(e,n-e.l,r);i[3]=Es(o,null,s,r.supbooks,r)}else e.l=n;return i}function fY(e,t,r){var n=e.l+t,s=ai(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=Rx(e,n-e.l,r);i[3]=Es(o,null,s,r.supbooks,r)}else e.l=n;return i}function dY(e,t,r){var n=e.l+t,s=ai(e);s.r=r["!row"];var a=Cs(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=Rx(e,n-e.l,r);i[3]=Es(o,null,s,r.supbooks,r)}else e.l=n;return i}function hY(e,t,r){var n=e.l+t,s=ai(e);s.r=r["!row"];var a=Fs(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=Rx(e,n-e.l,r);i[3]=Es(o,null,s,r.supbooks,r)}else e.l=n;return i}var pY=Ku;function mY(e,t){var r=e.l+t,n=Ku(e),s=Yb(e),a=Fs(e),i=Fs(e),o=Fs(e);e.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function gY(){}function xY(e,t,r){var n=e.l+t,s=_C(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=NG(e,n-e.l,r);i[1]=o}else e.l=n;return i}function vY(e,t,r){var n=e.l+t,s=Ku(e),a=[s];if(r.cellFormula){var i=kG(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}var yY=["left","right","top","bottom","header","footer"];function wY(e){var t={};return yY.forEach(function(r){t[r]=Cs(e)}),t}function bY(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function NY(){}function SY(){}function kY(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,d,m,g,w,x,y,b,S,T,L=[];o.biff=12,o["!row"]=0;var A=0,D=!1,C=[],O={},E=o.supbooks||s.supbooks||[[]];if(E.sharedf=O,E.arrayf=C,E.SheetNames=s.SheetNames||s.Sheets.map(function(re){return re.name}),!o.supbooks&&(o.supbooks=E,s.Names))for(var P=0;P<s.Names.length;++P)E[0][P+1]=s.Names[P];var q=[],M=[],ne=!1;Ug[16]={n:"BrtShortReal",f:l8};var fe;if(yl(e,function(G,ge,ve){if(!p)switch(ve){case 148:u=G;break;case 0:d=G,o.sheetRows&&o.sheetRows<=d.r&&(p=!0),S=hs(w=d.r),o["!row"]=d.r,(G.hidden||G.hpt||G.level!=null)&&(G.hpt&&(G.hpx=sp(G.hpt)),M[G.r]=G);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:G[2]},G[2]){case"n":m.v=G[1];break;case"s":b=d0[G[1]],m.v=b.t,m.r=b.r;break;case"b":m.v=!!G[1];break;case"e":m.v=G[1],o.cellText!==!1&&(m.w=Gu[m.v]);break;case"str":m.t="s",m.v=G[1];break;case"is":m.t="s",m.v=G[1].t;break}if((g=i.CellXf[G[0].iStyleRef])&&i8(m,g.numFmtId,null,o,a,i),x=G[0].c==-1?x+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][x]=m):l[Wn(x)+S]=m,o.cellFormula){for(D=!1,A=0;A<C.length;++A){var _=C[A];d.r>=_[0].s.r&&d.r<=_[0].e.r&&x>=_[0].s.c&&x<=_[0].e.c&&(m.F=pr(_[0]),D=!0)}!D&&G.length>3&&(m.f=G[3])}if(f.s.r>d.r&&(f.s.r=d.r),f.s.c>x&&(f.s.c=x),f.e.r<d.r&&(f.e.r=d.r),f.e.c<x&&(f.e.c=x),o.cellDates&&g&&m.t=="n"&&Ud(er[g.numFmtId])){var R=lu(m.v);R&&(m.t="d",m.v=new Date(R.y,R.m-1,R.d,R.H,R.M,R.S,R.u))}fe&&(fe.type=="XLDAPR"&&(m.D=!0),fe=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;m={t:"z",v:void 0},x=G[0].c==-1?x+1:G[0].c,o.dense?(l[w]||(l[w]=[]),l[w][x]=m):l[Wn(x)+S]=m,f.s.r>d.r&&(f.s.r=d.r),f.s.c>x&&(f.s.c=x),f.e.r<d.r&&(f.e.r=d.r),f.e.c<x&&(f.e.c=x),fe&&(fe.type=="XLDAPR"&&(m.D=!0),fe=void 0);break;case 176:L.push(G);break;case 49:fe=((o.xlmeta||{}).Cell||[])[G-1];break;case 494:var I=n["!id"][G.relId];for(I?(G.Target=I.Target,G.loc&&(G.Target+="#"+G.loc),G.Rel=I):G.relId==""&&(G.Target="#"+G.loc),w=G.rfx.s.r;w<=G.rfx.e.r;++w)for(x=G.rfx.s.c;x<=G.rfx.e.c;++x)o.dense?(l[w]||(l[w]=[]),l[w][x]||(l[w][x]={t:"z",v:void 0}),l[w][x].l=G):(y=Jt({c:x,r:w}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=G);break;case 426:if(!o.cellFormula)break;C.push(G),T=o.dense?l[w][x]:l[Wn(x)+S],T.f=Es(G[1],f,{r:d.r,c:x},E,o),T.F=pr(G[0]);break;case 427:if(!o.cellFormula)break;O[Jt(G[0].s)]=G[1],T=o.dense?l[w][x]:l[Wn(x)+S],T.f=Es(G[1],f,{r:d.r,c:x},E,o);break;case 60:if(!o.cellStyles)break;for(;G.e>=G.s;)q[G.e--]={width:G.w/256,hidden:!!(G.flags&1),level:G.level},ne||(ne=!0,e4(G.w/256)),_d(q[G.e+1]);break;case 161:l["!autofilter"]={ref:pr(G)};break;case 476:l["!margins"]=G;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),G.name&&(s.Sheets[r].CodeName=G.name),(G.above||G.left)&&(l["!outline"]={above:G.above,left:G.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),G.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!ge.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+ve.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=pr(u||f)),o.sheetRows&&l["!ref"]){var me=hn(l["!ref"]);o.sheetRows<=+me.e.r&&(me.e.r=o.sheetRows-1,me.e.r>f.e.r&&(me.e.r=f.e.r),me.e.r<me.s.r&&(me.s.r=me.e.r),me.e.c>f.e.c&&(me.e.c=f.e.c),me.e.c<me.s.c&&(me.s.c=me.e.c),l["!fullref"]=l["!ref"],l["!ref"]=pr(me))}return L.length>0&&(l["!merges"]=L),q.length>0&&(l["!cols"]=q),M.length>0&&(l["!rows"]=M),l}function _Y(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=vr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function EY(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,l=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=_Y(h);f.s.r=f.s.c=0,f.e.c=o,u=Wn(o),p[0].forEach(function(d,m){i[u+hs(m)]={t:"n",v:d,z:p[1]},l=m}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=pr(f)),i}function AY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(o8);return o&&r4(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function jY(e,t){e.l+=10;var r=Fs(e);return{name:r}}function TY(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return yl(e,function(l,u,f){switch(f){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var c8=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],CY=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],PY=[],LY=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Nk(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Xr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Sk(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Xr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function u8(e){Sk(e.WBProps,c8),Sk(e.CalcPr,LY),Nk(e.WBView,CY),Nk(e.Sheets,PY),ed.date1904=Xr(e.WBProps.date1904)}var FY="][*?/\\".split("");function DY(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return FY.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var RY=/<\w+:workbook/;function OY(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Is,function(l,u){var f=$t(l);switch(bo(f[0])){case"<?xml":break;case"<workbook":l.match(RY)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":c8.forEach(function(h){if(f[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Xr(f[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(f[h[0]],10);break;default:r.WBProps[h[0]]=f[h[0]]}}),f.codeName&&(r.WBProps.CodeName=Br(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=vr(Br(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Br(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),Xr(f.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=vr(Br(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),eH.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return u8(r),r}function IY(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Rw(e),r.name=Fs(e),r}function MY(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Fs(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function BY(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function UY(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=vH(e),i=SG(e,0,r),o=Yb(e);e.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function $Y(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ug[16]={n:"BrtFRTArchID$",f:BY},yl(e,function(l,u,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=Es(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),u8(r),r.Names=a,r.supbooks=i,r}function zY(e,t,r){return t.slice(-4)===".bin"?$Y(e,r):OY(e,r)}function HY(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?kY(e,n,r,s,a,i,o):IG(e,n,r,s,a,i,o)}function qY(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?TY(e,n,r,s,a):AY(e,n,r,s,a)}function WY(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?ZV():eK()}function VY(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?JV():QV()}function KY(e,t,r,n){return t.slice(-4)===".bin"?pV(e,r,n):lV(e,r,n)}function GY(e,t,r){return XC(e,r)}function YY(e,t,r){return t.slice(-4)===".bin"?CW(e,r):jW(e,r)}function XY(e,t,r){return t.slice(-4)===".bin"?GV(e,r):HV(e,r)}function JY(e,t,r){return t.slice(-4)===".bin"?UV(e):MV(e)}function QY(e,t,r,n){return r.slice(-4)===".bin"?$V(e,t,r,n):void 0}function ZY(e,t,r){return t.slice(-4)===".bin"?OV(e,t,r):IV(e,t,r)}var f8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,d8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function hi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(f8),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(d8),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function eX(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(f8),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(d8),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var p0;function tX(e,t){var r=p0[e]||vr(e);return r==="General"?Ru(t):ni(r,t)}function rX(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Xr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=es(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[vr(t)]=s}function nX(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Gu[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Z0(e.v):e.w=Ru(e.v):e.w=tX(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=p0[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ud(n)){var s=lu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function sX(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=rV[n.Pattern]||n.Pattern)}e[t.ID]=t}function aX(e,t,r,n,s,a,i,o,l,u){var f="General",h=n.StyleID,p={};u=u||{};var d=[],m=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&i&&(h=i.StyleID);a[h]!==void 0&&(a[h].nf&&(f=a[h].nf),a[h].Interior&&d.push(a[h].Interior),!!a[h].Parent);)h=a[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Xr(e);break;case"String":n.t="s",n.r=WS(vr(e)),n.v=e.indexOf("<")>-1?vr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(es(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=vr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jC[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=WS(t||e));break}if(nX(n,f,u),u.cellFormula!==!1)if(n.Formula){var g=vr(n.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),n.f=Zf(g,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Zf("RC:RC",s):n.ArrayRange&&(n.F=Zf(n.ArrayRange,s),l.push([hn(n.F),n.F]))}else for(m=0;m<l.length;++m)s.r>=l[m][0].s.r&&s.r<=l[m][0].e.r&&s.c>=l[m][0].s.c&&s.c<=l[m][0].e.c&&(n.F=l[m][1]);u.cellStyles&&(d.forEach(function(w){!p.patternType&&w.patternType&&(p.patternType=w.patternType)}),n.s=p),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iX(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function gv(e,t){var r=t||{};eC();var n=$h(qb(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Br(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=ds(r);return i.type="string",rp.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){s.indexOf("<"+it)>=0&&(a=!0)}),a)return mX(n,r);p0={"General Number":"General","General Date":er[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":er[15],"Short Date":er[14],"Long Time":er[19],"Medium Time":er[18],"Short Time":er[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:er[2],Standard:er[4],Percent:er[10],Scientific:er[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,f={},h=[],p=r.dense?[]:{},d="",m={},g={},w=hi('<Data ss:Type="String">'),x=0,y=0,b=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},T={},L={},A="",D=0,C=[],O={},E={},P=0,q=[],M=[],ne={},fe=[],me,re=!1,G=[],ge=[],ve={},_=0,R=0,I={Sheets:[],WBProps:{date1904:!1}},B={};tp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var W="";o=tp.exec(n);)switch(o[3]=(W=o[3]).toLowerCase()){case"data":if(W=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?aX(n.slice(x,o.index),A,w,l[l.length-1][0]=="comment"?ne:m,{c:y,r:b},T,fe[y],g,G,r):(A="",w=hi(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(M.length>0&&(m.c=M),(!r.sheetRows||r.sheetRows>b)&&m.v!==void 0&&(r.dense?(p[b]||(p[b]=[]),p[b][y]=m):p[Wn(y)+hs(b)]=m),m.HRef&&(m.l={Target:vr(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(_=y+(parseInt(m.MergeAcross,10)|0),R=b+(parseInt(m.MergeDown,10)|0),C.push({s:{c:y,r:b},e:{c:_,r:R}})),!r.sheetStubs)m.MergeAcross?y=_+1:++y;else if(m.MergeAcross||m.MergeDown){for(var se=y;se<=_;++se)for(var pe=b;pe<=R;++pe)(se>y||pe>b)&&(r.dense?(p[pe]||(p[pe]=[]),p[pe][se]={t:"z"}):p[Wn(se)+hs(pe)]={t:"z"});y=_+1}else++y;else m=eX(o[0]),m.Index&&(y=+m.Index-1),y<S.s.c&&(S.s.c=y),y>S.e.c&&(S.e.c=y),o[0].slice(-2)==="/>"&&++y,M=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<S.s.r&&(S.s.r=b),b>S.e.r&&(S.e.r=b),o[0].slice(-2)==="/>"&&(g=hi(o[0]),g.Index&&(b=+g.Index-1)),y=0,++b):(g=hi(o[0]),g.Index&&(b=+g.Index-1),ve={},(g.AutoFitHeight=="0"||g.Height)&&(ve.hpx=parseInt(g.Height,10),ve.hpt=YC(ve.hpx),ge[b]=ve),g.Hidden=="1"&&(ve.hidden=!0,ge[b]=ve));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(d),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(p["!ref"]=pr(S),r.sheetRows&&r.sheetRows<=S.e.r&&(p["!fullref"]=p["!ref"],S.e.r=r.sheetRows-1,p["!ref"]=pr(S))),C.length&&(p["!merges"]=C),fe.length>0&&(p["!cols"]=fe),ge.length>0&&(p["!rows"]=ge),f[d]=p}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=y=0,l.push([o[3],!1]),u=hi(o[0]),d=vr(u.Name),p=r.dense?[]:{},C=[],G=[],ge=[],B={name:d,Hidden:0},I.Sheets.push(B);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),fe=[],re=!1}break;case"style":o[1]==="/"?sX(T,L,r):L=hi(o[0]);break;case"numberformat":L.nf=vr(hi(o[0]).Format||"General"),p0[L.nf]&&(L.nf=p0[L.nf]);for(var he=0;he!=392&&er[he]!=L.nf;++he);if(he==392){for(he=57;he!=392;++he)if(er[he]==null){Su(L.nf,he);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(me=hi(o[0]),me.Hidden&&(me.hidden=!0,delete me.Hidden),me.Width&&(me.wpx=parseInt(me.Width,10)),!re&&me.wpx>10){re=!0,Vs=KC;for(var de=0;de<fe.length;++de)fe[de]&&_d(fe[de])}re&&_d(me),fe[me.Index-1||fe.length]=me;for(var je=0;je<+me.Span;++je)fe[fe.length]=ds(me);break;case"namedrange":if(o[1]==="/")break;I.Names||(I.Names=[]);var Y=$t(o[0]),We={Name:Y.Name,Ref:Zf(Y.RefersTo.slice(1),{r:0,c:0})};I.Sheets.length>0&&(We.Sheet=I.Sheets.length-1),I.Names.push(We);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(D,o.index):D=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;L.Interior=hi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?HH(O,W,n.slice(P,o.index)):P=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));iX(ne),M.push(ne)}else l.push([o[3],!1]),u=hi(o[0]),ne={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ke=hi(o[0]);p["!autofilter"]={ref:Zf(Ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return Tk(n,r);var J=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(o[3]){case"date1904":I.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:J=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(P,o.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else P=o.index+o[0].length;break;case"header":p["!margins"]||h0(p["!margins"]={},"xlml"),isNaN(+$t(o[0]).Margin)||(p["!margins"].header=+$t(o[0]).Margin);break;case"footer":p["!margins"]||h0(p["!margins"]={},"xlml"),isNaN(+$t(o[0]).Margin)||(p["!margins"].footer=+$t(o[0]).Margin);break;case"pagemargins":var ze=$t(o[0]);p["!margins"]||h0(p["!margins"]={},"xlml"),isNaN(+ze.Top)||(p["!margins"].top=+ze.Top),isNaN(+ze.Left)||(p["!margins"].left=+ze.Left),isNaN(+ze.Right)||(p["!margins"].right=+ze.Right),isNaN(+ze.Bottom)||(p["!margins"].bottom=+ze.Bottom);break;case"displayrighttoleft":I.Views||(I.Views=[]),I.Views[0]||(I.Views[0]={}),I.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:J=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:J=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:J=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:J=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1;break}if(J||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?rX(E,W,q,n.slice(P,o.index)):(q=o,P=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=f),He.SheetNames=h,He.Workbook=I,He.SSF=ds(er),He.Props=O,He.Custprops=E,He}function Bw(e,t){switch(a4(t=t||{}),t.type||"base64"){case"base64":return gv(Ra(e),t);case"binary":case"buffer":case"file":return gv(e,t);case"array":return gv(Wu(e),t)}}function oX(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=bH(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=NH(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var lX=[60,1084,2066,2165,2175];function cX(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=tl(r,r.l),u=Uw[l],f=0;u!=null&&lX.indexOf(l)>-1;)a=tl(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,u=Uw[l=tl(r,r.l)];var h=Xl(i);cs(h,0);var p=0;h.lens=[];for(var d=0;d<i.length;++d)h.lens.push(p),p+=i[d].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,s)}function Ji(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=er[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Gu[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Z0(e.v):e.w=Ru(e.v):e.w=ni(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Ud(er[n]||String(n))){var s=lu(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Qm(e,t,r){return{v:e,ixfe:t,t:r}}function uX(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,l=[],u="",f={},h,p="",d,m,g,w,x={},y=[],b,S,T=[],L=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},D={},C=function(nt){return nt<8?ku[nt]:nt<64&&L[nt-8]||ku[nt]},O=function(nt,at,ar){var Ct=at.XF.data;if(!(!Ct||!Ct.patternType||!ar||!ar.cellStyles)){at.s={},at.s.patternType=Ct.patternType;var Ot;(Ot=np(C(Ct.icvFore)))&&(at.s.fgColor={rgb:Ot}),(Ot=np(C(Ct.icvBack)))&&(at.s.bgColor={rgb:Ot})}},E=function(nt,at,ar){if(!(ve>1)&&!(ar.sheetRows&&nt.r>=ar.sheetRows)){if(ar.cellStyles&&at.XF&&at.XF.data&&O(nt,at,ar),delete at.ixfe,delete at.XF,h=nt,p=Jt(nt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),nt.r<i.s.r&&(i.s.r=nt.r),nt.c<i.s.c&&(i.s.c=nt.c),nt.r+1>i.e.r&&(i.e.r=nt.r+1),nt.c+1>i.e.c&&(i.e.c=nt.c+1),ar.cellFormula&&at.f){for(var Ct=0;Ct<y.length;++Ct)if(!(y[Ct][0].s.c>nt.c||y[Ct][0].s.r>nt.r)&&!(y[Ct][0].e.c<nt.c||y[Ct][0].e.r<nt.r)){at.F=pr(y[Ct][0]),(y[Ct][0].s.c!=nt.c||y[Ct][0].s.r!=nt.r)&&delete at.f,at.f&&(at.f=""+Es(y[Ct][1],i,nt,G,P));break}}ar.dense?(s[nt.r]||(s[nt.r]=[]),s[nt.r][nt.c]=at):s[p]=at}},P={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(P.password=t.password);var q,M=[],ne=[],fe=[],me=[],re=!1,G=[];G.SheetNames=P.snames,G.sharedf=P.sharedf,G.arrayf=P.arrayf,G.names=[],G.XTI=[];var ge=0,ve=0,_=0,R=[],I=[],B;P.codepage=1200,Ti(1200);for(var W=!1;e.l<e.length-1;){var se=e.l,pe=e.read_shift(2);if(pe===0&&ge===10)break;var he=e.l===e.length?0:e.read_shift(2),de=Uw[pe];if(de&&de.f){if(t.bookSheets&&ge===133&&pe!==133)break;if(ge=pe,de.r===2||de.r==12){var je=e.read_shift(2);if(he-=2,!P.enc&&je!==pe&&((je&255)<<8|je>>8)!==pe)throw new Error("rt mismatch: "+je+"!="+pe);de.r==12&&(e.l+=10,he-=10)}var Y={};if(pe===10?Y=de.f(e,he,P):Y=cX(pe,de,e,he,P),ve==0&&[9,521,1033,2057].indexOf(ge)===-1)continue;switch(pe){case 34:r.opts.Date1904=A.WBProps.date1904=Y;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(P.enc||(e.l=0),P.enc=Y,!t.password)throw new Error("File is password-protected");if(Y.valid==null)throw new Error("Encryption scheme unsupported");if(!Y.valid)throw new Error("Password is incorrect");break;case 92:P.lastuser=Y;break;case 66:var We=Number(Y);switch(We){case 21010:We=1200;break;case 32768:We=1e4;break;case 32769:We=1252;break}Ti(P.codepage=We),W=!0;break;case 317:P.rrtabid=Y;break;case 25:P.winlocked=Y;break;case 439:r.opts.RefreshAll=Y;break;case 12:r.opts.CalcCount=Y;break;case 16:r.opts.CalcDelta=Y;break;case 17:r.opts.CalcIter=Y;break;case 13:r.opts.CalcMode=Y;break;case 14:r.opts.CalcPrecision=Y;break;case 95:r.opts.CalcSaveRecalc=Y;break;case 15:P.CalcRefMode=Y;break;case 2211:r.opts.FullCalc=Y;break;case 129:Y.fDialog&&(s["!type"]="dialog"),Y.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),Y.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:T.push(Y);break;case 430:G.push([Y]),G[G.length-1].XTI=[];break;case 35:case 547:G[G.length-1].push(Y);break;case 24:case 536:B={Name:Y.Name,Ref:Es(Y.rgce,i,null,G,P)},Y.itab>0&&(B.Sheet=Y.itab-1),G.names.push(B),G[0]||(G[0]=[],G[0].XTI=[]),G[G.length-1].push(Y),Y.Name=="_xlnm._FilterDatabase"&&Y.itab>0&&Y.rgce&&Y.rgce[0]&&Y.rgce[0][0]&&Y.rgce[0][0][0]=="PtgArea3d"&&(I[Y.itab-1]={ref:pr(Y.rgce[0][0][1][2])});break;case 22:P.ExternCount=Y;break;case 23:G.length==0&&(G[0]=[],G[0].XTI=[]),G[G.length-1].XTI=G[G.length-1].XTI.concat(Y),G.XTI=G.XTI.concat(Y);break;case 2196:if(P.biff<8)break;B!=null&&(B.Comment=Y[1]);break;case 18:s["!protect"]=Y;break;case 19:Y!==0&&P.WTF&&console.error("Password verifier: "+Y);break;case 133:a[Y.pos]=Y,P.snames.push(Y.name);break;case 10:{if(--ve)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=pr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ke=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=pr(i),i.e.r=Ke}i.e.r++,i.e.c++}M.length>0&&(s["!merges"]=M),ne.length>0&&(s["!objects"]=ne),fe.length>0&&(s["!cols"]=fe),me.length>0&&(s["!rows"]=me),A.Sheets.push(D)}u===""?f=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(P.biff===8&&(P.biff={9:2,521:3,1033:4}[pe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Y.BIFFVer]||8),P.biffguess=Y.BIFFVer==0,Y.BIFFVer==0&&Y.dt==4096&&(P.biff=5,W=!0,Ti(P.codepage=28591)),P.biff==8&&Y.BIFFVer==0&&Y.dt==16&&(P.biff=2),ve++)break;if(s=t.dense?[]:{},P.biff<8&&!W&&(W=!0,Ti(P.codepage=t.codepage||1252)),P.biff<5||Y.BIFFVer==0&&Y.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-he,name:u};a[J.pos]=J,P.snames.push(u)}else u=(a[se]||{name:""}).name;Y.dt==32&&(s["!type"]="chart"),Y.dt==64&&(s["!type"]="macro"),M=[],ne=[],P.arrayf=y=[],fe=[],me=[],re=!1,D={Hidden:(a[se]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[Y.r]||[])[Y.c]:s[Jt({c:Y.c,r:Y.r})])&&++Y.c,b={ixfe:Y.ixfe,XF:T[Y.ixfe]||{},v:Y.val,t:"n"},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t);break;case 5:case 517:b={ixfe:Y.ixfe,XF:T[Y.ixfe],v:Y.val,t:Y.t},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t);break;case 638:b={ixfe:Y.ixfe,XF:T[Y.ixfe],v:Y.rknum,t:"n"},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t);break;case 189:for(var ze=Y.c;ze<=Y.C;++ze){var He=Y.rkrec[ze-Y.c][0];b={ixfe:He,XF:T[He],v:Y.rkrec[ze-Y.c][1],t:"n"},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:ze,r:Y.r},b,t)}break;case 6:case 518:case 1030:{if(Y.val=="String"){o=Y;break}if(b=Qm(Y.val,Y.cell.ixfe,Y.tt),b.XF=T[b.ixfe],t.cellFormula){var it=Y.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var qe=it[0][0][1][0],ht=it[0][0][1][1],ct=Jt({r:qe,c:ht});x[ct]?b.f=""+Es(Y.formula,i,Y.cell,G,P):b.F=((t.dense?(s[qe]||[])[ht]:s[ct])||{}).F}else b.f=""+Es(Y.formula,i,Y.cell,G,P)}_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E(Y.cell,b,t),o=Y}break;case 7:case 519:if(o)o.val=Y,b=Qm(Y,o.cell.ixfe,"s"),b.XF=T[b.ixfe],t.cellFormula&&(b.f=""+Es(o.formula,i,o.cell,G,P)),_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E(o.cell,b,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(Y);var Et=Jt(Y[0].s);if(d=t.dense?(s[Y[0].s.r]||[])[Y[0].s.c]:s[Et],t.cellFormula&&d){if(!o||!Et||!d)break;d.f=""+Es(Y[1],i,Y[0],G,P),d.F=pr(Y[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;x[Jt(o.cell)]=Y[0],d=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Jt(o.cell)],(d||{}).f=""+Es(Y[0],i,h,G,P)}}break;case 253:b=Qm(l[Y.isst].t,Y.ixfe,"s"),l[Y.isst].h&&(b.h=l[Y.isst].h),b.XF=T[b.ixfe],_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t);break;case 513:t.sheetStubs&&(b={ixfe:Y.ixfe,XF:T[Y.ixfe],t:"z"},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t));break;case 190:if(t.sheetStubs)for(var xt=Y.c;xt<=Y.C;++xt){var Ht=Y.ixfe[xt-Y.c];b={ixfe:Ht,XF:T[Ht],t:"z"},_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:xt,r:Y.r},b,t)}break;case 214:case 516:case 4:b=Qm(Y.val,Y.ixfe,"s"),b.XF=T[b.ixfe],_>0&&(b.z=R[b.ixfe>>8&63]),Ji(b,t,r.opts.Date1904),E({c:Y.c,r:Y.r},b,t);break;case 0:case 512:ve===1&&(i=Y);break;case 252:l=Y;break;case 1054:if(P.biff==4){R[_++]=Y[1];for(var Mt=0;Mt<_+163&&er[Mt]!=Y[1];++Mt);Mt>=163&&Su(Y[1],_+163)}else Su(Y[1],Y[0]);break;case 30:{R[_++]=Y;for(var Ft=0;Ft<_+163&&er[Ft]!=Y;++Ft);Ft>=163&&Su(Y,_+163)}break;case 229:M=M.concat(Y);break;case 93:ne[Y.cmo[0]]=P.lastobj=Y;break;case 438:P.lastobj.TxO=Y;break;case 127:P.lastobj.ImData=Y;break;case 440:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(g=Y[0].s.c;g<=Y[0].e.c;++g)d=t.dense?(s[w]||[])[g]:s[Jt({c:g,r:w})],d&&(d.l=Y[1]);break;case 2048:for(w=Y[0].s.r;w<=Y[0].e.r;++w)for(g=Y[0].s.c;g<=Y[0].e.c;++g)d=t.dense?(s[w]||[])[g]:s[Jt({c:g,r:w})],d&&d.l&&(d.l.Tooltip=Y[1]);break;case 28:{if(P.biff<=5&&P.biff>=2)break;d=t.dense?(s[Y[0].r]||[])[Y[0].c]:s[Jt(Y[0])];var Yt=ne[Y[2]];d||(t.dense?(s[Y[0].r]||(s[Y[0].r]=[]),d=s[Y[0].r][Y[0].c]={t:"z"}):d=s[Jt(Y[0])]={t:"z"},i.e.r=Math.max(i.e.r,Y[0].r),i.s.r=Math.min(i.s.r,Y[0].r),i.e.c=Math.max(i.e.c,Y[0].c),i.s.c=Math.min(i.s.c,Y[0].c)),d.c||(d.c=[]),m={a:Y[1],t:Yt.TxO.t},d.c.push(m)}break;case 2173:LV(T[Y.ixfe],Y.ext);break;case 125:{if(!P.cellStyles)break;for(;Y.e>=Y.s;)fe[Y.e--]={width:Y.w/256,level:Y.level||0,hidden:!!(Y.flags&1)},re||(re=!0,e4(Y.w/256)),_d(fe[Y.e+1])}break;case 520:{var Lt={};Y.level!=null&&(me[Y.r]=Lt,Lt.level=Y.level),Y.hidden&&(me[Y.r]=Lt,Lt.hidden=!0),Y.hpt&&(me[Y.r]=Lt,Lt.hpt=Y.hpt,Lt.hpx=sp(Y.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||h0(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[pe]]=Y;break;case 161:s["!margins"]||h0(s["!margins"]={}),s["!margins"].header=Y.header,s["!margins"].footer=Y.footer;break;case 574:Y.RTL&&(A.Views[0].RTL=!0);break;case 146:L=Y;break;case 2198:q=Y;break;case 140:S=Y;break;case 442:u?D.CodeName=Y||D.name:A.WBProps.CodeName=Y||"ThisWorkbook";break}}else de||console.error("Missing Info for XLS Record 0x"+pe.toString(16)),e.l+=he}return r.SheetNames=yo(a).sort(function(pt,nt){return Number(pt)-Number(nt)}).map(function(pt){return a[pt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&I.forEach(function(pt,nt){r.Sheets[r.SheetNames[nt]]["!autofilter"]=pt}),r.Strings=l,r.SSF=ds(er),P.enc&&(r.Encryption=P.enc),q&&(r.Themes=q),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),G.names.length>0&&(A.Names=G.names),r.Workbook=A,r}var kk={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function fX(e,t,r){var n=hr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ok(n,jH,kk.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=hr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=ok(i,TH,kk.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(CC(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function h8(e,t){t||(t={}),a4(t),zT(),t.codepage&&Ib(t.codepage);var r,n;if(e.FullPaths){if(hr.find(e,"/encryption"))throw new Error("File is password-protected");r=hr.find(e,"!CompObj"),n=hr.find(e,"/Workbook")||hr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ai(Ra(e));break;case"binary":e=Ai(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}cs(e,0),n={content:e}}var s,a;if(r&&oX(r),t.bookProps&&!t.bookSheets)s={};else{var i=ur?"buffer":"array";if(n&&n.content)s=uX(n.content,t);else if((a=hr.find(e,"PerfectOffice_MAIN"))&&a.content)s=f0.to_workbook(a.content,(t.type=i,t));else if((a=hr.find(e,"NativeContent_MAIN"))&&a.content)s=f0.to_workbook(a.content,(t.type=i,t));else throw(a=hr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&hr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=XV(e))}var o={};return e.FullPaths&&fX(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}var Ug={0:{f:VG},1:{f:XG},2:{f:aY},3:{f:eY},4:{f:QG},5:{f:sY},6:{f:lY},7:{f:rY},8:{f:hY},9:{f:dY},10:{f:uY},11:{f:fY},12:{f:JG},13:{f:iY},14:{f:tY},15:{f:ZG},16:{f:l8},17:{f:cY},18:{f:nY},19:{f:Gb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:UY},40:{},42:{},43:{f:uV},44:{f:cV},45:{f:fV},46:{f:hV},47:{f:dV},48:{},49:{f:pH},50:{},51:{f:DV},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:zC},62:{f:oY},63:{f:BV},64:{f:NY},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:bY},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:YG},148:{f:KG,p:16},151:{f:gY},152:{},153:{f:MY},154:{},155:{},156:{f:IY},157:{},158:{},159:{T:1,f:TW},160:{T:-1},161:{T:1,f:Ku},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:pY},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FV},336:{T:-1},337:{f:RV,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Rw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:$C},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:xY},427:{f:vY},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:wY},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GG},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:mY},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Rw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:KV},633:{T:1},634:{T:-1},635:{T:1,f:VV},636:{T:-1},637:{f:gH},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:jY},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:SY},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Uw={6:{f:pv},10:{f:Ml},12:{f:Pn},13:{f:Pn},14:{f:vn},15:{f:vn},16:{f:Cs},17:{f:vn},18:{f:vn},19:{f:Pn},20:{f:fk},21:{f:fk},23:{f:$C},24:{f:hk},25:{f:vn},26:{},27:{},28:{f:qq},29:{},34:{f:vn},35:{f:dk},38:{f:Cs},39:{f:Cs},40:{f:Cs},41:{f:Cs},42:{f:vn},43:{f:vn},47:{f:GW},49:{f:_q},51:{f:Pn},60:{},61:{f:Nq},64:{f:vn},65:{f:kq},66:{f:Pn},77:{},80:{},81:{},82:{},85:{f:Pn},89:{},90:{},91:{},92:{f:pq},93:{f:Vq},94:{},95:{f:vn},96:{},97:{},99:{f:vn},125:{f:zC},128:{f:Rq},129:{f:mq},130:{f:Pn},131:{f:vn},132:{f:vn},133:{f:gq},134:{},140:{f:Qq},141:{f:Pn},144:{},146:{f:eW},151:{},152:{},153:{},154:{},155:{},156:{f:Pn},157:{},158:{},160:{f:aW},161:{f:rW},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Pq},190:{f:Lq},193:{f:Ml},197:{},198:{},199:{},200:{},201:{},202:{f:vn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Pn},220:{},221:{f:vn},222:{},224:{f:Dq},225:{f:hq},226:{f:Ml},227:{},229:{f:Wq},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:xq},253:{f:Eq},255:{f:vq},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:RC},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:vn},353:{f:Ml},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Iq},431:{f:vn},432:{},433:{},434:{},437:{},438:{f:Yq},439:{f:vn},440:{f:Xq},441:{},442:{f:Tp},443:{},444:{f:Pn},445:{},446:{},448:{f:Ml},449:{f:bq,r:2},450:{f:Ml},512:{f:ck},513:{f:sW},515:{f:Oq},516:{f:Aq},517:{f:uk},519:{f:iW},520:{f:yq},523:{},545:{f:pk},549:{f:lk},566:{},574:{f:Sq},638:{f:Cq},659:{},1048:{},1054:{f:jq},1084:{},1212:{f:$q},2048:{f:Jq},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Ym},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ml},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:tW,r:12},2173:{f:PV,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:vn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Uq,r:12},2197:{},2198:{f:_V,r:12},2199:{},2200:{},2201:{},2202:{f:zq,r:12},2203:{f:Ml},2204:{},2205:{},2206:{},2207:{},2211:{f:wq},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Pn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:nW},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Zq},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ck},1:{},2:{f:uW},3:{f:cW},4:{f:lW},5:{f:uk},7:{f:fW},8:{},9:{f:Ym},11:{},22:{f:Pn},30:{f:Tq},31:{},32:{},33:{f:pk},36:{},37:{f:lk},50:{f:dW},62:{},52:{},67:{},68:{f:Pn},69:{},86:{},126:{},127:{f:oW},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hW},223:{},234:{},354:{},421:{},518:{f:pv},521:{f:Ym},536:{f:hk},547:{f:dk},561:{},579:{},1030:{f:pv},1033:{f:Ym},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function pi(e,t,r,n){var s=t;if(!isNaN(s)){var a=(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&NC(r)&&e.push(r)}}function _k(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,l=Oz(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,h=0,p=0,d={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var g=l[i].trim(),w=g.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(w!="<td"&&w!="<th")){var x=g.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var y=x[o].trim();if(y.match(/<t[dh]/i)){for(var b=y,S=0;b.charAt(0)=="<"&&(S=b.indexOf(">"))>-1;)b=b.slice(S+1);for(var T=0;T<m.length;++T){var L=m[T];L.s.c==f&&L.s.r<u&&u<=L.e.r&&(f=L.e.c+1,T=-1)}var A=$t(y.slice(0,y.indexOf(">")));p=A.colspan?+A.colspan:1,((h=+A.rowspan)>1||p>1)&&m.push({s:{r:u,c:f},e:{r:u+(h||1)-1,c:f+p-1}});var D=A.t||A["data-t"]||"";if(!b.length){f+=p;continue}if(b=cC(b),d.s.r>u&&(d.s.r=u),d.e.r<u&&(d.e.r=u),d.s.c>f&&(d.s.c=f),d.e.c<f&&(d.e.c=f),!b.length){f+=p;continue}var C={t:"s",v:b};r.raw||!b.trim().length||D=="s"||(b==="TRUE"?C={t:"b",v:!0}:b==="FALSE"?C={t:"b",v:!1}:isNaN(Di(b))?isNaN(kd(b).getDate())||(C={t:"d",v:es(b)},r.cellDates||(C={t:"n",v:ta(C.v)}),C.z=r.dateNF||er[14]):C={t:"n",v:Di(b)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=C):n[Jt({r:u,c:f})]=C,f+=p}}}}return n["!ref"]=pr(d),m.length&&(n["!merges"]=m),n}function dX(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var f=Jt({r,c:i}),h=n.dense?(e[r]||[])[i]:e[f],p=h&&h.v!=null&&(h.h||Hb(h.w||(ml(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),d.id=(n.id||"sjs")+"-"+f,a.push(Qz("td",p,d))}}var m="<tr>";return m+a.join("")+"</tr>"}var hX='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',pX="</body></html>";function mX(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Rc(_k(r[0],t),t);var n=o4();return r.forEach(function(s,a){l4(n,_k(s,t),"Sheet"+(a+1))}),n}function gX(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function xX(e,t){var r=t||{},n=r.header!=null?r.header:hX,s=r.footer!=null?r.footer:pX,a=[n],i=$d(e["!ref"]);r.dense=Array.isArray(e),a.push(gX(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(dX(e,i,o,r));return a.push("</table>"+s),a.join("")}function p8(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Ys(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=$d(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var h=[],p=0,d=e["!rows"]||(e["!rows"]=[]),m=0,g=0,w=0,x=0,y=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&g<l;++m){var S=o[m];if(Ek(S)){if(n.display)continue;d[g]={hidden:!0}}var T=S.children;for(w=x=0;w<T.length;++w){var L=T[w];if(!(n.display&&Ek(L))){var A=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):cC(L.innerHTML),D=L.getAttribute("data-z")||L.getAttribute("z");for(p=0;p<h.length;++p){var C=h[p];C.s.c==x+a&&C.s.r<g+s&&g+s<=C.e.r&&(x=C.e.c+1-a,p=-1)}b=+L.getAttribute("colspan")||1,((y=+L.getAttribute("rowspan")||1)>1||b>1)&&h.push({s:{r:g+s,c:x+a},e:{r:g+s+(y||1)-1,c:x+a+(b||1)-1}});var O={t:"s",v:A},E=L.getAttribute("data-t")||L.getAttribute("t")||"";A!=null&&(A.length==0?O.t=E||"z":n.raw||A.trim().length==0||E=="s"||(A==="TRUE"?O={t:"b",v:!0}:A==="FALSE"?O={t:"b",v:!1}:isNaN(Di(A))?isNaN(kd(A).getDate())||(O={t:"d",v:es(A)},n.cellDates||(O={t:"n",v:ta(O.v)}),O.z=n.dateNF||er[14]):O={t:"n",v:Di(A)})),O.z===void 0&&D!=null&&(O.z=D);var P="",q=L.getElementsByTagName("A");if(q&&q.length)for(var M=0;M<q.length&&!(q[M].hasAttribute("href")&&(P=q[M].getAttribute("href"),P.charAt(0)!="#"));++M);P&&P.charAt(0)!="#"&&(O.l={Target:P}),n.dense?(e[g+s]||(e[g+s]=[]),e[g+s][x+a]=O):e[Jt({c:x+a,r:g+s})]=O,u.e.c<x+a&&(u.e.c=x+a),x+=b}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+s),e["!ref"]=pr(u),g>=l&&(e["!fullref"]=pr((u.e.r=o.length-m+g-1+s,u))),e}function m8(e,t){var r=t||{},n=r.dense?[]:{};return p8(n,e,t)}function vX(e,t){return Rc(m8(e,t),t)}function Ek(e){var t="",r=yX(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function yX(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function wX(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=vr(t.replace(/<[^>]*>/g,""));return[r]}var Ak={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function g8(e,t){var r=t||{},n=qb(e),s=[],a,i,o={name:""},l="",u=0,f,h,p={},d=[],m=r.dense?[]:{},g,w,x={value:""},y="",b=0,S=[],T=-1,L=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},D=0,C={},O=[],E={},P=0,q=0,M=[],ne=1,fe=1,me=[],re={Names:[]},G={},ge=["",""],ve=[],_={},R="",I=0,B=!1,W=!1,se=0;for(tp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=tp.exec(n);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?m["!ref"]=pr(A):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(m["!fullref"]=m["!ref"],A.e.r=r.sheetRows-1,m["!ref"]=pr(A)),O.length&&(m["!merges"]=O),M.length&&(m["!rows"]=M),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),d.push(f.name),p[f.name]=m,W=!1):g[0].charAt(g[0].length-2)!=="/"&&(f=$t(g[0],!1),T=L=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,m=r.dense?[]:{},O=[],M=[],W=!0);break;case"table-row-group":g[1]==="/"?--D:++D;break;case"table-row":case"":if(g[1]==="/"){T+=ne,ne=1;break}if(h=$t(g[0],!1),h.?T=h.-1:T==-1&&(T=0),ne=+h["number-rows-repeated"]||1,ne<10)for(se=0;se<ne;++se)D>0&&(M[T+se]={level:D});L=-1;break;case"covered-table-cell":g[1]!=="/"&&++L,r.sheetStubs&&(r.dense?(m[T]||(m[T]=[]),m[T][L]={t:"z"}):m[Jt({r:T,c:L})]={t:"z"}),y="",S=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++L,x=$t(g[0],!1),fe=parseInt(x["number-columns-repeated"]||"1",10),w={t:"z",v:null},x.formula&&r.cellFormula!=!1&&(w.f=bk(vr(x.formula))),(x.||x["value-type"])=="string"&&(w.t="s",w.v=vr(x["string-value"]||""),r.dense?(m[T]||(m[T]=[]),m[T][L]=w):m[Jt({r:T,c:L})]=w),L+=fe-1;else if(g[1]!=="/"){++L,y="",b=0,S=[],fe=1;var pe=ne?T+ne-1:T;if(L>A.e.c&&(A.e.c=L),L<A.s.c&&(A.s.c=L),T<A.s.r&&(A.s.r=T),pe>A.e.r&&(A.e.r=pe),x=$t(g[0],!1),ve=[],_={},w={t:x.||x["value-type"],v:null},r.cellFormula)if(x.formula&&(x.formula=vr(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(P=parseInt(x["number-matrix-rows-spanned"],10)||0,q=parseInt(x["number-matrix-columns-spanned"],10)||0,E={s:{r:T,c:L},e:{r:T+P-1,c:L+q-1}},w.F=pr(E),me.push([E,w.F])),x.formula)w.f=bk(x.formula);else for(se=0;se<me.length;++se)T>=me[se][0].s.r&&T<=me[se][0].e.r&&L>=me[se][0].s.c&&L<=me[se][0].e.c&&(w.F=me[se][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(P=parseInt(x["number-rows-spanned"],10)||0,q=parseInt(x["number-columns-spanned"],10)||0,E={s:{r:T,c:L},e:{r:T+P-1,c:L+q-1}},O.push(E)),x["number-columns-repeated"]&&(fe=parseInt(x["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Xr(x["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(x.value);break;case"percentage":w.t="n",w.v=parseFloat(x.value);break;case"currency":w.t="n",w.v=parseFloat(x.value);break;case"date":w.t="d",w.v=es(x["date-value"]),r.cellDates||(w.t="n",w.v=ta(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Fz(x["time-value"])/86400,r.cellDates&&(w.t="d",w.v=Lx(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(x.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",x["string-value"]!=null&&(y=vr(x["string-value"]),S=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(B=!1,w.t==="s"&&(w.v=y||"",S.length&&(w.R=S),B=b==0),G.Target&&(w.l=G),ve.length>0&&(w.c=ve,ve=[]),y&&r.cellText!==!1&&(w.w=y),B&&(w.t="z",delete w.v),(!B||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=T))for(var he=0;he<ne;++he){if(fe=parseInt(x["number-columns-repeated"]||"1",10),r.dense)for(m[T+he]||(m[T+he]=[]),m[T+he][L]=he==0?w:ds(w);--fe>0;)m[T+he][L+fe]=ds(w);else for(m[Jt({r:T+he,c:L})]=w;--fe>0;)m[Jt({r:T+he,c:L+fe})]=ds(w);A.e.c<=L&&(A.e.c=L)}fe=parseInt(x["number-columns-repeated"]||"1",10),L+=fe-1,fe=0,w={},y="",S=[]}G={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a;_.t=y,S.length&&(_.R=S),_.a=R,ve.push(_)}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);R="",I=0,y="",b=0,S=[];break;case"creator":g[1]==="/"?R=n.slice(I,g.index):I=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&s.push([g[3],!1]);y="",b=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(C[o.name]=l,(a=s.pop())[0]!==g[3])throw"Bad state: "+a}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=$t(g[0],!1),s.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=$t(g[0],!1),l+=Ak[g[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=$t(g[0],!1),l+=Ak[g[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":i=$t(g[0],!1),ge=mv(i["cell-range-address"]);var de={Name:i.name,Ref:ge[0]+"!"+ge[1]};W&&(de.Sheet=d.length),re.Names.push(de);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(g[1]==="/"&&(!x||!x["string-value"])){var je=wX(n.slice(b,g.index));y=(y.length>0?y+`
`:"")+je[0]}else $t(g[0],!1),b=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{ge=mv($t(g[0])["target-range-address"]),p[ge[0]]["!autofilter"]={ref:ge[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(G=$t(g[0],!1),!G.href)break;G.Target=vr(G.href),delete G.href,G.Target.charAt(0)=="#"&&G.Target.indexOf(".")>-1?(ge=mv(G.Target.slice(1)),G.Target="#"+ge[0]+"!"+ge[1]):G.Target.match(/^\.\.[\\\/]/)&&(G.Target=G.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(g)}}var Y={Sheets:p,SheetNames:d,Workbook:re};return r.bookSheets&&delete Y.Sheets,Y}function jk(e,t){t=t||{},Va(e,"META-INF/manifest.xml")&&OH(Cn(e,"META-INF/manifest.xml"),t);var r=Ta(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=g8(Br(r),t);return Va(e,"meta.xml")&&(n.Props=TC(Cn(e,"meta.xml"))),n}function Tk(e,t){return g8(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function n4(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function $w(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Br(Wu(e))}function zw(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function Ck(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function bX(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ap(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Kn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Ls(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=ap(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=ap(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function s4(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function NX(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=ap(e,n),a=Ls(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Kn(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Ls(o.data),u=Kn(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Kn(a[3][0].data)>>>0>0),r.push(i)}return r}function SX(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=ap(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[zw(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var f=zw(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function kX(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(SX(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return zw(t)}function _X(e,t,r,n){var s=n4(e),a=s.getUint32(4,!0),i=(n>1?12:8)+Ck(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Ck(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function EX(e,t,r){var n=n4(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,f=new Date(2001,0,1);s&1&&(l=bX(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:f};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(i>-1)h={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return h}function AX(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return _X(e,t,r,e[0]);case 5:return EX(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function bc(e){var t=Ls(e);return ap(t[1][0].data)}function Pk(e,t){var r=Ls(t.data),n=Kn(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Ls(i.data),l=Kn(o[1][0].data)>>>0;switch(n){case 1:a[l]=$w(o[3][0].data);break;case 8:{var u=e[bc(o[9][0].data)][0],f=Ls(u.data),h=e[bc(f[1][0].data)][0],p=Kn(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var d=Ls(h.data);a[l]=d[3].map(function(m){return $w(m.data)}).join("")}break}}),a}function jX(e,t){var r,n,s,a,i,o,l,u,f,h,p,d,m,g,w=Ls(e),x=Kn(w[1][0].data)>>>0,y=Kn(w[2][0].data)>>>0,b=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Kn(w[8][0].data)>0||!1,S,T;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)S=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,T=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(f=w[4])==null?void 0:f[0])!=null&&h.data&&t!=1)S=(d=(p=w[4])==null?void 0:p[0])==null?void 0:d.data,T=(g=(m=w[3])==null?void 0:m[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=b?4:1,A=n4(S),D=[],C=0;C<S.length/2;++C){var O=A.getUint16(C*2,!0);O<65535&&D.push([C,O])}if(D.length!=y)throw"Expected ".concat(y," cells, found ").concat(D.length);var E=[];for(C=0;C<D.length-1;++C)E[D[C][0]]=T.subarray(D[C][1]*L,D[C+1][1]*L);return D.length>=1&&(E[D[D.length-1][0]]=T.subarray(D[D.length-1][1]*L)),{R:x,cells:E}}function TX(e,t){var r,n=Ls(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?Kn(n[7][0].data)>>>0>0?1:0:-1,a=s4(n[5],function(i){return jX(i,s)});return{nrows:Kn(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function CX(e,t,r){var n,s=Ls(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Kn(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Kn(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=pr(a);var i=Ls(s[4][0].data),o=Pk(e,e[bc(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Pk(e,e[bc(i[17][0].data)][0]):[],u=Ls(i[3][0].data),f=0;u[1].forEach(function(h){var p=Ls(h.data),d=e[bc(p[2][0].data)][0],m=Kn(d.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var g=TX(e,d);g.data.forEach(function(w,x){w.forEach(function(y,b){var S=Jt({r:f+x,c:b}),T=AX(y,o,l);T&&(r[S]=T)})}),f+=g.nrows})}function PX(e,t){var r=Ls(t.data),n={"!ref":"A1"},s=e[bc(r[2][0].data)],a=Kn(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return CX(e,s[0],n),n}function LX(e,t){var r,n=Ls(t.data),s={name:(r=n[1])!=null&&r[0]?$w(n[1][0].data):"",sheets:[]},a=s4(n[2],bc);return a.forEach(function(i){e[i].forEach(function(o){var l=Kn(o.meta[1][0].data);l==6e3&&s.sheets.push(PX(e,o))})}),s}function FX(e,t){var r=o4(),n=Ls(t.data),s=s4(n[1],bc);if(s.forEach(function(a){e[a].forEach(function(i){var o=Kn(i.meta[1][0].data);if(o==2){var l=LX(e,i);l.sheets.forEach(function(u,f){l4(r,u,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function xv(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=kX(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var f;try{f=NX(u)}catch(h){return console.log("## "+(h.message||h))}f.forEach(function(h){a[h.id]=h.messages,i.push(h.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Kn(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var f=Kn(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return FX(a,o)}function DX(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function a4(e){DX([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function RX(e){return Bf.WS.indexOf(e)>-1?"sheet":e==Bf.CS?"chart":e==Bf.DS?"dialog":e==Bf.MS?"macro":e&&e.length?e:"sheet"}function OX(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,RX(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function IX(e,t,r,n,s,a,i,o,l,u,f,h){try{a[n]=c0(Ta(e,r,!0),t);var p=Cn(e,t),d;switch(o){case"sheet":d=HY(p,t,s,l,a[n],u,f,h);break;case"chart":if(d=qY(p,t,s,l,a[n],u,f,h),!d||!d["!drawel"])break;var m=Hh(d["!drawel"].Target,t),g=Ow(m),w=zV(Ta(e,m,!0),c0(Ta(e,g,!0),m)),x=Hh(w,m),y=Ow(x);d=EY(Ta(e,x,!0),x,l,c0(Ta(e,y,!0),x),u,d);break;case"macro":d=WY(p,t,s,l,a[n],u,f,h);break;case"dialog":d=VY(p,t,s,l,a[n],u,f,h);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=d;var b=[];a&&a[n]&&yo(a[n]).forEach(function(S){var T="";if(a[n][S].Type==Bf.CMNT){T=Hh(a[n][S].Target,t);var L=XY(Cn(e,T,!0),T,l);if(!L||!L.length)return;gk(d,L,!1)}a[n][S].Type==Bf.TCMNT&&(T=Hh(a[n][S].Target,t),b=b.concat(qV(Cn(e,T,!0),l)))}),b&&b.length&&gk(d,b,!0,l.people||[])}catch(S){if(l.WTF)throw S}}function qa(e){return e.charAt(0)=="/"?e.slice(1):e}function MX(e,t){if(eC(),t=t||{},a4(t),Va(e,"META-INF/manifest.xml")||Va(e,"objectdata.xml"))return jk(e,t);if(Va(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof xv<"u"){if(e.FileIndex)return xv(e);var r=hr.utils.cfb_new();return HS(e).forEach(function(M){Bz(r,M,Mz(e,M))}),xv(r)}throw new Error("Unsupported NUMBERS file")}if(!Va(e,"[Content_Types].xml"))throw Va(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Va(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=HS(e),s=DH(Ta(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Cn(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Cn(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(d0=[],s.sst)try{d0=YY(Cn(e,qa(s.sst)),s.sst,t)}catch(M){if(t.WTF)throw M}t.cellStyles&&s.themes.length&&(l=GY(Ta(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=KY(Cn(e,qa(s.style)),s.style,l,t))}s.links.map(function(M){try{var ne=c0(Ta(e,Ow(qa(M))),M);return QY(Cn(e,qa(M)),ne,M,t)}catch{}});var f=zY(Cn(e,qa(s.workbooks[0])),s.workbooks[0],t),h={},p="";s.coreprops.length&&(p=Cn(e,qa(s.coreprops[0]),!0),p&&(h=TC(p)),s.extprops.length!==0&&(p=Cn(e,qa(s.extprops[0]),!0),p&&BH(p,h,t)));var d={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(p=Ta(e,qa(s.custprops[0]),!0),p&&(d=$H(p,t)));var m={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(ne){return ne.name}):h.Worksheets&&h.SheetNames.length>0&&(i=h.SheetNames),t.bookProps&&(m.Props=h,m.Custprops=d),t.bookSheets&&typeof i<"u"&&(m.SheetNames=i),t.bookSheets?m.SheetNames:t.bookProps))return m;i={};var g={};t.bookDeps&&s.calcchain&&(g=JY(Cn(e,qa(s.calcchain)),s.calcchain));var w=0,x={},y,b;{var S=f.Sheets;h.Worksheets=S.length,h.SheetNames=[];for(var T=0;T!=S.length;++T)h.SheetNames[T]=S[T].name}var L=a?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),D=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");Va(e,D)||(D="xl/_rels/workbook."+L+".rels");var C=c0(Ta(e,D,!0),D.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=ZY(Cn(e,qa(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=WV(Cn(e,qa(s.people[0])),t)),C&&(C=OX(C,f.Sheets));var O=Cn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var E="sheet";if(C&&C[w]?(y="xl/"+C[w][1].replace(/[\/]?xl\//,""),Va(e,y)||(y=C[w][1]),Va(e,y)||(y=D.replace(/_rels\/.*$/,"")+C[w][1]),E=C[w][2]):(y="xl/worksheets/sheet"+(w+1-O)+"."+L,y=y.replace(/sheet0\./,"sheet.")),b=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var P=!1,q=0;q!=t.sheets.length;++q)typeof t.sheets[q]=="number"&&t.sheets[q]==w&&(P=1),typeof t.sheets[q]=="string"&&t.sheets[q].toLowerCase()==h.SheetNames[w].toLowerCase()&&(P=1);if(!P)continue e}}IX(e,y,b,h.SheetNames[w],w,x,i,E,t,f,l,u)}return m={Directory:s,Workbook:f,Props:h,Custprops:d,Deps:g,Sheets:i,SheetNames:h.SheetNames,Strings:d0,Styles:u,Themes:l,SSF:ds(er)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(M,ne){M=M.replace(/^Root Entry[\/]/,""),m.keys.push(M),m.files[M]=e.FileIndex[ne]}))),t&&t.bookVBA&&(s.vba.length>0?m.vbaraw=Cn(e,qa(s.vba[0]),!0):s.defaults&&s.defaults.bin===YV&&(m.vbaraw=Cn(e,"xl/vbaProject.bin",!0))),m}function BX(e,t){var r=t||{},n="Workbook",s=hr.find(e,n);try{if(n="/!DataSpaces/Version",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(PW(s.content),n="/!DataSpaces/DataSpaceMap",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=FW(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=DW(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);OW(s.content)}catch{}if(n="/EncryptionInfo",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=IW(s.content);if(n="/EncryptedPackage",s=hr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function i4(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ra(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function UX(e,t){return hr.find(e,"EncryptedPackage")?BX(e,t):h8(e,t)}function $X(e,t){var r,n=e,s=t||{};return s.type||(s.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r=iC(n,s),MX(r,s)}function x8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Bw(e.slice(r),t);default:break e}return rp.to_workbook(e,t)}function zX(e,t){var r="",n=i4(e,t);switch(t.type){case"base64":r=Ra(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ou(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Br(r)),t.type="binary",x8(r,t)}function HX(e,t){var r=e;return t.type=="base64"&&(r=Ra(r)),r=Q0.utils.decode(1200,r.slice(2),"str"),t.type="binary",x8(r,t)}function qX(e){return e.match(/[^\x00-\x7F]/)?qh(e):e}function vv(e,t,r,n){return n?(r.type="string",rp.to_workbook(e,r)):rp.to_workbook(t,r)}function Hw(e,t){zT();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Hw(new Uint8Array(e),(r=ds(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ed={},r.dateNF&&(ed.dateNF=r.dateNF),r.type||(r.type=ur&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ur?"buffer":"binary",n=Pz(e),typeof Uint8Array<"u"&&!ur&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=qX(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=ds(r),r.type="array",Hw(Mb(n),r)}switch((s=i4(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return UX(hr.read(n,r),r);break;case 9:if(s[1]<=8)return h8(n,r);break;case 60:return Bw(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return vW(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return gW.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?$X(n,r):vv(e,n,r,a);case 239:return s[3]===60?Bw(n,r):vv(e,n,r,a);case 255:if(s[1]===254)return HX(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return f0.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return f0.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return mk.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return YW.to_workbook(n,r);break;case 10:case 13:case 32:return zX(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pW.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?mk.to_workbook(n,r):vv(e,n,r,a)}function WX(e,t,r,n,s,a,i,o){var l=hs(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!i||e[r])for(var d=t.s.c;d<=t.e.c;++d){var m=i?e[r][d]:e[n[d]+l];if(m===void 0||m.t===void 0){if(u===void 0)continue;a[d]!=null&&(p[a[d]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(a[d]!=null){if(g==null)if(m.t=="e"&&g===null)p[a[d]]=null;else if(u!==void 0)p[a[d]]=u;else if(f&&g===null)p[a[d]]=null;else continue;else p[a[d]]=f&&(m.t!=="n"||m.t==="n"&&o.rawNumbers!==!1)?g:ml(m,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function qw(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=hn(f);break;case"number":l=hn(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(s=0);var h=hs(l.s.r),p=[],d=[],m=0,g=0,w=Array.isArray(e),x=l.s.r,y=0,b={};w&&!e[x]&&(e[x]=[]);var S=u.skipHidden&&e["!cols"]||[],T=u.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(S[y]||{}).hidden)switch(p[y]=Wn(y),r=w?e[x][y]:e[p[y]+h],n){case 1:a[y]=y-l.s.c;break;case 2:a[y]=p[y];break;case 3:a[y]=u.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ml(r,null,u),g=b[i]||0,!g)b[i]=1;else{do o=i+"_"+g++;while(b[o]);b[i]=g,b[o]=1}a[y]=o}for(x=l.s.r+s;x<=l.e.r;++x)if(!(T[x]||{}).hidden){var L=WX(e,l,x,p,n,a,w,u);(L.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(d[m++]=L.row)}return d.length=m,d}var Lk=/"/g;function VX(e,t,r,n,s,a,i,o){for(var l=!0,u=[],f="",h=hs(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var d=o.dense?(e[r]||[])[p]:e[n[p]+h];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(o.rawNumbers&&d.t=="n"?d.v:ml(d,null,o));for(var m=0,g=0;m!==f.length;++m)if((g=f.charCodeAt(m))===s||g===a||g===34||o.forceQuotes){f='"'+f.replace(Lk,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Lk,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(i)}function v8(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=hn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],m=s.s.c;m<=s.e.c;++m)(p[m]||{}).hidden||(h[m]=Wn(m));for(var g=0,w=s.s.r;w<=s.e.r;++w)(d[w]||{}).hidden||(f=VX(e,s,w,h,i,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function KX(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=v8(e,t);return r}function GX(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=hn(e["!ref"]),a="",i=[],o,l=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Wn(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=hs(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function y8(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Ys(n.origin):n.origin;i=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var h=hn(a["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),i==-1&&(i=h.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var p=n.header||[],d=0;t.forEach(function(g,w){yo(g).forEach(function(x){(d=p.indexOf(x))==-1&&(p[d=p.length]=x);var y=g[x],b="z",S="",T=Jt({c:o+d,r:i+w+s});u=ip(a,T),y&&typeof y=="object"&&!(y instanceof Date)?a[T]=y:(typeof y=="number"?b="n":typeof y=="boolean"?b="b":typeof y=="string"?b="s":y instanceof Date?(b="d",n.cellDates||(b="n",y=ta(y)),S=n.dateNF||er[14]):y===null&&n.nullError&&(b="e",y=0),u?(u.t=b,u.v=y,delete u.w,delete u.R,S&&(u.z=S)):a[T]=u={t:b,v:y},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var m=hs(i);if(s)for(d=0;d<p.length;++d)a[Wn(d+o)+m]={t:"s",v:p[d]};return a["!ref"]=pr(f),a}function YX(e,t){return y8(null,e,t)}function ip(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Ys(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ip(e,Jt(t)):ip(e,Jt({r:t,c:r||0}))}function XX(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function o4(){return{SheetNames:[],Sheets:{}}}function l4(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(DY(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function JX(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=XX(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function QX(e,t){return e.z=t,e}function w8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ZX(e,t,r){return w8(e,"#"+t,r)}function eJ(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function tJ(e,t,r,n){for(var s=typeof t!="string"?t:hn(t),a=typeof t=="string"?t:pr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=ip(e,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return e}var rJ={encode_col:Wn,encode_row:hs,encode_cell:Jt,encode_range:pr,decode_col:Kb,decode_row:Vb,split_cell:hH,decode_cell:Ys,decode_range:$d,format_cell:ml,sheet_add_aoa:kC,sheet_add_json:y8,sheet_add_dom:p8,aoa_to_sheet:zd,json_to_sheet:YX,table_to_sheet:m8,table_to_book:vX,sheet_to_csv:v8,sheet_to_txt:KX,sheet_to_json:qw,sheet_to_html:xX,sheet_to_formulae:GX,sheet_to_row_object_array:qw,sheet_get_cell:ip,book_new:o4,book_append_sheet:l4,book_set_sheet_visibility:JX,cell_set_number_format:QX,cell_set_hyperlink:w8,cell_set_internal_link:ZX,cell_add_comment:eJ,sheet_set_array_formula:tJ,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const b8=({projectId:e,onClose:t,onImported:r})=>{const{user:n}=Rn(),[s,a]=ee.useState(null),[i,o]=ee.useState(""),[l,u]=ee.useState(""),[f,h]=ee.useState([]),[p,d]=ee.useState(!1),[m,g]=ee.useState(""),w=async S=>{var L;const T=(L=S.target.files)==null?void 0:L[0];if(T){a(T),g(""),d(!0);try{const A=await T.arrayBuffer(),D=Hw(A),C=D.Sheets[D.SheetNames[0]],O=rJ.sheet_to_json(C,{header:1}),E=[];for(let P=1;P<O.length;P++){const q=O[P];if(!q||q.length===0||!q.some(_=>_))continue;const M=parseInt(q[0])||P,ne=String(q[1]||"").trim(),fe=String(q[2]||"M").trim(),me=parseFloat(q[3])||0,re=parseFloat(q[4])||0,G=me*re;let ge=!0,ve="";ne||(ge=!1,ve="Dsignation manquante"),E.push({numero:M,designation:ne,unite:fe,quantite:me,prixUnitaire:re,montant:G,isValid:ge,error:ve})}if(h(E),!i){const P=T.name.replace(/\.[^/.]+$/,"");o(P)}}catch(A){g("Erreur lors de la lecture du fichier. Vrifiez le format Excel."),console.error(A)}finally{d(!1)}}},x=async()=>{if(!n||!i.trim()||!l.trim()||f.length===0){alert("Veuillez remplir tous les champs et charger un fichier valide");return}const S=f.filter(O=>O.isValid);if(S.length===0){alert("Aucune ligne valide  importer");return}const T=`bordereau:${jr()}`,L=new Date().toISOString(),A=S.map((O,E)=>({id:jr(),numero:E+1,designation:O.designation,unite:O.unite,quantite:O.quantite,prixUnitaire:O.prixUnitaire,montant:O.montant})),D=A.reduce((O,E)=>O+E.montant,0),C={id:T,projectId:e,userId:n.id,reference:i.trim(),designation:l.trim(),lignes:A,montantTotal:D,createdAt:L,updatedAt:L};await Le.bordereaux.add(C),await us("CREATE","bordereau",T.replace("bordereau:",""),C,n.id),r(T)},y=f.filter(S=>S.isValid).length,b=f.filter(S=>!S.isValid).length;return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Importer depuis Excel"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Format attendu: N, Dsignation, Unit, Quantit, Prix unitaire"})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(Ac,{className:"w-5 h-5"})})]}),c.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rfrence *"}),c.jsx("input",{type:"text",value:i,onChange:S=>o(S.target.value),className:"input w-full",placeholder:"Ex: BPU-2024-01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Dsignation *"}),c.jsx("input",{type:"text",value:l,onChange:S=>u(S.target.value),className:"input w-full",placeholder:"Ex: Bordereau import"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fichier Excel (.xlsx, .xls)"}),c.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-primary-500 transition-colors",children:[c.jsx("input",{type:"file",accept:".xlsx,.xls",onChange:w,className:"hidden",id:"excel-upload"}),c.jsxs("label",{htmlFor:"excel-upload",className:"cursor-pointer",children:[c.jsx(aB,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),s?c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:s.name}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[(s.size/1024).toFixed(2)," KB"]})]}):c.jsxs("div",{children:[c.jsx("p",{className:"font-medium text-gray-900",children:"Cliquer pour slectionner un fichier"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ou glisser-dposer"})]})]})]})]}),m&&c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[c.jsx(Za,{className:"w-5 h-5 text-red-600 mt-0.5"}),c.jsx("p",{className:"text-sm text-red-900",children:m})]}),f.length>0&&c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h4",{className:"font-medium text-gray-900",children:"Aperu des donnes"}),c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[c.jsx(_g,{className:"w-4 h-4"}),y," valides"]}),b>0&&c.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[c.jsx(Za,{className:"w-4 h-4"}),b," erreurs"]})]})]}),c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{className:"bg-gray-50 border-b sticky top-0",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"N"}),c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"Dsignation"}),c.jsx("th",{className:"px-3 py-2 text-left font-medium text-gray-700",children:"U"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Qt"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"P.U"}),c.jsx("th",{className:"px-3 py-2 text-right font-medium text-gray-700",children:"Montant"}),c.jsx("th",{className:"px-3 py-2 text-center font-medium text-gray-700",children:"Statut"})]})}),c.jsx("tbody",{className:"divide-y",children:f.map((S,T)=>c.jsxs("tr",{className:S.isValid?"":"bg-red-50",children:[c.jsx("td",{className:"px-3 py-2",children:S.numero}),c.jsx("td",{className:"px-3 py-2",children:S.designation||c.jsx("span",{className:"text-gray-400",children:"-"})}),c.jsx("td",{className:"px-3 py-2",children:S.unite}),c.jsx("td",{className:"px-3 py-2 text-right",children:S.quantite}),c.jsx("td",{className:"px-3 py-2 text-right",children:S.prixUnitaire.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-right font-medium",children:S.montant.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-center",children:S.isValid?c.jsx(_g,{className:"w-4 h-4 text-green-600 mx-auto"}):c.jsxs("div",{className:"flex items-center justify-center gap-1",children:[c.jsx(Za,{className:"w-4 h-4 text-red-600"}),c.jsx("span",{className:"text-xs text-red-600",children:S.error})]})})]},T))})]})})})]}),p&&c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"w-8 h-8 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"}),c.jsx("p",{className:"ml-3 text-gray-600",children:"Traitement du fichier..."})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("button",{onClick:t,className:"btn btn-secondary flex-1",children:"Annuler"}),c.jsxs("button",{onClick:x,disabled:f.length===0||y===0||!i.trim()||!l.trim(),className:"btn btn-primary flex-1 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:[c.jsx(Fb,{className:"w-4 h-4"}),"Importer ",y>0&&`(${y} lignes)`]})]})})]})})},N8="app_storage_config",Fp=()=>{const e=localStorage.getItem(N8);return e?JSON.parse(e):{type:"local",basePath:"MesProjetsBTP"}},S8=e=>{localStorage.setItem(N8,JSON.stringify(e))},k8=(e,t)=>{const r=t.replace(/\//g,"-").replace(/\s+/g,"-");return`${e}/${r}`},nJ=e=>{const n=`${Fp().basePath}/${e}`;return{root:n,bordereau:`${n}/Bordereau`,metre:`${n}/Mtr`,decomptes:`${n}/Dcomptes`,attachements:`${n}/Attachements`,photos:`${n}/Photos`,pv:`${n}/PV`,documents:`${n}/Documents`}},sJ=async(e,t)=>{const r=Fp(),n=k8(e,t),s=nJ(n);switch(r.type){case"local":await $g(s);break;case"onedrive":await aJ(s);break;case"google-drive":await iJ(s);break;default:await $g(s)}return s},$g=async e=>{if("showDirectoryPicker"in window)try{console.log(" File System Access API disponible")}catch(r){console.warn("Impossible de crer les dossiers locaux:",r)}else console.log(" File System Access API non disponible, utilisation du mode fallback");const t=JSON.parse(localStorage.getItem("project_folders")||"{}");t[e.root]={structure:e,createdAt:new Date().toISOString()},localStorage.setItem("project_folders",JSON.stringify(t)),console.log(" Structure de dossiers enregistre:",e)},aJ=async e=>{console.log(" OneDrive folders ( implmenter):",e),await $g(e)},iJ=async e=>{console.log(" Google Drive folders ( implmenter):",e),await $g(e)},oJ=async e=>{var n;const r=`${Fp().basePath}/${e}`;if((n=window.electronAPI)!=null&&n.openFolder){await window.electronAPI.openFolder(r);return}alert(`Chemin du dossier:
${r}

Copiez ce chemin pour accder au dossier.`)};let mf=null;const lJ=async()=>{if(!("showDirectoryPicker"in window))return alert("Votre navigateur ne supporte pas la slection de dossiers. Utilisez Chrome, Edge ou Opera."),null;try{if(mf=await window.showDirectoryPicker({mode:"readwrite"}),mf){const e=Fp();return e.basePath=mf.name,S8(e),localStorage.setItem("base_folder_name",mf.name),console.log(" Dossier de base slectionn:",mf.name),mf.name}return null}catch(e){return console.warn("Slection de dossier annule:",e),null}},gf=(e,t,r="-")=>{if(!e)return r;try{const n=typeof e=="string"?Si(e):new Date(e);return X0(n)?oa(n,t,{locale:Rb}):r}catch{return r}},cJ=()=>{const{t:e}=Ii(),{id:t}=Ld(),r=Os(),{user:n}=Rn(),[s,a]=ee.useState("overview"),[i,o]=ee.useState(!1),[l,u]=ee.useState(null),{canModify:f,reason:h}=Ep(),p=t!=null&&t.startsWith("project:")?t:`project:${t}`,d=t!=null&&t.startsWith("project:")?t.replace("project:",""):t;console.log(" ProjectDetailPage - URL id:",t),console.log(" ProjectDetailPage - projectId (with prefix):",p),console.log(" ProjectDetailPage - rawId (without prefix):",d);const{project:m,isLoading:g,refresh:w}=Bd(d||null),{bordereaux:x,refresh:y}=_p(d||null),{decompts:b,refresh:S}=AT(d||null),{photos:T}=QB(d||null),{pvs:L}=ZB(d||null),{attachments:A}=eU(d||null),{periodes:D,refresh:C}=Tx(d||null),{aggregatedMetres:O}=tU(d||null),{metres:E}=Cx(d||null),P=x&&x.length>0?x[0].lignes.reduce((R,I)=>{const W=I.quantite*(I.prixUnitaire||0)*1.2;return R+W},0):0,M=(()=>{if(!b||b.length===0||P===0)return 0;const R=b.reduce((W,se)=>!W||se.numero>W.numero?se:W,b[0]),B=((R==null?void 0:R.totalTTC)||(R==null?void 0:R.montantTotal)||(R==null?void 0:R.montantTTC)||0)/P*100;return Math.min(100,Math.max(0,B))})(),ne=async()=>{if(!(!n||!m)){if(!f){alert(h||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}if(confirm("tes-vous sr de vouloir supprimer ce projet ? Cette action est irrversible."))try{It()?await Rt.deleteProject(d):(await Le.projects.update(m.id,{deletedAt:new Date().toISOString(),updatedAt:new Date().toISOString()}),await us("DELETE","project",d,m,n.id)),r("/projects")}catch(R){console.error("Error deleting project:",R),alert("Erreur lors de la suppression du projet")}}},fe=async R=>{if(!n||!t)return;if(!f){alert(h||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}const I=`bordereau:${jr()}`,B=new Date().toISOString(),W={id:I,projectId:p,userId:n.id,reference:R.reference,designation:R.designation,lignes:[],montantTotal:0,createdAt:B,updatedAt:B};try{It()?(await Rt.createBordereau({projectId:d,reference:R.reference,designation:R.designation,lignes:[]}),y()):(await Le.bordereaux.add(W),await us("CREATE","bordereau",I.replace("bordereau:",""),W,n.id))}catch(se){console.error("Error creating bordereau:",se),alert("Erreur lors de la cration du bordereau")}u(null)},me=async()=>{var je;if(!n||!t||!x||x.length===0)return;if(!f){alert(h||"Vous ne pouvez pas modifier les donnes en mode hors ligne");return}const R=new Date().toISOString();if(It()){try{const Y=await Rt.createPeriode(d,{numero:((D==null?void 0:D.length)||0)+1,libelle:`Priode ${((D==null?void 0:D.length)||0)+1}`,dateDebut:R,dateFin:R,statut:"en_cours"}),We=((je=Y.data)==null?void 0:je.id)||Y.id;await Rt.createDecompt({projectId:d,periodeId:We,numero:((D==null?void 0:D.length)||0)+1,statut:"draft"}),C(),S(),r(`/projects/${d}/metre/${We.replace("periode:","")}`)}catch(Y){console.error("Error creating new metre:",Y),alert("Erreur lors de la cration du mtr")}return}const I=await Le.periodes.where("projectId").equals(p).and(Y=>!Y.deletedAt).toArray(),B=I.length+1,W=`periode:${jr()}`,se={id:W,projectId:p,userId:n.id,numero:B,libelle:`Priode ${B}`,dateDebut:R,dateFin:R,statut:"en_cours",createdAt:R,updatedAt:R};if(await Le.periodes.add(se),await us("CREATE","periode",W.replace("periode:",""),se,n.id),B>1){const Y=I.find(We=>We.numero===B-1);if(Y){const We=await Le.metres.where("periodeId").equals(Y.id).and(Ke=>!Ke.deletedAt).toArray();for(const Ke of We){const J=`metre:${jr()}`,ze={id:J,projectId:p,periodeId:W,bordereauLigneId:Ke.bordereauLigneId,userId:n.id,reference:Ke.reference,designationBordereau:Ke.designationBordereau,unite:Ke.unite,sections:[],subSections:[],lignes:[],totalPartiel:0,totalCumule:Ke.totalCumule||Ke.totalPartiel||0,quantiteBordereau:Ke.quantiteBordereau,pourcentageRealisation:Ke.pourcentageRealisation||0,createdAt:R,updatedAt:R};await Le.metres.add(ze),await us("CREATE","metre",J.replace("metre:",""),ze,n.id)}}}const pe=`decompt:${jr()}`;let he=0;B>1&&(he=(await Le.decompts.where("projectId").equals(p).and(We=>!We.deletedAt).toArray()).reduce((We,Ke)=>We+(Number(Ke.montantTotal)||0),0));const de={id:pe,projectId:p,periodeId:W,userId:n.id,numero:B,lignes:[],montantTotal:0,montantCumule:he,statut:"draft",createdAt:R,updatedAt:R};await Le.decompts.add(de),await us("CREATE","decompt",pe.replace("decompt:",""),de,n.id),r(`/projects/${d}/metre/${W.replace("periode:","")}`)},[re,G]=ee.useState(!1);if(ee.useEffect(()=>{const R=setTimeout(()=>{!m&&!g&&G(!0)},5e3);return()=>clearTimeout(R)},[m,g]),!m)return re?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-4",children:c.jsx(Za,{className:"w-8 h-8 text-yellow-600"})}),c.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),c.jsx("p",{className:"text-gray-500 text-sm mb-4",children:It()?"Le projet n'existe pas sur le serveur.":"Le projet n'existe pas localement. Essayez de synchroniser."}),c.jsx("button",{onClick:()=>It()?w():window.location.reload(),className:"btn btn-primary",children:It()?"Ressayer":"Rafrachir la page"})]})}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})});const ge=[{id:"overview",label:"Vue d'ensemble",icon:Du,count:null},{id:"bordereau",label:"Bordereau",icon:yn,count:x&&x.length>0?1:0},{id:"metre",label:"Mtr",icon:ic,count:(O==null?void 0:O.length)||0},{id:"decompt",label:"Dcompte",icon:_i,count:(b==null?void 0:b.length)||0},{id:"photos",label:"Photos",icon:Eh,count:(T==null?void 0:T.length)||0},{id:"pv",label:"PV",icon:yn,count:(L==null?void 0:L.length)||0},{id:"documents",label:"Documents",icon:zm,count:(A==null?void 0:A.length)||0}],ve=R=>{switch(R){case"active":return"bg-green-100 text-green-700 border-green-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"archived":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-yellow-100 text-yellow-700 border-yellow-200"}},_=R=>{switch(R){case"active":return c.jsx(pl,{className:"w-4 h-4"});case"completed":return c.jsx(go,{className:"w-4 h-4"});default:return c.jsx(yn,{className:"w-4 h-4"})}};return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r("/projects"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4 transition-colors",children:[c.jsx(ri,{className:"w-5 h-5"}),c.jsx("span",{children:"Retour aux projets"})]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["March N ",m.marcheNo]}),c.jsxs("span",{className:`flex items-center gap-1.5 px-3 py-1.5 text-sm font-medium rounded-full border ${ve(m.status)}`,children:[_(m.status),e(`project.status.${m.status}`)]})]}),c.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 flex-wrap",children:[c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Pb,{className:"w-4 h-4"}),m.annee]}),c.jsx("span",{children:""}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(_i,{className:"w-4 h-4"}),P.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD (TTC)"]}),m.societe&&c.jsxs(c.Fragment,{children:[c.jsx("span",{children:""}),c.jsxs("span",{className:"flex items-center gap-1",children:[c.jsx(Xf,{className:"w-4 h-4"}),m.societe]})]})]}),c.jsx("p",{className:"text-gray-600 mt-2 line-clamp-2",title:m.objet,children:m.objet})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Md,{className:"w-4 h-4"}),"Exporter"]}),c.jsxs(ji,{to:`/projects/${t}/edit`,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(wS,{className:"w-4 h-4"}),"Modifier"]}),c.jsxs("div",{className:"relative",children:[c.jsx("button",{onClick:()=>o(!i),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(xB,{className:"w-5 h-5 text-gray-600"})}),i&&c.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-10",children:[c.jsxs("button",{className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-50 flex items-center gap-2",children:[c.jsx(NB,{className:"w-4 h-4"}),"Partager"]}),c.jsxs("button",{onClick:ne,className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[c.jsx(ma,{className:"w-4 h-4"}),"Supprimer"]})]})]})]})]})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progression du projet"}),c.jsxs("span",{className:`text-2xl font-bold ${M>100?"text-red-600":"text-primary-600"}`,children:[M.toFixed(1),"%"]})]}),c.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-500 ${M>100?"bg-gradient-to-r from-red-500 to-red-600":M>80?"bg-gradient-to-r from-yellow-500 to-yellow-600":"bg-gradient-to-r from-primary-500 to-primary-600"}`,style:{width:`${Math.min(100,M)}%`}})}),c.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Mis  jour le ",gf(m.updatedAt,"dd MMMM yyyy  HH:mm")]}),M>100&&c.jsx("span",{className:"text-xs text-red-500 font-medium",children:" Dpassement du budget!"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(yn,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:x&&x.length>0?"1":"0"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Bordereau"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(ic,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(E==null?void 0:E.length)||0}),c.jsx("p",{className:"text-sm text-gray-600",children:"Mtrs"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(_i,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(b==null?void 0:b.length)||0}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dcomptes"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-yellow-100 text-yellow-600 rounded-lg",children:c.jsx(Eh,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(T==null?void 0:T.length)||0}),c.jsx("p",{className:"text-sm text-gray-600",children:"Photos"})]})]})})]}),c.jsx("div",{className:"border-b border-gray-200 mb-6",children:c.jsx("div",{className:"flex gap-1 overflow-x-auto",children:ge.map(R=>{const I=R.icon;return c.jsxs("button",{onClick:()=>a(R.id),className:`flex items-center gap-2 px-4 py-3 border-b-2 font-medium text-sm transition-colors whitespace-nowrap ${s===R.id?"border-primary-600 text-primary-600":"border-transparent text-gray-600 hover:text-gray-900 hover:border-gray-300"}`,children:[c.jsx(I,{className:"w-4 h-4"}),R.label,R.count!==null&&c.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${s===R.id?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600"}`,children:R.count})]},R.id)})})}),c.jsxs("div",{children:[s==="overview"&&c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Objet du march"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.objet})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Numro de march"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.marcheNo})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Anne"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.annee})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Date d'ouverture"}),c.jsx("p",{className:"font-medium text-gray-900",children:gf(m.dateOuverture,"dd/MM/yyyy")})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Montant (TTC)"}),c.jsxs("p",{className:"font-medium text-primary-600 text-lg",children:[P.toLocaleString("fr-MA",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Statut"}),c.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 text-sm font-medium rounded-full border ${ve(m.status)}`,children:[_(m.status),e(`project.status.${m.status}`)]})]})]})]}),(m.snss||m.cbn||m.rcn||m.osc)&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations administratives"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[m.snss&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"SNSS"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.snss})]}),m.cbn&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"CBN"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.cbn})]}),m.rcn&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"RCN"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.rcn})]}),m.osc&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"OSC"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.osc})]})]})]}),(m.societe||m.patente||m.delaisEntreeService)&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de la socit"}),c.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[m.societe&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Nom de la socit"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.societe})]}),m.patente&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Patente"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.patente})]}),m.delaisEntreeService&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Dlais d'entre en service"}),c.jsx("p",{className:"font-medium text-gray-900",children:m.delaisEntreeService})]})]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Chronologie"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-green-100 text-green-600 rounded-full flex items-center justify-center",children:c.jsx(go,{className:"w-4 h-4"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Projet cr"}),c.jsx("p",{className:"text-xs text-gray-500",children:gf(m.createdAt,"dd/MM/yyyy  HH:mm")})]})]}),m.updatedAt!==m.createdAt&&c.jsxs("div",{className:"flex gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center",children:c.jsx(wS,{className:"w-4 h-4"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Dernire modification"}),c.jsx("p",{className:"text-xs text-gray-500",children:gf(m.updatedAt,"dd/MM/yyyy  HH:mm")})]})]})]})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Actions rapides"}),c.jsxs("div",{className:"space-y-2",children:[c.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(yn,{className:"w-4 h-4"}),"Ajouter un bordereau"]}),c.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(Eh,{className:"w-4 h-4"}),"Ajouter des photos"]}),c.jsxs("button",{className:"w-full btn btn-secondary text-left flex items-center gap-2",children:[c.jsx(zm,{className:"w-4 h-4"}),"Joindre un document"]})]})]}),c.jsx("div",{className:"card bg-gradient-to-br from-primary-50 to-primary-100 border-primary-200",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:"flex-shrink-0 w-10 h-10 bg-primary-600 text-white rounded-lg flex items-center justify-center",children:c.jsx(Du,{className:"w-5 h-5"})}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Dossier du projet"}),c.jsx("p",{className:"text-sm text-gray-600 mb-2",children:m.folderPath||`${m.annee}/${m.marcheNo}`}),c.jsxs("button",{onClick:()=>oJ(m.folderPath||`${m.annee}/${m.marcheNo}`),className:"inline-flex items-center gap-1.5 text-sm text-primary-600 hover:text-primary-700 font-medium",children:[c.jsx(Pw,{className:"w-4 h-4"}),"Ouvrir le dossier",c.jsx(nB,{className:"w-3 h-3"})]})]})]})})]})]}),s==="bordereau"&&c.jsx(c.Fragment,{children:x&&x.length>0?c.jsx(IT,{bordereauId:x[0].id,onClose:()=>a("overview")}):c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center py-8 mb-6",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),c.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("button",{onClick:()=>u("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Gs,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),c.jsx("button",{onClick:()=>u("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(kT,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),c.jsx("button",{onClick:()=>u("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Eg,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),c.jsx("button",{onClick:()=>u("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Fb,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]})}),s==="metre"&&c.jsx(c.Fragment,{children:x&&x.length>0?c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Mtrs (",(D==null?void 0:D.length)||0,")"]}),D&&D.length>0&&c.jsxs("button",{onClick:me,className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Gs,{className:"w-4 h-4"}),"Nouveau mtr"]})]}),D&&D.length>0?c.jsx("div",{className:"grid gap-4",children:D.sort((R,I)=>I.numero-R.numero).map(R=>{const I=(E==null?void 0:E.filter(W=>W.periodeId===R.id))||[],B=I.reduce((W,se)=>{const pe=Number(se.totalCumule)||Number(se.totalPartiel)||0;return W+pe},0);return c.jsx("div",{className:"card hover:shadow-md transition-shadow cursor-pointer",onClick:()=>r(`/projects/${d}/metre/${R.id.replace("periode:","")}`),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center bg-primary-100",children:c.jsx(ic,{className:"w-6 h-6 text-primary-600"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900",children:["Mtr N ",R.numero]}),c.jsx("p",{className:"text-sm text-gray-500",children:R.libelle||`Priode ${R.numero}`})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Total Cumul"}),c.jsx("p",{className:"font-semibold text-gray-900",children:B.toFixed(2)})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Articles"}),c.jsx("p",{className:"font-semibold text-primary-600",children:I.length})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),c.jsx("p",{className:"text-sm text-gray-700",children:gf(R.createdAt,"dd/MM/yyyy")})]}),c.jsx(il,{className:"w-5 h-5 text-gray-400"})]})]})},R.id)})}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(ic,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun mtr cr"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Crez votre premier mtr pour commencer  mesurer les travaux"}),c.jsxs("button",{onClick:me,className:"btn btn-primary inline-flex items-center gap-2 px-6 py-3",children:[c.jsx(Gs,{className:"w-5 h-5"}),"Crer le premier mtr"]}),c.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Un dcompte sera cr automatiquement avec le mtr"})]})})]}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Bordereau requis"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),c.jsxs("button",{onClick:()=>r(`/projects/${t}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(yn,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})}),s==="decompt"&&c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Dcomptes (",(b==null?void 0:b.length)||0,")"]})}),b&&b.length>0?c.jsx("div",{className:"grid gap-4",children:b.sort((R,I)=>I.numero-R.numero).map(R=>{var W;const I=D==null?void 0:D.find(se=>se.id===R.periodeId),B=I==null?void 0:I.isDecompteDernier;return c.jsx("div",{className:"card hover:shadow-md transition-shadow cursor-pointer",onClick:()=>r(`/projects/${d}/decompte/${R.periodeId.replace("periode:","")}`),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${B?"bg-green-100":"bg-primary-100"}`,children:c.jsx(_i,{className:`w-6 h-6 ${B?"text-green-600":"text-primary-600"}`})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"font-semibold text-gray-900",children:["Dcompte N ",R.numero,B&&c.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700 rounded-full",children:"et dernier"})]}),c.jsx("p",{className:"text-sm text-gray-500",children:I?`${I.libelle||`Priode ${I.numero}`}`:"Priode non trouve"})]})]}),c.jsxs("div",{className:"flex items-center gap-6",children:[c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Montant HT"}),c.jsxs("p",{className:"font-semibold text-gray-900",children:[(W=R.montantTotal||R.montantHT||0)==null?void 0:W.toLocaleString("fr-FR",{minimumFractionDigits:2})," MAD"]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Statut"}),c.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${R.statut==="validated"?"bg-green-100 text-green-800":R.statut==="submitted"?"bg-blue-100 text-blue-800":R.statut==="paid"?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800"}`,children:R.statut==="validated"?"Valid":R.statut==="submitted"?"Soumis":R.statut==="paid"?"Pay":"Brouillon"})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Date"}),c.jsx("p",{className:"text-sm text-gray-700",children:gf((I==null?void 0:I.dateFin)||R.createdAt,"dd/MM/yyyy")})]}),c.jsx(il,{className:"w-5 h-5 text-gray-400"})]})]})},R.id)})}):c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(_i,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun dcompte"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Crez des mtrs puis gnrez le dcompte pour facturer les travaux excuts"}),c.jsxs("button",{onClick:()=>r(`/projects/${t}/decompte`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(_i,{className:"w-4 h-4"}),"Crer un dcompte"]})]})})]}),s==="photos"&&c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(Eh,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune photo"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Ajoutez des photos pour documenter l'avancement du projet"}),c.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(Eh,{className:"w-4 h-4"}),"Ajouter des photos"]})]})}),s==="pv"&&c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun PV"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Grez vos procs-verbaux (installation, rception, constat...)"}),c.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(yn,{className:"w-4 h-4"}),"Crer un PV"]})]})}),s==="documents"&&c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(zm,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun document"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Attachez vos factures, plans, et autres documents importants"}),c.jsxs("button",{className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(zm,{className:"w-4 h-4"}),"Joindre un document"]})]})})]}),l==="blank"&&c.jsx(MT,{onClose:()=>u(null),onCreate:fe}),l==="template"&&c.jsx(BT,{projectId:t,onClose:()=>u(null),onCreated:()=>u(null)}),l==="copy"&&c.jsx(UT,{currentProjectId:t,onClose:()=>u(null),onCopied:()=>u(null)}),l==="import"&&c.jsx(b8,{projectId:t,onClose:()=>u(null),onImported:()=>u(null)})]})},uJ=async(e,t)=>{if(!t||t.length<2)return(await Le.companies.toArray()).sort((a,i)=>i.usageCount-a.usageCount).slice(0,10);const r=t.toLowerCase();return(await Le.companies.filter(s=>{const a=s.nom.toLowerCase().includes(r),i=s.rc?s.rc.toLowerCase().includes(r):!1,o=s.cnss?s.cnss.toLowerCase().includes(r):!1;return a||i||o}).toArray()).sort((s,a)=>{const i=s.nom.toLowerCase().startsWith(r),o=a.nom.toLowerCase().startsWith(r);return i&&!o?-1:!i&&o?1:a.usageCount-s.usageCount}).slice(0,10)},fJ=async(e,t)=>(await Le.companies.filter(n=>n.nom.toLowerCase()===t.toLowerCase()).toArray())[0],_8=async(e,t)=>{const r=new Date().toISOString(),n=await fJ("",t.nom);if(n){const s={...t,usageCount:n.usageCount+1,lastUsed:r,updatedAt:r};return await Le.companies.update(n.id,s),await Le.syncOperations.add({id:`sync:${jr()}`,userId:e,deviceId:localStorage.getItem("deviceId")||"device-001",type:"UPDATE",entity:"company",entityId:n.id,data:{...n,...s},timestamp:Date.now(),synced:!1}),{...n,...s}}else{const s={id:`company:${jr()}`,userId:e,nom:t.nom,rc:t.rc,cb:t.cb,cnss:t.cnss,patente:t.patente,adresse:t.adresse,telephone:t.telephone,email:t.email,usageCount:1,lastUsed:r,createdAt:r,updatedAt:r};return await Le.companies.add(s),await Le.syncOperations.add({id:`sync:${jr()}`,userId:e,deviceId:localStorage.getItem("deviceId")||"device-001",type:"CREATE",entity:"company",entityId:s.id,data:s,timestamp:Date.now(),synced:!1}),console.log(" Nouvelle entreprise cre et prte pour sync:",s.nom),s}},E8=e=>e.societe?{nom:e.societe,rc:e.rc,cb:e.cb,cnss:e.cnss,patente:e.patente}:null,A8=({userId:e,value:t,onChange:r,onSelect:n,placeholder:s="Nom de la socit",className:a=""})=>{const[i,o]=ee.useState(!1),[l,u]=ee.useState([]),[f,h]=ee.useState(!1),[p,d]=ee.useState(-1),m=ee.useRef(null),g=ee.useRef(null);ee.useEffect(()=>{const S=T=>{m.current&&!m.current.contains(T.target)&&o(!1)};return document.addEventListener("mousedown",S),()=>document.removeEventListener("mousedown",S)},[]),ee.useEffect(()=>{const T=setTimeout(async()=>{if(e){h(!0);try{const L=await uJ(e,t);u(L)}catch(L){console.error("Erreur recherche entreprises:",L),u([])}finally{h(!1)}}},200);return()=>clearTimeout(T)},[e,t]);const w=S=>{if(!i){(S.key==="ArrowDown"||S.key==="Enter")&&o(!0);return}switch(S.key){case"ArrowDown":S.preventDefault(),d(T=>T<l.length-1?T+1:T);break;case"ArrowUp":S.preventDefault(),d(T=>T>0?T-1:T);break;case"Enter":S.preventDefault(),p>=0&&l[p]&&x(l[p]);break;case"Escape":o(!1),d(-1);break}},x=S=>{r(S.nom),n(S),o(!1),d(-1)},y=S=>{r(S.target.value),o(!0),d(-1)},b=()=>{o(!0)};return c.jsxs("div",{ref:m,className:`relative ${a}`,children:[c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:g,type:"text",value:t,onChange:y,onFocus:b,onKeyDown:w,placeholder:s,className:"input w-full pl-10 pr-8",autoComplete:"off"}),c.jsx(Xf,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t&&c.jsx("button",{type:"button",onClick:()=>{var S;r(""),(S=g.current)==null||S.focus()},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c.jsx(Ac,{className:"w-4 h-4"})})]}),i&&(l.length>0||f)&&c.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-64 overflow-auto",children:f?c.jsx("div",{className:"p-3 text-center text-gray-500",children:c.jsx("div",{className:"w-5 h-5 border-2 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto"})}):c.jsx(c.Fragment,{children:l.length>0&&c.jsxs("div",{className:"py-1",children:[c.jsx("div",{className:"px-3 py-1.5 text-xs font-medium text-gray-500 bg-gray-50",children:"Entreprises enregistres"}),l.map((S,T)=>c.jsxs("button",{type:"button",onClick:()=>x(S),className:`w-full px-3 py-2 text-left flex items-start gap-3 transition-colors ${T===p?"bg-primary-50":"hover:bg-gray-50"}`,children:[c.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${T===p?"bg-primary-100":"bg-gray-100"}`,children:c.jsx(Xf,{className:`w-4 h-4 ${T===p?"text-primary-600":"text-gray-500"}`})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("p",{className:"font-medium text-gray-900 truncate",children:S.nom}),c.jsx("p",{className:"text-xs text-gray-500 truncate",children:[S.rc&&`RC: ${S.rc}`,S.cnss&&`CNSS: ${S.cnss}`].filter(Boolean).join("  ")||"Aucune info supplmentaire"})]}),S.usageCount>1&&c.jsxs("span",{className:"flex-shrink-0 text-xs text-gray-400",children:[S.usageCount,"x"]})]},S.id))]})})}),i&&!f&&l.length===0&&t.length>=2&&c.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-3",children:c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[c.jsx(Lb,{className:"w-4 h-4"}),c.jsx("span",{children:"Nouvelle entreprise - les infos seront sauvegardes automatiquement"})]})})]})},dJ=()=>{const{t:e}=Ii(),t=Os(),{user:r}=Rn(),[n,s]=ee.useState(!1),[a,i]=ee.useState(null),{canModify:o,reason:l}=Ep(),[u,f]=ee.useState({objet:"",marcheNo:"",annee:new Date().getFullYear().toString(),dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",achevementTravaux:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""}),h=async p=>{if(p.preventDefault(),!!r){if(!o){i(l||"Vous devez tre connect pour crer un projet");return}s(!0),i(null);try{const d=`project:${jr()}`,m=new Date().toISOString(),g=k8(u.annee,u.marcheNo);if(It()){const y={objet:u.objet,marcheNo:u.marcheNo,annee:u.annee,dateOuverture:u.dateOuverture,montant:0,typeMarche:u.typeMarche,commune:u.commune||void 0,societe:u.societe,rc:u.rc,cb:u.cb,cnss:u.cnss,patente:u.patente,programme:u.programme,projet:u.projet,ligne:u.ligne,chapitre:u.chapitre,delaisExecution:u.delaisExecution?parseInt(u.delaisExecution):void 0,status:u.status,osc:u.osc||void 0,dateReceptionProvisoire:u.dateReceptionProvisoire||void 0,dateReceptionDefinitive:u.dateReceptionDefinitive||void 0,arrets:[],progress:0,folderPath:g};await Rt.createProject(y),console.log(" [WEB] Projet cr via API"),t("/projects");return}try{await sJ(u.annee,u.marcheNo),console.log(" Dossiers du projet crs:",g)}catch(y){console.warn(" Impossible de crer les dossiers (mode fallback):",y)}const w={id:d,userId:r.id,objet:u.objet,marcheNo:u.marcheNo,annee:u.annee,dateOuverture:u.dateOuverture,montant:0,typeMarche:u.typeMarche,commune:u.commune||void 0,societe:u.societe,rc:u.rc,cb:u.cb,cnss:u.cnss,patente:u.patente,programme:u.programme,projet:u.projet,ligne:u.ligne,chapitre:u.chapitre,delaisExecution:u.delaisExecution?parseInt(u.delaisExecution):void 0,status:u.status,osc:u.osc||void 0,dateReceptionProvisoire:u.dateReceptionProvisoire||void 0,dateReceptionDefinitive:u.dateReceptionDefinitive||void 0,arrets:[],progress:0,folderPath:g,createdAt:m,updatedAt:m};await Le.projects.add(w);const x=E8(u);if(x)try{await _8(r.id,x),console.log(" Entreprise sauvegarde pour autocompltion:",x.nom)}catch(y){console.warn(" Impossible de sauvegarder l'entreprise:",y)}await Le.syncOperations.add({id:`sync:${jr()}`,userId:r.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"CREATE",entity:"project",entityId:d,data:w,timestamp:Date.now(),synced:!1}),console.log(" Projet cr avec succs:",w),t("/projects")}catch(d){console.error(" Erreur cration projet:",d),i(d.message||"Erreur lors de la cration du projet")}finally{s(!1)}}};return c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),c.jsx("span",{children:e("common.back")})]}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:e("project.new")}),c.jsx("p",{className:"text-gray-600 mt-2",children:e("project.createDescription")})]}),c.jsxs("form",{onSubmit:h,className:"card space-y-6",children:[a&&c.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:a}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:u.typeMarche==="normal",onChange:p=>f({...u,typeMarche:p.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:u.typeMarche==="negocie",onChange:p=>f({...u,typeMarche:p.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.objet,onChange:p=>f({...u,objet:p.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.marcheNo,onChange:p=>f({...u,marcheNo:p.target.value}),placeholder:"Ex: 123/2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:u.annee,onChange:p=>f({...u,annee:p.target.value}),placeholder:"2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),c.jsxs("select",{className:"input",value:u.commune,onChange:p=>f({...u,commune:p.target.value}),children:[c.jsx("option",{value:"",children:"-- Slectionner une commune --"}),c.jsxs("optgroup",{label:"Municipalits",children:[c.jsx("option",{value:"Akka",children:"Akka"}),c.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),c.jsx("option",{value:"Tata",children:"Tata"}),c.jsx("option",{value:"Tissint",children:"Tissint"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[c.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),c.jsx("option",{value:"Allougoum",children:"Allougoum"}),c.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),c.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[c.jsx("option",{value:"Icht",children:"Icht"}),c.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[c.jsx("option",{value:"Addis",children:"Addis"}),c.jsx("option",{value:"Aguinane",children:"Aguinane"}),c.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),c.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),c.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),c.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),c.jsx("option",{value:"Tagmout",children:"Tagmout"}),c.jsx("option",{value:"Tlite",children:"Tlite"}),c.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),c.jsxs("select",{required:!0,className:"input",value:u.status,onChange:p=>f({...u,status:p.target.value}),children:[c.jsx("option",{value:"draft",children:"Brouillon"}),c.jsx("option",{value:"active",children:"Actif"}),c.jsx("option",{value:"completed",children:"Termin"}),c.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),c.jsx(A8,{userId:(r==null?void 0:r.id)||"",value:u.societe,onChange:p=>f({...u,societe:p}),onSelect:p=>{f(d=>({...d,societe:p.nom,rc:p.rc||d.rc,cb:p.cb||d.cb,cnss:p.cnss||d.cnss,patente:p.patente||d.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),c.jsx("input",{type:"text",className:"input",value:u.rc,onChange:p=>f({...u,rc:p.target.value}),placeholder:"Ex: 217/2021"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),c.jsx("input",{type:"text",className:"input",value:u.cb,onChange:p=>f({...u,cb:p.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),c.jsx("input",{type:"text",className:"input",value:u.cnss,onChange:p=>f({...u,cnss:p.target.value}),placeholder:"Ex: 4444634"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),c.jsx("input",{type:"text",className:"input",value:u.patente,onChange:p=>f({...u,patente:p.target.value}),placeholder:"Ex: 47730296"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),c.jsx("input",{type:"text",className:"input",value:u.programme,onChange:p=>f({...u,programme:p.target.value}),placeholder:"Ex: 31000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),c.jsx("input",{type:"text",className:"input",value:u.projet,onChange:p=>f({...u,projet:p.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),c.jsx("input",{type:"text",className:"input",value:u.ligne,onChange:p=>f({...u,ligne:p.target.value}),placeholder:"Ex: 24"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),c.jsx("input",{type:"text",className:"input",value:u.chapitre,onChange:p=>f({...u,chapitre:p.target.value}),placeholder:"Ex: 320010/03012"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture"}),c.jsx("input",{type:"date",className:"input",value:u.dateOuverture,onChange:p=>f({...u,dateOuverture:p.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date d'ouverture des plis"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),c.jsx("input",{type:"number",className:"input",value:u.delaisExecution,onChange:p=>f({...u,delaisExecution:p.target.value}),placeholder:"Ex: 10",min:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dure du march en mois"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux)"}),c.jsx("input",{type:"date",className:"input",value:u.osc,onChange:p=>f({...u,osc:p.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:n,children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:n,children:n?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Enregistrement..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Hu,{className:"w-5 h-5"}),c.jsx("span",{children:"Enregistrer"})]})})]})]})]})},hJ=()=>{const{t:e}=Ii(),t=Os(),{id:r}=Ld(),{user:n}=Rn(),[s,a]=ee.useState(!1),[i,o]=ee.useState(null),{canModify:l,reason:u}=Ep(),f=r!=null&&r.startsWith("project:")?r.replace("project:",""):r,{project:h,isLoading:p}=Bd(f||null),[d,m]=ee.useState({objet:"",marcheNo:"",annee:"",dateOuverture:"",typeMarche:"normal",commune:"",societe:"",rc:"",cb:"",cnss:"",patente:"",programme:"",projet:"",ligne:"",chapitre:"",delaisExecution:"",status:"draft",osc:"",dateReceptionProvisoire:"",dateReceptionDefinitive:""}),g=x=>x?/^\d{4}-\d{2}-\d{2}$/.test(x)?x:x.split("T")[0]:"";ee.useEffect(()=>{var x;h&&m({objet:h.objet||"",marcheNo:h.marcheNo||"",annee:h.annee||"",dateOuverture:g(h.dateOuverture),typeMarche:h.typeMarche||"normal",commune:h.commune||"",societe:h.societe||"",rc:h.rc||"",cb:h.cb||"",cnss:h.cnss||"",patente:h.patente||"",programme:h.programme||"",projet:h.projet||"",ligne:h.ligne||"",chapitre:h.chapitre||"",delaisExecution:((x=h.delaisExecution)==null?void 0:x.toString())||"",status:h.status||"draft",osc:g(h.osc),dateReceptionProvisoire:g(h.dateReceptionProvisoire),dateReceptionDefinitive:g(h.dateReceptionDefinitive)})},[h]);const w=async x=>{if(x.preventDefault(),!(!n||!h)){if(!l){o(u||"Vous devez tre connect pour modifier un projet");return}a(!0),o(null);try{const y=new Date().toISOString(),b={objet:d.objet,marcheNo:d.marcheNo,annee:d.annee,dateOuverture:d.dateOuverture,typeMarche:d.typeMarche,commune:d.commune||void 0,societe:d.societe,rc:d.rc,cb:d.cb,cnss:d.cnss,patente:d.patente,programme:d.programme,projet:d.projet,ligne:d.ligne,chapitre:d.chapitre,delaisExecution:d.delaisExecution?parseInt(d.delaisExecution):void 0,status:d.status,osc:d.osc||void 0,dateReceptionProvisoire:d.dateReceptionProvisoire||void 0,dateReceptionDefinitive:d.dateReceptionDefinitive||void 0,folderPath:`${d.annee}/${d.marcheNo}`};if(It()){await Rt.updateProject(f,b),console.log(" [WEB] Projet modifi via API"),t(`/projects/${f}`);return}const S={...h,...b,updatedAt:y};await Le.projects.update(h.id,S);const T=E8(d);if(T)try{await _8(n.id,T),console.log(" Entreprise sauvegarde pour autocompltion:",T.nom)}catch(L){console.warn(" Impossible de sauvegarder l'entreprise:",L)}await Le.syncOperations.add({id:`sync:${jr()}`,userId:n.id,deviceId:localStorage.getItem("deviceId")||"device-001",type:"UPDATE",entity:"project",entityId:h.id,data:S,timestamp:Date.now(),synced:!1}),console.log(" Projet modifi avec succs:",S),t(`/projects/${r}`)}catch(y){console.error(" Erreur modification projet:",y),o(y.message||"Erreur lors de la modification du projet")}finally{a(!1)}}};return!h&&!p?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:It()?"Projet non trouv sur le serveur":"Projet non trouv"})})}):h?c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(-1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),c.jsx("span",{children:e("common.back")})]}),c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Modifier le projet"}),c.jsxs("p",{className:"text-gray-600 mt-2",children:['Modifiez les informations du projet "',h.objet,'"']})]}),c.jsxs("form",{onSubmit:w,className:"card space-y-6",children:[i&&c.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:i}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations gnrales"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Type de march *"}),c.jsxs("div",{className:"flex gap-4",children:[c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"normal",checked:d.typeMarche==="normal",onChange:x=>m({...d,typeMarche:x.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Normal"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"radio",name:"typeMarche",value:"negocie",checked:d.typeMarche==="negocie",onChange:x=>m({...d,typeMarche:x.target.value}),className:"w-4 h-4 text-primary-600"}),c.jsx("span",{className:"text-gray-700",children:"March Ngoci"})]})]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Objet du march *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:d.objet,onChange:x=>m({...d,objet:x.target.value}),placeholder:"Ex: Construction d'un btiment..."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"N March *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:d.marcheNo,onChange:x=>m({...d,marcheNo:x.target.value}),placeholder:"Ex: 123/2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Anne *"}),c.jsx("input",{type:"text",required:!0,className:"input",value:d.annee,onChange:x=>m({...d,annee:x.target.value}),placeholder:"2025"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Commune (CT)"}),c.jsxs("select",{className:"input",value:d.commune,onChange:x=>m({...d,commune:x.target.value}),children:[c.jsx("option",{value:"",children:"-- Slectionner une commune --"}),c.jsxs("optgroup",{label:"Municipalits",children:[c.jsx("option",{value:"Akka",children:"Akka"}),c.jsx("option",{value:"Foum Zguid",children:"Foum Zguid"}),c.jsx("option",{value:"Tata",children:"Tata"}),c.jsx("option",{value:"Tissint",children:"Tissint"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Akka",children:[c.jsx("option",{value:"Ait Rahal",children:"Ait Rahal"}),c.jsx("option",{value:"Allougoum",children:"Allougoum"}),c.jsx("option",{value:"Kasbat Sidi Abdellah Ben Mbarek",children:"Kasbat Sidi Abdellah Ben Mbarek"}),c.jsx("option",{value:"Tighmart",children:"Tighmart"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Foum Zguid",children:[c.jsx("option",{value:"Icht",children:"Icht"}),c.jsx("option",{value:"Tamanarte",children:"Tamanarte"})]}),c.jsxs("optgroup",{label:"Communes Rurales - Cercle Tata",children:[c.jsx("option",{value:"Addis",children:"Addis"}),c.jsx("option",{value:"Aguinane",children:"Aguinane"}),c.jsx("option",{value:"Ait Ouabelli",children:"Ait Ouabelli"}),c.jsx("option",{value:"Kasbat El Harira",children:"Kasbat El Harira"}),c.jsx("option",{value:"Ksar Oulad Abdelhalim",children:"Ksar Oulad Abdelhalim"}),c.jsx("option",{value:"Oum El Guerdane",children:"Oum El Guerdane"}),c.jsx("option",{value:"Tagmout",children:"Tagmout"}),c.jsx("option",{value:"Tlite",children:"Tlite"}),c.jsx("option",{value:"Tizounine",children:"Tizounine"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Statut *"}),c.jsxs("select",{required:!0,className:"input",value:d.status,onChange:x=>m({...d,status:x.target.value}),children:[c.jsx("option",{value:"draft",children:"Brouillon"}),c.jsx("option",{value:"active",children:"Actif"}),c.jsx("option",{value:"completed",children:"Termin"}),c.jsx("option",{value:"archived",children:"Archiv"})]})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations de l'entreprise"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Socit"}),c.jsx(A8,{userId:(n==null?void 0:n.id)||"",value:d.societe,onChange:x=>m({...d,societe:x}),onSelect:x=>{m(y=>({...y,societe:x.nom,rc:x.rc||y.rc,cb:x.cb||y.cb,cnss:x.cnss||y.cnss,patente:x.patente||y.patente}))},placeholder:"Ex: SOUS ISKE TRAVAUX DIVERS(SARL)"}),c.jsx("p",{className:"mt-1 text-xs text-gray-500",children:" Commencez  taper pour voir les entreprises enregistres"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"R.C. n (Registre de Commerce)"}),c.jsx("input",{type:"text",className:"input",value:d.rc,onChange:x=>m({...d,rc:x.target.value}),placeholder:"Ex: 217/2021"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.B n (Compte Bancaire)"}),c.jsx("input",{type:"text",className:"input",value:d.cb,onChange:x=>m({...d,cb:x.target.value}),placeholder:"Ex: 007550604987600000228218"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"C.N.S.S. n (Scurit Sociale)"}),c.jsx("input",{type:"text",className:"input",value:d.cnss,onChange:x=>m({...d,cnss:x.target.value}),placeholder:"Ex: 4444634"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Patente"}),c.jsx("input",{type:"text",className:"input",value:d.patente,onChange:x=>m({...d,patente:x.target.value}),placeholder:"Ex: 47730296"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Informations budgtaires et dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Programme"}),c.jsx("input",{type:"text",className:"input",value:d.programme,onChange:x=>m({...d,programme:x.target.value}),placeholder:"Ex: 31000"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Projet"}),c.jsx("input",{type:"text",className:"input",value:d.projet,onChange:x=>m({...d,projet:x.target.value}),placeholder:"Ex: 47/2025/DPA/TA"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ligne"}),c.jsx("input",{type:"text",className:"input",value:d.ligne,onChange:x=>m({...d,ligne:x.target.value}),placeholder:"Ex: 24"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chapitre"}),c.jsx("input",{type:"text",className:"input",value:d.chapitre,onChange:x=>m({...d,chapitre:x.target.value}),placeholder:"Ex: 320010/03012"})]})]})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gestion des dlais"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date d'ouverture"}),c.jsx("input",{type:"date",className:"input",value:d.dateOuverture,onChange:x=>m({...d,dateOuverture:x.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Date d'ouverture des plis"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dlais d'excution (mois)"}),c.jsx("input",{type:"number",className:"input",value:d.delaisExecution,onChange:x=>m({...d,delaisExecution:x.target.value}),placeholder:"Ex: 10",min:"1"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Dure du march en mois"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"O.S.C (Date dbut des travaux)"}),c.jsx("input",{type:"date",className:"input",value:d.osc,onChange:x=>m({...d,osc:x.target.value})}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ordre de Service de Commencement"})]})]})]}),c.jsxs("div",{className:"flex items-center justify-end gap-4 pt-4 border-t",children:[c.jsx("button",{type:"button",onClick:()=>t(-1),className:"btn btn-secondary",disabled:s,children:"Annuler"}),c.jsx("button",{type:"submit",className:"btn btn-primary flex items-center gap-2",disabled:s,children:s?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),c.jsx("span",{children:"Enregistrement..."})]}):c.jsxs(c.Fragment,{children:[c.jsx(Hu,{className:"w-5 h-5"}),c.jsx("span",{children:"Enregistrer les modifications"})]})})]})]})]}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:e("common.loading")})]})})},pJ=e=>!e||e.length===0?0:e.reduce((t,r)=>{if(r.dateArret&&r.dateReprise){const n=Si(r.dateArret),s=Si(r.dateReprise);if(X0(n)&&X0(s))return t+Ni(s,n)}return t},0),O1=e=>{const t=new Date,r=e.osc?Si(e.osc):null;if(!r||!X0(r))return{status:"no-data",message:"Date OSC non dfinie"};const n=e.delaisExecution||0;if(n===0)return{status:"no-data",message:"Dlai non dfini"};const s=n*30,a=pJ(e.arrets),i=Uh(r,n),o=rU(i,a),l=Ni(t,r),u=Ni(o,t),f=s+a,h=Math.min(100,Math.max(0,l/f*100));let p;return e.dateReceptionDefinitive||e.dateReceptionProvisoire?p="completed":u<0?p="overdue":u<=15?p="critical":u<=30?p="warning":p="normal",{status:p,oscDate:r,delaiMois:n,delaiJours:s,joursArret:a,dateFinInitiale:i,dateFinEffective:o,joursEcoules:l,joursRestants:u,pourcentage:h,delaiTotal:f}},j8={normal:{bg:"bg-green-100",text:"text-green-700",border:"border-green-200",progress:"bg-green-500"},warning:{bg:"bg-yellow-100",text:"text-yellow-700",border:"border-yellow-200",progress:"bg-yellow-500"},critical:{bg:"bg-red-100",text:"text-red-700",border:"border-red-200",progress:"bg-red-500"},completed:{bg:"bg-gray-100",text:"text-gray-700",border:"border-gray-200",progress:"bg-gray-500"},overdue:{bg:"bg-purple-100",text:"text-purple-700",border:"border-purple-200",progress:"bg-purple-500"},"no-data":{bg:"bg-gray-50",text:"text-gray-400",border:"border-gray-100",progress:"bg-gray-300"}},mJ={normal:"En cours",warning:"Alerte",critical:"Critique",completed:"Termin",overdue:"Dpass","no-data":"Non configur"},gJ={normal:pl,warning:G0,critical:ET,completed:go,overdue:G0,"no-data":pl},xJ=()=>{const{user:e}=Rn(),[t,r]=ee.useState(null),[n,s]=ee.useState("all"),{projects:a,isLoading:i,refresh:o}=Db((e==null?void 0:e.id)||null),l=(a==null?void 0:a.reduce((p,d)=>{const m=O1(d);return p[m.status]=(p[m.status]||0)+1,p},{}))||{},u=(a==null?void 0:a.filter(p=>n==="all"?!0:O1(p).status===n))||[],f=async(p,d)=>{const m=a==null?void 0:a.find(x=>x.id===p);if(!m||!e)return;const g={id:jr(),...d},w=[...m.arrets||[],g];if(It())try{await Rt.updateProject(p.replace("project:",""),{arrets:w}),o()}catch(x){console.error("Error updating project:",x)}else await Le.projects.update(p,{arrets:w,updatedAt:new Date().toISOString()});(t==null?void 0:t.id)===p&&r({...t,arrets:w})},h=async(p,d)=>{const m=a==null?void 0:a.find(w=>w.id===p);if(!m||!e)return;const g=(m.arrets||[]).filter(w=>w.id!==d);if(It())try{await Rt.updateProject(p.replace("project:",""),{arrets:g}),o()}catch(w){console.error("Error updating project:",w)}else await Le.projects.update(p,{arrets:g,updatedAt:new Date().toISOString()});(t==null?void 0:t.id)===p&&r({...t,arrets:g})};return i?c.jsx("div",{className:"flex items-center justify-center h-96",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestion des Dlais"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Suivi des dlais d'excution de tous les projets"})]})}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-green-100 flex items-center justify-center",children:c.jsx(pl,{className:"w-6 h-6 text-green-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.normal||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"En cours"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-yellow-100 flex items-center justify-center",children:c.jsx(G0,{className:"w-6 h-6 text-yellow-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.warning||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Alerte"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-red-100 flex items-center justify-center",children:c.jsx(ET,{className:"w-6 h-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.critical||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Critique"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-purple-100 flex items-center justify-center",children:c.jsx(G0,{className:"w-6 h-6 text-purple-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.overdue||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Dpass"})]})]}),c.jsxs("div",{className:"card p-4 flex items-center gap-3",children:[c.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-100 flex items-center justify-center",children:c.jsx(go,{className:"w-6 h-6 text-gray-600"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.completed||0}),c.jsx("p",{className:"text-sm text-gray-500",children:"Termins"})]})]})]}),c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("select",{className:"input w-48",value:n,onChange:p=>s(p.target.value),children:[c.jsx("option",{value:"all",children:"Tous les projets"}),c.jsx("option",{value:"normal",children:"En cours"}),c.jsx("option",{value:"warning",children:"Alerte"}),c.jsx("option",{value:"critical",children:"Critique"}),c.jsx("option",{value:"overdue",children:"Dpass"}),c.jsx("option",{value:"completed",children:"Termins"}),c.jsx("option",{value:"no-data",children:"Non configur"})]}),c.jsxs("span",{className:"text-gray-500",children:[u.length," projet(s)"]})]}),c.jsxs("div",{className:"space-y-4",children:[u.map(p=>{const d=O1(p),m=j8[d.status],g=gJ[d.status];return c.jsxs("div",{className:"card p-5",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:p.objet}),c.jsxs("span",{className:`flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full ${m.bg} ${m.text}`,children:[c.jsx(g,{className:"w-3 h-3"}),mJ[d.status]]})]}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",p.marcheNo,"  ",p.societe||"Socit non dfinie"]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:()=>r(p),className:"btn btn-secondary btn-sm flex items-center gap-1",children:[c.jsx(Ag,{className:"w-4 h-4"}),"Dtails"]}),c.jsxs(ji,{to:`/projects/${p.id.replace("project:","")}`,className:"btn btn-secondary btn-sm flex items-center gap-1",children:[c.jsx(yn,{className:"w-4 h-4"}),"Projet"]})]})]}),d.status!=="no-data"&&typeof d.pourcentage=="number"&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"flex items-center justify-between text-sm mb-1",children:[c.jsx("span",{className:"text-gray-600",children:"Progression"}),c.jsxs("span",{className:"font-medium",children:[Math.round(d.pourcentage),"%"]})]}),c.jsx("div",{className:"w-full h-3 bg-gray-100 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full ${m.progress} transition-all duration-300`,style:{width:`${Math.min(100,d.pourcentage)}%`}})})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Dbut (OSC)"}),c.jsx("p",{className:"font-medium",children:d.oscDate?oa(d.oscDate,"dd/MM/yyyy"):"-"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Dlai"}),c.jsxs("p",{className:"font-medium",children:[d.delaiMois," mois"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Jours d'arrt"}),c.jsxs("p",{className:"font-medium text-orange-600",children:[d.joursArret," j"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Fin prvue"}),c.jsx("p",{className:"font-medium",children:d.dateFinEffective?oa(d.dateFinEffective,"dd/MM/yyyy"):"-"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-500",children:"Reste"}),c.jsx("p",{className:`font-bold ${(d.joursRestants??0)<0?"text-purple-600":(d.joursRestants??0)<=15?"text-red-600":(d.joursRestants??0)<=30?"text-yellow-600":"text-green-600"}`,children:(d.joursRestants??0)<0?`${Math.abs(d.joursRestants??0)}j de retard`:`${d.joursRestants??0} jours`})]})]})]}),d.status==="no-data"&&c.jsx("p",{className:"text-gray-400 text-sm italic",children:d.message})]},p.id)}),u.length===0&&c.jsxs("div",{className:"card p-12 text-center",children:[c.jsx(pl,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Aucun projet trouv"})]})]}),t&&c.jsx(vJ,{project:t,onClose:()=>r(null),onAddArret:f,onDeleteArret:h})]})},vJ=({project:e,onClose:t,onAddArret:r,onDeleteArret:n})=>{const[s,a]=ee.useState(!1),[i,o]=ee.useState({dateArret:"",dateReprise:"",motif:""}),l=O1(e),u=j8[l.status],f=async()=>{!i.dateArret||!i.motif||(await r(e.id,{dateArret:i.dateArret,dateReprise:i.dateReprise||void 0,motif:i.motif}),o({dateArret:"",dateReprise:"",motif:""}),a(!1))};return c.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[c.jsx("div",{className:"p-6 border-b sticky top-0 bg-white z-10",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Dtails du Dlai"}),c.jsx("p",{className:"text-gray-500",children:e.objet})]}),c.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(Ac,{className:"w-5 h-5"})})]})}),c.jsxs("div",{className:"p-6 space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500",children:"Dlai contractuel"}),c.jsxs("p",{className:"text-xl font-bold",children:[l.delaiMois||0," mois"]})]}),c.jsxs("div",{className:"p-4 bg-orange-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-orange-600",children:"Jours d'arrt"}),c.jsxs("p",{className:"text-xl font-bold text-orange-700",children:[l.joursArret||0," jours"]})]}),c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[c.jsx("p",{className:"text-sm text-blue-600",children:"Dlai effectif"}),c.jsxs("p",{className:"text-xl font-bold text-blue-700",children:[l.delaiTotal||0," jours"]})]}),c.jsxs("div",{className:`p-4 rounded-lg ${u.bg}`,children:[c.jsx("p",{className:`text-sm ${u.text}`,children:"Jours restants"}),c.jsx("p",{className:`text-xl font-bold ${u.text}`,children:l.joursRestants!==void 0?l.joursRestants<0?`${Math.abs(l.joursRestants)} retard`:l.joursRestants:"-"})]})]}),l.status!=="no-data"&&l.oscDate&&l.dateFinEffective&&c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Timeline"}),c.jsxs("div",{className:"relative",children:[c.jsx("div",{className:"h-2 bg-gray-200 rounded-full",children:c.jsx("div",{className:`h-full ${u.progress} rounded-full`,style:{width:`${Math.min(100,l.pourcentage||0)}%`}})}),c.jsxs("div",{className:"flex justify-between mt-2 text-xs text-gray-500",children:[c.jsxs("span",{children:["OSC: ",oa(l.oscDate,"dd/MM/yyyy")]}),c.jsxs("span",{children:["Fin: ",oa(l.dateFinEffective,"dd/MM/yyyy")]})]})]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"font-semibold text-gray-900",children:"Historique des Arrts"}),c.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary btn-sm flex items-center gap-1",children:[c.jsx(Gs,{className:"w-4 h-4"}),"Ajouter un arrt"]})]}),s&&c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg mb-4 space-y-3",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date d'arrt (OSA) *"}),c.jsx("input",{type:"date",className:"input",value:i.dateArret,onChange:h=>o({...i,dateArret:h.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date de reprise (OSR)"}),c.jsx("input",{type:"date",className:"input",value:i.dateReprise,onChange:h=>o({...i,dateReprise:h.target.value})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motif *"}),c.jsx("input",{type:"text",className:"input",placeholder:"Ex: Vague de froid",value:i.motif,onChange:h=>o({...i,motif:h.target.value})})]})]}),c.jsxs("div",{className:"flex justify-end gap-2",children:[c.jsx("button",{onClick:()=>a(!1),className:"btn btn-secondary btn-sm",children:"Annuler"}),c.jsxs("button",{onClick:f,className:"btn btn-primary btn-sm flex items-center gap-1",disabled:!i.dateArret||!i.motif,children:[c.jsx(Hu,{className:"w-4 h-4"}),"Enregistrer"]})]})]}),e.arrets&&e.arrets.length>0?c.jsx("div",{className:"border rounded-lg overflow-hidden",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Arrt (OSA)"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Reprise (OSR)"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Dure"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-gray-600",children:"Motif"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium text-gray-600",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y",children:e.arrets.map((h,p)=>{const d=h.dateArret&&h.dateReprise?Ni(Si(h.dateReprise),Si(h.dateArret)):null;return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-sm",children:p+1}),c.jsx("td",{className:"px-4 py-3 text-sm",children:c.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[c.jsx(vS,{className:"w-3 h-3"}),h.dateArret?oa(Si(h.dateArret),"dd/MM/yyyy"):"-"]})}),c.jsx("td",{className:"px-4 py-3 text-sm",children:h.dateReprise?c.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[c.jsx(vB,{className:"w-3 h-3"}),oa(Si(h.dateReprise),"dd/MM/yyyy")]}):c.jsx("span",{className:"text-orange-500 italic",children:"En cours"})}),c.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:d!==null?`${d} jours`:"-"}),c.jsx("td",{className:"px-4 py-3 text-sm",children:h.motif}),c.jsx("td",{className:"px-4 py-3 text-center",children:c.jsx("button",{onClick:()=>n(e.id,h.id),className:"p-1 text-red-500 hover:bg-red-50 rounded",title:"Supprimer",children:c.jsx(Ac,{className:"w-4 h-4"})})})]},h.id)})})]})}):c.jsxs("div",{className:"text-center py-8 text-gray-400",children:[c.jsx(vS,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),c.jsx("p",{children:"Aucun arrt enregistr"})]})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Dates importantes"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Ordre de Service (OSC)"}),c.jsx("p",{className:"font-medium",children:e.osc?oa(Si(e.osc),"dd/MM/yyyy"):"Non dfini"})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Provisoire"}),c.jsx("p",{className:"font-medium",children:e.dateReceptionProvisoire?oa(Si(e.dateReceptionProvisoire),"dd/MM/yyyy"):"Non dfini"})]}),c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsx("p",{className:"text-sm text-gray-500 mb-1",children:"Rception Dfinitive"}),c.jsx("p",{className:"font-medium",children:e.dateReceptionDefinitive?oa(Si(e.dateReceptionDefinitive),"dd/MM/yyyy"):"Non dfini"})]})]})]})]}),c.jsx("div",{className:"p-6 border-t bg-gray-50 flex justify-end gap-3",children:c.jsx("button",{onClick:t,className:"btn btn-secondary",children:"Fermer"})})]})})},yJ=()=>{const{projectId:e}=Ld(),t=Os(),{user:r}=Rn(),[n,s]=ee.useState(null),a=e!=null&&e.includes(":")?e:`project:${e}`,i=e!=null&&e.includes(":")?e.split(":").pop():e,{project:o,isLoading:l}=Bd(a),{bordereau:u,refresh:f}=_p(a),h=async m=>{if(!r||!a)return;const g=`bordereau:${jr()}`,w=g.replace("bordereau:",""),x=new Date().toISOString(),y={id:g,projectId:a,userId:r.id,reference:m.reference,designation:m.designation,lignes:[],montantTotal:0,createdAt:x,updatedAt:x};if(It())try{await Rt.createBordereau({projectId:i,reference:m.reference,designation:m.designation,lignes:[],montantTotal:0}),await f()}catch(b){throw console.error("Failed to create bordereau:",b),b}else await Le.bordereaux.add(y),await us("CREATE","bordereau",w,y,r.id);s(null)},[p,d]=ee.useState(!1);return ee.useEffect(()=>{const m=setTimeout(()=>{!o&&!l&&d(!0)},5e3);return()=>clearTimeout(m)},[o,l]),l||!o?p?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx(Za,{className:"w-12 h-12 text-yellow-500 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-700 font-medium mb-2",children:"Projet non trouv"}),c.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"Synchronisez les donnes ou vrifiez l'URL"}),c.jsx("button",{onClick:()=>t("/projects"),className:"btn btn-primary",children:"Retour aux projets"})]})}):c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>t(`/projects/${a}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),"Retour au projet"]}),c.jsx("div",{className:"flex items-start justify-between",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Bordereau des Prix"}),c.jsx("p",{className:"text-gray-600",children:o.objet}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",o.marcheNo," - ",o.annee]})]})})]}),u?c.jsx(IT,{bordereauId:u.id,onClose:()=>t(`/projects/${a}`)}):c.jsxs("div",{className:"card",children:[c.jsxs("div",{className:"text-center py-8 mb-6",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Crer le bordereau"}),c.jsx("p",{className:"text-gray-600",children:"Choisissez la mthode qui vous convient"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsx("button",{onClick:()=>s("blank"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Gs,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Nouveau vide"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Crer un bordereau depuis zro"})]})}),c.jsx("button",{onClick:()=>s("template"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(kT,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Depuis bibliothque"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Utiliser des articles prdfinis"})]})}),c.jsx("button",{onClick:()=>s("copy"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Eg,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Copier un projet"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Dupliquer depuis un projet existant"})]})}),c.jsx("button",{onClick:()=>s("import"),className:"card hover:shadow-lg transition-all border-2 border-transparent hover:border-primary-500 cursor-pointer",children:c.jsxs("div",{className:"text-center py-6",children:[c.jsx("div",{className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center mx-auto mb-3",children:c.jsx(Fb,{className:"w-6 h-6"})}),c.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Importer Excel"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Charger un fichier Excel existant"})]})})]})]}),n==="blank"&&c.jsx(MT,{onClose:()=>s(null),onCreate:h}),n==="template"&&c.jsx(BT,{projectId:a,onClose:()=>s(null),onCreated:()=>s(null)}),n==="copy"&&c.jsx(UT,{currentProjectId:a,onClose:()=>s(null),onCopied:()=>s(null)}),n==="import"&&c.jsx(b8,{projectId:a,onClose:()=>s(null),onImported:()=>s(null)})]})},T8={"M":{unite:"M",type:"volume",label:"Volume",formule:"Longueur  Largeur  Profondeur",champs:["longueur","largeur","profondeur"],description:"Calcul de volume (terrassement, bton, etc.)"},"M":{unite:"M",type:"surface",label:"Surface",formule:"Longueur  Largeur",champs:["longueur","largeur"],description:"Calcul de surface (carrelage, enduit, etc.)"},ML:{unite:"ML",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},M:{unite:"M",type:"lineaire",label:"Linaire",formule:"Longueur",champs:["longueur"],description:"Mtrage linaire"},KG:{unite:"KG",type:"poids",label:"Poids (KG)",formule:"Nombre  Longueur  Poids unitaire",champs:["nombre","longueur","diametre"],description:"Poids en kilogrammes (ferraillage)"},T:{unite:"T",type:"poids",label:"Poids (T)",formule:"Nombre  Longueur  Poids unitaire  1000",champs:["nombre","longueur","diametre"],description:"Poids en tonnes (ferraillage)"},U:{unite:"U",type:"unite",label:"Unit",formule:"Nombre",champs:["nombre"],description:"Nombre d'units"},ENS:{unite:"ENS",type:"unite",label:"Ensemble",formule:"Nombre",champs:["nombre"],description:"Nombre d'ensembles"}};function wJ(e){return T8[e]}const bJ={6:.222,8:.395,10:.617,12:.888,14:1.208,16:1.578,20:2.466,25:3.854,32:6.313,40:9.864};function NJ(e){return bJ[e]||0}function SJ(e,t,r,n,s,a,i){const o=T8[e],l=i&&i>0?i:1;let u=0;switch(o.type){case"volume":u=(t||0)*(r||0)*(n||0);break;case"surface":u=(t||0)*(r||0);break;case"lineaire":u=t||0;break;case"poids":{const f=NJ(a||0),h=(s||0)*(t||0)*f;u=e==="T"?h/1e3:h;break}case"unite":u=s||0;break;default:u=0}return u*l}const Fk=[{bg:"bg-blue-100",border:"border-blue-400",text:"text-blue-800",header:"bg-blue-500"},{bg:"bg-green-100",border:"border-green-400",text:"text-green-800",header:"bg-green-500"},{bg:"bg-purple-100",border:"border-purple-400",text:"text-purple-800",header:"bg-purple-500"},{bg:"bg-orange-100",border:"border-orange-400",text:"text-orange-800",header:"bg-orange-500"},{bg:"bg-pink-100",border:"border-pink-400",text:"text-pink-800",header:"bg-pink-500"},{bg:"bg-cyan-100",border:"border-cyan-400",text:"text-cyan-800",header:"bg-cyan-500"}],Dk=[{bg:"bg-red-50",border:"border-red-300",text:"text-red-700"},{bg:"bg-amber-50",border:"border-amber-300",text:"text-amber-700"},{bg:"bg-lime-50",border:"border-lime-300",text:"text-lime-700"},{bg:"bg-teal-50",border:"border-teal-300",text:"text-teal-700"},{bg:"bg-indigo-50",border:"border-indigo-300",text:"text-indigo-700"}],jh=()=>{const{projectId:e,periodeId:t}=Ld(),r=Os(),{user:n}=Rn(),{setDirty:s,clearDirty:a}=Cb(),i=`metre-${e}-${t}`,[o,l]=ee.useState([]),[u,f]=ee.useState(!1),[h,p]=ee.useState(!1),[d,m]=ee.useState(!1),[g,w]=ee.useState(null),[x,y]=ee.useState(null),[b,S]=ee.useState(!1),[T,L]=ee.useState(new Date().toISOString().split("T")[0]),[A,D]=ee.useState(!1),C=ee.useRef(!1),O=e!=null&&e.includes(":")?e:`project:${e}`,E=t?t.includes(":")?t:`periode:${t}`:null;ee.useEffect(()=>()=>{a(i)},[i,a]),ee.useEffect(()=>{const we=Je=>{if(b)return Je.preventDefault(),Je.returnValue="Vous avez des modifications non enregistres. Voulez-vous vraiment quitter?",Je.returnValue};return window.addEventListener("beforeunload",we),()=>window.removeEventListener("beforeunload",we)},[b]);const P=ee.useCallback(()=>{C.current=!0,b||(S(!0),s(i,`Mtr ${t}`))},[b,i,t,s]),q=ee.useCallback(()=>{C.current=!1,S(!1),a(i)},[i,a]),{project:M,refresh:ne}=Bd(O),{bordereau:fe,refresh:me}=_p(O),{periodes:re,refresh:G}=Tx(O),{metres:ge,refresh:ve}=Cx(O),_=ee.useMemo(()=>{if(!E||!re)return;const we=E.replace("periode:","");return re.find(Je=>Je.id===E||Je.id===we)},[E,re]);ee.useEffect(()=>{if(_){const we=_.dateFin||_.dateDebut||new Date().toISOString();L(we.split("T")[0]),D(_.isDecompteDernier||!1)}},[_]);const R=we=>we?we.replace(/^bordereau:/,""):"",I=we=>Fk[we%Fk.length],B=we=>Dk[we%Dk.length],W=ee.useMemo(()=>_?_.numero:0,[_]),se=ee.useMemo(()=>{if(!ge||!re||!E)return new Map;const we=new Map,Je=[...re].sort((De,Ge)=>De.numero-Ge.numero);for(const De of ge){const Ge=Je.find(bt=>bt.id===De.periodeId);if(!Ge||Ge.numero>=W)continue;const Re=R(De.bordereauLigneId);we.has(Re)||we.set(Re,{sections:[],subSections:[],lignes:[],total:0});const Pe=we.get(Re);if(De.sections)for(const bt of De.sections){const Qe={...bt,periodeId:De.periodeId,periodeNumero:Ge.numero,isFromPreviousPeriode:De.periodeId!==E};Pe.sections.push(Qe)}if(De.subSections)for(const bt of De.subSections){const Qe={...bt,periodeId:De.periodeId,periodeNumero:Ge.numero,isFromPreviousPeriode:De.periodeId!==E};Pe.subSections.push(Qe)}if(De.lignes)for(const bt of De.lignes){const Qe={...bt,periodeId:De.periodeId,periodeNumero:Ge.numero,isFromPreviousPeriode:De.periodeId!==E};Pe.lignes.push(Qe)}Pe.total+=De.totalPartiel||0}return we},[ge,re,E,W]),pe=ee.useRef(!1);ee.useEffect(()=>{if(C.current||b){console.log(" Skipping data reload - unsaved changes present (ref:",C.current,", state:",b,")");return}if(fe&&ge!==void 0&&_){const we=fe.lignes.map(Je=>{var yt,qt,Tr,wr,Qr;const Ge=`${R(fe.id)}-ligne-${Je.numero}`,Re=se.get(Ge),Pe=ge==null?void 0:ge.find(ut=>R(ut.bordereauLigneId)===Ge&&ut.periodeId===E);console.log(" Loading data for ligne:",Ge,{foundCurrentMetre:!!Pe,currentMetreId:Pe==null?void 0:Pe.id,currentMetreSections:((yt=Pe==null?void 0:Pe.sections)==null?void 0:yt.length)||0,currentMetreSubSections:((qt=Pe==null?void 0:Pe.subSections)==null?void 0:qt.length)||0,currentMetreLignes:((Tr=Pe==null?void 0:Pe.lignes)==null?void 0:Tr.length)||0,rawSections:Pe==null?void 0:Pe.sections,rawSubSections:Pe==null?void 0:Pe.subSections,cumulData:Re?{sections:(wr=Re.sections)==null?void 0:wr.length,lignes:(Qr=Re.lignes)==null?void 0:Qr.length}:null});const bt=[...(Re==null?void 0:Re.sections)||[],...((Pe==null?void 0:Pe.sections)||[]).map(ut=>({...ut,periodeId:E,periodeNumero:_.numero,isFromPreviousPeriode:!1}))],Qe=[...(Re==null?void 0:Re.subSections)||[],...((Pe==null?void 0:Pe.subSections)||[]).map(ut=>({...ut,periodeId:E,periodeNumero:_.numero,isFromPreviousPeriode:!1}))],Ve=[...(Re==null?void 0:Re.lignes)||[],...((Pe==null?void 0:Pe.lignes)||[]).map(ut=>({...ut,periodeId:E,periodeNumero:_.numero,isFromPreviousPeriode:!1}))];return{bordereauLigneId:Ge,numeroLigne:Je.numero,designation:Je.designation,unite:Je.unite,quantiteBordereau:Je.quantite,prixUnitaire:Je.prixUnitaire||0,sections:bt,subSections:Qe,lignes:Ve,isExpanded:!1,cumulPrecedent:(Re==null?void 0:Re.total)||0}});l(we),pe.current||(pe.current=!0)}},[fe,ge,se,_,b,E]);const he=we=>{const Je=o.find(Ge=>Ge.bordereauLigneId===we);if(!Je)return;P();const De={id:`section-${jr()}`,titre:"",ordre:Je.sections.length+1,isCollapsed:!1,isFromPreviousPeriode:!1};l(Ge=>Ge.map(Re=>Re.bordereauLigneId===we?{...Re,sections:[...Re.sections,De],isExpanded:!0}:Re)),w(De.id)},de=(we,Je,De)=>{P(),l(Ge=>Ge.map(Re=>Re.bordereauLigneId===we?{...Re,sections:Re.sections.map(Pe=>Pe.id===Je?{...Pe,titre:De}:Pe)}:Re))},je=(we,Je)=>{confirm("Supprimer cette section et toutes ses sous-sections et mesures ?")&&(P(),l(De=>De.map(Ge=>Ge.bordereauLigneId===we?{...Ge,sections:Ge.sections.filter(Re=>Re.id!==Je),subSections:Ge.subSections.filter(Re=>Re.sectionId!==Je),lignes:Ge.lignes.filter(Re=>Re.sectionId!==Je)}:Ge)))},Y=(we,Je)=>{l(De=>De.map(Ge=>Ge.bordereauLigneId===we?{...Ge,sections:Ge.sections.map(Re=>Re.id===Je?{...Re,isCollapsed:!Re.isCollapsed}:Re)}:Ge))},We=(we,Je)=>{const De=o.find(Ve=>Ve.bordereauLigneId===we);if(!De)return;P();const Ge=De.subSections.filter(Ve=>Ve.sectionId===Je),Re=De.unite==="KG"||De.unite==="T",Pe=`subsection-${jr()}`,bt={id:Pe,sectionId:Je,titre:"",ordre:Ge.length+1,isCollapsed:!1,nombreElements:1,isFromPreviousPeriode:!1},Qe=Re?[{id:`${we}-mesure-${Date.now()}-1`,sectionId:Je,subSectionId:Pe,numero:1,designation:"filantes Longi  f 10 mm   esp 0,20",partiel:0,isFromPreviousPeriode:!1},{id:`${we}-mesure-${Date.now()}-2`,sectionId:Je,subSectionId:Pe,numero:2,designation:"Cadres filantes  f 8 mm   esp 0,20",partiel:0,isFromPreviousPeriode:!1}]:[];l(Ve=>Ve.map(yt=>yt.bordereauLigneId===we?{...yt,subSections:[...yt.subSections,bt],lignes:[...yt.lignes,...Qe]}:yt)),y(bt.id)},Ke=(we,Je,De)=>{P(),l(Ge=>Ge.map(Re=>Re.bordereauLigneId===we?{...Re,subSections:Re.subSections.map(Pe=>Pe.id===Je?{...Pe,titre:De}:Pe)}:Re))},J=(we,Je,De)=>{P(),l(Ge=>Ge.map(Re=>Re.bordereauLigneId===we?{...Re,subSections:Re.subSections.map(Pe=>Pe.id===Je?{...Pe,nombreElements:De}:Pe)}:Re))},ze=(we,Je)=>{confirm("Supprimer cette sous-section et toutes ses mesures ?")&&(P(),l(De=>De.map(Ge=>Ge.bordereauLigneId===we?{...Ge,subSections:Ge.subSections.filter(Re=>Re.id!==Je),lignes:Ge.lignes.filter(Re=>Re.subSectionId!==Je)}:Ge)))},He=(we,Je)=>{l(De=>De.map(Ge=>Ge.bordereauLigneId===we?{...Ge,subSections:Ge.subSections.map(Re=>Re.id===Je?{...Re,isCollapsed:!Re.isCollapsed}:Re)}:Ge))},it=(we,Je,De)=>{const Ge=o.find(Qe=>Qe.bordereauLigneId===we);if(!Ge)return;P();let Re=Ge.lignes;De?Re=Ge.lignes.filter(Qe=>Qe.subSectionId===De):Je&&(Re=Ge.lignes.filter(Qe=>Qe.sectionId===Je&&!Qe.subSectionId));const Pe=Re.length+1,bt={id:`${we}-mesure-${Date.now()}`,sectionId:Je,subSectionId:De,numero:Pe,designation:"",partiel:0,isFromPreviousPeriode:!1};l(Qe=>Qe.map(Ve=>Ve.bordereauLigneId===we?{...Ve,lignes:[...Ve.lignes,bt],isExpanded:!0}:Ve))},qe=(we,Je)=>{P(),l(De=>De.map(Ge=>Ge.bordereauLigneId===we?{...Ge,lignes:Ge.lignes.filter(Re=>Re.id!==Je)}:Ge))},ht=(we,Je,De,Ge)=>{P(),l(Re=>Re.map(Pe=>{if(Pe.bordereauLigneId!==we)return Pe;const bt=Pe.lignes.map(Qe=>{if(Qe.id!==Je)return Qe;const Ve={...Qe,[De]:Ge};if(["nombreSemblables","nombreElements","longueur","largeur","profondeur","nombre","diametre"].includes(De)){const yt=SJ(Pe.unite,Ve.longueur,Ve.largeur,Ve.profondeur,Ve.nombre,Ve.diametre,Ve.nombreSemblables),qt=Ve.nombreElements||1;Ve.partiel=yt*qt}return Ve});return{...Pe,lignes:bt}}))},ct=we=>{l(Je=>Je.map(De=>De.bordereauLigneId===we?{...De,isExpanded:!De.isExpanded}:De))},Et=async()=>{var we,Je,De,Ge,Re,Pe;if(!n||!O||!fe||!E){alert(" Erreur: Priode non dfinie. Veuillez revenir  la liste des mtrs.");return}f(!0);try{const bt=new Date().toISOString();console.log(" Starting save... metresQuick count:",o.length),console.log(" periodeId:",E),console.log(" projectId:",O),console.log(" allProjectMetres:",ge==null?void 0:ge.length,ge==null?void 0:ge.map(Ve=>({id:Ve.id,bordereauLigneId:Ve.bordereauLigneId,periodeId:Ve.periodeId})));for(const Ve of o){const yt=Ve.sections.filter(St=>St.isFromPreviousPeriode!==!0),qt=Ve.subSections.filter(St=>St.isFromPreviousPeriode!==!0),Tr=Ve.lignes.filter(St=>St.isFromPreviousPeriode!==!0);console.log(" Article:",Ve.bordereauLigneId),console.log("  - All sections:",Ve.sections.length,"Current:",yt.length),console.log("  - All subSections:",Ve.subSections.length,"Current:",qt.length),console.log("  - All lignes:",Ve.lignes.length,"Current:",Tr.length),console.log("  - Lignes data:",Ve.lignes.map(St=>({id:St.id,partiel:St.partiel,isFromPrev:St.isFromPreviousPeriode})));const wr=Tr.reduce((St,H)=>St+(H.partiel||0),0),Qr=Ve.lignes.reduce((St,H)=>St+(H.partiel||0),0),ut=Ve.quantiteBordereau>0?Qr/Ve.quantiteBordereau*100:0,gs=Math.min(Math.max(ut,-999.99),999.99),Vr=ge==null?void 0:ge.find(St=>St.bordereauLigneId===Ve.bordereauLigneId&&St.periodeId===E);console.log("   Looking for existing metre:",{searchBordereauLigneId:Ve.bordereauLigneId,searchPeriodeId:E,found:!!Vr,existingMetreId:Vr==null?void 0:Vr.id,allMetresCount:ge==null?void 0:ge.length,allMetresBordereauIds:ge==null?void 0:ge.map(St=>St.bordereauLigneId)});const Rr=yt.map(St=>{const{periodeId:H,periodeNumero:ae,isFromPreviousPeriode:Q,...te}=St;return te}),Kr=qt.map(St=>{const{periodeId:H,periodeNumero:ae,isFromPreviousPeriode:Q,...te}=St;return te}),fr=Tr.map(St=>{const{periodeId:H,periodeNumero:ae,isFromPreviousPeriode:Q,...te}=St;return te});if(fr.length===0&&Rr.length===0&&Kr.length===0){console.log("   Skipping - no data for current period");continue}if(console.log("   Saving:",fr.length,"lignes,",Rr.length,"sections,",Kr.length,"subSections"),console.log("   Clean Sections to save:",JSON.stringify(Rr)),console.log("   Clean SubSections to save:",JSON.stringify(Kr)),console.log("   Clean Lignes to save:",JSON.stringify(fr)),It()){const St={projectId:O.replace("project:",""),periodeId:E.replace("periode:",""),bordereauLigneId:Ve.bordereauLigneId,userId:n.id.replace("user:",""),reference:`METRE-L${Ve.numeroLigne}`,designationBordereau:Ve.designation,unite:Ve.unite,sections:Rr,subSections:Kr,lignes:fr,totalPartiel:wr,totalCumule:Qr,quantiteBordereau:Ve.quantiteBordereau,pourcentageRealisation:gs};Vr?(console.log("   [WEB] Updating existing metre:",Vr.id),await Rt.updateMetre(Vr.id.replace("metre:",""),St),console.log("   [WEB] Metre updated successfully!")):(console.log("   [WEB] Creating new metre"),await Rt.createMetre(St),console.log("   [WEB] Metre created successfully!"))}else if(Vr){console.log("   Updating existing metre:",Vr.id,{sections:Rr,subSections:Kr,lignes:fr}),await Le.metres.update(Vr.id,{sections:Rr,subSections:Kr,lignes:fr,totalPartiel:wr,totalCumule:Qr,pourcentageRealisation:gs,updatedAt:bt}),console.log("   Metre updated successfully!");const St=await Le.metres.get(Vr.id);console.log("   Verification - Updated metre:",St?{id:St.id,sectionsCount:(we=St.sections)==null?void 0:we.length,subSectionsCount:(Je=St.subSections)==null?void 0:Je.length,lignesCount:(De=St.lignes)==null?void 0:De.length,sections:St.sections,lignes:St.lignes}:"NOT FOUND!"),await us("UPDATE","metre",Vr.id.replace("metre:",""),{sections:Rr,subSections:Kr,lignes:fr,totalPartiel:wr,totalCumule:Qr,pourcentageRealisation:gs},n.id)}else{const St=`metre:${jr()}`;console.log("   Creating new metre:",St,{bordereauLigneId:Ve.bordereauLigneId,sections:Rr,subSections:Kr,lignes:fr});const H={id:St,projectId:O,periodeId:E,bordereauLigneId:Ve.bordereauLigneId,userId:n.id,reference:`METRE-L${Ve.numeroLigne}`,designationBordereau:Ve.designation,unite:Ve.unite,sections:Rr,subSections:Kr,lignes:fr,totalPartiel:wr,totalCumule:Qr,quantiteBordereau:Ve.quantiteBordereau,pourcentageRealisation:gs,createdAt:bt,updatedAt:bt};await Le.metres.add(H),console.log("   Metre created successfully!");const ae=await Le.metres.get(St);console.log("   Verification - Saved metre:",ae?{id:ae.id,sectionsCount:(Ge=ae.sections)==null?void 0:Ge.length,subSectionsCount:(Re=ae.subSections)==null?void 0:Re.length,lignesCount:(Pe=ae.lignes)==null?void 0:Pe.length}:"NOT FOUND!"),await us("CREATE","metre",St.replace("metre:",""),H,n.id)}}const Qe={dateFin:T+"T23:59:59.999Z",isDecompteDernier:A,updatedAt:bt};It()?await Rt.updatePeriode(E.replace("periode:",""),Qe):(await Le.periodes.update(E,Qe),await us("UPDATE","periode",E.replace("periode:",""),{dateFin:T,isDecompteDernier:A},n.id)),q(),await ve(),await G(),alert(" Mtrs enregistrs avec succs !")}catch(bt){console.error("Erreur lors de la sauvegarde:",bt),alert(" Erreur lors de la sauvegarde des mtrs")}finally{f(!1)}},xt=async()=>{m(!0);try{if(It())await Promise.all([ne(),me(),G(),ve()]);else{const we=O.replace("project:","");await Sf(we)}}catch(we){console.error("Error refreshing data:",we)}finally{m(!1)}},Ht=()=>{const we=O.replace("project:",""),Je=(E==null?void 0:E.replace("periode:",""))||"";r(`/projects/${we}/periodes/${Je}/attachement`)},Mt=()=>o.reduce((we,Je)=>{const De=Je.lignes.reduce((Ge,Re)=>Ge+Re.partiel,0);return we+De},0),Ft=()=>o.reduce((we,Je)=>we+Je.quantiteBordereau,0),Yt=()=>{const we=Ft();return we>0?Mt()/we*100:0},Lt=()=>o.reduce((we,Je)=>{const De=Je.lignes.reduce((Ge,Re)=>Ge+Re.partiel,0);return we+De*Je.prixUnitaire},0),pt=()=>o.reduce((we,Je)=>we+Je.quantiteBordereau*Je.prixUnitaire,0),nt=()=>{const we=pt();return we>0?Lt()/we*100:0},at=(we,Je)=>we.lignes.filter(De=>De.sectionId===Je).reduce((De,Ge)=>De+Ge.partiel,0),ar=(we,Je)=>{const De=we.subSections.find(Pe=>Pe.id===Je),Ge=(De==null?void 0:De.nombreElements)||1;return we.lignes.filter(Pe=>Pe.subSectionId===Je).reduce((Pe,bt)=>Pe+bt.partiel,0)*Ge},Ct=h?o.filter(we=>we.lignes.length>0||we.sections.length>0):o;if(!M)return c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement du projet..."})]})});if(!fe)return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsx("div",{className:"mb-6",children:c.jsxs("button",{onClick:()=>r(`/projects/${O}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),"Retour au projet"]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"text-center py-12",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucun bordereau"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Vous devez d'abord crer un bordereau avant de faire des mtrs"}),c.jsxs("button",{onClick:()=>r(`/projects/${O}/bordereau`),className:"btn btn-primary inline-flex items-center gap-2",children:[c.jsx(yn,{className:"w-4 h-4"}),"Crer le bordereau"]})]})})]});const Ot=(we,Je,De,Ge)=>{const Re=wJ(we.unite),Pe=(Re==null?void 0:Re.champs)||[];let bt=we.lignes;return De?bt=we.lignes.filter(Qe=>Qe.subSectionId===De):Je?bt=we.lignes.filter(Qe=>Qe.sectionId===Je&&!Qe.subSectionId):bt=we.lignes.filter(Qe=>!Qe.sectionId),bt.length===0?c.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:c.jsx("p",{children:'Aucune mesure. Cliquez sur "+ Ajouter mesure" pour commencer.'})}):c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:`w-full border ${Ge||"border-gray-300"}`,children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300 w-12",children:"N"}),c.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation"}),["M","M","ML","M"].includes(we.unite)&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-16",title:"Nombre des parties semblables",children:"Nbre"}),Pe.includes("longueur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Longueur (m)"}),Pe.includes("largeur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Largeur (m)"}),Pe.includes("profondeur")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Profondeur (m)"}),Pe.includes("nombre")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-20",children:"Nombre"}),Pe.includes("diametre")&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-24",children:"Diamtre (mm)"}),["KG","T"].includes(we.unite)&&c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 border-r border-gray-300 w-20 bg-yellow-50",title:"Nombre d'lments (poteaux, poutres...)",children:"N.lm"}),c.jsx("th",{className:"px-3 py-2 text-right text-xs font-semibold text-gray-700 border-r border-gray-300 w-28 bg-blue-50",children:"Partiel"}),c.jsx("th",{className:"px-3 py-2 text-center text-xs font-semibold text-gray-700 w-16",children:"Actions"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:bt.map((Qe,Ve)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-3 py-2 text-gray-700 font-medium border-r border-gray-200",children:Ve+1}),c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"text",value:Qe.designation,onChange:yt=>ht(we.bordereauLigneId,Qe.id,"designation",yt.target.value),className:"input text-sm w-full",placeholder:"Mesure / Description..."})}),["M","M","ML","M"].includes(we.unite)&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.nombreSemblables||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"nombreSemblables",parseInt(yt.target.value)||1),className:"input text-sm text-center w-full",step:"1",min:"1",placeholder:"1"})}),Pe.includes("longueur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.longueur||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"longueur",parseFloat(yt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),Pe.includes("largeur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.largeur||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"largeur",parseFloat(yt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),Pe.includes("profondeur")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.profondeur||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"profondeur",parseFloat(yt.target.value)||0),className:"input text-sm text-center w-full",step:"0.01",placeholder:"0.00"})}),Pe.includes("nombre")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.nombre||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"nombre",parseInt(yt.target.value)||0),className:"input text-sm text-center w-full",step:"1",placeholder:"0"})}),Pe.includes("diametre")&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200",children:c.jsx("input",{type:"number",value:Qe.diametre||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"diametre",parseFloat(yt.target.value)||0),className:"input text-sm text-center w-full",step:"0.1",placeholder:"0"})}),["KG","T"].includes(we.unite)&&c.jsx("td",{className:"px-3 py-2 border-r border-gray-200 bg-yellow-50",children:c.jsx("input",{type:"number",value:Qe.nombreElements||"",onChange:yt=>ht(we.bordereauLigneId,Qe.id,"nombreElements",parseInt(yt.target.value)||1),className:"input text-sm text-center w-full bg-yellow-50",step:"1",min:"1",placeholder:"1",title:"Nombre d'lments (poteaux, poutres...)"})}),c.jsx("td",{className:"px-3 py-2 text-right font-bold text-primary-600 border-r border-gray-200 bg-blue-50",children:Qe.partiel.toFixed(2)}),c.jsx("td",{className:"px-3 py-2 text-center",children:c.jsx("button",{onClick:()=>qe(we.bordereauLigneId,Qe.id),className:"p-1 text-red-500 hover:bg-red-100 rounded",children:c.jsx(ma,{className:"w-4 h-4"})})})]},Qe.id))}),c.jsx("tfoot",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("td",{colSpan:2+Pe.length+(["M","M","ML","M"].includes(we.unite)?1:0)+(["KG","T"].includes(we.unite)?1:0),className:"px-3 py-2 text-right font-semibold text-gray-700 border-r border-gray-300",children:"Total:"}),c.jsx("td",{className:"px-3 py-2 text-right font-bold text-primary-700 bg-primary-50 border-r border-gray-300",children:bt.reduce((Qe,Ve)=>Qe+Ve.partiel,0).toFixed(2)}),c.jsx("td",{})]})})]})})};return c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r(`/projects/${e}`),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),"Retour au projet"]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Mtr N ",(_==null?void 0:_.numero)||""]}),A&&c.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-green-500 to-emerald-500 text-white text-xs font-bold rounded-full",children:"et Dernier"}),c.jsx("span",{className:"px-3 py-1 bg-gradient-to-r from-purple-500 to-pink-500 text-white text-xs font-bold rounded-full",children:(_==null?void 0:_.libelle)||"Hirarchique"})]}),c.jsx("p",{className:"text-gray-700 font-medium",children:M.objet}),c.jsxs("p",{className:"text-sm text-gray-500",children:["March N ",M.marcheNo," - ",M.annee]}),c.jsxs("div",{className:"flex items-center gap-4 mt-3",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-600",children:"Date des travaux:"}),c.jsx("input",{type:"date",value:T,onChange:we=>{L(we.target.value),P()},className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),c.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:A,onChange:we=>{D(we.target.checked),P()},className:"w-4 h-4 text-green-600 border-gray-300 rounded focus:ring-green-500"}),c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Dcompte et Dernier"})]})]})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("button",{onClick:xt,disabled:d,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(xo,{className:`w-4 h-4 ${d?"animate-spin":""}`}),"Actualiser"]}),c.jsxs("button",{onClick:Ht,className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(yB,{className:"w-4 h-4"}),"Attachement"]}),c.jsxs("button",{onClick:()=>r(`/projects/${O}/decompte`),className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(_i,{className:"w-4 h-4"}),"Dcompte"]}),c.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",children:[c.jsx(Md,{className:"w-4 h-4"}),"Exporter"]}),c.jsx("button",{onClick:Et,disabled:u,className:`btn flex items-center gap-2 ${b?"btn-primary bg-orange-500 hover:bg-orange-600 animate-pulse":"btn-primary"}`,children:u?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enregistrement..."]}):c.jsxs(c.Fragment,{children:[c.jsx(Hu,{className:"w-4 h-4"}),b?" Enregistrer":"Enregistrer"]})})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(ST,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:fe.lignes.length}),c.jsx("p",{className:"text-sm text-gray-600",children:"Lignes bordereau"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(ic,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Mt().toFixed(2)}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total ralis"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(go,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsxs("p",{className:`text-2xl font-bold ${Yt()>100?"text-orange-600":"text-gray-900"}`,children:[Yt().toFixed(1),"%"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Avancement quantit"})]})]})}),c.jsx("div",{className:`card ${nt()>100?"border-2 border-orange-400 bg-orange-50":""}`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:c.jsx(_i,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsxs("p",{className:`text-2xl font-bold ${nt()>100?"text-orange-600":"text-gray-900"}`,children:[nt().toFixed(1),"%"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Avancement financier"})]})]})})]}),c.jsx("div",{className:"card mb-6 bg-gradient-to-r from-primary-50 to-blue-50",children:c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Montant Bordereau (HT)"}),c.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[pt().toLocaleString("fr-MA",{minimumFractionDigits:2})," DH"]})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-600",children:"Montant Ralis (HT)"}),c.jsxs("p",{className:"text-xl font-bold text-primary-600",children:[Lt().toLocaleString("fr-MA",{minimumFractionDigits:2})," DH"]})]})]})}),c.jsx("div",{className:"card mb-4 bg-gradient-to-r from-gray-50 to-slate-50",children:c.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(ov,{className:"w-4 h-4 text-blue-600"}),c.jsx("span",{className:"font-medium",children:"Section"}),c.jsx("span",{className:"text-gray-500",children:"= Douar / Lieu"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Xf,{className:"w-4 h-4 text-red-600"}),c.jsx("span",{className:"font-medium",children:"Sous-section"}),c.jsx("span",{className:"text-gray-500",children:"= lment (semeille, radier, voile...)"})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(cB,{className:"w-4 h-4 text-gray-600"}),c.jsx("span",{className:"font-medium",children:"Mesure"}),c.jsx("span",{className:"text-gray-500",children:"= Ligne de calcul"})]})]})}),c.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[c.jsxs("button",{onClick:()=>p(!h),className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium transition ${h?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[h?c.jsx(Ag,{className:"w-4 h-4"}):c.jsx(sB,{className:"w-4 h-4"}),h?"Afficher tout":"Uniquement les mtrs"]}),c.jsxs("span",{className:"text-sm text-gray-500",children:[Ct.length," / ",o.length," lignes affiches"]})]}),c.jsx("div",{className:"card",children:c.jsx("div",{className:"space-y-3",children:Ct.map(we=>{const Je=we.lignes.reduce((Pe,bt)=>Pe+bt.partiel,0),De=we.quantiteBordereau>0?Je/we.quantiteBordereau*100:0,Ge=De>=100,Re=Je>0;return c.jsxs("div",{className:`border-2 rounded-xl overflow-hidden shadow-sm ${Ge?De>100?"border-orange-400 bg-orange-50/50":"border-green-400 bg-green-50/50":"border-gray-200"}`,children:[c.jsxs("div",{className:"flex items-center gap-4 p-4 cursor-pointer hover:bg-gray-50 transition bg-white",onClick:()=>ct(we.bordereauLigneId),children:[we.isExpanded?c.jsx(av,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}):c.jsx(il,{className:"w-5 h-5 text-gray-500 flex-shrink-0"}),c.jsx("div",{className:"w-12 h-12 flex items-center justify-center bg-primary-100 text-primary-700 font-bold rounded-lg text-lg",children:we.numeroLigne}),c.jsxs("div",{className:"flex-1",children:[c.jsx("p",{className:"text-gray-900 font-semibold",children:we.designation}),c.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[c.jsx("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:we.unite}),we.sections.length>0&&c.jsxs("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded text-xs",children:[we.sections.length," section(s)"]})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsxs("div",{className:"text-sm text-gray-600",children:["Bordereau: ",Number(we.quantiteBordereau||0).toLocaleString()]}),c.jsxs("div",{className:"text-lg font-bold text-primary-600",children:["Ralis: ",Number(Je||0).toFixed(2)]})]}),c.jsx("div",{className:"w-36",children:c.jsxs("div",{className:"flex items-center gap-2",children:[Ge?De>100?c.jsx(Za,{className:"w-5 h-5 text-orange-500 flex-shrink-0"}):c.jsx(go,{className:"w-5 h-5 text-green-500 flex-shrink-0"}):Re?c.jsx(Za,{className:"w-5 h-5 text-blue-500 flex-shrink-0"}):c.jsx("div",{className:"w-5 h-5 flex-shrink-0"}),c.jsx("div",{className:"flex-1",children:c.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:c.jsx("div",{className:`h-full transition-all duration-300 ${De>100?"bg-gradient-to-r from-orange-400 to-red-500":Ge?"bg-gradient-to-r from-green-400 to-emerald-500":De>=75?"bg-gradient-to-r from-blue-400 to-cyan-500":"bg-gradient-to-r from-yellow-400 to-orange-500"}`,style:{width:`${Math.min(De,100)}%`}})})}),c.jsxs("span",{className:`text-sm font-bold w-16 text-right ${De>100?"text-orange-600":"text-gray-700"}`,children:[De.toFixed(0),"%"]})]})})]}),we.isExpanded&&c.jsxs("div",{className:"border-t-2 border-gray-200 bg-gray-50 p-4",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-4 border-b border-gray-200",children:[c.jsxs("button",{onClick:()=>he(we.bordereauLigneId),className:"btn btn-secondary flex items-center gap-2 text-sm bg-blue-50 text-blue-700 hover:bg-blue-100 border-blue-200",children:[c.jsx(ov,{className:"w-4 h-4"}),"+ Ajouter Section (Douar)"]}),c.jsxs("button",{onClick:()=>it(we.bordereauLigneId),className:"btn btn-secondary flex items-center gap-2 text-sm",children:[c.jsx(Gs,{className:"w-4 h-4"}),"+ Ajouter Mesure Directe"]})]}),we.lignes.filter(Pe=>!Pe.sectionId).length>0&&c.jsxs("div",{className:"mb-4",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Mesures Gnrales"}),Ot(we),c.jsxs("button",{onClick:()=>it(we.bordereauLigneId),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[c.jsx(Gs,{className:"w-3 h-3"}),"Ajouter mesure"]})]}),we.sections.map((Pe,bt)=>{const Qe=I(bt),Ve=we.subSections.filter(qt=>qt.sectionId===Pe.id),yt=at(we,Pe.id);return c.jsxs("div",{className:`mb-4 rounded-lg border-2 ${Qe.border} ${Qe.bg} overflow-hidden`,children:[c.jsxs("div",{className:`flex items-center gap-3 px-4 py-3 ${Qe.header} text-white cursor-pointer`,onClick:()=>Y(we.bordereauLigneId,Pe.id),children:[Pe.isCollapsed?c.jsx(il,{className:"w-5 h-5"}):c.jsx(av,{className:"w-5 h-5"}),c.jsx(ov,{className:"w-5 h-5"}),g===Pe.id?c.jsx("input",{type:"text",value:Pe.titre,onChange:qt=>de(we.bordereauLigneId,Pe.id,qt.target.value),onBlur:()=>w(null),onKeyDown:qt=>qt.key==="Enter"&&w(null),onClick:qt=>qt.stopPropagation(),className:"flex-1 bg-white/20 text-white placeholder-white/70 px-2 py-1 rounded border-0 focus:ring-2 focus:ring-white/50",placeholder:"Douar / Lieu...",autoFocus:!0}):c.jsx("span",{className:"flex-1 font-bold text-lg",children:Pe.titre||c.jsx("span",{className:"opacity-60 italic",children:"Douar / Lieu..."})}),c.jsxs("span",{className:"px-3 py-1 bg-white/20 rounded-full text-sm font-semibold",children:["Total: ",yt.toFixed(2)]}),c.jsxs("div",{className:"flex items-center gap-1",onClick:qt=>qt.stopPropagation(),children:[c.jsx("button",{onClick:()=>w(Pe.id),className:"p-1 hover:bg-white/20 rounded",title:"Modifier",children:c.jsx(yS,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>je(we.bordereauLigneId,Pe.id),className:"p-1 hover:bg-white/20 rounded",title:"Supprimer",children:c.jsx(ma,{className:"w-4 h-4"})})]})]}),!Pe.isCollapsed&&c.jsxs("div",{className:"p-4",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsxs("button",{onClick:()=>We(we.bordereauLigneId,Pe.id),className:"btn btn-secondary flex items-center gap-2 text-sm bg-white",children:[c.jsx(Xf,{className:"w-4 h-4"}),"+ Ajouter lment (semeille, radier...)"]}),c.jsxs("button",{onClick:()=>it(we.bordereauLigneId,Pe.id),className:"btn btn-secondary flex items-center gap-2 text-sm bg-white",children:[c.jsx(Gs,{className:"w-4 h-4"}),"+ Mesure directe"]})]}),we.lignes.filter(qt=>qt.sectionId===Pe.id&&!qt.subSectionId).length>0&&c.jsx("div",{className:"mb-4 bg-white rounded-lg p-3",children:Ot(we,Pe.id,void 0,Qe.border)}),Ve.map((qt,Tr)=>{const wr=B(Tr),Qr=ar(we,qt.id);return c.jsxs("div",{className:`mb-3 rounded-lg border ${wr.border} ${wr.bg} overflow-hidden`,children:[c.jsxs("div",{className:`flex items-center gap-3 px-3 py-2 bg-white border-b ${wr.border} cursor-pointer`,onClick:()=>He(we.bordereauLigneId,qt.id),children:[qt.isCollapsed?c.jsx(il,{className:"w-4 h-4 text-gray-500"}):c.jsx(av,{className:"w-4 h-4 text-gray-500"}),c.jsx(Xf,{className:`w-4 h-4 ${wr.text}`}),x===qt.id?c.jsx("input",{type:"text",value:qt.titre,onChange:ut=>Ke(we.bordereauLigneId,qt.id,ut.target.value),onBlur:()=>y(null),onKeyDown:ut=>ut.key==="Enter"&&y(null),onClick:ut=>ut.stopPropagation(),className:`flex-1 px-2 py-1 rounded border ${wr.border} focus:ring-2 focus:ring-primary-300`,placeholder:"lment (semeille, radier, poteau...)",autoFocus:!0}):c.jsx("span",{className:`flex-1 font-semibold ${wr.text}`,children:qt.titre||c.jsx("span",{className:"opacity-60 italic",children:"lment..."})}),c.jsxs("div",{className:"flex items-center gap-1",onClick:ut=>ut.stopPropagation(),children:[c.jsx("span",{className:"text-xs text-gray-500",children:""}),c.jsx("input",{type:"number",value:qt.nombreElements||1,onChange:ut=>J(we.bordereauLigneId,qt.id,parseInt(ut.target.value)||1),className:"w-12 px-1 py-0.5 text-center text-sm border border-gray-300 rounded focus:ring-2 focus:ring-primary-300",min:"1",step:"1",title:"Nombre d'lments (ex: nombre de poteaux)"})]}),c.jsx("span",{className:`px-2 py-0.5 ${wr.bg} ${wr.text} rounded text-sm font-medium`,children:Qr.toFixed(2)}),c.jsxs("div",{className:"flex items-center gap-1",onClick:ut=>ut.stopPropagation(),children:[c.jsx("button",{onClick:()=>y(qt.id),className:"p-1 hover:bg-gray-100 rounded",title:"Modifier",children:c.jsx(yS,{className:"w-3 h-3 text-gray-500"})}),c.jsx("button",{onClick:()=>ze(we.bordereauLigneId,qt.id),className:"p-1 hover:bg-gray-100 rounded",title:"Supprimer",children:c.jsx(ma,{className:"w-3 h-3 text-gray-500"})})]})]}),!qt.isCollapsed&&c.jsxs("div",{className:"p-3",children:[Ot(we,Pe.id,qt.id,wr.border),c.jsxs("button",{onClick:()=>it(we.bordereauLigneId,Pe.id,qt.id),className:"mt-2 text-sm text-primary-600 hover:text-primary-700 flex items-center gap-1",children:[c.jsx(Gs,{className:"w-3 h-3"}),"Ajouter mesure"]})]})]},qt.id)})]})]},Pe.id)}),c.jsx("div",{className:"mt-4 pt-4 border-t-2 border-gray-300 bg-gradient-to-r from-primary-50 to-blue-50 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("span",{className:"text-lg font-bold text-gray-700",children:["TOTAL PARTIEL (Article ",we.numeroLigne,")"]}),c.jsxs("span",{className:"text-2xl font-bold text-primary-700",children:[Je.toFixed(2)," ",we.unite]})]})})]})]},we.bordereauLigneId)})})})]})},kJ="modulepreload",_J=function(e){return"/"+e},Rk={},yv=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=_J(l),l in Rk)return;Rk[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":kJ,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((p,d)=>{h.addEventListener("load",p),h.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function _r(e){"@babel/helpers - typeof";return _r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_r(e)}var Oi=Uint8Array,Pa=Uint16Array,c4=Int32Array,u4=new Oi([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),f4=new Oi([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ok=new Oi([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),C8=function(e,t){for(var r=new Pa(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var s=new c4(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)s[a]=a-r[n]<<5|n;return{b:r,r:s}},P8=C8(u4,2),EJ=P8.b,Ww=P8.r;EJ[28]=258,Ww[258]=28;var AJ=C8(f4,0),Ik=AJ.r,Vw=new Pa(32768);for(var qr=0;qr<32768;++qr){var Bl=(qr&43690)>>1|(qr&21845)<<1;Bl=(Bl&52428)>>2|(Bl&13107)<<2,Bl=(Bl&61680)>>4|(Bl&3855)<<4,Vw[qr]=((Bl&65280)>>8|(Bl&255)<<8)>>1}var m0=function(e,t,r){for(var n=e.length,s=0,a=new Pa(t);s<n;++s)e[s]&&++a[e[s]-1];var i=new Pa(t);for(s=1;s<t;++s)i[s]=i[s-1]+a[s-1]<<1;var o;if(r){o=new Pa(1<<t);var l=15-t;for(s=0;s<n;++s)if(e[s])for(var u=s<<4|e[s],f=t-e[s],h=i[e[s]-1]++<<f,p=h|(1<<f)-1;h<=p;++h)o[Vw[h]>>l]=u}else for(o=new Pa(n),s=0;s<n;++s)e[s]&&(o[s]=Vw[i[e[s]-1]++]>>15-e[s]);return o},Mu=new Oi(288);for(var qr=0;qr<144;++qr)Mu[qr]=8;for(var qr=144;qr<256;++qr)Mu[qr]=9;for(var qr=256;qr<280;++qr)Mu[qr]=7;for(var qr=280;qr<288;++qr)Mu[qr]=8;var zg=new Oi(32);for(var qr=0;qr<32;++qr)zg[qr]=5;var jJ=m0(Mu,9,0),TJ=m0(zg,5,0),L8=function(e){return(e+7)/8|0},CJ=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Oi(e.subarray(t,r))},Ho=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Th=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},wv=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var s=r.length,a=r.slice();if(!s)return{t:D8,l:0};if(s==1){var i=new Oi(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(T,L){return T.f-L.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,f=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=s-1;)o=r[r[u].f<r[h].f?u++:h++],l=r[u!=f&&r[u].f<r[h].f?u++:h++],r[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=a[0].s,n=1;n<s;++n)a[n].s>p&&(p=a[n].s);var d=new Pa(p+1),m=Kw(r[f-1],d,0);if(m>t){var n=0,g=0,w=m-t,x=1<<w;for(a.sort(function(L,A){return d[A.s]-d[L.s]||L.f-A.f});n<s;++n){var y=a[n].s;if(d[y]>t)g+=x-(1<<m-d[y]),d[y]=t;else break}for(g>>=w;g>0;){var b=a[n].s;d[b]<t?g-=1<<t-d[b]++-1:++n}for(;n>=0&&g;--n){var S=a[n].s;d[S]==t&&(--d[S],++g)}m=t}return{t:new Oi(d),l:m}},Kw=function(e,t,r){return e.s==-1?Math.max(Kw(e.l,t,r+1),Kw(e.r,t,r+1)):t[e.s]=r},Mk=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Pa(++t),n=0,s=e[0],a=1,i=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==s&&o!=t)++a;else{if(!s&&a>2){for(;a>138;a-=138)i(32754);a>2&&(i(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(i(s),--a;a>6;a-=6)i(8304);a>2&&(i(a-3<<5|8208),a=0)}for(;a--;)i(s);a=1,s=e[o]}return{c:r.subarray(0,n),n:t}},Ch=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},F8=function(e,t,r){var n=r.length,s=L8(t+2);e[s]=n&255,e[s+1]=n>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var a=0;a<n;++a)e[s+a+4]=r[a];return(s+4+n)*8},Bk=function(e,t,r,n,s,a,i,o,l,u,f){Ho(t,f++,r),++s[256];for(var h=wv(s,15),p=h.t,d=h.l,m=wv(a,15),g=m.t,w=m.l,x=Mk(p),y=x.c,b=x.n,S=Mk(g),T=S.c,L=S.n,A=new Pa(19),D=0;D<y.length;++D)++A[y[D]&31];for(var D=0;D<T.length;++D)++A[T[D]&31];for(var C=wv(A,7),O=C.t,E=C.l,P=19;P>4&&!O[Ok[P-1]];--P);var q=u+5<<3,M=Ch(s,Mu)+Ch(a,zg)+i,ne=Ch(s,p)+Ch(a,g)+i+14+3*P+Ch(A,O)+2*A[16]+3*A[17]+7*A[18];if(l>=0&&q<=M&&q<=ne)return F8(t,f,e.subarray(l,l+u));var fe,me,re,G;if(Ho(t,f,1+(ne<M)),f+=2,ne<M){fe=m0(p,d,0),me=p,re=m0(g,w,0),G=g;var ge=m0(O,E,0);Ho(t,f,b-257),Ho(t,f+5,L-1),Ho(t,f+10,P-4),f+=14;for(var D=0;D<P;++D)Ho(t,f+3*D,O[Ok[D]]);f+=3*P;for(var ve=[y,T],_=0;_<2;++_)for(var R=ve[_],D=0;D<R.length;++D){var I=R[D]&31;Ho(t,f,ge[I]),f+=O[I],I>15&&(Ho(t,f,R[D]>>5&127),f+=R[D]>>12)}}else fe=jJ,me=Mu,re=TJ,G=zg;for(var D=0;D<o;++D){var B=n[D];if(B>255){var I=B>>18&31;Th(t,f,fe[I+257]),f+=me[I+257],I>7&&(Ho(t,f,B>>23&31),f+=u4[I]);var W=B&31;Th(t,f,re[W]),f+=G[W],W>3&&(Th(t,f,B>>5&8191),f+=f4[W])}else Th(t,f,fe[B]),f+=me[B]}return Th(t,f,fe[256]),f+me[256]},PJ=new c4([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),D8=new Oi(0),LJ=function(e,t,r,n,s,a){var i=a.z||e.length,o=new Oi(n+i+5*(1+Math.ceil(i/7e3))+s),l=o.subarray(n,o.length-s),u=a.l,f=(a.r||0)&7;if(t){f&&(l[0]=a.r>>3);for(var h=PJ[t-1],p=h>>13,d=h&8191,m=(1<<r)-1,g=a.p||new Pa(32768),w=a.h||new Pa(m+1),x=Math.ceil(r/3),y=2*x,b=function(Ke){return(e[Ke]^e[Ke+1]<<x^e[Ke+2]<<y)&m},S=new c4(25e3),T=new Pa(288),L=new Pa(32),A=0,D=0,C=a.i||0,O=0,E=a.w||0,P=0;C+2<i;++C){var q=b(C),M=C&32767,ne=w[q];if(g[M]=ne,w[q]=M,E<=C){var fe=i-C;if((A>7e3||O>24576)&&(fe>423||!u)){f=Bk(e,l,0,S,T,L,D,O,P,C-P,f),O=A=D=0,P=C;for(var me=0;me<286;++me)T[me]=0;for(var me=0;me<30;++me)L[me]=0}var re=2,G=0,ge=d,ve=M-ne&32767;if(fe>2&&q==b(C-ve))for(var _=Math.min(p,fe)-1,R=Math.min(32767,C),I=Math.min(258,fe);ve<=R&&--ge&&M!=ne;){if(e[C+re]==e[C+re-ve]){for(var B=0;B<I&&e[C+B]==e[C+B-ve];++B);if(B>re){if(re=B,G=ve,B>_)break;for(var W=Math.min(ve,B-2),se=0,me=0;me<W;++me){var pe=C-ve+me&32767,he=g[pe],de=pe-he&32767;de>se&&(se=de,ne=pe)}}}M=ne,ne=g[M],ve+=M-ne&32767}if(G){S[O++]=268435456|Ww[re]<<18|Ik[G];var je=Ww[re]&31,Y=Ik[G]&31;D+=u4[je]+f4[Y],++T[257+je],++L[Y],E=C+re,++A}else S[O++]=e[C],++T[e[C]]}}for(C=Math.max(C,E);C<i;++C)S[O++]=e[C],++T[e[C]];f=Bk(e,l,u,S,T,L,D,O,P,C-P,f),u||(a.r=f&7|l[f/8|0]<<3,f-=7,a.h=w,a.p=g,a.i=C,a.w=E)}else{for(var C=a.w||0;C<i+u;C+=65535){var We=C+65535;We>=i&&(l[f/8|0]=u,We=i),f=F8(l,f+1,e.subarray(C,We))}a.i=i}return CJ(o,0,n+L8(f)+s)},R8=function(){var e=1,t=0;return{p:function(r){for(var n=e,s=t,a=r.length|0,i=0;i!=a;){for(var o=Math.min(i+2655,a);i<o;++i)s+=n+=r[i];n=(n&65535)+15*(n>>16),s=(s&65535)+15*(s>>16)}e=n,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},FJ=function(e,t,r,n,s){if(!s&&(s={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),i=new Oi(a.length+e.length);i.set(a),i.set(e,a.length),e=i,s.w=a.length}return LJ(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,s)},O8=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},DJ=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=R8();s.p(t.dictionary),O8(e,2,s.d())}};function Gw(e,t){t||(t={});var r=R8();r.p(e);var n=FJ(e,t,t.dictionary?6:2,4);return DJ(n,t),O8(n,n.length-4,r.d()),n}var RJ=typeof TextDecoder<"u"&&new TextDecoder,OJ=0;try{RJ.decode(D8,{stream:!0}),OJ=1}catch{}function IJ(e){if(Array.isArray(e))return e}function MJ(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,s,a,i,o=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){u=!0,s=f}finally{try{if(!l&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw s}}return o}}function Uk(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function BJ(e,t){if(e){if(typeof e=="string")return Uk(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Uk(e,t):void 0}}function UJ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $k(e,t){return IJ(e)||MJ(e,t)||BJ(e,t)||UJ()}function zk(e,t="utf8"){return new TextDecoder(t).decode(e)}const $J=new TextEncoder;function zJ(e){return $J.encode(e)}const HJ=1024*8,qJ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),bv={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class d4{constructor(t=HJ,r={}){Pt(this,"buffer");Pt(this,"byteLength");Pt(this,"byteOffset");Pt(this,"length");Pt(this,"offset");Pt(this,"lastWrittenByte");Pt(this,"littleEndian");Pt(this,"_data");Pt(this,"_mark");Pt(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const s=r.offset?r.offset>>>0:0,a=t.byteLength-s;let i=s;(ArrayBuffer.isView(t)||t instanceof d4)&&(t.byteLength!==t.buffer.byteLength&&(i=t.byteOffset+s),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=i,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,i,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,s=new Uint8Array(n);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=bv[r].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,a=this.buffer.slice(s,s+n);if(this.littleEndian===qJ&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+n));o.reverse();const l=new bv[r](o.buffer);return this.offset+=n,l.reverse(),l}const i=new bv[r](a);return this.offset+=n,i}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return zk(this.readBytes(t))}decodeText(t=1,r="utf8"){return zk(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(zJ(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Hd(e){let t=e.length;for(;--t>=0;)e[t]=0}const WJ=3,VJ=258,I8=29,KJ=256,GJ=KJ+1+I8,M8=30,YJ=512,XJ=new Array((GJ+2)*2);Hd(XJ);const JJ=new Array(M8*2);Hd(JJ);const QJ=new Array(YJ);Hd(QJ);const ZJ=new Array(VJ-WJ+1);Hd(ZJ);const eQ=new Array(I8);Hd(eQ);const tQ=new Array(M8);Hd(tQ);const rQ=(e,t,r,n)=>{let s=e&65535|0,a=e>>>16&65535|0,i=0;for(;r!==0;){i=r>2e3?2e3:r,r-=i;do s=s+t[n++]|0,a=a+s|0;while(--i);s%=65521,a%=65521}return s|a<<16|0};var Yw=rQ;const nQ=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},sQ=new Uint32Array(nQ()),aQ=(e,t,r,n)=>{const s=sQ,a=n+r;e^=-1;for(let i=n;i<a;i++)e=e>>>8^s[(e^t[i])&255];return e^-1};var Qi=aQ,Xw={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},B8={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const iQ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var oQ=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)iQ(r,n)&&(e[n]=r[n])}}return e},lQ=e=>{let t=0;for(let n=0,s=e.length;n<s;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,s=0,a=e.length;n<a;n++){let i=e[n];r.set(i,s),s+=i.length}return r},U8={assign:oQ,flattenChunks:lQ};let $8=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{$8=!1}const op=new Uint8Array(256);for(let e=0;e<256;e++)op[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;op[254]=op[254]=1;var cQ=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,s,a,i=e.length,o=0;for(s=0;s<i;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,s=0;a<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<i&&(n=e.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const uQ=(e,t)=>{if(t<65534&&e.subarray&&$8)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var fQ=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,s;const a=new Array(r*2);for(s=0,n=0;n<r;){let i=e[n++];if(i<128){a[s++]=i;continue}let o=op[i];if(o>4){a[s++]=65533,n+=o-1;continue}for(i&=o===2?31:o===3?15:7;o>1&&n<r;)i=i<<6|e[n++]&63,o--;if(o>1){a[s++]=65533;continue}i<65536?a[s++]=i:(i-=65536,a[s++]=55296|i>>10&1023,a[s++]=56320|i&1023)}return uQ(a,s)},dQ=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+op[e[r]]>t?r:t},Jw={string2buf:cQ,buf2string:fQ,utf8border:dQ};function hQ(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var pQ=hQ;const Zm=16209,mQ=16191;var gQ=function(t,r){let n,s,a,i,o,l,u,f,h,p,d,m,g,w,x,y,b,S,T,L,A,D,C,O;const E=t.state;n=t.next_in,C=t.input,s=n+(t.avail_in-5),a=t.next_out,O=t.output,i=a-(r-t.avail_out),o=a+(t.avail_out-257),l=E.dmax,u=E.wsize,f=E.whave,h=E.wnext,p=E.window,d=E.hold,m=E.bits,g=E.lencode,w=E.distcode,x=(1<<E.lenbits)-1,y=(1<<E.distbits)-1;e:do{m<15&&(d+=C[n++]<<m,m+=8,d+=C[n++]<<m,m+=8),b=g[d&x];t:for(;;){if(S=b>>>24,d>>>=S,m-=S,S=b>>>16&255,S===0)O[a++]=b&65535;else if(S&16){T=b&65535,S&=15,S&&(m<S&&(d+=C[n++]<<m,m+=8),T+=d&(1<<S)-1,d>>>=S,m-=S),m<15&&(d+=C[n++]<<m,m+=8,d+=C[n++]<<m,m+=8),b=w[d&y];r:for(;;){if(S=b>>>24,d>>>=S,m-=S,S=b>>>16&255,S&16){if(L=b&65535,S&=15,m<S&&(d+=C[n++]<<m,m+=8,m<S&&(d+=C[n++]<<m,m+=8)),L+=d&(1<<S)-1,L>l){t.msg="invalid distance too far back",E.mode=Zm;break e}if(d>>>=S,m-=S,S=a-i,L>S){if(S=L-S,S>f&&E.sane){t.msg="invalid distance too far back",E.mode=Zm;break e}if(A=0,D=p,h===0){if(A+=u-S,S<T){T-=S;do O[a++]=p[A++];while(--S);A=a-L,D=O}}else if(h<S){if(A+=u+h-S,S-=h,S<T){T-=S;do O[a++]=p[A++];while(--S);if(A=0,h<T){S=h,T-=S;do O[a++]=p[A++];while(--S);A=a-L,D=O}}}else if(A+=h-S,S<T){T-=S;do O[a++]=p[A++];while(--S);A=a-L,D=O}for(;T>2;)O[a++]=D[A++],O[a++]=D[A++],O[a++]=D[A++],T-=3;T&&(O[a++]=D[A++],T>1&&(O[a++]=D[A++]))}else{A=a-L;do O[a++]=O[A++],O[a++]=O[A++],O[a++]=O[A++],T-=3;while(T>2);T&&(O[a++]=O[A++],T>1&&(O[a++]=O[A++]))}}else if(S&64){t.msg="invalid distance code",E.mode=Zm;break e}else{b=w[(b&65535)+(d&(1<<S)-1)];continue r}break}}else if(S&64)if(S&32){E.mode=mQ;break e}else{t.msg="invalid literal/length code",E.mode=Zm;break e}else{b=g[(b&65535)+(d&(1<<S)-1)];continue t}break}}while(n<s&&a<o);T=m>>3,n-=T,m-=T<<3,d&=(1<<m)-1,t.next_in=n,t.next_out=a,t.avail_in=n<s?5+(s-n):5-(n-s),t.avail_out=a<o?257+(o-a):257-(a-o),E.hold=d,E.bits=m};const xf=15,Hk=852,qk=592,Wk=0,Nv=1,Vk=2,xQ=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),vQ=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),yQ=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),wQ=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),bQ=(e,t,r,n,s,a,i,o)=>{const l=o.bits;let u=0,f=0,h=0,p=0,d=0,m=0,g=0,w=0,x=0,y=0,b,S,T,L,A,D=null,C;const O=new Uint16Array(xf+1),E=new Uint16Array(xf+1);let P=null,q,M,ne;for(u=0;u<=xf;u++)O[u]=0;for(f=0;f<n;f++)O[t[r+f]]++;for(d=l,p=xf;p>=1&&O[p]===0;p--);if(d>p&&(d=p),p===0)return s[a++]=1<<24|64<<16|0,s[a++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<p&&O[h]===0;h++);for(d<h&&(d=h),w=1,u=1;u<=xf;u++)if(w<<=1,w-=O[u],w<0)return-1;if(w>0&&(e===Wk||p!==1))return-1;for(E[1]=0,u=1;u<xf;u++)E[u+1]=E[u]+O[u];for(f=0;f<n;f++)t[r+f]!==0&&(i[E[t[r+f]]++]=f);if(e===Wk?(D=P=i,C=20):e===Nv?(D=xQ,P=vQ,C=257):(D=yQ,P=wQ,C=0),y=0,f=0,u=h,A=a,m=d,g=0,T=-1,x=1<<d,L=x-1,e===Nv&&x>Hk||e===Vk&&x>qk)return 1;for(;;){q=u-g,i[f]+1<C?(M=0,ne=i[f]):i[f]>=C?(M=P[i[f]-C],ne=D[i[f]-C]):(M=96,ne=0),b=1<<u-g,S=1<<m,h=S;do S-=b,s[A+(y>>g)+S]=q<<24|M<<16|ne|0;while(S!==0);for(b=1<<u-1;y&b;)b>>=1;if(b!==0?(y&=b-1,y+=b):y=0,f++,--O[u]===0){if(u===p)break;u=t[r+i[f]]}if(u>d&&(y&L)!==T){for(g===0&&(g=d),A+=h,m=u-g,w=1<<m;m+g<p&&(w-=O[m+g],!(w<=0));)m++,w<<=1;if(x+=1<<m,e===Nv&&x>Hk||e===Vk&&x>qk)return 1;T=y&L,s[T]=d<<24|m<<16|A-a|0}}return y!==0&&(s[A+y]=u-g<<24|64<<16|0),o.bits=d,0};var g0=bQ;const NQ=0,z8=1,H8=2,{Z_FINISH:Kk,Z_BLOCK:SQ,Z_TREES:e1,Z_OK:Bu,Z_STREAM_END:kQ,Z_NEED_DICT:_Q,Z_STREAM_ERROR:si,Z_DATA_ERROR:q8,Z_MEM_ERROR:W8,Z_BUF_ERROR:EQ,Z_DEFLATED:Gk}=B8,Ox=16180,Yk=16181,Xk=16182,Jk=16183,Qk=16184,Zk=16185,e_=16186,t_=16187,r_=16188,n_=16189,Hg=16190,qo=16191,Sv=16192,s_=16193,kv=16194,a_=16195,i_=16196,o_=16197,l_=16198,t1=16199,r1=16200,c_=16201,u_=16202,f_=16203,d_=16204,h_=16205,_v=16206,p_=16207,m_=16208,Gr=16209,V8=16210,K8=16211,AQ=852,jQ=592,TQ=15,CQ=TQ,g_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function PQ(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Xu=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Ox||t.mode>K8?1:0},G8=e=>{if(Xu(e))return si;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Ox,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(AQ),t.distcode=t.distdyn=new Int32Array(jQ),t.sane=1,t.back=-1,Bu},Y8=e=>{if(Xu(e))return si;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,G8(e)},X8=(e,t)=>{let r;if(Xu(e))return si;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?si:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,Y8(e))},J8=(e,t)=>{if(!e)return si;const r=new PQ;e.state=r,r.strm=e,r.window=null,r.mode=Ox;const n=X8(e,t);return n!==Bu&&(e.state=null),n},LQ=e=>J8(e,CQ);let x_=!0,Ev,Av;const FQ=e=>{if(x_){Ev=new Int32Array(512),Av=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(g0(z8,e.lens,0,288,Ev,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;g0(H8,e.lens,0,32,Av,0,e.work,{bits:5}),x_=!1}e.lencode=Ev,e.lenbits=9,e.distcode=Av,e.distbits=5},Q8=(e,t,r,n)=>{let s;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(s=a.wsize-a.wnext,s>n&&(s=n),a.window.set(t.subarray(r-n,r-n+s),a.wnext),n-=s,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=s,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=s))),0},DQ=(e,t)=>{let r,n,s,a,i,o,l,u,f,h,p,d,m,g,w=0,x,y,b,S,T,L,A,D;const C=new Uint8Array(4);let O,E;const P=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Xu(e)||!e.output||!e.input&&e.avail_in!==0)return si;r=e.state,r.mode===qo&&(r.mode=Sv),i=e.next_out,s=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,u=r.hold,f=r.bits,h=o,p=l,D=Bu;e:for(;;)switch(r.mode){case Ox:if(r.wrap===0){r.mode=Sv;break}for(;f<16;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,C[0]=u&255,C[1]=u>>>8&255,r.check=Qi(r.check,C,2,0),u=0,f=0,r.mode=Yk;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Gr;break}if((u&15)!==Gk){e.msg="unknown compression method",r.mode=Gr;break}if(u>>>=4,f-=4,A=(u&15)+8,r.wbits===0&&(r.wbits=A),A>15||A>r.wbits){e.msg="invalid window size",r.mode=Gr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?n_:qo,u=0,f=0;break;case Yk:for(;f<16;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==Gk){e.msg="unknown compression method",r.mode=Gr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Gr;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(C[0]=u&255,C[1]=u>>>8&255,r.check=Qi(r.check,C,2,0)),u=0,f=0,r.mode=Xk;case Xk:for(;f<32;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(C[0]=u&255,C[1]=u>>>8&255,C[2]=u>>>16&255,C[3]=u>>>24&255,r.check=Qi(r.check,C,4,0)),u=0,f=0,r.mode=Jk;case Jk:for(;f<16;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(C[0]=u&255,C[1]=u>>>8&255,r.check=Qi(r.check,C,2,0)),u=0,f=0,r.mode=Qk;case Qk:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(C[0]=u&255,C[1]=u>>>8&255,r.check=Qi(r.check,C,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=Zk;case Zk:if(r.flags&1024&&(d=r.length,d>o&&(d=o),d&&(r.head&&(A=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),A)),r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,d,a)),o-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=e_;case e_:if(r.flags&2048){if(o===0)break e;d=0;do A=n[a+d++],r.head&&A&&r.length<65536&&(r.head.name+=String.fromCharCode(A));while(A&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,d,a)),o-=d,a+=d,A)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=t_;case t_:if(r.flags&4096){if(o===0)break e;d=0;do A=n[a+d++],r.head&&A&&r.length<65536&&(r.head.comment+=String.fromCharCode(A));while(A&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=Qi(r.check,n,d,a)),o-=d,a+=d,A)break e}else r.head&&(r.head.comment=null);r.mode=r_;case r_:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Gr;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=qo;break;case n_:for(;f<32;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}e.adler=r.check=g_(u),u=0,f=0,r.mode=Hg;case Hg:if(r.havedict===0)return e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=f,_Q;e.adler=r.check=1,r.mode=qo;case qo:if(t===SQ||t===e1)break e;case Sv:if(r.last){u>>>=f&7,f-=f&7,r.mode=_v;break}for(;f<3;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}switch(r.last=u&1,u>>>=1,f-=1,u&3){case 0:r.mode=s_;break;case 1:if(FQ(r),r.mode=t1,t===e1){u>>>=2,f-=2;break e}break;case 2:r.mode=i_;break;case 3:e.msg="invalid block type",r.mode=Gr}u>>>=2,f-=2;break;case s_:for(u>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Gr;break}if(r.length=u&65535,u=0,f=0,r.mode=kv,t===e1)break e;case kv:r.mode=a_;case a_:if(d=r.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;s.set(n.subarray(a,a+d),i),o-=d,a+=d,l-=d,i+=d,r.length-=d;break}r.mode=qo;break;case i_:for(;f<14;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Gr;break}r.have=0,r.mode=o_;case o_:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.lens[P[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,O={bits:r.lenbits},D=g0(NQ,r.lens,0,19,r.lencode,0,r.work,O),r.lenbits=O.bits,D){e.msg="invalid code lengths set",r.mode=Gr;break}r.have=0,r.mode=l_;case l_:for(;r.have<r.nlen+r.ndist;){for(;w=r.lencode[u&(1<<r.lenbits)-1],x=w>>>24,y=w>>>16&255,b=w&65535,!(x<=f);){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(b<16)u>>>=x,f-=x,r.lens[r.have++]=b;else{if(b===16){for(E=x+2;f<E;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(u>>>=x,f-=x,r.have===0){e.msg="invalid bit length repeat",r.mode=Gr;break}A=r.lens[r.have-1],d=3+(u&3),u>>>=2,f-=2}else if(b===17){for(E=x+3;f<E;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}u>>>=x,f-=x,A=0,d=3+(u&7),u>>>=3,f-=3}else{for(E=x+7;f<E;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}u>>>=x,f-=x,A=0,d=11+(u&127),u>>>=7,f-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Gr;break}for(;d--;)r.lens[r.have++]=A}}if(r.mode===Gr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Gr;break}if(r.lenbits=9,O={bits:r.lenbits},D=g0(z8,r.lens,0,r.nlen,r.lencode,0,r.work,O),r.lenbits=O.bits,D){e.msg="invalid literal/lengths set",r.mode=Gr;break}if(r.distbits=6,r.distcode=r.distdyn,O={bits:r.distbits},D=g0(H8,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,O),r.distbits=O.bits,D){e.msg="invalid distances set",r.mode=Gr;break}if(r.mode=t1,t===e1)break e;case t1:r.mode=r1;case r1:if(o>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=f,gQ(e,p),i=e.next_out,s=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,u=r.hold,f=r.bits,r.mode===qo&&(r.back=-1);break}for(r.back=0;w=r.lencode[u&(1<<r.lenbits)-1],x=w>>>24,y=w>>>16&255,b=w&65535,!(x<=f);){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(y&&!(y&240)){for(S=x,T=y,L=b;w=r.lencode[L+((u&(1<<S+T)-1)>>S)],x=w>>>24,y=w>>>16&255,b=w&65535,!(S+x<=f);){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}u>>>=S,f-=S,r.back+=S}if(u>>>=x,f-=x,r.back+=x,r.length=b,y===0){r.mode=h_;break}if(y&32){r.back=-1,r.mode=qo;break}if(y&64){e.msg="invalid literal/length code",r.mode=Gr;break}r.extra=y&15,r.mode=c_;case c_:if(r.extra){for(E=r.extra;f<E;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=u_;case u_:for(;w=r.distcode[u&(1<<r.distbits)-1],x=w>>>24,y=w>>>16&255,b=w&65535,!(x<=f);){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(!(y&240)){for(S=x,T=y,L=b;w=r.distcode[L+((u&(1<<S+T)-1)>>S)],x=w>>>24,y=w>>>16&255,b=w&65535,!(S+x<=f);){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}u>>>=S,f-=S,r.back+=S}if(u>>>=x,f-=x,r.back+=x,y&64){e.msg="invalid distance code",r.mode=Gr;break}r.offset=b,r.extra=y&15,r.mode=f_;case f_:if(r.extra){for(E=r.extra;f<E;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Gr;break}r.mode=d_;case d_:if(l===0)break e;if(d=p-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Gr;break}d>r.wnext?(d-=r.wnext,m=r.wsize-d):m=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=s,m=i-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do s[i++]=g[m++];while(--d);r.length===0&&(r.mode=r1);break;case h_:if(l===0)break e;s[i++]=r.length,l--,r.mode=r1;break;case _v:if(r.wrap){for(;f<32;){if(o===0)break e;o--,u|=n[a++]<<f,f+=8}if(p-=l,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Qi(r.check,s,p,i-p):Yw(r.check,s,p,i-p)),p=l,r.wrap&4&&(r.flags?u:g_(u))!==r.check){e.msg="incorrect data check",r.mode=Gr;break}u=0,f=0}r.mode=p_;case p_:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,u+=n[a++]<<f,f+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Gr;break}u=0,f=0}r.mode=m_;case m_:D=kQ;break e;case Gr:D=q8;break e;case V8:return W8;case K8:default:return si}return e.next_out=i,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=u,r.bits=f,(r.wsize||p!==e.avail_out&&r.mode<Gr&&(r.mode<_v||t!==Kk))&&Q8(e,e.output,e.next_out,p-e.avail_out),h-=e.avail_in,p-=e.avail_out,e.total_in+=h,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Qi(r.check,s,p,e.next_out-p):Yw(r.check,s,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===qo?128:0)+(r.mode===t1||r.mode===kv?256:0),(h===0&&p===0||t===Kk)&&D===Bu&&(D=EQ),D},RQ=e=>{if(Xu(e))return si;let t=e.state;return t.window&&(t.window=null),e.state=null,Bu},OQ=(e,t)=>{if(Xu(e))return si;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Bu):si},IQ=(e,t)=>{const r=t.length;let n,s,a;return Xu(e)||(n=e.state,n.wrap!==0&&n.mode!==Hg)?si:n.mode===Hg&&(s=1,s=Yw(s,t,r,0),s!==n.check)?q8:(a=Q8(e,t,r,r),a?(n.mode=V8,W8):(n.havedict=1,Bu))};var MQ=Y8,BQ=X8,UQ=G8,$Q=LQ,zQ=J8,HQ=DQ,qQ=RQ,WQ=OQ,VQ=IQ,KQ="pako inflate (from Nodeca project)",Yo={inflateReset:MQ,inflateReset2:BQ,inflateResetKeep:UQ,inflateInit:$Q,inflateInit2:zQ,inflate:HQ,inflateEnd:qQ,inflateGetHeader:WQ,inflateSetDictionary:VQ,inflateInfo:KQ};function GQ(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var YQ=GQ;const Z8=Object.prototype.toString,{Z_NO_FLUSH:XQ,Z_FINISH:JQ,Z_OK:lp,Z_STREAM_END:jv,Z_NEED_DICT:Tv,Z_STREAM_ERROR:QQ,Z_DATA_ERROR:v_,Z_MEM_ERROR:ZQ}=B8;function Dp(e){this.options=U8.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new pQ,this.strm.avail_out=0;let r=Yo.inflateInit2(this.strm,t.windowBits);if(r!==lp)throw new Error(Xw[r]);if(this.header=new YQ,Yo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Jw.string2buf(t.dictionary):Z8.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Yo.inflateSetDictionary(this.strm,t.dictionary),r!==lp)))throw new Error(Xw[r])}Dp.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,s=this.options.dictionary;let a,i,o;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?JQ:XQ,Z8.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=Yo.inflate(r,i),a===Tv&&s&&(a=Yo.inflateSetDictionary(r,s),a===lp?a=Yo.inflate(r,i):a===v_&&(a=Tv));r.avail_in>0&&a===jv&&r.state.wrap>0&&e[r.next_in]!==0;)Yo.inflateReset(r),a=Yo.inflate(r,i);switch(a){case QQ:case v_:case Tv:case ZQ:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===jv))if(this.options.to==="string"){let l=Jw.utf8border(r.output,r.next_out),u=r.next_out-l,f=Jw.buf2string(r.output,l);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(l,l+u),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===lp&&o===0)){if(a===jv)return a=Yo.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Dp.prototype.onData=function(e){this.chunks.push(e)};Dp.prototype.onEnd=function(e){e===lp&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=U8.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function eZ(e,t){const r=new Dp(t);if(r.push(e),r.err)throw r.msg||Xw[r.err];return r.result}var tZ=Dp,rZ=eZ,nZ={Inflate:tZ,inflate:rZ};const{Inflate:sZ,inflate:aZ}=nZ;var y_=sZ,iZ=aZ;const eP=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;eP[e]=t}const w_=4294967295;function oZ(e,t,r){let n=e;for(let s=0;s<r;s++)n=eP[(n^t[s])&255]^n>>>8;return n}function lZ(e,t){return(oZ(w_,e,t)^w_)>>>0}function b_(e,t,r){const n=e.readUint32(),s=lZ(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${s}`)}function tP(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function rP(e,t,r,n){let s=0;for(;s<n;s++)t[s]=e[s];for(;s<r;s++)t[s]=e[s]+t[s-n]&255}function nP(e,t,r,n){let s=0;if(r.length===0)for(;s<n;s++)t[s]=e[s];else for(;s<n;s++)t[s]=e[s]+r[s]&255}function sP(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-s]>>1)&255}else{for(;a<s;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-s]+r[a]>>1)&255}}function aP(e,t,r,n,s){let a=0;if(r.length===0){for(;a<s;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-s]&255}else{for(;a<s;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+cZ(t[a-s],r[a],r[a-s])&255}}function cZ(e,t,r){const n=e+t-r,s=Math.abs(n-e),a=Math.abs(n-t),i=Math.abs(n-r);return s<=a&&s<=i?e:a<=i?t:r}function uZ(e,t,r,n,s,a){switch(e){case 0:tP(t,r,s);break;case 1:rP(t,r,s,a);break;case 2:nP(t,r,n,s);break;case 3:sP(t,r,n,s,a);break;case 4:aP(t,r,n,s,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const fZ=new Uint16Array([255]),dZ=new Uint8Array(fZ.buffer),hZ=dZ[0]===255;function pZ(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*s,l=new Uint8Array(n*r*o);let u=0;for(let f=0;f<7;f++){const h=i[f],p=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(p<=0||d<=0)continue;const m=p*o,g=new Uint8Array(m);for(let w=0;w<d;w++){const x=t[u++],y=t.subarray(u,u+m);u+=m;const b=new Uint8Array(m);uZ(x,y,b,g,m,o),g.set(b);for(let S=0;S<p;S++){const T=h.x+S*h.xStep,L=h.y+w*h.yStep;if(!(T>=r||L>=n))for(let A=0;A<o;A++)l[(L*r+T)*o+A]=b[S*o+A]}}}if(a===16){const f=new Uint16Array(l.buffer);if(hZ)for(let h=0;h<f.length;h++)f[h]=mZ(f[h]);return f}else return l}function mZ(e){return(e&255)<<8|e>>8&255}const gZ=new Uint16Array([255]),xZ=new Uint8Array(gZ.buffer),vZ=xZ[0]===255,yZ=new Uint8Array(0);function N_(e){const{data:t,width:r,height:n,channels:s,depth:a}=e,i=Math.ceil(a/8)*s,o=Math.ceil(a/8*s*r),l=new Uint8Array(n*o);let u=yZ,f=0,h,p;for(let d=0;d<n;d++){switch(h=t.subarray(f+1,f+1+o),p=l.subarray(d*o,(d+1)*o),t[f]){case 0:tP(h,p,o);break;case 1:rP(h,p,o,i);break;case 2:nP(h,p,u,o);break;case 3:sP(h,p,u,o,i);break;case 4:aP(h,p,u,o,i);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}u=p,f+=o+1}if(a===16){const d=new Uint16Array(l.buffer);if(vZ)for(let m=0;m<d.length;m++)d[m]=wZ(d[m]);return d}else return l}function wZ(e){return(e&255)<<8|e>>8&255}const I1=Uint8Array.of(137,80,78,71,13,10,26,10);function S_(e){if(!bZ(e.readBytes(I1.length)))throw new Error("wrong PNG signature")}function bZ(e){if(e.length<I1.length)return!1;for(let t=0;t<I1.length;t++)if(e[t]!==I1[t])return!1;return!0}const NZ="tEXt",SZ=0,iP=new TextDecoder("latin1");function kZ(e){if(EZ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const _Z=/^[\u0000-\u00FF]*$/;function EZ(e){if(!_Z.test(e))throw new Error("invalid latin1 text")}function AZ(e,t,r){const n=oP(t);e[n]=jZ(t,r-n.length-1)}function oP(e){for(e.mark();e.readByte()!==SZ;);const t=e.offset;e.reset();const r=iP.decode(e.readBytes(t-e.offset-1));return e.skip(1),kZ(r),r}function jZ(e,t){return iP.decode(e.readBytes(t))}const _a={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Cv={UNKNOWN:-1,DEFLATE:0},k_={UNKNOWN:-1,ADAPTIVE:0},Pv={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},n1={NONE:0,BACKGROUND:1,PREVIOUS:2},Lv={SOURCE:0,OVER:1};class TZ extends d4{constructor(r,n={}){super(r);Pt(this,"_checkCrc");Pt(this,"_inflator");Pt(this,"_png");Pt(this,"_apng");Pt(this,"_end");Pt(this,"_hasPalette");Pt(this,"_palette");Pt(this,"_hasTransparency");Pt(this,"_transparency");Pt(this,"_compressionMethod");Pt(this,"_filterMethod");Pt(this,"_interlaceMethod");Pt(this,"_colorType");Pt(this,"_isAnimated");Pt(this,"_numberOfFrames");Pt(this,"_numberOfPlays");Pt(this,"_frames");Pt(this,"_writingDataChunks");const{checkCrc:s=!1}=n;this._checkCrc=s,this._inflator=new y_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Cv.UNKNOWN,this._filterMethod=k_.UNKNOWN,this._interlaceMethod=Pv.UNKNOWN,this._colorType=_a.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(S_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(S_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const s=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case NZ:AZ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?b_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const s=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=s+r;break}if(this.offset-s!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?b_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=CZ(this.readUint8());const n=this.readUint8();this._colorType=n;let s;switch(n){case _a.GREYSCALE:s=1;break;case _a.TRUECOLOUR:s=3;break;case _a.INDEXED_COLOUR:s=1;break;case _a.GREYSCALE_ALPHA:s=2;break;case _a.TRUECOLOUR_ALPHA:s=4;break;case _a.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Cv.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const s=[];this._palette=s;for(let a=0;a<n;a++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,s=this.offset+this.byteOffset;if(s+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,s,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case _a.GREYSCALE:case _a.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case _a.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const s=this.readByte();this._palette[n].push(s)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case _a.UNKNOWN:case _a.GREYSCALE_ALPHA:case _a.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=oP(this),s=this.readUint8();if(s!==Cv.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:iZ(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),s=this.readByte();this._png.resolution={x:r,y:n,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(r);if(s){if(s.data=N_({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)n.data=s.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(s,a,n),this.addFrameDataToCanvas(n,s)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,s){switch(r.disposeOp){case n1.NONE:break;case n1.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let i=0;i<this._png.width;i++){const o=(a*r.width+i)*this._png.channels;for(let l=0;l<this._png.channels;l++)s.data[o+l]=0}break;case n1.PREVIOUS:s.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const s=1<<this._png.depth,a=(i,o)=>{const l=((i+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,u=(i*n.width+o)*this._png.channels;return{index:l,frameIndex:u}};switch(n.blendOp){case Lv.SOURCE:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(i,o);for(let f=0;f<this._png.channels;f++)r.data[l+f]=n.data[u+f]}break;case Lv.OVER:for(let i=0;i<n.height;i++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:u}=a(i,o);for(let f=0;f<this._png.channels;f++){const h=n.data[u+this._png.channels-1]/s,p=f%(this._png.channels-1)===0?1:n.data[u+f],d=Math.floor(h*p+(1-h)*r.data[l+f]);r.data[l+f]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==k_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===Pv.NO_INTERLACE)this._png.data=N_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===Pv.ADAM7)this._png.data=pZ({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:n1.NONE,blendOp:Lv.SOURCE,data:r}),this._inflator=new y_,this._writingDataChunks=!1}}function CZ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var __;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(__||(__={}));function PZ(e,t){return new TZ(e,t).decode()}var zt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Fv(){zt.console&&typeof zt.console.log=="function"&&zt.console.log.apply(zt.console,arguments)}var Fr={log:Fv,warn:function(e){zt.console&&(typeof zt.console.warn=="function"?zt.console.warn.apply(zt.console,arguments):Fv.call(null,arguments))},error:function(e){zt.console&&(typeof zt.console.error=="function"?zt.console.error.apply(zt.console,arguments):Fv(e))}};function Dv(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){eu(n.response,t,r)},n.onerror=function(){Fr.error("could not download file")},n.send()}function E_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function s1(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var eu=zt.saveAs||((typeof window>"u"?"undefined":_r(window))!=="object"||window!==zt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=zt.URL||zt.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?E_(s.href)?Dv(e,t,r):s1(s,s.target="_blank"):s1(s)):(s.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(s.href)},4e4),setTimeout(function(){s1(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(E_(e))Dv(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){s1(n)})}else navigator.msSaveOrOpenBlob(function(s,a){return a===void 0?a={autoBom:!1}:_r(a)!=="object"&&(Fr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return Dv(e,t,r);var s=e.type==="application/octet-stream",a=/constructor/i.test(zt.HTMLElement)||zt.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||s&&a)&&(typeof FileReader>"u"?"undefined":_r(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=i?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var l=zt.URL||zt.webkitURL,u=l.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function lP(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var s=r[n].re,a=r[n].process,i=s.exec(e);i&&(t=a(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+o+l+u}}var M1=zt.atob.bind(zt),A_=zt.btoa.bind(zt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Rv(e,t){var r=e[0],n=e[1],s=e[2],a=e[3];r=Ns(r,n,s,a,t[0],7,-680876936),a=Ns(a,r,n,s,t[1],12,-389564586),s=Ns(s,a,r,n,t[2],17,606105819),n=Ns(n,s,a,r,t[3],22,-1044525330),r=Ns(r,n,s,a,t[4],7,-176418897),a=Ns(a,r,n,s,t[5],12,1200080426),s=Ns(s,a,r,n,t[6],17,-1473231341),n=Ns(n,s,a,r,t[7],22,-45705983),r=Ns(r,n,s,a,t[8],7,1770035416),a=Ns(a,r,n,s,t[9],12,-1958414417),s=Ns(s,a,r,n,t[10],17,-42063),n=Ns(n,s,a,r,t[11],22,-1990404162),r=Ns(r,n,s,a,t[12],7,1804603682),a=Ns(a,r,n,s,t[13],12,-40341101),s=Ns(s,a,r,n,t[14],17,-1502002290),r=Ss(r,n=Ns(n,s,a,r,t[15],22,1236535329),s,a,t[1],5,-165796510),a=Ss(a,r,n,s,t[6],9,-1069501632),s=Ss(s,a,r,n,t[11],14,643717713),n=Ss(n,s,a,r,t[0],20,-373897302),r=Ss(r,n,s,a,t[5],5,-701558691),a=Ss(a,r,n,s,t[10],9,38016083),s=Ss(s,a,r,n,t[15],14,-660478335),n=Ss(n,s,a,r,t[4],20,-405537848),r=Ss(r,n,s,a,t[9],5,568446438),a=Ss(a,r,n,s,t[14],9,-1019803690),s=Ss(s,a,r,n,t[3],14,-187363961),n=Ss(n,s,a,r,t[8],20,1163531501),r=Ss(r,n,s,a,t[13],5,-1444681467),a=Ss(a,r,n,s,t[2],9,-51403784),s=Ss(s,a,r,n,t[7],14,1735328473),r=ks(r,n=Ss(n,s,a,r,t[12],20,-1926607734),s,a,t[5],4,-378558),a=ks(a,r,n,s,t[8],11,-2022574463),s=ks(s,a,r,n,t[11],16,1839030562),n=ks(n,s,a,r,t[14],23,-35309556),r=ks(r,n,s,a,t[1],4,-1530992060),a=ks(a,r,n,s,t[4],11,1272893353),s=ks(s,a,r,n,t[7],16,-155497632),n=ks(n,s,a,r,t[10],23,-1094730640),r=ks(r,n,s,a,t[13],4,681279174),a=ks(a,r,n,s,t[0],11,-358537222),s=ks(s,a,r,n,t[3],16,-722521979),n=ks(n,s,a,r,t[6],23,76029189),r=ks(r,n,s,a,t[9],4,-640364487),a=ks(a,r,n,s,t[12],11,-421815835),s=ks(s,a,r,n,t[15],16,530742520),r=_s(r,n=ks(n,s,a,r,t[2],23,-995338651),s,a,t[0],6,-198630844),a=_s(a,r,n,s,t[7],10,1126891415),s=_s(s,a,r,n,t[14],15,-1416354905),n=_s(n,s,a,r,t[5],21,-57434055),r=_s(r,n,s,a,t[12],6,1700485571),a=_s(a,r,n,s,t[3],10,-1894986606),s=_s(s,a,r,n,t[10],15,-1051523),n=_s(n,s,a,r,t[1],21,-2054922799),r=_s(r,n,s,a,t[8],6,1873313359),a=_s(a,r,n,s,t[15],10,-30611744),s=_s(s,a,r,n,t[6],15,-1560198380),n=_s(n,s,a,r,t[13],21,1309151649),r=_s(r,n,s,a,t[4],6,-145523070),a=_s(a,r,n,s,t[11],10,-1120210379),s=_s(s,a,r,n,t[2],15,718787259),n=_s(n,s,a,r,t[9],21,-343485551),e[0]=cc(r,e[0]),e[1]=cc(n,e[1]),e[2]=cc(s,e[2]),e[3]=cc(a,e[3])}function Ix(e,t,r,n,s,a){return t=cc(cc(t,e),cc(n,a)),cc(t<<s|t>>>32-s,r)}function Ns(e,t,r,n,s,a,i){return Ix(t&r|~t&n,e,t,s,a,i)}function Ss(e,t,r,n,s,a,i){return Ix(t&n|r&~n,e,t,s,a,i)}function ks(e,t,r,n,s,a,i){return Ix(t^r^n,e,t,s,a,i)}function _s(e,t,r,n,s,a,i){return Ix(r^(t|~n),e,t,s,a,i)}function cP(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Rv(n,LZ(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(Rv(n,s),t=0;t<16;t++)s[t]=0;return s[14]=8*r,Rv(n,s),n}function LZ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var j_="0123456789abcdef".split("");function FZ(e){for(var t="",r=0;r<4;r++)t+=j_[e>>8*r+4&15]+j_[e>>8*r&15];return t}function DZ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Qw(e){return cP(e).map(DZ).join("")}var RZ=function(e){for(var t=0;t<e.length;t++)e[t]=FZ(e[t]);return e.join("")}(cP("hello"))!="5d41402abc4b2a76b9719d911017c592";function cc(e,t){if(RZ){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Zw(e,t){var r,n,s,a;if(e!==r){for(var i=(s=e,a=1+(256/e.length|0),new Array(a+1).join(s)),o=[],l=0;l<256;l++)o[l]=l;var u=0;for(l=0;l<256;l++){var f=o[l];u=(u+f+i.charCodeAt(l))%256,o[l]=o[u],o[u]=f}r=e,n=o}else o=n;var h=t.length,p=0,d=0,m="";for(l=0;l<h;l++)d=(d+(f=o[p=(p+1)%256]))%256,o[p]=o[d],o[d]=f,i=o[(o[p]+o[d])%256],m+=String.fromCharCode(t.charCodeAt(l)^i);return m}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var T_={print:4,modify:8,copy:16,"annot-forms":32};function _f(e,t,r,n){this.v=1,this.r=2;var s=192;e.forEach(function(o){if(T_.perm!==void 0)throw new Error("Invalid permission: "+o);s+=T_[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,i),this.P=-(1+(255^s)),this.encryptionKey=Qw(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Zw(this.encryptionKey,this.padding)}function Ef(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var s=e.charCodeAt(n);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[n]}return t}function C_(e){if(_r(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,s){if(s=s||!1,typeof r!="string"||typeof n!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!s],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),s=[];for(var a in t[r]){var i=t[r][a];try{i[0].apply(e,n)}catch(o){zt.console&&Fr.error("jsPDF PubSub Error",o.message,o)}i[1]&&s.push(a)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function qg(e){if(!(this instanceof qg))return new qg(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function uP(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function ru(e,t,r,n,s){if(!(this instanceof ru))return new ru(e,t,r,n,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,uP.call(this,n,s)}function Uf(e,t,r,n,s){if(!(this instanceof Uf))return new Uf(e,t,r,n,s);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,uP.call(this,n,s)}function jt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],s=arguments[2],a=arguments[3],i=[],o=1,l=16,u="S",f=null;_r(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,s=e.format||s,a=e.compress||e.compressPdf||a,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),u=e.defaultPathOperation||"S"),i=e.filters||(a===!0?["FlateEncode"]:i),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=C_;var m="1.3",g=d.__private__.getPdfVersion=function(){return m};d.__private__.setPdfVersion=function(k){m=k};var w={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return w};var x=d.__private__.getPageFormat=function(k){return w[k]};s=s||"a4";var y="compat",b="advanced",S=y;function T(){this.saveGraphicsState(),J(new ut(nt,0,0,-nt,0,Uc()*nt).toString()+" cm"),this.setFontSize(this.getFontSize()/nt),u="n",S=b}function L(){this.restoreGraphicsState(),u="S",S=y}var A=d.__private__.combineFontStyleAndFontWeight=function(k,U){if(k=="bold"&&U=="normal"||k=="bold"&&U==400||k=="normal"&&U=="italic"||k=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(k=U==400||U==="normal"?k==="italic"?"italic":"normal":U!=700&&U!=="bold"||k!=="normal"?(U==700?"bold":U)+""+k:"bold"),k};d.advancedAPI=function(k){var U=S===y;return U&&T.call(this),typeof k!="function"||(k(this),U&&L.call(this)),this},d.compatAPI=function(k){var U=S===b;return U&&L.call(this),typeof k!="function"||(k(this),U&&T.call(this)),this},d.isAdvancedAPI=function(){return S===b};var D,C=function(k){if(S!==b)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},O=d.roundToPrecision=d.__private__.roundToPrecision=function(k,U){var ce=t||U;if(isNaN(k)||isNaN(ce))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(ce).replace(/0+$/,"")};D=d.hpf=d.__private__.hpf=typeof l=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return O(k,l)}:l==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return O(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return O(k,16)};var E=d.f2=d.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return O(k,2)},P=d.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return O(k,3)},q=d.scale=d.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return S===y?k*nt:S===b?k:void 0},M=function(k){return q(function(U){return S===y?Uc()-U:S===b?U:void 0}(k))};d.__private__.setPrecision=d.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var ne,fe="00000000000000000000000000000000",me=d.__private__.getFileId=function(){return fe},re=d.__private__.setFileId=function(k){return fe=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():fe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(On=new _f(f.userPermissions,f.userPassword,f.ownerPassword,fe)),fe};d.setFileId=function(k){return re(k),this},d.getFileId=function(){return me()};var G=d.__private__.convertDateToPDFDate=function(k){var U=k.getTimezoneOffset(),ce=U<0?"+":"-",xe=Math.floor(Math.abs(U/60)),Ne=Math.abs(U%60),Ue=[ce,I(xe),"'",I(Ne),"'"].join("");return["D:",k.getFullYear(),I(k.getMonth()+1),I(k.getDate()),I(k.getHours()),I(k.getMinutes()),I(k.getSeconds()),Ue].join("")},ge=d.__private__.convertPDFDateToDate=function(k){var U=parseInt(k.substr(2,4),10),ce=parseInt(k.substr(6,2),10)-1,xe=parseInt(k.substr(8,2),10),Ne=parseInt(k.substr(10,2),10),Ue=parseInt(k.substr(12,2),10),Ye=parseInt(k.substr(14,2),10);return new Date(U,ce,xe,Ne,Ue,Ye,0)},ve=d.__private__.setCreationDate=function(k){var U;if(k===void 0&&(k=new Date),k instanceof Date)U=G(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=k}return ne=U},_=d.__private__.getCreationDate=function(k){var U=ne;return k==="jsDate"&&(U=ge(ne)),U};d.setCreationDate=function(k){return ve(k),this},d.getCreationDate=function(k){return _(k)};var R,I=d.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},B=d.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},W=0,se=[],pe=[],he=0,de=[],je=[],Y=!1,We=pe;d.__private__.setCustomOutputDestination=function(k){Y=!0,We=k};var Ke=function(k){Y||(We=k)};d.__private__.resetCustomOutputDestination=function(){Y=!1,We=pe};var J=d.__private__.out=function(k){return k=k.toString(),he+=k.length+1,We.push(k),We},ze=d.__private__.write=function(k){return J(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},He=d.__private__.getArrayBuffer=function(k){for(var U=k.length,ce=new ArrayBuffer(U),xe=new Uint8Array(ce);U--;)xe[U]=k.charCodeAt(U);return ce},it=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return it};var qe=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(k){return qe=S===b?k/nt:k,this};var ht,ct=d.__private__.getFontSize=d.getFontSize=function(){return S===y?qe:qe*nt},Et=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(k){return Et=k,this},d.__private__.getR2L=d.getR2L=function(){return Et};var xt,Ht=d.__private__.setZoomMode=function(k){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))ht=k;else if(isNaN(k)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');ht=k}else ht=parseInt(k,10)};d.__private__.getZoomMode=function(){return ht};var Mt,Ft=d.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');xt=k};d.__private__.getPageMode=function(){return xt};var Yt=d.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');Mt=k};d.__private__.getLayoutMode=function(){return Mt},d.__private__.setDisplayMode=d.setDisplayMode=function(k,U,ce){return Ht(k),Yt(U),Ft(ce),this};var Lt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(k){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Lt[k]},d.__private__.getDocumentProperties=function(){return Lt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(k){for(var U in Lt)Lt.hasOwnProperty(U)&&k[U]&&(Lt[U]=k[U]);return this},d.__private__.setDocumentProperty=function(k,U){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Lt[k]=U};var pt,nt,at,ar,Ct,Ot={},we={},Je=[],De={},Ge={},Re={},Pe={},bt=null,Qe=0,Ve=[],yt=new C_(d),qt=e.hotfixes||[],Tr={},wr={},Qr=[],ut=function k(U,ce,xe,Ne,Ue,Ye){if(!(this instanceof k))return new k(U,ce,xe,Ne,Ue,Ye);isNaN(U)&&(U=1),isNaN(ce)&&(ce=0),isNaN(xe)&&(xe=0),isNaN(Ne)&&(Ne=1),isNaN(Ue)&&(Ue=0),isNaN(Ye)&&(Ye=0),this._matrix=[U,ce,xe,Ne,Ue,Ye]};Object.defineProperty(ut.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(ut.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(ut.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(ut.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(ut.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(ut.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(ut.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(ut.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(ut.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(ut.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(ut.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(ut.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(ut.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ut.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ut.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ut.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ut.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(D).join(k)},ut.prototype.multiply=function(k){var U=k.sx*this.sx+k.shy*this.shx,ce=k.sx*this.shy+k.shy*this.sy,xe=k.shx*this.sx+k.sy*this.shx,Ne=k.shx*this.shy+k.sy*this.sy,Ue=k.tx*this.sx+k.ty*this.shx+this.tx,Ye=k.tx*this.shy+k.ty*this.sy+this.ty;return new ut(U,ce,xe,Ne,Ue,Ye)},ut.prototype.decompose=function(){var k=this.sx,U=this.shy,ce=this.shx,xe=this.sy,Ne=this.tx,Ue=this.ty,Ye=Math.sqrt(k*k+U*U),Nt=(k/=Ye)*ce+(U/=Ye)*xe;ce-=k*Nt,xe-=U*Nt;var At=Math.sqrt(ce*ce+xe*xe);return Nt/=At,k*(xe/=At)<U*(ce/=At)&&(k=-k,U=-U,Nt=-Nt,Ye=-Ye),{scale:new ut(Ye,0,0,At,0,0),translate:new ut(1,0,0,1,Ne,Ue),rotate:new ut(k,U,-U,k,0,0),skew:new ut(1,0,Nt,1,0,0)}},ut.prototype.toString=function(k){return this.join(" ")},ut.prototype.inversed=function(){var k=this.sx,U=this.shy,ce=this.shx,xe=this.sy,Ne=this.tx,Ue=this.ty,Ye=1/(k*xe-U*ce),Nt=xe*Ye,At=-U*Ye,Wt=-ce*Ye,Zt=k*Ye;return new ut(Nt,At,Wt,Zt,-Nt*Ne-Wt*Ue,-At*Ne-Zt*Ue)},ut.prototype.applyToPoint=function(k){var U=k.x*this.sx+k.y*this.shx+this.tx,ce=k.x*this.shy+k.y*this.sy+this.ty;return new jo(U,ce)},ut.prototype.applyToRectangle=function(k){var U=this.applyToPoint(k),ce=this.applyToPoint(new jo(k.x+k.w,k.y+k.h));return new Yd(U.x,U.y,ce.x-U.x,ce.y-U.y)},ut.prototype.clone=function(){var k=this.sx,U=this.shy,ce=this.shx,xe=this.sy,Ne=this.tx,Ue=this.ty;return new ut(k,U,ce,xe,Ne,Ue)},d.Matrix=ut;var gs=d.matrixMult=function(k,U){return U.multiply(k)},Vr=new ut(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=Vr;var Rr=function(k,U){if(!Ge[k]){var ce=(U instanceof ru?"Sh":"P")+(Object.keys(De).length+1).toString(10);U.id=ce,Ge[k]=ce,De[ce]=U,yt.publish("addPattern",U)}};d.ShadingPattern=ru,d.TilingPattern=Uf,d.addShadingPattern=function(k,U){return C("addShadingPattern()"),Rr(k,U),this},d.beginTilingPattern=function(k){C("beginTilingPattern()"),Xd(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},d.endTilingPattern=function(k,U){C("endTilingPattern()"),U.stream=je[R].join(`
`),Rr(k,U),yt.publish("endTilingPattern",U),Qr.pop().restore()};var Kr,fr=d.__private__.newObject=function(){var k=St();return H(k,!0),k},St=d.__private__.newObjectDeferred=function(){return W++,se[W]=function(){return he},W},H=function(k,U){return U=typeof U=="boolean"&&U,se[k]=he,U&&J(k+" 0 obj"),k},ae=d.__private__.newAdditionalObject=function(){var k={objId:St(),content:""};return de.push(k),k},Q=St(),te=St(),le=d.__private__.decodeColorString=function(k){var U=k.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length!==5||U[4]!=="k"&&U[4]!=="K"||(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var ce=parseFloat(U[0]);U=[ce,ce,ce,"r"]}for(var xe="#",Ne=0;Ne<3;Ne++)xe+=("0"+Math.floor(255*parseFloat(U[Ne])).toString(16)).slice(-2);return xe},ue=d.__private__.encodeColorString=function(k){var U;typeof k=="string"&&(k={ch1:k});var ce=k.ch1,xe=k.ch2,Ne=k.ch3,Ue=k.ch4,Ye=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ce=="string"&&ce.charAt(0)!=="#"){var Nt=new lP(ce);if(Nt.ok)ce=Nt.toHex();else if(!/^\d*\.?\d*$/.test(ce))throw new Error('Invalid color "'+ce+'" passed to jsPDF.encodeColorString.')}if(typeof ce=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ce)&&(ce="#"+ce[1]+ce[1]+ce[2]+ce[2]+ce[3]+ce[3]),typeof ce=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ce)){var At=parseInt(ce.substr(1),16);ce=At>>16&255,xe=At>>8&255,Ne=255&At}if(xe===void 0||Ue===void 0&&ce===xe&&xe===Ne)U=typeof ce=="string"?ce+" "+Ye[0]:k.precision===2?E(ce/255)+" "+Ye[0]:P(ce/255)+" "+Ye[0];else if(Ue===void 0||_r(Ue)==="object"){if(Ue&&!isNaN(Ue.a)&&Ue.a===0)return["1.","1.","1.",Ye[1]].join(" ");U=typeof ce=="string"?[ce,xe,Ne,Ye[1]].join(" "):k.precision===2?[E(ce/255),E(xe/255),E(Ne/255),Ye[1]].join(" "):[P(ce/255),P(xe/255),P(Ne/255),Ye[1]].join(" ")}else U=typeof ce=="string"?[ce,xe,Ne,Ue,Ye[2]].join(" "):k.precision===2?[E(ce),E(xe),E(Ne),E(Ue),Ye[2]].join(" "):[P(ce),P(xe),P(Ne),P(Ue),Ye[2]].join(" ");return U},ke=d.__private__.getFilters=function(){return i},Oe=d.__private__.putStream=function(k){var U=(k=k||{}).data||"",ce=k.filters||ke(),xe=k.alreadyAppliedFilters||[],Ne=k.addLength1||!1,Ue=U.length,Ye=k.objectId,Nt=function(In){return In};if(f!==null&&Ye===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(Nt=On.encryptor(Ye,0));var At={};ce===!0&&(ce=["FlateEncode"]);var Wt=k.additionalKeyValues||[],Zt=(At=jt.API.processDataByFilters!==void 0?jt.API.processDataByFilters(U,ce):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(xe)?xe.join(" "):xe.toString());if(At.data.length!==0&&(Wt.push({key:"Length",value:At.data.length}),Ne===!0&&Wt.push({key:"Length1",value:Ue})),Zt.length!=0)if(Zt.split("/").length-1==1)Wt.push({key:"Filter",value:Zt});else{Wt.push({key:"Filter",value:"["+Zt+"]"});for(var mr=0;mr<Wt.length;mr+=1)if(Wt[mr].key==="DecodeParms"){for(var Zr=[],An=0;An<At.reverseChain.split("/").length-1;An+=1)Zr.push("null");Zr.push(Wt[mr].value),Wt[mr].value="["+Zr.join(" ")+"]"}}J("<<");for(var Or=0;Or<Wt.length;Or++)J("/"+Wt[Or].key+" "+Wt[Or].value);J(">>"),At.data.length!==0&&(J("stream"),J(Nt(At.data)),J("endstream"))},_e=d.__private__.putPage=function(k){var U=k.number,ce=k.data,xe=k.objId,Ne=k.contentsObjId;H(xe,!0),J("<</Type /Page"),J("/Parent "+k.rootDictionaryObjId+" 0 R"),J("/Resources "+k.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(D(k.mediaBox.bottomLeftX))+" "+parseFloat(D(k.mediaBox.bottomLeftY))+" "+D(k.mediaBox.topRightX)+" "+D(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&J("/CropBox ["+D(k.cropBox.bottomLeftX)+" "+D(k.cropBox.bottomLeftY)+" "+D(k.cropBox.topRightX)+" "+D(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&J("/BleedBox ["+D(k.bleedBox.bottomLeftX)+" "+D(k.bleedBox.bottomLeftY)+" "+D(k.bleedBox.topRightX)+" "+D(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&J("/TrimBox ["+D(k.trimBox.bottomLeftX)+" "+D(k.trimBox.bottomLeftY)+" "+D(k.trimBox.topRightX)+" "+D(k.trimBox.topRightY)+"]"),k.artBox!==null&&J("/ArtBox ["+D(k.artBox.bottomLeftX)+" "+D(k.artBox.bottomLeftY)+" "+D(k.artBox.topRightX)+" "+D(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&J("/UserUnit "+k.userUnit),yt.publish("putPage",{objId:xe,pageContext:Ve[U],pageNumber:U,page:ce}),J("/Contents "+Ne+" 0 R"),J(">>"),J("endobj");var Ue=ce.join(`
`);return S===b&&(Ue+=`
Q`),H(Ne,!0),Oe({data:Ue,filters:ke(),objectId:Ne}),J("endobj"),xe},Ee=d.__private__.putPages=function(){var k,U,ce=[];for(k=1;k<=Qe;k++)Ve[k].objId=St(),Ve[k].contentsObjId=St();for(k=1;k<=Qe;k++)ce.push(_e({number:k,data:je[k],objId:Ve[k].objId,contentsObjId:Ve[k].contentsObjId,mediaBox:Ve[k].mediaBox,cropBox:Ve[k].cropBox,bleedBox:Ve[k].bleedBox,trimBox:Ve[k].trimBox,artBox:Ve[k].artBox,userUnit:Ve[k].userUnit,rootDictionaryObjId:Q,resourceDictionaryObjId:te}));H(Q,!0),J("<</Type /Pages");var xe="/Kids [";for(U=0;U<Qe;U++)xe+=ce[U]+" 0 R ";J(xe+"]"),J("/Count "+Qe),J(">>"),J("endobj"),yt.publish("postPutPages")},Ce=function(k){yt.publish("putFont",{font:k,out:J,newObject:fr,putStream:Oe}),k.isAlreadyPutted!==!0&&(k.objectNumber=fr(),J("<<"),J("/Type /Font"),J("/BaseFont /"+Ef(k.postScriptName)),J("/Subtype /Type1"),typeof k.encoding=="string"&&J("/Encoding /"+k.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Ze=function(k){k.objectNumber=fr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[D(k.x),D(k.y),D(k.x+k.width),D(k.y+k.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var ce=k.pages[1].join(`
`);Oe({data:ce,additionalKeyValues:U,objectId:k.objectNumber}),J("endobj")},st=function(k,U){U||(U=21);var ce=fr(),xe=function(Ye,Nt){var At,Wt=[],Zt=1/(Nt-1);for(At=0;At<1;At+=Zt)Wt.push(At);if(Wt.push(1),Ye[0].offset!=0){var mr={offset:0,color:Ye[0].color};Ye.unshift(mr)}if(Ye[Ye.length-1].offset!=1){var Zr={offset:1,color:Ye[Ye.length-1].color};Ye.push(Zr)}for(var An="",Or=0,In=0;In<Wt.length;In++){for(At=Wt[In];At>Ye[Or+1].offset;)Or++;var jn=Ye[Or].offset,ts=(At-jn)/(Ye[Or+1].offset-jn),Po=Ye[Or].color,li=Ye[Or+1].color;An+=B(Math.round((1-ts)*Po[0]+ts*li[0]).toString(16))+B(Math.round((1-ts)*Po[1]+ts*li[1]).toString(16))+B(Math.round((1-ts)*Po[2]+ts*li[2]).toString(16))}return An.trim()}(k.colors,U),Ne=[];Ne.push({key:"FunctionType",value:"0"}),Ne.push({key:"Domain",value:"[0.0 1.0]"}),Ne.push({key:"Size",value:"["+U+"]"}),Ne.push({key:"BitsPerSample",value:"8"}),Ne.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Oe({data:xe,additionalKeyValues:Ne,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ce}),J("endobj"),k.objectNumber=fr(),J("<< /ShadingType "+k.type),J("/ColorSpace /DeviceRGB");var Ue="/Coords ["+D(parseFloat(k.coords[0]))+" "+D(parseFloat(k.coords[1]))+" ";k.type===2?Ue+=D(parseFloat(k.coords[2]))+" "+D(parseFloat(k.coords[3])):Ue+=D(parseFloat(k.coords[2]))+" "+D(parseFloat(k.coords[3]))+" "+D(parseFloat(k.coords[4]))+" "+D(parseFloat(k.coords[5])),J(Ue+="]"),k.matrix&&J("/Matrix ["+k.matrix.toString()+"]"),J("/Function "+ce+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},ft=function(k,U){var ce=St(),xe=fr();U.push({resourcesOid:ce,objectOid:xe}),k.objectNumber=xe;var Ne=[];Ne.push({key:"Type",value:"/Pattern"}),Ne.push({key:"PatternType",value:"1"}),Ne.push({key:"PaintType",value:"1"}),Ne.push({key:"TilingType",value:"1"}),Ne.push({key:"BBox",value:"["+k.boundingBox.map(D).join(" ")+"]"}),Ne.push({key:"XStep",value:D(k.xStep)}),Ne.push({key:"YStep",value:D(k.yStep)}),Ne.push({key:"Resources",value:ce+" 0 R"}),k.matrix&&Ne.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),Oe({data:k.stream,additionalKeyValues:Ne,objectId:k.objectNumber}),J("endobj")},rt=function(k){for(var U in k.objectNumber=fr(),J("<<"),k)switch(U){case"opacity":J("/ca "+E(k[U]));break;case"stroke-opacity":J("/CA "+E(k[U]))}J(">>"),J("endobj")},lt=function(k){H(k.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var U in J("/Font <<"),Ot)Ot.hasOwnProperty(U)&&(h===!1||h===!0&&p.hasOwnProperty(U))&&J("/"+U+" "+Ot[U].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(De).length>0){for(var U in J("/Shading <<"),De)De.hasOwnProperty(U)&&De[U]instanceof ru&&De[U].objectNumber>=0&&J("/"+U+" "+De[U].objectNumber+" 0 R");yt.publish("putShadingPatternDict"),J(">>")}}(),function(U){if(Object.keys(De).length>0){for(var ce in J("/Pattern <<"),De)De.hasOwnProperty(ce)&&De[ce]instanceof d.TilingPattern&&De[ce].objectNumber>=0&&De[ce].objectNumber<U&&J("/"+ce+" "+De[ce].objectNumber+" 0 R");yt.publish("putTilingPatternDict"),J(">>")}}(k.objectOid),function(){if(Object.keys(Re).length>0){var U;for(U in J("/ExtGState <<"),Re)Re.hasOwnProperty(U)&&Re[U].objectNumber>=0&&J("/"+U+" "+Re[U].objectNumber+" 0 R");yt.publish("putGStateDict"),J(">>")}}(),function(){for(var U in J("/XObject <<"),Tr)Tr.hasOwnProperty(U)&&Tr[U].objectNumber>=0&&J("/"+U+" "+Tr[U].objectNumber+" 0 R");yt.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},Bt=function(k){we[k.fontName]=we[k.fontName]||{},we[k.fontName][k.fontStyle]=k.id},Ar=function(k,U,ce,xe,Ne){var Ue={id:"F"+(Object.keys(Ot).length+1).toString(10),postScriptName:k,fontName:U,fontStyle:ce,encoding:xe,isStandardFont:Ne||!1,metadata:{}};return yt.publish("addFont",{font:Ue,instance:this}),Ot[Ue.id]=Ue,Bt(Ue),Ue.id},ir=d.__private__.pdfEscape=d.pdfEscape=function(k,U){return function(ce,xe){var Ne,Ue,Ye,Nt,At,Wt,Zt,mr,Zr;if(Ye=(xe=xe||{}).sourceEncoding||"Unicode",At=xe.outputEncoding,(xe.autoencode||At)&&Ot[pt].metadata&&Ot[pt].metadata[Ye]&&Ot[pt].metadata[Ye].encoding&&(Nt=Ot[pt].metadata[Ye].encoding,!At&&Ot[pt].encoding&&(At=Ot[pt].encoding),!At&&Nt.codePages&&(At=Nt.codePages[0]),typeof At=="string"&&(At=Nt[At]),At)){for(Zt=!1,Wt=[],Ne=0,Ue=ce.length;Ne<Ue;Ne++)(mr=At[ce.charCodeAt(Ne)])?Wt.push(String.fromCharCode(mr)):Wt.push(ce[Ne]),Wt[Ne].charCodeAt(0)>>8&&(Zt=!0);ce=Wt.join("")}for(Ne=ce.length;Zt===void 0&&Ne!==0;)ce.charCodeAt(Ne-1)>>8&&(Zt=!0),Ne--;if(!Zt)return ce;for(Wt=xe.noBOM?[]:[254,255],Ne=0,Ue=ce.length;Ne<Ue;Ne++){if((Zr=(mr=ce.charCodeAt(Ne))>>8)>>8)throw new Error("Character at position "+Ne+" of string '"+ce+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Wt.push(Zr),Wt.push(mr-(Zr<<8))}return String.fromCharCode.apply(void 0,Wt)}(k,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},sn=d.__private__.beginPage=function(k){je[++Qe]=[],Ve[Qe]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},zi(Qe),Ke(je[R])},$i=function(k,U){var ce,xe,Ne;switch(r=U||r,typeof k=="string"&&(ce=x(k.toLowerCase()),Array.isArray(ce)&&(xe=ce[0],Ne=ce[1])),Array.isArray(k)&&(xe=k[0]*nt,Ne=k[1]*nt),isNaN(xe)&&(xe=s[0],Ne=s[1]),(xe>14400||Ne>14400)&&(Fr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),xe=Math.min(14400,xe),Ne=Math.min(14400,Ne)),s=[xe,Ne],r.substr(0,1)){case"l":Ne>xe&&(s=[Ne,xe]);break;case"p":xe>Ne&&(s=[Ne,xe])}sn(s),Kt(Wd),J(tf),Kd!==0&&J(Kd+" J"),Gd!==0&&J(Gd+" j"),yt.publish("addPage",{pageNumber:Qe})},ii=function(k){k>0&&k<=Qe&&(je.splice(k,1),Ve.splice(k,1),Qe--,R>Qe&&(R=Qe),this.setPage(R))},zi=function(k){k>0&&k<=Qe&&(R=k)},Ma=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return je.length-1},wl=function(k,U,ce){var xe,Ne=void 0;return ce=ce||{},k=k!==void 0?k:Ot[pt].fontName,U=U!==void 0?U:Ot[pt].fontStyle,xe=k.toLowerCase(),we[xe]!==void 0&&we[xe][U]!==void 0?Ne=we[xe][U]:we[k]!==void 0&&we[k][U]!==void 0?Ne=we[k][U]:ce.disableWarning===!1&&Fr.warn("Unable to look up font label for font '"+k+"', '"+U+"'. Refer to getFontList() for available fonts."),Ne||ce.noFallback||(Ne=we.times[U])==null&&(Ne=we.times.normal),Ne},_n=d.__private__.putInfo=function(){var k=fr(),U=function(xe){return xe};for(var ce in f!==null&&(U=On.encryptor(k,0)),J("<<"),J("/Producer ("+ir(U("jsPDF "+jt.version))+")"),Lt)Lt.hasOwnProperty(ce)&&Lt[ce]&&J("/"+ce.substr(0,1).toUpperCase()+ce.substr(1)+" ("+ir(U(Lt[ce]))+")");J("/CreationDate ("+ir(U(ne))+")"),J(">>"),J("endobj")},Qu=d.__private__.putCatalog=function(k){var U=(k=k||{}).rootDictionaryObjId||Q;switch(fr(),J("<<"),J("/Type /Catalog"),J("/Pages "+U+" 0 R"),ht||(ht="fullwidth"),ht){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ce=""+ht;ce.substr(ce.length-1)==="%"&&(ht=parseInt(ht)/100),typeof ht=="number"&&J("/OpenAction [3 0 R /XYZ null null "+E(ht)+"]")}switch(Mt||(Mt="continuous"),Mt){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}xt&&J("/PageMode /"+xt),yt.publish("putCatalog"),J(">>"),J("endobj")},Ux=d.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(W+1)),J("/Root "+W+" 0 R"),J("/Info "+(W-1)+" 0 R"),f!==null&&J("/Encrypt "+On.oid+" 0 R"),J("/ID [ <"+fe+"> <"+fe+"> ]"),J(">>")},En=d.__private__.putHeader=function(){J("%PDF-"+m),J("%")},Rp=d.__private__.putXRef=function(){var k="0000000000";J("xref"),J("0 "+(W+1)),J("0000000000 65535 f ");for(var U=1;U<=W;U++)typeof se[U]=="function"?J((k+se[U]()).slice(-10)+" 00000 n "):se[U]!==void 0?J((k+se[U]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},Hi=d.__private__.buildDocument=function(){var k;W=0,he=0,pe=[],se=[],de=[],Q=St(),te=St(),Ke(pe),yt.publish("buildDocument"),En(),Ee(),function(){yt.publish("putAdditionalObjects");for(var ce=0;ce<de.length;ce++){var xe=de[ce];H(xe.objId,!0),J(xe.content),J("endobj")}yt.publish("postPutAdditionalObjects")}(),k=[],function(){for(var ce in Ot)Ot.hasOwnProperty(ce)&&(h===!1||h===!0&&p.hasOwnProperty(ce))&&Ce(Ot[ce])}(),function(){var ce;for(ce in Re)Re.hasOwnProperty(ce)&&rt(Re[ce])}(),function(){for(var ce in Tr)Tr.hasOwnProperty(ce)&&Ze(Tr[ce])}(),function(ce){var xe;for(xe in De)De.hasOwnProperty(xe)&&(De[xe]instanceof ru?st(De[xe]):De[xe]instanceof Uf&&ft(De[xe],ce))}(k),yt.publish("putResources"),k.forEach(lt),lt({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),yt.publish("postPutResources"),f!==null&&(On.oid=fr(),J("<<"),J("/Filter /Standard"),J("/V "+On.v),J("/R "+On.r),J("/U <"+On.toHexString(On.U)+">"),J("/O <"+On.toHexString(On.O)+">"),J("/P "+On.P),J(">>"),J("endobj")),_n(),Qu();var U=he;return Rp(),Ux(),J("startxref"),J(""+U),J("%%EOF"),Ke(je[R]),pe.join(`
`)},Zu=d.__private__.getBlob=function(k){return new Blob([He(k)],{type:"application/pdf"})},Op=d.output=d.__private__.output=(Kr=function(k,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",k){case void 0:return Hi();case"save":d.save(U.filename);break;case"arraybuffer":return He(Hi());case"blob":return Zu(Hi());case"bloburi":case"bloburl":if(zt.URL!==void 0&&typeof zt.URL.createObjectURL=="function")return zt.URL&&zt.URL.createObjectURL(Zu(Hi()))||void 0;Fr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ce="",xe=Hi();try{ce=A_(xe)}catch{ce=A_(unescape(encodeURIComponent(xe)))}return"data:application/pdf;filename="+U.filename+";base64,"+ce;case"pdfobjectnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var Ne="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ue=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(Ne=U.pdfObjectUrl,Ue="");var Ye='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ne+'"'+Ue+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",Nt=zt.open();return Nt!==null&&Nt.document.write(Ye),Nt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(zt)==="[object Window]"){var At='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',Wt=zt.open();if(Wt!==null){Wt.document.write(At);var Zt=this;Wt.document.documentElement.querySelector("#pdfViewer").onload=function(){Wt.document.title=U.filename,Wt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Zt.output("bloburl"))}}return Wt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(zt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var mr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',Zr=zt.open();if(Zr!==null&&(Zr.document.write(mr),Zr.document.title=U.filename),Zr||typeof safari>"u")return Zr;break;case"datauri":case"dataurl":return zt.document.location.href=this.output("datauristring",U);default:return null}},Kr.foo=function(){try{return Kr.apply(this,arguments)}catch(ce){var k=ce.stack||"";~k.indexOf(" at ")&&(k=k.split(" at ")[1]);var U="Error in function "+k.split(`
`)[0].split("<")[0]+": "+ce.message;if(!zt.console)throw new Error(U);zt.console.error(U,ce),zt.alert&&alert(U)}},Kr.foo.bar=Kr,Kr.foo),Ba=function(k){return Array.isArray(qt)===!0&&qt.indexOf(k)>-1};switch(n){case"pt":nt=1;break;case"mm":nt=72/25.4;break;case"cm":nt=72/2.54;break;case"in":nt=72;break;case"px":nt=Ba("px_scaling")==1?.75:96/72;break;case"pc":case"em":nt=12;break;case"ex":nt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);nt=n}var On=null;ve(),re();var ko=d.__private__.getPageInfo=d.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Ve[k].objId,pageNumber:k,pageContext:Ve[k]}},Ip=d.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in Ve)if(Ve[U].objId===k)break;return ko(U)},$x=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:Ve[R].objId,pageNumber:R,pageContext:Ve[R]}};d.addPage=function(){return $i.apply(this,arguments),this},d.setPage=function(){return zi.apply(this,arguments),Ke.call(this,je[R]),this},d.insertPage=function(k){return this.addPage(),this.movePage(R,k),this},d.movePage=function(k,U){var ce,xe;if(k>U){ce=je[k],xe=Ve[k];for(var Ne=k;Ne>U;Ne--)je[Ne]=je[Ne-1],Ve[Ne]=Ve[Ne-1];je[U]=ce,Ve[U]=xe,this.setPage(U)}else if(k<U){ce=je[k],xe=Ve[k];for(var Ue=k;Ue<U;Ue++)je[Ue]=je[Ue+1],Ve[Ue]=Ve[Ue+1];je[U]=ce,Ve[U]=xe,this.setPage(U)}return this},d.deletePage=function(){return ii.apply(this,arguments),this},d.__private__.text=d.text=function(k,U,ce,xe,Ne){var Ue,Ye,Nt,At,Wt,Zt,mr,Zr,An,Or=(xe=xe||{}).scope||this;if(typeof k=="number"&&typeof U=="number"&&(typeof ce=="string"||Array.isArray(ce))){var In=ce;ce=U,U=k,k=In}if(arguments[3]instanceof ut==0?(Nt=arguments[4],At=arguments[5],_r(mr=arguments[3])==="object"&&mr!==null||(typeof Nt=="string"&&(At=Nt,Nt=null),typeof mr=="string"&&(At=mr,mr=null),typeof mr=="number"&&(Nt=mr,mr=null),xe={flags:mr,angle:Nt,align:At})):(C("The transform parameter of text() with a Matrix value"),An=Ne),isNaN(U)||isNaN(ce)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Or;var jn,ts="",Po=typeof xe.lineHeightFactor=="number"?xe.lineHeightFactor:Ic,li=Or.internal.scaleFactor;function Lo(yr){return yr=yr.split("	").join(Array(xe.TabLen||9).join(" ")),ir(yr,mr)}function Qd(yr){for(var Cr,mn=yr.concat(),Mn=[],Ro=mn.length;Ro--;)typeof(Cr=mn.shift())=="string"?Mn.push(Cr):Array.isArray(yr)&&(Cr.length===1||Cr[1]===void 0&&Cr[2]===void 0)?Mn.push(Cr[0]):Mn.push([Cr[0],Cr[1],Cr[2]]);return Mn}function nf(yr,Cr){var mn;if(typeof yr=="string")mn=Cr(yr)[0];else if(Array.isArray(yr)){for(var Mn,Ro,lh=yr.concat(),of=[],Gp=lh.length;Gp--;)typeof(Mn=lh.shift())=="string"?of.push(Cr(Mn)[0]):Array.isArray(Mn)&&typeof Mn[0]=="string"&&(Ro=Cr(Mn[0],Mn[1],Mn[2]),of.push([Ro[0],Ro[1],Ro[2]]));mn=of}return mn}var bl=!1,$c=!0;if(typeof k=="string")bl=!0;else if(Array.isArray(k)){var zc=k.concat();Ye=[];for(var Nl,rs=zc.length;rs--;)(typeof(Nl=zc.shift())!="string"||Array.isArray(Nl)&&typeof Nl[0]!="string")&&($c=!1);bl=$c}if(bl===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Hc=qe/Or.internal.scaleFactor,qc=Hc*(Po-1);switch(xe.baseline){case"bottom":ce-=qc;break;case"top":ce+=Hc-qc;break;case"hanging":ce+=Hc-2*qc;break;case"middle":ce+=Hc/2-qc}if((Zt=xe.maxWidth||0)>0&&(typeof k=="string"?k=Or.splitTextToSize(k,Zt):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(yr,Cr){return yr.concat(Or.splitTextToSize(Cr,Zt))},[]))),Ue={text:k,x:U,y:ce,options:xe,mutex:{pdfEscape:ir,activeFontKey:pt,fonts:Ot,activeFontSize:qe}},yt.publish("preProcessText",Ue),k=Ue.text,Nt=(xe=Ue.options).angle,An instanceof ut==0&&Nt&&typeof Nt=="number"){Nt*=Math.PI/180,xe.rotationDirection===0&&(Nt=-Nt),S===b&&(Nt=-Nt);var Zd=Math.cos(Nt),eh=Math.sin(Nt);An=new ut(Zd,eh,-eh,Zd,0,0)}else Nt&&Nt instanceof ut&&(An=Nt);S!==b||An||(An=Vr),(Wt=xe.charSpace||Ao)!==void 0&&(ts+=D(q(Wt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Zr=xe.horizontalScale)!==void 0&&(ts+=D(100*Zr)+` Tz
`),xe.lang;var Ms=-1,Fo=xe.renderingMode!==void 0?xe.renderingMode:xe.stroke,sf=Or.internal.getCurrentPageInfo().pageContext;switch(Fo){case 0:case!1:case"fill":Ms=0;break;case 1:case!0:case"stroke":Ms=1;break;case 2:case"fillThenStroke":Ms=2;break;case 3:case"invisible":Ms=3;break;case 4:case"fillAndAddForClipping":Ms=4;break;case 5:case"strokeAndAddPathForClipping":Ms=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ms=6;break;case 7:case"addToPathForClipping":Ms=7}var Vp=sf.usedRenderingMode!==void 0?sf.usedRenderingMode:-1;Ms!==-1?ts+=Ms+` Tr
`:Vp!==-1&&(ts+=`0 Tr
`),Ms!==-1&&(sf.usedRenderingMode=Ms),At=xe.align||"left";var Ua,Wc=qe*Po,th=Or.internal.pageSize.getWidth(),rh=Ot[pt];Wt=xe.charSpace||Ao,Zt=xe.maxWidth||0,mr=Object.assign({autoencode:!0,noBOM:!0},xe.flags);var Sl=[],Vc=function(yr){return Or.getStringUnitWidth(yr,{font:rh,charSpace:Wt,fontSize:qe,doKerning:!1})*qe/li};if(Object.prototype.toString.call(k)==="[object Array]"){var xa;Ye=Qd(k),At!=="left"&&(Ua=Ye.map(Vc));var va,kl=0;if(At==="right"){U-=Ua[0],k=[],rs=Ye.length;for(var Do=0;Do<rs;Do++)Do===0?(va=_o(U),xa=Eo(ce)):(va=q(kl-Ua[Do]),xa=-Wc),k.push([Ye[Do],va,xa]),kl=Ua[Do]}else if(At==="center"){U-=Ua[0]/2,k=[],rs=Ye.length;for(var _l=0;_l<rs;_l++)_l===0?(va=_o(U),xa=Eo(ce)):(va=q((kl-Ua[_l])/2),xa=-Wc),k.push([Ye[_l],va,xa]),kl=Ua[_l]}else if(At==="left"){k=[],rs=Ye.length;for(var nh=0;nh<rs;nh++)k.push(Ye[nh])}else if(At==="justify"&&rh.encoding==="Identity-H"){k=[],rs=Ye.length,Zt=Zt!==0?Zt:th;for(var af=0,pn=0;pn<rs;pn++)if(xa=pn===0?Eo(ce):-Wc,va=pn===0?_o(U):af,pn<rs-1){var Kp=q((Zt-Ua[pn])/(Ye[pn].split(" ").length-1)),Wi=Ye[pn].split(" ");k.push([Wi[0]+" ",va,xa]),af=0;for(var Vi=1;Vi<Wi.length;Vi++){var sh=(Vc(Wi[Vi-1]+" "+Wi[Vi])-Vc(Wi[Vi]))*li+Kp;Vi==Wi.length-1?k.push([Wi[Vi],sh,0]):k.push([Wi[Vi]+" ",sh,0]),af-=sh}}else k.push([Ye[pn],va,xa]);k.push(["",af,0])}else{if(At!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],rs=Ye.length,Zt=Zt!==0?Zt:th,pn=0;pn<rs;pn++){xa=pn===0?Eo(ce):-Wc,va=pn===0?_o(U):0;var ah=Ye[pn].split(" ").length-1,ih=ah>0?(Zt-Ua[pn])/ah:0;pn<rs-1?Sl.push(D(q(ih))):Sl.push(0),k.push([Ye[pn],va,xa])}}}(typeof xe.R2L=="boolean"?xe.R2L:Et)===!0&&(k=nf(k,function(yr,Cr,mn){return[yr.split("").reverse().join(""),Cr,mn]})),Ue={text:k,x:U,y:ce,options:xe,mutex:{pdfEscape:ir,activeFontKey:pt,fonts:Ot,activeFontSize:qe}},yt.publish("postProcessText",Ue),k=Ue.text,jn=Ue.mutex.isHex||!1;var oh=Ot[pt].encoding;oh!=="WinAnsiEncoding"&&oh!=="StandardEncoding"||(k=nf(k,function(yr,Cr,mn){return[Lo(yr),Cr,mn]})),Ye=Qd(k),k=[];for(var El,Al,jl,Kc=Array.isArray(Ye[0])?1:0,Tl="",Gc=function(yr,Cr,mn){var Mn="";return mn instanceof ut?(mn=typeof xe.angle=="number"?gs(mn,new ut(1,0,0,1,yr,Cr)):gs(new ut(1,0,0,1,yr,Cr),mn),S===b&&(mn=gs(new ut(1,0,0,-1,0,0),mn)),Mn=mn.join(" ")+` Tm
`):Mn=D(yr)+" "+D(Cr)+` Td
`,Mn},$a=0;$a<Ye.length;$a++){switch(Tl="",Kc){case 1:jl=(jn?"<":"(")+Ye[$a][0]+(jn?">":")"),El=parseFloat(Ye[$a][1]),Al=parseFloat(Ye[$a][2]);break;case 0:jl=(jn?"<":"(")+Ye[$a]+(jn?">":")"),El=_o(U),Al=Eo(ce)}Sl!==void 0&&Sl[$a]!==void 0&&(Tl=Sl[$a]+` Tw
`),$a===0?k.push(Tl+Gc(El,Al,An)+jl):Kc===0?k.push(Tl+jl):Kc===1&&k.push(Tl+Gc(El,Al,An)+jl)}k=Kc===0?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var Ki=`BT
/`;return Ki+=pt+" "+qe+` Tf
`,Ki+=D(qe*Po)+` TL
`,Ki+=Mc+`
`,Ki+=ts,Ki+=k,J(Ki+="ET"),p[pt]=!0,Or};var zx=d.__private__.clip=d.clip=function(k){return J(k==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return zx("evenodd")},d.__private__.discardPath=d.discardPath=function(){return J("n"),this};var qi=d.__private__.isValidStyle=function(k){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(U=!0),U};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(k){return qi(k)&&(u=k),this};var Mp=d.__private__.getStyle=d.getStyle=function(k){var U=u;switch(k){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=k}return U},Bp=d.close=function(){return J("h"),this};d.stroke=function(){return J("S"),this},d.fill=function(k){return ef("f",k),this},d.fillEvenOdd=function(k){return ef("f*",k),this},d.fillStroke=function(k){return ef("B",k),this},d.fillStrokeEvenOdd=function(k){return ef("B*",k),this};var ef=function(k,U){_r(U)==="object"?qx(U,k):J(k)},Oc=function(k){k===null||S===b&&k===void 0||(k=Mp(k),J(k))};function Hx(k,U,ce,xe,Ne){var Ue=new Uf(U||this.boundingBox,ce||this.xStep,xe||this.yStep,this.gState,Ne||this.matrix);Ue.stream=this.stream;var Ye=k+"$$"+this.cloneIndex+++"$$";return Rr(Ye,Ue),Ue}var qx=function(k,U){var ce=Ge[k.key],xe=De[ce];if(xe instanceof ru)J("q"),J(Wx(U)),xe.gState&&d.setGState(xe.gState),J(k.matrix.toString()+" cm"),J("/"+ce+" sh"),J("Q");else if(xe instanceof Uf){var Ne=new ut(1,0,0,-1,0,Uc());k.matrix&&(Ne=Ne.multiply(k.matrix||Vr),ce=Hx.call(xe,k.key,k.boundingBox,k.xStep,k.yStep,Ne).id),J("q"),J("/Pattern cs"),J("/"+ce+" scn"),xe.gState&&d.setGState(xe.gState),J(U),J("Q")}},Wx=function(k){switch(k){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},qd=d.moveTo=function(k,U){return J(D(q(k))+" "+D(M(U))+" m"),this},Up=d.lineTo=function(k,U){return J(D(q(k))+" "+D(M(U))+" l"),this},oi=d.curveTo=function(k,U,ce,xe,Ne,Ue){return J([D(q(k)),D(M(U)),D(q(ce)),D(M(xe)),D(q(Ne)),D(M(Ue)),"c"].join(" ")),this};d.__private__.line=d.line=function(k,U,ce,xe,Ne){if(isNaN(k)||isNaN(U)||isNaN(ce)||isNaN(xe)||!qi(Ne))throw new Error("Invalid arguments passed to jsPDF.line");return S===y?this.lines([[ce-k,xe-U]],k,U,[1,1],Ne||"S"):this.lines([[ce-k,xe-U]],k,U,[1,1]).stroke()},d.__private__.lines=d.lines=function(k,U,ce,xe,Ne,Ue){var Ye,Nt,At,Wt,Zt,mr,Zr,An,Or,In,jn,ts;if(typeof k=="number"&&(ts=ce,ce=U,U=k,k=ts),xe=xe||[1,1],Ue=Ue||!1,isNaN(U)||isNaN(ce)||!Array.isArray(k)||!Array.isArray(xe)||!qi(Ne)||typeof Ue!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(qd(U,ce),Ye=xe[0],Nt=xe[1],Wt=k.length,In=U,jn=ce,At=0;At<Wt;At++)(Zt=k[At]).length===2?(In=Zt[0]*Ye+In,jn=Zt[1]*Nt+jn,Up(In,jn)):(mr=Zt[0]*Ye+In,Zr=Zt[1]*Nt+jn,An=Zt[2]*Ye+In,Or=Zt[3]*Nt+jn,In=Zt[4]*Ye+In,jn=Zt[5]*Nt+jn,oi(mr,Zr,An,Or,In,jn));return Ue&&Bp(),Oc(Ne),this},d.path=function(k){for(var U=0;U<k.length;U++){var ce=k[U],xe=ce.c;switch(ce.op){case"m":qd(xe[0],xe[1]);break;case"l":Up(xe[0],xe[1]);break;case"c":oi.apply(this,xe);break;case"h":Bp()}}return this},d.__private__.rect=d.rect=function(k,U,ce,xe,Ne){if(isNaN(k)||isNaN(U)||isNaN(ce)||isNaN(xe)||!qi(Ne))throw new Error("Invalid arguments passed to jsPDF.rect");return S===y&&(xe=-xe),J([D(q(k)),D(M(U)),D(q(ce)),D(q(xe)),"re"].join(" ")),Oc(Ne),this},d.__private__.triangle=d.triangle=function(k,U,ce,xe,Ne,Ue,Ye){if(isNaN(k)||isNaN(U)||isNaN(ce)||isNaN(xe)||isNaN(Ne)||isNaN(Ue)||!qi(Ye))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ce-k,xe-U],[Ne-ce,Ue-xe],[k-Ne,U-Ue]],k,U,[1,1],Ye,!0),this},d.__private__.roundedRect=d.roundedRect=function(k,U,ce,xe,Ne,Ue,Ye){if(isNaN(k)||isNaN(U)||isNaN(ce)||isNaN(xe)||isNaN(Ne)||isNaN(Ue)||!qi(Ye))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Nt=4/3*(Math.SQRT2-1);return Ne=Math.min(Ne,.5*ce),Ue=Math.min(Ue,.5*xe),this.lines([[ce-2*Ne,0],[Ne*Nt,0,Ne,Ue-Ue*Nt,Ne,Ue],[0,xe-2*Ue],[0,Ue*Nt,-Ne*Nt,Ue,-Ne,Ue],[2*Ne-ce,0],[-Ne*Nt,0,-Ne,-Ue*Nt,-Ne,-Ue],[0,2*Ue-xe],[0,-Ue*Nt,Ne*Nt,-Ue,Ne,-Ue]],k+Ne,U,[1,1],Ye,!0),this},d.__private__.ellipse=d.ellipse=function(k,U,ce,xe,Ne){if(isNaN(k)||isNaN(U)||isNaN(ce)||isNaN(xe)||!qi(Ne))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ue=4/3*(Math.SQRT2-1)*ce,Ye=4/3*(Math.SQRT2-1)*xe;return qd(k+ce,U),oi(k+ce,U-Ye,k+Ue,U-xe,k,U-xe),oi(k-Ue,U-xe,k-ce,U-Ye,k-ce,U),oi(k-ce,U+Ye,k-Ue,U+xe,k,U+xe),oi(k+Ue,U+xe,k+ce,U+Ye,k+ce,U),Oc(Ne),this},d.__private__.circle=d.circle=function(k,U,ce,xe){if(isNaN(k)||isNaN(U)||isNaN(ce)||!qi(xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,U,ce,ce,xe)},d.setFont=function(k,U,ce){return ce&&(U=A(U,ce)),pt=wl(k,U,{disableWarning:!1}),this};var Vx=d.__private__.getFont=d.getFont=function(){return Ot[wl.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var k,U,ce={};for(k in we)if(we.hasOwnProperty(k))for(U in ce[k]=[],we[k])we[k].hasOwnProperty(U)&&ce[k].push(U);return ce},d.addFont=function(k,U,ce,xe,Ne){var Ue=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ue.indexOf(arguments[3])!==-1?Ne=arguments[3]:arguments[3]&&Ue.indexOf(arguments[3])==-1&&(ce=A(ce,xe)),Ar.call(this,k,U,ce,Ne=Ne||"Identity-H")};var Ic,Wd=e.lineWidth||.200025,Kx=d.__private__.getLineWidth=d.getLineWidth=function(){return Wd},Kt=d.__private__.setLineWidth=d.setLineWidth=function(k){return Wd=k,J(D(q(k))+" w"),this};d.__private__.setLineDash=jt.API.setLineDash=jt.API.setLineDashPattern=function(k,U){if(k=k||[],U=U||0,isNaN(U)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(ce){return D(q(ce))}).join(" "),U=D(q(U)),J("["+k+"] "+U+" d"),this};var Gx=d.__private__.getLineHeight=d.getLineHeight=function(){return qe*Ic};d.__private__.getLineHeight=d.getLineHeight=function(){return qe*Ic};var Yx=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(Ic=k),this},Xx=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Ic};Yx(e.lineHeight);var _o=d.__private__.getHorizontalCoordinate=function(k){return q(k)},Eo=d.__private__.getVerticalCoordinate=function(k){return S===b?k:Ve[R].mediaBox.topRightY-Ve[R].mediaBox.bottomLeftY-q(k)},Jx=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(k){return D(_o(k))},Qx=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(k){return D(Eo(k))},tf=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return le(tf)},d.__private__.setStrokeColor=d.setDrawColor=function(k,U,ce,xe){return tf=ue({ch1:k,ch2:U,ch3:ce,ch4:xe,pdfColorType:"draw",precision:2}),J(tf),this};var Vd=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return le(Vd)},d.__private__.setFillColor=d.setFillColor=function(k,U,ce,xe){return Vd=ue({ch1:k,ch2:U,ch3:ce,ch4:xe,pdfColorType:"fill",precision:2}),J(Vd),this};var Mc=e.textColor||"0 g",Zx=d.__private__.getTextColor=d.getTextColor=function(){return le(Mc)};d.__private__.setTextColor=d.setTextColor=function(k,U,ce,xe){return Mc=ue({ch1:k,ch2:U,ch3:ce,ch4:xe,pdfColorType:"text",precision:3}),this};var Ao=e.charSpace,e2=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Ao||0)};d.__private__.setCharSpace=d.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ao=k,this};var Kd=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(k){var U=d.CapJoinStyles[k];if(U===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Kd=U,J(U+" J"),this};var Gd=0;d.__private__.setLineJoin=d.setLineJoin=function(k){var U=d.CapJoinStyles[k];if(U===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Gd=U,J(U+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(D(q(k))+" M"),this},d.GState=qg,d.setGState=function(k){(k=typeof k=="string"?Re[Pe[k]]:$p(null,k)).equals(bt)||(J("/"+k.id+" gs"),bt=k)};var $p=function(k,U){if(!k||!Pe[k]){var ce=!1;for(var xe in Re)if(Re.hasOwnProperty(xe)&&Re[xe].equals(U)){ce=!0;break}if(ce)U=Re[xe];else{var Ne="GS"+(Object.keys(Re).length+1).toString(10);Re[Ne]=U,U.id=Ne}return k&&(Pe[k]=U.id),yt.publish("addGState",U),U}};d.addGState=function(k,U){return $p(k,U),this},d.saveGraphicsState=function(){return J("q"),Je.push({key:pt,size:qe,color:Mc}),this},d.restoreGraphicsState=function(){J("Q");var k=Je.pop();return pt=k.key,qe=k.size,Mc=k.color,bt=null,this},d.setCurrentTransformationMatrix=function(k){return J(k.toString()+" cm"),this},d.comment=function(k){return J("#"+k),this};var jo=function(k,U){var ce=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ce},set:function(Ue){isNaN(Ue)||(ce=parseFloat(Ue))}});var xe=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xe},set:function(Ue){isNaN(Ue)||(xe=parseFloat(Ue))}});var Ne="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ne},set:function(Ue){Ne=Ue.toString()}}),this},Yd=function(k,U,ce,xe){jo.call(this,k,U),this.type="rect";var Ne=ce||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ne},set:function(Ye){isNaN(Ye)||(Ne=parseFloat(Ye))}});var Ue=xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ue},set:function(Ye){isNaN(Ye)||(Ue=parseFloat(Ye))}}),this},rf=function(){this.page=Qe,this.currentPage=R,this.pages=je.slice(0),this.pagesContext=Ve.slice(0),this.x=at,this.y=ar,this.matrix=Ct,this.width=Jd(R),this.height=Hp(R),this.outputDestination=We,this.id="",this.objectNumber=-1};rf.prototype.restore=function(){Qe=this.page,R=this.currentPage,Ve=this.pagesContext,je=this.pages,at=this.x,ar=this.y,Ct=this.matrix,zp(R,this.width),To(R,this.height),We=this.outputDestination};var Xd=function(k,U,ce,xe,Ne){Qr.push(new rf),Qe=R=0,je=[],at=k,ar=U,Ct=Ne,sn([ce,xe])};for(var Bc in d.beginFormObject=function(k,U,ce,xe,Ne){return Xd(k,U,ce,xe,Ne),this},d.endFormObject=function(k){return function(U){if(wr[U])Qr.pop().restore();else{var ce=new rf,xe="Xo"+(Object.keys(Tr).length+1).toString(10);ce.id=xe,wr[U]=xe,Tr[xe]=ce,yt.publish("addFormObject",ce),Qr.pop().restore()}}(k),this},d.doFormObject=function(k,U){var ce=Tr[wr[k]];return J("q"),J(U.toString()+" cm"),J("/"+ce.id+" Do"),J("Q"),this},d.getFormObject=function(k){var U=Tr[wr[k]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},d.save=function(k,U){return k=k||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(eu(Zu(Hi()),k),typeof eu.unload=="function"&&zt.setTimeout&&setTimeout(eu.unload,911),this):new Promise(function(ce,xe){try{var Ne=eu(Zu(Hi()),k);typeof eu.unload=="function"&&zt.setTimeout&&setTimeout(eu.unload,911),ce(Ne)}catch(Ue){xe(Ue.message)}})},jt.API)jt.API.hasOwnProperty(Bc)&&(Bc==="events"&&jt.API.events.length?function(k,U){var ce,xe,Ne;for(Ne=U.length-1;Ne!==-1;Ne--)ce=U[Ne][0],xe=U[Ne][1],k.subscribe.apply(k,[ce].concat(typeof xe=="function"?[xe]:xe))}(yt,jt.API.events):d[Bc]=jt.API[Bc]);function Jd(k){return Ve[k].mediaBox.topRightX-Ve[k].mediaBox.bottomLeftX}function zp(k,U){Ve[k].mediaBox.topRightX=U+Ve[k].mediaBox.bottomLeftX}function Hp(k){return Ve[k].mediaBox.topRightY-Ve[k].mediaBox.bottomLeftY}function To(k,U){Ve[k].mediaBox.topRightY=U+Ve[k].mediaBox.bottomLeftY}var Co=d.getPageWidth=function(k){return Jd(k=k||R)/nt},qp=d.setPageWidth=function(k,U){zp(k,U*nt)},Uc=d.getPageHeight=function(k){return Hp(k=k||R)/nt},Wp=d.setPageHeight=function(k,U){To(k,U*nt)};return d.internal={pdfEscape:ir,getStyle:Mp,getFont:Vx,getFontSize:ct,getCharSpace:e2,getTextColor:Zx,getLineHeight:Gx,getLineHeightFactor:Xx,getLineWidth:Kx,write:ze,getHorizontalCoordinate:_o,getVerticalCoordinate:Eo,getCoordinateString:Jx,getVerticalCoordinateString:Qx,collections:{},newObject:fr,newAdditionalObject:ae,newObjectDeferred:St,newObjectDeferredBegin:H,getFilters:ke,putStream:Oe,events:yt,scaleFactor:nt,pageSize:{getWidth:function(){return Co(R)},setWidth:function(k){qp(R,k)},getHeight:function(){return Uc(R)},setHeight:function(k){Wp(R,k)}},encryptionOptions:f,encryption:On,getEncryptor:function(k){return f!==null?On.encryptor(k,0):function(U){return U}},output:Op,getNumberOfPages:Ma,get pages(){return je},out:J,f2:E,f3:P,getPageInfo:ko,getPageInfoByObjId:Ip,getCurrentPageInfo:$x,getPDFVersion:g,Point:jo,Rectangle:Yd,Matrix:ut,hasHotfix:Ba},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Co(R)},set:function(k){qp(R,k)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return Uc(R)},set:function(k){Wp(R,k)},enumerable:!0,configurable:!0}),(function(k){for(var U=0,ce=it.length;U<ce;U++){var xe=Ar.call(this,k[U][0],k[U][1],k[U][2],it[U][3],!0);h===!1&&(p[xe]=!0);var Ne=k[U][0].split("-");Bt({id:xe,fontName:Ne[0],fontStyle:Ne[1]||""})}yt.publish("addFonts",{fonts:Ot,dictionary:we})}).call(d,it),pt="F1",$i(s,r),yt.publish("initialized"),d}_f.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},_f.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},_f.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},_f.prototype.processOwnerPassword=function(e,t){return Zw(Qw(t).substr(0,5),e)},_f.prototype.encryptor=function(e,t){var r=Qw(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Zw(r,n)}},qg.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||_r(e)!==_r(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},jt.API={events:[]},jt.version="3.0.4";var cn=jt.API,h4=1,Ju=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},vf=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Xt=function(e){return e.toFixed(2)},Ul=function(e){return e.toFixed(5)};cn.__acroform__={};var ga=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},P_=function(e){return e*h4},eo=function(e){var t=new dP,r=wt.internal.getHeight(e)||0,n=wt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Xt(n)),Number(Xt(r))],t},OZ=cn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},IZ=cn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},MZ=cn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},bn=cn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return MZ(e,t-1)},Nn=cn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return OZ(e,t-1)},Sn=cn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return IZ(e,t-1)},BZ=cn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,s=e[0],a=e[1],i=e[2],o=e[3],l={};return l.lowerLeft_X=r(s)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=r(s+i)||0,l.upperRight_Y=n(a)||0,[Number(Xt(l.lowerLeft_X)),Number(Xt(l.lowerLeft_Y)),Number(Xt(l.upperRight_X)),Number(Xt(l.upperRight_Y))]},UZ=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=e5(e,r),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+Xt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=eo(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},e5=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(E){return E.split(`
`)}):s.map(function(E){return[E]});var a=r,i=wt.internal.getHeight(e)||0;i=i<0?-i:i;var o=wt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(E,P,q){if(E+1<s.length){var M=P+" "+s[E+1][0];return a1(M,e,q).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var u,f,h=a1("3",e,a).height,p=e.multiline?i-a:(i-h)/2,d=p+=2,m=0,g=0,w=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+a1(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var x="",y=0,b=0;b<s.length;b++)if(s.hasOwnProperty(b)){var S=!1;if(s[b].length!==1&&w!==s[b].length-1){if((h+2)*(y+2)+2>i)continue e;x+=s[b][w],S=!0,g=b,b--}else{x=(x+=s[b][w]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var T=parseInt(b),L=l(T,x,a),A=b>=s.length-1;if(L&&!A){x+=" ",w=0;continue}if(L||A){if(A)g=T;else if(e.multiline&&(h+2)*(y+2)+2>i)continue e}else{if(!e.multiline||(h+2)*(y+2)+2>i)continue e;g=T}}for(var D="",C=m;C<=g;C++){var O=s[C];if(e.multiline){if(C===g){D+=O[w]+" ",w=(w+1)%O.length;continue}if(C===m){D+=O[O.length-1]+" ";continue}}D+=O[0]+" "}switch(D=D.substr(D.length-1)==" "?D.substr(0,D.length-1):D,f=a1(D,e,a).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;default:u=2}t+=Xt(u)+" "+Xt(d)+` Td
`,t+="("+Ju(D)+`) Tj
`,t+=-Xt(u)+` 0 Td
`,d=-(a+2),f=0,m=S?g:g+1,y++,x=""}break}return n.text=t,n.fontSize=a,n},a1=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:s}},$Z={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},zZ=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},HZ=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Bi.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify($Z)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");h4=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new hP,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in n)if(n.hasOwnProperty(s)){var a=n[s];a.objId=void 0,a.hasAnnotation&&zZ(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,s){var a=!n;for(var i in n||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(i)){var o=n[i],l=[],u=o.Rect;if(o.Rect&&(o.Rect=BZ(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=wt.createDefaultAppearanceStream(o),_r(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=UZ(o);l.push({key:"AP",value:"<</N "+f+">>"}),s.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var d=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var i in d)if(d.hasOwnProperty(i)){var m=d[i];typeof m=="function"&&(m=m.call(s,o)),h+="/"+i+" "+m+" ",s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m)}}else typeof(m=d)=="function"&&(m=m.call(s,o)),h+="/"+i+" "+m,s.internal.acroformPlugin.xForms.indexOf(m)>=0||s.internal.acroformPlugin.xForms.push(m);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}s.internal.putStream({additionalKeyValues:l,objectId:o.objId}),s.internal.out("endobj")}a&&function(g,w){for(var x in g)if(g.hasOwnProperty(x)){var y=x,b=g[x];w.internal.newObjectDeferredBegin(b.objId,!0),_r(b)==="object"&&typeof b.putStream=="function"&&b.putStream(),delete g[y]}}(s.internal.acroformPlugin.xForms,s)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},fP=cn.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(i){return i};if(Array.isArray(e)){for(var s="[",a=0;a<e.length;a++)switch(a!==0&&(s+=" "),_r(e[a])){case"boolean":case"number":case"object":s+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),s+="("+Ju(n(e[a].toString()))+")"):s+=e[a].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Ov=function(e,t,r){var n=function(s){return s};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Ju(n(e))+")"},co=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};co.prototype.toString=function(){return this.objId+" 0 R"},co.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},co.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],s=this[n];s&&(Array.isArray(s)?e.push({key:n,value:fP(s,this.objId,this.scope)}):s instanceof co?(s.scope=this.scope,e.push({key:n,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:n,value:s}))}return e};var dP=function(){co.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ga(dP,co);var hP=function(){co.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Ju(r(e))+")"}},set:function(r){e=r}})};ga(hP,co);var Bi=function e(){co.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bn(t,3)},set:function(x){x?this.F=Nn(t,3):this.F=Sn(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');r=x}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(x){n=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(x){n[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(x){n[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(x){n[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(x){n[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Wg)return;a="FieldObject"+e.FieldNum++}var x=function(y){return y};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Ju(x(a))+")"},set:function(x){a=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(x){a=x}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(x){i=x}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(x){o=x}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/h4:u},set:function(x){u=x}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(x){f=x}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Wg||this instanceof _u))return Ov(h,this.objId,this.scope)},set:function(x){x=x.toString(),h=x}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Qn==0?Ov(p,this.objId,this.scope):p},set:function(x){x=x.toString(),p=this instanceof Qn==0?x.substr(0,1)==="("?vf(x.substr(1,x.length-2)):vf(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qn==1?vf(p.substr(1,p.length-1)):p},set:function(x){x=x.toString(),p=this instanceof Qn==1?"/"+x:x}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Qn==0?Ov(d,this.objId,this.scope):d},set:function(x){x=x.toString(),d=this instanceof Qn==0?x.substr(0,1)==="("?vf(x.substr(1,x.length-2)):vf(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qn==1?vf(d.substr(1,d.length-1)):d},set:function(x){x=x.toString(),d=this instanceof Qn==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var m,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(x){x=!!x,g=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(m)return m},set:function(x){m=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,1)},set:function(x){x?this.Ff=Nn(this.Ff,1):this.Ff=Sn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,2)},set:function(x){x?this.Ff=Nn(this.Ff,2):this.Ff=Sn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,3)},set:function(x){x?this.Ff=Nn(this.Ff,3):this.Ff=Sn(this.Ff,3)}});var w=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(w!==null)return w},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');w=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(w){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:w=2;break;case"center":case 1:w=1;break;default:w=0}}})};ga(Bi,co);var td=function(){Bi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return fP(t,this.objId,this.scope)},set:function(r){var n,s;s=[],typeof(n=r)=="string"&&(s=function(a,i,o){o||(o=1);for(var l,u=[];l=i.exec(a);)u.push(l[o]);return u}(n,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,18)},set:function(r){r?this.Ff=Nn(this.Ff,18):this.Ff=Sn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Nn(this.Ff,19):this.Ff=Sn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,20)},set:function(r){r?(this.Ff=Nn(this.Ff,20),t.sort()):this.Ff=Sn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,22)},set:function(r){r?this.Ff=Nn(this.Ff,22):this.Ff=Sn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(r){r?this.Ff=Nn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,27)},set:function(r){r?this.Ff=Nn(this.Ff,27):this.Ff=Sn(this.Ff,27)}}),this.hasAppearanceStream=!1};ga(td,Bi);var rd=function(){td.call(this),this.fontName="helvetica",this.combo=!1};ga(rd,td);var nd=function(){rd.call(this),this.combo=!0};ga(nd,rd);var B1=function(){nd.call(this),this.edit=!0};ga(B1,nd);var Qn=function(){Bi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,15)},set:function(r){r?this.Ff=Nn(this.Ff,15):this.Ff=Sn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,16)},set:function(r){r?this.Ff=Nn(this.Ff,16):this.Ff=Sn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,17)},set:function(r){r?this.Ff=Nn(this.Ff,17):this.Ff=Sn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(r){r?this.Ff=Nn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,s=[];for(n in s.push("<<"),t)s.push("/"+n+" ("+Ju(r(t[n]))+")");return s.push(">>"),s.join(`
`)}},set:function(r){_r(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ga(Qn,Bi);var U1=function(){Qn.call(this),this.pushButton=!0};ga(U1,Qn);var sd=function(){Qn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ga(sd,Qn);var Wg=function(){var e,t;Bi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var a,i=[];for(a in i.push("<<"),n)i.push("/"+a+" ("+Ju(s(n[a]))+")");return i.push(">>"),i.join(`
`)},set:function(s){_r(s)==="object"&&(n=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(s){typeof s=="string"&&(n.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(s){r=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(s){r="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=wt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ga(Wg,Bi),sd.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},sd.prototype.createOption=function(e){var t=new Wg;return t.Parent=this,t.optionName=e,this.Kids.push(t),qZ.call(this.scope,t),t};var $1=function(){Qn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=wt.CheckBox.createAppearanceStream()};ga($1,Qn);var _u=function(){Bi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,13)},set:function(t){t?this.Ff=Nn(this.Ff,13):this.Ff=Sn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,21)},set:function(t){t?this.Ff=Nn(this.Ff,21):this.Ff=Sn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,23)},set:function(t){t?this.Ff=Nn(this.Ff,23):this.Ff=Sn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,24)},set:function(t){t?this.Ff=Nn(this.Ff,24):this.Ff=Sn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,25)},set:function(t){t?this.Ff=Nn(this.Ff,25):this.Ff=Sn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,26)},set:function(t){t?this.Ff=Nn(this.Ff,26):this.Ff=Sn(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ga(_u,Bi);var z1=function(){_u.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bn(this.Ff,14)},set:function(e){e?this.Ff=Nn(this.Ff,14):this.Ff=Sn(this.Ff,14)}}),this.password=!0};ga(z1,_u);var wt={CheckBox:{createAppearanceStream:function(){return{N:{On:wt.CheckBox.YesNormal},D:{On:wt.CheckBox.YesPushDown,Off:wt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),a=e5(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Xt(wt.internal.getWidth(e))+" "+Xt(wt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Xt(a.fontSize)+" Tf "+s),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=[],a=wt.internal.getHeight(e),i=wt.internal.getWidth(e),o=e5(e,e.caption);return s.push("1 g"),s.push("0 0 "+Xt(i)+" "+Xt(a)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+Xt(i-1)+" "+Xt(a-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+r+" "+Xt(o.fontSize)+" Tf "+n),s.push(o.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Xt(wt.internal.getWidth(e))+" "+Xt(wt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:wt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=wt.RadioButton.Circle.YesNormal,t.D[e]=wt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=wt.internal.Bezier_C,a=Number((n*s).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ul(wt.internal.getWidth(e)/2)+" "+Ul(wt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*wt.internal.Bezier_C).toFixed(5)),i=Number((n*wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ul(wt.internal.getWidth(e)/2)+" "+Ul(wt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ul(wt.internal.getWidth(e)/2)+" "+Ul(wt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=wt.internal.getWidth(e)<=wt.internal.getHeight(e)?wt.internal.getWidth(e)/4:wt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var s=Number((2*n).toFixed(5)),a=Number((s*wt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ul(wt.internal.getWidth(e)/2)+" "+Ul(wt.internal.getHeight(e)/2)+" cm"),r.push(s+" 0 m"),r.push(s+" "+a+" "+a+" "+s+" 0 "+s+" c"),r.push("-"+a+" "+s+" -"+s+" "+a+" -"+s+" 0 c"),r.push("-"+s+" -"+a+" -"+a+" -"+s+" 0 -"+s+" c"),r.push(a+" -"+s+" "+s+" -"+a+" "+s+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:wt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=wt.RadioButton.Cross.YesNormal,t.D[e]=wt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=eo(e);t.scope=e.scope;var r=[],n=wt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Xt(wt.internal.getWidth(e)-2)+" "+Xt(wt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Xt(n.x1.x)+" "+Xt(n.x1.y)+" m"),r.push(Xt(n.x2.x)+" "+Xt(n.x2.y)+" l"),r.push(Xt(n.x4.x)+" "+Xt(n.x4.y)+" m"),r.push(Xt(n.x3.x)+" "+Xt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=wt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Xt(wt.internal.getWidth(e))+" "+Xt(wt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Xt(wt.internal.getWidth(e)-2)+" "+Xt(wt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Xt(r.x1.x)+" "+Xt(r.x1.y)+" m"),n.push(Xt(r.x2.x)+" "+Xt(r.x2.y)+" l"),n.push(Xt(r.x4.x)+" "+Xt(r.x4.y)+" m"),n.push(Xt(r.x3.x)+" "+Xt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=eo(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Xt(wt.internal.getWidth(e))+" "+Xt(wt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};wt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=wt.internal.getWidth(e),r=wt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},wt.internal.getWidth=function(e){var t=0;return _r(e)==="object"&&(t=P_(e.Rect[2])),t},wt.internal.getHeight=function(e){var t=0;return _r(e)==="object"&&(t=P_(e.Rect[3])),t};var qZ=cn.addField=function(e){if(HZ(this,e),!(e instanceof Bi))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};cn.AcroFormChoiceField=td,cn.AcroFormListBox=rd,cn.AcroFormComboBox=nd,cn.AcroFormEditBox=B1,cn.AcroFormButton=Qn,cn.AcroFormPushButton=U1,cn.AcroFormRadioButton=sd,cn.AcroFormCheckBox=$1,cn.AcroFormTextField=_u,cn.AcroFormPasswordField=z1,cn.AcroFormAppearance=wt,cn.AcroForm={ChoiceField:td,ListBox:rd,ComboBox:nd,EditBox:B1,Button:Qn,PushButton:U1,RadioButton:sd,CheckBox:$1,TextField:_u,PasswordField:z1,Appearance:wt},jt.AcroForm={ChoiceField:td,ListBox:rd,ComboBox:nd,EditBox:B1,Button:Qn,PushButton:U1,RadioButton:sd,CheckBox:$1,TextField:_u,PasswordField:z1,Appearance:wt};jt.AcroForm;function pP(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(E,P){var q,M,ne,fe,me,re=r;if((P=P||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(L(E))for(me in n)for(ne=n[me],q=0;q<ne.length;q+=1){for(fe=!0,M=0;M<ne[q].length;M+=1)if(ne[q][M]!==void 0&&ne[q][M]!==E[M]){fe=!1;break}if(fe===!0){re=me;break}}else for(me in n)for(ne=n[me],q=0;q<ne.length;q+=1){for(fe=!0,M=0;M<ne[q].length;M+=1)if(ne[q][M]!==void 0&&ne[q][M]!==E.charCodeAt(M)){fe=!1;break}if(fe===!0){re=me;break}}return re===r&&P!==r&&(re=P),re},a=function E(P){for(var q=this.internal.write,M=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);P.objectId=this.internal.newObject();var fe=[];if(fe.push({key:"Type",value:"/XObject"}),fe.push({key:"Subtype",value:"/Image"}),fe.push({key:"Width",value:P.width}),fe.push({key:"Height",value:P.height}),P.colorSpace===x.INDEXED?fe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(P.palette.length/3-1)+" "+("sMask"in P&&P.sMask!==void 0?P.objectId+2:P.objectId+1)+" 0 R]"}):(fe.push({key:"ColorSpace",value:"/"+P.colorSpace}),P.colorSpace===x.DEVICE_CMYK&&fe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),fe.push({key:"BitsPerComponent",value:P.bitsPerComponent}),"decodeParameters"in P&&P.decodeParameters!==void 0&&fe.push({key:"DecodeParms",value:"<<"+P.decodeParameters+">>"}),"transparency"in P&&Array.isArray(P.transparency)&&P.transparency.length>0){for(var me="",re=0,G=P.transparency.length;re<G;re++)me+=P.transparency[re]+" "+P.transparency[re]+" ";fe.push({key:"Mask",value:"["+me+"]"})}P.sMask!==void 0&&fe.push({key:"SMask",value:P.objectId+1+" 0 R"});var ge=P.filter!==void 0?["/"+P.filter]:void 0;if(M({data:P.data,additionalKeyValues:fe,alreadyAppliedFilters:ge,objectId:P.objectId}),q("endobj"),"sMask"in P&&P.sMask!==void 0){var ve,_=(ve=P.sMaskBitsPerComponent)!==null&&ve!==void 0?ve:P.bitsPerComponent,R={width:P.width,height:P.height,colorSpace:"DeviceGray",bitsPerComponent:_,data:P.sMask};"filter"in P&&(R.decodeParameters="/Predictor ".concat(P.predictor," /Colors 1 /BitsPerComponent ").concat(_," /Columns ").concat(P.width),R.filter=P.filter),E.call(this,R)}if(P.colorSpace===x.INDEXED){var I=this.internal.newObject();M({data:D(new Uint8Array(P.palette)),objectId:I}),q("endobj")}},i=function(){var E=this.internal.collections[t+"images"];for(var P in E)a.call(this,E[P])},o=function(){var E,P=this.internal.collections[t+"images"],q=this.internal.write;for(var M in P)q("/I"+(E=P[M]).index,E.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var E=this.internal.collections[t+"images"];return l.call(this),E},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(E){return typeof e["process"+E.toUpperCase()]=="function"},p=function(E){return _r(E)==="object"&&E.nodeType===1},d=function(E,P){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var q=""+E.getAttribute("src");if(q.indexOf("data:image/")===0)return M1(unescape(q).split("base64,").pop());var M=e.loadFile(q,!0);if(M!==void 0)return M}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var ne;switch(P){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;default:ne="image/jpeg"}return M1(E.toDataURL(ne,1).split("base64,").pop())}},m=function(E){var P=this.internal.collections[t+"images"];if(P){for(var q in P)if(E===P[q].alias)return P[q]}},g=function(E,P,q){return E||P||(E=-96,P=-96),E<0&&(E=-1*q.width*72/E/this.internal.scaleFactor),P<0&&(P=-1*q.height*72/P/this.internal.scaleFactor),E===0&&(E=P*q.width/q.height),P===0&&(P=E*q.height/q.width),[E,P]},w=function(E,P,q,M,ne,fe){var me=g.call(this,q,M,ne),re=this.internal.getCoordinateString,G=this.internal.getVerticalCoordinateString,ge=u.call(this);if(q=me[0],M=me[1],ge[ne.index]=ne,fe){fe*=Math.PI/180;var ve=Math.cos(fe),_=Math.sin(fe),R=function(B){return B.toFixed(4)},I=[R(ve),R(_),R(-1*_),R(ve),0,0,"cm"]}this.internal.write("q"),fe?(this.internal.write([1,"0","0",1,re(E),G(P+M),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([re(q),"0","0",re(M),"0","0","cm"].join(" "))):this.internal.write([re(q),"0","0",re(M),re(E),G(P+M),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},b=e.__addimage__.sHashCode=function(E){var P,q,M=0;if(typeof E=="string")for(q=E.length,P=0;P<q;P++)M=(M<<5)-M+E.charCodeAt(P),M|=0;else if(L(E))for(q=E.byteLength/2,P=0;P<q;P++)M=(M<<5)-M+E[P],M|=0;return M},S=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var P=!0;return E.length===0&&(P=!1),E.length%4!=0&&(P=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(P=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(P=!1),P},T=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var P=E.indexOf(",");return P<0?null:E.substring(0,P).trim().endsWith("base64")?E.substring(P+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var L=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},A=e.__addimage__.binaryStringToUint8Array=function(E){for(var P=E.length,q=new Uint8Array(P),M=0;M<P;M++)q[M]=E.charCodeAt(M);return q},D=e.__addimage__.arrayBufferToBinaryString=function(E){for(var P="",q=L(E)?E:new Uint8Array(E),M=0;M<q.length;M+=8192)P+=String.fromCharCode.apply(null,q.subarray(M,M+8192));return P};e.addImage=function(){var E,P,q,M,ne,fe,me,re,G;if(typeof arguments[1]=="number"?(P=r,q=arguments[1],M=arguments[2],ne=arguments[3],fe=arguments[4],me=arguments[5],re=arguments[6],G=arguments[7]):(P=arguments[1],q=arguments[2],M=arguments[3],ne=arguments[4],fe=arguments[5],me=arguments[6],re=arguments[7],G=arguments[8]),_r(E=arguments[0])==="object"&&!p(E)&&"imageData"in E){var ge=E;E=ge.imageData,P=ge.format||P||r,q=ge.x||q||0,M=ge.y||M||0,ne=ge.w||ge.width||ne,fe=ge.h||ge.height||fe,me=ge.alias||me,re=ge.compression||re,G=ge.rotation||ge.angle||G}var ve=this.internal.getFilters();if(re===void 0&&ve.indexOf("FlateEncode")!==-1&&(re="SLOW"),isNaN(q)||isNaN(M))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var _=C.call(this,E,P,me,re);return w.call(this,q,M,ne,fe,_,G),this};var C=function(E,P,q,M){var ne,fe,me;if(typeof E=="string"&&s(E)===r){E=unescape(E);var re=O(E,!1);(re!==""||(re=e.loadFile(E,!0))!==void 0)&&(E=re)}if(p(E)&&(E=d(E,P)),P=s(E,P),!h(P))throw new Error("addImage does not support files of type '"+P+"', please ensure that a plugin for '"+P+"' support is added.");if(((me=q)==null||me.length===0)&&(q=function(G){return typeof G=="string"||L(G)?b(G):L(G.data)?b(G.data):null}(E)),(ne=m.call(this,q))||(E instanceof Uint8Array||P==="RGBA"||(fe=E,E=A(E)),ne=this["process"+P.toUpperCase()](E,f.call(this),q,function(G){return G&&typeof G=="string"&&(G=G.toUpperCase()),G in e.image_compression?G:y.NONE}(M),fe)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},O=e.__addimage__.convertBase64ToBinaryString=function(E,P){P=typeof P!="boolean"||P;var q,M="";if(typeof E=="string"){var ne;q=(ne=T(E))!==null&&ne!==void 0?ne:E;try{M=M1(q)}catch(fe){if(P)throw S(q)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+fe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return M};e.getImageProperties=function(E){var P,q,M="";if(p(E)&&(E=d(E)),typeof E=="string"&&s(E)===r&&((M=O(E,!1))===""&&(M=e.loadFile(E)||""),E=M),q=s(E),!h(q))throw new Error("addImage does not support files of type '"+q+"', please ensure that a plugin for '"+q+"' support is added.");if(E instanceof Uint8Array||(E=A(E)),!(P=this["process"+q.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return P.fileType=q,P}})(jt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};jt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,s,a,i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,h=0;h<u.length&&!f;h++)switch((n=u[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var d=this.internal.pdfEscape,m=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),w=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(g.objId),y=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(x(n.contents))+")",a+=" /Popup "+w.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+d(x(y))+") >>",g.content=a;var b=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+i(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+i(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+b,n.open&&(a+=" /Open true"),a+=" >>",w.content=a,this.internal.write(g.objId,"0 R",w.objId,"0 R");break;case"freetext":s="/Rect ["+i(n.bounds.x)+" "+o(n.bounds.y)+" "+i(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var S=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+d(m(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+S+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var T=this.annotations._nameMap[n.options.name];n.options.pageNumber=T.page,n.options.top=T.y}else n.options.top||(n.options.top=0);if(s="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+d(m(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var L=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+L+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,s,a,i){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:u(n),w:l(r+s),h:u(n+a)},options:i,type:"link"})},e.textWithLink=function(r,n,s,a){var i,o,l=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var f=this.splitTextToSize(r,o).length;i=Math.ceil(u*f)}else o=l,i=u;return this.text(r,n,s,a),s+=.2*u,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,s-u,o,i,a),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(jt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},i=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return i(g)&&s.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return i(g)&&a(g)&&t[g.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(g){var w=0,x=r,y="",b=0;for(w=0;w<g.length;w+=1)x[g.charCodeAt(w)]!==void 0?(b++,typeof(x=x[g.charCodeAt(w)])=="number"&&(y+=String.fromCharCode(x),x=r,b=0),w===g.length-1&&(x=r,y+=g.charAt(w-(b-1)),w-=b-1,b=0)):(x=r,y+=g.charAt(w-b),w-=b,b=0);return y};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,w,x){return i(g)?a(g)===!1?-1:!u(g)||!i(w)&&!i(x)||!i(x)&&o(w)||o(g)&&!i(w)||o(g)&&l(w)||o(g)&&o(w)?0:f(g)&&i(w)&&!o(w)&&i(x)&&u(x)?3:o(g)||!i(x)?1:2:-1},d=function(g){var w=0,x=0,y=0,b="",S="",T="",L=(g=g||"").split("\\s+"),A=[];for(w=0;w<L.length;w+=1){for(A.push(""),x=0;x<L[w].length;x+=1)b=L[w][x],S=L[w][x-1],T=L[w][x+1],i(b)?(y=p(b,S,T),A[w]+=y!==-1?String.fromCharCode(t[b.charCodeAt(0)][y]):b):A[w]+=b;A[w]=h(A[w])}return A.join(" ")},m=e.__arabicParser__.processArabic=e.processArabic=function(){var g,w=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(w)){var y=0;for(x=[],y=0;y<w.length;y+=1)Array.isArray(w[y])?x.push([d(w[y][0]),w[y][1],w[y][2]]):x.push([d(w[y])]);g=x}else g=d(w);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",m])}(jt.API),jt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(o){i=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var s;if((r=r||"2d")!=="2d")return null;for(s in n)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=n[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(jt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var m=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return m},set:function(g){m=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),h=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,d=0,m=0,g=0,w=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var x=u.maxWidth;x>0?typeof l=="string"?l=this.splitTextToSize(l,x):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(b,S){return b.concat(w.splitTextToSize(S,x))},[])):l=Array.isArray(l)?l:[l];for(var y=0;y<l.length;y++)d<(g=this.getStringUnitWidth(l[y],{font:h})*f)&&(d=g);return d!==0&&(m=l.length),{w:d/=p,h:Math.max((m*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,d&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};e.table=function(l,u,f,h,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var d,m,g,w,x=[],y=[],b=[],S={},T={},L=[],A=[],D=(p=p||{}).autoSize||!1,C=p.printHeaders!==!1,O=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,E=p.margins||Object.assign({width:this.getPageWidth()},t),P=typeof p.padding=="number"?p.padding:3,q=p.headerBackgroundColor||"#c8c8c8",M=p.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=C,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=O,this.internal.__cell__.padding=P,this.internal.__cell__.headerBackgroundColor=q,this.internal.__cell__.headerTextColor=M,this.setFontSize(O),h==null)y=x=Object.keys(f[0]),b=x.map(function(){return"left"});else if(Array.isArray(h)&&_r(h[0])==="object")for(x=h.map(function(ge){return ge.name}),y=h.map(function(ge){return ge.prompt||ge.name||""}),b=h.map(function(ge){return ge.align||"left"}),d=0;d<h.length;d+=1)T[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(y=x=h,b=x.map(function(){return"left"}));if(D||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<x.length;d+=1){for(S[w=x[d]]=f.map(function(ge){return ge[w]}),this.setFont(void 0,"bold"),L.push(this.getTextDimensions(y[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),m=S[w],this.setFont(void 0,"normal"),g=0;g<m.length;g+=1)L.push(this.getTextDimensions(m[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);T[w]=Math.max.apply(null,L)+P+P,L=[]}if(C){var ne={};for(d=0;d<x.length;d+=1)ne[x[d]]={},ne[x[d]].text=y[d],ne[x[d]].align=b[d];var fe=o.call(this,ne,T);A=x.map(function(ge){return new a(l,u,T[ge],fe,ne[ge].text,void 0,ne[ge].align)}),this.setTableHeaderRow(A),this.printHeaderRow(1,!1)}var me=h.reduce(function(ge,ve){return ge[ve.name]=ve.align,ge},{});for(d=0;d<f.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:f[d]},this);var re=o.call(this,f[d],T);for(g=0;g<x.length;g+=1){var G=f[d][x[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:g,data:G},this),i.call(this,new a(l,u,T[x[g]],re,G,d+2,me[x[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var o=function(l,u){var f=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(d){var m=l[d];return this.splitTextToSize(m.hasOwnProperty("text")?m.text:m,u[d]-f-f)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/p+f+f},this).reduce(function(d,m){return Math.max(d,m)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){f=this.internal.__cell__.tableHeaderRow[d].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=l;var m=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,f),this.setTextColor(m)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(jt.API);var mP={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},gP=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],t5=pP(gP),xP=[100,200,300,400,500,600,700,800,900],WZ=pP(xP);function Iv(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return mP[a=a||"normal"]?a:"normal"}(e.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(e.weight),s=function(a){return typeof t5[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,r,n].join(" ")}}}function L_(e,t,r,n){var s;for(s=r;s>=0&&s<t.length;s+=n)if(e[t[s]])return e[t[s]];for(s=r;s>=0&&s<t.length;s-=n)if(e[t[s]])return e[t[s]]}var VZ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},F_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function D_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function R_(e){return e.trimLeft()}function KZ(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function GZ(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var i1,O_,I_,yf,o1,M_,B_,U_,Mv=["times"];function $_(e,t,r,n,s){var a=4,i=H_;switch(s){case jt.API.image_compression.FAST:a=1,i=z_;break;case jt.API.image_compression.MEDIUM:a=6,i=q_;break;case jt.API.image_compression.SLOW:a=9,i=W_}e=function(l,u,f,h){for(var p,d=l.length/u,m=new Uint8Array(l.length+d),g=[YZ,z_,H_,q_,W_],w=0;w<d;w+=1){var x=w*u,y=l.subarray(x,x+u);if(h)m.set(h(y,f,p),x+w);else{for(var b=g.length,S=[],T=0;T<b;T+=1)S[T]=g[T](y,f,p);var L=JZ(S.concat());m.set(S[L],x+w)}p=y}return m}(e,t,Math.ceil(r*n/8),i);var o=Gw(e,{level:a});return jt.API.__addimage__.arrayBufferToBinaryString(o)}function YZ(e){var t=Array.apply([],e);return t.unshift(0),t}function z_(e,t){var r=e.length,n=[];n[0]=1;for(var s=0;s<r;s+=1){var a=e[s-t]||0;n[s+1]=e[s]-a+256&255}return n}function H_(e,t,r){var n=e.length,s=[];s[0]=2;for(var a=0;a<n;a+=1){var i=r&&r[a]||0;s[a+1]=e[a]-i+256&255}return s}function q_(e,t,r){var n=e.length,s=[];s[0]=3;for(var a=0;a<n;a+=1){var i=e[a-t]||0,o=r&&r[a]||0;s[a+1]=e[a]+256-(i+o>>>1)&255}return s}function W_(e,t,r){var n=e.length,s=[];s[0]=4;for(var a=0;a<n;a+=1){var i=XZ(e[a-t]||0,r&&r[a]||0,r&&r[a-t]||0);s[a+1]=e[a]-i+256&255}return s}function XZ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),s=Math.abs(e-r),a=Math.abs(e+t-r-r);return n<=s&&n<=a?e:s<=a?t:r}function JZ(e){var t=e.map(function(r){return r.reduce(function(n,s){return n+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function Bv(e,t,r){var n=t*r,s=Math.floor(n/8),a=16-(n-8*s+r),i=(1<<r)-1;return vP(e,s)>>a&i}function V_(e,t,r,n){var s=r*n,a=Math.floor(s/8),i=16-(s-8*a+n),o=(1<<n)-1,l=(t&o)<<i;(function(u,f,h){if(f+1<u.byteLength)u.setUint16(f,h,!1);else{var p=h>>8&255;u.setUint8(f,p)}})(e,a,vP(e,a)&~(o<<i)&65535|l)}function vP(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function QZ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,s=e[t++],a=s>>7,i=1<<1+(7&s);e[t++],e[t++];var o=null,l=null;a&&(o=t,l=i,t+=3*i);var u=!0,f=[],h=0,p=null,d=0,m=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,m=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var w=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,S=e[t++],T=S>>6&1,L=1<<1+(7&S),A=o,D=l,C=!1;S>>7&&(C=!0,A=t,D=L,t+=3*L);var O=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}f.push({x:w,y:x,width:y,height:b,has_local_palette:C,palette_offset:A,palette_size:D,data_offset:O,data_length:t-O,transparent_index:p,interlaced:!!T,delay:h,disposal:d});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return m},this.frameInfo=function(P){if(P<0||P>=f.length)throw new Error("Frame index out of range.");return f[P]},this.decodeAndBlitFrameBGRA=function(P,q){var M=this.frameInfo(P),ne=M.width*M.height,fe=new Uint8Array(ne);K_(e,M.data_offset,fe,ne);var me=M.palette_offset,re=M.transparent_index;re===null&&(re=256);var G=M.width,ge=r-G,ve=G,_=4*(M.y*r+M.x),R=4*((M.y+M.height)*r+M.x),I=_,B=4*ge;M.interlaced===!0&&(B+=4*r*7);for(var W=8,se=0,pe=fe.length;se<pe;++se){var he=fe[se];if(ve===0&&(ve=G,(I+=B)>=R&&(B=4*ge+4*r*(W-1),I=_+(G+ge)*(W<<1),W>>=1)),he===re)I+=4;else{var de=e[me+3*he],je=e[me+3*he+1],Y=e[me+3*he+2];q[I++]=Y,q[I++]=je,q[I++]=de,q[I++]=255}--ve}},this.decodeAndBlitFrameRGBA=function(P,q){var M=this.frameInfo(P),ne=M.width*M.height,fe=new Uint8Array(ne);K_(e,M.data_offset,fe,ne);var me=M.palette_offset,re=M.transparent_index;re===null&&(re=256);var G=M.width,ge=r-G,ve=G,_=4*(M.y*r+M.x),R=4*((M.y+M.height)*r+M.x),I=_,B=4*ge;M.interlaced===!0&&(B+=4*r*7);for(var W=8,se=0,pe=fe.length;se<pe;++se){var he=fe[se];if(ve===0&&(ve=G,(I+=B)>=R&&(B=4*ge+4*r*(W-1),I=_+(G+ge)*(W<<1),W>>=1)),he===re)I+=4;else{var de=e[me+3*he],je=e[me+3*he+1],Y=e[me+3*he+2];q[I++]=de,q[I++]=je,q[I++]=Y,q[I++]=255}--ve}}}function K_(e,t,r,n){for(var s=e[t++],a=1<<s,i=a+1,o=i+1,l=s+1,u=(1<<l)-1,f=0,h=0,p=0,d=e[t++],m=new Int32Array(4096),g=null;;){for(;f<16&&d!==0;)h|=e[t++]<<f,f+=8,d===1?d=e[t++]:--d;if(f<l)break;var w=h&u;if(h>>=l,f-=l,w!==a){if(w===i)break;for(var x=w<o?w:g,y=0,b=x;b>a;)b=m[b]>>8,++y;var S=b;if(p+y+(x!==w?1:0)>n)return void Fr.log("Warning, gif stream longer than expected.");r[p++]=S;var T=p+=y;for(x!==w&&(r[p++]=S),b=x;y--;)b=m[b],r[--T]=255&b,b>>=8;g!==null&&o<4096&&(m[o++]=g<<8|S,o>=u+1&&l<12&&(++l,u=u<<1|1)),g=w}else o=i+1,u=(1<<(l=s+1))-1,g=null}return p!==n&&Fr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Uv(e){var t,r,n,s,a,i=Math.floor,o=new Array(64),l=new Array(64),u=new Array(64),f=new Array(64),h=new Array(65535),p=new Array(65535),d=new Array(64),m=new Array(64),g=[],w=0,x=7,y=new Array(64),b=new Array(64),S=new Array(64),T=new Array(256),L=new Array(2048),A=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],D=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],O=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],P=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],q=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function fe(_,R){for(var I=0,B=0,W=new Array,se=1;se<=16;se++){for(var pe=1;pe<=_[se];pe++)W[R[B]]=[],W[R[B]][0]=I,W[R[B]][1]=se,B++,I++;I*=2}return W}function me(_){for(var R=_[0],I=_[1]-1;I>=0;)R&1<<I&&(w|=1<<x),I--,--x<0&&(w==255?(re(255),re(0)):re(w),x=7,w=0)}function re(_){g.push(_)}function G(_){re(_>>8&255),re(255&_)}function ge(_,R,I,B,W){for(var se,pe=W[0],he=W[240],de=function(qe,ht){var ct,Et,xt,Ht,Mt,Ft,Yt,Lt,pt,nt,at=0;for(pt=0;pt<8;++pt){ct=qe[at],Et=qe[at+1],xt=qe[at+2],Ht=qe[at+3],Mt=qe[at+4],Ft=qe[at+5],Yt=qe[at+6];var ar=ct+(Lt=qe[at+7]),Ct=ct-Lt,Ot=Et+Yt,we=Et-Yt,Je=xt+Ft,De=xt-Ft,Ge=Ht+Mt,Re=Ht-Mt,Pe=ar+Ge,bt=ar-Ge,Qe=Ot+Je,Ve=Ot-Je;qe[at]=Pe+Qe,qe[at+4]=Pe-Qe;var yt=.707106781*(Ve+bt);qe[at+2]=bt+yt,qe[at+6]=bt-yt;var qt=.382683433*((Pe=Re+De)-(Ve=we+Ct)),Tr=.5411961*Pe+qt,wr=1.306562965*Ve+qt,Qr=.707106781*(Qe=De+we),ut=Ct+Qr,gs=Ct-Qr;qe[at+5]=gs+Tr,qe[at+3]=gs-Tr,qe[at+1]=ut+wr,qe[at+7]=ut-wr,at+=8}for(at=0,pt=0;pt<8;++pt){ct=qe[at],Et=qe[at+8],xt=qe[at+16],Ht=qe[at+24],Mt=qe[at+32],Ft=qe[at+40],Yt=qe[at+48];var Vr=ct+(Lt=qe[at+56]),Rr=ct-Lt,Kr=Et+Yt,fr=Et-Yt,St=xt+Ft,H=xt-Ft,ae=Ht+Mt,Q=Ht-Mt,te=Vr+ae,le=Vr-ae,ue=Kr+St,ke=Kr-St;qe[at]=te+ue,qe[at+32]=te-ue;var Oe=.707106781*(ke+le);qe[at+16]=le+Oe,qe[at+48]=le-Oe;var _e=.382683433*((te=Q+H)-(ke=fr+Rr)),Ee=.5411961*te+_e,Ce=1.306562965*ke+_e,Ze=.707106781*(ue=H+fr),st=Rr+Ze,ft=Rr-Ze;qe[at+40]=ft+Ee,qe[at+24]=ft-Ee,qe[at+8]=st+Ce,qe[at+56]=st-Ce,at++}for(pt=0;pt<64;++pt)nt=qe[pt]*ht[pt],d[pt]=nt>0?nt+.5|0:nt-.5|0;return d}(_,R),je=0;je<64;++je)m[A[je]]=de[je];var Y=m[0]-I;I=m[0],Y==0?me(B[0]):(me(B[p[se=32767+Y]]),me(h[se]));for(var We=63;We>0&&m[We]==0;)We--;if(We==0)return me(pe),I;for(var Ke,J=1;J<=We;){for(var ze=J;m[J]==0&&J<=We;)++J;var He=J-ze;if(He>=16){Ke=He>>4;for(var it=1;it<=Ke;++it)me(he);He&=15}se=32767+m[J],me(W[(He<<4)+p[se]]),me(h[se]),J++}return We!=63&&me(pe),I}function ve(_){_=Math.min(Math.max(_,1),100),a!=_&&(function(R){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],B=0;B<64;B++){var W=i((I[B]*R+50)/100);W=Math.min(Math.max(W,1),255),o[A[B]]=W}for(var se=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],pe=0;pe<64;pe++){var he=i((se[pe]*R+50)/100);he=Math.min(Math.max(he,1),255),l[A[pe]]=he}for(var de=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],je=0,Y=0;Y<8;Y++)for(var We=0;We<8;We++)u[je]=1/(o[A[je]]*de[Y]*de[We]*8),f[je]=1/(l[A[je]]*de[Y]*de[We]*8),je++}(_<50?Math.floor(5e3/_):Math.floor(200-2*_)),a=_)}this.encode=function(_,R){R&&ve(R),g=new Array,w=0,x=7,G(65496),G(65504),G(16),re(74),re(70),re(73),re(70),re(0),re(1),re(1),re(0),G(1),G(1),re(0),re(0),function(){G(65499),G(132),re(0);for(var Et=0;Et<64;Et++)re(o[Et]);re(1);for(var xt=0;xt<64;xt++)re(l[xt])}(),function(Et,xt){G(65472),G(17),re(8),G(xt),G(Et),re(3),re(1),re(17),re(0),re(2),re(17),re(1),re(3),re(17),re(1)}(_.width,_.height),function(){G(65476),G(418),re(0);for(var Et=0;Et<16;Et++)re(D[Et+1]);for(var xt=0;xt<=11;xt++)re(C[xt]);re(16);for(var Ht=0;Ht<16;Ht++)re(O[Ht+1]);for(var Mt=0;Mt<=161;Mt++)re(E[Mt]);re(1);for(var Ft=0;Ft<16;Ft++)re(P[Ft+1]);for(var Yt=0;Yt<=11;Yt++)re(q[Yt]);re(17);for(var Lt=0;Lt<16;Lt++)re(M[Lt+1]);for(var pt=0;pt<=161;pt++)re(ne[pt])}(),G(65498),G(12),re(3),re(1),re(0),re(2),re(17),re(3),re(17),re(0),re(63),re(0);var I=0,B=0,W=0;w=0,x=7,this.encode.displayName="_encode_";for(var se,pe,he,de,je,Y,We,Ke,J,ze=_.data,He=_.width,it=_.height,qe=4*He,ht=0;ht<it;){for(se=0;se<qe;){for(je=qe*ht+se,We=-1,Ke=0,J=0;J<64;J++)Y=je+(Ke=J>>3)*qe+(We=4*(7&J)),ht+Ke>=it&&(Y-=qe*(ht+1+Ke-it)),se+We>=qe&&(Y-=se+We-qe+4),pe=ze[Y++],he=ze[Y++],de=ze[Y++],y[J]=(L[pe]+L[he+256|0]+L[de+512|0]>>16)-128,b[J]=(L[pe+768|0]+L[he+1024|0]+L[de+1280|0]>>16)-128,S[J]=(L[pe+1280|0]+L[he+1536|0]+L[de+1792|0]>>16)-128;I=ge(y,u,I,t,n),B=ge(b,f,B,r,s),W=ge(S,f,W,r,s),se+=32}ht+=8}if(x>=0){var ct=[];ct[1]=x+1,ct[0]=(1<<x+1)-1,me(ct)}return G(65497),new Uint8Array(g)},e=e||50,function(){for(var _=String.fromCharCode,R=0;R<256;R++)T[R]=_(R)}(),t=fe(D,C),r=fe(P,q),n=fe(O,E),s=fe(M,ne),function(){for(var _=1,R=2,I=1;I<=15;I++){for(var B=_;B<R;B++)p[32767+B]=I,h[32767+B]=[],h[32767+B][1]=I,h[32767+B][0]=B;for(var W=-(R-1);W<=-_;W++)p[32767+W]=I,h[32767+W]=[],h[32767+W][1]=I,h[32767+W][0]=R-1+W;_<<=1,R<<=1}}(),function(){for(var _=0;_<256;_++)L[_]=19595*_,L[_+256|0]=38470*_,L[_+512|0]=7471*_+32768,L[_+768|0]=-11059*_,L[_+1024|0]=-21709*_,L[_+1280|0]=32768*_+8421375,L[_+1536|0]=-27439*_,L[_+1792|0]=-5329*_}(),ve(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function mi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function G_(e){function t(C){if(!C)throw Error("assert :P")}function r(C,O,E){for(var P=0;4>P;P++)if(C[O+P]!=E.charCodeAt(P))return!0;return!1}function n(C,O,E,P,q){for(var M=0;M<q;M++)C[O+M]=E[P+M]}function s(C,O,E,P){for(var q=0;q<P;q++)C[O+q]=E}function a(C){return new Int32Array(C)}function i(C,O){for(var E=[],P=0;P<C;P++)E.push(new O);return E}function o(C,O){var E=[];return function P(q,M,ne){for(var fe=ne[M],me=0;me<fe&&(q.push(ne.length>M+1?[]:new O),!(ne.length<M+1));me++)P(q[me],M+1,ne)}(E,0,C),E}var l=function(){var C=this;function O(v,N){for(var j=1<<N-1>>>0;v&j;)j>>>=1;return j?(v&j-1)+j:v}function E(v,N,j,F,z){t(!(F%j));do v[N+(F-=j)]=z;while(0<F)}function P(v,N,j,F,z){if(t(2328>=z),512>=z)var V=a(512);else if((V=a(z))==null)return 0;return function(K,X,Z,ie,ye,Te){var oe,be,Se=X,Ie=1<<Z,Ae=a(16),Me=a(16);for(t(ye!=0),t(ie!=null),t(K!=null),t(0<Z),be=0;be<ye;++be){if(15<ie[be])return 0;++Ae[ie[be]]}if(Ae[0]==ye)return 0;for(Me[1]=0,oe=1;15>oe;++oe){if(Ae[oe]>1<<oe)return 0;Me[oe+1]=Me[oe]+Ae[oe]}for(be=0;be<ye;++be)oe=ie[be],0<ie[be]&&(Te[Me[oe]++]=be);if(Me[15]==1)return(ie=new q).g=0,ie.value=Te[0],E(K,Se,1,Ie,ie),Ie;var $e,et=-1,Xe=Ie-1,Tt=0,vt=1,rr=1,kt=1<<Z;for(be=0,oe=1,ye=2;oe<=Z;++oe,ye<<=1){if(vt+=rr<<=1,0>(rr-=Ae[oe]))return 0;for(;0<Ae[oe];--Ae[oe])(ie=new q).g=oe,ie.value=Te[be++],E(K,Se+Tt,ye,kt,ie),Tt=O(Tt,oe)}for(oe=Z+1,ye=2;15>=oe;++oe,ye<<=1){if(vt+=rr<<=1,0>(rr-=Ae[oe]))return 0;for(;0<Ae[oe];--Ae[oe]){if(ie=new q,(Tt&Xe)!=et){for(Se+=kt,$e=1<<(et=oe)-Z;15>et&&!(0>=($e-=Ae[et]));)++et,$e<<=1;Ie+=kt=1<<($e=et-Z),K[X+(et=Tt&Xe)].g=$e+Z,K[X+et].value=Se-X-et}ie.g=oe-Z,ie.value=Te[be++],E(K,Se+(Tt>>Z),ye,kt,ie),Tt=O(Tt,oe)}}return vt!=2*Me[15]-1?0:Ie}(v,N,j,F,z,V)}function q(){this.value=this.g=0}function M(){this.value=this.g=0}function ne(){this.G=i(5,q),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Vc,M)}function fe(v,N,j,F){t(v!=null),t(N!=null),t(2147483648>F),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=N,v.pa=j,v.Jd=N,v.Yc=j+F,v.Zc=4<=F?j+F-4+1:j,pe(v)}function me(v,N){for(var j=0;0<N--;)j|=de(v,128)<<N;return j}function re(v,N){var j=me(v,N);return he(v)?-j:j}function G(v,N,j,F){var z,V=0;for(t(v!=null),t(N!=null),t(4294967288>F),v.Sb=F,v.Ra=0,v.u=0,v.h=0,4<F&&(F=4),z=0;z<F;++z)V+=N[j+z]<<8*z;v.Ra=V,v.bb=F,v.oa=N,v.pa=j}function ge(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<kl-8>>>0,++v.bb,v.u-=8;B(v)&&(v.h=1,v.u=0)}function ve(v,N){if(t(0<=N),!v.h&&N<=va){var j=I(v)&xa[N];return v.u+=N,ge(v),j}return v.h=1,v.u=0}function _(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function R(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function I(v){return v.Ra>>>(v.u&kl-1)>>>0}function B(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>kl}function W(v,N){v.u=N,v.h=B(v)}function se(v){v.u>=Do&&(t(v.u>=Do),ge(v))}function pe(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function he(v){return me(v,1)}function de(v,N){var j=v.Ca;0>v.b&&pe(v);var F=v.b,z=j*N>>>8,V=(v.I>>>F>z)+0;for(V?(j-=z,v.I-=z+1<<F>>>0):j=z+1,F=j,z=0;256<=F;)z+=8,F>>=8;return F=7^z+_l[F],v.b-=F,v.Ca=(j<<F)-1,V}function je(v,N,j){v[N+0]=j>>24&255,v[N+1]=j>>16&255,v[N+2]=j>>8&255,v[N+3]=255&j}function Y(v,N){return v[N+0]|v[N+1]<<8}function We(v,N){return Y(v,N)|v[N+2]<<16}function Ke(v,N){return Y(v,N)|Y(v,N+2)<<16}function J(v,N){var j=1<<N;return t(v!=null),t(0<N),v.X=a(j),v.X==null?0:(v.Mb=32-N,v.Xa=N,1)}function ze(v,N){t(v!=null),t(N!=null),t(v.Xa==N.Xa),n(N.X,0,v.X,0,1<<N.Xa)}function He(){this.X=[],this.Xa=this.Mb=0}function it(v,N,j,F){t(j!=null),t(F!=null);var z=j[0],V=F[0];return z==0&&(z=(v*V+N/2)/N),V==0&&(V=(N*z+v/2)/v),0>=z||0>=V?0:(j[0]=z,F[0]=V,1)}function qe(v,N){return v+(1<<N)-1>>>N}function ht(v,N){return((4278255360&v)+(4278255360&N)>>>0&4278255360)+((16711935&v)+(16711935&N)>>>0&16711935)>>>0}function ct(v,N){C[N]=function(j,F,z,V,K,X,Z){var ie;for(ie=0;ie<K;++ie){var ye=C[v](X[Z+ie-1],z,V+ie);X[Z+ie]=ht(j[F+ie],ye)}}}function Et(){this.ud=this.hd=this.jd=0}function xt(v,N){return((4278124286&(v^N))>>>1)+(v&N)>>>0}function Ht(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Mt(v,N){return Ht(v+(v-N+.5>>1))}function Ft(v,N,j){return Math.abs(N-j)-Math.abs(v-j)}function Yt(v,N,j,F,z,V,K){for(F=V[K-1],j=0;j<z;++j)V[K+j]=F=ht(v[N+j],F)}function Lt(v,N,j,F,z){var V;for(V=0;V<j;++V){var K=v[N+V],X=K>>8&255,Z=16711935&(Z=(Z=16711935&K)+((X<<16)+X));F[z+V]=(4278255360&K)+Z>>>0}}function pt(v,N){N.jd=255&v,N.hd=v>>8&255,N.ud=v>>16&255}function nt(v,N,j,F,z,V){var K;for(K=0;K<F;++K){var X=N[j+K],Z=X>>>8,ie=X,ye=255&(ye=(ye=X>>>16)+((v.jd<<24>>24)*(Z<<24>>24)>>>5));ie=255&(ie=(ie+=(v.hd<<24>>24)*(Z<<24>>24)>>>5)+((v.ud<<24>>24)*(ye<<24>>24)>>>5)),z[V+K]=(4278255360&X)+(ye<<16)+ie}}function at(v,N,j,F,z){C[N]=function(V,K,X,Z,ie,ye,Te,oe,be){for(Z=Te;Z<oe;++Z)for(Te=0;Te<be;++Te)ie[ye++]=z(X[F(V[K++])])},C[v]=function(V,K,X,Z,ie,ye,Te){var oe=8>>V.b,be=V.Ea,Se=V.K[0],Ie=V.w;if(8>oe)for(V=(1<<V.b)-1,Ie=(1<<oe)-1;K<X;++K){var Ae,Me=0;for(Ae=0;Ae<be;++Ae)Ae&V||(Me=F(Z[ie++])),ye[Te++]=z(Se[Me&Ie]),Me>>=oe}else C["VP8LMapColor"+j](Z,ie,Se,Ie,ye,Te,K,X,be)}}function ar(v,N,j,F,z){for(j=N+j;N<j;){var V=v[N++];F[z++]=V>>16&255,F[z++]=V>>8&255,F[z++]=255&V}}function Ct(v,N,j,F,z){for(j=N+j;N<j;){var V=v[N++];F[z++]=V>>16&255,F[z++]=V>>8&255,F[z++]=255&V,F[z++]=V>>24&255}}function Ot(v,N,j,F,z){for(j=N+j;N<j;){var V=(K=v[N++])>>16&240|K>>12&15,K=240&K|K>>28&15;F[z++]=V,F[z++]=K}}function we(v,N,j,F,z){for(j=N+j;N<j;){var V=(K=v[N++])>>16&248|K>>13&7,K=K>>5&224|K>>3&31;F[z++]=V,F[z++]=K}}function Je(v,N,j,F,z){for(j=N+j;N<j;){var V=v[N++];F[z++]=255&V,F[z++]=V>>8&255,F[z++]=V>>16&255}}function De(v,N,j,F,z,V){if(V==0)for(j=N+j;N<j;)je(F,((V=v[N++])[0]>>24|V[1]>>8&65280|V[2]<<8&16711680|V[3]<<24)>>>0),z+=32;else n(F,z,v,N,j)}function Ge(v,N){C[N][0]=C[v+"0"],C[N][1]=C[v+"1"],C[N][2]=C[v+"2"],C[N][3]=C[v+"3"],C[N][4]=C[v+"4"],C[N][5]=C[v+"5"],C[N][6]=C[v+"6"],C[N][7]=C[v+"7"],C[N][8]=C[v+"8"],C[N][9]=C[v+"9"],C[N][10]=C[v+"10"],C[N][11]=C[v+"11"],C[N][12]=C[v+"12"],C[N][13]=C[v+"13"],C[N][14]=C[v+"0"],C[N][15]=C[v+"0"]}function Re(v){return v==n2||v==s2||v==em||v==a2}function Pe(){this.eb=[],this.size=this.A=this.fb=0}function bt(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Qe(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Pe,this.f.kb=new bt,this.sd=null}function Ve(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function yt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function qt(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function Tr(v,N){var j=v.T,F=N.ba.f.RGBA,z=F.eb,V=F.fb+v.ka*F.A,K=Ha[N.ba.S],X=v.y,Z=v.O,ie=v.f,ye=v.N,Te=v.ea,oe=v.W,be=N.cc,Se=N.dc,Ie=N.Mc,Ae=N.Nc,Me=v.ka,$e=v.ka+v.T,et=v.U,Xe=et+1>>1;for(Me==0?K(X,Z,null,null,ie,ye,Te,oe,ie,ye,Te,oe,z,V,null,null,et):(K(N.ec,N.fc,X,Z,be,Se,Ie,Ae,ie,ye,Te,oe,z,V-F.A,z,V,et),++j);Me+2<$e;Me+=2)be=ie,Se=ye,Ie=Te,Ae=oe,ye+=v.Rc,oe+=v.Rc,V+=2*F.A,K(X,(Z+=2*v.fa)-v.fa,X,Z,be,Se,Ie,Ae,ie,ye,Te,oe,z,V-F.A,z,V,et);return Z+=v.fa,v.j+$e<v.o?(n(N.ec,N.fc,X,Z,et),n(N.cc,N.dc,ie,ye,Xe),n(N.Mc,N.Nc,Te,oe,Xe),j--):1&$e||K(X,Z,null,null,ie,ye,Te,oe,ie,ye,Te,oe,z,V+F.A,null,null,et),j}function wr(v,N,j){var F=v.F,z=[v.J];if(F!=null){var V=v.U,K=N.ba.S,X=K==Zp||K==em;N=N.ba.f.RGBA;var Z=[0],ie=v.ka;Z[0]=v.T,v.Kb&&(ie==0?--Z[0]:(--ie,z[0]-=v.width),v.j+v.ka+v.T==v.o&&(Z[0]=v.o-v.j-ie));var ye=N.eb;ie=N.fb+ie*N.A,v=b4(F,z[0],v.width,V,Z,ye,ie+(X?0:3),N.A),t(j==Z),v&&Re(K)&&ch(ye,ie,X,V,Z,N.A)}return 0}function Qr(v){var N=v.ma,j=N.ba.S,F=11>j,z=j==Jp||j==Qp||j==Zp||j==r2||j==12||Re(j);if(N.memory=null,N.Ib=null,N.Jb=null,N.Nd=null,!th(N.Oa,v,z?11:12))return 0;if(z&&Re(j)&&Qd(),v.da)alert("todo:use_scaling");else{if(F){if(N.Ib=qt,v.Kb){if(j=v.U+1>>1,N.memory=a(v.U+2*j),N.memory==null)return 0;N.ec=N.memory,N.fc=0,N.cc=N.ec,N.dc=N.fc+v.U,N.Mc=N.cc,N.Nc=N.dc+j,N.Ib=Tr,Qd()}}else alert("todo:EmitYUV");z&&(N.Jb=wr,F&&li())}if(F&&!I4){for(v=0;256>v;++v)rL[v]=89858*(v-128)+rm>>tm,aL[v]=-22014*(v-128)+rm,sL[v]=-45773*(v-128),nL[v]=113618*(v-128)+rm>>tm;for(v=fh;v<l2;++v)N=76283*(v-16)+rm>>tm,iL[v-fh]=_n(N,255),oL[v-fh]=_n(N+8>>4,15);I4=1}return 1}function ut(v){var N=v.ma,j=v.U,F=v.T;return t(!(1&v.ka)),0>=j||0>=F?0:(j=N.Ib(v,N),N.Jb!=null&&N.Jb(v,N,j),N.Dc+=j,1)}function gs(v){v.ma.memory=null}function Vr(v,N,j,F){return ve(v,8)!=47?0:(N[0]=ve(v,14)+1,j[0]=ve(v,14)+1,F[0]=ve(v,1),ve(v,3)!=0?0:!v.h)}function Rr(v,N){if(4>v)return v+1;var j=v-2>>1;return(2+(1&v)<<j)+ve(N,j)+1}function Kr(v,N){return 120<N?N-120:1<=(j=((j=zP[N-1])>>4)*v+(8-(15&j)))?j:1;var j}function fr(v,N,j){var F=I(j),z=v[N+=255&F].g-8;return 0<z&&(W(j,j.u+8),F=I(j),N+=v[N].value,N+=F&(1<<z)-1),W(j,j.u+v[N].g),v[N].value}function St(v,N,j){return j.g+=v.g,j.value+=v.value<<N>>>0,t(8>=j.g),v.g}function H(v,N,j){var F=v.xc;return t((N=F==0?0:v.vc[v.md*(j>>F)+(N>>F)])<v.Wb),v.Ya[N]}function ae(v,N,j,F){var z=v.ab,V=v.c*N,K=v.C;N=K+N;var X=j,Z=F;for(F=v.Ta,j=v.Ua;0<z--;){var ie=v.gc[z],ye=K,Te=N,oe=X,be=Z,Se=(Z=F,X=j,ie.Ea);switch(t(ye<Te),t(Te<=ie.nc),ie.hc){case 2:pn(oe,be,(Te-ye)*Se,Z,X);break;case 0:var Ie=ye,Ae=Te,Me=Z,$e=X,et=(kt=ie).Ea;Ie==0&&(nh(oe,be,null,null,1,Me,$e),Yt(oe,be+1,0,0,et-1,Me,$e+1),be+=et,$e+=et,++Ie);for(var Xe=1<<kt.b,Tt=Xe-1,vt=qe(et,kt.b),rr=kt.K,kt=kt.w+(Ie>>kt.b)*vt;Ie<Ae;){var or=rr,Bn=kt,nr=1;for(af(oe,be,Me,$e-et,1,Me,$e);nr<et;){var _t=(nr&~Tt)+Xe;_t>et&&(_t=et),(0,ah[or[Bn++]>>8&15])(oe,be+ +nr,Me,$e+nr-et,_t-nr,Me,$e+nr),nr=_t}be+=et,$e+=et,++Ie&Tt||(kt+=vt)}Te!=ie.nc&&n(Z,X-Se,Z,X+(Te-ye-1)*Se,Se);break;case 1:for(Se=oe,Ae=be,et=(oe=ie.Ea)-($e=oe&~(Me=(be=1<<ie.b)-1)),Ie=qe(oe,ie.b),Xe=ie.K,ie=ie.w+(ye>>ie.b)*Ie;ye<Te;){for(Tt=Xe,vt=ie,rr=new Et,kt=Ae+$e,or=Ae+oe;Ae<kt;)pt(Tt[vt++],rr),ih(rr,Se,Ae,be,Z,X),Ae+=be,X+=be;Ae<or&&(pt(Tt[vt++],rr),ih(rr,Se,Ae,et,Z,X),Ae+=et,X+=et),++ye&Me||(ie+=Ie)}break;case 3:if(oe==Z&&be==X&&0<ie.b){for(Ae=Z,oe=Se=X+(Te-ye)*Se-($e=(Te-ye)*qe(ie.Ea,ie.b)),be=Z,Me=X,Ie=[],$e=(et=$e)-1;0<=$e;--$e)Ie[$e]=be[Me+$e];for($e=et-1;0<=$e;--$e)Ae[oe+$e]=Ie[$e];Kp(ie,ye,Te,Z,Se,Z,X)}else Kp(ie,ye,Te,oe,be,Z,X)}X=F,Z=j}Z!=j&&n(F,j,X,Z,V)}function Q(v,N){var j=v.V,F=v.Ba+v.c*v.C,z=N-v.C;if(t(N<=v.l.o),t(16>=z),0<z){var V=v.l,K=v.Ta,X=v.Ua,Z=V.width;if(ae(v,z,j,F),z=X=[X],t((j=v.C)<(F=N)),t(V.v<V.va),F>V.o&&(F=V.o),j<V.j){var ie=V.j-j;j=V.j,z[0]+=ie*Z}if(j>=F?j=0:(z[0]+=4*V.v,V.ka=j-V.j,V.U=V.va-V.v,V.T=F-j,j=1),j){if(X=X[0],11>(j=v.ca).S){var ye=j.f.RGBA,Te=(F=j.S,z=V.U,V=V.T,ie=ye.eb,ye.A),oe=V;for(ye=ye.fb+v.Ma*ye.A;0<oe--;){var be=K,Se=X,Ie=z,Ae=ie,Me=ye;switch(F){case Xp:oh(be,Se,Ie,Ae,Me);break;case Jp:El(be,Se,Ie,Ae,Me);break;case n2:El(be,Se,Ie,Ae,Me),ch(Ae,Me,0,Ie,1,0);break;case j4:Kc(be,Se,Ie,Ae,Me);break;case Qp:De(be,Se,Ie,Ae,Me,1);break;case s2:De(be,Se,Ie,Ae,Me,1),ch(Ae,Me,0,Ie,1,0);break;case Zp:De(be,Se,Ie,Ae,Me,0);break;case em:De(be,Se,Ie,Ae,Me,0),ch(Ae,Me,1,Ie,1,0);break;case r2:Al(be,Se,Ie,Ae,Me);break;case a2:Al(be,Se,Ie,Ae,Me),w4(Ae,Me,Ie,1,0);break;case T4:jl(be,Se,Ie,Ae,Me);break;default:t(0)}X+=Z,ye+=Te}v.Ma+=V}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=j.height)}}v.C=N,t(v.C<=v.i)}function te(v){var N;if(0<v.ua)return 0;for(N=0;N<v.Wb;++N){var j=v.Ya[N].G,F=v.Ya[N].H;if(0<j[1][F[1]+0].g||0<j[2][F[2]+0].g||0<j[3][F[3]+0].g)return 0}return 1}function le(v,N,j,F,z,V){if(v.Z!=0){var K=v.qd,X=v.rd;for(t(Pl[v.Z]!=null);N<j;++N)Pl[v.Z](K,X,F,z,F,z,V),K=F,X=z,z+=V;v.qd=K,v.rd=X}}function ue(v,N){var j=v.l.ma,F=j.Z==0||j.Z==1?v.l.j:v.C;if(F=v.C<F?F:v.C,t(N<=v.l.o),N>F){var z=v.l.width,V=j.ca,K=j.tb+z*F,X=v.V,Z=v.Ba+v.c*F,ie=v.gc;t(v.ab==1),t(ie[0].hc==3),Vi(ie[0],F,N,X,Z,V,K),le(j,F,N,V,K,z)}v.C=v.Ma=N}function ke(v,N,j,F,z,V,K){var X=v.$/F,Z=v.$%F,ie=v.m,ye=v.s,Te=j+v.$,oe=Te;z=j+F*z;var be=j+F*V,Se=280+ye.ua,Ie=v.Pb?X:16777216,Ae=0<ye.ua?ye.Wa:null,Me=ye.wc,$e=Te<be?H(ye,Z,X):null;t(v.C<V),t(be<=z);var et=!1;e:for(;;){for(;et||Te<be;){var Xe=0;if(X>=Ie){var Tt=Te-j;t((Ie=v).Pb),Ie.wd=Ie.m,Ie.xd=Tt,0<Ie.s.ua&&ze(Ie.s.Wa,Ie.s.vb),Ie=X+qP}if(Z&Me||($e=H(ye,Z,X)),t($e!=null),$e.Qb&&(N[Te]=$e.qb,et=!0),!et)if(se(ie),$e.jc){Xe=ie,Tt=N;var vt=Te,rr=$e.pd[I(Xe)&Vc-1];t($e.jc),256>rr.g?(W(Xe,Xe.u+rr.g),Tt[vt]=rr.value,Xe=0):(W(Xe,Xe.u+rr.g-256),t(256<=rr.value),Xe=rr.value),Xe==0&&(et=!0)}else Xe=fr($e.G[0],$e.H[0],ie);if(ie.h)break;if(et||256>Xe){if(!et)if($e.nd)N[Te]=($e.qb|Xe<<8)>>>0;else{if(se(ie),et=fr($e.G[1],$e.H[1],ie),se(ie),Tt=fr($e.G[2],$e.H[2],ie),vt=fr($e.G[3],$e.H[3],ie),ie.h)break;N[Te]=(vt<<24|et<<16|Xe<<8|Tt)>>>0}if(et=!1,++Te,++Z>=F&&(Z=0,++X,K!=null&&X<=V&&!(X%16)&&K(v,X),Ae!=null))for(;oe<Te;)Xe=N[oe++],Ae.X[(506832829*Xe&4294967295)>>>Ae.Mb]=Xe}else if(280>Xe){if(Xe=Rr(Xe-256,ie),Tt=fr($e.G[4],$e.H[4],ie),se(ie),Tt=Kr(F,Tt=Rr(Tt,ie)),ie.h)break;if(Te-j<Tt||z-Te<Xe)break e;for(vt=0;vt<Xe;++vt)N[Te+vt]=N[Te+vt-Tt];for(Te+=Xe,Z+=Xe;Z>=F;)Z-=F,++X,K!=null&&X<=V&&!(X%16)&&K(v,X);if(t(Te<=z),Z&Me&&($e=H(ye,Z,X)),Ae!=null)for(;oe<Te;)Xe=N[oe++],Ae.X[(506832829*Xe&4294967295)>>>Ae.Mb]=Xe}else{if(!(Xe<Se))break e;for(et=Xe-280,t(Ae!=null);oe<Te;)Xe=N[oe++],Ae.X[(506832829*Xe&4294967295)>>>Ae.Mb]=Xe;Xe=Te,t(!(et>>>(Tt=Ae).Xa)),N[Xe]=Tt.X[et],et=!0}et||t(ie.h==B(ie))}if(v.Pb&&ie.h&&Te<z)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&ze(v.s.vb,v.s.Wa);else{if(ie.h)break e;K!=null&&K(v,X>V?V:X),v.a=0,v.$=Te-j}return 1}return v.a=3,0}function Oe(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var N=v.Wa;N!=null&&(N.X=null),v.vb=null,t(v!=null)}function _e(){var v=new Wt;return v==null?null:(v.a=0,v.xb=L4,Ge("Predictor","VP8LPredictors"),Ge("Predictor","VP8LPredictors_C"),Ge("PredictorAdd","VP8LPredictorsAdd"),Ge("PredictorAdd","VP8LPredictorsAdd_C"),pn=Lt,ih=nt,oh=ar,El=Ct,Al=Ot,jl=we,Kc=Je,C.VP8LMapColor32b=Wi,C.VP8LMapColor8b=sh,v)}function Ee(v,N,j,F,z){var V=1,K=[v],X=[N],Z=F.m,ie=F.s,ye=null,Te=0;e:for(;;){if(j)for(;V&&ve(Z,1);){var oe=K,be=X,Se=F,Ie=1,Ae=Se.m,Me=Se.gc[Se.ab],$e=ve(Ae,2);if(Se.Oc&1<<$e)V=0;else{switch(Se.Oc|=1<<$e,Me.hc=$e,Me.Ea=oe[0],Me.nc=be[0],Me.K=[null],++Se.ab,t(4>=Se.ab),$e){case 0:case 1:Me.b=ve(Ae,3)+2,Ie=Ee(qe(Me.Ea,Me.b),qe(Me.nc,Me.b),0,Se,Me.K),Me.K=Me.K[0];break;case 3:var et,Xe=ve(Ae,8)+1,Tt=16<Xe?0:4<Xe?1:2<Xe?2:3;if(oe[0]=qe(Me.Ea,Tt),Me.b=Tt,et=Ie=Ee(Xe,1,0,Se,Me.K)){var vt,rr=Xe,kt=Me,or=1<<(8>>kt.b),Bn=a(or);if(Bn==null)et=0;else{var nr=kt.K[0],_t=kt.w;for(Bn[0]=kt.K[0][0],vt=1;vt<1*rr;++vt)Bn[vt]=ht(nr[_t+vt],Bn[vt-1]);for(;vt<4*or;++vt)Bn[vt]=0;kt.K[0]=null,kt.K[0]=Bn,et=1}}Ie=et;break;case 2:break;default:t(0)}V=Ie}}if(K=K[0],X=X[0],V&&ve(Z,1)&&!(V=1<=(Te=ve(Z,4))&&11>=Te)){F.a=3;break e}var ot;if(ot=V)t:{var gn,Qt,dr,Ur=F,ns=K,Bs=X,an=Te,xs=j,Us=Ur.m,Un=Ur.s,gr=[null],br=1,on=0,Nr=HP[an];r:for(;;){if(xs&&ve(Us,1)){var ss=ve(Us,3)+2,ui=qe(ns,ss),xn=qe(Bs,ss),sa=ui*xn;if(!Ee(ui,xn,0,Ur,gr))break r;for(gr=gr[0],Un.xc=ss,gn=0;gn<sa;++gn){var Pr=gr[gn]>>8&65535;gr[gn]=Pr,Pr>=br&&(br=Pr+1)}}if(Us.h)break r;for(Qt=0;5>Qt;++Qt){var $n=C4[Qt];!Qt&&0<an&&($n+=1<<an),on<$n&&(on=$n)}var wa=i(br*Nr,q),$s=br,ba=i($s,ne);if(ba==null)var Na=null;else t(65536>=$s),Na=ba;var aa=a(on);if(Na==null||aa==null||wa==null){Ur.a=1;break r}var Sa=wa;for(gn=dr=0;gn<br;++gn){var Ir=Na[gn],ka=Ir.G,fi=Ir.H,Yc=0,Io=1,as=0;for(Qt=0;5>Qt;++Qt){$n=C4[Qt],ka[Qt]=Sa,fi[Qt]=dr,!Qt&&0<an&&($n+=1<<an);s:{var sm,c2=$n,am=Ur,dh=aa,uL=Sa,fL=dr,u2=0,Ll=am.m,dL=ve(Ll,1);if(s(dh,0,0,c2),dL){var hL=ve(Ll,1)+1,pL=ve(Ll,1),U4=ve(Ll,pL==0?1:8);dh[U4]=1,hL==2&&(dh[U4=ve(Ll,8)]=1);var im=1}else{var $4=a(19),z4=ve(Ll,4)+4;if(19<z4){am.a=3;var om=0;break s}for(sm=0;sm<z4;++sm)$4[$P[sm]]=ve(Ll,3);var f2=void 0,hh=void 0,H4=am,mL=$4,lm=c2,q4=dh,d2=0,Fl=H4.m,W4=8,V4=i(128,q);n:for(;P(V4,0,7,mL,19);){if(ve(Fl,1)){var gL=2+2*ve(Fl,3);if((f2=2+ve(Fl,gL))>lm)break n}else f2=lm;for(hh=0;hh<lm&&f2--;){se(Fl);var K4=V4[0+(127&I(Fl))];W(Fl,Fl.u+K4.g);var lf=K4.value;if(16>lf)q4[hh++]=lf,lf!=0&&(W4=lf);else{var xL=lf==16,G4=lf-16,vL=BP[G4],Y4=ve(Fl,MP[G4])+vL;if(hh+Y4>lm)break n;for(var yL=xL?W4:0;0<Y4--;)q4[hh++]=yL}}d2=1;break n}d2||(H4.a=3),im=d2}(im=im&&!Ll.h)&&(u2=P(uL,fL,8,dh,c2)),im&&u2!=0?om=u2:(am.a=3,om=0)}if(om==0)break r;if(Io&&UP[Qt]==1&&(Io=Sa[dr].g==0),Yc+=Sa[dr].g,dr+=om,3>=Qt){var ph,h2=aa[0];for(ph=1;ph<$n;++ph)aa[ph]>h2&&(h2=aa[ph]);as+=h2}}if(Ir.nd=Io,Ir.Qb=0,Io&&(Ir.qb=(ka[3][fi[3]+0].value<<24|ka[1][fi[1]+0].value<<16|ka[2][fi[2]+0].value)>>>0,Yc==0&&256>ka[0][fi[0]+0].value&&(Ir.Qb=1,Ir.qb+=ka[0][fi[0]+0].value<<8)),Ir.jc=!Ir.Qb&&6>as,Ir.jc){var cm,Mo=Ir;for(cm=0;cm<Vc;++cm){var Dl=cm,Rl=Mo.pd[Dl],um=Mo.G[0][Mo.H[0]+Dl];256<=um.value?(Rl.g=um.g+256,Rl.value=um.value):(Rl.g=0,Rl.value=0,Dl>>=St(um,8,Rl),Dl>>=St(Mo.G[1][Mo.H[1]+Dl],16,Rl),Dl>>=St(Mo.G[2][Mo.H[2]+Dl],0,Rl),St(Mo.G[3][Mo.H[3]+Dl],24,Rl))}}}Un.vc=gr,Un.Wb=br,Un.Ya=Na,Un.yc=wa,ot=1;break t}ot=0}if(!(V=ot)){F.a=3;break e}if(0<Te){if(ie.ua=1<<Te,!J(ie.Wa,Te)){F.a=1,V=0;break e}}else ie.ua=0;var p2=F,X4=K,wL=X,m2=p2.s,g2=m2.xc;if(p2.c=X4,p2.i=wL,m2.md=qe(X4,g2),m2.wc=g2==0?-1:(1<<g2)-1,j){F.xb=JP;break e}if((ye=a(K*X))==null){F.a=1,V=0;break e}V=(V=ke(F,ye,0,K,X,X,null))&&!Z.h;break e}return V?(z!=null?z[0]=ye:(t(ye==null),t(j)),F.$=0,j||Oe(ie)):Oe(ie),V}function Ce(v,N){var j=v.c*v.i,F=j+N+16*N;return t(v.c<=N),v.V=a(F),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+j+N,1)}function Ze(v,N){var j=v.C,F=N-j,z=v.V,V=v.Ba+v.c*j;for(t(N<=v.l.o);0<F;){var K=16<F?16:F,X=v.l.ma,Z=v.l.width,ie=Z*K,ye=X.ca,Te=X.tb+Z*j,oe=v.Ta,be=v.Ua;ae(v,K,z,V),N4(oe,be,ye,Te,ie),le(X,j,j+K,ye,Te,Z),F-=K,z+=K*v.c,j+=K}t(j==N),v.C=v.Ma=N}function st(){this.ub=this.yd=this.td=this.Rb=0}function ft(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function rt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function lt(){this.Yb=function(){var v=[];return function N(j,F,z){for(var V=z[F],K=0;K<V&&(j.push(z.length>F+1?[]:0),!(z.length<F+1));K++)N(j[K],F+1,z)}(v,0,[3,11]),v}()}function Bt(){this.jb=a(3),this.Wc=o([4,8],lt),this.Xc=o([4,17],lt)}function Ar(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function ir(){this.ld=this.La=this.dd=this.tc=0}function sn(){this.Na=this.la=0}function $i(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ii(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function zi(){this.uc=this.M=this.Nb=0,this.wa=Array(new ir),this.Y=0,this.ya=Array(new ii),this.aa=0,this.l=new Qu}function Ma(){this.y=a(16),this.f=a(8),this.ea=a(8)}function wl(){this.cb=this.a=0,this.sc="",this.m=new _,this.Od=new st,this.Kc=new ft,this.ed=new Ar,this.Qa=new rt,this.Ic=this.$c=this.Aa=0,this.D=new zi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,_),this.ia=0,this.pb=i(4,$i),this.Pa=new Bt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ma),this.Hd=0,this.rb=Array(new sn),this.sb=0,this.wa=Array(new ir),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ii),this.L=this.aa=0,this.gd=o([4,2],ir),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function _n(v,N){return 0>v?0:v>N?N:v}function Qu(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ux(){var v=new wl;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,uh||(uh=Zu)),v}function En(v,N,j){return v.a==0&&(v.a=N,v.sc=j,v.cb=0),0}function Rp(v,N,j){return 3<=j&&v[N+0]==157&&v[N+1]==1&&v[N+2]==42}function Hi(v,N){if(v==null)return 0;if(v.a=0,v.sc="OK",N==null)return En(v,2,"null VP8Io passed to VP8GetHeaders()");var j=N.data,F=N.w,z=N.ha;if(4>z)return En(v,7,"Truncated header.");var V=j[F+0]|j[F+1]<<8|j[F+2]<<16,K=v.Od;if(K.Rb=!(1&V),K.td=V>>1&7,K.yd=V>>4&1,K.ub=V>>5,3<K.td)return En(v,3,"Incorrect keyframe parameters.");if(!K.yd)return En(v,4,"Frame not displayable.");F+=3,z-=3;var X=v.Kc;if(K.Rb){if(7>z)return En(v,7,"cannot parse picture header");if(!Rp(j,F,z))return En(v,3,"Bad code word");X.c=16383&(j[F+4]<<8|j[F+3]),X.Td=j[F+4]>>6,X.i=16383&(j[F+6]<<8|j[F+5]),X.Ud=j[F+6]>>6,F+=7,z-=7,v.za=X.c+15>>4,v.Ub=X.i+15>>4,N.width=X.c,N.height=X.i,N.Da=0,N.j=0,N.v=0,N.va=N.width,N.o=N.height,N.da=0,N.ib=N.width,N.hb=N.height,N.U=N.width,N.T=N.height,s((V=v.Pa).jb,0,255,V.jb.length),t((V=v.Qa)!=null),V.Cb=0,V.Bb=0,V.Fb=1,s(V.Zb,0,0,V.Zb.length),s(V.Lb,0,0,V.Lb)}if(K.ub>z)return En(v,7,"bad partition length");fe(V=v.m,j,F,K.ub),F+=K.ub,z-=K.ub,K.Rb&&(X.Ld=he(V),X.Kd=he(V)),X=v.Qa;var Z,ie=v.Pa;if(t(V!=null),t(X!=null),X.Cb=he(V),X.Cb){if(X.Bb=he(V),he(V)){for(X.Fb=he(V),Z=0;4>Z;++Z)X.Zb[Z]=he(V)?re(V,7):0;for(Z=0;4>Z;++Z)X.Lb[Z]=he(V)?re(V,6):0}if(X.Bb)for(Z=0;3>Z;++Z)ie.jb[Z]=he(V)?me(V,8):255}else X.Bb=0;if(V.Ka)return En(v,3,"cannot parse segment header");if((X=v.ed).zd=he(V),X.Tb=me(V,6),X.wb=me(V,3),X.Pc=he(V),X.Pc&&he(V)){for(ie=0;4>ie;++ie)he(V)&&(X.vd[ie]=re(V,6));for(ie=0;4>ie;++ie)he(V)&&(X.od[ie]=re(V,6))}if(v.L=X.Tb==0?0:X.zd?1:2,V.Ka)return En(v,3,"cannot parse filter header");var ye=z;if(z=Z=F,F=Z+ye,X=ye,v.Xb=(1<<me(v.m,2))-1,ye<3*(ie=v.Xb))j=7;else{for(Z+=3*ie,X-=3*ie,ye=0;ye<ie;++ye){var Te=j[z+0]|j[z+1]<<8|j[z+2]<<16;Te>X&&(Te=X),fe(v.Jc[+ye],j,Z,Te),Z+=Te,X-=Te,z+=3}fe(v.Jc[+ie],j,Z,X),j=Z<F?0:5}if(j!=0)return En(v,j,"cannot parse partitions");for(j=me(Z=v.m,7),z=he(Z)?re(Z,4):0,F=he(Z)?re(Z,4):0,X=he(Z)?re(Z,4):0,ie=he(Z)?re(Z,4):0,Z=he(Z)?re(Z,4):0,ye=v.Qa,Te=0;4>Te;++Te){if(ye.Cb){var oe=ye.Zb[Te];ye.Fb||(oe+=j)}else{if(0<Te){v.pb[Te]=v.pb[0];continue}oe=j}var be=v.pb[Te];be.Sc[0]=i2[_n(oe+z,127)],be.Sc[1]=o2[_n(oe+0,127)],be.Eb[0]=2*i2[_n(oe+F,127)],be.Eb[1]=101581*o2[_n(oe+X,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=i2[_n(oe+ie,117)],be.Qc[1]=o2[_n(oe+Z,127)],be.lc=oe+Z}if(!K.Rb)return En(v,4,"Not a key frame.");for(he(V),K=v.Pa,j=0;4>j;++j){for(z=0;8>z;++z)for(F=0;3>F;++F)for(X=0;11>X;++X)ie=de(V,YP[j][z][F][X])?me(V,8):KP[j][z][F][X],K.Wc[j][z].Yb[F][X]=ie;for(z=0;17>z;++z)K.Xc[j][z]=K.Wc[j][XP[z]]}return v.kc=he(V),v.kc&&(v.Bd=me(V,8)),v.cb=1}function Zu(v,N,j,F,z,V,K){var X=N[z].Yb[j];for(j=0;16>z;++z){if(!de(v,X[j+0]))return z;for(;!de(v,X[j+1]);)if(X=N[++z].Yb[0],j=0,z==16)return 16;var Z=N[z+1].Yb;if(de(v,X[j+2])){var ie=v,ye=0;if(de(ie,(oe=X)[(Te=j)+3]))if(de(ie,oe[Te+6])){for(X=0,Te=2*(ye=de(ie,oe[Te+8]))+(oe=de(ie,oe[Te+9+ye])),ye=0,oe=WP[Te];oe[X];++X)ye+=ye+de(ie,oe[X]);ye+=3+(8<<Te)}else de(ie,oe[Te+7])?(ye=7+2*de(ie,165),ye+=de(ie,145)):ye=5+de(ie,159);else ye=de(ie,oe[Te+4])?3+de(ie,oe[Te+5]):2;X=Z[2]}else ye=1,X=Z[1];Z=K+VP[z],0>(ie=v).b&&pe(ie);var Te,oe=ie.b,be=(Te=ie.Ca>>1)-(ie.I>>oe)>>31;--ie.b,ie.Ca+=be,ie.Ca|=1,ie.I-=(Te+1&be)<<oe,V[Z]=((ye^be)-be)*F[(0<z)+0]}return 16}function Op(v){var N=v.rb[v.sb-1];N.la=0,N.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Ba(v,N,j,F,z){z=v[N+j+32*F]+(z>>3),v[N+j+32*F]=-256&z?0>z?0:255:z}function On(v,N,j,F,z,V){Ba(v,N,0,j,F+z),Ba(v,N,1,j,F+V),Ba(v,N,2,j,F-V),Ba(v,N,3,j,F-z)}function ko(v){return(20091*v>>16)+v}function Ip(v,N,j,F){var z,V=0,K=a(16);for(z=0;4>z;++z){var X=v[N+0]+v[N+8],Z=v[N+0]-v[N+8],ie=(35468*v[N+4]>>16)-ko(v[N+12]),ye=ko(v[N+4])+(35468*v[N+12]>>16);K[V+0]=X+ye,K[V+1]=Z+ie,K[V+2]=Z-ie,K[V+3]=X-ye,V+=4,N++}for(z=V=0;4>z;++z)X=(v=K[V+0]+4)+K[V+8],Z=v-K[V+8],ie=(35468*K[V+4]>>16)-ko(K[V+12]),Ba(j,F,0,0,X+(ye=ko(K[V+4])+(35468*K[V+12]>>16))),Ba(j,F,1,0,Z+ie),Ba(j,F,2,0,Z-ie),Ba(j,F,3,0,X-ye),V++,F+=32}function $x(v,N,j,F){var z=v[N+0]+4,V=35468*v[N+4]>>16,K=ko(v[N+4]),X=35468*v[N+1]>>16;On(j,F,0,z+K,v=ko(v[N+1]),X),On(j,F,1,z+V,v,X),On(j,F,2,z-V,v,X),On(j,F,3,z-K,v,X)}function zx(v,N,j,F,z){Ip(v,N,j,F),z&&Ip(v,N+16,j,F+4)}function qi(v,N,j,F){Gc(v,N+0,j,F,1),Gc(v,N+32,j,F+128,1)}function Mp(v,N,j,F){var z;for(v=v[N+0]+4,z=0;4>z;++z)for(N=0;4>N;++N)Ba(j,F,N,z,v)}function Bp(v,N,j,F){v[N+0]&&yr(v,N+0,j,F),v[N+16]&&yr(v,N+16,j,F+4),v[N+32]&&yr(v,N+32,j,F+128),v[N+48]&&yr(v,N+48,j,F+128+4)}function ef(v,N,j,F){var z,V=a(16);for(z=0;4>z;++z){var K=v[N+0+z]+v[N+12+z],X=v[N+4+z]+v[N+8+z],Z=v[N+4+z]-v[N+8+z],ie=v[N+0+z]-v[N+12+z];V[0+z]=K+X,V[8+z]=K-X,V[4+z]=ie+Z,V[12+z]=ie-Z}for(z=0;4>z;++z)K=(v=V[0+4*z]+3)+V[3+4*z],X=V[1+4*z]+V[2+4*z],Z=V[1+4*z]-V[2+4*z],ie=v-V[3+4*z],j[F+0]=K+X>>3,j[F+16]=ie+Z>>3,j[F+32]=K-X>>3,j[F+48]=ie-Z>>3,F+=64}function Oc(v,N,j){var F,z=N-32,V=ya,K=255-v[z-1];for(F=0;F<j;++F){var X,Z=V,ie=K+v[N-1];for(X=0;X<j;++X)v[N+X]=Z[ie+v[z+X]];N+=32}}function Hx(v,N){Oc(v,N,4)}function qx(v,N){Oc(v,N,8)}function Wx(v,N){Oc(v,N,16)}function qd(v,N){var j;for(j=0;16>j;++j)n(v,N+32*j,v,N-32,16)}function Up(v,N){var j;for(j=16;0<j;--j)s(v,N,v[N-1],16),N+=32}function oi(v,N,j){var F;for(F=0;16>F;++F)s(N,j+32*F,v,16)}function Vx(v,N){var j,F=16;for(j=0;16>j;++j)F+=v[N-1+32*j]+v[N+j-32];oi(F>>5,v,N)}function Ic(v,N){var j,F=8;for(j=0;16>j;++j)F+=v[N-1+32*j];oi(F>>4,v,N)}function Wd(v,N){var j,F=8;for(j=0;16>j;++j)F+=v[N+j-32];oi(F>>4,v,N)}function Kx(v,N){oi(128,v,N)}function Kt(v,N,j){return v+2*N+j+2>>2}function Gx(v,N){var j,F=N-32;for(F=new Uint8Array([Kt(v[F-1],v[F+0],v[F+1]),Kt(v[F+0],v[F+1],v[F+2]),Kt(v[F+1],v[F+2],v[F+3]),Kt(v[F+2],v[F+3],v[F+4])]),j=0;4>j;++j)n(v,N+32*j,F,0,F.length)}function Yx(v,N){var j=v[N-1],F=v[N-1+32],z=v[N-1+64],V=v[N-1+96];je(v,N+0,16843009*Kt(v[N-1-32],j,F)),je(v,N+32,16843009*Kt(j,F,z)),je(v,N+64,16843009*Kt(F,z,V)),je(v,N+96,16843009*Kt(z,V,V))}function Xx(v,N){var j,F=4;for(j=0;4>j;++j)F+=v[N+j-32]+v[N-1+32*j];for(F>>=3,j=0;4>j;++j)s(v,N+32*j,F,4)}function _o(v,N){var j=v[N-1+0],F=v[N-1+32],z=v[N-1+64],V=v[N-1-32],K=v[N+0-32],X=v[N+1-32],Z=v[N+2-32],ie=v[N+3-32];v[N+0+96]=Kt(F,z,v[N-1+96]),v[N+1+96]=v[N+0+64]=Kt(j,F,z),v[N+2+96]=v[N+1+64]=v[N+0+32]=Kt(V,j,F),v[N+3+96]=v[N+2+64]=v[N+1+32]=v[N+0+0]=Kt(K,V,j),v[N+3+64]=v[N+2+32]=v[N+1+0]=Kt(X,K,V),v[N+3+32]=v[N+2+0]=Kt(Z,X,K),v[N+3+0]=Kt(ie,Z,X)}function Eo(v,N){var j=v[N+1-32],F=v[N+2-32],z=v[N+3-32],V=v[N+4-32],K=v[N+5-32],X=v[N+6-32],Z=v[N+7-32];v[N+0+0]=Kt(v[N+0-32],j,F),v[N+1+0]=v[N+0+32]=Kt(j,F,z),v[N+2+0]=v[N+1+32]=v[N+0+64]=Kt(F,z,V),v[N+3+0]=v[N+2+32]=v[N+1+64]=v[N+0+96]=Kt(z,V,K),v[N+3+32]=v[N+2+64]=v[N+1+96]=Kt(V,K,X),v[N+3+64]=v[N+2+96]=Kt(K,X,Z),v[N+3+96]=Kt(X,Z,Z)}function Jx(v,N){var j=v[N-1+0],F=v[N-1+32],z=v[N-1+64],V=v[N-1-32],K=v[N+0-32],X=v[N+1-32],Z=v[N+2-32],ie=v[N+3-32];v[N+0+0]=v[N+1+64]=V+K+1>>1,v[N+1+0]=v[N+2+64]=K+X+1>>1,v[N+2+0]=v[N+3+64]=X+Z+1>>1,v[N+3+0]=Z+ie+1>>1,v[N+0+96]=Kt(z,F,j),v[N+0+64]=Kt(F,j,V),v[N+0+32]=v[N+1+96]=Kt(j,V,K),v[N+1+32]=v[N+2+96]=Kt(V,K,X),v[N+2+32]=v[N+3+96]=Kt(K,X,Z),v[N+3+32]=Kt(X,Z,ie)}function Qx(v,N){var j=v[N+0-32],F=v[N+1-32],z=v[N+2-32],V=v[N+3-32],K=v[N+4-32],X=v[N+5-32],Z=v[N+6-32],ie=v[N+7-32];v[N+0+0]=j+F+1>>1,v[N+1+0]=v[N+0+64]=F+z+1>>1,v[N+2+0]=v[N+1+64]=z+V+1>>1,v[N+3+0]=v[N+2+64]=V+K+1>>1,v[N+0+32]=Kt(j,F,z),v[N+1+32]=v[N+0+96]=Kt(F,z,V),v[N+2+32]=v[N+1+96]=Kt(z,V,K),v[N+3+32]=v[N+2+96]=Kt(V,K,X),v[N+3+64]=Kt(K,X,Z),v[N+3+96]=Kt(X,Z,ie)}function tf(v,N){var j=v[N-1+0],F=v[N-1+32],z=v[N-1+64],V=v[N-1+96];v[N+0+0]=j+F+1>>1,v[N+2+0]=v[N+0+32]=F+z+1>>1,v[N+2+32]=v[N+0+64]=z+V+1>>1,v[N+1+0]=Kt(j,F,z),v[N+3+0]=v[N+1+32]=Kt(F,z,V),v[N+3+32]=v[N+1+64]=Kt(z,V,V),v[N+3+64]=v[N+2+64]=v[N+0+96]=v[N+1+96]=v[N+2+96]=v[N+3+96]=V}function Vd(v,N){var j=v[N-1+0],F=v[N-1+32],z=v[N-1+64],V=v[N-1+96],K=v[N-1-32],X=v[N+0-32],Z=v[N+1-32],ie=v[N+2-32];v[N+0+0]=v[N+2+32]=j+K+1>>1,v[N+0+32]=v[N+2+64]=F+j+1>>1,v[N+0+64]=v[N+2+96]=z+F+1>>1,v[N+0+96]=V+z+1>>1,v[N+3+0]=Kt(X,Z,ie),v[N+2+0]=Kt(K,X,Z),v[N+1+0]=v[N+3+32]=Kt(j,K,X),v[N+1+32]=v[N+3+64]=Kt(F,j,K),v[N+1+64]=v[N+3+96]=Kt(z,F,j),v[N+1+96]=Kt(V,z,F)}function Mc(v,N){var j;for(j=0;8>j;++j)n(v,N+32*j,v,N-32,8)}function Zx(v,N){var j;for(j=0;8>j;++j)s(v,N,v[N-1],8),N+=32}function Ao(v,N,j){var F;for(F=0;8>F;++F)s(N,j+32*F,v,8)}function e2(v,N){var j,F=8;for(j=0;8>j;++j)F+=v[N+j-32]+v[N-1+32*j];Ao(F>>4,v,N)}function Kd(v,N){var j,F=4;for(j=0;8>j;++j)F+=v[N+j-32];Ao(F>>3,v,N)}function Gd(v,N){var j,F=4;for(j=0;8>j;++j)F+=v[N-1+32*j];Ao(F>>3,v,N)}function $p(v,N){Ao(128,v,N)}function jo(v,N,j){var F=v[N-j],z=v[N+0],V=3*(z-F)+t2[1020+v[N-2*j]-v[N+j]],K=Yp[112+(V+4>>3)];v[N-j]=ya[255+F+Yp[112+(V+3>>3)]],v[N+0]=ya[255+z-K]}function Yd(v,N,j,F){var z=v[N+0],V=v[N+j];return za[255+v[N-2*j]-v[N-j]]>F||za[255+V-z]>F}function rf(v,N,j,F){return 4*za[255+v[N-j]-v[N+0]]+za[255+v[N-2*j]-v[N+j]]<=F}function Xd(v,N,j,F,z){var V=v[N-3*j],K=v[N-2*j],X=v[N-j],Z=v[N+0],ie=v[N+j],ye=v[N+2*j],Te=v[N+3*j];return 4*za[255+X-Z]+za[255+K-ie]>F?0:za[255+v[N-4*j]-V]<=z&&za[255+V-K]<=z&&za[255+K-X]<=z&&za[255+Te-ye]<=z&&za[255+ye-ie]<=z&&za[255+ie-Z]<=z}function Bc(v,N,j,F){var z=2*F+1;for(F=0;16>F;++F)rf(v,N+F,j,z)&&jo(v,N+F,j)}function Jd(v,N,j,F){var z=2*F+1;for(F=0;16>F;++F)rf(v,N+F*j,1,z)&&jo(v,N+F*j,1)}function zp(v,N,j,F){var z;for(z=3;0<z;--z)Bc(v,N+=4*j,j,F)}function Hp(v,N,j,F){var z;for(z=3;0<z;--z)Jd(v,N+=4,j,F)}function To(v,N,j,F,z,V,K,X){for(V=2*V+1;0<z--;){if(Xd(v,N,j,V,K))if(Yd(v,N,j,X))jo(v,N,j);else{var Z=v,ie=N,ye=j,Te=Z[ie-2*ye],oe=Z[ie-ye],be=Z[ie+0],Se=Z[ie+ye],Ie=Z[ie+2*ye],Ae=27*($e=t2[1020+3*(be-oe)+t2[1020+Te-Se]])+63>>7,Me=18*$e+63>>7,$e=9*$e+63>>7;Z[ie-3*ye]=ya[255+Z[ie-3*ye]+$e],Z[ie-2*ye]=ya[255+Te+Me],Z[ie-ye]=ya[255+oe+Ae],Z[ie+0]=ya[255+be-Ae],Z[ie+ye]=ya[255+Se-Me],Z[ie+2*ye]=ya[255+Ie-$e]}N+=F}}function Co(v,N,j,F,z,V,K,X){for(V=2*V+1;0<z--;){if(Xd(v,N,j,V,K))if(Yd(v,N,j,X))jo(v,N,j);else{var Z=v,ie=N,ye=j,Te=Z[ie-ye],oe=Z[ie+0],be=Z[ie+ye],Se=Yp[112+(4+(Ie=3*(oe-Te))>>3)],Ie=Yp[112+(Ie+3>>3)],Ae=Se+1>>1;Z[ie-2*ye]=ya[255+Z[ie-2*ye]+Ae],Z[ie-ye]=ya[255+Te+Ie],Z[ie+0]=ya[255+oe-Se],Z[ie+ye]=ya[255+be-Ae]}N+=F}}function qp(v,N,j,F,z,V){To(v,N,j,1,16,F,z,V)}function Uc(v,N,j,F,z,V){To(v,N,1,j,16,F,z,V)}function Wp(v,N,j,F,z,V){var K;for(K=3;0<K;--K)Co(v,N+=4*j,j,1,16,F,z,V)}function k(v,N,j,F,z,V){var K;for(K=3;0<K;--K)Co(v,N+=4,1,j,16,F,z,V)}function U(v,N,j,F,z,V,K,X){To(v,N,z,1,8,V,K,X),To(j,F,z,1,8,V,K,X)}function ce(v,N,j,F,z,V,K,X){To(v,N,1,z,8,V,K,X),To(j,F,1,z,8,V,K,X)}function xe(v,N,j,F,z,V,K,X){Co(v,N+4*z,z,1,8,V,K,X),Co(j,F+4*z,z,1,8,V,K,X)}function Ne(v,N,j,F,z,V,K,X){Co(v,N+4,1,z,8,V,K,X),Co(j,F+4,1,z,8,V,K,X)}function Ue(){this.ba=new Qe,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new yt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ye(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Nt(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function At(){this.ua=0,this.Wa=new He,this.vb=new He,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ne,this.yc=new q}function Wt(){this.xb=this.a=0,this.l=new Qu,this.ca=new Qe,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new R,this.Pb=0,this.wd=new R,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new At,this.ab=0,this.gc=i(4,Nt),this.Oc=0}function Zt(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Qu,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function mr(v,N,j,F,z,V,K){for(v=v==null?0:v[N+0],N=0;N<K;++N)z[V+N]=v+j[F+N]&255,v=z[V+N]}function Zr(v,N,j,F,z,V,K){var X;if(v==null)mr(null,null,j,F,z,V,K);else for(X=0;X<K;++X)z[V+X]=v[N+X]+j[F+X]&255}function An(v,N,j,F,z,V,K){if(v==null)mr(null,null,j,F,z,V,K);else{var X,Z=v[N+0],ie=Z,ye=Z;for(X=0;X<K;++X)ie=ye+(Z=v[N+X])-ie,ye=j[F+X]+(-256&ie?0>ie?0:255:ie)&255,ie=Z,z[V+X]=ye}}function Or(v,N,j,F){var z=N.width,V=N.o;if(t(v!=null&&N!=null),0>j||0>=F||j+F>V)return null;if(!v.Cc){if(v.ga==null){var K;if(v.ga=new Zt,(K=v.ga==null)||(K=N.width*N.o,t(v.Gb.length==0),v.Gb=a(K),v.Uc=0,v.Gb==null?K=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,K=1),K=!K),!K){K=v.ga;var X=v.Fa,Z=v.P,ie=v.qc,ye=v.mb,Te=v.nb,oe=Z+1,be=ie-1,Se=K.l;if(t(X!=null&&ye!=null&&N!=null),Pl[0]=null,Pl[1]=mr,Pl[2]=Zr,Pl[3]=An,K.ca=ye,K.tb=Te,K.c=N.width,K.i=N.height,t(0<K.c&&0<K.i),1>=ie)N=0;else if(K.$a=3&X[Z+0],K.Z=X[Z+0]>>2&3,K.Lc=X[Z+0]>>4&3,Z=X[Z+0]>>6&3,0>K.$a||1<K.$a||4<=K.Z||1<K.Lc||Z)N=0;else if(Se.put=ut,Se.ac=Qr,Se.bc=gs,Se.ma=K,Se.width=N.width,Se.height=N.height,Se.Da=N.Da,Se.v=N.v,Se.va=N.va,Se.j=N.j,Se.o=N.o,K.$a)e:{t(K.$a==1),N=_e();t:for(;;){if(N==null){N=0;break e}if(t(K!=null),K.mc=N,N.c=K.c,N.i=K.i,N.l=K.l,N.l.ma=K,N.l.width=K.c,N.l.height=K.i,N.a=0,G(N.m,X,oe,be),!Ee(K.c,K.i,1,N,null)||(N.ab==1&&N.gc[0].hc==3&&te(N.s)?(K.ic=1,X=N.c*N.i,N.Ta=null,N.Ua=0,N.V=a(X),N.Ba=0,N.V==null?(N.a=1,N=0):N=1):(K.ic=0,N=Ce(N,K.c)),!N))break t;N=1;break e}K.mc=null,N=0}else N=be>=K.c*K.i;K=!N}if(K)return null;v.ga.Lc!=1?v.Ga=0:F=V-j}t(v.ga!=null),t(j+F<=V);e:{if(N=(X=v.ga).c,V=X.l.o,X.$a==0){if(oe=v.rc,be=v.Vc,Se=v.Fa,Z=v.P+1+j*N,ie=v.mb,ye=v.nb+j*N,t(Z<=v.P+v.qc),X.Z!=0)for(t(Pl[X.Z]!=null),K=0;K<F;++K)Pl[X.Z](oe,be,Se,Z,ie,ye,N),oe=ie,be=ye,ye+=N,Z+=N;else for(K=0;K<F;++K)n(ie,ye,Se,Z,N),oe=ie,be=ye,ye+=N,Z+=N;v.rc=oe,v.Vc=be}else{if(t(X.mc!=null),N=j+F,t((K=X.mc)!=null),t(N<=K.i),K.C>=N)N=1;else if(X.ic||li(),X.ic){X=K.V,oe=K.Ba,be=K.c;var Ie=K.i,Ae=(Se=1,Z=K.$/be,ie=K.$%be,ye=K.m,Te=K.s,K.$),Me=be*Ie,$e=be*N,et=Te.wc,Xe=Ae<$e?H(Te,ie,Z):null;t(Ae<=Me),t(N<=Ie),t(te(Te));t:for(;;){for(;!ye.h&&Ae<$e;){if(ie&et||(Xe=H(Te,ie,Z)),t(Xe!=null),se(ye),256>(Ie=fr(Xe.G[0],Xe.H[0],ye)))X[oe+Ae]=Ie,++Ae,++ie>=be&&(ie=0,++Z<=N&&!(Z%16)&&ue(K,Z));else{if(!(280>Ie)){Se=0;break t}Ie=Rr(Ie-256,ye);var Tt,vt=fr(Xe.G[4],Xe.H[4],ye);if(se(ye),!(Ae>=(vt=Kr(be,vt=Rr(vt,ye)))&&Me-Ae>=Ie)){Se=0;break t}for(Tt=0;Tt<Ie;++Tt)X[oe+Ae+Tt]=X[oe+Ae+Tt-vt];for(Ae+=Ie,ie+=Ie;ie>=be;)ie-=be,++Z<=N&&!(Z%16)&&ue(K,Z);Ae<$e&&ie&et&&(Xe=H(Te,ie,Z))}t(ye.h==B(ye))}ue(K,Z>N?N:Z);break t}!Se||ye.h&&Ae<Me?(Se=0,K.a=ye.h?5:3):K.$=Ae,N=Se}else N=ke(K,K.V,K.Ba,K.c,K.i,N,Ze);if(!N){F=0;break e}}j+F>=V&&(v.Cc=1),F=1}if(!F)return null;if(v.Cc&&((F=v.ga)!=null&&(F.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+j*z}function In(v,N,j,F,z,V){for(;0<z--;){var K,X=v,Z=N+(j?1:0),ie=v,ye=N+(j?0:3);for(K=0;K<F;++K){var Te=ie[ye+4*K];Te!=255&&(Te*=32897,X[Z+4*K+0]=X[Z+4*K+0]*Te>>23,X[Z+4*K+1]=X[Z+4*K+1]*Te>>23,X[Z+4*K+2]=X[Z+4*K+2]*Te>>23)}N+=V}}function jn(v,N,j,F,z){for(;0<F--;){var V;for(V=0;V<j;++V){var K=v[N+2*V+0],X=15&(ie=v[N+2*V+1]),Z=4369*X,ie=(240&ie|ie>>4)*Z>>16;v[N+2*V+0]=(240&K|K>>4)*Z>>16&240|(15&K|K<<4)*Z>>16>>4&15,v[N+2*V+1]=240&ie|X}N+=z}}function ts(v,N,j,F,z,V,K,X){var Z,ie,ye=255;for(ie=0;ie<z;++ie){for(Z=0;Z<F;++Z){var Te=v[N+Z];V[K+4*Z]=Te,ye&=Te}N+=j,K+=X}return ye!=255}function Po(v,N,j,F,z){var V;for(V=0;V<z;++V)j[F+V]=v[N+V]>>8}function li(){ch=In,w4=jn,b4=ts,N4=Po}function Lo(v,N,j){C[v]=function(F,z,V,K,X,Z,ie,ye,Te,oe,be,Se,Ie,Ae,Me,$e,et){var Xe,Tt=et-1>>1,vt=X[Z+0]|ie[ye+0]<<16,rr=Te[oe+0]|be[Se+0]<<16;t(F!=null);var kt=3*vt+rr+131074>>2;for(N(F[z+0],255&kt,kt>>16,Ie,Ae),V!=null&&(kt=3*rr+vt+131074>>2,N(V[K+0],255&kt,kt>>16,Me,$e)),Xe=1;Xe<=Tt;++Xe){var or=X[Z+Xe]|ie[ye+Xe]<<16,Bn=Te[oe+Xe]|be[Se+Xe]<<16,nr=vt+or+rr+Bn+524296,_t=nr+2*(or+rr)>>3;kt=_t+vt>>1,vt=(nr=nr+2*(vt+Bn)>>3)+or>>1,N(F[z+2*Xe-1],255&kt,kt>>16,Ie,Ae+(2*Xe-1)*j),N(F[z+2*Xe-0],255&vt,vt>>16,Ie,Ae+(2*Xe-0)*j),V!=null&&(kt=nr+rr>>1,vt=_t+Bn>>1,N(V[K+2*Xe-1],255&kt,kt>>16,Me,$e+(2*Xe-1)*j),N(V[K+2*Xe+0],255&vt,vt>>16,Me,$e+(2*Xe+0)*j)),vt=or,rr=Bn}1&et||(kt=3*vt+rr+131074>>2,N(F[z+et-1],255&kt,kt>>16,Ie,Ae+(et-1)*j),V!=null&&(kt=3*rr+vt+131074>>2,N(V[K+et-1],255&kt,kt>>16,Me,$e+(et-1)*j)))}}function Qd(){Ha[Xp]=QP,Ha[Jp]=F4,Ha[j4]=ZP,Ha[Qp]=D4,Ha[Zp]=R4,Ha[r2]=O4,Ha[T4]=eL,Ha[n2]=F4,Ha[s2]=D4,Ha[em]=R4,Ha[a2]=O4}function nf(v){return v&-16384?0>v?0:255:v>>tL}function bl(v,N){return nf((19077*v>>8)+(26149*N>>8)-14234)}function $c(v,N,j){return nf((19077*v>>8)-(6419*N>>8)-(13320*j>>8)+8708)}function zc(v,N){return nf((19077*v>>8)+(33050*N>>8)-17685)}function Nl(v,N,j,F,z){F[z+0]=bl(v,j),F[z+1]=$c(v,N,j),F[z+2]=zc(v,N)}function rs(v,N,j,F,z){F[z+0]=zc(v,N),F[z+1]=$c(v,N,j),F[z+2]=bl(v,j)}function Hc(v,N,j,F,z){var V=$c(v,N,j);N=V<<3&224|zc(v,N)>>3,F[z+0]=248&bl(v,j)|V>>5,F[z+1]=N}function qc(v,N,j,F,z){var V=240&zc(v,N)|15;F[z+0]=240&bl(v,j)|$c(v,N,j)>>4,F[z+1]=V}function Zd(v,N,j,F,z){F[z+0]=255,Nl(v,N,j,F,z+1)}function eh(v,N,j,F,z){rs(v,N,j,F,z),F[z+3]=255}function Ms(v,N,j,F,z){Nl(v,N,j,F,z),F[z+3]=255}function Fo(v,N,j){C[v]=function(F,z,V,K,X,Z,ie,ye,Te){for(var oe=ye+(-2&Te)*j;ye!=oe;)N(F[z+0],V[K+0],X[Z+0],ie,ye),N(F[z+1],V[K+0],X[Z+0],ie,ye+j),z+=2,++K,++Z,ye+=2*j;1&Te&&N(F[z+0],V[K+0],X[Z+0],ie,ye)}}function sf(v,N,j){return j==0?v==0?N==0?6:5:N==0?4:0:j}function Vp(v,N,j,F,z){switch(v>>>30){case 3:Gc(N,j,F,z,0);break;case 2:$a(N,j,F,z);break;case 1:yr(N,j,F,z)}}function Ua(v,N){var j,F,z=N.M,V=N.Nb,K=v.oc,X=v.pc+40,Z=v.oc,ie=v.pc+584,ye=v.oc,Te=v.pc+600;for(j=0;16>j;++j)K[X+32*j-1]=129;for(j=0;8>j;++j)Z[ie+32*j-1]=129,ye[Te+32*j-1]=129;for(0<z?K[X-1-32]=Z[ie-1-32]=ye[Te-1-32]=129:(s(K,X-32-1,127,21),s(Z,ie-32-1,127,9),s(ye,Te-32-1,127,9)),F=0;F<v.za;++F){var oe=N.ya[N.aa+F];if(0<F){for(j=-1;16>j;++j)n(K,X+32*j-4,K,X+32*j+12,4);for(j=-1;8>j;++j)n(Z,ie+32*j-4,Z,ie+32*j+4,4),n(ye,Te+32*j-4,ye,Te+32*j+4,4)}var be=v.Gd,Se=v.Hd+F,Ie=oe.ad,Ae=oe.Hc;if(0<z&&(n(K,X-32,be[Se].y,0,16),n(Z,ie-32,be[Se].f,0,8),n(ye,Te-32,be[Se].ea,0,8)),oe.Za){var Me=K,$e=X-32+16;for(0<z&&(F>=v.za-1?s(Me,$e,be[Se].y[15],4):n(Me,$e,be[Se+1].y,0,4)),j=0;4>j;j++)Me[$e+128+j]=Me[$e+256+j]=Me[$e+384+j]=Me[$e+0+j];for(j=0;16>j;++j,Ae<<=2)Me=K,$e=X+M4[j],ci[oe.Ob[j]](Me,$e),Vp(Ae,Ie,16*+j,Me,$e)}else if(Me=sf(F,z,oe.Ob[0]),Cl[Me](K,X),Ae!=0)for(j=0;16>j;++j,Ae<<=2)Vp(Ae,Ie,16*+j,K,X+M4[j]);for(j=oe.Gc,Me=sf(F,z,oe.Dd),Oo[Me](Z,ie),Oo[Me](ye,Te),Ae=Ie,Me=Z,$e=ie,255&(oe=0|j)&&(170&oe?Ki(Ae,256,Me,$e):Cr(Ae,256,Me,$e)),oe=ye,Ae=Te,255&(j>>=8)&&(170&j?Ki(Ie,320,oe,Ae):Cr(Ie,320,oe,Ae)),z<v.Ub-1&&(n(be[Se].y,0,K,X+480,16),n(be[Se].f,0,Z,ie+224,8),n(be[Se].ea,0,ye,Te+224,8)),j=8*V*v.B,be=v.sa,Se=v.ta+16*F+16*V*v.R,Ie=v.qa,oe=v.ra+8*F+j,Ae=v.Ha,Me=v.Ia+8*F+j,j=0;16>j;++j)n(be,Se+j*v.R,K,X+32*j,16);for(j=0;8>j;++j)n(Ie,oe+j*v.B,Z,ie+32*j,8),n(Ae,Me+j*v.B,ye,Te+32*j,8)}}function Wc(v,N,j,F,z,V,K,X,Z){var ie=[0],ye=[0],Te=0,oe=Z!=null?Z.kd:0,be=Z??new Ye;if(v==null||12>j)return 7;be.data=v,be.w=N,be.ha=j,N=[N],j=[j],be.gb=[be.gb];e:{var Se=N,Ie=j,Ae=be.gb;if(t(v!=null),t(Ie!=null),t(Ae!=null),Ae[0]=0,12<=Ie[0]&&!r(v,Se[0],"RIFF")){if(r(v,Se[0]+8,"WEBP")){Ae=3;break e}var Me=Ke(v,Se[0]+4);if(12>Me||4294967286<Me){Ae=3;break e}if(oe&&Me>Ie[0]-8){Ae=7;break e}Ae[0]=Me,Se[0]+=12,Ie[0]-=12}Ae=0}if(Ae!=0)return Ae;for(Me=0<be.gb[0],j=j[0];;){e:{var $e=v;Ie=N,Ae=j;var et=ie,Xe=ye,Tt=Se=[0];if((kt=Te=[Te])[0]=0,8>Ae[0])Ae=7;else{if(!r($e,Ie[0],"VP8X")){if(Ke($e,Ie[0]+4)!=10){Ae=3;break e}if(18>Ae[0]){Ae=7;break e}var vt=Ke($e,Ie[0]+8),rr=1+We($e,Ie[0]+12);if(2147483648<=rr*($e=1+We($e,Ie[0]+15))){Ae=3;break e}Tt!=null&&(Tt[0]=vt),et!=null&&(et[0]=rr),Xe!=null&&(Xe[0]=$e),Ie[0]+=18,Ae[0]-=18,kt[0]=1}Ae=0}}if(Te=Te[0],Se=Se[0],Ae!=0)return Ae;if(Ie=!!(2&Se),!Me&&Te)return 3;if(V!=null&&(V[0]=!!(16&Se)),K!=null&&(K[0]=Ie),X!=null&&(X[0]=0),K=ie[0],Se=ye[0],Te&&Ie&&Z==null){Ae=0;break}if(4>j){Ae=7;break}if(Me&&Te||!Me&&!Te&&!r(v,N[0],"ALPH")){j=[j],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{vt=v,Ae=N,Me=j;var kt=be.gb;et=be.na,Xe=be.P,Tt=be.Sa,rr=22,t(vt!=null),t(Me!=null),$e=Ae[0];var or=Me[0];for(t(et!=null),t(Tt!=null),et[0]=null,Xe[0]=null,Tt[0]=0;;){if(Ae[0]=$e,Me[0]=or,8>or){Ae=7;break e}var Bn=Ke(vt,$e+4);if(4294967286<Bn){Ae=3;break e}var nr=8+Bn+1&-2;if(rr+=nr,0<kt&&rr>kt){Ae=3;break e}if(!r(vt,$e,"VP8 ")||!r(vt,$e,"VP8L")){Ae=0;break e}if(or[0]<nr){Ae=7;break e}r(vt,$e,"ALPH")||(et[0]=vt,Xe[0]=$e+8,Tt[0]=Bn),$e+=nr,or-=nr}}if(j=j[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],Ae!=0)break}j=[j],be.Ja=[be.Ja],be.xa=[be.xa];e:if(kt=v,Ae=N,Me=j,et=be.gb[0],Xe=be.Ja,Tt=be.xa,vt=Ae[0],$e=!r(kt,vt,"VP8 "),rr=!r(kt,vt,"VP8L"),t(kt!=null),t(Me!=null),t(Xe!=null),t(Tt!=null),8>Me[0])Ae=7;else{if($e||rr){if(kt=Ke(kt,vt+4),12<=et&&kt>et-12){Ae=3;break e}if(oe&&kt>Me[0]-8){Ae=7;break e}Xe[0]=kt,Ae[0]+=8,Me[0]-=8,Tt[0]=rr}else Tt[0]=5<=Me[0]&&kt[vt+0]==47&&!(kt[vt+4]>>5),Xe[0]=Me[0];Ae=0}if(j=j[0],be.Ja=be.Ja[0],be.xa=be.xa[0],N=N[0],Ae!=0)break;if(4294967286<be.Ja)return 3;if(X==null||Ie||(X[0]=be.xa?2:1),K=[K],Se=[Se],be.xa){if(5>j){Ae=7;break}X=K,oe=Se,Ie=V,v==null||5>j?v=0:5<=j&&v[N+0]==47&&!(v[N+4]>>5)?(Me=[0],kt=[0],et=[0],G(Xe=new R,v,N,j),Vr(Xe,Me,kt,et)?(X!=null&&(X[0]=Me[0]),oe!=null&&(oe[0]=kt[0]),Ie!=null&&(Ie[0]=et[0]),v=1):v=0):v=0}else{if(10>j){Ae=7;break}X=Se,v==null||10>j||!Rp(v,N+3,j-3)?v=0:(oe=v[N+0]|v[N+1]<<8|v[N+2]<<16,Ie=16383&(v[N+7]<<8|v[N+6]),v=16383&(v[N+9]<<8|v[N+8]),1&oe||3<(oe>>1&7)||!(oe>>4&1)||oe>>5>=be.Ja||!Ie||!v?v=0:(K&&(K[0]=Ie),X&&(X[0]=v),v=1))}if(!v||(K=K[0],Se=Se[0],Te&&(ie[0]!=K||ye[0]!=Se)))return 3;Z!=null&&(Z[0]=be,Z.offset=N-Z.w,t(4294967286>N-Z.w),t(Z.offset==Z.ha-j));break}return Ae==0||Ae==7&&Te&&Z==null?(V!=null&&(V[0]|=be.na!=null&&0<be.na.length),F!=null&&(F[0]=K),z!=null&&(z[0]=Se),0):Ae}function th(v,N,j){var F=N.width,z=N.height,V=0,K=0,X=F,Z=z;if(N.Da=v!=null&&0<v.Da,N.Da&&(X=v.cd,Z=v.bd,V=v.v,K=v.j,11>j||(V&=-2,K&=-2),0>V||0>K||0>=X||0>=Z||V+X>F||K+Z>z))return 0;if(N.v=V,N.j=K,N.va=V+X,N.o=K+Z,N.U=X,N.T=Z,N.da=v!=null&&0<v.da,N.da){if(!it(X,Z,j=[v.ib],V=[v.hb]))return 0;N.ib=j[0],N.hb=V[0]}return N.ob=v!=null&&v.ob,N.Kb=v==null||!v.Sd,N.da&&(N.ob=N.ib<3*F/4&&N.hb<3*z/4,N.Kb=0),1}function rh(v){if(v==null)return 2;if(11>v.S){var N=v.f.RGBA;N.fb+=(v.height-1)*N.A,N.A=-N.A}else N=v.f.kb,v=v.height,N.O+=(v-1)*N.fa,N.fa=-N.fa,N.N+=(v-1>>1)*N.Ab,N.Ab=-N.Ab,N.W+=(v-1>>1)*N.Db,N.Db=-N.Db,N.F!=null&&(N.J+=(v-1)*N.lb,N.lb=-N.lb);return 0}function Sl(v,N,j,F){if(F==null||0>=v||0>=N)return 2;if(j!=null){if(j.Da){var z=j.cd,V=j.bd,K=-2&j.v,X=-2&j.j;if(0>K||0>X||0>=z||0>=V||K+z>v||X+V>N)return 2;v=z,N=V}if(j.da){if(!it(v,N,z=[j.ib],V=[j.hb]))return 2;v=z[0],N=V[0]}}F.width=v,F.height=N;e:{var Z=F.width,ie=F.height;if(v=F.S,0>=Z||0>=ie||!(v>=Xp&&13>v))v=2;else{if(0>=F.Rd&&F.sd==null){K=V=z=N=0;var ye=(X=Z*B4[v])*ie;if(11>v||(V=(ie+1)/2*(N=(Z+1)/2),v==12&&(K=(z=Z)*ie)),(ie=a(ye+2*V+K))==null){v=1;break e}F.sd=ie,11>v?((Z=F.f.RGBA).eb=ie,Z.fb=0,Z.A=X,Z.size=ye):((Z=F.f.kb).y=ie,Z.O=0,Z.fa=X,Z.Fd=ye,Z.f=ie,Z.N=0+ye,Z.Ab=N,Z.Cd=V,Z.ea=ie,Z.W=0+ye+V,Z.Db=N,Z.Ed=V,v==12&&(Z.F=ie,Z.J=0+ye+2*V),Z.Tc=K,Z.lb=z)}if(N=1,z=F.S,V=F.width,K=F.height,z>=Xp&&13>z)if(11>z)v=F.f.RGBA,N&=(X=Math.abs(v.A))*(K-1)+V<=v.size,N&=X>=V*B4[z],N&=v.eb!=null;else{v=F.f.kb,X=(V+1)/2,ye=(K+1)/2,Z=Math.abs(v.fa),ie=Math.abs(v.Ab);var Te=Math.abs(v.Db),oe=Math.abs(v.lb),be=oe*(K-1)+V;N&=Z*(K-1)+V<=v.Fd,N&=ie*(ye-1)+X<=v.Cd,N=(N&=Te*(ye-1)+X<=v.Ed)&Z>=V&ie>=X&Te>=X,N&=v.y!=null,N&=v.f!=null,N&=v.ea!=null,z==12&&(N&=oe>=V,N&=be<=v.Tc,N&=v.F!=null)}else N=0;v=N?0:2}}return v!=0||j!=null&&j.fd&&(v=rh(F)),v}var Vc=64,xa=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],va=24,kl=32,Do=8,_l=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ct("Predictor0","PredictorAdd0"),C.Predictor0=function(){return 4278190080},C.Predictor1=function(v){return v},C.Predictor2=function(v,N,j){return N[j+0]},C.Predictor3=function(v,N,j){return N[j+1]},C.Predictor4=function(v,N,j){return N[j-1]},C.Predictor5=function(v,N,j){return xt(xt(v,N[j+1]),N[j+0])},C.Predictor6=function(v,N,j){return xt(v,N[j-1])},C.Predictor7=function(v,N,j){return xt(v,N[j+0])},C.Predictor8=function(v,N,j){return xt(N[j-1],N[j+0])},C.Predictor9=function(v,N,j){return xt(N[j+0],N[j+1])},C.Predictor10=function(v,N,j){return xt(xt(v,N[j-1]),xt(N[j+0],N[j+1]))},C.Predictor11=function(v,N,j){var F=N[j+0];return 0>=Ft(F>>24&255,v>>24&255,(N=N[j-1])>>24&255)+Ft(F>>16&255,v>>16&255,N>>16&255)+Ft(F>>8&255,v>>8&255,N>>8&255)+Ft(255&F,255&v,255&N)?F:v},C.Predictor12=function(v,N,j){var F=N[j+0];return(Ht((v>>24&255)+(F>>24&255)-((N=N[j-1])>>24&255))<<24|Ht((v>>16&255)+(F>>16&255)-(N>>16&255))<<16|Ht((v>>8&255)+(F>>8&255)-(N>>8&255))<<8|Ht((255&v)+(255&F)-(255&N)))>>>0},C.Predictor13=function(v,N,j){var F=N[j-1];return(Mt((v=xt(v,N[j+0]))>>24&255,F>>24&255)<<24|Mt(v>>16&255,F>>16&255)<<16|Mt(v>>8&255,F>>8&255)<<8|Mt(255&v,255&F))>>>0};var nh=C.PredictorAdd0;C.PredictorAdd1=Yt,ct("Predictor2","PredictorAdd2"),ct("Predictor3","PredictorAdd3"),ct("Predictor4","PredictorAdd4"),ct("Predictor5","PredictorAdd5"),ct("Predictor6","PredictorAdd6"),ct("Predictor7","PredictorAdd7"),ct("Predictor8","PredictorAdd8"),ct("Predictor9","PredictorAdd9"),ct("Predictor10","PredictorAdd10"),ct("Predictor11","PredictorAdd11"),ct("Predictor12","PredictorAdd12"),ct("Predictor13","PredictorAdd13");var af=C.PredictorAdd2;at("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),at("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var pn,Kp=C.ColorIndexInverseTransform,Wi=C.MapARGB,Vi=C.VP8LColorIndexInverseTransformAlpha,sh=C.MapAlpha,ah=C.VP8LPredictorsAdd=[];ah.length=16,(C.VP8LPredictors=[]).length=16,(C.VP8LPredictorsAdd_C=[]).length=16,(C.VP8LPredictors_C=[]).length=16;var ih,oh,El,Al,jl,Kc,Tl,Gc,$a,Ki,yr,Cr,mn,Mn,Ro,lh,of,Gp,p4,m4,g4,x4,v4,y4,ch,w4,b4,N4,S4=a(511),k4=a(2041),_4=a(225),E4=a(767),A4=0,t2=k4,Yp=_4,ya=E4,za=S4,Xp=0,Jp=1,j4=2,Qp=3,Zp=4,r2=5,T4=6,n2=7,s2=8,em=9,a2=10,MP=[2,3,7],BP=[3,3,11],C4=[280,256,256,256,40],UP=[0,1,1,1,0],$P=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],zP=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],HP=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],qP=8,i2=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],o2=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],uh=null,WP=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],VP=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],P4=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],KP=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],GP=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],YP=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],XP=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Cl=[],ci=[],Oo=[],JP=1,L4=2,Pl=[],Ha=[];Lo("UpsampleRgbLinePair",Nl,3),Lo("UpsampleBgrLinePair",rs,3),Lo("UpsampleRgbaLinePair",Ms,4),Lo("UpsampleBgraLinePair",eh,4),Lo("UpsampleArgbLinePair",Zd,4),Lo("UpsampleRgba4444LinePair",qc,2),Lo("UpsampleRgb565LinePair",Hc,2);var QP=C.UpsampleRgbLinePair,ZP=C.UpsampleBgrLinePair,F4=C.UpsampleRgbaLinePair,D4=C.UpsampleBgraLinePair,R4=C.UpsampleArgbLinePair,O4=C.UpsampleRgba4444LinePair,eL=C.UpsampleRgb565LinePair,tm=16,rm=1<<tm-1,fh=-227,l2=482,tL=6,I4=0,rL=a(256),nL=a(256),sL=a(256),aL=a(256),iL=a(l2-fh),oL=a(l2-fh);Fo("YuvToRgbRow",Nl,3),Fo("YuvToBgrRow",rs,3),Fo("YuvToRgbaRow",Ms,4),Fo("YuvToBgraRow",eh,4),Fo("YuvToArgbRow",Zd,4),Fo("YuvToRgba4444Row",qc,2),Fo("YuvToRgb565Row",Hc,2);var M4=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],nm=[0,2,8],lL=[8,7,6,4,4,2,2,2,1,1,1,1],cL=1;this.WebPDecodeRGBA=function(v,N,j,F,z){var V=Jp,K=new Ue,X=new Qe;K.ba=X,X.S=V,X.width=[X.width],X.height=[X.height];var Z=X.width,ie=X.height,ye=new Ve;if(ye==null||v==null)var Te=2;else t(ye!=null),Te=Wc(v,N,j,ye.width,ye.height,ye.Pd,ye.Qd,ye.format,null);if(Te!=0?Z=0:(Z!=null&&(Z[0]=ye.width[0]),ie!=null&&(ie[0]=ye.height[0]),Z=1),Z){X.width=X.width[0],X.height=X.height[0],F!=null&&(F[0]=X.width),z!=null&&(z[0]=X.height);e:{if(F=new Qu,(z=new Ye).data=v,z.w=N,z.ha=j,z.kd=1,N=[0],t(z!=null),((v=Wc(z.data,z.w,z.ha,null,null,null,N,null,z))==0||v==7)&&N[0]&&(v=4),(N=v)==0){if(t(K!=null),F.data=z.data,F.w=z.w+z.offset,F.ha=z.ha-z.offset,F.put=ut,F.ac=Qr,F.bc=gs,F.ma=K,z.xa){if((v=_e())==null){K=1;break e}if(function(oe,be){var Se=[0],Ie=[0],Ae=[0];t:for(;;){if(oe==null)return 0;if(be==null)return oe.a=2,0;if(oe.l=be,oe.a=0,G(oe.m,be.data,be.w,be.ha),!Vr(oe.m,Se,Ie,Ae)){oe.a=3;break t}if(oe.xb=L4,be.width=Se[0],be.height=Ie[0],!Ee(Se[0],Ie[0],1,oe,null))break t;return 1}return t(oe.a!=0),0}(v,F)){if(F=(N=Sl(F.width,F.height,K.Oa,K.ba))==0){t:{F=v;r:for(;;){if(F==null){F=0;break t}if(t(F.s.yc!=null),t(F.s.Ya!=null),t(0<F.s.Wb),t((j=F.l)!=null),t((z=j.ma)!=null),F.xb!=0){if(F.ca=z.ba,F.tb=z.tb,t(F.ca!=null),!th(z.Oa,j,Qp)){F.a=2;break r}if(!Ce(F,j.width)||j.da)break r;if((j.da||Re(F.ca.S))&&li(),11>F.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),F.ca.f.kb.F!=null&&li()),F.Pb&&0<F.s.ua&&F.s.vb.X==null&&!J(F.s.vb,F.s.Wa.Xa)){F.a=1;break r}F.xb=0}if(!ke(F,F.V,F.Ba,F.c,F.i,j.o,Q))break r;z.Dc=F.Ma,F=1;break t}t(F.a!=0),F=0}F=!F}F&&(N=v.a)}else N=v.a}else{if((v=new Ux)==null){K=1;break e}if(v.Fa=z.na,v.P=z.P,v.qc=z.Sa,Hi(v,F)){if((N=Sl(F.width,F.height,K.Oa,K.ba))==0){if(v.Aa=0,j=K.Oa,t((z=v)!=null),j!=null){if(0<(Z=0>(Z=j.Md)?0:100<Z?255:255*Z/100)){for(ie=ye=0;4>ie;++ie)12>(Te=z.pb[ie]).lc&&(Te.ia=Z*lL[0>Te.lc?0:Te.lc]>>3),ye|=Te.ia;ye&&(alert("todo:VP8InitRandom"),z.ia=1)}z.Ga=j.Id,100<z.Ga?z.Ga=100:0>z.Ga&&(z.Ga=0)}(function(oe,be){if(oe==null)return 0;if(be==null)return En(oe,2,"NULL VP8Io parameter in VP8Decode().");if(!oe.cb&&!Hi(oe,be))return 0;if(t(oe.cb),be.ac==null||be.ac(be)){be.ob&&(oe.L=0);var Se=nm[oe.L];if(oe.L==2?(oe.yb=0,oe.zb=0):(oe.yb=be.v-Se>>4,oe.zb=be.j-Se>>4,0>oe.yb&&(oe.yb=0),0>oe.zb&&(oe.zb=0)),oe.Va=be.o+15+Se>>4,oe.Hb=be.va+15+Se>>4,oe.Hb>oe.za&&(oe.Hb=oe.za),oe.Va>oe.Ub&&(oe.Va=oe.Ub),0<oe.L){var Ie=oe.ed;for(Se=0;4>Se;++Se){var Ae;if(oe.Qa.Cb){var Me=oe.Qa.Lb[Se];oe.Qa.Fb||(Me+=Ie.Tb)}else Me=Ie.Tb;for(Ae=0;1>=Ae;++Ae){var $e=oe.gd[Se][Ae],et=Me;if(Ie.Pc&&(et+=Ie.vd[0],Ae&&(et+=Ie.od[0])),0<(et=0>et?0:63<et?63:et)){var Xe=et;0<Ie.wb&&(Xe=4<Ie.wb?Xe>>2:Xe>>1)>9-Ie.wb&&(Xe=9-Ie.wb),1>Xe&&(Xe=1),$e.dd=Xe,$e.tc=2*et+Xe,$e.ld=40<=et?2:15<=et?1:0}else $e.tc=0;$e.La=Ae}}}Se=0}else En(oe,6,"Frame setup failed"),Se=oe.a;if(Se=Se==0){if(Se){oe.$c=0,0<oe.Aa||(oe.Ic=cL);t:{Se=oe.Ic,Ie=4*(Xe=oe.za);var Tt=32*Xe,vt=Xe+1,rr=0<oe.L?Xe*(0<oe.Aa?2:1):0,kt=(oe.Aa==2?2:1)*Xe;if(($e=Ie+832+(Ae=3*(16*Se+nm[oe.L])/2*Tt)+(Me=oe.Fa!=null&&0<oe.Fa.length?oe.Kc.c*oe.Kc.i:0))!=$e)Se=0;else{if($e>oe.Vb){if(oe.Vb=0,oe.Ec=a($e),oe.Fc=0,oe.Ec==null){Se=En(oe,1,"no memory during frame initialization.");break t}oe.Vb=$e}$e=oe.Ec,et=oe.Fc,oe.Ac=$e,oe.Bc=et,et+=Ie,oe.Gd=i(Tt,Ma),oe.Hd=0,oe.rb=i(vt+1,sn),oe.sb=1,oe.wa=rr?i(rr,ir):null,oe.Y=0,oe.D.Nb=0,oe.D.wa=oe.wa,oe.D.Y=oe.Y,0<oe.Aa&&(oe.D.Y+=Xe),t(!0),oe.oc=$e,oe.pc=et,et+=832,oe.ya=i(kt,ii),oe.aa=0,oe.D.ya=oe.ya,oe.D.aa=oe.aa,oe.Aa==2&&(oe.D.aa+=Xe),oe.R=16*Xe,oe.B=8*Xe,Xe=(Tt=nm[oe.L])*oe.R,Tt=Tt/2*oe.B,oe.sa=$e,oe.ta=et+Xe,oe.qa=oe.sa,oe.ra=oe.ta+16*Se*oe.R+Tt,oe.Ha=oe.qa,oe.Ia=oe.ra+8*Se*oe.B+Tt,oe.$c=0,et+=Ae,oe.mb=Me?$e:null,oe.nb=Me?et:null,t(et+Me<=oe.Fc+oe.Vb),Op(oe),s(oe.Ac,oe.Bc,0,Ie),Se=1}}if(Se){if(be.ka=0,be.y=oe.sa,be.O=oe.ta,be.f=oe.qa,be.N=oe.ra,be.ea=oe.Ha,be.Vd=oe.Ia,be.fa=oe.R,be.Rc=oe.B,be.F=null,be.J=0,!A4){for(Se=-255;255>=Se;++Se)S4[255+Se]=0>Se?-Se:Se;for(Se=-1020;1020>=Se;++Se)k4[1020+Se]=-128>Se?-128:127<Se?127:Se;for(Se=-112;112>=Se;++Se)_4[112+Se]=-16>Se?-16:15<Se?15:Se;for(Se=-255;510>=Se;++Se)E4[255+Se]=0>Se?0:255<Se?255:Se;A4=1}Tl=ef,Gc=zx,Ki=qi,yr=Mp,Cr=Bp,$a=$x,mn=qp,Mn=Uc,Ro=U,lh=ce,of=Wp,Gp=k,p4=xe,m4=Ne,g4=Bc,x4=Jd,v4=zp,y4=Hp,ci[0]=Xx,ci[1]=Hx,ci[2]=Gx,ci[3]=Yx,ci[4]=_o,ci[5]=Jx,ci[6]=Eo,ci[7]=Qx,ci[8]=Vd,ci[9]=tf,Cl[0]=Vx,Cl[1]=Wx,Cl[2]=qd,Cl[3]=Up,Cl[4]=Ic,Cl[5]=Wd,Cl[6]=Kx,Oo[0]=e2,Oo[1]=qx,Oo[2]=Mc,Oo[3]=Zx,Oo[4]=Gd,Oo[5]=Kd,Oo[6]=$p,Se=1}else Se=0}Se&&(Se=function(or,Bn){for(or.M=0;or.M<or.Va;++or.M){var nr,_t=or.Jc[or.M&or.Xb],ot=or.m,gn=or;for(nr=0;nr<gn.za;++nr){var Qt=ot,dr=gn,Ur=dr.Ac,ns=dr.Bc+4*nr,Bs=dr.zc,an=dr.ya[dr.aa+nr];if(dr.Qa.Bb?an.$b=de(Qt,dr.Pa.jb[0])?2+de(Qt,dr.Pa.jb[2]):de(Qt,dr.Pa.jb[1]):an.$b=0,dr.kc&&(an.Ad=de(Qt,dr.Bd)),an.Za=!de(Qt,145)+0,an.Za){var xs=an.Ob,Us=0;for(dr=0;4>dr;++dr){var Un,gr=Bs[0+dr];for(Un=0;4>Un;++Un){gr=GP[Ur[ns+Un]][gr];for(var br=P4[de(Qt,gr[0])];0<br;)br=P4[2*br+de(Qt,gr[br])];gr=-br,Ur[ns+Un]=gr}n(xs,Us,Ur,ns,4),Us+=4,Bs[0+dr]=gr}}else gr=de(Qt,156)?de(Qt,128)?1:3:de(Qt,163)?2:0,an.Ob[0]=gr,s(Ur,ns,gr,4),s(Bs,0,gr,4);an.Dd=de(Qt,142)?de(Qt,114)?de(Qt,183)?1:3:2:0}if(gn.m.Ka)return En(or,7,"Premature end-of-partition0 encountered.");for(;or.ja<or.za;++or.ja){if(gn=_t,Qt=(ot=or).rb[ot.sb-1],Ur=ot.rb[ot.sb+ot.ja],nr=ot.ya[ot.aa+ot.ja],ns=ot.kc?nr.Ad:0)Qt.la=Ur.la=0,nr.Za||(Qt.Na=Ur.Na=0),nr.Hc=0,nr.Gc=0,nr.ia=0;else{var on,Nr;if(Qt=Ur,Ur=gn,ns=ot.Pa.Xc,Bs=ot.ya[ot.aa+ot.ja],an=ot.pb[Bs.$b],dr=Bs.ad,xs=0,Us=ot.rb[ot.sb-1],gr=Un=0,s(dr,xs,0,384),Bs.Za)var ss=0,ui=ns[3];else{br=a(16);var xn=Qt.Na+Us.Na;if(xn=uh(Ur,ns[1],xn,an.Eb,0,br,0),Qt.Na=Us.Na=(0<xn)+0,1<xn)Tl(br,0,dr,xs);else{var sa=br[0]+3>>3;for(br=0;256>br;br+=16)dr[xs+br]=sa}ss=1,ui=ns[0]}var Pr=15&Qt.la,$n=15&Us.la;for(br=0;4>br;++br){var wa=1&$n;for(sa=Nr=0;4>sa;++sa)Pr=Pr>>1|(wa=(xn=uh(Ur,ui,xn=wa+(1&Pr),an.Sc,ss,dr,xs))>ss)<<7,Nr=Nr<<2|(3<xn?3:1<xn?2:dr[xs+0]!=0),xs+=16;Pr>>=4,$n=$n>>1|wa<<7,Un=(Un<<8|Nr)>>>0}for(ui=Pr,ss=$n>>4,on=0;4>on;on+=2){for(Nr=0,Pr=Qt.la>>4+on,$n=Us.la>>4+on,br=0;2>br;++br){for(wa=1&$n,sa=0;2>sa;++sa)xn=wa+(1&Pr),Pr=Pr>>1|(wa=0<(xn=uh(Ur,ns[2],xn,an.Qc,0,dr,xs)))<<3,Nr=Nr<<2|(3<xn?3:1<xn?2:dr[xs+0]!=0),xs+=16;Pr>>=2,$n=$n>>1|wa<<5}gr|=Nr<<4*on,ui|=Pr<<4<<on,ss|=(240&$n)<<on}Qt.la=ui,Us.la=ss,Bs.Hc=Un,Bs.Gc=gr,Bs.ia=43690&gr?0:an.ia,ns=!(Un|gr)}if(0<ot.L&&(ot.wa[ot.Y+ot.ja]=ot.gd[nr.$b][nr.Za],ot.wa[ot.Y+ot.ja].La|=!ns),gn.Ka)return En(or,7,"Premature end-of-file encountered.")}if(Op(or),ot=Bn,gn=1,nr=(_t=or).D,Qt=0<_t.L&&_t.M>=_t.zb&&_t.M<=_t.Va,_t.Aa==0)t:{if(nr.M=_t.M,nr.uc=Qt,Ua(_t,nr),gn=1,nr=(Nr=_t.D).Nb,Qt=(gr=nm[_t.L])*_t.R,Ur=gr/2*_t.B,br=16*nr*_t.R,sa=8*nr*_t.B,ns=_t.sa,Bs=_t.ta-Qt+br,an=_t.qa,dr=_t.ra-Ur+sa,xs=_t.Ha,Us=_t.Ia-Ur+sa,$n=(Pr=Nr.M)==0,Un=Pr>=_t.Va-1,_t.Aa==2&&Ua(_t,Nr),Nr.uc)for(wa=(xn=_t).D.M,t(xn.D.uc),Nr=xn.yb;Nr<xn.Hb;++Nr){ss=Nr,ui=wa;var $s=(ba=(as=xn).D).Nb;on=as.R;var ba=ba.wa[ba.Y+ss],Na=as.sa,aa=as.ta+16*$s*on+16*ss,Sa=ba.dd,Ir=ba.tc;if(Ir!=0)if(t(3<=Ir),as.L==1)0<ss&&x4(Na,aa,on,Ir+4),ba.La&&y4(Na,aa,on,Ir),0<ui&&g4(Na,aa,on,Ir+4),ba.La&&v4(Na,aa,on,Ir);else{var ka=as.B,fi=as.qa,Yc=as.ra+8*$s*ka+8*ss,Io=as.Ha,as=as.Ia+8*$s*ka+8*ss;$s=ba.ld,0<ss&&(Mn(Na,aa,on,Ir+4,Sa,$s),lh(fi,Yc,Io,as,ka,Ir+4,Sa,$s)),ba.La&&(Gp(Na,aa,on,Ir,Sa,$s),m4(fi,Yc,Io,as,ka,Ir,Sa,$s)),0<ui&&(mn(Na,aa,on,Ir+4,Sa,$s),Ro(fi,Yc,Io,as,ka,Ir+4,Sa,$s)),ba.La&&(of(Na,aa,on,Ir,Sa,$s),p4(fi,Yc,Io,as,ka,Ir,Sa,$s))}}if(_t.ia&&alert("todo:DitherRow"),ot.put!=null){if(Nr=16*Pr,Pr=16*(Pr+1),$n?(ot.y=_t.sa,ot.O=_t.ta+br,ot.f=_t.qa,ot.N=_t.ra+sa,ot.ea=_t.Ha,ot.W=_t.Ia+sa):(Nr-=gr,ot.y=ns,ot.O=Bs,ot.f=an,ot.N=dr,ot.ea=xs,ot.W=Us),Un||(Pr-=gr),Pr>ot.o&&(Pr=ot.o),ot.F=null,ot.J=null,_t.Fa!=null&&0<_t.Fa.length&&Nr<Pr&&(ot.J=Or(_t,ot,Nr,Pr-Nr),ot.F=_t.mb,ot.F==null&&ot.F.length==0)){gn=En(_t,3,"Could not decode alpha data.");break t}Nr<ot.j&&(gr=ot.j-Nr,Nr=ot.j,t(!(1&gr)),ot.O+=_t.R*gr,ot.N+=_t.B*(gr>>1),ot.W+=_t.B*(gr>>1),ot.F!=null&&(ot.J+=ot.width*gr)),Nr<Pr&&(ot.O+=ot.v,ot.N+=ot.v>>1,ot.W+=ot.v>>1,ot.F!=null&&(ot.J+=ot.v),ot.ka=Nr-ot.j,ot.U=ot.va-ot.v,ot.T=Pr-Nr,gn=ot.put(ot))}nr+1!=_t.Ic||Un||(n(_t.sa,_t.ta-Qt,ns,Bs+16*_t.R,Qt),n(_t.qa,_t.ra-Ur,an,dr+8*_t.B,Ur),n(_t.Ha,_t.Ia-Ur,xs,Us+8*_t.B,Ur))}if(!gn)return En(or,6,"Output aborted.")}return 1}(oe,be)),be.bc!=null&&be.bc(be),Se&=1}return Se?(oe.cb=0,Se):0})(v,F)||(N=v.a)}}else N=v.a}N==0&&K.Oa!=null&&K.Oa.fd&&(N=rh(K.ba))}K=N}V=K!=0?null:11>V?X.f.RGBA.eb:X.f.kb.y}else V=null;return V};var B4=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(C,O){for(var E="",P=0;P<4;P++)E+=String.fromCharCode(C[O++]);return E}function f(C,O){return C[O+0]|C[O+1]<<8}function h(C,O){return(C[O+0]|C[O+1]<<8|C[O+2]<<16)>>>0}function p(C,O){return(C[O+0]|C[O+1]<<8|C[O+2]<<16|C[O+3]<<24)>>>0}new l;var d=[0],m=[0],g=[],w=new l,x=e,y=function(C,O){var E={},P=0,q=!1,M=0,ne=0;if(E.frames=[],!function(_,R){for(var I=0;I<4;I++)if(_[R+I]!="RIFF".charCodeAt(I))return!0;return!1}(C,O)){for(p(C,O+=4),O+=8;O<C.length;){var fe=u(C,O),me=p(C,O+=4);O+=4;var re=me+(1&me);switch(fe){case"VP8 ":case"VP8L":E.frames[P]===void 0&&(E.frames[P]={}),(ve=E.frames[P]).src_off=q?ne:O-8,ve.src_size=M+me+8,P++,q&&(q=!1,M=0,ne=0);break;case"VP8X":(ve=E.header={}).feature_flags=C[O];var G=O+4;ve.canvas_width=1+h(C,G),G+=3,ve.canvas_height=1+h(C,G),G+=3;break;case"ALPH":q=!0,M=re+8,ne=O-8;break;case"ANIM":(ve=E.header).bgcolor=p(C,O),G=O+4,ve.loop_count=f(C,G),G+=2;break;case"ANMF":var ge,ve;(ve=E.frames[P]={}).offset_x=2*h(C,O),O+=3,ve.offset_y=2*h(C,O),O+=3,ve.width=1+h(C,O),O+=3,ve.height=1+h(C,O),O+=3,ve.duration=h(C,O),O+=3,ge=C[O++],ve.dispose=1&ge,ve.blend=ge>>1&1}fe!="ANMF"&&(O+=re)}return E}}(x,0);y.response=x,y.rgbaoutput=!0,y.dataurl=!1;var b=y.header?y.header:null,S=y.frames?y.frames:null;if(b){b.loop_counter=b.loop_count,d=[b.canvas_height],m=[b.canvas_width];for(var T=0;T<S.length&&S[T].blend!=0;T++);}var L=S[0],A=w.WebPDecodeRGBA(x,L.src_off,L.src_size,m,d);L.rgba=A,L.imgwidth=m[0],L.imgheight=d[0];for(var D=0;D<m[0]*d[0]*4;D++)g[D]=A[D];return this.width=m,this.height=d,this.data=g,this}(function(e){var t,r,n,s,a,i,o,l,u,f=function(_){return _=_||{},this.isStrokeTransparent=_.isStrokeTransparent||!1,this.strokeOpacity=_.strokeOpacity||1,this.strokeStyle=_.strokeStyle||"#000000",this.fillStyle=_.fillStyle||"#000000",this.isFillTransparent=_.isFillTransparent||!1,this.fillOpacity=_.fillOpacity||1,this.font=_.font||"10px sans-serif",this.textBaseline=_.textBaseline||"alphabetic",this.textAlign=_.textAlign||"left",this.lineWidth=_.lineWidth||1,this.lineJoin=_.lineJoin||"miter",this.lineCap=_.lineCap||"butt",this.path=_.path||[],this.transform=_.transform!==void 0?_.transform.clone():new l,this.globalCompositeOperation=_.globalCompositeOperation||"normal",this.globalAlpha=_.globalAlpha||1,this.clip_path=_.clip_path||[],this.currentPoint=_.currentPoint||new i,this.miterLimit=_.miterLimit||10,this.lastPoint=_.lastPoint||new i,this.lineDashOffset=_.lineDashOffset||0,this.lineDash=_.lineDash||[],this.margin=_.margin||[0,0,0,0],this.prevPageLastElemOffset=_.prevPageLastElemOffset||0,this.ignoreClearRect=typeof _.ignoreClearRect!="boolean"||_.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,u=new f}]);var h=function(_){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var R=_;Object.defineProperty(this,"pdf",{get:function(){return R}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(J){I=!!J}});var B=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return B},set:function(J){B=!!J}});var W=0;Object.defineProperty(this,"posX",{get:function(){return W},set:function(J){isNaN(J)||(W=J)}});var se=0;Object.defineProperty(this,"posY",{get:function(){return se},set:function(J){isNaN(J)||(se=J)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(J){var ze;typeof J=="number"?ze=[J,J,J,J]:((ze=new Array(4))[0]=J[0],ze[1]=J.length>=2?J[1]:ze[0],ze[2]=J.length>=3?J[2]:ze[0],ze[3]=J.length>=4?J[3]:ze[1]),u.margin=ze}});var pe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return pe},set:function(J){pe=J}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(J){he=J}});var de=[];Object.defineProperty(this,"pageBreaks",{get:function(){return de},set:function(J){de=J}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(J){J instanceof f&&(u=J)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(J){u.path=J}});var je=[];Object.defineProperty(this,"ctxStack",{get:function(){return je},set:function(J){je=J}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(J){var ze;ze=p(J),this.ctx.fillStyle=ze.style,this.ctx.isFillTransparent=ze.a===0,this.ctx.fillOpacity=ze.a,this.pdf.setFillColor(ze.r,ze.g,ze.b,{a:ze.a}),this.pdf.setTextColor(ze.r,ze.g,ze.b,{a:ze.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(J){var ze=p(J);this.ctx.strokeStyle=ze.style,this.ctx.isStrokeTransparent=ze.a===0,this.ctx.strokeOpacity=ze.a,ze.a===0?this.pdf.setDrawColor(255,255,255):(ze.a,this.pdf.setDrawColor(ze.r,ze.g,ze.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(J){["butt","round","square"].indexOf(J)!==-1&&(this.ctx.lineCap=J,this.pdf.setLineCap(J))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(J){isNaN(J)||(this.ctx.lineWidth=J,this.pdf.setLineWidth(J))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(J){["bevel","round","miter"].indexOf(J)!==-1&&(this.ctx.lineJoin=J,this.pdf.setLineJoin(J))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(J){isNaN(J)||(this.ctx.miterLimit=J,this.pdf.setMiterLimit(J))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(J){this.ctx.textBaseline=J}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(J){["right","end","center","left","start"].indexOf(J)!==-1&&(this.ctx.textAlign=J)}});var Y=null,We=null,Ke=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ke},set:function(J){Y=null,We=null,Ke=J}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(J){var ze;if(this.ctx.font=J,(ze=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(J))!==null){var He=ze[1];ze[2];var it=ze[3],qe=ze[4];ze[5];var ht=ze[6],ct=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(qe)[2];qe=Math.floor(ct==="px"?parseFloat(qe)*this.pdf.internal.scaleFactor:ct==="em"?parseFloat(qe)*this.pdf.getFontSize():parseFloat(qe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(qe);var Et=function(at){var ar,Ct,Ot=[],we=at.trim();if(we==="")return Mv;if(we in F_)return[F_[we]];for(;we!=="";){switch(Ct=null,ar=(we=R_(we)).charAt(0)){case'"':case"'":Ct=KZ(we.substring(1),ar);break;default:Ct=GZ(we)}if(Ct===null||(Ot.push(Ct[0]),(we=R_(Ct[1]))!==""&&we.charAt(0)!==","))return Mv;we=we.replace(/^,/,"")}return Ot}(ht);if(this.fontFaces){var xt=function(at,ar){var Ct=at.getFontList(),Ot=JSON.stringify(Ct);if(Y===null||We!==Ot){var we=function(Je){var De=[];return Object.keys(Je).forEach(function(Ge){Je[Ge].forEach(function(Re){var Pe=null;switch(Re){case"bold":Pe={family:Ge,weight:"bold"};break;case"italic":Pe={family:Ge,style:"italic"};break;case"bolditalic":Pe={family:Ge,weight:"bold",style:"italic"};break;case"":case"normal":Pe={family:Ge}}Pe!==null&&(Pe.ref={name:Ge,style:Re},De.push(Pe))})}),De}(Ct);Y=function(Je){for(var De={},Ge=0;Ge<Je.length;++Ge){var Re=Iv(Je[Ge]),Pe=Re.family,bt=Re.stretch,Qe=Re.style,Ve=Re.weight;De[Pe]=De[Pe]||{},De[Pe][bt]=De[Pe][bt]||{},De[Pe][bt][Qe]=De[Pe][bt][Qe]||{},De[Pe][bt][Qe][Ve]=Re}return De}(we.concat(ar)),We=Ot}return Y}(this.pdf,this.fontFaces),Ht=Et.map(function(at){return{family:at,stretch:"normal",weight:it,style:He}}),Mt=function(at,ar,Ct){for(var Ot=(Ct=Ct||{}).defaultFontFamily||"times",we=Object.assign({},VZ,Ct.genericFontFamilies||{}),Je=null,De=null,Ge=0;Ge<ar.length;++Ge)if(we[(Je=Iv(ar[Ge])).family]&&(Je.family=we[Je.family]),at.hasOwnProperty(Je.family)){De=at[Je.family];break}if(!(De=De||at[Ot]))throw new Error("Could not find a font-family for the rule '"+D_(Je)+"' and default family '"+Ot+"'.");if(De=function(Re,Pe){if(Pe[Re])return Pe[Re];var bt=t5[Re],Qe=bt<=t5.normal?-1:1,Ve=L_(Pe,gP,bt,Qe);if(!Ve)throw new Error("Could not find a matching font-stretch value for "+Re);return Ve}(Je.stretch,De),De=function(Re,Pe){if(Pe[Re])return Pe[Re];for(var bt=mP[Re],Qe=0;Qe<bt.length;++Qe)if(Pe[bt[Qe]])return Pe[bt[Qe]];throw new Error("Could not find a matching font-style for "+Re)}(Je.style,De),!(De=function(Re,Pe){if(Pe[Re])return Pe[Re];if(Re===400&&Pe[500])return Pe[500];if(Re===500&&Pe[400])return Pe[400];var bt=WZ[Re],Qe=L_(Pe,xP,bt,Re<400?-1:1);if(!Qe)throw new Error("Could not find a matching font-weight for value "+Re);return Qe}(Je.weight,De)))throw new Error("Failed to resolve a font for the rule '"+D_(Je)+"'.");return De}(xt,Ht);this.pdf.setFont(Mt.ref.name,Mt.ref.style)}else{var Ft="";(it==="bold"||parseInt(it,10)>=700||He==="bold")&&(Ft="bold"),He==="italic"&&(Ft+="italic"),Ft.length===0&&(Ft="normal");for(var Yt="",Lt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},pt=0;pt<Et.length;pt++){if(this.pdf.internal.getFont(Et[pt],Ft,{noFallback:!0,disableWarning:!0})!==void 0){Yt=Et[pt];break}if(Ft==="bolditalic"&&this.pdf.internal.getFont(Et[pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Yt=Et[pt],Ft="bold";else if(this.pdf.internal.getFont(Et[pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Yt=Et[pt],Ft="normal";break}}if(Yt===""){for(var nt=0;nt<Et.length;nt++)if(Lt[Et[nt]]){Yt=Lt[Et[nt]];break}}Yt=Yt===""?"Times":Yt,this.pdf.setFont(Yt,Ft)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(J){this.ctx.globalCompositeOperation=J}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(J){this.ctx.globalAlpha=J}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(J){this.ctx.lineDashOffset=J,ve.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(J){this.ctx.lineDash=J,ve.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(J){this.ctx.ignoreClearRect=!!J}})};h.prototype.setLineDash=function(_){this.lineDash=_},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){S.call(this,"fill",!1)},h.prototype.stroke=function(){S.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(_,R){if(isNaN(_)||isNaN(R))throw Fr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new i(_,R));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(_,R)},h.prototype.closePath=function(){var _=new i(0,0),R=0;for(R=this.path.length-1;R!==-1;R--)if(this.path[R].type==="begin"&&_r(this.path[R+1])==="object"&&typeof this.path[R+1].x=="number"){_=new i(this.path[R+1].x,this.path[R+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(_.x,_.y)},h.prototype.lineTo=function(_,R){if(isNaN(_)||isNaN(R))throw Fr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new i(_,R));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(I.x,I.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),S.call(this,null,!0)},h.prototype.quadraticCurveTo=function(_,R,I,B){if(isNaN(I)||isNaN(B)||isNaN(_)||isNaN(R))throw Fr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var W=this.ctx.transform.applyToPoint(new i(I,B)),se=this.ctx.transform.applyToPoint(new i(_,R));this.path.push({type:"qct",x1:se.x,y1:se.y,x:W.x,y:W.y}),this.ctx.lastPoint=new i(W.x,W.y)},h.prototype.bezierCurveTo=function(_,R,I,B,W,se){if(isNaN(W)||isNaN(se)||isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B))throw Fr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var pe=this.ctx.transform.applyToPoint(new i(W,se)),he=this.ctx.transform.applyToPoint(new i(_,R)),de=this.ctx.transform.applyToPoint(new i(I,B));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:de.x,y2:de.y,x:pe.x,y:pe.y}),this.ctx.lastPoint=new i(pe.x,pe.y)},h.prototype.arc=function(_,R,I,B,W,se){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B)||isNaN(W))throw Fr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(se=!!se,!this.ctx.transform.isIdentity){var pe=this.ctx.transform.applyToPoint(new i(_,R));_=pe.x,R=pe.y;var he=this.ctx.transform.applyToPoint(new i(0,I)),de=this.ctx.transform.applyToPoint(new i(0,0));I=Math.sqrt(Math.pow(he.x-de.x,2)+Math.pow(he.y-de.y,2))}Math.abs(W-B)>=2*Math.PI&&(B=0,W=2*Math.PI),this.path.push({type:"arc",x:_,y:R,radius:I,startAngle:B,endAngle:W,counterclockwise:se})},h.prototype.arcTo=function(_,R,I,B,W){throw new Error("arcTo not implemented.")},h.prototype.rect=function(_,R,I,B){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B))throw Fr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(_,R),this.lineTo(_+I,R),this.lineTo(_+I,R+B),this.lineTo(_,R+B),this.lineTo(_,R),this.lineTo(_+I,R),this.lineTo(_,R)},h.prototype.fillRect=function(_,R,I,B){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B))throw Fr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var W={};this.lineCap!=="butt"&&(W.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(W.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(_,R,I,B),this.fill(),W.hasOwnProperty("lineCap")&&(this.lineCap=W.lineCap),W.hasOwnProperty("lineJoin")&&(this.lineJoin=W.lineJoin)}},h.prototype.strokeRect=function(_,R,I,B){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B))throw Fr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");m.call(this)||(this.beginPath(),this.rect(_,R,I,B),this.stroke())},h.prototype.clearRect=function(_,R,I,B){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B))throw Fr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(_,R,I,B))},h.prototype.save=function(_){_=typeof _!="boolean"||_;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(R),_){this.ctx.fontSize=this.pdf.internal.getFontSize();var B=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=B}},h.prototype.restore=function(_){_=typeof _!="boolean"||_;for(var R=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(R),_&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(_){var R,I,B,W;if(_.isCanvasGradient===!0&&(_=_.getColor()),!_)return{r:0,g:0,b:0,a:0,style:_};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(_))R=0,I=0,B=0,W=0;else{var se=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(_);if(se!==null)R=parseInt(se[1]),I=parseInt(se[2]),B=parseInt(se[3]),W=1;else if((se=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(_))!==null)R=parseInt(se[1]),I=parseInt(se[2]),B=parseInt(se[3]),W=parseFloat(se[4]);else{if(W=1,typeof _=="string"&&_.charAt(0)!=="#"){var pe=new lP(_);_=pe.ok?pe.toHex():"#000000"}_.length===4?(R=_.substring(1,2),R+=R,I=_.substring(2,3),I+=I,B=_.substring(3,4),B+=B):(R=_.substring(1,3),I=_.substring(3,5),B=_.substring(5,7)),R=parseInt(R,16),I=parseInt(I,16),B=parseInt(B,16)}}return{r:R,g:I,b:B,a:W,style:_}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},m=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(_,R,I,B){if(isNaN(R)||isNaN(I)||typeof _!="string")throw Fr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(B=isNaN(B)?void 0:B,!d.call(this)){var W=re(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;P.call(this,{text:_,x:R,y:I,scale:se,angle:W,align:this.textAlign,maxWidth:B})}},h.prototype.strokeText=function(_,R,I,B){if(isNaN(R)||isNaN(I)||typeof _!="string")throw Fr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!m.call(this)){B=isNaN(B)?void 0:B;var W=re(this.ctx.transform.rotation),se=this.ctx.transform.scaleX;P.call(this,{text:_,x:R,y:I,scale:se,renderingMode:"stroke",angle:W,align:this.textAlign,maxWidth:B})}},h.prototype.measureText=function(_){if(typeof _!="string")throw Fr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var R=this.pdf,I=this.pdf.internal.scaleFactor,B=R.internal.getFontSize(),W=R.getStringUnitWidth(_)*B/R.internal.scaleFactor;return new function(se){var pe=(se=se||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return pe}}),this}({width:W*=Math.round(96*I/72*1e4)/1e4})},h.prototype.scale=function(_,R){if(isNaN(_)||isNaN(R))throw Fr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new l(_,0,0,R,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},h.prototype.rotate=function(_){if(isNaN(_))throw Fr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var R=new l(Math.cos(_),Math.sin(_),-Math.sin(_),Math.cos(_),0,0);this.ctx.transform=this.ctx.transform.multiply(R)},h.prototype.translate=function(_,R){if(isNaN(_)||isNaN(R))throw Fr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new l(1,0,0,1,_,R);this.ctx.transform=this.ctx.transform.multiply(I)},h.prototype.transform=function(_,R,I,B,W,se){if(isNaN(_)||isNaN(R)||isNaN(I)||isNaN(B)||isNaN(W)||isNaN(se))throw Fr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var pe=new l(_,R,I,B,W,se);this.ctx.transform=this.ctx.transform.multiply(pe)},h.prototype.setTransform=function(_,R,I,B,W,se){_=isNaN(_)?1:_,R=isNaN(R)?0:R,I=isNaN(I)?0:I,B=isNaN(B)?1:B,W=isNaN(W)?0:W,se=isNaN(se)?0:se,this.ctx.transform=new l(_,R,I,B,W,se)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(_,R,I,B,W,se,pe,he,de){var je=this.pdf.getImageProperties(_),Y=1,We=1,Ke=1,J=1;B!==void 0&&he!==void 0&&(Ke=he/B,J=de/W,Y=je.width/B*he/B,We=je.height/W*de/W),se===void 0&&(se=R,pe=I,R=0,I=0),B!==void 0&&he===void 0&&(he=B,de=W),B===void 0&&he===void 0&&(he=je.width,de=je.height);var ze=this.ctx.transform.decompose(),He=re(ze.rotate.shx),it=new l,qe=(it=(it=(it=it.multiply(ze.translate)).multiply(ze.skew)).multiply(ze.scale)).applyToRectangle(new o(se-R*Ke,pe-I*J,B*Y,W*We));if(this.autoPaging){for(var ht,ct=w.call(this,qe),Et=[],xt=0;xt<ct.length;xt+=1)Et.indexOf(ct[xt])===-1&&Et.push(ct[xt]);b(Et);for(var Ht=Et[0],Mt=Et[Et.length-1],Ft=Ht;Ft<Mt+1;Ft++){this.pdf.setPage(Ft);var Yt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Lt=Ft===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],at=Ft===1?0:pt+(Ft-2)*nt;if(this.ctx.clip_path.length!==0){var ar=this.path;ht=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(ht,this.posX+this.margin[3],-at+Lt+this.ctx.prevPageLastElemOffset),T.call(this,"fill",!0),this.path=ar}var Ct=JSON.parse(JSON.stringify(qe));Ct=y([Ct],this.posX+this.margin[3],-at+Lt+this.ctx.prevPageLastElemOffset)[0];var Ot=(Ft>Ht||Ft<Mt)&&g.call(this);Ot&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Yt,nt,null).clip().discardPath()),this.pdf.addImage(_,"JPEG",Ct.x,Ct.y,Ct.w,Ct.h,null,null,He),Ot&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(_,"JPEG",qe.x,qe.y,qe.w,qe.h,null,null,He)};var w=function(_,R,I){var B=[];R=R||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var W=this.posY+this.ctx.prevPageLastElemOffset;switch(_.type){default:case"mt":case"lt":B.push(Math.floor((_.y+W)/I)+1);break;case"arc":B.push(Math.floor((_.y+W-_.radius)/I)+1),B.push(Math.floor((_.y+W+_.radius)/I)+1);break;case"qct":var se=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x,_.y);B.push(Math.floor((se.y+W)/I)+1),B.push(Math.floor((se.y+se.h+W)/I)+1);break;case"bct":var pe=ge(this.ctx.lastPoint.x,this.ctx.lastPoint.y,_.x1,_.y1,_.x2,_.y2,_.x,_.y);B.push(Math.floor((pe.y+W)/I)+1),B.push(Math.floor((pe.y+pe.h+W)/I)+1);break;case"rect":B.push(Math.floor((_.y+W)/I)+1),B.push(Math.floor((_.y+_.h+W)/I)+1)}for(var he=0;he<B.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<B[he];)x.call(this);return B},x=function(){var _=this.fillStyle,R=this.strokeStyle,I=this.font,B=this.lineCap,W=this.lineWidth,se=this.lineJoin;this.pdf.addPage(),this.fillStyle=_,this.strokeStyle=R,this.font=I,this.lineCap=B,this.lineWidth=W,this.lineJoin=se},y=function(_,R,I){for(var B=0;B<_.length;B++)switch(_[B].type){case"bct":_[B].x2+=R,_[B].y2+=I;case"qct":_[B].x1+=R,_[B].y1+=I;default:_[B].x+=R,_[B].y+=I}return _},b=function(_){return _.sort(function(R,I){return R-I})},S=function(_,R){var I=this.fillStyle,B=this.strokeStyle,W=this.lineCap,se=this.lineWidth,pe=Math.abs(se*this.ctx.transform.scaleX),he=this.lineJoin;if(this.autoPaging){for(var de,je,Y=JSON.parse(JSON.stringify(this.path)),We=JSON.parse(JSON.stringify(this.path)),Ke=[],J=0;J<We.length;J++)if(We[J].x!==void 0)for(var ze=w.call(this,We[J]),He=0;He<ze.length;He+=1)Ke.indexOf(ze[He])===-1&&Ke.push(ze[He]);for(var it=0;it<Ke.length;it++)for(;this.pdf.internal.getNumberOfPages()<Ke[it];)x.call(this);b(Ke);for(var qe=Ke[0],ht=Ke[Ke.length-1],ct=qe;ct<ht+1;ct++){this.pdf.setPage(ct),this.fillStyle=I,this.strokeStyle=B,this.lineCap=W,this.lineWidth=pe,this.lineJoin=he;var Et=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=ct===1?this.posY+this.margin[0]:this.margin[0],Ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ft=ct===1?0:Ht+(ct-2)*Mt;if(this.ctx.clip_path.length!==0){var Yt=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(de,this.posX+this.margin[3],-Ft+xt+this.ctx.prevPageLastElemOffset),T.call(this,_,!0),this.path=Yt}if(je=JSON.parse(JSON.stringify(Y)),this.path=y(je,this.posX+this.margin[3],-Ft+xt+this.ctx.prevPageLastElemOffset),R===!1||ct===0){var Lt=(ct>qe||ct<ht)&&g.call(this);Lt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Mt,null).clip().discardPath()),T.call(this,_,R),Lt&&this.pdf.restoreGraphicsState()}this.lineWidth=se}this.path=Y}else this.lineWidth=pe,T.call(this,_,R),this.lineWidth=se},T=function(_,R){if((_!=="stroke"||R||!m.call(this))&&(_==="stroke"||R||!d.call(this))){for(var I,B,W=[],se=this.path,pe=0;pe<se.length;pe++){var he=se[pe];switch(he.type){case"begin":W.push({begin:!0});break;case"close":W.push({close:!0});break;case"mt":W.push({start:he,deltas:[],abs:[]});break;case"lt":var de=W.length;if(se[pe-1]&&!isNaN(se[pe-1].x)&&(I=[he.x-se[pe-1].x,he.y-se[pe-1].y],de>0)){for(;de>=0;de--)if(W[de-1].close!==!0&&W[de-1].begin!==!0){W[de-1].deltas.push(I),W[de-1].abs.push(he);break}}break;case"bct":I=[he.x1-se[pe-1].x,he.y1-se[pe-1].y,he.x2-se[pe-1].x,he.y2-se[pe-1].y,he.x-se[pe-1].x,he.y-se[pe-1].y],W[W.length-1].deltas.push(I);break;case"qct":var je=se[pe-1].x+2/3*(he.x1-se[pe-1].x),Y=se[pe-1].y+2/3*(he.y1-se[pe-1].y),We=he.x+2/3*(he.x1-he.x),Ke=he.y+2/3*(he.y1-he.y),J=he.x,ze=he.y;I=[je-se[pe-1].x,Y-se[pe-1].y,We-se[pe-1].x,Ke-se[pe-1].y,J-se[pe-1].x,ze-se[pe-1].y],W[W.length-1].deltas.push(I);break;case"arc":W.push({deltas:[],abs:[],arc:!0}),Array.isArray(W[W.length-1].abs)&&W[W.length-1].abs.push(he)}}B=R?null:_==="stroke"?"stroke":"fill";for(var He=!1,it=0;it<W.length;it++)if(W[it].arc)for(var qe=W[it].abs,ht=0;ht<qe.length;ht++){var ct=qe[ht];ct.type==="arc"?D.call(this,ct.x,ct.y,ct.radius,ct.startAngle,ct.endAngle,ct.counterclockwise,void 0,R,!He):q.call(this,ct.x,ct.y),He=!0}else if(W[it].close===!0)this.pdf.internal.out("h"),He=!1;else if(W[it].begin!==!0){var Et=W[it].start.x,xt=W[it].start.y;M.call(this,W[it].deltas,Et,xt),He=!0}B&&C.call(this,B),R&&O.call(this)}},L=function(_){var R=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=R*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return _-I;case"top":return _+R-I;case"hanging":return _+R-2*I;case"middle":return _+R/2-I;default:return _}},A=function(_){return _+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var _=function(){};return _.colorStops=[],_.addColorStop=function(R,I){this.colorStops.push([R,I])},_.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},_.isCanvasGradient=!0,_},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var D=function(_,R,I,B,W,se,pe,he,de){for(var je=fe.call(this,I,B,W,se),Y=0;Y<je.length;Y++){var We=je[Y];Y===0&&(de?E.call(this,We.x1+_,We.y1+R):q.call(this,We.x1+_,We.y1+R)),ne.call(this,_,R,We.x2,We.y2,We.x3,We.y3,We.x4,We.y4)}he?O.call(this):C.call(this,pe)},C=function(_){switch(_){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},O=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(_,R){this.pdf.internal.out(r(_)+" "+n(R)+" m")},P=function(_){var R;switch(_.align){case"right":case"end":R="right";break;case"center":R="center";break;default:R="left"}var I,B,W,se=this.pdf.getTextDimensions(_.text),pe=L.call(this,_.y),he=A.call(this,pe)-se.h,de=this.ctx.transform.applyToPoint(new i(_.x,pe));if(this.autoPaging){var je=this.ctx.transform.decompose(),Y=new l;Y=(Y=(Y=Y.multiply(je.translate)).multiply(je.skew)).multiply(je.scale);for(var We=this.ctx.transform.applyToRectangle(new o(_.x,pe,se.w,se.h)),Ke=Y.applyToRectangle(new o(_.x,he,se.w,se.h)),J=w.call(this,Ke),ze=[],He=0;He<J.length;He+=1)ze.indexOf(J[He])===-1&&ze.push(J[He]);b(ze);for(var it=ze[0],qe=ze[ze.length-1],ht=it;ht<qe+1;ht++){this.pdf.setPage(ht);var ct=ht===1?this.posY+this.margin[0]:this.margin[0],Et=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],xt=this.pdf.internal.pageSize.height-this.margin[2],Ht=xt-this.margin[0],Mt=this.pdf.internal.pageSize.width-this.margin[1],Ft=Mt-this.margin[3],Yt=ht===1?0:Et+(ht-2)*Ht;if(this.ctx.clip_path.length!==0){var Lt=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(I,this.posX+this.margin[3],-1*Yt+ct),T.call(this,"fill",!0),this.path=Lt}var pt=y([JSON.parse(JSON.stringify(Ke))],this.posX+this.margin[3],-Yt+ct+this.ctx.prevPageLastElemOffset)[0];_.scale>=.01&&(B=this.pdf.internal.getFontSize(),this.pdf.setFontSize(B*_.scale),W=this.lineWidth,this.lineWidth=W*_.scale);var nt=this.autoPaging!=="text";if(nt||pt.y+pt.h<=xt){if(nt||pt.y>=ct&&pt.x<=Mt){var at=nt?_.text:this.pdf.splitTextToSize(_.text,_.maxWidth||Mt-pt.x)[0],ar=y([JSON.parse(JSON.stringify(We))],this.posX+this.margin[3],-Yt+ct+this.ctx.prevPageLastElemOffset)[0],Ct=nt&&(ht>it||ht<qe)&&g.call(this);Ct&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ft,Ht,null).clip().discardPath()),this.pdf.text(at,ar.x,ar.y,{angle:_.angle,align:R,renderingMode:_.renderingMode}),Ct&&this.pdf.restoreGraphicsState()}}else pt.y<xt&&(this.ctx.prevPageLastElemOffset+=xt-pt.y);_.scale>=.01&&(this.pdf.setFontSize(B),this.lineWidth=W)}}else _.scale>=.01&&(B=this.pdf.internal.getFontSize(),this.pdf.setFontSize(B*_.scale),W=this.lineWidth,this.lineWidth=W*_.scale),this.pdf.text(_.text,de.x+this.posX,de.y+this.posY,{angle:_.angle,align:R,renderingMode:_.renderingMode,maxWidth:_.maxWidth}),_.scale>=.01&&(this.pdf.setFontSize(B),this.lineWidth=W)},q=function(_,R,I,B){I=I||0,B=B||0,this.pdf.internal.out(r(_+I)+" "+n(R+B)+" l")},M=function(_,R,I){return this.pdf.lines(_,R,I,null,null)},ne=function(_,R,I,B,W,se,pe,he){this.pdf.internal.out([t(s(I+_)),t(a(B+R)),t(s(W+_)),t(a(se+R)),t(s(pe+_)),t(a(he+R)),"c"].join(" "))},fe=function(_,R,I,B){for(var W=2*Math.PI,se=Math.PI/2;R>I;)R-=W;var pe=Math.abs(I-R);pe<W&&B&&(pe=W-pe);for(var he=[],de=B?-1:1,je=R;pe>1e-5;){var Y=je+de*Math.min(pe,se);he.push(me.call(this,_,je,Y)),pe-=Math.abs(Y-je),je=Y}return he},me=function(_,R,I){var B=(I-R)/2,W=_*Math.cos(B),se=_*Math.sin(B),pe=W,he=-se,de=pe*pe+he*he,je=de+pe*W+he*se,Y=4/3*(Math.sqrt(2*de*je)-je)/(pe*se-he*W),We=pe-Y*he,Ke=he+Y*pe,J=We,ze=-Ke,He=B+R,it=Math.cos(He),qe=Math.sin(He);return{x1:_*Math.cos(R),y1:_*Math.sin(R),x2:We*it-Ke*qe,y2:We*qe+Ke*it,x3:J*it-ze*qe,y3:J*qe+ze*it,x4:_*Math.cos(I),y4:_*Math.sin(I)}},re=function(_){return 180*_/Math.PI},G=function(_,R,I,B,W,se){var pe=_+.5*(I-_),he=R+.5*(B-R),de=W+.5*(I-W),je=se+.5*(B-se),Y=Math.min(_,W,pe,de),We=Math.max(_,W,pe,de),Ke=Math.min(R,se,he,je),J=Math.max(R,se,he,je);return new o(Y,Ke,We-Y,J-Ke)},ge=function(_,R,I,B,W,se,pe,he){var de,je,Y,We,Ke,J,ze,He,it,qe,ht,ct,Et,xt,Ht=I-_,Mt=B-R,Ft=W-I,Yt=se-B,Lt=pe-W,pt=he-se;for(je=0;je<41;je++)it=(ze=(Y=_+(de=je/40)*Ht)+de*((Ke=I+de*Ft)-Y))+de*(Ke+de*(W+de*Lt-Ke)-ze),qe=(He=(We=R+de*Mt)+de*((J=B+de*Yt)-We))+de*(J+de*(se+de*pt-J)-He),je==0?(ht=it,ct=qe,Et=it,xt=qe):(ht=Math.min(ht,it),ct=Math.min(ct,qe),Et=Math.max(Et,it),xt=Math.max(xt,qe));return new o(Math.round(ht),Math.round(ct),Math.round(Et-ht),Math.round(xt-ct))},ve=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var _,R,I=(_=this.ctx.lineDash,R=this.ctx.lineDashOffset,JSON.stringify({lineDash:_,lineDashOffset:R}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(jt.API),function(e){var t=function(i){var o,l,u,f,h,p,d,m,g,w;for(l=[],u=0,f=(i+=o="\0\0\0\0".slice(i.length%4||4)).length;f>u;u+=4)(h=(i.charCodeAt(u)<<24)+(i.charCodeAt(u+1)<<16)+(i.charCodeAt(u+2)<<8)+i.charCodeAt(u+3))!==0?(p=(h=((h=((h=((h=(h-(w=h%85))/85)-(g=h%85))/85)-(m=h%85))/85)-(d=h%85))/85)%85,l.push(p+33,d+33,m+33,g+33,w+33)):l.push(122);return function(x,y){for(var b=y;b>0;b--)x.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(i){var o,l,u,f,h,p=String,d="length",m=255,g="charCodeAt",w="slice",x="replace";for(i[w](-2),i=i[w](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),u=[],f=0,h=(i+=o="uuuuu"[w](i[d]%5||5))[d];h>f;f+=5)l=52200625*(i[g](f)-33)+614125*(i[g](f+1)-33)+7225*(i[g](f+2)-33)+85*(i[g](f+3)-33)+(i[g](f+4)-33),u.push(m&l>>24,m&l>>16,m&l>>8,m&l);return function(y,b){for(var S=b;S>0;S--)y.pop()}(u,o[d]),p.fromCharCode.apply(p,u)},n=function(i){return i.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(i){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((i=i.replace(/\s/g,"")).indexOf(">")!==-1&&(i=i.substr(0,i.indexOf(">"))),i.length%2&&(i+="0"),o.test(i)===!1)return"";for(var l="",u=0;u<i.length;u+=2)l+=String.fromCharCode("0x"+(i[u]+i[u+1]));return l},a=function(i){for(var o=new Uint8Array(i.length),l=i.length;l--;)o[l]=i.charCodeAt(l);return(o=Gw(o)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};e.processDataByFilters=function(i,o){var l=0,u=i||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=a(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(jt.API),function(e){e.loadFile=function(t,r,n){return function(s,a,i){a=a!==!1,i=typeof i=="function"?i:function(){};var o=void 0;try{o=function(l,u,f){var h=new XMLHttpRequest,p=0,d=function(m){var g=m.length,w=[],x=String.fromCharCode;for(p=0;p<g;p+=1)w.push(x(255&m.charCodeAt(p)));return w.join("")};if(h.open("GET",l,!u),h.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(h.onload=function(){h.status===200?f(d(this.responseText)):f(void 0)}),h.send(null),u&&h.status===200)return d(h.responseText)}(s,a,i)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(jt.API),function(e){function t(){return(zt.html2canvas?Promise.resolve(zt.html2canvas):yv(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(zt.DOMPurify?Promise.resolve(zt.DOMPurify):yv(()=>import("./purify.es-B6FQ9oRL.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=_r(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},s=function(o,l){var u=document.createElement(o);for(var f in l.className&&(u.className=l.className),l.innerHTML&&l.dompurify&&(u.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)u.style[f]=l.style[f];return u},a=function o(l,u){for(var f=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),h=l.firstChild;h;h=h.nextSibling)u!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(o(h,u));return l.nodeType===1&&(l.nodeName==="CANVAS"?(f.width=l.width,f.height=l.height,f.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(f.value=l.value),f.addEventListener("load",function(){f.scrollTop=l.scrollTop,f.scrollLeft=l.scrollLeft},!0)),f},i=function o(l){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),u);return(f=f.setProgress(1,o,1,[o])).set(l)};(i.prototype=Object.create(Promise.prototype)).constructor=i,i.convert=function(o,l){return o.__proto__=l||i.prototype,o},i.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},i.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),l){case"string":return this.then(r).then(function(u){return this.set({src:s("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},i.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},i.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},i.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,l(this.prop.container,u)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var u=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var d=0;d<f.length;++d){var m=f[d],g=m.src.find(function(w){return w.format==="truetype"});g&&u.addFont(g.url,m.ref.name,m.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},i.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},i.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},i.prototype.output=function(o,l,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},i.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},i.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},i.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},i.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},i.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(u){if(u in i.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(l)})},i.prototype.get=function(o,l){return this.then(function(){var u=o in i.template.prop?this.prop[o]:this.opt[o];return l?l(u):u})},i.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},i.prototype.setPageSize=function(o){function l(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(o=o||jt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},i.prototype.setProgress=function(o,l,u,f){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},i.prototype.updateProgress=function(o,l,u,f){return this.setProgress(o?this.progress.val+o:null,l||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},i.prototype.then=function(o,l){var u=this;return this.thenCore(o,l,function(f,h){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,f),p}).then(f,h).then(function(p){return u.updateProgress(1),p})})},i.prototype.thenCore=function(o,l,u){u=u||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),l&&(l=l.bind(f));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:i.convert(Object.assign({},f),Promise.prototype),p=u.call(h,o,l);return i.convert(p,f.__proto__)},i.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},i.prototype.thenList=function(o){var l=this;return o.forEach(function(u){l=l.thenCore(u)}),l},i.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return i.convert(l,this)},i.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},i.prototype.error=function(o){return this.then(function(){throw new Error(o)})},i.prototype.using=i.prototype.set,i.prototype.saveAs=i.prototype.save,i.prototype.export=i.prototype.output,i.prototype.run=i.prototype.then,jt.getPageSize=function(o,l,u){if(_r(o)==="object"){var f=o;o=f.orientation,l=f.unit||l,u=f.format||u}l=l||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var h,p=(""+u).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var m,g=0,w=0;if(d.hasOwnProperty(p))g=d[p][1]/h,w=d[p][0]/h;else try{g=u[1],w=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",w>g&&(m=w,w=g,g=m);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>w&&(m=w,w=g,g=m)}return{width:w,height:g,unit:l,k:h,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(Iv):null;var u=new i(l);return l.worker?u:u.from(o).doCallback()}}(jt.API),jt.API.addJS=function(e){return I_=e,this.internal.events.subscribe("postPutResources",function(){i1=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(i1+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),O_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+I_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){i1!==void 0&&O_!==void 0&&this.internal.out("/Names <</JavaScript "+i1+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=r.outline.render().split(/\r\n/),a=0;a<s.length;a++){var i=s[a],o=n.exec(i);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(i)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(a=0;a<u;a++){var h=r.internal.newObject();f.push(h);var p=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<f.length;a++)r.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,s,a){var i={title:s,options:a,children:[]};return n==null&&(n=this.root),n.children.push(i),i},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var s=0;s<n.children.length;s++)this.genIds_r(n.children[s])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var i=n.children[a];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var o=this.count=this.count_r({count:0},i);if(o>0&&this.line("/Count "+o),i.options&&i.options.pageNumber){var l=r.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,s){for(var a=0;a<s.children.length;a++)n.count++,this.count_r(n,s.children[a]);return n.count}}])}(jt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,s,a,i,o){var l,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=i||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,l=function(h){for(var p,d=256*h.charCodeAt(4)+h.charCodeAt(5),m=h.length,g={width:0,height:0,numcomponents:1},w=4;w<m;w+=2){if(w+=d,t.indexOf(h.charCodeAt(w+1))!==-1){p=256*h.charCodeAt(w+5)+h.charCodeAt(w+6),g={width:256*h.charCodeAt(w+7)+h.charCodeAt(w+8),height:p,numcomponents:h.charCodeAt(w+9)};break}d=256*h.charCodeAt(w+2)+h.charCodeAt(w+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:s}}return f}}(jt.API),jt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,a=PZ(e,{checkCrc:!0}),i=a.width,o=a.height,l=a.channels,u=a.palette,f=a.depth;s=u&&l===1?function(D){for(var C=D.width,O=D.height,E=D.data,P=D.palette,q=D.depth,M=!1,ne=[],fe=[],me=void 0,re=!1,G=0,ge=0;ge<P.length;ge++){var ve=$k(P[ge],4),_=ve[0],R=ve[1],I=ve[2],B=ve[3];ne.push(_,R,I),B!=null&&(B===0?(G++,fe.length<1&&fe.push(ge)):B<255&&(re=!0))}if(re||G>1){M=!0,fe=void 0;var W=C*O;me=new Uint8Array(W);for(var se=new DataView(E.buffer),pe=0;pe<W;pe++){var he=Bv(se,pe,q),de=$k(P[he],4)[3];me[pe]=de}}else G===0&&(fe=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:M?8:void 0,colorBytes:E,alphaBytes:me,needSMask:M,palette:ne,mask:fe}}(a):l===2||l===4?function(D){for(var C=D.data,O=D.width,E=D.height,P=D.channels,q=D.depth,M=P===2?"DeviceGray":"DeviceRGB",ne=P-1,fe=O*E,me=ne,re=fe*me,G=1*fe,ge=Math.ceil(re*q/8),ve=Math.ceil(G*q/8),_=new Uint8Array(ge),R=new Uint8Array(ve),I=new DataView(C.buffer),B=new DataView(_.buffer),W=new DataView(R.buffer),se=!1,pe=0;pe<fe;pe++){for(var he=pe*P,de=0;de<me;de++)V_(B,Bv(I,he+de,q),pe*me+de,q);var je=Bv(I,he+me,q);je<(1<<q)-1&&(se=!0),V_(W,je,1*pe,q)}return{colorSpace:M,colorsPerPixel:ne,sMaskBitsPerComponent:se?q:void 0,colorBytes:_,alphaBytes:R,needSMask:se}}(a):function(D){var C=D.data,O=D.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:O,colorsPerPixel:O==="DeviceGray"?1:3,colorBytes:C instanceof Uint16Array?function(E){for(var P=E.length,q=new Uint8Array(2*P),M=new DataView(q.buffer,q.byteOffset,q.byteLength),ne=0;ne<P;ne++)M.setUint16(2*ne,E[ne],!1);return q}(C):C,needSMask:!1}}(a);var h,p,d,m=s,g=m.colorSpace,w=m.colorsPerPixel,x=m.sMaskBitsPerComponent,y=m.colorBytes,b=m.alphaBytes,S=m.needSMask,T=m.palette,L=m.mask,A=null;return n!==jt.API.image_compression.NONE&&typeof Gw=="function"?(A=function(D){var C;switch(D){case jt.API.image_compression.FAST:C=11;break;case jt.API.image_compression.MEDIUM:C=13;break;case jt.API.image_compression.SLOW:C=14;break;default:C=12}return C}(n),h=this.decode.FLATE_DECODE,p="/Predictor ".concat(A," /Colors ").concat(w," /BitsPerComponent ").concat(f," /Columns ").concat(i),e=$_(y,Math.ceil(i*w*f/8),w,f,n),S&&(d=$_(b,Math.ceil(i*x/8),1,x,n))):(h=void 0,p=void 0,e=y,S&&(d=b)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:h,decodeParameters:p,transparency:L,palette:T,sMask:d,predictor:A,width:i,height:o,bitsPerComponent:f,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,s){var a=new QZ(t),i=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:i,height:o},f=new Uv(100).encode(u,100);return e.processJPEG.call(this,f,r,n,s)},e.processGIF87A=e.processGIF89A}(jt.API),mi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},mi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Fr.log("bit decode error:"+r)}},mi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}r!==0&&(this.pos+=4-r)}},mi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<e;s++){var a=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+2*s*4,o=a>>4,l=15&a,u=this.palette[o];if(this.data[i]=u.blue,this.data[i+1]=u.green,this.data[i+2]=u.red,this.data[i+3]=255,2*s+1>=this.width)break;u=this.palette[l],this.data[i+4]=u.blue,this.data[i+4+1]=u.green,this.data[i+4+2]=u.red,this.data[i+4+3]=255}t!==0&&(this.pos+=4-t)}},mi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var s=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(s<this.palette.length){var i=this.palette[s];this.data[a]=i.red,this.data[a+1]=i.green,this.data[a+2]=i.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},mi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,u=a>>15?255:0,f=n*this.width*4+4*s;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=i,this.data[f+3]=u}this.pos+=e}},mi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var s=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&r)/r*255|0,u=(i>>11)/t*255|0,f=s*this.width*4+4*a;this.data[f]=u,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},mi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=a,this.data[i+1]=s,this.data[i+2]=n,this.data[i+3]=255}this.pos+=this.width%4}},mi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=s,this.data[o+2]=n,this.data[o+3]=i}},mi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,s){var a=new mi(t,!1),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},u=new Uv(100).encode(l,100);return e.processJPEG.call(this,u,r,n,s)}}(jt.API),G_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,s){var a=new G_(t),i=a.width,o=a.height,l={data:a.getData(),width:i,height:o},u=new Uv(100).encode(l,100);return e.processJPEG.call(this,u,r,n,s)}}(jt.API),jt.API.processRGBA=function(e,t,r){for(var n=e.data,s=n.length,a=new Uint8Array(s/4*3),i=new Uint8Array(s/4),o=0,l=0,u=0;u<s;u+=4){var f=n[u],h=n[u+1],p=n[u+2],d=n[u+3];a[o++]=f,a[o++]=h,a[o++]=p,i[l++]=d}var m=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:m,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},jt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yf=jt.API,o1=yf.getCharWidthsArray=function(e,t){var r,n,s=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:s.metadata.Unicode.widths,l=o.fof?o.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,f=u.fof?u.fof:1,h=t.doKerning!==!1,p=0,d=e.length,m=0,g=o[0]||l,w=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof s.metadata.widthOfString=="function"?w.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(n))+i*(1e3/a)||0)/1e3):(p=h&&_r(u[n])==="object"&&!isNaN(parseInt(u[n][m],10))?u[n][m]/f:0,w.push((o[n]||g)/l+p)),m=n;return w},M_=yf.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return yf.processArabic&&(e=yf.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,s)/r:o1.apply(this,arguments).reduce(function(a,i){return a+i},0)},B_=function(e,t,r,n){for(var s=[],a=0,i=e.length,o=0;a!==i&&o+t[a]<r;)o+=t[a],a++;s.push(e.slice(0,a));var l=a;for(o=0;a!==i;)o+t[a]>n&&(s.push(e.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&s.push(e.slice(l,a)),s},U_=function(e,t,r){r||(r={});var n,s,a,i,o,l,u,f=[],h=[f],p=r.textIndent||0,d=0,m=0,g=e.split(" "),w=o1.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),y=[];g.map(function(S){(S=S.split(/\s*\n/)).length>1?y=y.concat(S.map(function(T,L){return(L&&T.length?`
`:"")+T})):y.push(S[0])}),g=y,l=M_.apply(this,[x,r])}for(a=0,i=g.length;a<i;a++){var b=0;if(n=g[a],l&&n[0]==`
`&&(n=n.substr(1),b=1),p+d+(m=(s=o1.apply(this,[n,r])).reduce(function(S,T){return S+T},0))>t||b){if(m>t){for(o=B_.apply(this,[n,s,t-(p+d),t]),f.push(o.shift()),f=[o.pop()];o.length;)h.push([o.shift()]);m=s.slice(n.length-(f[0]?f[0].length:0)).reduce(function(S,T){return S+T},0)}else f=[n];h.push(f),p=m+l,d=w}else f.push(n),p+=d+m,d=w}return u=l?function(S,T){return(T?x:"")+S.join(" ")}:function(S){return S.join(" ")},h.map(u)},yf.splitTextToSize=function(e,t,r){var n,s=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var h=this.internal.getFont(f.fontName,f.fontStyle),p="Unicode";return h.metadata[p]?{widths:h.metadata[p].widths||{0:1},kerning:h.metadata[p].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/s;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/s:0,a.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=n.length;o<l;o++)u=u.concat(U_.apply(this,[n[o],i,a]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},s={},a=0;a<16;a++)n[r[a]]=t[a],s[t[a]]=r[a];var i=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var d,m,g,w,x=["{"];for(var y in p){if(d=p[y],isNaN(parseInt(y,10))?m="'"+y+"'":(y=parseInt(y,10),m=(m=i(y).slice(2)).slice(0,-1)+s[m.slice(-1)]),typeof d=="number")d<0?(g=i(d).slice(3),w="-"):(g=i(d).slice(2),w=""),g=w+g.slice(0,-1)+s[g.slice(-1)];else{if(_r(d)!=="object")throw new Error("Don't know what to do with value type "+_r(d)+".");g=o(d)}x.push(m+g)}return x.push("}"),x.join("")},l=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,m,g,w,x={},y=1,b=x,S=[],T="",L="",A=p.length-1,D=1;D<A;D+=1)(w=p[D])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(w):w=="{"?(S.push([b,g]),b={},g=void 0):w=="}"?((m=S.pop())[0][m[1]]=b,g=void 0,b=m[0]):w=="-"?y=-1:g===void 0?n.hasOwnProperty(w)?(T+=n[w],g=parseInt(T,16)*y,y=1,T=""):T+=w:n.hasOwnProperty(w)?(L+=n[w],b[g]=parseInt(L,16)*y,y=1,g=void 0,L=""):L+=w;return x},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var d=p.font,m=h.Unicode[d.postScriptName];m&&(d.metadata.Unicode={},d.metadata.Unicode.widths=m.widths,d.metadata.Unicode.kerning=m.kerning);var g=f.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(jt.API),function(e){var t=function(r){for(var n=r.length,s=new Uint8Array(n),a=0;a<n;a++)s[a]=r.charCodeAt(a);return s};e.API.events.push(["addFont",function(r){var n=void 0,s=r.font,a=r.instance;if(!s.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(n=a.existsFileInVFS(s.postScriptName)===!1?a.loadFile(s.postScriptName):a.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(i,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(M1(o)),i.metadata=e.API.TTFFont.open(o),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(s,n)}}])}(jt),jt.API.addSvgAsImage=function(e,t,r,n,s,a,i,o){if(isNaN(t)||isNaN(r))throw Fr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Fr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=s;var u=l.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,l.width,l.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(zt.canvg?Promise.resolve(zt.canvg):yv(()=>import("./index.es-VpAlAF9h.js"),[])).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(f)}).then(function(){h.addImage(l.toDataURL("image/jpeg",1),t,r,n,s,i,o)})},jt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var s=0;s<this.internal.pages[n].length;s++)this.internal.pages[n][s]=this.internal.pages[n][s].replace(t,r);return this},jt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,s,a,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],u=0,f=0,h=0;function p(m,g){var w,x=!1;for(w=0;w<m.length;w+=1)m[w]===g&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=o.length;for(h=0;h<d;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(_r(e)==="object"){for(s in e)if(a=e[s],p(o,s)&&a!==void 0){if(r[s].type==="boolean"&&typeof a=="boolean")r[s].value=a;else if(r[s].type==="name"&&p(r[s].valueSet,a))r[s].value=a;else if(r[s].type==="integer"&&Number.isInteger(a))r[s].value=a;else if(r[s].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")l.push(String(a[u]-1));else if(a[u].length>1){for(f=0;f<a[u].length;f+=1)typeof a[u][f]!="number"&&(n=!1);n===!0&&l.push([a[u][0]-1,a[u][1]-1].join(" "))}r[s].value="["+l.join(" ")+"]"}else r[s].value=r[s].defaultValue;r[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var m,g=[];for(m in r)r[m].explicitSet===!0&&(r[m].type==="name"?g.push("/"+m+" /"+r[m].value):g.push("/"+m+" "+r[m].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+i.length+o.length+s.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+a+i+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(jt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,i){for(var o,l=i.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],h=0,p=a.length;h<p;++h){if(o=i.metadata.characterToGlyph(a.charCodeAt(h)),i.metadata.glyIdsUsed.push(o),i.metadata.toUnicode[o]=a.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(i.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(a){var i,o,l,u,f,h,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,p=(o=Object.keys(a).sort(function(d,m){return d-m})).length;h<p;h++)i=o[h],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[i]!==void 0&&a[i]!==null&&typeof a[i].toString=="function"&&(u=("0000"+a[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),l.push("<"+i+"><"+u+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,u=i.newObject,f=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",m=0;m<p.length;m++)d+=String.fromCharCode(p[m]);var g=u();f({data:d,addLength1:!0,objectId:g}),l("endobj");var w=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:w}),l("endobj");var x=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Ef(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var y=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+Ef(o.fontName)),l("/FontDescriptor "+x+" 0 R"),l("/W "+e.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+w+" 0 R"),l("/BaseFont /"+Ef(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+y+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(i){var o=i.font,l=i.out,u=i.newObject,f=i.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",d=0;d<h.length;d++)p+=String.fromCharCode(h[d]);var m=u();f({data:p,addLength1:!0,objectId:m}),l("endobj");var g=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var w=u();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+m+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Ef(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=u();for(var x=0;x<o.metadata.hmtx.widths.length;x++)o.metadata.hmtx.widths[x]=parseInt(o.metadata.hmtx.widths[x]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Ef(o.fontName)+"/FontDescriptor "+w+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var s=function(a){var i,o=a.text||"",l=a.x,u=a.y,f=a.options||{},h=a.mutex||{},p=h.pdfEscape,d=h.activeFontKey,m=h.fonts,g=d,w="",x=0,y="",b=m[g].encoding;if(m[g].encoding!=="Identity-H")return{text:o,x:l,y:u,options:f,mutex:h};for(y=o,g=d,Array.isArray(o)&&(y=o[0]),x=0;x<y.length;x+=1)m[g].metadata.hasOwnProperty("cmap")&&(i=m[g].metadata.cmap.unicode.codeMap[y[x].charCodeAt(0)]),i||y[x].charCodeAt(0)<256&&m[g].metadata.hasOwnProperty("Unicode")?w+=y[x]:w+="";var S="";return parseInt(g.slice(1))<14||b==="WinAnsiEncoding"?S=p(w,g).split("").map(function(T){return T.charCodeAt(0).toString(16)}).join(""):b==="Identity-H"&&(S=r(w,m[g])),h.isHex=!0,{text:S,x:l,y:u,options:f,mutex:h}};t.events.push(["postProcessText",function(a){var i=a.text||"",o=[],l={text:i,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(i)){var u=0;for(u=0;u<i.length;u+=1)Array.isArray(i[u])&&i[u].length===3?o.push([s(Object.assign({},l,{text:i[u][0]})).text,i[u][1],i[u][2]]):o.push(s(Object.assign({},l,{text:i[u]})).text);a.text=o}else a.text=s(Object.assign({},l,{text:i})).text}])}(jt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(jt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var s,a,i,o,l,u,f,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],m={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},w=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),y=!1,b=0;this.__bidiEngine__={};var S=function(E){var P=E.charCodeAt(),q=P>>8,M=g[q];return M!==void 0?h[256*M+(255&P)]:q===252||q===253?"AL":x.test(q)?"L":q===8?"R":"N"},T=function(E){for(var P,q=0;q<E.length;q++){if((P=S(E.charAt(q)))==="L")return!1;if(P==="R")return!0}return!1},L=function(E,P,q,M){var ne,fe,me,re,G=P[M];switch(G){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":y=!1;break;case"N":case"AN":break;case"EN":y&&(G="AN");break;case"AL":y=!0,G="R";break;case"WS":case"BN":G="N";break;case"CS":M<1||M+1>=P.length||(ne=q[M-1])!=="EN"&&ne!=="AN"||(fe=P[M+1])!=="EN"&&fe!=="AN"?G="N":y&&(fe="AN"),G=fe===ne?fe:"N";break;case"ES":G=(ne=M>0?q[M-1]:"B")==="EN"&&M+1<P.length&&P[M+1]==="EN"?"EN":"N";break;case"ET":if(M>0&&q[M-1]==="EN"){G="EN";break}if(y){G="N";break}for(me=M+1,re=P.length;me<re&&P[me]==="ET";)me++;G=me<re&&P[me]==="EN"?"EN":"N";break;case"NSM":if(i&&!o){for(re=P.length,me=M+1;me<re&&P[me]==="NSM";)me++;if(me<re){var ge=E[M],ve=ge>=1425&&ge<=2303||ge===64286;if(ne=P[me],ve&&(ne==="R"||ne==="AL")){G="R";break}}}G=M<1||(ne=P[M-1])==="B"?"N":q[M-1];break;case"B":y=!1,s=!0,G=b;break;case"S":a=!0,G="N"}return G},A=function(E,P,q){var M=E.split("");return q&&D(M,q,{hiLevel:b}),M.reverse(),P&&P.reverse(),M.join("")},D=function(E,P,q){var M,ne,fe,me,re,G=-1,ge=E.length,ve=0,_=[],R=b?d:p,I=[];for(y=!1,s=!1,a=!1,ne=0;ne<ge;ne++)I[ne]=S(E[ne]);for(fe=0;fe<ge;fe++){if(re=ve,_[fe]=L(E,I,_,fe),M=240&(ve=R[re][m[_[fe]]]),ve&=15,P[fe]=me=R[ve][5],M>0)if(M===16){for(ne=G;ne<fe;ne++)P[ne]=1;G=-1}else G=-1;if(R[ve][6])G===-1&&(G=fe);else if(G>-1){for(ne=G;ne<fe;ne++)P[ne]=me;G=-1}I[fe]==="B"&&(P[fe]=0),q.hiLevel|=me}a&&function(B,W,se){for(var pe=0;pe<se;pe++)if(B[pe]==="S"){W[pe]=b;for(var he=pe-1;he>=0&&B[he]==="WS";he--)W[he]=b}}(I,P,ge)},C=function(E,P,q,M,ne){if(!(ne.hiLevel<E)){if(E===1&&b===1&&!s)return P.reverse(),void(q&&q.reverse());for(var fe,me,re,G,ge=P.length,ve=0;ve<ge;){if(M[ve]>=E){for(re=ve+1;re<ge&&M[re]>=E;)re++;for(G=ve,me=re-1;G<me;G++,me--)fe=P[G],P[G]=P[me],P[me]=fe,q&&(fe=q[G],q[G]=q[me],q[me]=fe);ve=re}ve++}}},O=function(E,P,q){var M=E.split(""),ne={hiLevel:b};return q||(q=[]),D(M,q,ne),function(fe,me,re){if(re.hiLevel!==0&&f)for(var G,ge=0;ge<fe.length;ge++)me[ge]===1&&(G=w.indexOf(fe[ge]))>=0&&(fe[ge]=w[G+1])}(M,q,ne),C(2,M,P,q,ne),C(1,M,P,q,ne),M.join("")};return this.__bidiEngine__.doBidiReorder=function(E,P,q){if(function(ne,fe){if(fe)for(var me=0;me<ne.length;me++)fe[me]=me;o===void 0&&(o=T(ne)),u===void 0&&(u=T(ne))}(E,P),i||!l||u)if(i&&l&&o^u)b=o?1:0,E=A(E,P,q);else if(!i&&l&&u)b=o?1:0,E=O(E,P,q),E=A(E,P);else if(!i||o||l||u){if(i&&!l&&o^u)E=A(E,P),o?(b=0,E=O(E,P,q)):(b=1,E=O(E,P,q),E=A(E,P));else if(i&&o&&!l&&u)b=1,E=O(E,P,q),E=A(E,P);else if(!i&&!l&&o^u){var M=f;o?(b=1,E=O(E,P,q),b=0,f=!1,E=O(E,P,q),f=M):(b=0,E=O(E,P,q),E=A(E,P),b=1,f=!1,E=O(E,P,q),f=M,E=A(E,P))}}else b=0,E=O(E,P,q);else b=o?1:0,E=O(E,P,q);return E},this.__bidiEngine__.setOptions=function(E){E&&(i=E.isInputVisual,l=E.isOutputVisual,o=E.isInputRtl,u=E.isOutputRtl,f=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var s=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var i=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(i=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?i.push([r.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):i.push([r.doBidiReorder(s[o])]);n.text=i}else n.text=r.doBidiReorder(s);r.setOptions({isInputVisual:!0})}])}(jt),jt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Cc(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new hee(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new ZZ(this.contents),this.head=new tee(this),this.name=new iee(this),this.cmap=new yP(this),this.toUnicode={},this.hhea=new ree(this),this.maxp=new oee(this),this.hmtx=new lee(this),this.post=new see(this),this.os2=new nee(this),this.loca=new dee(this),this.glyf=new cee(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,s,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,o,l,u;for(u=[],i=0,o=(l=this.bbox).length;i<o;i++)t=l[i],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(s=this.post.italic_angle),32768&(r=s>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var s,a,i,o;for(i=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)s=t.charCodeAt(a),i+=this.widthOfGlyph(this.characterToGlyph(s))+n*(1e3/r)||0;return i*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Ui,Cc=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,s;for(s=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)s.push(this.writeByte(t.charCodeAt(r)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,s,a,i,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),s=this.readByte(),a=this.readByte(),i=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^s)+16777216*(255^a)+65536*(255^i)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*s+16777216*a+65536*i+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,s,a;for(a=[],n=0,s=t.length;n<s;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),ZZ=function(){var e;function t(r){var n,s,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},s=0,a=this.tableCount;0<=a?s<a:s>a;s=0<=a?++s:--s)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,s,a,i,o,l,u,f,h,p,d,m,g;for(g in d=Object.keys(r).length,l=Math.log(2),h=16*Math.floor(Math.log(d)/l),i=Math.floor(h/l),f=16*d-h,(s=new Cc).writeInt(this.scalarType),s.writeShort(d),s.writeShort(h),s.writeShort(i),s.writeShort(f),a=16*d,u=s.pos+a,o=null,m=[],r)for(p=r[g],s.writeString(g),s.writeInt(e(p)),s.writeInt(u),s.writeInt(p.length),m=m.concat(p),g==="head"&&(o=u),u+=p.length;u%4;)m.push(0),u++;return s.write(m),n=2981146554-e(s.data),s.pos=o+8,s.writeUInt32(n),s.data},e=function(r){var n,s,a,i;for(r=wP.call(r);r.length%4;)r.push(0);for(a=new Cc(r),s=0,n=0,i=r.length;n<i;n=n+=4)s+=a.readUInt32();return 4294967295&s},t}(),eee={}.hasOwnProperty,So=function(e,t){for(var r in t)eee.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Ui=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var tee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Cc).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Y_=function(){function e(t,r){var n,s,a,i,o,l,u,f,h,p,d,m,g,w,x,y,b;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),p=d/2,t.pos+=6,a=function(){var S,T;for(T=[],l=S=0;0<=p?S<p:S>p;l=0<=p?++S:--S)T.push(t.readUInt16());return T}(),t.pos+=2,g=function(){var S,T;for(T=[],l=S=0;0<=p?S<p:S>p;l=0<=p?++S:--S)T.push(t.readUInt16());return T}(),u=function(){var S,T;for(T=[],l=S=0;0<=p?S<p:S>p;l=0<=p?++S:--S)T.push(t.readUInt16());return T}(),f=function(){var S,T;for(T=[],l=S=0;0<=p?S<p:S>p;l=0<=p?++S:--S)T.push(t.readUInt16());return T}(),s=(this.length-t.pos+this.offset)/2,o=function(){var S,T;for(T=[],l=S=0;0<=s?S<s:S>s;l=0<=s?++S:--S)T.push(t.readUInt16());return T}(),l=x=0,b=a.length;x<b;l=++x)for(w=a[l],n=y=m=g[l];m<=w?y<=w:y>=w;n=m<=w?++y:--y)f[l]===0?i=n+u[l]:(i=o[f[l]/2+(n-m)-(p-l)]||0)!==0&&(i+=u[l]),this.codeMap[n]=65535&i}t.pos=h}return e.encode=function(t,r){var n,s,a,i,o,l,u,f,h,p,d,m,g,w,x,y,b,S,T,L,A,D,C,O,E,P,q,M,ne,fe,me,re,G,ge,ve,_,R,I,B,W,se,pe,he,de,je,Y;switch(M=new Cc,i=Object.keys(t).sort(function(We,Ke){return We-Ke}),r){case"macroman":for(g=0,w=function(){var We=[];for(m=0;m<256;++m)We.push(0);return We}(),y={0:0},a={},ne=0,G=i.length;ne<G;ne++)y[he=t[s=i[ne]]]==null&&(y[he]=++g),a[s]={old:t[s],new:y[t[s]]},w[s]=y[t[s]];return M.writeUInt16(1),M.writeUInt16(0),M.writeUInt32(12),M.writeUInt16(0),M.writeUInt16(262),M.writeUInt16(0),M.write(w),{charMap:a,subtable:M.data,maxGlyphID:g+1};case"unicode":for(P=[],h=[],b=0,y={},n={},x=u=null,fe=0,ge=i.length;fe<ge;fe++)y[T=t[s=i[fe]]]==null&&(y[T]=++b),n[s]={old:T,new:y[T]},o=y[T]-s,x!=null&&o===u||(x&&h.push(x),P.push(s),u=o),x=s;for(x&&h.push(x),h.push(65535),P.push(65535),O=2*(C=P.length),D=2*Math.pow(Math.log(C)/Math.LN2,2),p=Math.log(D/2)/Math.LN2,A=2*C-D,l=[],L=[],d=[],m=me=0,ve=P.length;me<ve;m=++me){if(E=P[m],f=h[m],E===65535){l.push(0),L.push(0);break}if(E-(q=n[E].new)>=32768)for(l.push(0),L.push(2*(d.length+C-m)),s=re=E;E<=f?re<=f:re>=f;s=E<=f?++re:--re)d.push(n[s].new);else l.push(q-E),L.push(0)}for(M.writeUInt16(3),M.writeUInt16(1),M.writeUInt32(12),M.writeUInt16(4),M.writeUInt16(16+8*C+2*d.length),M.writeUInt16(0),M.writeUInt16(O),M.writeUInt16(D),M.writeUInt16(p),M.writeUInt16(A),se=0,_=h.length;se<_;se++)s=h[se],M.writeUInt16(s);for(M.writeUInt16(0),pe=0,R=P.length;pe<R;pe++)s=P[pe],M.writeUInt16(s);for(de=0,I=l.length;de<I;de++)o=l[de],M.writeUInt16(o);for(je=0,B=L.length;je<B;je++)S=L[je],M.writeUInt16(S);for(Y=0,W=d.length;Y<W;Y++)g=d[Y],M.writeUInt16(g);return{charMap:n,subtable:M.data,maxGlyphID:b+1}}},e}(),yP=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)r=new Y_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,s;return r==null&&(r="macroman"),n=Y_.encode(t,r),(s=new Cc).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},e}(),ree=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),nee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),see=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var i,o,l;for(l=[],a=i=0,o=this.file.maxp.numGlyphs;0<=o?i<o:i>o;a=0<=o?++i:--i)l.push(t.readUInt32());return l}).call(this)}},e}(),aee=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},iee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,s,a,i,o,l,u,f,h,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},a=f=0,h=n.length;f<h;a=++f)s=n[a],t.pos=s.offset,u=t.readString(s.length),i=new aee(u,s),l[p=s.nameID]==null&&(l[p]=[]),l[s.nameID].push(i);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),oee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),lee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,s,a,i,o,l;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],r=u=0;0<=s?u<s:u>s;r=0<=s?++u:--u)f.push(t.readInt16());return f}(),this.widths=(function(){var u,f,h,p;for(p=[],u=0,f=(h=this.metrics).length;u<f;u++)a=h[u],p.push(a.advance);return p}).call(this),n=this.widths[this.widths.length-1],l=[],r=i=0;0<=s?i<s:i>s;r=0<=s?++i:--i)l.push(this.widths.push(n));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),wP=[].slice,cee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,s,a,i,o,l,u,f,h;return t in this.cache?this.cache[t]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(t),(s=a.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,i=(o=new Cc(r.read(s))).readShort(),u=o.readShort(),h=o.readShort(),l=o.readShort(),f=o.readShort(),this.cache[t]=i===-1?new fee(o,u,h,l,f):new uee(o,i,u,h,l,f),this.cache[t]))},e.prototype.encode=function(t,r,n){var s,a,i,o,l;for(i=[],a=[],o=0,l=r.length;o<l;o++)s=t[r[o]],a.push(i.length),s&&(i=i.concat(s.encode(n)));return a.push(i.length),{table:i,offsets:a}},e}(),uee=function(){function e(t,r,n,s,a,i){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=s,this.xMax=a,this.yMax=i,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),fee=function(){function e(t,r,n,s,a){var i,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=s,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;o=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&o;)i.pos+=1&o?4:2,128&o?i.pos+=8:64&o?i.pos+=4:8&o&&(i.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Cc(wP.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),dee=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return So(e,Ui),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var s,a;for(a=[],n=0,s=this.length;n<s;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),s=0,a=0,i=0;i<n.length;++i)if(n[i]=s,a<r.length&&r[a]==i){++a,n[i]=s;var o=this.offsets[i],l=this.offsets[i+1]-o;l>0&&(s+=l)}for(var u=new Array(4*n.length),f=0;f<n.length;++f)u[4*f+3]=255&n[f],u[4*f+2]=(65280&n[f])>>8,u[4*f+1]=(16711680&n[f])>>16,u[4*f]=(4278190080&n[f])>>24;return u},e}(),hee=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,s,a;for(r in s=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=s[n];return t},e.prototype.glyphsFor=function(t){var r,n,s,a,i,o,l;for(s={},i=0,o=t.length;i<o;i++)s[a=t[i]]=this.font.glyf.glyphFor(a);for(a in r=[],s)(n=s[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in l=this.glyphsFor(r))n=l[a],s[a]=n;return s},e.prototype.encode=function(t,r){var n,s,a,i,o,l,u,f,h,p,d,m,g,w,x;for(s in n=yP.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(t),d={0:0},x=n.charMap)d[(l=x[s]).old]=l.new;for(m in p=n.maxGlyphID,i)m in d||(d[m]=p++);return f=function(y){var b,S;for(b in S={},y)S[y[b]]=b;return S}(d),h=Object.keys(f).sort(function(y,b){return y-b}),g=function(){var y,b,S;for(S=[],y=0,b=h.length;y<b;y++)o=h[y],S.push(f[o]);return S}(),a=this.font.glyf.encode(i,g,d),u=this.font.loca.encode(a.offsets,g),w={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(w["OS/2"]=this.font.os2.raw()),this.font.directory.encode(w)},e}();jt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,s,a,i;if(Array.isArray(r))return"["+function(){var o,l,u;for(u=[],o=0,l=r.length;o<l;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(s in a=["<<"],r)i=r[s],a.push("/"+s+" "+t.convert(i));return a.push(">>"),a.join(`
`)}return""+r},t}();function bP(e,t,r,n,s){n=n||{};var a=1.15,i=s.internal.scaleFactor,o=s.internal.getFontSize()/i,l=s.getLineHeightFactor?s.getLineHeightFactor():a,u=o*l,f=/\r\n|\r|\n/g,h="",p=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(h=typeof e=="string"?e.split(f):e,p=h.length||1),r+=o*(2-a),n.valign==="middle"?r-=p/2*u:n.valign==="bottom"&&(r-=p*u),n.halign==="center"||n.halign==="right"){var d=o;if(n.halign==="center"&&(d*=.5),h&&p>=1){for(var m=0;m<h.length;m++)s.text(h[m],t-s.getStringUnitWidth(h[m])*d,r),r+=u;return s}t-=s.getStringUnitWidth(e)*d}return n.halign==="justify"?s.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):s.text(e,t,r),s}var X_={},ad=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:X_=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,s,a;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var i=this.jsPDFDocument.internal.getFont(),o=i.fontStyle,l=i.fontName;if(t.font&&(l=t.font),t.fontStyle){o=t.fontStyle;var u=this.getFontList()[l];u&&u.indexOf(o)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(u[0]),o=u[0])}if(this.jsPDFDocument.setFont(l,o),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var f=e.unifyColor(t.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=e.unifyColor(t.textColor),f&&(s=this.jsPDFDocument).setTextColor.apply(s,f),f=e.unifyColor(t.lineColor),f&&(a=this.jsPDFDocument).setDrawColor.apply(a,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,s,a){return this.jsPDFDocument.rect(t,r,n,s,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return X_||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),r5=function(e,t){return r5=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(r[s]=n[s])},r5(e,t)};function NP(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");r5(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var SP=function(e){NP(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t}(Array);function pee(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function mee(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function Vg(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],s=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,i){return Math.max(a,i)},0);return s}function kP(e,t,r,n){var s=t.settings.tableLineWidth,a=t.settings.tableLineColor;e.applyStyles({lineWidth:s,lineColor:a});var i=_P(s,!1);i&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,i)}function _P(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function Mx(e,t){var r,n,s,a;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(s=e.right)!==null&&s!==void 0?s:t,bottom:(a=e.bottom)!==null&&a!==void 0?a:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function EP(e,t){var r=Mx(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function gee(e,t,r,n,s){var a={},i=1.3333333333333333,o=$v(t,function(b){return s.getComputedStyle(b).backgroundColor});o!=null&&(a.fillColor=o);var l=$v(t,function(b){return s.getComputedStyle(b).color});l!=null&&(a.textColor=l);var u=vee(n,r);u&&(a.cellPadding=u);var f="borderTopColor",h=i*r,p=n.borderTopWidth;if(n.borderBottomWidth===p&&n.borderRightWidth===p&&n.borderLeftWidth===p){var d=(parseFloat(p)||0)/h;d&&(a.lineWidth=d)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/h,right:(parseFloat(n.borderRightWidth)||0)/h,bottom:(parseFloat(n.borderBottomWidth)||0)/h,left:(parseFloat(n.borderLeftWidth)||0)/h},a.lineWidth.top||(a.lineWidth.right?f="borderRightColor":a.lineWidth.bottom?f="borderBottomColor":a.lineWidth.left&&(f="borderLeftColor"));var m=$v(t,function(b){return s.getComputedStyle(b)[f]});m!=null&&(a.lineColor=m);var g=["left","right","center","justify"];g.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),g=["middle","bottom","top"],g.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var w=parseInt(n.fontSize||"");isNaN(w)||(a.fontSize=w/i);var x=xee(n);x&&(a.fontStyle=x);var y=(n.fontFamily||"").toLowerCase();return e.indexOf(y)!==-1&&(a.font=y),a}function xee(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function $v(e,t){var r=AP(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var s=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(s[0])||isNaN(s[1])||isNaN(s[2])?null:s}function AP(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:AP(e.parentElement,t):r}function vee(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),s=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,a=r.map(function(o){return parseInt(o||"0")/n}),i=Mx(a,0);return s>i.top&&(i.top=s),s>i.bottom&&(i.bottom=s),i}function jP(e,t,r,n,s){var a,i;n===void 0&&(n=!1),s===void 0&&(s=!1);var o;typeof t=="string"?o=r.document.querySelector(t):o=t;var l=Object.keys(e.getFontList()),u=e.scaleFactor(),f=[],h=[],p=[];if(!o)return console.error("Html table could not be found with input: ",t),{head:f,body:h,foot:p};for(var d=0;d<o.rows.length;d++){var m=o.rows[d],g=(i=(a=m==null?void 0:m.parentElement)===null||a===void 0?void 0:a.tagName)===null||i===void 0?void 0:i.toLowerCase(),w=yee(l,u,r,m,n,s);w&&(g==="thead"?f.push(w):g==="tfoot"?p.push(w):h.push(w))}return{head:f,body:h,foot:p}}function yee(e,t,r,n,s,a){for(var i=new SP(n),o=0;o<n.cells.length;o++){var l=n.cells[o],u=r.getComputedStyle(l);if(s||u.display!=="none"){var f=void 0;a&&(f=gee(e,l,t,u,r)),i.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:f,_element:l,content:wee(l)})}}var h=r.getComputedStyle(n);if(i.length>0&&(s||h.display!=="none"))return i}function wee(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function bee(e,t,r){for(var n=0,s=[e,t,r];n<s.length;n++){var a=s[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function rl(e,t,r,n,s){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),i=1;i<arguments.length;i++){var o=arguments[i];if(o!=null)for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(a[l]=o[l])}return a}function TP(e,t){var r=new ad(e),n=r.getDocumentOptions(),s=r.getGlobalOptions();bee(s,n,t);var a=rl({},s,n,t),i;typeof window<"u"&&(i=window);var o=Nee(s,n,t),l=See(s,n,t),u=kee(r,a),f=Eee(r,a,i);return{id:t.tableId,content:f,hooks:l,styles:o,settings:u}}function Nee(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},s=function(l){if(l==="columnStyles"){var u=e[l],f=t[l],h=r[l];n.columnStyles=rl({},u,f,h)}else{var p=[e,t,r],d=p.map(function(m){return m[l]||{}});n[l]=rl({},d[0],d[1],d[2])}},a=0,i=Object.keys(n);a<i.length;a++){var o=i[a];s(o)}return n}function See(e,t,r){for(var n=[e,t,r],s={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,i=n;a<i.length;a++){var o=i[a];o.didParseCell&&s.didParseCell.push(o.didParseCell),o.willDrawCell&&s.willDrawCell.push(o.willDrawCell),o.didDrawCell&&s.didDrawCell.push(o.didDrawCell),o.willDrawPage&&s.willDrawPage.push(o.willDrawPage),o.didDrawPage&&s.didDrawPage.push(o.didDrawPage)}return s}function kee(e,t){var r,n,s,a,i,o,l,u,f,h,p,d,m=Mx(t.margin,40/e.scaleFactor()),g=(r=_ee(e,t.startY))!==null&&r!==void 0?r:m.top,w;t.showFoot===!0?w="everyPage":t.showFoot===!1?w="never":w=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var x;t.showHead===!0?x="everyPage":t.showHead===!1?x="never":x=(s=t.showHead)!==null&&s!==void 0?s:"everyPage";var y=(a=t.useCss)!==null&&a!==void 0?a:!1,b=t.theme||(y?"plain":"striped"),S=!!t.horizontalPageBreak,T=(i=t.horizontalPageBreakRepeat)!==null&&i!==void 0?i:null;return{includeHiddenHtml:(o=t.includeHiddenHtml)!==null&&o!==void 0?o:!1,useCss:y,theme:b,startY:g,margin:m,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(u=t.rowPageBreak)!==null&&u!==void 0?u:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:x,showFoot:w,tableLineWidth:(h=t.tableLineWidth)!==null&&h!==void 0?h:0,tableLineColor:(p=t.tableLineColor)!==null&&p!==void 0?p:200,horizontalPageBreak:S,horizontalPageBreakRepeat:T,horizontalPageBreakBehaviour:(d=t.horizontalPageBreakBehaviour)!==null&&d!==void 0?d:"afterAllRows"}}function _ee(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),s=e.pageNumber(),a=!1;if(r&&r.startPageNumber){var i=r.startPageNumber+r.pageNumber-1;a=i===s}return typeof t=="number"?t:(t==null||t===!1)&&a&&(r==null?void 0:r.finalY)!=null?r.finalY+20/n:null}function Eee(e,t,r){var n=t.head||[],s=t.body||[],a=t.foot||[];if(t.html){var i=t.includeHiddenHtml;if(r){var o=jP(e,t.html,r,i,t.useCss)||{};n=o.head||n,s=o.body||n,a=o.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||Aee(n,s,a);return{columns:l,head:n,body:s,foot:a}}function Aee(e,t,r){var n=e[0]||t[0]||r[0]||[],s=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var i=1,o;Array.isArray(n)?o=n[parseInt(a)]:o=n[a],typeof o=="object"&&!Array.isArray(o)&&(i=(o==null?void 0:o.colSpan)||1);for(var l=0;l<i;l++){var u=void 0;Array.isArray(n)?u=s.length:u=a+(l>0?"_".concat(l):"");var f={dataKey:u};s.push(f)}}),s}var n5=function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),jee=function(e){NP(t,e);function t(r,n,s,a,i,o){var l=e.call(this,r,n,o)||this;return l.cell=s,l.row=a,l.column=i,l.section=a.section,l}return t}(n5),Tee=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,s,a,i){for(var o=0,l=r;o<l.length;o++){var u=l[o],f=new jee(t,this,n,s,a,i),h=u(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],h)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,s=this.hooks.didDrawPage;n<s.length;n++){var a=s[n];a(new n5(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,s=this.hooks.willDrawPage;n<s.length;n++){var a=s[n];a(new n5(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(s,a){return s+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),CP=function(){function e(t,r,n,s,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof SP&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=s,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,s){var a;return Math.max(n,((a=r.cells[s.index])===null||a===void 0?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var s=r.cells[n.index];return s?s.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(s,a){var i=n.cells[a.index];if(!i)return 0;var o=r.getLineHeight(i.styles.fontSize),l=i.padding("vertical"),u=l+o;return u>s?u:s},0)},e}(),PP=function(){function e(t,r,n){var s;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(s=t.content)!==null&&s!==void 0?s:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var i=a!=null?""+a:"",o=/\r\n|\r|\n/g;this.text=i.split(o)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var s=this.width-this.padding("horizontal");n=this.x+s/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,s=this.styles.fontSize/t*r,a=n*s+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Mx(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),Cee=function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,s=t.allRows();n<s.length;n++){var a=s[n],i=a.cells[this.index];i&&typeof i.styles.cellWidth=="number"&&(r=Math.max(r,i.styles.cellWidth))}return r},e}();function Pee(e,t){Lee(e,t);var r=[],n=0;t.columns.forEach(function(a){var i=a.getMaxCustomCellWidth(t);i?a.width=i:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var s=t.getWidth(e.pageSize().width)-n;s&&(s=s5(r,s,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),s&&(s=s5(r,s,function(a){return a.minWidth})),s=Math.abs(s),!t.settings.horizontalPageBreak&&s>.1/e.scaleFactor()&&(s=s<1?s:Math.round(s),console.warn("Of the table content, ".concat(s," units width could not fit page"))),Dee(t),Ree(t,e),Fee(t)}function Lee(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,s=EP(e,t);t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u){var f=t.hooks.didParseCell;t.callCellHooks(e,f,u,a,l,null);var h=u.padding("horizontal");u.contentWidth=Vg(u.text,u.styles,e)+h;var p=Vg(u.text.join(" ").split(/[^\S\u00A0]+/),u.styles,e);if(u.minReadableWidth=p+u.padding("horizontal"),typeof u.styles.cellWidth=="number")u.minWidth=u.styles.cellWidth,u.wrappedWidth=u.styles.cellWidth;else if(u.styles.cellWidth==="wrap"||n===!0)u.contentWidth>s?(u.minWidth=s,u.wrappedWidth=s):(u.minWidth=u.contentWidth,u.wrappedWidth=u.contentWidth);else{var d=10/r;u.minWidth=u.styles.minCellWidth||d,u.wrappedWidth=u.contentWidth,u.minWidth>u.wrappedWidth&&(u.wrappedWidth=u.minWidth)}}}}),t.allRows().forEach(function(a){for(var i=0,o=t.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u&&u.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,u.wrappedWidth),l.minWidth=Math.max(l.minWidth,u.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,u.minReadableWidth);else{var f=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},h=f.cellWidth||f.minCellWidth;h&&typeof h=="number"&&(l.minWidth=h,l.wrappedWidth=h)}u&&(u.colSpan>1&&!l.minWidth&&(l.minWidth=u.minWidth),u.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=u.minWidth))}})}function s5(e,t,r){for(var n=t,s=e.reduce(function(d,m){return d+m.wrappedWidth},0),a=0;a<e.length;a++){var i=e[a],o=i.wrappedWidth/s,l=n*o,u=i.width+l,f=r(i),h=u<f?f:u;t-=h-i.width,i.width=h}if(t=Math.round(t*1e10)/1e10,t){var p=e.filter(function(d){return t<0?d.width>r(d):!0});p.length&&(t=s5(p,t,r))}return t}function Fee(e){for(var t={},r=1,n=e.allRows(),s=0;s<n.length;s++)for(var a=n[s],i=0,o=e.columns;i<o.length;i++){var l=o[i],u=t[l.index];if(r>1)r--,delete a.cells[l.index];else if(u)u.cell.height+=a.height,r=u.cell.colSpan,delete a.cells[l.index],u.left--,u.left<=1&&delete t[l.index];else{var f=a.cells[l.index];if(!f)continue;if(f.height=a.height,f.rowSpan>1){var h=n.length-s,p=f.rowSpan>h?h:f.rowSpan;t[l.index]={cell:f,left:p,row:a}}}}}function Dee(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],s=null,a=0,i=0,o=0;o<e.columns.length;o++){var l=e.columns[o];if(i-=1,i>1&&e.columns[o+1])a+=l.width,delete n.cells[l.index];else if(s){var u=s;delete n.cells[l.index],s=null,u.width=l.width+a}else{var u=n.cells[l.index];if(!u)continue;if(i=u.colSpan,a=0,u.colSpan>1){s=u,a+=l.width;continue}u.width=l.width+a}}}function Ree(e,t){for(var r={count:0,height:0},n=0,s=e.allRows();n<s.length;n++){for(var a=s[n],i=0,o=e.columns;i<o.length;i++){var l=o[i],u=a.cells[l.index];if(u){t.applyStyles(u.styles,!0);var f=u.width-u.padding("horizontal");if(u.styles.overflow==="linebreak")u.text=t.splitTextToSize(u.text,f+1/t.scaleFactor(),{fontSize:u.styles.fontSize});else if(u.styles.overflow==="ellipsize")u.text=J_(u.text,f,u.styles,t,"...");else if(u.styles.overflow==="hidden")u.text=J_(u.text,f,u.styles,t,"");else if(typeof u.styles.overflow=="function"){var h=u.styles.overflow(u.text,f);typeof h=="string"?u.text=[h]:u.text=h}u.contentHeight=u.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var p=u.contentHeight/u.rowSpan;u.rowSpan>1&&r.count*r.height<p*u.rowSpan?r={height:p,count:u.rowSpan}:r&&r.count>0&&r.height>p&&(p=r.height),p>a.height&&(a.height=p)}}r.count--}}function J_(e,t,r,n,s){return e.map(function(a){return Oee(a,t,r,n,s)})}function Oee(e,t,r,n,s){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=Vg(e,r,n))return e;for(;t<Vg(e+s,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+s}function LP(e,t){var r=new ad(e),n=Iee(t,r.scaleFactor()),s=new Tee(t,n);return Pee(r,s),r.applyStyles(r.userStyles),s}function Iee(e,t){var r=e.content,n=Bee(r.columns);if(r.head.length===0){var s=Q_(n,"head");s&&r.head.push(s)}if(r.foot.length===0){var s=Q_(n,"foot");s&&r.foot.push(s)}var a=e.settings.theme,i=e.styles;return{columns:n,head:zv("head",r.head,n,i,a,t),body:zv("body",r.body,n,i,a,t),foot:zv("foot",r.foot,n,i,a,t)}}function zv(e,t,r,n,s,a){var i={},o=t.map(function(l,u){for(var f=0,h={},p=0,d=0,m=0,g=r;m<g.length;m++){var w=g[m];if(i[w.index]==null||i[w.index].left===0)if(d===0){var x=void 0;Array.isArray(l)?x=l[w.index-p-f]:x=l[w.dataKey];var y={};typeof x=="object"&&!Array.isArray(x)&&(y=(x==null?void 0:x.styles)||{});var b=Uee(e,w,u,s,n,a,y),S=new PP(x,b,e);h[w.dataKey]=S,h[w.index]=S,d=S.colSpan-1,i[w.index]={left:S.rowSpan-1,times:d}}else d--,p++;else i[w.index].left--,d=i[w.index].times,f++}return new CP(l,u,e,h)});return o}function Q_(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var s=Mee(t,n.raw);s!=null&&(r[n.dataKey]=s)}}),Object.keys(r).length>0?r:null}function Mee(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function Bee(e){return e.map(function(t,r){var n,s;return typeof t=="object"?s=(n=t.dataKey)!==null&&n!==void 0?n:r:s=r,new Cee(s,t,r)})}function Uee(e,t,r,n,s,a,i){var o=mee(n),l;e==="head"?l=s.headStyles:e==="body"?l=s.bodyStyles:e==="foot"&&(l=s.footStyles);var u=rl({},o.table,o[e],s.styles,l),f=s.columnStyles[t.dataKey]||s.columnStyles[t.index]||{},h=e==="body"?f:{},p=e==="body"&&r%2===0?rl({},o.alternateRow,s.alternateRowStyles):{},d=pee(a),m=rl({},d,u,p,h);return rl(m,i)}function $ee(e,t,r){var n;r===void 0&&(r={});var s=EP(e,t),a=new Map,i=[],o=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(p){var d=t.columns.find(function(m){return m.dataKey===p||m.index===p});d&&!a.has(d.index)&&(a.set(d.index,!0),i.push(d.index),o.push(t.columns[d.index]),s-=d.wrappedWidth)});for(var u=!0,f=(n=r==null?void 0:r.start)!==null&&n!==void 0?n:0;f<t.columns.length;){if(a.has(f)){f++;continue}var h=t.columns[f].wrappedWidth;if(u||s>=h)u=!1,i.push(f),o.push(t.columns[f]),s-=h;else break;f++}return{colIndexes:i,columns:o,lastIndex:f-1}}function zee(e,t){for(var r=[],n=0;n<t.columns.length;n++){var s=$ee(e,t,{start:n});s.columns.length&&(r.push(s),n=s.lastIndex)}return r}function FP(e,t){var r=t.settings,n=r.startY,s=r.margin,a={x:s.left,y:n},i=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),o=n+s.bottom+i;if(r.pageBreak==="avoid"){var l=t.body,u=l.reduce(function(p,d){return p+d.height},0);o+=u}var f=new ad(e);(r.pageBreak==="always"||r.startY!=null&&o>f.pageSize().height)&&(RP(f),a.y=s.top),t.callWillDrawPageHooks(f,a);var h=rl({},a);t.startPageNumber=f.pageNumber(),r.horizontalPageBreak?Hee(f,t,h,a):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(p){return gl(f,t,p,a,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(p,d){var m=d===t.body.length-1;Kg(f,t,p,m,h,a,t.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(p){return gl(f,t,p,a,t.columns)})),kP(f,t,h,a),t.callEndPageHooks(f,a),t.finalY=a.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function Hee(e,t,r,n){var s=zee(e,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")s.forEach(function(u,f){e.applyStyles(e.userStyles),f>0?x0(e,t,r,n,u.columns,!0):Z_(e,t,n,u.columns),qee(e,t,r,n,u.columns),Hv(e,t,n,u.columns)});else for(var i=-1,o=s[0],l=function(){var u=i;if(o){e.applyStyles(e.userStyles);var f=o.columns;i>=0?x0(e,t,r,n,f,!0):Z_(e,t,n,f),u=eE(e,t,i+1,n,f),Hv(e,t,n,f)}var h=u-i;s.slice(1).forEach(function(p){e.applyStyles(e.userStyles),x0(e,t,r,n,p.columns,!0),eE(e,t,i+1,n,p.columns,h),Hv(e,t,n,p.columns)}),i=u};i<t.body.length-1;)l()}function Z_(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showHead==="firstPage"||s.showHead==="everyPage")&&t.head.forEach(function(a){return gl(e,t,a,r,n)})}function qee(e,t,r,n,s){e.applyStyles(e.userStyles),t.body.forEach(function(a,i){var o=i===t.body.length-1;Kg(e,t,a,o,r,n,s)})}function eE(e,t,r,n,s,a){e.applyStyles(e.userStyles),a=a??t.body.length;var i=Math.min(r+a,t.body.length),o=-1;return t.body.slice(r,i).forEach(function(l,u){var f=r+u===t.body.length-1,h=DP(e,t,f,n);l.canEntireRowFit(h,s)&&(gl(e,t,l,n,s),o=r+u)}),o}function Hv(e,t,r,n){var s=t.settings;e.applyStyles(e.userStyles),(s.showFoot==="lastPage"||s.showFoot==="everyPage")&&t.foot.forEach(function(a){return gl(e,t,a,r,n)})}function Wee(e,t,r){var n=r.getLineHeight(e.styles.fontSize),s=e.padding("vertical"),a=Math.floor((t-s)/n);return Math.max(0,a)}function Vee(e,t,r,n){var s={};e.spansMultiplePages=!0,e.height=0;for(var a=0,i=0,o=r.columns;i<o.length;i++){var l=o[i],u=e.cells[l.index];if(u){Array.isArray(u.text)||(u.text=[u.text]);var f=new PP(u.raw,u.styles,u.section);f=rl(f,u),f.text=[];var h=Wee(u,t,n);u.text.length>h&&(f.text=u.text.splice(h,u.text.length));var p=n.scaleFactor(),d=n.getLineHeightFactor();u.contentHeight=u.getContentHeight(p,d),u.contentHeight>=t&&(u.contentHeight=t,f.styles.minCellHeight-=t),u.contentHeight>e.height&&(e.height=u.contentHeight),f.contentHeight=f.getContentHeight(p,d),f.contentHeight>a&&(a=f.contentHeight),s[l.index]=f}}var m=new CP(e.raw,-1,e.section,s,!0);m.height=a;for(var g=0,w=r.columns;g<w.length;g++){var l=w[g],f=m.cells[l.index];f&&(f.height=m.height);var u=e.cells[l.index];u&&(u.height=e.height)}return m}function Kee(e,t,r,n){var s=e.pageSize().height,a=n.settings.margin,i=a.top+a.bottom,o=s-i;t.section==="body"&&(o-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,e),u=l<r;if(l>o)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!u)return!1;var f=t.hasRowSpan(n.columns),h=t.getMaxCellHeight(n.columns)>o;return h?(f&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function Kg(e,t,r,n,s,a,i){var o=DP(e,t,n,a);if(r.canEntireRowFit(o,i))gl(e,t,r,a,i);else if(Kee(e,r,o,t)){var l=Vee(r,o,t,e);gl(e,t,r,a,i),x0(e,t,s,a,i),Kg(e,t,l,n,s,a,i)}else x0(e,t,s,a,i),Kg(e,t,r,n,s,a,i)}function gl(e,t,r,n,s){n.x=t.settings.margin.left;for(var a=0,i=s;a<i.length;a++){var o=i[a],l=r.cells[o.index];if(!l){n.x+=o.width;continue}e.applyStyles(l.styles),l.x=n.x,l.y=n.y;var u=t.callCellHooks(e,t.hooks.willDrawCell,l,r,o,n);if(u===!1){n.x+=o.width;continue}Gee(e,l,n);var f=l.getTextPos();bP(l.text,f.x,f.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,o,n),n.x+=o.width}n.y+=r.height}function Gee(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var s=_P(n.lineWidth,n.fillColor);s&&e.rect(t.x,r.y,t.width,t.height,s)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),Yee(e,t,r,n.lineWidth))}function Yee(e,t,r,n){var s,a,i,o;n.top&&(s=r.x,a=r.y,i=r.x+t.width,o=r.y,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.top,s,a,i,o)),n.bottom&&(s=r.x,a=r.y+t.height,i=r.x+t.width,o=r.y+t.height,n.right&&(i+=.5*n.right),n.left&&(s-=.5*n.left),l(n.bottom,s,a,i,o)),n.left&&(s=r.x,a=r.y,i=r.x,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.left,s,a,i,o)),n.right&&(s=r.x+t.width,a=r.y,i=r.x+t.width,o=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(o+=.5*n.bottom),l(n.right,s,a,i,o));function l(u,f,h,p,d){e.getDocument().setLineWidth(u),e.getDocument().line(f,h,p,d,"S")}}function DP(e,t,r,n){var s=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(s+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-s}function x0(e,t,r,n,s,a){s===void 0&&(s=[]),a===void 0&&(a=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(o){return gl(e,t,o,n,s)}),t.callEndPageHooks(e,n);var i=t.settings.margin;kP(e,t,r,n),RP(e),t.pageNumber++,n.x=i.left,n.y=i.top,r.y=i.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(o){return gl(e,t,o,n,s)}),e.applyStyles(e.userStyles))}function RP(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Xee(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],s=TP(this,n),a=LP(this,s);return FP(this,a),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,s){bP(t,r,n,s,this)},e.API.autoTableSetDefaults=function(t){return ad.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){ad.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var s=new ad(this),a=jP(s,t,window,r,!1),i=a.head,o=a.body,l=((n=i[0])===null||n===void 0?void 0:n.map(function(u){return u.content}))||[];return{columns:l,rows:o,data:o}}}var qv;function Gg(e,t){var r=TP(e,t),n=LP(e,r);FP(e,n)}try{if(typeof window<"u"&&window){var tE=window,rE=tE.jsPDF||((qv=tE.jspdf)===null||qv===void 0?void 0:qv.jsPDF);rE&&Xee(rE)}}catch(e){console.error("Could not apply autoTable plugin",e)}function Jee(e){const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const l=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],u=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],f=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return l[o];if(o>=10&&o<20)return u[o-10];const h=Math.floor(o/10),p=o%10;if(h===7||h===9){const d=f[h],m=10+p;return m<20?d+"-"+u[m-10]:d+"-"+l[p]}return h===8?p===0?"quatre-vingts":"quatre-vingt-"+l[p]:p===0?f[h]:p===1&&h===2?"vingt et un":p===1&&(h===3||h===4||h===5||h===6)?f[h]+" et un":f[h]+"-"+l[p]},s=o=>{if(o===0)return"";const l=Math.floor(o/100),u=o%100;let f="";return l>1?(f=n(l)+" cent",u===0&&(f+="s")):l===1&&(f="cent"),u>0&&(f&&(f+=" "),f+=n(u)),f};let i=(o=>{if(o===0)return"zro";const l=Math.floor(o/1e6),u=Math.floor(o%1e6/1e3),f=o%1e3;let h="";return l>0&&(l===1?h+="un million":h+=s(l)+" millions"),u>0&&(h&&(h+=" "),u===1?h+="mille":h+=s(u)+" mille"),f>0&&(h&&(h+=" "),h+=s(f)),h})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i}async function Qee(e,t,r,n,s,a,i,o,l,u=[]){const f=new jt("portrait","mm","a4"),h=f.internal.pageSize.width,p=f.internal.pageSize.height;let d=15;f.setFontSize(10),f.setFont("helvetica","bold"),f.text("ROYAUME DU MAROC",55,d,{align:"center"}),d+=5,f.setFontSize(9),f.setFont("helvetica","normal"),f.text("MINISTERE DE L'AGRICULTURE ET DE LA PECHE MARITIME",55,d,{align:"center"}),d+=4,f.text("DU DEVELOPPEMENT RURAL ET DES EAUX ET FORETS",55,d,{align:"center"}),d+=4,f.text("DIRECTION PROVINCIALE DE L'AGRICULTURE",55,d,{align:"center"}),d+=4,f.text("TATA",55,d,{align:"center"}),d+=10;const m=h-60;if(f.setFontSize(8),f.setFont("helvetica","bold"),f.text("EXER: "+e.annee,m+2,20),f.text("Chapitre: "+(e.chapitre||""),m+2,25),f.text("Programme: "+(e.programme||""),m+2,30),f.text("Projet: "+(e.projet||""),m+2,35),f.text("Ligne: "+(e.ligne||""),m+2,40),d=55,f.setFontSize(10),f.setFont("helvetica","bold"),e.typeMarche==="negocie"){const _="MARCHE NEGOCIE N"+e.marcheNo;f.text(_,h/2,d,{align:"center"});const R=f.getTextWidth(_),I=(h-R)/2;f.setLineWidth(.3),f.line(I,d+1,I+R,d+1)}else f.text("MARCHE N"+e.marcheNo,h/2,d,{align:"center"});d+=6,f.setFontSize(9),f.setFont("helvetica","normal"),f.splitTextToSize(e.objet,h-20).forEach(_=>{f.text(_,h/2,d,{align:"center"}),d+=5}),d+=5,f.setFontSize(9),f.setFont("helvetica","normal");const w=d;e.societe&&(f.text("Socit: "+e.societe,10,d),d+=5),e.rc&&(f.text("R. C. n: "+e.rc,10,d),d+=5),e.cb&&(f.text("C.B n: "+e.cb,10,d),d+=5),e.cnss&&(f.text("C.N.S.S. n: "+e.cnss,10,d),d+=5),e.patente&&(f.text("Patente: "+e.patente,10,d),d+=5);const x=h-70,y=60;f.rect(x,w-4,y,12),f.setFont("helvetica","bold"),f.setFontSize(8),f.text("Montant de l'acompte en Dhs:",x+y/2,w,{align:"center"}),f.setFontSize(10),f.text(s.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2}),x+y/2,w+5,{align:"center"}),d===w?d+=10:d+=5,f.setFont("helvetica","bold"),f.setFontSize(11);const S=t.isDecompteDernier?" et dernier":"";f.text("DECOMPTE PROVISOIRE N"+t.numero+S,h/2,d,{align:"center"}),d+=5,f.setFont("helvetica","normal"),f.setFontSize(9);const T=`Des travaux excuts au: ${new Date(t.dateFin).toLocaleDateString("fr-FR")}`;f.text(T,h/2,d,{align:"center"}),d+=10;const L=n.map(_=>[_.prixNo,_.designation,_.unite,_.quantiteRealisee.toFixed(2),_.prixUnitaireHT.toFixed(2),(_.quantiteRealisee*_.prixUnitaireHT).toFixed(2)]);let A=0,D=0,C=0,O=0,E=0;Gg(f,{startY:d,head:[["Prix N","DESIGNATIONS DES PRESTATIONS","U","Quantit",`Prix U En DH
hors TVA`,`Prix Total En DH
hors TVA`]],body:L,foot:[[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral Hors TVA",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:i.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:`Total TVA (${a}%)`,colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:o.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}],[{content:"",colSpan:3,styles:{halign:"left"}},{content:"Total Gnral (T.T.C)",colSpan:2,styles:{halign:"right",fontStyle:"bold"}},{content:l.toLocaleString("fr-MA",{minimumFractionDigits:2}),styles:{halign:"right",fontStyle:"bold"}}]],theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold",halign:"center"},footStyles:{fillColor:[255,255,255],textColor:0,fontStyle:"bold"},tableLineWidth:.1,tableLineColor:[200,200,200],willDrawCell:_=>{_.section==="foot"&&_.column.index<3&&(_.cell.styles.lineWidth=0,_.cell.styles.lineColor=[255,255,255])},didDrawCell:_=>{_.section==="body"&&_.row.index===_.table.body.length-1&&_.column.index===0&&(O=_.cell.y+_.cell.height),_.section==="body"&&_.row.index===_.table.body.length-1&&_.column.index===3&&(A=_.cell.x),_.section==="body"&&_.row.index===_.table.body.length-1&&_.column.index===5&&(D=_.cell.x+_.cell.width),_.section==="body"&&_.row.index===0&&_.column.index===0&&(E=_.cell.x),_.section==="foot"&&_.row.index===2&&_.column.index===3&&(C=_.cell.y+_.cell.height),_.section==="foot"&&_.column.index>=3&&(f.setDrawColor(200,200,200),f.setLineWidth(.1),f.rect(_.cell.x,_.cell.y,_.cell.width,_.cell.height))},didDrawPage:()=>{},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:12,halign:"center"},3:{cellWidth:20,halign:"right"},4:{cellWidth:25,halign:"right"},5:{cellWidth:30,halign:"right"}}}),f.setDrawColor(200,200,200),f.setLineWidth(.1),f.line(A,O,A,C),f.line(D,O,D,C),f.line(E,O,A,O),f.setDrawColor(255,255,255),f.setLineWidth(1),f.line(E,O+.5,E,C+.5),f.line(E,C,A,C),f.addPage(),d=20,f.setFontSize(9),f.setFont("helvetica","normal");const P=e.osc?new Date(e.osc).toLocaleDateString("fr-FR"):"../../....";f.text("Ordre de service de commencer les travaux du: "+P,10,d),d+=10,f.text("Dlais d'excution: "+(e.delaisExecution||"10")+" mois",10,d),d+=5,console.log(" PDF - Dcomptes prcdents reus:",u),u&&u.length>0?(console.log(" PDF - Affichage de",u.length,"dcomptes prcdents"),u.forEach(_=>{f.setFontSize(9),f.setFont("helvetica","normal");const R=_.isDecompteDernier?" et dernier":"",I=`D.P.n ${_.numero}${R} du ${_.date} montant: ${_.montant.toLocaleString("fr-MA",{minimumFractionDigits:2,maximumFractionDigits:2})} DH`;console.log(" PDF - Ligne:",I),f.text(I,10,d),d+=5})):console.log(" PDF - Aucun dcompte prcdent  afficher");const q=t.isDecompteDernier?" et dernier":"",M=`D.P.n ${t.numero}${q} du ${new Date(t.dateFin).toLocaleDateString("fr-FR")} montant: ${s.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2})} DH`;f.text(M,10,d),d+=9,f.setFont("helvetica","bold"),f.setFontSize(11),f.text("RECAPITULATION",h/2,d,{align:"center"}),d+=10;const ne=t.isDecompteDernier?[["Travaux termins",s.travauxTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxTermines-s.retenueGarantie).toFixed(2)],["Travaux non termins","0,00","",""],["Approvisionnements",s.approvisionnements.toFixed(2),"",""]]:[["Travaux termins",s.travauxTermines.toFixed(2),"",""],["Travaux non termins",s.travauxNonTermines.toFixed(2),s.retenueGarantie.toFixed(2),(s.travauxNonTermines-s.retenueGarantie).toFixed(2)],["Approvisionnements",s.approvisionnements.toFixed(2),"",""]];Gg(f,{startY:d,head:[["NATURE DES DEPENSES","MONTANTS","RETENUE DE","RESTES"]],body:ne,foot:[[{content:"TOTAUX",styles:{fontStyle:"bold"}},{content:s.totalAvantRetenue.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.retenueGarantie.toFixed(2),styles:{halign:"right",fontStyle:"bold"}},{content:s.resteAPayer.toFixed(2),styles:{halign:"right",fontStyle:"bold"}}],[{content:" dduire les dpenses imputes sur exercices antrieurs",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.depensesExercicesAnterieurs.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Reste  payer sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:s.resteAPayer.toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:" dduire le montant des acomptes dlivrs sur l'exercice en cours",colSpan:3,styles:{fillColor:[255,255,255],textColor:0}},{content:(s.totalADeduire-s.depensesExercicesAnterieurs).toFixed(2),styles:{fillColor:[255,255,255],textColor:0,halign:"right"}}],[{content:"Montant de l'acompte  dlivrer:",colSpan:3,styles:{fontStyle:"bold",fillColor:[255,255,255],textColor:0}},{content:s.montantAcompte.toFixed(2),styles:{fontStyle:"bold",fontSize:10,fillColor:[255,255,255],textColor:0,halign:"right"}}]],theme:"grid",styles:{fontSize:9,cellPadding:3},headStyles:{fillColor:[240,240,240],textColor:0,fontStyle:"bold"},footStyles:{fillColor:[255,255,255],textColor:0},didDrawCell:_=>{_.section==="foot"&&(f.setDrawColor(200,200,200),f.setLineWidth(.1),f.rect(_.cell.x,_.cell.y,_.cell.width,_.cell.height))},columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:35,halign:"right"},2:{cellWidth:35,halign:"right"},3:{cellWidth:35,halign:"right"}}}),d=f.lastAutoTable.finalY+10,f.setFontSize(8),f.setFont("helvetica","italic"),f.splitTextToSize("Dress par 1. Le responsable du Service d'Amnagement Hydro-Agricole ou son reprsentant  et 2. Le Chef de Mission AT Gzouli Ingnieur Conseil; responsable de suivi des travaux, qui certifie que les quantits portes au prsent dcompte correspondent aux travaux rellement excuts conformment aux plans et aux stipulations du march.",h-20).forEach(_=>{d>p-40&&(f.addPage(),d=20),f.text(_,10,d),d+=4}),d+=10,f.setFontSize(9),f.setFont("helvetica","normal"),f.text("1-",10,d),f.text("2-",h/2,d),d+=20,f.text("Vu et vrifi",10,d),d+=25,f.setFillColor(255,255,255),f.rect(10,d,h-20,15,"F"),f.setDrawColor(0),f.setLineWidth(.2),f.rect(10,d,h-20,15,"S"),f.setFont("helvetica","normal"),f.setFontSize(9),f.setTextColor(0);const re=`Arrt par nous, Sous-Ordonnateur,  la somme de: ${Jee(s.montantAcompte)}`,G=f.splitTextToSize(re,h-25);let ge=d+5;G.forEach(_=>{f.text(_,12,ge),ge+=4}),d+=20,f.text("A Tata, Le:",10,d),d+=10,f.text("Tata, le:",h/2,d);const ve=`Decompte_${e.marcheNo}_Periode_${t.numero}_${new Date().toISOString().split("T")[0]}.pdf`;f.save(ve)}const en=e=>Math.round(e*100)/100,nE=()=>{const{projectId:e,periodeId:t}=Ld(),r=Os(),n=Rn(W=>W.user),[s,a]=ee.useState(!1),[i,o]=ee.useState([]),[l,u]=ee.useState(20),[f,h]=ee.useState(10),[p,d]=ee.useState(0),[m,g]=ee.useState(0),w=e!=null&&e.includes(":")?e:`project:${e}`,x=t!=null&&t.includes(":")?t:`periode:${t}`,y=(t==null?void 0:t.replace("periode:",""))||"",{project:b,isLoading:S}=Bd(w),{bordereau:T,isLoading:L}=_p(w),{periodes:A,isLoading:D}=Tx(w),{metres:C,isLoading:O}=Cx(w,x),{decompts:E,isLoading:P,refresh:q}=AT(w),M=ee.useMemo(()=>!A||!x?null:A.find(W=>W.id===x||W.id===y||W.id===`periode:${y}`)||null,[A,x,y]),ne=ee.useMemo(()=>C||[],[C]),fe=ee.useMemo(()=>!E||!x?null:E.find(W=>W.periodeId===x||W.periodeId===y||W.periodeId===`periode:${y}`)||null,[E,x,y]),me=S||L||D||O||P;ee.useEffect(()=>{M&&(u(M.tauxTVA??20),h(M.tauxRetenue??10),g(en(M.depensesExercicesAnterieurs??0)),d(en(M.decomptesPrecedents??0)))},[M]),ee.useEffect(()=>{(async()=>{if(!M||!w||!b||!E||!A)return;const se=E.filter(je=>je.numero<M.numero);if(console.log(" Calculating previous payments:",{projectId:w,currentPeriodeNumero:M.numero,allDecomptesCount:E.length,previousDecomptesCount:se.length,decomptes:se.map(je=>({numero:je.numero,montant:je.montantTotal}))}),se.length===0){g(0),d(0);return}const pe=new Date(M.dateDebut).getFullYear();let he=0,de=0;for(const je of se){const Y=A.find(J=>J.id===je.periodeId||J.id===je.periodeId.replace("periode:","")||`periode:${J.id}`===je.periodeId);if(!Y){console.warn(" Priode not found for dcompte:",je.id);continue}const We=new Date(Y.dateDebut).getFullYear(),Ke=je.montantTotal||0;console.log(" Dcompte:",{numero:je.numero,anneeDecompt:We,anneePeriodeActuelle:pe,montant:Ke}),We<pe?he+=Ke:We===pe&&(de+=Ke)}console.log(" Calculated totals:",{totalExercicesAnterieurs:he,totalExerciceEnCours:de}),g(en(he)),d(en(de))})()},[M,w,b,E,A]);const re=W=>W?W.replace(/^bordereau:/,""):"";ee.useEffect(()=>{if(T&&ne.length>0){const W=re(T.id),se=T.lignes.map(pe=>{const he=`${W}-ligne-${pe.numero}`,de=ne.find(Ke=>re(Ke.bordereauLigneId)===he),je=en((de==null?void 0:de.totalCumule)||(de==null?void 0:de.totalPartiel)||0),Y=en(pe.prixUnitaire||0),We=en(je*Y);return{prixNo:pe.numero,designation:pe.designation,unite:pe.unite,quantiteBordereau:pe.quantite,quantiteRealisee:je,prixUnitaireHT:Y,montantHT:We,bordereauLigneId:he,metreId:de==null?void 0:de.id}});o(se)}else if(T&&ne.length===0){const W=re(T.id),se=T.lignes.map(pe=>{const he=en(pe.prixUnitaire||0);return{prixNo:pe.numero,designation:pe.designation,unite:pe.unite,quantiteBordereau:pe.quantite,quantiteRealisee:0,prixUnitaireHT:he,montantHT:0,bordereauLigneId:`${W}-ligne-${pe.numero}`}});o(se)}},[T,ne]);const G=en(i.reduce((W,se)=>W+se.montantHT,0)),ge=en(G*l/100),ve=en(G+ge),R=(()=>{let W=0,se=0;M!=null&&M.isDecompteDernier?(W=ve,se=0):(W=0,se=ve);const pe=0,he=ve,de=en((T==null?void 0:T.lignes.reduce((it,qe)=>{const ht=en(qe.quantite*(qe.prixUnitaire||0));return it+en(ht*1.2)},0))||0),je=en(ve*.1),Y=en(de*.07),We=en(Math.min(je,Y)),Ke=en(he-We),J=en(Ke-m),ze=en(m+p),He=en(J-p);return{travauxTermines:W,travauxNonTermines:se,approvisionnements:pe,totalAvantRetenue:he,retenueGarantie:We,resteAPayer:J,depensesExercicesAnterieurs:m,totalADeduire:ze,montantAcompte:He}})();ee.useEffect(()=>{(async()=>{if(!n||!w||!x||!M||!fe||i.length===0)return;const se=new Date().toISOString(),pe=R.montantAcompte;if(fe.montantTotal!==pe||fe.totalTTC!==ve){const he={lignes:i,montantTotal:pe,totalTTC:ve,updatedAt:se};if(It())try{const de=fe.id.replace("decompt:","");await Rt.updateDecompt(de,he),console.log(" Dcompte mis  jour automatiquement (Web):",pe,"TTC:",ve)}catch(de){console.error("Error auto-updating dcompte:",de)}else await Le.decompts.update(fe.id,he),console.log(" Dcompte mis  jour automatiquement (Electron):",pe,"TTC:",ve)}})()},[i,R.montantAcompte,fe,n,w,x,M,ve]);const I=async()=>{if(!(!n||!w||!x||!M)){a(!0);try{const W=new Date().toISOString(),se=x.replace("periode:",""),pe=w.replace("project:",""),he={tauxTVA:l,tauxRetenue:f,depensesExercicesAnterieurs:m,decomptesPrecedents:p,updatedAt:W};if(It()?await Rt.updatePeriode(se,he):(await Le.periodes.update(x,he),await us("UPDATE","periode",se,{tauxTVA:l,tauxRetenue:f,depensesExercicesAnterieurs:m,decomptesPrecedents:p},n.id)),fe){const de={lignes:i,montantTotal:R.montantAcompte,totalTTC:ve,statut:"draft",updatedAt:W};if(It()){const je=fe.id.replace("decompt:","");await Rt.updateDecompt(je,de)}else await Le.decompts.update(fe.id,de),await us("UPDATE","decompt",fe.id.replace("decompt:",""),{montantTotal:R.montantAcompte,lignesCount:i.length},n.id)}else{const de=jr(),je=`decompt:${de}`,Y={id:It()?de:je,projectId:It()?pe:w,periodeId:It()?se:x,userId:n.id.replace("user:",""),numero:M.numero,lignes:i,montantTotal:R.montantAcompte,totalTTC:ve,statut:"draft",createdAt:W,updatedAt:W};It()?await Rt.createDecompt(Y):(await Le.decompts.add({...Y,id:je,projectId:w,periodeId:x}),await us("CREATE","decompt",de,Y,n.id))}It()&&q(),alert("Dcompte enregistr avec succs !")}catch(W){console.error("Erreur lors de la sauvegarde:",W),alert("Erreur lors de la sauvegarde du dcompte")}finally{a(!1)}}},B=async()=>{if(!b||!M||!T||!w){alert("Donnes manquantes pour gnrer le PDF");return}try{console.log(" Recherche des dcomptes prcdents..."),console.log(" Project ID:",w),console.log(" Priode actuelle:",M);const W=E||[];console.log(" TOUS les dcomptes du projet:",W);const se=W.filter(he=>he.numero<M.numero);console.log(" Dcomptes prcdents filtrs:",se);const pe=se.map(he=>{const de=A==null?void 0:A.find(je=>je.id===he.periodeId||je.id===he.periodeId.replace("periode:","")||`periode:${je.id}`===he.periodeId);return console.log(` Priode du dcompte ${he.numero}:`,de),{numero:he.numero,date:de?new Date(de.dateFin).toLocaleDateString("fr-FR"):"",montant:he.montantTotal,isDecompteDernier:(de==null?void 0:de.isDecompteDernier)||!1}});pe.sort((he,de)=>he.numero-de.numero),console.log(" Dcomptes prcdents avec dates (tris):",pe),await Qee(b,M,T,i,R,l,G,ge,ve,pe)}catch(W){console.error("Erreur lors de la gnration du PDF:",W),alert("Erreur lors de la gnration du PDF")}};return me||!b||!M||!T?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):c.jsxs("div",{className:"max-w-7xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>r(`/projects/${e}`),className:"btn-secondary mb-4 flex items-center gap-2",children:[c.jsx(ri,{className:"w-4 h-4"}),"Retour au projet"]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Dcompte Provisoire N",M.numero.toString().padStart(2,"0"),M.isDecompteDernier?" et dernier":""]}),c.jsxs("p",{className:"text-gray-600",children:["Priode: ",M.libelle,"  Des travaux excuts au:"," ",oa(new Date(M.dateFin),"dd/MM/yyyy",{locale:Rb})]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:b.objet})]}),c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("button",{onClick:B,className:"btn-secondary flex items-center gap-2",children:[c.jsx(Md,{className:"w-5 h-5"}),"Exporter PDF"]}),c.jsxs("button",{onClick:I,disabled:s,className:"btn-primary flex items-center gap-2",children:[c.jsx(Hu,{className:"w-5 h-5"}),s?"Enregistrement...":"Enregistrer"]})]})]})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[c.jsx(yn,{className:"w-5 h-5 text-primary-600"}),"Informations du Projet"]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Matre d'ouvrage:"}),c.jsx("p",{className:"text-gray-900",children:"ROYAUME DU MAROC - Ministre de l'Agriculture"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Projet:"}),c.jsx("p",{className:"text-gray-900",children:b.objet})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"March N:"}),c.jsx("p",{className:"text-gray-900",children:b.marcheNo})]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-semibold text-gray-700",children:"Montant du march (TTC):"}),c.jsxs("p",{className:"text-gray-900 font-bold text-primary-600",children:[T.lignes.reduce((W,se)=>{const he=se.quantite*(se.prixUnitaire||0)*1.2;return W+he},0).toLocaleString("fr-MA",{minimumFractionDigits:2})," ","DH"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-blue-100 text-blue-600 rounded-lg",children:c.jsx(ST,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.length}),c.jsx("p",{className:"text-sm text-gray-600",children:"Lignes"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-green-100 text-green-600 rounded-lg",children:c.jsx(_i,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:G.toLocaleString("fr-MA",{maximumFractionDigits:2})}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total HT (DH)"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(ic,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ve.toLocaleString("fr-MA",{maximumFractionDigits:2})}),c.jsx("p",{className:"text-sm text-gray-600",children:"Total TTC (DH)"})]})]})}),c.jsx("div",{className:"card",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-orange-100 text-orange-600 rounded-lg",children:c.jsx(go,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:R.montantAcompte.toLocaleString("fr-MA",{maximumFractionDigits:2})}),c.jsx("p",{className:"text-sm text-gray-600",children:" payer (DH)"})]})]})})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Dsignations des Prestations"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border border-gray-300",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"Prix N"}),c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Dsignation des Prestations"}),c.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700 border-r border-gray-300 w-16",children:"U"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-28",children:"Quantit"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-32",children:"Prix U En DH hors TVA"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-36",children:"Prix Total En DH hors TVA"})]})}),c.jsx("tbody",{className:"divide-y divide-gray-200",children:i.map(W=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-gray-700 font-medium border-r border-gray-200",children:W.prixNo}),c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:W.designation}),c.jsx("td",{className:"px-4 py-3 text-center border-r border-gray-200",children:c.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs font-medium",children:W.unite})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:W.quantiteRealisee.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:W.prixUnitaireHT.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:W.montantHT.toLocaleString("fr-MA",{minimumFractionDigits:2})})]},W.bordereauLigneId))}),c.jsxs("tfoot",{className:"bg-gray-100 border-t-2 border-gray-300",children:[c.jsxs("tr",{children:[c.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral Hors TVA"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:G.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{children:[c.jsxs("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:["Total TVA (",l,"%)"]}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-xl text-primary-600",children:ge.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{className:"bg-primary-50",children:[c.jsx("td",{colSpan:5,className:"px-4 py-3 text-right font-bold text-gray-900",children:"Total Gnral (T.T.C)"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:ve.toLocaleString("fr-MA",{minimumFractionDigits:2})})]})]})]})})]}),c.jsxs("div",{className:"card mb-6",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Rcapitulation"}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border border-gray-300",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700 border-r border-gray-300",children:"Nature des Dpenses"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-40 whitespace-nowrap",children:"Montants"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 border-r border-gray-300 w-48 whitespace-nowrap",children:"Retenue de Garantie"}),c.jsx("th",{className:"px-4 py-3 text-right text-sm font-semibold text-gray-700 w-40 whitespace-nowrap",children:"Restes"})]})}),c.jsxs("tbody",{className:"divide-y divide-gray-200",children:[c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux termins"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:R.travauxTermines.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:M!=null&&M.isDecompteDernier?R.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2}):""}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:M!=null&&M.isDecompteDernier?(R.travauxTermines-R.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2}):""})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Travaux non termins"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:R.travauxNonTermines.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700 border-r border-gray-200",children:M!=null&&M.isDecompteDernier?"":R.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:M!=null&&M.isDecompteDernier?"":(R.travauxNonTermines-R.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 border-r border-gray-200",children:"Approvisionnements"}),c.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),c.jsx("td",{className:"px-4 py-3 border-r border-gray-200"}),c.jsx("td",{className:"px-4 py-3"})]}),c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{className:"px-4 py-3 text-gray-900 font-bold border-r border-gray-200",children:"TOTAUX"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:R.totalAvantRetenue.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900 border-r border-gray-200",children:R.retenueGarantie.toLocaleString("fr-MA",{minimumFractionDigits:2})}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:(R.totalAvantRetenue-R.retenueGarantie).toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire les dpenses imputes sur exercices antrieurs"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:R.depensesExercicesAnterieurs.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:"Reste  payer sur l'exercice en cours"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-gray-900",children:R.resteAPayer.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-semibold border-r border-gray-200",children:" dduire le montant des acomptes dlivrs sur l'exercice en cours"}),c.jsx("td",{className:"px-4 py-3 text-right font-medium text-gray-700",children:p.toLocaleString("fr-MA",{minimumFractionDigits:2})})]}),c.jsxs("tr",{className:"bg-primary-50",children:[c.jsx("td",{colSpan:3,className:"px-4 py-3 text-right text-gray-900 font-bold border-r border-gray-200",children:"Montant de l'acompte  dlivrer:"}),c.jsx("td",{className:"px-4 py-3 text-right font-bold text-2xl text-primary-600",children:R.montantAcompte.toLocaleString("fr-MA",{minimumFractionDigits:2})})]})]})]})}),c.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("p",{className:"text-sm text-blue-900 font-medium",children:["Arrt par nous, Sous-Ordonnateur,  la somme de: ",c.jsx("span",{className:"font-bold",children:Zee(R.montantAcompte)})]})})]}),c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Paramtres du Dcompte"}),c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Taux TVA (%)"}),c.jsx("input",{type:"number",value:l,onChange:W=>u(parseFloat(W.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Retenue de garantie (%)"}),c.jsx("input",{type:"number",value:f,onChange:W=>h(parseFloat(W.target.value)||0),className:"input",min:"0",max:"100",step:"0.1"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dpenses exercices antrieurs (DH)"}),c.jsx("input",{type:"number",value:m,onChange:W=>g(en(parseFloat(W.target.value)||0)),className:"input",min:"0",step:"0.01"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dcomptes prcdents (DH)"}),c.jsx("input",{type:"number",value:p,onChange:W=>d(en(parseFloat(W.target.value)||0)),className:"input",min:"0",step:"0.01"})]})]})]})]})},Zee=e=>{const t=Math.floor(e),r=Math.round((e-t)*100),n=o=>{const l=["","un","deux","trois","quatre","cinq","six","sept","huit","neuf"],u=["dix","onze","douze","treize","quatorze","quinze","seize","dix-sept","dix-huit","dix-neuf"],f=["","","vingt","trente","quarante","cinquante","soixante","soixante","quatre-vingt","quatre-vingt"];if(o===0)return"";if(o<10)return l[o];if(o>=10&&o<20)return u[o-10];const h=Math.floor(o/10),p=o%10;if(h===7||h===9){const d=f[h],m=10+p;return m<20?d+"-"+u[m-10]:d+"-"+l[p]}return h===8?p===0?"quatre-vingts":"quatre-vingt-"+l[p]:p===0?f[h]:p===1&&h===2?"vingt et un":p===1&&(h===3||h===4||h===5||h===6)?f[h]+" et un":f[h]+"-"+l[p]},s=o=>{if(o===0)return"";const l=Math.floor(o/100),u=o%100;let f="";return l>1?(f=n(l)+" cent",u===0&&(f+="s")):l===1&&(f="cent"),u>0&&(f&&(f+=" "),f+=n(u)),f};let i=(o=>{if(o===0)return"zro";const l=Math.floor(o/1e6),u=Math.floor(o%1e6/1e3),f=o%1e3;let h="";return l>0&&(l===1?h+="un million":h+=s(l)+" millions"),u>0&&(h&&(h+=" "),u===1?h+="mille":h+=s(u)+" mille"),f>0&&(h&&(h+=" "),h+=s(f)),h})(t).trim();return i=i.charAt(0).toUpperCase()+i.slice(1),i+=" DIRHAMS",r>0&&(i+=", "+r.toString().padStart(2,"0")+" CTS"),i},sE=()=>{const{projectId:e,periodeId:t}=Ld(),r=Os(),[n,s]=ee.useState(!1),a=(e==null?void 0:e.replace("project:",""))||"",i=t?t.includes(":")?t:`periode:${t}`:null,o=(t==null?void 0:t.replace("periode:",""))||"",{project:l}=Bd(a||null),{bordereau:u}=_p(a||null),{periodes:f}=Tx(a||null),{metres:h}=Cx(a||null,i),p=ee.useMemo(()=>!f||!i?null:f.find(y=>y.id===i||y.id===o||y.id===`periode:${o}`)||null,[f,i,o]),d=ee.useMemo(()=>h||[],[h]),m=y=>y?y.replace(/^bordereau:/,""):"",w=!(u!=null&&u.lignes)||!d?[]:u.lignes.map((y,b)=>{const T=`${m(u.id)}-ligne-${y.numero}`,L=d.find(D=>m(D.bordereauLigneId)===T);let A=0;return(L==null?void 0:L.totalCumule)!==void 0&&(L==null?void 0:L.totalCumule)!==null?A=Number(L.totalCumule)||0:L!=null&&L.lignes&&Array.isArray(L.lignes)&&(A=L.lignes.reduce((D,C)=>D+(Number(C.partiel)||0),0)),{numero:b+1,designation:y.designation,unite:y.unite||"",quantiteCumulee:Number(A)||0}}).filter(y=>y.quantiteCumulee>0),x=async()=>{if(!(!l||!u)){s(!0);try{const y=new jt("p","mm","a4"),b=y.internal.pageSize.getWidth(),S=y.internal.pageSize.getHeight(),T=15;y.setFontSize(12),y.setFont("helvetica","bold"),y.text("Royaume du Maroc",b/2,12,{align:"center"});let L=45;try{const M=new Image;M.crossOrigin="anonymous",await new Promise((me,re)=>{M.onload=()=>me(),M.onerror=()=>re(),M.src="/maroc-logo.png"});const ne=30,fe=M.height/M.width*ne;y.addImage(M,"PNG",(b-ne)/2,16,ne,fe),L=16+fe+4}catch{y.setFillColor(200,200,200),y.circle(b/2,28,12,"F"),L=45}y.setFontSize(9),y.setFont("helvetica","normal");const A=["Ministre de l'Agriculture, de la Pche Maritime,","du Dveloppement Rural et des Eaux et Fort","Direction Provinciale de l'Agriculture de Tata","Service des Amnagement hydro-agricole"];let D=L;A.forEach(M=>{y.text(M,b/2,D,{align:"center"}),D+=4}),D+=2,y.setFont("helvetica","bold"),y.setFontSize(10);const C=l.typeMarche==="negocie"?"MARCHE NEGOCIE":"MARCHE";if(y.text(`${C} N${l.marcheNo}`,b/2,D,{align:"center"}),D+=8,y.setFontSize(9),y.setFont("helvetica","bold"),y.splitTextToSize(l.objet.toUpperCase(),b-2*T).forEach(M=>{y.text(M,b/2,D,{align:"center"}),D+=4}),D+=6,y.setFontSize(12),y.setFont("helvetica","bold"),p){const M=p.isDecompteDernier?" et dernier":"";y.text(`ATTACHEMENT PROVISOIRE  N${p.numero.toString().padStart(2,"0")}${M}`,b/2,D,{align:"center"})}else y.text("ATTACHEMENT DES TRAVAUX",b/2,D,{align:"center"});D+=4,y.setLineWidth(.5),y.line(T,D,b-T,D),D+=6;const E=w.map(M=>[M.numero.toString(),M.designation,M.unite,Number(M.quantiteCumulee).toFixed(2)]);Gg(y,{startY:D,head:[["N","Dsignation des ouvrages","U","Quantit"]],body:E,theme:"grid",styles:{fontSize:9,cellPadding:3,lineColor:[0,0,0],lineWidth:.3},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{cellWidth:15,halign:"center"},1:{cellWidth:"auto"},2:{cellWidth:20,halign:"center"},3:{cellWidth:30,halign:"right"}},didDrawPage:()=>{y.setFontSize(10),y.setFont("helvetica","normal");const M=y.getCurrentPageInfo().pageNumber;y.text(`Page ${M}`,b/2,S-10,{align:"center"})}});const P=y.lastAutoTable.finalY+15;Gg(y,{startY:P,head:[["Etabli par","Accept par","Vrifi par"]],body:[["","",""]],theme:"grid",styles:{fontSize:9,cellPadding:15,lineColor:[0,0,0],lineWidth:.3,minCellHeight:25},headStyles:{fillColor:[255,255,255],textColor:[0,0,0],fontStyle:"bold",halign:"center",lineColor:[0,0,0],lineWidth:.3},columnStyles:{0:{halign:"center"},1:{halign:"center"},2:{halign:"center"}}});const q=p?`Attachement_${l.marcheNo}_P${p.numero}.pdf`:`Attachement_${l.marcheNo}.pdf`;y.save(q)}catch(y){console.error("Erreur export PDF:",y),alert("Erreur lors de l'export PDF")}finally{s(!1)}}};return!l||!u||i&&!p?c.jsx("div",{className:"flex items-center justify-center min-h-96",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin mx-auto mb-4"}),c.jsx("p",{className:"text-gray-500",children:"Chargement..."})]})}):c.jsxs("div",{className:"max-w-5xl mx-auto",children:[c.jsxs("div",{className:"mb-6",children:[c.jsxs("button",{onClick:()=>{r(i?`/projects/${a}/metre/${o}`:`/projects/${a}`)},className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[c.jsx(ri,{className:"w-5 h-5"}),i?"Retour au mtr":"Retour au projet"]}),c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:p?`Attachement Provisoire N ${p.numero.toString().padStart(2,"0")}${p.isDecompteDernier?" et dernier":""}`:"Attachement des Travaux"}),c.jsxs("p",{className:"text-gray-600",children:["March N ",l.marcheNo," - ",l.annee]}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:l.objet})]}),c.jsxs("button",{onClick:x,disabled:n||w.length===0,className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Md,{className:"w-4 h-4"}),n?"Export en cours...":"Exporter PDF"]})]})]}),c.jsxs("div",{className:"card bg-white",children:[c.jsxs("div",{className:"text-center border-b pb-6 mb-6",children:[c.jsx("h2",{className:"text-lg font-bold mb-3",children:"Royaume du Maroc"}),c.jsx("img",{src:"/maroc-logo.png",alt:"Emblme du Royaume du Maroc",className:"h-24 mx-auto mb-3",onError:y=>{y.target.style.display="none"}}),c.jsx("p",{className:"text-sm text-gray-600",children:"Ministre de l'Agriculture, de la Pche Maritime,"}),c.jsx("p",{className:"text-sm text-gray-600",children:"du Dveloppement Rural et des Eaux et Fort"}),c.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Direction Provinciale de l'Agriculture de Tata"}),c.jsxs("p",{className:"font-bold text-sm mb-2",children:[l.typeMarche==="negocie"?"MARCHE NEGOCIE":"MARCHE"," N",l.marcheNo]}),c.jsx("p",{className:"text-sm font-semibold text-gray-800 mb-4 px-8",children:l.objet.toUpperCase()}),c.jsx("h3",{className:"text-lg font-bold border-t border-b py-2 inline-block px-8",children:p?`ATTACHEMENT PROVISOIRE N${p.numero.toString().padStart(2,"0")}${p.isDecompteDernier?" et dernier":""}`:"ATTACHEMENT DES TRAVAUX"})]}),w.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full border-collapse border border-gray-400",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"bg-gray-50",children:[c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-16",children:"N"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-left font-semibold",children:"Dsignation des ouvrages"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-center font-semibold w-20",children:"U"}),c.jsx("th",{className:"border border-gray-400 px-4 py-3 text-right font-semibold w-32",children:"Quantit"})]})}),c.jsx("tbody",{children:w.map(y=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:y.numero}),c.jsx("td",{className:"border border-gray-400 px-4 py-2",children:y.designation}),c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-center",children:y.unite}),c.jsx("td",{className:"border border-gray-400 px-4 py-2 text-right font-medium",children:Number(y.quantiteCumulee).toFixed(2)})]},y.numero))})]})}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx(yn,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Aucune quantit saisie"}),c.jsx("p",{className:"text-gray-600",children:"Saisissez d'abord les quantits dans le mtr pour gnrer l'attachement"})]}),w.length>0&&c.jsx("div",{className:"mt-8 pt-6 border-t",children:c.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Etabli par"}),c.jsx("div",{className:"h-16"})]}),c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Accept par"}),c.jsx("div",{className:"h-16"})]}),c.jsxs("div",{className:"border border-gray-400 p-4 text-center",children:[c.jsx("p",{className:"font-semibold mb-8",children:"Vrifi par"}),c.jsx("div",{className:"h-16"})]})]})})]})]})},ete=()=>{const{t:e,i18n:t}=Ii(),[r,n]=ee.useState(Fp()),[s,a]=ee.useState(localStorage.getItem("base_folder_name")),[i,o]=ee.useState(!1),[l,u]=ee.useState("storage"),f=[{type:"local",name:"Stockage Local",description:"Enregistrez vos projets sur votre ordinateur",icon:lB,available:!0},{type:"onedrive",name:"OneDrive",description:"Synchronisez avec Microsoft OneDrive",icon:gS,available:!1,comingSoon:!0},{type:"google-drive",name:"Google Drive",description:"Synchronisez avec Google Drive",icon:gS,available:!1,comingSoon:!0}],h=async()=>{const g=await lJ();g&&(a(g),n(w=>({...w,basePath:g})))},p=()=>{S8(r),o(!0),setTimeout(()=>o(!1),2e3)},d=g=>{const w=f.find(x=>x.type===g);w!=null&&w.available&&n(x=>({...x,type:g}))},m="showDirectoryPicker"in window;return c.jsxs("div",{className:"max-w-4xl mx-auto",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[c.jsx(Lw,{className:"w-8 h-8 text-primary-600"}),e("settings.title")]}),c.jsx("p",{className:"text-gray-600 mt-2",children:"Configurez les paramtres de l'application"})]}),c.jsxs("div",{className:"flex gap-6",children:[c.jsx("div",{className:"w-64 flex-shrink-0",children:c.jsxs("nav",{className:"space-y-1",children:[c.jsxs("button",{onClick:()=>u("storage"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="storage"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx($m,{className:"w-5 h-5"}),"Stockage des fichiers",c.jsx(il,{className:"w-4 h-4 ml-auto"})]}),c.jsxs("button",{onClick:()=>u("general"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="general"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(Lw,{className:"w-5 h-5"}),"Paramtres gnraux",c.jsx(il,{className:"w-4 h-4 ml-auto"})]}),c.jsxs("button",{onClick:()=>u("about"),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-left transition-colors ${l==="about"?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(xS,{className:"w-5 h-5"})," propos",c.jsx(il,{className:"w-4 h-4 ml-auto"})]})]})}),c.jsxs("div",{className:"flex-1",children:[l==="storage"&&c.jsxs("div",{className:"card",children:[c.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[c.jsx($m,{className:"w-6 h-6 text-primary-600"}),"Configuration du stockage"]}),c.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:c.jsxs("div",{className:"flex gap-3",children:[c.jsx(xS,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{children:[c.jsx("p",{className:"text-blue-800 font-medium",children:"Comment a fonctionne ?"}),c.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Choisissez un emplacement o tous vos dossiers de projets seront crs automatiquement. Chaque projet aura sa propre structure de dossiers organise (Bordereau, Mtr, Dcomptes, etc.)."})]})]})}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Type de stockage"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.map(g=>{const w=g.icon;return c.jsxs("button",{onClick:()=>d(g.type),disabled:!g.available,className:`relative p-4 rounded-lg border-2 text-left transition-all ${r.type===g.type?"border-primary-500 bg-primary-50":g.available?"border-gray-200 hover:border-gray-300":"border-gray-200 bg-gray-50 opacity-60 cursor-not-allowed"}`,children:[g.comingSoon&&c.jsx("span",{className:"absolute top-2 right-2 px-2 py-0.5 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-full",children:"Bientt"}),c.jsx(w,{className:`w-8 h-8 mb-2 ${r.type===g.type?"text-primary-600":"text-gray-400"}`}),c.jsx("p",{className:`font-medium ${r.type===g.type?"text-primary-900":"text-gray-900"}`,children:g.name}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:g.description}),r.type===g.type&&c.jsx("div",{className:"absolute top-2 left-2",children:c.jsx(mS,{className:"w-5 h-5 text-primary-600"})})]},g.type)})})]}),r.type==="local"&&c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dossier de base"}),m?c.jsxs("div",{className:"flex gap-3",children:[c.jsxs("div",{className:"flex-1 flex items-center gap-3 px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx(Pw,{className:"w-5 h-5 text-gray-400"}),c.jsx("span",{className:s?"text-gray-900":"text-gray-500",children:s||"Aucun dossier slectionn"})]}),c.jsxs("button",{onClick:h,className:"btn-primary flex items-center gap-2",children:[c.jsx($m,{className:"w-4 h-4"}),"Choisir un dossier"]})]}):c.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:c.jsxs("p",{className:"text-yellow-800 text-sm",children:[c.jsx("strong",{children:"Note :"})," Votre navigateur ne supporte pas la slection de dossiers. Les fichiers seront tlchargs dans votre dossier de tlchargements par dfaut.",c.jsx("br",{}),c.jsx("span",{className:"text-yellow-700",children:"Pour une meilleure exprience, utilisez Chrome, Edge ou Opera."})]})})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Structure des dossiers"}),c.jsxs("div",{className:"bg-gray-900 text-gray-100 rounded-lg p-4 font-mono text-sm",children:[c.jsxs("div",{className:"text-yellow-400",children:[" ",s||"MesProjetsBTP","/"]}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-blue-400",children:" 2025/"}),c.jsxs("div",{className:"ml-4",children:[c.jsx("div",{className:"text-green-400",children:" 12-2025-dpa-ta/"}),c.jsxs("div",{className:"ml-4 text-gray-400",children:[c.jsx("div",{children:" Bordereau/"}),c.jsx("div",{children:" Mtr/"}),c.jsx("div",{children:" Dcomptes/"}),c.jsx("div",{children:" Attachements/"}),c.jsx("div",{children:" Photos/"}),c.jsx("div",{children:" PV/"}),c.jsx("div",{children:" Documents/"})]})]})]})]})]})]}),c.jsx("div",{className:"mt-6 pt-6 border-t flex justify-end",children:c.jsx("button",{onClick:p,className:"btn-primary flex items-center gap-2",children:i?c.jsxs(c.Fragment,{children:[c.jsx(mS,{className:"w-4 h-4"}),"Enregistr !"]}):c.jsxs(c.Fragment,{children:[c.jsx(Hu,{className:"w-4 h-4"}),"Enregistrer les paramtres"]})})})]}),l==="general"&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Paramtres gnraux"}),c.jsxs("div",{className:"mb-6",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Langue de l'interface"}),c.jsx("div",{className:"flex gap-2",children:[{code:"fr",label:"Franais",flag:""},{code:"ar",label:"",flag:""},{code:"en",label:"English",flag:""}].map(g=>c.jsxs("button",{onClick:()=>t.changeLanguage(g.code),className:`flex items-center gap-2 px-4 py-2 rounded-lg border-2 transition-colors ${t.language===g.code?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("span",{className:"text-xl",children:g.flag}),c.jsx("span",{children:g.label})]},g.code))})]}),c.jsx("div",{className:"mb-6",children:c.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[c.jsx("input",{type:"checkbox",className:"w-5 h-5 rounded border-gray-300 text-primary-600 focus:ring-primary-500",defaultChecked:!0}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Sauvegarde automatique"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Enregistrer automatiquement les modifications"})]})]})}),c.jsxs("div",{className:"pt-6 border-t",children:[c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Gestion des donnes"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[c.jsx(xo,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Exporter toutes les donnes"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Tlcharger une sauvegarde complte"})]})]}),c.jsxs("button",{className:"flex items-center gap-3 px-4 py-3 w-full text-left rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[c.jsx($m,{className:"w-5 h-5 text-gray-400"}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium text-gray-900",children:"Importer des donnes"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Restaurer depuis une sauvegarde"})]})]})]})]})]}),l==="about"&&c.jsxs("div",{className:"card",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:" propos"}),c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"w-20 h-20 bg-primary-100 rounded-2xl flex items-center justify-center mx-auto mb-4",children:c.jsx(Pw,{className:"w-10 h-10 text-primary-600"})}),c.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Suivi Chantier BTP"}),c.jsx("p",{className:"text-gray-500 mt-1",children:"Version 1.0.0"}),c.jsxs("div",{className:"mt-6 text-sm text-gray-600",children:[c.jsx("p",{children:"Application de gestion de projets BTP"}),c.jsxs("p",{className:"mt-2",children:["Dvelopp pour simplifier la gestion des marchs,",c.jsx("br",{}),"des mtrs, des dcomptes et des attachements."]})]}),c.jsx("div",{className:"mt-8 pt-6 border-t text-sm text-gray-500",children:c.jsx("p",{children:" 2025 - Tous droits rservs"})})]})]})]})]})]})};function tte(){const e=Os(),{user:t}=Rn(),[r,n]=ee.useState({totalUsers:0,activeUsers:0,trialUsers:0,expiredTrials:0}),[s,a]=ee.useState([]),[i,o]=ee.useState(!0);ee.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}l()},[t,e]);const l=async()=>{try{const f=await Le.users.toArray(),h=await Le.auditLogs.orderBy("timestamp").reverse().limit(10).toArray(),p=new Date,d=f.filter(w=>w.isActive).length,m=f.filter(w=>w.trialEndDate&&new Date(w.trialEndDate)>p).length,g=f.filter(w=>w.trialEndDate&&new Date(w.trialEndDate)<=p).length;n({totalUsers:f.length,activeUsers:d,trialUsers:m,expiredTrials:g}),a(h),o(!1)}catch(f){console.error("Error loading dashboard data:",f),o(!1)}},u=f=>({create_user:"Utilisateur cr",disable_user:"Utilisateur dsactiv",enable_user:"Utilisateur activ",delete_user:"Utilisateur supprim",extend_trial:"Essai prolong",update_role:"Rle modifi"})[f]||f;return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ri,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-purple-100 text-purple-600 rounded-lg",children:c.jsx(jg,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Tableau de bord Admin"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Vue d'ensemble du systme"})]})]})]}),c.jsxs("button",{onClick:()=>e("/admin/users"),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Fw,{className:"w-4 h-4"}),"Grer les utilisateurs"]})]})})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[c.jsx(l1,{title:"Total Utilisateurs",value:r.totalUsers,icon:Fw,color:"blue"}),c.jsx(l1,{title:"Utilisateurs Actifs",value:r.activeUsers,icon:jg,color:"green"}),c.jsx(l1,{title:"Priodes d'essai",value:r.trialUsers,icon:Pb,color:"yellow"}),c.jsx(l1,{title:"Essais Expirs",value:r.expiredTrials,icon:Za,color:"red"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx(eB,{className:"w-5 h-5 text-gray-400"}),c.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activit Rcente"})]})}),c.jsx("div",{className:"divide-y divide-gray-200",children:s.length===0?c.jsx("div",{className:"px-6 py-12 text-center text-gray-500",children:"Aucune activit rcente"}):s.map(f=>c.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[c.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.userEmail}),c.jsx("span",{className:"text-sm text-gray-500",children:""}),c.jsx("span",{className:"text-sm text-gray-600",children:u(f.action)})]}),f.details&&c.jsxs("div",{className:"text-sm text-gray-500",children:[f.details.email&&c.jsxs("span",{children:["Email: ",f.details.email]}),f.details.role&&c.jsxs("span",{className:"ml-3",children:["Rle: ",f.details.role]})]})]}),c.jsx("div",{className:"text-xs text-gray-400",children:oa(new Date(f.timestamp),"dd MMM yyyy HH:mm",{locale:Rb})})]})},f.id))})]})]})]})}function l1({title:e,value:t,icon:r,color:n}){const s={blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",yellow:"bg-yellow-100 text-yellow-600",red:"bg-red-100 text-red-600"};return c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex items-center justify-between mb-4",children:c.jsx("div",{className:`p-3 rounded-lg ${s[n]}`,children:c.jsx(r,{className:"w-6 h-6"})})}),c.jsxs("div",{className:"space-y-1",children:[c.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t}),c.jsx("p",{className:"text-sm text-gray-600",children:e})]})]})}function rte(){const e=Os(),{user:t}=Rn(),[r,n]=ee.useState([]),[s,a]=ee.useState(!1),[i,o]=ee.useState(!0);ee.useEffect(()=>{if((t==null?void 0:t.role)!=="super_admin"){e("/");return}l()},[t,e]);const l=async()=>{try{const p=await Le.users.toArray();n(p.filter(d=>!d.email.includes("deleted"))),o(!1)}catch(p){console.error("Error loading users:",p),o(!1)}},u=async(p,d,m)=>{const g={id:`audit:${jr()}`,userId:t.id,userEmail:t.email,action:p,entityType:"user",entityId:d,details:m,timestamp:new Date().toISOString()};await Le.auditLogs.add(g)},f=async p=>{try{await Le.users.update(p.id,{isActive:!p.isActive}),await u(p.isActive?"disable_user":"enable_user",p.id,{email:p.email,previousStatus:p.isActive}),l()}catch(d){console.error("Error toggling user status:",d),alert("Erreur lors de la modification du statut")}},h=async p=>{if(confirm(`tes-vous sr de vouloir supprimer ${p.firstName} ${p.lastName}?`))try{await Le.users.delete(p.id),await u("delete_user",p.id,{email:p.email,name:`${p.firstName} ${p.lastName}`}),l()}catch(d){console.error("Error deleting user:",d),alert("Erreur lors de la suppression")}};return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-gray-600",children:"Chargement..."})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white border-b border-gray-200",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex items-center justify-between h-16",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("button",{onClick:()=>e("/"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:c.jsx(ri,{className:"w-5 h-5 text-gray-600"})}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 bg-primary-100 text-primary-600 rounded-lg",children:c.jsx(Fw,{className:"w-6 h-6"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Gestion des Utilisateurs"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[r.length," utilisateurs"]})]})]})]}),c.jsxs("button",{onClick:()=>a(!0),className:"btn btn-primary flex items-center gap-2",children:[c.jsx(Gs,{className:"w-4 h-4"}),"Nouvel Utilisateur"]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Utilisateur"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rle"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Statut"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Priode d'essai"}),c.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map(p=>{const d=p.trialEndDate&&new Date(p.trialEndDate)<new Date,m=p.trialEndDate?Math.ceil((new Date(p.trialEndDate).getTime()-new Date().getTime())/(1e3*60*60*24)):null;return c.jsxs("tr",{className:d?"bg-red-50":"",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsxs("div",{children:[c.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[p.firstName," ",p.lastName]}),c.jsx("div",{className:"text-sm text-gray-500",children:p.email})]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.role==="super_admin"?"bg-purple-100 text-purple-800":p.role==="admin"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:p.role==="super_admin"?"Super Admin":p.role==="admin"?"Admin":"User"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.isActive?"Actif":"Dsactiv"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p.trialEndDate?c.jsx("div",{className:d?"text-red-600 font-medium":"",children:d?"Expir":c.jsxs("span",{children:[m," jours restants"]})}):c.jsx("span",{className:"text-gray-400",children:"-"})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:c.jsx("div",{className:"flex items-center justify-end gap-2",children:p.role!=="super_admin"&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>f(p),className:`p-2 rounded-lg transition-colors ${p.isActive?"hover:bg-red-50 text-red-600":"hover:bg-green-50 text-green-600"}`,title:p.isActive?"Dsactiver":"Activer",children:p.isActive?c.jsx(hB,{className:"w-4 h-4"}):c.jsx(_B,{className:"w-4 h-4"})}),c.jsx("button",{onClick:()=>h(p),className:"p-2 hover:bg-red-50 text-red-600 rounded-lg transition-colors",title:"Supprimer",children:c.jsx(ma,{className:"w-4 h-4"})})]})})})]},p.id)})})]})})}),s&&c.jsx(nte,{onClose:()=>a(!1),onCreated:()=>{a(!1),l()},currentUser:t})]})}function nte({onClose:e,onCreated:t,currentUser:r}){const[n,s]=ee.useState({email:"",password:"",firstName:"",lastName:"",role:"user",trialDays:30,hasTrial:!1}),a=async i=>{i.preventDefault();try{const o=n.hasTrial?new Date(Date.now()+n.trialDays*24*60*60*1e3).toISOString():void 0,l={id:`user:${jr()}`,email:n.email,firstName:n.firstName,lastName:n.lastName,role:n.role,isActive:!0,trialEndDate:o,createdBy:r.id,createdAt:new Date().toISOString()};await Le.users.add(l);const u={id:`audit:${jr()}`,userId:r.id,userEmail:r.email,action:"create_user",entityType:"user",entityId:l.id,details:{email:l.email,role:l.role,hasTrial:n.hasTrial,trialDays:n.trialDays},timestamp:new Date().toISOString()};await Le.auditLogs.add(u),alert(`Utilisateur cr avec succs!
Email: ${n.email}
Mot de passe: ${n.password}

Veuillez communiquer ces informations  l'utilisateur.`),t()}catch(o){console.error("Error creating user:",o),alert("Erreur lors de la cration de l'utilisateur")}};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md",children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nouvel Utilisateur"}),c.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:c.jsx(ri,{className:"w-6 h-6"})})]}),c.jsxs("form",{onSubmit:a,className:"p-6 space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Prnom ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.firstName,onChange:i=>s({...n,firstName:i.target.value}),className:"input w-full",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Nom ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.lastName,onChange:i=>s({...n,lastName:i.target.value}),className:"input w-full",required:!0})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Email ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"email",value:n.email,onChange:i=>s({...n,email:i.target.value}),className:"input w-full",placeholder:"utilisateur@agriculture.gov.ma",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Mot de passe ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsx("input",{type:"text",value:n.password,onChange:i=>s({...n,password:i.target.value}),className:"input w-full",placeholder:"Gnrer un mot de passe fort",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Rle ",c.jsx("span",{className:"text-red-500",children:"*"})]}),c.jsxs("select",{value:n.role,onChange:i=>s({...n,role:i.target.value}),className:"input w-full",children:[c.jsx("option",{value:"user",children:"Utilisateur"}),c.jsx("option",{value:"admin",children:"Administrateur"})]})]}),c.jsxs("div",{className:"flex items-center gap-2 p-3 border border-gray-200 rounded-lg",children:[c.jsx("input",{type:"checkbox",checked:n.hasTrial,onChange:i=>s({...n,hasTrial:i.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),c.jsx("label",{className:"text-sm font-medium text-gray-700 flex-1",children:"Priode d'essai"}),n.hasTrial&&c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("input",{type:"number",value:n.trialDays,onChange:i=>s({...n,trialDays:parseInt(i.target.value)||30}),className:"w-16 px-2 py-1 border border-gray-300 rounded text-sm",min:"1"}),c.jsx("span",{className:"text-sm text-gray-600",children:"jours"})]})]}),c.jsxs("div",{className:"flex gap-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Annuler"}),c.jsx("button",{type:"submit",className:"flex-1 btn btn-primary",children:"Crer"})]})]})]})})}const ste=()=>{const{user:e}=Rn(),[t,r]=ee.useState(null),[n,s]=ee.useState([]),[a,i]=ee.useState(!0),o=ee.useMemo(()=>{if(!(e!=null&&e.id))return[];const f=e.id.includes(":")?e.id.split(":").pop():e.id;return[f,`user:${f}`]},[e==null?void 0:e.id]);ee.useEffect(()=>{(async()=>{if(!(e!=null&&e.id)){s([]),i(!1);return}i(!0);try{if(It()){const h=await Rt.getDeletedProjects();s(h.data||h||[])}else{const p=(await Le.projects.filter(d=>!!d.deletedAt).toArray()).filter(d=>o.includes(d.userId));s(p)}}catch(h){console.error("Error loading deleted projects:",h),s([])}finally{i(!1)}})()},[e==null?void 0:e.id,o]);const l=async f=>{if(e){r(f);try{if(It()){await Rt.restoreProject(f.replace("project:",""));const h=await Rt.getDeletedProjects();s(h.data||h||[])}else{await Rt.restoreProject(f),await Le.projects.update(f,{deletedAt:void 0,updatedAt:new Date().toISOString()}),await us("UPDATE","project",f,{deletedAt:null},e.id);const h=await Le.projects.filter(p=>!!p.deletedAt).toArray();s(h.filter(p=>o.includes(p.userId)))}}catch(h){console.error("Error restoring project:",h),alert("   ")}finally{r(null)}}},u=async f=>{if(!(!e||!confirm("           !"))){r(f);try{if(It()){await Rt.permanentDeleteProject(f.replace("project:",""));const h=await Rt.getDeletedProjects();s(h.data||h||[])}else{await Le.projects.delete(f);const h=await Le.projects.filter(p=>!!p.deletedAt).toArray();s(h.filter(p=>o.includes(p.userId)))}}catch(h){console.error("Error deleting project permanently:",h),alert("    ")}finally{r(null)}}};return a?c.jsx("div",{className:"flex items-center justify-center h-96",children:c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):c.jsxs("div",{className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:c.jsx(ma,{className:"w-6 h-6 text-red-600"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:" "}),c.jsx("p",{className:"text-sm text-gray-500",children:"  "})]})]})}),c.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 flex items-start gap-3",children:[c.jsx(Za,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),c.jsxs("div",{className:"text-sm text-amber-800",children:[c.jsx("p",{className:"font-medium",children:"   "}),c.jsx("p",{className:"mt-1",children:"       .      ."})]})]}),n.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx(ma,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"  "}),c.jsx("p",{className:"text-gray-500",children:"   "})]}):c.jsx("div",{className:"card overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:""}),c.jsx("th",{className:"text-right py-3 px-4 text-sm font-medium text-gray-700",children:" "}),c.jsx("th",{className:"text-center py-3 px-4 text-sm font-medium text-gray-700",children:""})]})}),c.jsx("tbody",{children:n.map(f=>c.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[c.jsxs("td",{className:"py-3 px-4",children:[c.jsx("div",{className:"font-medium text-gray-900",children:f.objet}),f.societe&&c.jsx("div",{className:"text-xs text-gray-500",children:f.societe})]}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:f.marcheNo}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:f.annee}),c.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(Pb,{className:"w-4 h-4 text-gray-400"}),f.deletedAt?oa(new Date(f.deletedAt),"dd/MM/yyyy HH:mm"):"-"]})}),c.jsx("td",{className:"py-3 px-4",children:c.jsxs("div",{className:"flex items-center justify-center gap-2",children:[c.jsxs("button",{onClick:()=>l(f.id),disabled:t===f.id,className:"flex items-center gap-1 px-3 py-1.5 bg-green-50 hover:bg-green-100 text-green-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:"",children:[c.jsx(bB,{className:"w-4 h-4"}),""]}),c.jsxs("button",{onClick:()=>u(f.id),disabled:t===f.id,className:"flex items-center gap-1 px-3 py-1.5 bg-red-50 hover:bg-red-100 text-red-700 rounded-lg text-sm font-medium transition-colors disabled:opacity-50",title:" ",children:[c.jsx(ma,{className:"w-4 h-4"})," "]})]})})]},f.id))})]})})})]})},Gn=({children:e})=>{var p,d;const{t,i18n:r}=Ii(),n=Pd(),s=Os(),{user:a,logout:i}=Rn(),[o,l]=ee.useState(!0),u=()=>{i(),s("/login")},f=m=>{r.changeLanguage(m)},h=[{path:"/",icon:uB,label:t("dashboard.title")},{path:"/projects",icon:Du,label:t("project.projects")},{path:"/delais",icon:pl,label:"Gestion des Dlais"},{path:"/trash",icon:ma,label:" "},{path:"/settings",icon:Lw,label:t("settings.title")}];return(a==null?void 0:a.role)==="super_admin"&&h.splice(2,0,{path:"/admin",icon:jg,label:"Administration"}),c.jsxs("div",{className:"min-h-screen bg-gray-50 flex",children:[c.jsxs("aside",{className:`${o?"w-64":"w-20"} bg-white border-r border-gray-200 transition-all duration-300 relative flex flex-col`,children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[o&&c.jsx("h1",{className:"text-xl font-bold text-primary-600",children:t("app.title")}),c.jsx("button",{onClick:()=>l(!o),className:"p-2 hover:bg-gray-100 rounded-lg",children:c.jsx(gB,{className:"w-5 h-5"})})]}),c.jsx("nav",{className:"p-4 space-y-2 flex-1 overflow-y-auto",children:h.map(m=>{const g=m.icon,w=n.pathname===m.path;return c.jsxs(ji,{to:m.path,className:`flex items-center gap-3 px-3 py-2 rounded-lg transition-colors ${w?"bg-primary-50 text-primary-600":"text-gray-700 hover:bg-gray-100"}`,children:[c.jsx(g,{className:"w-5 h-5 flex-shrink-0"}),o&&c.jsx("span",{children:m.label})]},m.path)})}),c.jsxs("div",{className:"p-4 border-t mt-auto",children:[c.jsxs("div",{className:"mb-4",children:[o&&c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>f("fr"),className:`px-3 py-1 text-sm rounded ${r.language==="fr"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"FR"}),c.jsx("button",{onClick:()=>f("ar"),className:`px-3 py-1 text-sm rounded ${r.language==="ar"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"AR"}),c.jsx("button",{onClick:()=>f("en"),className:`px-3 py-1 text-sm rounded ${r.language==="en"?"bg-primary-100 text-primary-600":"bg-gray-100"}`,children:"EN"})]}),!o&&c.jsx(oB,{className:"w-5 h-5 mx-auto text-gray-500"})]}),c.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[c.jsxs("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center text-primary-600 font-semibold flex-shrink-0",children:[(p=a==null?void 0:a.firstName)==null?void 0:p[0],(d=a==null?void 0:a.lastName)==null?void 0:d[0]]}),o&&c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsxs("p",{className:"text-sm font-medium text-gray-900 truncate",children:[a==null?void 0:a.firstName," ",a==null?void 0:a.lastName]}),c.jsx("p",{className:"text-xs text-gray-500 truncate",children:a==null?void 0:a.email})]})]}),c.jsxs("button",{onClick:u,className:"w-full flex items-center gap-3 px-3 py-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[c.jsx(mB,{className:"w-5 h-5 flex-shrink-0"}),o&&c.jsx("span",{children:t("auth.logout")})]})]})]}),c.jsx("main",{className:"flex-1 overflow-auto",children:c.jsx("div",{className:"p-8",children:e})})]})},ate=({syncState:e,onSync:t,onClearPending:r})=>{const{t:n}=Ii(),[s,a]=ee.useState(!1),[i,o]=ee.useState(!1),l=()=>{if(e.realtimeConnected||e.status==="realtime")return c.jsx(wB,{className:"w-4 h-4 text-green-500 animate-pulse"});switch(e.status){case"offline":return c.jsx(Nu,{className:"w-4 h-4 text-red-500"});case"syncing":case"pulling":return c.jsx(iv,{className:"w-4 h-4 text-blue-500 animate-spin"});case"synced":return c.jsx(_g,{className:"w-4 h-4 text-green-500"});case"error":return c.jsx(Za,{className:"w-4 h-4 text-red-500"});default:return c.jsx(AB,{className:"w-4 h-4 text-gray-500"})}},u=()=>e.realtimeConnected||e.status==="realtime"?n("sync.status.realtime","En direct"):n(`sync.status.${e.status}`),f=()=>{if(e.realtimeConnected||e.status==="realtime")return"bg-green-100 text-green-800 border-green-200";switch(e.status){case"offline":return"bg-red-100 text-red-800 border-red-200";case"syncing":case"pulling":return"bg-blue-100 text-blue-800 border-blue-200";case"synced":return"bg-green-100 text-green-800 border-green-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},h=async()=>{if(r){o(!0);try{await r(),a(!1)}finally{o(!1)}}};return c.jsxs("div",{className:"fixed top-4 right-4 z-50",children:[c.jsxs("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg border shadow-sm ${f()} cursor-pointer hover:shadow-md transition-shadow`,onClick:()=>e.status==="error"?a(!s):t==null?void 0:t(),title:e.status==="error"?n("sync.clickForOptions","Cliquer pour options"):n("sync.clickToSync","Cliquer pour synchroniser"),children:[l(),c.jsx("span",{className:"text-sm font-medium",children:u()}),e.pendingOperations>0&&c.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-white rounded-full",children:e.pendingOperations}),t&&e.status!=="syncing"&&e.status!=="pulling"&&c.jsx(xo,{className:"w-4 h-4 ml-1 opacity-60 hover:opacity-100"})]}),e.error&&c.jsxs("div",{className:"mt-2 p-2 text-xs text-red-700 bg-red-50 rounded-lg border border-red-200",children:[c.jsx("p",{children:e.error}),r&&e.pendingOperations>0&&c.jsxs("button",{onClick:h,disabled:i,className:"mt-2 flex items-center gap-1 px-2 py-1 text-xs bg-red-100 hover:bg-red-200 text-red-800 rounded transition-colors disabled:opacity-50",children:[i?c.jsx(iv,{className:"w-3 h-3 animate-spin"}):c.jsx(ma,{className:"w-3 h-3"}),n("sync.clearPending","Effacer les oprations en attente")," (",e.pendingOperations,")"]})]}),s&&e.status==="error"&&c.jsxs("div",{className:"mt-2 p-2 bg-white rounded-lg border shadow-lg",children:[c.jsxs("button",{onClick:()=>{t==null||t(),a(!1)},className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[c.jsx(xo,{className:"w-4 h-4"}),n("sync.retry","Ressayer la synchronisation")]}),r&&c.jsxs("button",{onClick:h,disabled:i,className:"w-full flex items-center gap-2 px-3 py-2 text-sm text-red-700 hover:bg-red-50 rounded disabled:opacity-50",children:[i?c.jsx(iv,{className:"w-4 h-4 animate-spin"}):c.jsx(ma,{className:"w-4 h-4"}),n("sync.clearAndRetry","Effacer et ressayer")]})]})]})};function ite(){const{isUpdateAvailable:e,updateInfo:t,isDownloading:r,downloadProgress:n,isUpdateDownloaded:s,error:a}=NT(),[i,o]=ee.useState(!1);if(i||!e&&!s&&!a)return null;const l=async()=>{if(window.electron)try{const h=await window.electron.downloadUpdate();h.error&&console.error("Failed to download update:",h.error)}catch(h){console.error("Error downloading update:",h)}},u=async()=>{if(window.electron)try{await window.electron.installUpdate()}catch(h){console.error("Error installing update:",h)}},f=h=>{if(h===0)return"0 Bytes";const p=1024,d=["Bytes","KB","MB","GB"],m=Math.floor(Math.log(h)/Math.log(p));return Math.round(h/Math.pow(p,m)*100)/100+" "+d[m]};return c.jsx("div",{className:"fixed top-4 right-4 z-50 w-96 animate-in slide-in-from-top-5",children:c.jsxs("div",{className:"bg-white rounded-lg shadow-xl border border-gray-200 overflow-hidden",children:[c.jsxs("div",{className:"flex items-start justify-between p-4 bg-gradient-to-r from-blue-500 to-blue-600",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[s?c.jsx(_g,{className:"h-6 w-6 text-white"}):a?c.jsx(Za,{className:"h-6 w-6 text-white"}):c.jsx(xo,{className:`h-6 w-6 text-white ${r?"animate-spin":""}`}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-white",children:s?"  ":a?"  ":r?"  ...":" "}),t&&c.jsxs("p",{className:"text-sm text-blue-100",children:[" ",t.version]})]})]}),c.jsx("button",{onClick:()=>o(!0),className:"text-white hover:text-gray-200 transition-colors",children:c.jsx(Ac,{className:"h-5 w-5"})})]}),c.jsx("div",{className:"p-4",children:a?c.jsxs("div",{className:"text-sm text-red-600",children:[c.jsx("p",{className:"font-medium",children:"   :"}),c.jsx("p",{className:"mt-1 text-xs",children:a})]}):s?c.jsxs("div",{children:[c.jsx("p",{className:"text-sm text-gray-700 mb-4",children:"   .       ."}),c.jsxs("button",{onClick:u,className:"w-full bg-green-500 hover:bg-green-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[c.jsx(xo,{className:"h-4 w-4"}),"  "]})]}):r&&n?c.jsxs("div",{children:[c.jsxs("div",{className:"mb-2 flex justify-between text-sm text-gray-600",children:[c.jsx("span",{children:" ..."}),c.jsxs("span",{children:[n.percent,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2 overflow-hidden",children:c.jsx("div",{className:"bg-blue-500 h-full transition-all duration-300 ease-out",style:{width:`${n.percent}%`}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-500",children:[c.jsxs("span",{children:[f(n.transferred)," / ",f(n.total)]}),c.jsxs("span",{children:[f(n.bytesPerSecond),"/s"]})]})]}):c.jsxs("div",{children:[(t==null?void 0:t.releaseNotes)&&c.jsxs("div",{className:"mb-4 text-sm text-gray-700 max-h-32 overflow-y-auto",children:[c.jsx("p",{className:"font-medium mb-1",children:" :"}),c.jsx("div",{className:"text-xs whitespace-pre-wrap",children:t.releaseNotes})]}),c.jsxs("button",{onClick:l,className:"w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors flex items-center justify-center gap-2",children:[c.jsx(Md,{className:"h-4 w-4"})," "]})]})}),!a&&!s&&c.jsx("div",{className:"px-4 py-3 bg-gray-50 border-t border-gray-100",children:c.jsx("p",{className:"text-xs text-gray-500 text-center",children:"      "})})]})})}function ote(){Ii();const{user:e,isInitialized:t,checkAuth:r}=Rn(),{syncState:n,sync:s,clearPendingOperations:a}=X9(yc()&&(e==null?void 0:e.id)||null),[i,o]=ee.useState({isOnline:navigator.onLine,lastCheck:Date.now()});ee.useEffect(()=>{if(!It())return;console.log(" [WEB] Server-First mode - No IndexedDB, No Sync Engine");const u=()=>o({isOnline:!0,lastCheck:Date.now()}),f=()=>o({isOnline:!1,lastCheck:Date.now()});return window.addEventListener("online",u),window.addEventListener("offline",f),()=>{window.removeEventListener("online",u),window.removeEventListener("offline",f)}},[]),J9(),ee.useEffect(()=>It()?(window.btpStatus=()=>({mode:"WEB SERVER-FIRST",online:i.isOnline,message:"Web mode - all data loaded directly from server, no local storage"}),()=>{delete window.btpStatus}):(window.btpSync={sync:s,clearPendingOperations:a,status:()=>({mode:"ELECTRON OFFLINE-FIRST",syncState:n,message:"Electron mode - IndexedDB + Sync Engine"})},()=>{delete window.btpSync}),[i,n,s,a]),ee.useEffect(()=>{r()},[r]),ee.useEffect(()=>{if(!t){console.log(" Waiting for auth to initialize...");return}if(!e){console.log(" No user, skipping sync");return}if(console.log(" Auth initialized for user:",e.id),It()){console.log(" [WEB] Server-First mode - No sync, no IndexedDB");return}console.log(" [ELECTRON] Offline-First mode - Starting sync...");const u=setTimeout(()=>{s().catch(f=>{var h;((h=f.response)==null?void 0:h.status)!==401&&console.error("Sync error:",f)})},300);return()=>clearTimeout(u)},[t,e==null?void 0:e.id,s]);const l=It()?{status:i.isOnline?"synced":"offline",lastSyncTime:i.lastCheck,pendingOperations:0,error:i.isOnline?null:"Mode hors ligne",lastPullCount:0,realtimeConnected:!1}:n;return c.jsxs(c.Fragment,{children:[c.jsx(ate,{syncState:l,onSync:yc()?s:void 0,onClearPending:yc()?a:void 0}),c.jsx(ite,{}),c.jsxs(zD,{children:[c.jsx(Lr,{path:"/login",element:c.jsx(TB,{})}),c.jsx(Lr,{path:"/register",element:c.jsx(CB,{})}),c.jsx(Lr,{path:"/",element:e?c.jsx(Gn,{children:c.jsx(b$,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects",element:e?c.jsx(Gn,{children:c.jsx(N$,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/new",element:e?c.jsx(Gn,{children:c.jsx(dJ,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:id",element:e?c.jsx(Gn,{children:c.jsx(cJ,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:id/edit",element:e?c.jsx(Gn,{children:c.jsx(hJ,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/delais",element:e?c.jsx(Gn,{children:c.jsx(xJ,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/bordereau",element:e?c.jsx(Gn,{children:c.jsx(yJ,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/metre",element:e?c.jsx(Gn,{children:c.jsx(jh,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/metres",element:e?c.jsx(Gn,{children:c.jsx(jh,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/metre-v3",element:e?c.jsx(Gn,{children:c.jsx(jh,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/metre/:periodeId",element:e?c.jsx(Gn,{children:c.jsx(jh,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/decompte",element:c.jsx($r,{to:"..",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/decomptes",element:c.jsx($r,{to:"..",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/decompte/:periodeId",element:e?c.jsx(Gn,{children:c.jsx(nE,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/periodes",element:e?c.jsx($r,{to:`/projects/${window.location.pathname.split("/")[2]}/metre`,replace:!0}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/periodes/:periodeId/metre",element:e?c.jsx(Gn,{children:c.jsx(jh,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/periodes/:periodeId/decompte",element:e?c.jsx(Gn,{children:c.jsx(nE,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/periodes/:periodeId/attachement",element:e?c.jsx(Gn,{children:c.jsx(sE,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/projects/:projectId/attachement",element:e?c.jsx(Gn,{children:c.jsx(sE,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/settings",element:e?c.jsx(Gn,{children:c.jsx(ete,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/trash",element:e?c.jsx(Gn,{children:c.jsx(ste,{})}):c.jsx($r,{to:"/login",replace:!0})}),c.jsx(Lr,{path:"/admin",element:(e==null?void 0:e.role)==="super_admin"?c.jsx(tte,{}):c.jsx($r,{to:"/",replace:!0})}),c.jsx(Lr,{path:"/admin/users",element:(e==null?void 0:e.role)==="super_admin"?c.jsx(rte,{}):c.jsx($r,{to:"/",replace:!0})}),c.jsx(Lr,{path:"*",element:c.jsx($r,{to:"/",replace:!0})})]})]})}const Gt=e=>typeof e=="string",Ph=()=>{let e,t;const r=new Promise((n,s)=>{e=n,t=s});return r.resolve=e,r.reject=t,r},aE=e=>e==null?"":""+e,lte=(e,t,r)=>{e.forEach(n=>{t[n]&&(r[n]=t[n])})},cte=/###/g,iE=e=>e&&e.indexOf("###")>-1?e.replace(cte,"."):e,oE=e=>!e||Gt(e),v0=(e,t,r)=>{const n=Gt(t)?t.split("."):t;let s=0;for(;s<n.length-1;){if(oE(e))return{};const a=iE(n[s]);!e[a]&&r&&(e[a]=new r),Object.prototype.hasOwnProperty.call(e,a)?e=e[a]:e={},++s}return oE(e)?{}:{obj:e,k:iE(n[s])}},lE=(e,t,r)=>{const{obj:n,k:s}=v0(e,t,Object);if(n!==void 0||t.length===1){n[s]=r;return}let a=t[t.length-1],i=t.slice(0,t.length-1),o=v0(e,i,Object);for(;o.obj===void 0&&i.length;)a=`${i[i.length-1]}.${a}`,i=i.slice(0,i.length-1),o=v0(e,i,Object),o&&o.obj&&typeof o.obj[`${o.k}.${a}`]<"u"&&(o.obj=void 0);o.obj[`${o.k}.${a}`]=r},ute=(e,t,r,n)=>{const{obj:s,k:a}=v0(e,t,Object);s[a]=s[a]||[],s[a].push(r)},Yg=(e,t)=>{const{obj:r,k:n}=v0(e,t);if(r)return r[n]},fte=(e,t,r)=>{const n=Yg(e,r);return n!==void 0?n:Yg(t,r)},OP=(e,t,r)=>{for(const n in t)n!=="__proto__"&&n!=="constructor"&&(n in e?Gt(e[n])||e[n]instanceof String||Gt(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):OP(e[n],t[n],r):e[n]=t[n]);return e},wf=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var dte={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const hte=e=>Gt(e)?e.replace(/[&<>"'\/]/g,t=>dte[t]):e;class pte{constructor(t){this.capacity=t,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(t){const r=this.regExpMap.get(t);if(r!==void 0)return r;const n=new RegExp(t);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(t,n),this.regExpQueue.push(t),n}}const mte=[" ",",","?","!",";"],gte=new pte(20),xte=(e,t,r)=>{t=t||"",r=r||"";const n=mte.filter(i=>t.indexOf(i)<0&&r.indexOf(i)<0);if(n.length===0)return!0;const s=gte.getRegExp(`(${n.map(i=>i==="?"?"\\?":i).join("|")})`);let a=!s.test(e);if(!a){const i=e.indexOf(r);i>0&&!s.test(e.substring(0,i))&&(a=!0)}return a},a5=function(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!e)return;if(e[t])return e[t];const n=t.split(r);let s=e;for(let a=0;a<n.length;){if(!s||typeof s!="object")return;let i,o="";for(let l=a;l<n.length;++l)if(l!==a&&(o+=r),o+=n[l],i=s[o],i!==void 0){if(["string","number","boolean"].indexOf(typeof i)>-1&&l<n.length-1)continue;a+=l-a+1;break}s=i}return s},Xg=e=>e&&e.replace("_","-"),vte={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class Jg{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(t,r)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=r.prefix||"i18next:",this.logger=t||vte,this.options=r,this.debug=r.debug}log(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"log","",!0)}warn(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","",!0)}error(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"error","")}deprecate(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return this.forward(r,"warn","WARNING DEPRECATED: ",!0)}forward(t,r,n,s){return s&&!this.debug?null:(Gt(t[0])&&(t[0]=`${n}${this.prefix} ${t[0]}`),this.logger[r](t))}create(t){return new Jg(this.logger,{prefix:`${this.prefix}:${t}:`,...this.options})}clone(t){return t=t||this.options,t.prefix=t.prefix||this.prefix,new Jg(this.logger,t)}}var uo=new Jg;class Bx{constructor(){this.observers={}}on(t,r){return t.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const s=this.observers[n].get(r)||0;this.observers[n].set(r,s+1)}),this}off(t,r){if(this.observers[t]){if(!r){delete this.observers[t];return}this.observers[t].delete(r)}}emit(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),s=1;s<r;s++)n[s-1]=arguments[s];this.observers[t]&&Array.from(this.observers[t].entries()).forEach(i=>{let[o,l]=i;for(let u=0;u<l;u++)o(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(i=>{let[o,l]=i;for(let u=0;u<l;u++)o.apply(o,[t,...n])})}}class cE extends Bx{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=t||{},this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(t){this.options.ns.indexOf(t)<0&&this.options.ns.push(t)}removeNamespaces(t){const r=this.options.ns.indexOf(t);r>-1&&this.options.ns.splice(r,1)}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=s.keySeparator!==void 0?s.keySeparator:this.options.keySeparator,i=s.ignoreJSONStructure!==void 0?s.ignoreJSONStructure:this.options.ignoreJSONStructure;let o;t.indexOf(".")>-1?o=t.split("."):(o=[t,r],n&&(Array.isArray(n)?o.push(...n):Gt(n)&&a?o.push(...n.split(a)):o.push(n)));const l=Yg(this.data,o);return!l&&!r&&!n&&t.indexOf(".")>-1&&(t=o[0],r=o[1],n=o.slice(2).join(".")),l||!i||!Gt(n)?l:a5(this.data&&this.data[t]&&this.data[t][r],n,a)}addResource(t,r,n,s){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const i=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let o=[t,r];n&&(o=o.concat(i?n.split(i):n)),t.indexOf(".")>-1&&(o=t.split("."),s=r,r=o[1]),this.addNamespaces(r),lE(this.data,o,s),a.silent||this.emit("added",t,r,n,s)}addResources(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in n)(Gt(n[a])||Array.isArray(n[a]))&&this.addResource(t,r,a,n[a],{silent:!0});s.silent||this.emit("added",t,r,n)}addResourceBundle(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},o=[t,r];t.indexOf(".")>-1&&(o=t.split("."),s=n,n=r,r=o[1]),this.addNamespaces(r);let l=Yg(this.data,o)||{};i.skipCopy||(n=JSON.parse(JSON.stringify(n))),s?OP(l,n,a):l={...l,...n},lE(this.data,o,l),i.silent||this.emit("added",t,r,n)}removeResourceBundle(t,r){this.hasResourceBundle(t,r)&&delete this.data[t][r],this.removeNamespaces(r),this.emit("removed",t,r)}hasResourceBundle(t,r){return this.getResource(t,r)!==void 0}getResourceBundle(t,r){return r||(r=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(t,r)}:this.getResource(t,r)}getDataByLanguage(t){return this.data[t]}hasLanguageSomeTranslations(t){const r=this.getDataByLanguage(t);return!!(r&&Object.keys(r)||[]).find(s=>r[s]&&Object.keys(r[s]).length>0)}toJSON(){return this.data}}var IP={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,s){return e.forEach(a=>{this.processors[a]&&(t=this.processors[a].process(t,r,n,s))}),t}};const uE={};class Qg extends Bx{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),lte(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],t,this),this.options=r,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=uo.create("translator")}changeLanguage(t){t&&(this.language=t)}exists(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(t==null)return!1;const n=this.resolve(t,r);return n&&n.res!==void 0}extractFromKey(t,r){let n=r.nsSeparator!==void 0?r.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const s=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator;let a=r.ns||this.options.defaultNS||[];const i=n&&t.indexOf(n)>-1,o=!this.options.userDefinedKeySeparator&&!r.keySeparator&&!this.options.userDefinedNsSeparator&&!r.nsSeparator&&!xte(t,n,s);if(i&&!o){const l=t.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:t,namespaces:Gt(a)?[a]:a};const u=t.split(n);(n!==s||n===s&&this.options.ns.indexOf(u[0])>-1)&&(a=u.shift()),t=u.join(s)}return{key:t,namespaces:Gt(a)?[a]:a}}translate(t,r,n){if(typeof r!="object"&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),typeof r=="object"&&(r={...r}),r||(r={}),t==null)return"";Array.isArray(t)||(t=[String(t)]);const s=r.returnDetails!==void 0?r.returnDetails:this.options.returnDetails,a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,{key:i,namespaces:o}=this.extractFromKey(t[t.length-1],r),l=o[o.length-1],u=r.lng||this.language,f=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(f){const S=r.nsSeparator||this.options.nsSeparator;return s?{res:`${l}${S}${i}`,usedKey:i,exactUsedKey:i,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:`${l}${S}${i}`}return s?{res:i,usedKey:i,exactUsedKey:i,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(r)}:i}const h=this.resolve(t,r);let p=h&&h.res;const d=h&&h.usedKey||i,m=h&&h.exactUsedKey||i,g=Object.prototype.toString.apply(p),w=["[object Number]","[object Function]","[object RegExp]"],x=r.joinArrays!==void 0?r.joinArrays:this.options.joinArrays,y=!this.i18nFormat||this.i18nFormat.handleAsObject,b=!Gt(p)&&typeof p!="boolean"&&typeof p!="number";if(y&&p&&b&&w.indexOf(g)<0&&!(Gt(x)&&Array.isArray(p))){if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const S=this.options.returnedObjectHandler?this.options.returnedObjectHandler(d,p,{...r,ns:o}):`key '${i} (${this.language})' returned an object instead of string.`;return s?(h.res=S,h.usedParams=this.getUsedParamsDetails(r),h):S}if(a){const S=Array.isArray(p),T=S?[]:{},L=S?m:d;for(const A in p)if(Object.prototype.hasOwnProperty.call(p,A)){const D=`${L}${a}${A}`;T[A]=this.translate(D,{...r,joinArrays:!1,ns:o}),T[A]===D&&(T[A]=p[A])}p=T}}else if(y&&Gt(x)&&Array.isArray(p))p=p.join(x),p&&(p=this.extendTranslation(p,t,r,n));else{let S=!1,T=!1;const L=r.count!==void 0&&!Gt(r.count),A=Qg.hasDefaultValue(r),D=L?this.pluralResolver.getSuffix(u,r.count,r):"",C=r.ordinal&&L?this.pluralResolver.getSuffix(u,r.count,{ordinal:!1}):"",O=L&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),E=O&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${D}`]||r[`defaultValue${C}`]||r.defaultValue;!this.isValidLookup(p)&&A&&(S=!0,p=E),this.isValidLookup(p)||(T=!0,p=i);const q=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&T?void 0:p,M=A&&E!==p&&this.options.updateMissing;if(T||S||M){if(this.logger.log(M?"updateKey":"missingKey",u,l,i,M?E:p),a){const re=this.resolve(i,{...r,keySeparator:!1});re&&re.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let ne=[];const fe=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if(this.options.saveMissingTo==="fallback"&&fe&&fe[0])for(let re=0;re<fe.length;re++)ne.push(fe[re]);else this.options.saveMissingTo==="all"?ne=this.languageUtils.toResolveHierarchy(r.lng||this.language):ne.push(r.lng||this.language);const me=(re,G,ge)=>{const ve=A&&ge!==p?ge:q;this.options.missingKeyHandler?this.options.missingKeyHandler(re,l,G,ve,M,r):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(re,l,G,ve,M,r),this.emit("missingKey",re,l,G,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&L?ne.forEach(re=>{const G=this.pluralResolver.getSuffixes(re,r);O&&r[`defaultValue${this.options.pluralSeparator}zero`]&&G.indexOf(`${this.options.pluralSeparator}zero`)<0&&G.push(`${this.options.pluralSeparator}zero`),G.forEach(ge=>{me([re],i+ge,r[`defaultValue${ge}`]||E)})}):me(ne,i,E))}p=this.extendTranslation(p,t,r,h,n),T&&p===i&&this.options.appendNamespaceToMissingKey&&(p=`${l}:${i}`),(T||S)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?p=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${i}`:i,S?p:void 0):p=this.options.parseMissingKeyHandler(p))}return s?(h.res=p,h.usedParams=this.getUsedParamsDetails(r),h):p}extendTranslation(t,r,n,s,a){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)t=this.i18nFormat.parse(t,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||s.usedLng,s.usedNS,s.usedKey,{resolved:s});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const u=Gt(t)&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let f;if(u){const p=t.match(this.interpolator.nestingRegexp);f=p&&p.length}let h=n.replace&&!Gt(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(h={...this.options.interpolation.defaultVariables,...h}),t=this.interpolator.interpolate(t,h,n.lng||this.language||s.usedLng,n),u){const p=t.match(this.interpolator.nestingRegexp),d=p&&p.length;f<d&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&s&&s.res&&(n.lng=this.language||s.usedLng),n.nest!==!1&&(t=this.interpolator.nest(t,function(){for(var p=arguments.length,d=new Array(p),m=0;m<p;m++)d[m]=arguments[m];return a&&a[0]===d[0]&&!n.context?(i.logger.warn(`It seems you are nesting recursively key: ${d[0]} in key: ${r[0]}`),null):i.translate(...d,r)},n)),n.interpolation&&this.interpolator.reset()}const o=n.postProcess||this.options.postProcess,l=Gt(o)?[o]:o;return t!=null&&l&&l.length&&n.applyPostProcessor!==!1&&(t=IP.handle(l,t,r,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...s,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),t}resolve(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,s,a,i,o;return Gt(t)&&(t=[t]),t.forEach(l=>{if(this.isValidLookup(n))return;const u=this.extractFromKey(l,r),f=u.key;s=f;let h=u.namespaces;this.options.fallbackNS&&(h=h.concat(this.options.fallbackNS));const p=r.count!==void 0&&!Gt(r.count),d=p&&!r.ordinal&&r.count===0&&this.pluralResolver.shouldUseIntlApi(),m=r.context!==void 0&&(Gt(r.context)||typeof r.context=="number")&&r.context!=="",g=r.lngs?r.lngs:this.languageUtils.toResolveHierarchy(r.lng||this.language,r.fallbackLng);h.forEach(w=>{this.isValidLookup(n)||(o=w,!uE[`${g[0]}-${w}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(o)&&(uE[`${g[0]}-${w}`]=!0,this.logger.warn(`key "${s}" for languages "${g.join(", ")}" won't get resolved as namespace "${o}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),g.forEach(x=>{if(this.isValidLookup(n))return;i=x;const y=[f];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(y,f,x,w,r);else{let S;p&&(S=this.pluralResolver.getSuffix(x,r.count,r));const T=`${this.options.pluralSeparator}zero`,L=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(y.push(f+S),r.ordinal&&S.indexOf(L)===0&&y.push(f+S.replace(L,this.options.pluralSeparator)),d&&y.push(f+T)),m){const A=`${f}${this.options.contextSeparator}${r.context}`;y.push(A),p&&(y.push(A+S),r.ordinal&&S.indexOf(L)===0&&y.push(A+S.replace(L,this.options.pluralSeparator)),d&&y.push(A+T))}}let b;for(;b=y.pop();)this.isValidLookup(n)||(a=b,n=this.getResource(x,w,b,r))}))})}),{res:n,usedKey:s,exactUsedKey:a,usedLng:i,usedNS:o}}isValidLookup(t){return t!==void 0&&!(!this.options.returnNull&&t===null)&&!(!this.options.returnEmptyString&&t==="")}getResource(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(t,r,n,s):this.resourceStore.getResource(t,r,n,s)}getUsedParamsDetails(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=t.replace&&!Gt(t.replace);let s=n?t.replace:t;if(n&&typeof t.count<"u"&&(s.count=t.count),this.options.interpolation.defaultVariables&&(s={...this.options.interpolation.defaultVariables,...s}),!n){s={...s};for(const a of r)delete s[a]}return s}static hasDefaultValue(t){const r="defaultValue";for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&r===n.substring(0,r.length)&&t[n]!==void 0)return!0;return!1}}const Wv=e=>e.charAt(0).toUpperCase()+e.slice(1);class fE{constructor(t){this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=uo.create("languageUtils")}getScriptPartFromCode(t){if(t=Xg(t),!t||t.indexOf("-")<0)return null;const r=t.split("-");return r.length===2||(r.pop(),r[r.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(r.join("-"))}getLanguagePartFromCode(t){if(t=Xg(t),!t||t.indexOf("-")<0)return t;const r=t.split("-");return this.formatLanguageCode(r[0])}formatLanguageCode(t){if(Gt(t)&&t.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let s=Intl.getCanonicalLocales(t)[0];if(s&&this.options.lowerCaseLng&&(s=s.toLowerCase()),s)return s}catch{}const r=["hans","hant","latn","cyrl","cans","mong","arab"];let n=t.split("-");return this.options.lowerCaseLng?n=n.map(s=>s.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Wv(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),r.indexOf(n[1].toLowerCase())>-1&&(n[1]=Wv(n[1].toLowerCase())),r.indexOf(n[2].toLowerCase())>-1&&(n[2]=Wv(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?t.toLowerCase():t}isSupportedCode(t){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(t=this.getLanguagePartFromCode(t)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(t)>-1}getBestMatchFromCodes(t){if(!t)return null;let r;return t.forEach(n=>{if(r)return;const s=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(s))&&(r=s)}),!r&&this.options.supportedLngs&&t.forEach(n=>{if(r)return;const s=this.getLanguagePartFromCode(n);if(this.isSupportedCode(s))return r=s;r=this.options.supportedLngs.find(a=>{if(a===s)return a;if(!(a.indexOf("-")<0&&s.indexOf("-")<0)&&(a.indexOf("-")>0&&s.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===s||a.indexOf(s)===0&&s.length>1))return a})}),r||(r=this.getFallbackCodes(this.options.fallbackLng)[0]),r}getFallbackCodes(t,r){if(!t)return[];if(typeof t=="function"&&(t=t(r)),Gt(t)&&(t=[t]),Array.isArray(t))return t;if(!r)return t.default||[];let n=t[r];return n||(n=t[this.getScriptPartFromCode(r)]),n||(n=t[this.formatLanguageCode(r)]),n||(n=t[this.getLanguagePartFromCode(r)]),n||(n=t.default),n||[]}toResolveHierarchy(t,r){const n=this.getFallbackCodes(r||this.options.fallbackLng||[],t),s=[],a=i=>{i&&(this.isSupportedCode(i)?s.push(i):this.logger.warn(`rejecting language code not found in supportedLngs: ${i}`))};return Gt(t)&&(t.indexOf("-")>-1||t.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(t)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(t)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(t))):Gt(t)&&a(this.formatLanguageCode(t)),n.forEach(i=>{s.indexOf(i)<0&&a(this.formatLanguageCode(i))}),s}}let yte=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],wte={1:e=>+(e>1),2:e=>+(e!=1),3:e=>0,4:e=>e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,5:e=>e==0?0:e==1?1:e==2?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5,6:e=>e==1?0:e>=2&&e<=4?1:2,7:e=>e==1?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2,8:e=>e==1?0:e==2?1:e!=8&&e!=11?2:3,9:e=>+(e>=2),10:e=>e==1?0:e==2?1:e<7?2:e<11?3:4,11:e=>e==1||e==11?0:e==2||e==12?1:e>2&&e<20?2:3,12:e=>+(e%10!=1||e%100==11),13:e=>+(e!==0),14:e=>e==1?0:e==2?1:e==3?2:3,15:e=>e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2,16:e=>e%10==1&&e%100!=11?0:e!==0?1:2,17:e=>e==1||e%10==1&&e%100!=11?0:1,18:e=>e==0?0:e==1?1:2,19:e=>e==1?0:e==0||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3,20:e=>e==1?0:e==0||e%100>0&&e%100<20?1:2,21:e=>e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0,22:e=>e==1?0:e==2?1:(e<0||e>10)&&e%10==0?2:3};const bte=["v1","v2","v3"],Nte=["v4"],dE={zero:0,one:1,two:2,few:3,many:4,other:5},Ste=()=>{const e={};return yte.forEach(t=>{t.lngs.forEach(r=>{e[r]={numbers:t.nr,plurals:wte[t.fc]}})}),e};class kte{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=t,this.options=r,this.logger=uo.create("pluralResolver"),(!this.options.compatibilityJSON||Nte.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Ste(),this.pluralRulesCache={}}addRule(t,r){this.rules[t]=r}clearCache(){this.pluralRulesCache={}}getRule(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const n=Xg(t==="dev"?"en":t),s=r.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:s});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let i;try{i=new Intl.PluralRules(n,{type:s})}catch{if(!t.match(/-|_/))return;const l=this.languageUtils.getLanguagePartFromCode(t);i=this.getRule(l,r)}return this.pluralRulesCache[a]=i,i}return this.rules[t]||this.rules[this.languageUtils.getLanguagePartFromCode(t)]}needsPlural(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(t,n).map(s=>`${r}${s}`)}getSuffixes(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(t,r);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((s,a)=>dE[s]-dE[a]).map(s=>`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${s}`):n.numbers.map(s=>this.getSuffix(t,s,r)):[]}getSuffix(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.getRule(t,n);return s?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${s.select(r)}`:this.getSuffixRetroCompatible(s,r):(this.logger.warn(`no plural rule found for: ${t}`),"")}getSuffixRetroCompatible(t,r){const n=t.noAbs?t.plurals(r):t.plurals(Math.abs(r));let s=t.numbers[n];this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1&&(s===2?s="plural":s===1&&(s=""));const a=()=>this.options.prepend&&s.toString()?this.options.prepend+s.toString():s.toString();return this.options.compatibilityJSON==="v1"?s===1?"":typeof s=="number"?`_plural_${s.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&t.numbers.length===2&&t.numbers[0]===1?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!bte.includes(this.options.compatibilityJSON)}}const hE=function(e,t,r){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=fte(e,t,r);return!a&&s&&Gt(r)&&(a=a5(e,r,n),a===void 0&&(a=a5(t,r,n))),a},Vv=e=>e.replace(/\$/g,"$$$$");class _te{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=uo.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||(r=>r),this.init(t)}init(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};t.interpolation||(t.interpolation={escapeValue:!0});const{escape:r,escapeValue:n,useRawValueToEscape:s,prefix:a,prefixEscaped:i,suffix:o,suffixEscaped:l,formatSeparator:u,unescapeSuffix:f,unescapePrefix:h,nestingPrefix:p,nestingPrefixEscaped:d,nestingSuffix:m,nestingSuffixEscaped:g,nestingOptionsSeparator:w,maxReplaces:x,alwaysFormat:y}=t.interpolation;this.escape=r!==void 0?r:hte,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=s!==void 0?s:!1,this.prefix=a?wf(a):i||"{{",this.suffix=o?wf(o):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=f?"":h||"-",this.unescapeSuffix=this.unescapePrefix?"":f||"",this.nestingPrefix=p?wf(p):d||wf("$t("),this.nestingSuffix=m?wf(m):g||wf(")"),this.nestingOptionsSeparator=w||",",this.maxReplaces=x||1e3,this.alwaysFormat=y!==void 0?y:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const t=(r,n)=>r&&r.source===n?(r.lastIndex=0,r):new RegExp(n,"g");this.regexp=t(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=t(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=t(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(t,r,n,s){let a,i,o;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=d=>{if(d.indexOf(this.formatSeparator)<0){const x=hE(r,l,d,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(x,void 0,n,{...s,...r,interpolationkey:d}):x}const m=d.split(this.formatSeparator),g=m.shift().trim(),w=m.join(this.formatSeparator).trim();return this.format(hE(r,l,g,this.options.keySeparator,this.options.ignoreJSONStructure),w,n,{...s,...r,interpolationkey:g})};this.resetRegExp();const f=s&&s.missingInterpolationHandler||this.options.missingInterpolationHandler,h=s&&s.interpolation&&s.interpolation.skipOnVariables!==void 0?s.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:d=>Vv(d)},{regex:this.regexp,safeValue:d=>this.escapeValue?Vv(this.escape(d)):Vv(d)}].forEach(d=>{for(o=0;a=d.regex.exec(t);){const m=a[1].trim();if(i=u(m),i===void 0)if(typeof f=="function"){const w=f(t,a,s);i=Gt(w)?w:""}else if(s&&Object.prototype.hasOwnProperty.call(s,m))i="";else if(h){i=a[0];continue}else this.logger.warn(`missed to pass in variable ${m} for interpolating ${t}`),i="";else!Gt(i)&&!this.useRawValueToEscape&&(i=aE(i));const g=d.safeValue(i);if(t=t.replace(a[0],g),h?(d.regex.lastIndex+=i.length,d.regex.lastIndex-=a[0].length):d.regex.lastIndex=0,o++,o>=this.maxReplaces)break}}),t}nest(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s,a,i;const o=(l,u)=>{const f=this.nestingOptionsSeparator;if(l.indexOf(f)<0)return l;const h=l.split(new RegExp(`${f}[ ]*{`));let p=`{${h[1]}`;l=h[0],p=this.interpolate(p,i);const d=p.match(/'/g),m=p.match(/"/g);(d&&d.length%2===0&&!m||m.length%2!==0)&&(p=p.replace(/'/g,'"'));try{i=JSON.parse(p),u&&(i={...u,...i})}catch(g){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,g),`${l}${f}${p}`}return i.defaultValue&&i.defaultValue.indexOf(this.prefix)>-1&&delete i.defaultValue,l};for(;s=this.nestingRegexp.exec(t);){let l=[];i={...n},i=i.replace&&!Gt(i.replace)?i.replace:i,i.applyPostProcessor=!1,delete i.defaultValue;let u=!1;if(s[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(s[1])){const f=s[1].split(this.formatSeparator).map(h=>h.trim());s[1]=f.shift(),l=f,u=!0}if(a=r(o.call(this,s[1].trim(),i),i),a&&s[0]===t&&!Gt(a))return a;Gt(a)||(a=aE(a)),a||(this.logger.warn(`missed to resolve ${s[1]} for nesting ${t}`),a=""),u&&(a=l.reduce((f,h)=>this.format(f,h,n.lng,{...n,interpolationkey:s[1].trim()}),a.trim())),t=t.replace(s[0],a),this.regexp.lastIndex=0}return t}}const Ete=e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const s=n[1].substring(0,n[1].length-1);t==="currency"&&s.indexOf(":")<0?r.currency||(r.currency=s.trim()):t==="relativetime"&&s.indexOf(":")<0?r.range||(r.range=s.trim()):s.split(";").forEach(i=>{if(i){const[o,...l]=i.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),f=o.trim();r[f]||(r[f]=u),u==="false"&&(r[f]=!1),u==="true"&&(r[f]=!0),isNaN(u)||(r[f]=parseInt(u,10))}})}return{formatName:t,formatOptions:r}},bf=e=>{const t={};return(r,n,s)=>{let a=s;s&&s.interpolationkey&&s.formatParams&&s.formatParams[s.interpolationkey]&&s[s.interpolationkey]&&(a={...a,[s.interpolationkey]:void 0});const i=n+JSON.stringify(a);let o=t[i];return o||(o=e(Xg(n),s),t[i]=o),o(r)}};class Ate{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=uo.create("formatter"),this.options=t,this.formats={number:bf((r,n)=>{const s=new Intl.NumberFormat(r,{...n});return a=>s.format(a)}),currency:bf((r,n)=>{const s=new Intl.NumberFormat(r,{...n,style:"currency"});return a=>s.format(a)}),datetime:bf((r,n)=>{const s=new Intl.DateTimeFormat(r,{...n});return a=>s.format(a)}),relativetime:bf((r,n)=>{const s=new Intl.RelativeTimeFormat(r,{...n});return a=>s.format(a,n.range||"day")}),list:bf((r,n)=>{const s=new Intl.ListFormat(r,{...n});return a=>s.format(a)})},this.init(t)}init(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=r.interpolation.formatSeparator||","}add(t,r){this.formats[t.toLowerCase().trim()]=r}addCached(t,r){this.formats[t.toLowerCase().trim()]=bf(r)}format(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(o=>o.indexOf(")")>-1)){const o=a.findIndex(l=>l.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,o)].join(this.formatSeparator)}return a.reduce((o,l)=>{const{formatName:u,formatOptions:f}=Ete(l);if(this.formats[u]){let h=o;try{const p=s&&s.formatParams&&s.formatParams[s.interpolationkey]||{},d=p.locale||p.lng||s.locale||s.lng||n;h=this.formats[u](o,d,{...f,...s,...p})}catch(p){this.logger.warn(p)}return h}else this.logger.warn(`there was no format function for ${u}`);return o},t)}}const jte=(e,t)=>{e.pending[t]!==void 0&&(delete e.pending[t],e.pendingCount--)};class Tte extends Bx{constructor(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=t,this.store=r,this.services=n,this.languageUtils=n.languageUtils,this.options=s,this.logger=uo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=s.maxParallelReads||10,this.readingCalls=0,this.maxRetries=s.maxRetries>=0?s.maxRetries:5,this.retryTimeout=s.retryTimeout>=1?s.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,s.backend,s)}queueLoad(t,r,n,s){const a={},i={},o={},l={};return t.forEach(u=>{let f=!0;r.forEach(h=>{const p=`${u}|${h}`;!n.reload&&this.store.hasResourceBundle(u,h)?this.state[p]=2:this.state[p]<0||(this.state[p]===1?i[p]===void 0&&(i[p]=!0):(this.state[p]=1,f=!1,i[p]===void 0&&(i[p]=!0),a[p]===void 0&&(a[p]=!0),l[h]===void 0&&(l[h]=!0)))}),f||(o[u]=!0)}),(Object.keys(a).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:s}),{toLoad:Object.keys(a),pending:Object.keys(i),toLoadLanguages:Object.keys(o),toLoadNamespaces:Object.keys(l)}}loaded(t,r,n){const s=t.split("|"),a=s[0],i=s[1];r&&this.emit("failedLoading",a,i,r),!r&&n&&this.store.addResourceBundle(a,i,n,void 0,void 0,{skipCopy:!0}),this.state[t]=r?-1:2,r&&n&&(this.state[t]=0);const o={};this.queue.forEach(l=>{ute(l.loaded,[a],i),jte(l,t),r&&l.errors.push(r),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{o[u]||(o[u]={});const f=l.loaded[u];f.length&&f.forEach(h=>{o[u][h]===void 0&&(o[u][h]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",o),this.queue=this.queue.filter(l=>!l.done)}read(t,r,n){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!t.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:t,ns:r,fcName:n,tried:s,wait:a,callback:i});return}this.readingCalls++;const o=(u,f)=>{if(this.readingCalls--,this.waitingReads.length>0){const h=this.waitingReads.shift();this.read(h.lng,h.ns,h.fcName,h.tried,h.wait,h.callback)}if(u&&f&&s<this.maxRetries){setTimeout(()=>{this.read.call(this,t,r,n,s+1,a*2,i)},a);return}i(u,f)},l=this.backend[n].bind(this.backend);if(l.length===2){try{const u=l(t,r);u&&typeof u.then=="function"?u.then(f=>o(null,f)).catch(o):o(null,u)}catch(u){o(u)}return}return l(t,r,o)}prepareLoading(t,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),s&&s();Gt(t)&&(t=this.languageUtils.toResolveHierarchy(t)),Gt(r)&&(r=[r]);const a=this.queueLoad(t,r,n,s);if(!a.toLoad.length)return a.pending.length||s(),null;a.toLoad.forEach(i=>{this.loadOne(i)})}load(t,r,n){this.prepareLoading(t,r,{},n)}reload(t,r,n){this.prepareLoading(t,r,{reload:!0},n)}loadOne(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=t.split("|"),s=n[0],a=n[1];this.read(s,a,"read",void 0,void 0,(i,o)=>{i&&this.logger.warn(`${r}loading namespace ${a} for language ${s} failed`,i),!i&&o&&this.logger.log(`${r}loaded namespace ${a} for language ${s}`,o),this.loaded(t,i,o)})}saveMissing(t,r,n,s,a){let i=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},o=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(r)){this.logger.warn(`did not save key "${n}" as the namespace "${r}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){const l={...i,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let f;u.length===5?f=u(t,r,n,s,l):f=u(t,r,n,s),f&&typeof f.then=="function"?f.then(h=>o(null,h)).catch(o):o(null,f)}catch(f){o(f)}else u(t,r,n,s,o,l)}!t||!t[0]||this.store.addResource(t[0],r,n,s)}}}const pE=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if(typeof e[1]=="object"&&(t=e[1]),Gt(e[1])&&(t.defaultValue=e[1]),Gt(e[2])&&(t.tDescription=e[2]),typeof e[2]=="object"||typeof e[3]=="object"){const r=e[3]||e[2];Object.keys(r).forEach(n=>{t[n]=r[n]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),mE=e=>(Gt(e.ns)&&(e.ns=[e.ns]),Gt(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Gt(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),c1=()=>{},Cte=e=>{Object.getOwnPropertyNames(Object.getPrototypeOf(e)).forEach(r=>{typeof e[r]=="function"&&(e[r]=e[r].bind(e))})};class cp extends Bx{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;if(super(),this.options=mE(t),this.services={},this.logger=uo,this.modules={external:[]},Cte(this),r&&!this.isInitialized&&!t.isClone){if(!this.options.initImmediate)return this.init(t,r),this;setTimeout(()=>{this.init(t,r)},0)}}init(){var t=this;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof r=="function"&&(n=r,r={}),!r.defaultNS&&r.defaultNS!==!1&&r.ns&&(Gt(r.ns)?r.defaultNS=r.ns:r.ns.indexOf("translation")<0&&(r.defaultNS=r.ns[0]));const s=pE();this.options={...s,...this.options,...mE(r)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...s.interpolation,...this.options.interpolation}),r.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=r.keySeparator),r.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=r.nsSeparator);const a=f=>f?typeof f=="function"?new f:f:null;if(!this.options.isClone){this.modules.logger?uo.init(a(this.modules.logger),this.options):uo.init(null,this.options);let f;this.modules.formatter?f=this.modules.formatter:typeof Intl<"u"&&(f=Ate);const h=new fE(this.options);this.store=new cE(this.options.resources,this.options);const p=this.services;p.logger=uo,p.resourceStore=this.store,p.languageUtils=h,p.pluralResolver=new kte(h,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),f&&(!this.options.interpolation.format||this.options.interpolation.format===s.interpolation.format)&&(p.formatter=a(f),p.formatter.init(p,this.options),this.options.interpolation.format=p.formatter.format.bind(p.formatter)),p.interpolator=new _te(this.options),p.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},p.backendConnector=new Tte(a(this.modules.backend),p.resourceStore,p,this.options),p.backendConnector.on("*",function(d){for(var m=arguments.length,g=new Array(m>1?m-1:0),w=1;w<m;w++)g[w-1]=arguments[w];t.emit(d,...g)}),this.modules.languageDetector&&(p.languageDetector=a(this.modules.languageDetector),p.languageDetector.init&&p.languageDetector.init(p,this.options.detection,this.options)),this.modules.i18nFormat&&(p.i18nFormat=a(this.modules.i18nFormat),p.i18nFormat.init&&p.i18nFormat.init(this)),this.translator=new Qg(this.services,this.options),this.translator.on("*",function(d){for(var m=arguments.length,g=new Array(m>1?m-1:0),w=1;w<m;w++)g[w-1]=arguments[w];t.emit(d,...g)}),this.modules.external.forEach(d=>{d.init&&d.init(this)})}if(this.format=this.options.interpolation.format,n||(n=c1),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const f=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);f.length>0&&f[0]!=="dev"&&(this.options.lng=f[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(f=>{this[f]=function(){return t.store[f](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(f=>{this[f]=function(){return t.store[f](...arguments),t}});const l=Ph(),u=()=>{const f=(h,p)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(p),n(h,p)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return f(null,this.t.bind(this));this.changeLanguage(this.options.lng,f)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(t){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c1;const s=Gt(t)?t:this.language;if(typeof t=="function"&&(n=t),!this.options.resources||this.options.partialBundledLanguages){if(s&&s.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],i=o=>{if(!o||o==="cimode")return;this.services.languageUtils.toResolveHierarchy(o).forEach(u=>{u!=="cimode"&&a.indexOf(u)<0&&a.push(u)})};s?i(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>i(l)),this.options.preload&&this.options.preload.forEach(o=>i(o)),this.services.backendConnector.load(a,this.options.ns,o=>{!o&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(o)})}else n(null)}reloadResources(t,r,n){const s=Ph();return typeof t=="function"&&(n=t,t=void 0),typeof r=="function"&&(n=r,r=void 0),t||(t=this.languages),r||(r=this.options.ns),n||(n=c1),this.services.backendConnector.reload(t,r,a=>{s.resolve(),n(a)}),s}use(t){if(!t)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!t.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return t.type==="backend"&&(this.modules.backend=t),(t.type==="logger"||t.log&&t.warn&&t.error)&&(this.modules.logger=t),t.type==="languageDetector"&&(this.modules.languageDetector=t),t.type==="i18nFormat"&&(this.modules.i18nFormat=t),t.type==="postProcessor"&&IP.addPostProcessor(t),t.type==="formatter"&&(this.modules.formatter=t),t.type==="3rdParty"&&this.modules.external.push(t),this}setResolvedLanguage(t){if(!(!t||!this.languages)&&!(["cimode","dev"].indexOf(t)>-1))for(let r=0;r<this.languages.length;r++){const n=this.languages[r];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(t,r){var n=this;this.isLanguageChangingTo=t;const s=Ph();this.emit("languageChanging",t);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},i=(l,u)=>{u?(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,s.resolve(function(){return n.t(...arguments)}),r&&r(l,function(){return n.t(...arguments)})},o=l=>{!t&&!l&&this.services.languageDetector&&(l=[]);const u=Gt(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||a(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,f=>{i(f,u)})};return!t&&this.services.languageDetector&&!this.services.languageDetector.async?o(this.services.languageDetector.detect()):!t&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(o):this.services.languageDetector.detect(o):o(t),s}getFixedT(t,r,n){var s=this;const a=function(i,o){let l;if(typeof o!="object"){for(var u=arguments.length,f=new Array(u>2?u-2:0),h=2;h<u;h++)f[h-2]=arguments[h];l=s.options.overloadTranslationOptionHandler([i,o].concat(f))}else l={...o};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);const p=s.options.keySeparator||".";let d;return l.keyPrefix&&Array.isArray(i)?d=i.map(m=>`${l.keyPrefix}${p}${m}`):d=l.keyPrefix?`${l.keyPrefix}${p}${i}`:i,s.t(d,l)};return Gt(t)?a.lng=t:a.lngs=t,a.ns=r,a.keyPrefix=n,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(t){this.options.defaultNS=t}hasLoadedNamespace(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=r.lng||this.resolvedLanguage||this.languages[0],s=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const i=(o,l)=>{const u=this.services.backendConnector.state[`${o}|${l}`];return u===-1||u===0||u===2};if(r.precheck){const o=r.precheck(this,i);if(o!==void 0)return o}return!!(this.hasResourceBundle(n,t)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||i(n,t)&&(!s||i(a,t)))}loadNamespaces(t,r){const n=Ph();return this.options.ns?(Gt(t)&&(t=[t]),t.forEach(s=>{this.options.ns.indexOf(s)<0&&this.options.ns.push(s)}),this.loadResources(s=>{n.resolve(),r&&r(s)}),n):(r&&r(),Promise.resolve())}loadLanguages(t,r){const n=Ph();Gt(t)&&(t=[t]);const s=this.options.preload||[],a=t.filter(i=>s.indexOf(i)<0&&this.services.languageUtils.isSupportedCode(i));return a.length?(this.options.preload=s.concat(a),this.loadResources(i=>{n.resolve(),r&&r(i)}),n):(r&&r(),Promise.resolve())}dir(t){if(t||(t=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!t)return"rtl";const r=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new fE(pE());return r.indexOf(n.getLanguagePartFromCode(t))>-1||t.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;return new cp(t,r)}cloneInstance(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:c1;const n=t.forkResourceStore;n&&delete t.forkResourceStore;const s={...this.options,...t,isClone:!0},a=new cp(s);return(t.debug!==void 0||t.prefix!==void 0)&&(a.logger=a.logger.clone(t)),["store","services","language"].forEach(o=>{a[o]=this[o]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new cE(this.store.data,s),a.services.resourceStore=a.store),a.translator=new Qg(a.services,s),a.translator.on("*",function(o){for(var l=arguments.length,u=new Array(l>1?l-1:0),f=1;f<l;f++)u[f-1]=arguments[f];a.emit(o,...u)}),a.init(s,r),a.translator.options=s,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const ms=cp.createInstance();ms.createInstance=cp.createInstance;ms.createInstance;ms.dir;ms.init;ms.loadResources;ms.reloadResources;ms.use;ms.changeLanguage;ms.getFixedT;ms.t;ms.exists;ms.setDefaultNamespace;ms.hasLoadedNamespace;ms.loadNamespaces;ms.loadLanguages;const Pte={title:"Gestion de Projets",subtitle:"Application de gestion de projets offline-first"},Lte={save:"Enregistrer",cancel:"Annuler",delete:"Supprimer",edit:"Modifier",create:"Crer",search:"Rechercher",filter:"Filtrer",export:"Exporter",import:"Importer",back:"Retour",next:"Suivant",previous:"Prcdent",loading:"Chargement...",error:"Erreur",success:"Succs",warning:"Avertissement",info:"Information",confirm:"Confirmer",close:"Fermer",viewAll:"Voir tout"},Fte={login:"Connexion",register:"Inscription",logout:"Dconnexion",email:"Email",password:"Mot de passe",firstName:"Prnom",lastName:"Nom",forgotPassword:"Mot de passe oubli?",loginSuccess:"Connexion russie",loginError:"Erreur de connexion",registerSuccess:"Inscription russie",registerError:"Erreur lors de l'inscription"},Dte={status:{offline:"Hors ligne",syncing:"Synchronisation...",synced:" jour",error:"Erreur de synchronisation",idle:"En attente"},lastSync:"Dernire sync: {{time}}",pendingOperations:"{{count}} oprations en attente",syncNow:"Synchroniser maintenant",autoSync:"Synchronisation automatique",conflicts:"Conflits dtects",resolveConflict:"Rsoudre le conflit"},Rte={title:"Tableau de bord",totalProjects:"Projets totaux",activeProjects:"Projets actifs",completedProjects:"Projets termins",totalBudget:"Budget total",recentProjects:"Projets rcents",recentActivities:"Activits rcentes",upcomingDeadlines:"chances  venir",statistics:"Statistiques"},Ote={title:"Projet",projects:"Projets",new:"Nouveau projet",newProject:"Nouveau projet",createDescription:"Crez un nouveau projet en remplissant les informations ci-dessous",editProject:"Modifier le projet",deleteProject:"Supprimer le projet",projectDetails:"Dtails du projet",noProjects:"Aucun projet pour le moment",objet:"Objet",marcheNo:"March N",annee:"Anne",dateOuverture:"Date d'ouverture",montant:"Montant (MAD)",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"Socit",patente:"Patente",delaisEntreeService:"Dlais d'entre en service",osc:"OSC",status:{draft:"Brouillon",active:"Actif",completed:"Termin",archived:"Archiv"},progress:"Avancement",folderPath:"Chemin du dossier"},Ite={title:"Bordereau",bordereaux:"Bordereaux",newBordereau:"Nouveau bordereau",reference:"Rfrence",designation:"Dsignation",unite:"Unit",quantite:"Quantit",prixUnitaire:"Prix unitaire",montantTotal:"Montant total"},Mte={title:"Mtr",metres:"Mtrs",newMetre:"Nouveau mtr",reference:"Rfrence",designation:"Dsignation",mesures:"Mesures",longueur:"Longueur",largeur:"Largeur",hauteur:"Hauteur",quantite:"Quantit",totalQuantite:"Quantit totale"},Bte={title:"Dcompte",decompts:"Dcomptes",newDecompt:"Nouveau dcompte",periode:"Priode",numero:"Numro",lignes:"Lignes",montantTotal:"Montant total",statut:{draft:"Brouillon",submitted:"Soumis",validated:"Valid",paid:"Pay"},generatePDF:"Gnrer PDF"},Ute={title:"Photo",photos:"Photos",uploadPhoto:"Tlcharger une photo",description:"Description",tags:"tiquettes",location:"Localisation"},$te={title:"Procs-Verbal",pvs:"Procs-Verbaux",newPV:"Nouveau PV",type:{installation:"Installation",reception:"Rception",constat:"Constat",other:"Autre"},numero:"Numro",date:"Date",objet:"Objet",contenu:"Contenu",participants:"Participants",attachments:"Pices jointes"},zte={title:"Pice jointe",attachments:"Pices jointes",uploadFile:"Tlcharger un fichier",category:{facture:"Facture",bp:"Bon de paiement",plan:"Plan",autre:"Autre"}},Hte={title:"Paramtres",language:"Langue",theme:"Thme",notifications:"Notifications",account:"Compte",sync:"Synchronisation"},qte={app:Pte,common:Lte,auth:Fte,sync:Dte,dashboard:Rte,project:Ote,bordereau:Ite,metre:Mte,decompt:Bte,photo:Ute,pv:$te,attachment:zte,settings:Hte},Wte={title:" ",subtitle:"     "},Vte={save:"",cancel:"",delete:"",edit:"",create:"",search:"",filter:"",export:"",import:"",back:"",next:"",previous:"",loading:" ...",error:"",success:"",warning:"",info:"",confirm:"",close:""},Kte={login:" ",register:"",logout:" ",email:" ",password:" ",firstName:" ",lastName:" ",forgotPassword:"   ",loginSuccess:"   ",loginError:"   ",registerSuccess:"  ",registerError:"  "},Gte={status:{offline:" ",syncing:" ...",synced:"",error:"  ",idle:" "},lastSync:" : {{time}}",pendingOperations:"{{count}}  ",syncNow:" ",autoSync:" ",conflicts:" ",resolveConflict:" "},Yte={title:" ",totalProjects:" ",activeProjects:" ",completedProjects:" ",totalBudget:" ",recentProjects:" ",recentActivities:" ",upcomingDeadlines:"  ",statistics:""},Xte={title:"",projects:"",newProject:" ",editProject:" ",deleteProject:" ",projectDetails:" ",objet:"",marcheNo:" ",annee:"",dateOuverture:" ",montant:" ()",snss:"SNSS",cbn:"C.B.N",rcn:"R.C.N",societe:"",patente:"",delaisEntreeService:"   ",osc:"OSC",status:{draft:"",active:"",completed:"",archived:""},progress:"",folderPath:" "},Jte={title:" ",bordereaux:" ",newBordereau:"  ",reference:"",designation:"",unite:"",quantite:"",prixUnitaire:" ",montantTotal:" "},Qte={title:"",metres:"",newMetre:" ",reference:"",designation:"",mesures:"",longueur:"",largeur:"",hauteur:"",quantite:"",totalQuantite:" "},Zte={title:"",decompts:"",newDecompt:" ",periode:"",numero:"",lignes:"",montantTotal:" ",statut:{draft:"",submitted:"",validated:" ",paid:""},generatePDF:" PDF"},ere={title:"",photos:"",uploadPhoto:" ",description:"",tags:"",location:""},tre={title:"",pvs:"",newPV:" ",type:{installation:"",reception:"",constat:"",other:""},numero:"",date:"",objet:"",contenu:"",participants:"",attachments:""},rre={title:"",attachments:"",uploadFile:" ",category:{facture:"",bp:" ",plan:"",autre:""}},nre={title:"",language:"",theme:"",notifications:"",account:"",sync:""},sre={app:Wte,common:Vte,auth:Kte,sync:Gte,dashboard:Yte,project:Xte,bordereau:Jte,metre:Qte,decompt:Zte,photo:ere,pv:tre,attachment:rre,settings:nre},are={title:"Project Management",subtitle:"Offline-first project management application"},ire={save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",create:"Create",search:"Search",filter:"Filter",export:"Export",import:"Import",back:"Back",next:"Next",previous:"Previous",loading:"Loading...",error:"Error",success:"Success",warning:"Warning",info:"Information",confirm:"Confirm",close:"Close"},ore={login:"Login",register:"Register",logout:"Logout",email:"Email",password:"Password",firstName:"First Name",lastName:"Last Name",forgotPassword:"Forgot password?",loginSuccess:"Login successful",loginError:"Login error",registerSuccess:"Registration successful",registerError:"Registration error"},lre={status:{offline:"Offline",syncing:"Syncing...",synced:"Up to date",error:"Sync error",idle:"Idle"},lastSync:"Last sync: {{time}}",pendingOperations:"{{count}} pending operations",syncNow:"Sync now",autoSync:"Auto sync",conflicts:"Conflicts detected",resolveConflict:"Resolve conflict"},cre={title:"Dashboard",totalProjects:"Total Projects",activeProjects:"Active Projects",completedProjects:"Completed Projects",totalBudget:"Total Budget",recentProjects:"Recent Projects",recentActivities:"Recent Activities",upcomingDeadlines:"Upcoming Deadlines",statistics:"Statistics"},ure={title:"Project",projects:"Projects",newProject:"New Project",editProject:"Edit Project",deleteProject:"Delete Project",projectDetails:"Project Details",objet:"Object",marcheNo:"Contract No.",annee:"Year",dateOuverture:"Opening Date",montant:"Amount (MAD)",snss:"SNSS",cbn:"C.B.No.",rcn:"R.C.No.",societe:"Company",patente:"License",delaisEntreeService:"Service Entry Deadline",osc:"OSC",status:{draft:"Draft",active:"Active",completed:"Completed",archived:"Archived"},progress:"Progress",folderPath:"Folder Path"},fre={title:"Price Schedule",bordereaux:"Price Schedules",newBordereau:"New Price Schedule",reference:"Reference",designation:"Designation",unite:"Unit",quantite:"Quantity",prixUnitaire:"Unit Price",montantTotal:"Total Amount"},dre={title:"Measurement",metres:"Measurements",newMetre:"New Measurement",reference:"Reference",designation:"Designation",mesures:"Measurements",longueur:"Length",largeur:"Width",hauteur:"Height",quantite:"Quantity",totalQuantite:"Total Quantity"},hre={title:"Payment Statement",decompts:"Payment Statements",newDecompt:"New Payment Statement",periode:"Period",numero:"Number",lignes:"Lines",montantTotal:"Total Amount",statut:{draft:"Draft",submitted:"Submitted",validated:"Validated",paid:"Paid"},generatePDF:"Generate PDF"},pre={title:"Photo",photos:"Photos",uploadPhoto:"Upload Photo",description:"Description",tags:"Tags",location:"Location"},mre={title:"Report",pvs:"Reports",newPV:"New Report",type:{installation:"Installation",reception:"Reception",constat:"Finding",other:"Other"},numero:"Number",date:"Date",objet:"Subject",contenu:"Content",participants:"Participants",attachments:"Attachments"},gre={title:"Attachment",attachments:"Attachments",uploadFile:"Upload File",category:{facture:"Invoice",bp:"Payment Slip",plan:"Plan",autre:"Other"}},xre={title:"Settings",language:"Language",theme:"Theme",notifications:"Notifications",account:"Account",sync:"Synchronization"},vre={app:are,common:ire,auth:ore,sync:lre,dashboard:cre,project:ure,bordereau:fre,metre:dre,decompt:hre,photo:pre,pv:mre,attachment:gre,settings:xre},yre={fr:{translation:qte},ar:{translation:sre},en:{translation:vre}},wre=localStorage.getItem("language")||"fr";ms.use(BR).init({resources:yre,lng:wre,fallbackLng:"fr",interpolation:{escapeValue:!1}});ms.on("languageChanged",e=>{document.documentElement.setAttribute("dir",e==="ar"?"rtl":"ltr"),document.documentElement.setAttribute("lang",e),localStorage.setItem("language",e)});const bre=new kR({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1,staleTime:5*60*1e3}}});Kv.createRoot(document.getElementById("root")).render(c.jsx(Vl.StrictMode,{children:c.jsx(ER,{client:bre,children:c.jsx(YD,{children:c.jsx(ote,{})})})}));export{_r as _,Sre as c,_E as g};
